<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="og: https://ogp.me/ns#">
  <head>
    <meta charset="utf-8" />
<link rel="canonical" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/index" />
<link rel="shortlink" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/index" />
<meta property="og:site_name" content="Red Hat Customer Portal" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/index" />
<meta property="og:title" content="CI/CD OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<meta property="og:description" content="CI/CD for the OpenShift Container Platform" />
<meta property="og:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="CI/CD for the OpenShift Container Platform" />
<meta name="twitter:title" content="CI/CD OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<meta name="twitter:url" content="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/index" />
<meta name="twitter:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="title" content="CI/CD OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<link rel="alternate" hreflang="en" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/index" />
<link rel="alternate" hreflang="ko" href="https://access.redhat.com/documentation/ko-kr/openshift_container_platform/4.13/html-single/cicd/index" />
<link rel="alternate" hreflang="zh-hans" href="https://access.redhat.com/documentation/zh-cn/openshift_container_platform/4.13/html-single/cicd/index" />
<link rel="alternate" hreflang="ja" href="https://access.redhat.com/documentation/ja-jp/openshift_container_platform/4.13/html-single/cicd/index" />
<link rel="alternate" hreflang="es" href="https://access.redhat.com/documentation/es-es/openshift_container_platform/4.13/html-single/cicd/index" />
<link rel="alternate" hreflang="ru" href="https://access.redhat.com/documentation/ru-ru/openshift_container_platform/4.13/html-single/cicd/index" />
<link rel="alternate" hreflang="pt-br" href="https://access.redhat.com/documentation/pt-br/openshift_container_platform/4.13/html-single/cicd/index" />
<link rel="alternate" hreflang="it" href="https://access.redhat.com/documentation/it-it/openshift_container_platform/4.13/html-single/cicd/index" />
<link rel="alternate" hreflang="de" href="https://access.redhat.com/documentation/de-de/openshift_container_platform/4.13/html-single/cicd/index" />
<link rel="alternate" hreflang="fr" href="https://access.redhat.com/documentation/fr-fr/openshift_container_platform/4.13/html-single/cicd/index" />
<link rel="alternate" hreflang="zh-hant" href="https://access.redhat.com/documentation/zh-tw/openshift_container_platform/4.13/html-single/cicd/index" />
<link rel="alternate" hreflang="id" href="https://access.redhat.com/documentation/id-id/openshift_container_platform/4.13/html-single/cicd/index" />
<link rel="alternate" hreflang="th" href="https://access.redhat.com/documentation/th-th/openshift_container_platform/4.13/html-single/cicd/index" />
<link rel="alternate" hreflang="vi" href="https://access.redhat.com/documentation/vi-vn/openshift_container_platform/4.13/html-single/cicd/index" />
<meta name="Generator" content="Drupal 9 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="revision" product="b0738f19-59ac-47eb-9512-8a439cd6dfb0" title="f71bae66-8008-4738-8132-4e3b3d0a2ea4" page="498199b3-d727-4378-9089-e8be50d3a7b8" revision="a9b2f940183f7b22b049f578bab422b40265d849:en-us" body="d02969ce0ea9e43801d56cbb1f8f2972.html" toc="b885f894a3b64fef8dee6bc203167288.json" />

    <title>CI/CD OpenShift Container Platform 4.13 | Red Hat Customer Portal</title>
    <link rel="stylesheet" media="all" href="/sites/dxp-docs/files/css/css_87GMcmxT1ib8ziQiU2KUAnTDFtZQV6iP-KGslA9LigM.css" />
<link rel="stylesheet" media="all" href="/sites/dxp-docs/files/css/css__Xq4GfgPDJw9K_yYJFmlRZGJeCENu3R3r4s0K7Tr_9g.css" />

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"documentation\/en-us\/openshift_container_platform\/4.13\/html-single\/cicd\/index","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"red_hat_jwt":{"client_id":"customer-portal","cookie_name":"rh_jwt","leeway":"0","realm":"redhat-external","sso_host":"https:\/\/sso.redhat.com\/","user_integration":1,"user_plugin":"drupal_user_auth","use_external_js":0,"use_internal_js":0,"use_in_admin":0},"user":{"uid":0,"permissionsHash":"d8ea0bce2d740dacbdfe0257cf55baa0e33f7fb8468a26d055ce75daaaa2d315"}}</script>
<script src="/sites/dxp-docs/files/js/js_EQWKo9EokWkWS99x_e1oM-NEM0zlKyTkp_83mGdm5Ks.js"></script>

    <!-- CP_PRIMER_HEAD -->  <!-- TrustArc & DTM -->
  <script src="//static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>
  <script src="//www.redhat.com/dtm.js"></script><meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<!--[if IEMobile]><meta http-equiv="cleartype" content="on"><![endif]-->

<!-- metaInclude -->
<meta name="avalon-host-info" content="dxp-kbase-prod-139-77b4fb8768-25dr9" />
<meta name="avalon-version" content="27861f77" />
<meta name="cp-chrome-build-date" content="2023-10-06T19:17:59.039Z" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#000000">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#000000">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-status-bar-style" content="#000000">
<link rel="manifest" href="https://access.redhat.com/webassets/avalon/j/manifest.json">
<!-- Open Search - Tap to search -->
<link rel="search" type="application/opensearchdescription+xml" title="Red Hat Customer Portal" href="https://access.redhat.com/webassets/avalon/j/opensearch.xml" />
<!-- title -->
<title>Red Hat Customer Portal - Access to 24x7 support and knowledge</title>
<!-- /title -->
<script type="text/javascript">
    window.portal = {
        analytics : {},
        host      : "https://access.redhat.com",
        idp_url   : "https://sso.redhat.com",
        lang      : "en", 
        version   : "27861f77",
        builddate : "2023-10-06T19:17:59.039Z",        fetchdate : "2023-10-10T17:45:08-0400",        nrid      : "NOLONGERSUPPORTED",
        nrlk      : "NOLONGERSUPPORTED"
    };
</script>
<script type="text/javascript">
    if (!/\/logout.*/.test(location.pathname) && portal.host === location.origin && document.cookie.indexOf('rh_sso_session') >= 0 && !(document.cookie.indexOf('rh_jwt') >= 0)) window.location = '/login?redirectTo=' + encodeURIComponent(window.location.href);
</script>
<!-- cssInclude -->

<link rel="shortcut icon" href="https://access.redhat.com/webassets/avalon/g/favicon.ico" /><link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/bootstrap.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/bootstrap-grid.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/main.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/components.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/pages.css?v=27861f77" />

<link href="https://access.redhat.com/webassets/avalon/s/chosen.css?v=27861f77" rel="stylesheet" type="text/css" />

<!--[if lte IE 9]>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/ie.css" />
<![endif]--><noscript>
    <style type="text/css" media="screen"> .primary-nav { display: block; } </style>
</noscript>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/webassets/avalon/j/public_modules/node_modules/@cpelements/pfe-navigation/dist/pfe-navigation--lightdom.min.css" />
<!-- /cssInclude -->
<script src="https://access.redhat.com/webassets/avalon/j/public_modules/node_modules/@cpelements/pfe-navigation/dist/ie-polyfills.js?v=27861f77"></script>

<script async>
  if (!HTMLScriptElement.supports || !HTMLScriptElement.supports('importmap')) {
    import("https://www.redhatstatic.com/dx/v1-alpha/es-module-shims@1.7.3.js");
  }
</script>
<script type="importmap">
{
  "imports": {
    "@patternfly/elements/" : "https://www.redhatstatic.com/dx/v1-alpha/@patternfly/elements@2.2.2/",
    "@rhds/elements/":"https://www.redhatstatic.com/dx/v1-alpha/@rhds/elements@1.1.0/elements/",
    "@rhds/elements/lib/":"https://www.redhatstatic.com/dx/v1-alpha/@rhds/elements@1.1.0/lib/",
    "@cpelements/elements/":"https://www.redhatstatic.com/dx/v1-alpha/@cpelements/elements@2.0.0-alpha.7/elements/"
  }
}
</script><script type="text/javascript" src="https://access.redhat.com/webassets/avalon/j/lib/require.js?v=27861f77" data-main="/webassets/avalon/j/"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<script src="https://access.redhat.com/chrome_themes/nimbus/js/ie8.js"></script>
<![endif]-->
<script type="text/javascript" src="https://access.redhat.com/chrome_themes/nimbus/js/new-nav.js?v=27861f77" ></script>
<!-- /CP_PRIMER_HEAD -->

  </head>
  <body>
    
      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
      <!-- CP_PRIMER_HEADER -->
<div id="page-wrap" class="page-wrap">
    <div id="pers-top-page-wrap" class="top-page-wrap pers-loader-bg">

      <div id="hero-bg-top-left" class="summit-bg-shapes"></div>
      <div id="hero-bg-top-right" class="summit-bg-shapes"></div>

        <!--googleoff: all-->
        <header class="masthead" id="masthead">

            <a href="#pfe-navigation" id="global-skip-to-nav" class="skip-link visually-hidden">Skip to navigation</a>
            <a href="#cp-main" class="skip-link visually-hidden">Skip to main content</a>            <nav id="portal-utility-nav" class="utility-navigation utility-navigation--bar hidden-at-mobile" data-analytics-region="utility" aria-labelledby="nav__utility-nav--desktop">
                <h3 id="nav__utility-nav--desktop" class="element-invisible">Utilities
                </h3>
                <ul aria-labelledby="nav__utility-nav--desktop">
                    <li id="nav-subscription" data-portal-tour-1="1">
                        <a class="top-nav-subscriptions" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Subscription" href="https://access.redhat.com/management/" >Subscriptions
                        </a>
                    </li>
                    <li id="nav-downloads" data-portal-tour-1="2">
                        <a class="top-nav-downloads" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Downloads" href="https://access.redhat.com/downloads/" >Downloads
                        </a>
                    </li>
                    <li id="nav-containers">
                        <a class="top-nav-containers" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Containers" href="https://catalog.redhat.com/software/containers/explore/" >Containers
                        </a>
                    </li>
                    <li id="nav-support" data-portal-tour-1="3">
                        <a class="top-nav-support-cases" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Support Cases" href="https://access.redhat.com/support/cases/" >Support Cases
                        </a>
                    </li>
                </ul>
            </nav>

            <pfe-navigation id="pfe-navigation" data-analytics-region="mega menu">
                <div class="pfe-navigation__logo-wrapper" id="pfe-navigation__logo-wrapper">
                    <a href="https://access.redhat.com/" class="pfe-navigation__logo-link" data-analytics-text="logo" data-analytics-category="MM|logo">
                        <img class="pfe-navigation__logo-image" alt="Red Hat Customer Portal" src="https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg" />
                    </a>
                </div>

                <nav class="pfe-navigation" aria-label="Main Navigation" data-analytics-region="main nav">
                    <ul class="pfe-navigation__menu" id="pfe-navigation__menu">                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-subscription--mobile" data-portal-tour-1="1">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Subscription" href="https://access.redhat.com/management/" >Subscriptions
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-downloads--mobile" data-portal-tour-1="2">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Downloads" href="https://access.redhat.com/downloads/" >Downloads
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-containers--mobile">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Containers" href="https://catalog.redhat.com/software/containers/explore/" >Containers
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-support--mobile" data-portal-tour-1="3">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Support Cases" href="https://access.redhat.com/support/cases/" >Support Cases
                            </a>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a href="https://access.redhat.com/products/" class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Products and Services">Products &amp; Services
                            </a>
                            <div class="pfe-navigation__dropdown has-primary-detail">                                <div class="desktop-col-span-2 tablet-col-span-all">
                                    <h3>
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Products" href="https://access.redhat.com/products/">Products
                                        </a>
                                    </h3>
                                    <slot name="main-menu__dropdown--product__product-listing"></slot>
                                </div>                                <div>
                                    <h3 id="nav__products__support">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Support" href="https://access.redhat.com/support">Support
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__support">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Production Support" href="https://access.redhat.com/support/offerings/production/">Production Support
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Development Support" href="https://access.redhat.com/support/offerings/developer/">Development Support
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Product Life Cycles" href="https://access.redhat.com/product-life-cycles/">Product Life Cycles
                                                    </a></li>
                                    </ul>

                                    <h3 id="nav__products__services">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Services" href="https://www.redhat.com/en/services">Services
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__services">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Consulting" href="https://www.redhat.com/en/services/consulting">Consulting
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Technical Account Management" href="https://access.redhat.com/support/offerings/tam/">Technical Account Management
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Training and Certifications" href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications
                                                    </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__products__documentation">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Documentation" href="https://access.redhat.com/documentation">Documentation
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__documentation">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat Enterprise Linux" href="https://access.redhat.com/documentation/en/red_hat_enterprise_linux">Red Hat Enterprise Linux
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat JBoss Enterprise Application Platform" href="https://access.redhat.com/documentation/en/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat OpenStack Platform" href="https://access.redhat.com/documentation/en/red_hat_openstack_platform">Red Hat OpenStack Platform
                                                    </a></li>
                                                    <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat OpenShift Container Platform" href="https://access.redhat.com/documentation/en/openshift_container_platform">Red Hat OpenShift Container Platform
                                                        </a></li>
                                    </ul>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="All Documentation" data-analytics-linkType="cta" href="https://access.redhat.com/documentation">All Documentation
                                        </a>
                                    </pfe-cta>

                                    <h3 id="nav__products__catalog"><a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Ecosystem Catalog" href="https://catalog.redhat.com/">Ecosystem Catalog
                                        </a></h3>
                                        <ul aria-labelledby="nav__products__catalog">
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Ecosystem Catalog" data-analytics-text="Red Hat Partner Ecosystem" href="https://access.redhat.com/ecosystem/">Red Hat Partner Ecosystem
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Ecosystem Catalog" data-analytics-text="Partner Resources" href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources
                                                    </a></li>
                                        </ul>
                                </div>
                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Tools" href="https://access.redhat.com/labs/">Tools
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="nav__tools__tools" data-analytics-level="2" data-analytics-text="Tools" data-analytics-category="Tools">Tools
                                    </h3>
                                    <ul aria-labelledby="nav__tools__tools">
                                        <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Solution Engine" href="https://access.redhat.com/support/cases/#/troubleshoot">Troubleshoot a product issue
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Packages" href="https://access.redhat.com/downloads/content/package-browser">Packages
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Errata" href="https://access.redhat.com/errata/">Errata
                                                    </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__tools__labs">
                                        <a data-analytics-level="2" data-analytics-category="Tools" data-analytics-text="Customer Portal Labs" href="https://access.redhat.com/labs/">Customer Portal Labs
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__tools__labs">
                                        <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Configuration" href="https://access.redhat.com/labs/#!?type=config">Configuration
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Deployment" href="https://access.redhat.com/labs/#!?type=deploy">Deployment
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Security" href="https://access.redhat.com/labs/#!?type=security">Security
                                                    </a></li>                                                    <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Troubleshooting" href="https://access.redhat.com/labs/#!?type=troubleshoot">Troubleshoot
                                                        </a></li>
                                    </ul>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="All Labs" data-analytics-linkType="cta" href="https://access.redhat.com/labs/">All labs
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h4 id="nav__tools__red-hat-insights">
                                        <a data-analytics-level="2" data-analytics-category="Tools" data-analytics-text="Red Hat Insights" href="//www.redhat.com/en/technologies/management/insights">Red Hat Insights
                                        </a>
                                    </h4>
                                    <p>Increase visibility into IT operations to detect and resolve technical issues before they impact your business.</p>
                                    <a data-analytics-level="3" data-analytics-category="Tools|Red Hat Insights" data-analytics-text="Learn more" href="https://www.redhat.com/en/technologies/management/insights">Learn More
                                    </a>
                                    <br>
                                    <a data-analytics-level="3" data-analytics-category="Tools|Red Hat Insights" data-analytics-text="Go to Insights" href="https://cloud.redhat.com/insights">Go to Insights
                                    </a>
                                </div>
                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Security" href="https://access.redhat.com/security/">Security
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="security__security-center">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Red Hat Product Security Center" href="https://access.redhat.com/security">Red Hat Product Security Center
                                        </a>
                                    </h3>
                                    <p>Engage with our Red Hat Product Security team, access security updates, and ensure your environments are not exposed to any known security vulnerabilities.
                                    </p>
                                    <pfe-cta pfe-priority="primary">
                                        <a data-analytics-level="3" data-analytics-category="Security|Red Hat Product Security Center" data-analytics-text="Product Security Center" data-analytics-linkType="cta" href="https://access.redhat.com/security/">Product Security Center
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__security__updates" data-analytics-level="2" data-analytics-text="Security Updates" data-analytics-category="Security">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Security Updates" href="/security">Security Updates
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__security__updates">
                                        <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Security Advisories" href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Red Hat CVE Database" href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Security Labs" href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs
                                                    </a></li>
                                    </ul>
                                    <p class="margin-top-xl">Keep your systems secure with Red Hat&#039;s specialized responses to security vulnerabilities.
                                    </p>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="View Responses" data-analytics-linkType="cta" href="https://access.redhat.com/security/vulnerability">View Responses
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__security__resources">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Resources" href="https://access.redhat.com/security/overview">Resources
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__security__resources">                                            <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Security Blog" href="//redhat.com/en/blog/channel/security">Security Blog
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Security Measurement" href="https://www.redhat.com/security/data/metrics/">Security Measurement
                                                    </a></li>
                                                    <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Severity Ratings" href="https://access.redhat.com/security/updates/classification/">Severity Ratings
                                                        </a></li>
                                                        <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Backporting Policies" href="https://access.redhat.com/security/updates/backporting/">Backporting Policies
                                                            </a></li>
                                                            <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Product Signing (GPG) Keys" href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys
                                                                </a></li>
                                    </ul>
                                </div>

                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a href="https://access.redhat.com/community/" class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Community">Community
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="nav__community__cp-community">
                                        <a href="https://access.redhat.com/community" data-analytics-level="2" data-analytics-text="Customer Portal Community" data-analytics-text="Customer Portal Community" data-analytics-category="Community">Customer Portal Community
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__community__cp-community">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Discussions" href="https://access.redhat.com/discussions">Discussions
                                            </a></li>                                                <li><a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Private Groups" href="https://access.redhat.com/groups/">Private Groups
                                                    </a></li>
                                    </ul>

                                    <pfe-cta pfe-priority="primary">
                                        <a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Community Activity" data-analytics-linkType="cta" href="https://access.redhat.com/community/">Community Activity
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__community__events" data-analytics-level="2" data-analytics-text="Customer Events" data-analytics-category="Community">Customer Events
                                    </h3>
                                    <ul aria-labelledby="nav__community__events">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Customer Events" data-analytics-text="Red Hat Convergence" href="https://access.redhat.com/convergence/">Red Hat Convergence
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Community|Customer Events" data-analytics-text="Red Hat Summit" href="http://www.redhat.com/summit/">Red Hat Summit
                                                </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__community__stories" data-analytics-level="2" data-analytics-text="Stories" data-analytics-category="Community">Stories
                                    </h3>
                                    <ul aria-labelledby="nav__community__stories">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Stories" data-analytics-text="Red Hat Subscription Value" href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-text="You Asked. We Acted." data-analytics-category="Community|Stories" href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Community|Stories" data-analytics-text="Open Source Communities" href="http://www.redhat.com/en/open-source">Open Source Communities
                                                    </a></li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                    </ul>                </nav>                <div id="site-search" slot="search" class="utility-link site-search">
                    <div class="content">
                        <form class="ng-pristine ng-valid topSearchForm" id="topSearchForm" name="topSearchForm" action="/search/browse/search/" method="get" enctype="application/x-www-form-urlencoded">
                            <cp-search-autocomplete class="push-bottom" path="/webassets/avalon/j/data.json"></cp-search-autocomplete>                            <div>Or <a href="/support/cases/#/troubleshoot">troubleshoot an issue</a>.
                            </div>
                        </form>
                    </div>
                </div>


                <div slot="secondary-links" id="localesMenu">
                    <button class="pfe-navigation__secondary-link">
                        <pfe-icon icon="web-icon-globe" size="sm" aria-hidden="true"></pfe-icon>English
                    </button>

                    <pfe-navigation-dropdown dropdown-width="single">
                        <h2 class="utility-header">Select Your Language
                        </h2>
                        <ul class="reset">
                            <li><a href="https://access.redhat.com/changeLanguage?language=en" data-lang="en" id="en" data-analytics-text="English">English</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=ko" data-lang="ko" id="ko" data-analytics-text="Korean">한국어</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=ja"    data-lang="ja"    id="ja" data-analytics-text="Japanese">日本語</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" data-lang="zh_CN" id="zh_CN" data-analytics-text="Chinese">中文 (中国)</a></li>
                        </ul>

                    </pfe-navigation-dropdown>
                </div>                <rh-account-dropdown slot="account"></rh-account-dropdown>                <pfe-primary-detail breakpoint-width="600" class="main-menu__dropdown--product__product-listing" slot="main-menu__dropdown--product__product-listing" consistent-height>
                    <h3 slot="details-nav">Infrastructure and Management                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Enterprise Linux" href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Satellite" href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Subscription Management" href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Insights" href="https://access.redhat.com/products/red-hat-insights/">Red Hat Insights
                                </a>
                            </li>
                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Ansible Automation Platform" href="https://access.redhat.com/products/red-hat-ansible-automation-platform/">Red Hat Ansible Automation Platform
                                </a></li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Cloud Computing                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift" href="https://access.redhat.com/products/openshift">Red Hat OpenShift
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenStack Platform" href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat OpenShift Container Platform" href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat OpenShift Data Science" href="https://access.redhat.com/products/red-hat-openshift-data-science/">Red Hat OpenShift Data Science
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift Dedicated" href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat Advanced Cluster Security for Kubernetes" href="https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/">Red Hat Advanced Cluster Security for Kubernetes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat Advanced Cluster Management for Kubernetes" href="https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/">Red Hat Advanced Cluster Management for Kubernetes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat Quay" href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat CodeReady Workspaces" href="https://access.redhat.com/products/red-hat-codeready-workspaces/">OpenShift Dev Spaces
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift Service on AWS" href="https://access.redhat.com/products/red-hat-openshift-service-aws">Red Hat OpenShift Service on AWS
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Storage                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Gluster Storage" href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Hyperconverged Infrastructure" href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Ceph Storage" href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Openshift Container Storage" href="https://access.redhat.com/products/red-hat-openshift-data-foundation">Red Hat OpenShift Data Foundation
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Runtimes                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Runtimes" href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat JBoss Enterprise Application Platform" href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Data Grid" href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat JBoss Web Server" href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Single Sign On" href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat support for Spring Boot" href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat build of Node.js" href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js
                                </a>
                            </li>                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat build of Quarkus" href="https://access.redhat.com/products/quarkus/">Red Hat build of Quarkus
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Integration and Automation                    </h3>
                    <div slot="details">
                        <ul class="border-bottom" id="portal-menu-border-bottom">
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat Application Foundations" href="https://access.redhat.com/products/red-hat-application-foundations/">Red Hat Application Foundations
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat Fuse" href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat AMQ" href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat 3scale API Management" href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div slot="details-nav--footer">
                        <pfe-cta pfe-priority="primary">
                            <a href="https://access.redhat.com/products/" class="pfe-navigation__menu-link" data-analytics-level="2" data-analytics-text="All Products" data-analytics-category="Products and Services|Products:" data-analytics-linkType="cta">All Products
                            </a>
                        </pfe-cta>
                    </div>
                </pfe-primary-detail>

            </pfe-navigation>

            <div id="scroll-anchor"></div>

            <!--[if IE 8]>
                <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                <span class="icon-warning alert-icon" aria-hidden="true"></span>
                You are using an unsupported web browser. Update to a supported browser for the best experience. <a href="/announcements/2120951">Read the announcement</a>.
                </div>
                </div>
            <![endif]-->
            <!--[if IE 9]>
                <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                <span class="icon-warning alert-icon" aria-hidden="true"></span>As of March 1, 2016, the Red Hat Customer Portal will no longer support Internet Explorer 9. See our new <a href="/help/browsers">browser support policy</a> for more information.
                </div>
                </div>
            <![endif]-->
            <div id="site-section"></div>
        </header>
        <!--googleon: all-->

        <main id="cp-main" class="portal-content-area">
            <div id="cp-content" class="main-content">                            <!-- /CP_PRIMER_HEADER -->

      <div class="container">
        

                                                                                                        <script>breadcrumbs = [["Products & Services","\/products\/"],["Product Documentation","\/documentation"],["OpenShift Container Platform","\/documentation\/en-us\/openshift_container_platform"],["4.13","\/documentation\/en-us\/openshift_container_platform\/4.13"],["CI\/CD","\/documentation\/en-us\/openshift_container_platform\/4.13\/html\/cicd"],["CI\/CD","\/documentation\/en-us\/openshift_container_platform\/4.13\/html\/cicd\/--single-page-document--"]]</script>

<div data-drupal-messages-fallback class="hidden"></div>


    </div>
        <div class="container">
        

  

  


  <article class="pvof-doc__content-wrapper__outer pvof-doc__content-wrapper__outer--css-not-removed">
    <script>
      'use strict';

            var $outerWrapper = document.querySelector('.pvof-doc__content-wrapper__outer');
      if ($outerWrapper && $outerWrapper.closest) {
        var $containerWrapper = $outerWrapper.closest('.container');
        if ($containerWrapper) {
          $containerWrapper.classList.remove('container');
          $containerWrapper.classList.add('j-chrome-content-container');
        }
      }

            var cssRemoved = false;
      try {
        var $crapCss = document.querySelectorAll(
          'link[href*="/chrome_themes/nimbus/css/pages.css"], link[href*="/chrome_themes/nimbus/css/components.css"]'
        );
        if ($crapCss.length) {
          for (let index = 0; index < $crapCss.length; index++) {
            const $stylesheet = $crapCss[index];
            $stylesheet.remove();
          }
        }
        cssRemoved = true;
      }
      catch (error) {
        console.error('Ran into an issue while trying to retheme page', error);
        cssRemoved = false;
      }

            if (cssRemoved) {
        var $pvofOuterWrapper = document.querySelector('.pvof-doc__content-wrapper__outer--css-not-removed');
        if ($pvofOuterWrapper) {
          $pvofOuterWrapper.classList.remove('pvof-doc__content-wrapper__outer--css-not-removed');
        }
      }
    </script>
    <div itemscope="" itemtype="https://schema.org/TechArticle" itemref="techArticle-md1 techArticle-md2 techArticle-md3"></div>
    <div itemscope="" itemtype="https://schema.org/SoftwareApplication" itemref="softwareApplication-md1 softwareApplication-md2 softwareApplication-md3 softwareApplication-md4"></div>
    <div class="pvof-doc__content-wrapper pvof-doc__content-wrapper--has-sidebar">
                                <div class="pvof-doc__content-wrapper__inner j-superdoc j-superdoc--has-nav">
                            <div class="pvof-sidebar__wrapper j-doc-nav j-superdoc__nav">
            <div class="j-sidebar__menu-container">
              <button class="j-sidebar__menu-trigger content-expander__trigger">
                <span class="j-sidebar__menu-trigger__open-text">Jump To</span>
                <span class="j-sidebar__menu-trigger__close-text">Close</span>
              </button>

              <div class="pvof-sidebar__inner-wrapper j-doc-nav__wrapper content-expander">
                <div class="j-sidebar__menu-details-container">
                  <button class="j-sidebar__menu-details-button j-sidebar__menu-details-button--expand">
                    Expand all
                  </button>
                  <button class="j-sidebar__menu-details-button j-sidebar__menu-details-button--collapse">
                    Collapse all
                  </button>
                </div>
                

  <nav id="pvof-doc__toc" class="pvof-doc__toc">
  <h2 class="j-doc-nav__title" id="j-doc-nav__title">
    Table of contents
  </h2>
  <div class="pvof-doc__toc-inner">
              <ol class="j-doc-nav__list" aria-labelledby="j-doc-nav__title">
                  <li class="j-doc-nav__list-item">
                                    

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd" class="j-doc-nav__link ">
    CI/CD
  </a>
  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#ci-cd-overview" class="j-doc-nav__link j-doc-nav__link--has-children">
    1. OpenShift Container Platform CI/CD overview
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1. OpenShift Container Platform CI/CD overview"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1. OpenShift Container Platform CI/CD overview"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#openshift-builds" class="j-doc-nav__link ">
    1.1. OpenShift Builds
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#openshift-pipelines" class="j-doc-nav__link ">
    1.2. OpenShift Pipelines
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#openshift-gitops" class="j-doc-nav__link ">
    1.3. OpenShift GitOps
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#jenkins-ci-cd" class="j-doc-nav__link ">
    1.4. Jenkins
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds" class="j-doc-nav__link j-doc-nav__link--has-children">
    2. Builds
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2. Builds"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2. Builds"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#understanding-image-builds" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1. Understanding image builds
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1. Understanding image builds"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1. Understanding image builds"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-about_understanding-image-builds" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1.1. Builds
  </a>
                              <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1.1. Builds"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1.1. Builds"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-docker-build_understanding-image-builds" class="j-doc-nav__link ">
    2.1.1.1. Docker build
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-s2i-build_understanding-image-builds" class="j-doc-nav__link ">
    2.1.1.2. Source-to-image build
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-custom-build_understanding-image-builds" class="j-doc-nav__link ">
    2.1.1.3. Custom build
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-pipeline-build_understanding-image-builds" class="j-doc-nav__link ">
    2.1.1.4. Pipeline build
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#understanding-buildconfigs" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.2. Understanding build configurations
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.2. Understanding build configurations"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.2. Understanding build configurations"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-buildconfig_understanding-builds" class="j-doc-nav__link ">
    2.2.1. BuildConfigs
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#creating-build-inputs" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.3. Creating build inputs
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.3. Creating build inputs"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.3. Creating build inputs"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-define-build-inputs_creating-build-inputs" class="j-doc-nav__link ">
    2.3.1. Build inputs
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-dockerfile-source_creating-build-inputs" class="j-doc-nav__link ">
    2.3.2. Dockerfile source
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-image-source_creating-build-inputs" class="j-doc-nav__link ">
    2.3.3. Image source
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-source-code_creating-build-inputs" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.3.4. Git source
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.3.4. Git source"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.3.4. Git source"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-using-proxy-git-cloning_creating-build-inputs" class="j-doc-nav__link ">
    2.3.4.1. Using a proxy
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-adding-source-clone-secrets_creating-build-inputs" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.3.4.2. Source Clone Secrets
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.3.4.2. Source Clone Secrets"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.3.4.2. Source Clone Secrets"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-automatically-add-source-clone-secrets_creating-build-inputs" class="j-doc-nav__link ">
    2.3.4.2.1. Automatically adding a source clone secret to a build configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-manually-add-source-clone-secrets_creating-build-inputs" class="j-doc-nav__link ">
    2.3.4.2.2. Manually adding a source clone secret
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-gitconfig-file_creating-build-inputs" class="j-doc-nav__link ">
    2.3.4.2.3. Creating a secret from a .gitconfig file
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-gitconfig-file-secured-git_creating-build-inputs" class="j-doc-nav__link ">
    2.3.4.2.4. Creating a secret from a .gitconfig file for secured Git
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-source-secret-basic-auth_creating-build-inputs" class="j-doc-nav__link ">
    2.3.4.2.5. Creating a secret from source code basic authentication
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-source-secret-ssh-key-auth_creating-build-inputs" class="j-doc-nav__link ">
    2.3.4.2.6. Creating a secret from source code SSH key authentication
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-source-secret-trusted-ca_creating-build-inputs" class="j-doc-nav__link ">
    2.3.4.2.7. Creating a secret from source code trusted certificate authorities
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-source-secret-combinations_creating-build-inputs" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.3.4.2.8. Source secret combinations
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.3.4.2.8. Source secret combinations"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.3.4.2.8. Source secret combinations"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-source-secret-combinations-ssh-gitconfig_creating-build-inputs" class="j-doc-nav__link ">
    2.3.4.2.8.1. Creating a SSH-based authentication secret with a .gitconfig file
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-source-secret-combinations-gitconfig-ca_creating-build-inputs" class="j-doc-nav__link ">
    2.3.4.2.8.2. Creating a secret that combines a .gitconfig file and CA certificate
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-source-secret-combinations-basic-auth-ca_creating-build-inputs" class="j-doc-nav__link ">
    2.3.4.2.8.3. Creating a basic authentication secret with a CA certificate
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-source-secret-combinations-basic-auth-gitconfig_creating-build-inputs" class="j-doc-nav__link ">
    2.3.4.2.8.4. Creating a basic authentication secret with a .gitconfig file
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-source-secret-combinations-basic-auth-gitconfig-ca_creating-build-inputs" class="j-doc-nav__link ">
    2.3.4.2.8.5. Creating a basic authentication secret with a .gitconfig file and CA certificate
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-binary-source_creating-build-inputs" class="j-doc-nav__link ">
    2.3.5. Binary (local) source
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-input-secrets-configmaps_creating-build-inputs" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.3.6. Input secrets and config maps
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.3.6. Input secrets and config maps"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.3.6. Input secrets and config maps"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-secrets-overview_creating-build-inputs" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.3.6.1. What is a secret?
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.3.6.1. What is a secret?"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.3.6.1. What is a secret?"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-secrets-overview-properties_creating-build-inputs" class="j-doc-nav__link ">
    2.3.6.1.1. Properties of secrets
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-secrets-overview-types_creating-build-inputs" class="j-doc-nav__link ">
    2.3.6.1.2. Types of Secrets
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-secrets-overview-updates_creating-build-inputs" class="j-doc-nav__link ">
    2.3.6.1.3. Updates to secrets
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-creating-secrets_creating-build-inputs" class="j-doc-nav__link ">
    2.3.6.2. Creating secrets
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-using-secrets_creating-build-inputs" class="j-doc-nav__link ">
    2.3.6.3. Using secrets
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-adding-input-secrets-configmaps_creating-build-inputs" class="j-doc-nav__link ">
    2.3.6.4. Adding input secrets and config maps
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-source-to-image_creating-build-inputs" class="j-doc-nav__link ">
    2.3.6.5. Source-to-image strategy
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-docker-strategy_creating-build-inputs" class="j-doc-nav__link ">
    2.3.6.6. Docker strategy
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-custom-strategy_creating-build-inputs" class="j-doc-nav__link ">
    2.3.6.7. Custom strategy
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-using-external-artifacts_creating-build-inputs" class="j-doc-nav__link ">
    2.3.7. External artifacts
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-docker-credentials-private-registries_creating-build-inputs" class="j-doc-nav__link ">
    2.3.8. Using docker credentials for private registries
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-build-environment_creating-build-inputs" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.3.9. Build environments
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.3.9. Build environments"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.3.9. Build environments"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-using-build-fields-as-environment-variables_creating-build-inputs" class="j-doc-nav__link ">
    2.3.9.1. Using build fields as environment variables
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-using-secrets-as-environment-variables_creating-build-inputs" class="j-doc-nav__link ">
    2.3.9.2. Using secrets as environment variables
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-service-serving-certificate-secrets_creating-build-inputs" class="j-doc-nav__link ">
    2.3.10. Service serving certificate secrets
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-secrets-restrictions_creating-build-inputs" class="j-doc-nav__link ">
    2.3.11. Secrets restrictions
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#managing-build-output" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4. Managing build output
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4. Managing build output"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4. Managing build output"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-docker-source-build-output_managing-build-output" class="j-doc-nav__link ">
    2.4.1. Build output
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-output-image-environment-variables_managing-build-output" class="j-doc-nav__link ">
    2.4.2. Output image environment variables
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-output-image-labels_managing-build-output" class="j-doc-nav__link ">
    2.4.3. Output image labels
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#build-strategies" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5. Using build strategies
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5. Using build strategies"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5. Using build strategies"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-docker-build_build-strategies" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5.1. Docker build
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5.1. Docker build"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5.1. Docker build"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-docker-from-image_build-strategies" class="j-doc-nav__link ">
    2.5.1.1. Replacing Dockerfile FROM image
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-dockerfile-path_build-strategies" class="j-doc-nav__link ">
    2.5.1.2. Using Dockerfile path
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-docker-environment-variables_build-strategies" class="j-doc-nav__link ">
    2.5.1.3. Using docker environment variables
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-docker-build-arguments_build-strategies" class="j-doc-nav__link ">
    2.5.1.4. Adding docker build arguments
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-docker-squash-layers_build-strategies" class="j-doc-nav__link ">
    2.5.1.5. Squashing layers with docker builds
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-using-build-volumes_build-strategies-docker" class="j-doc-nav__link ">
    2.5.1.6. Using build volumes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-s2i-build_build-strategies-docker" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5.2. Source-to-image build
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5.2. Source-to-image build"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5.2. Source-to-image build"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-s2i-incremental-builds_build-strategies-docker" class="j-doc-nav__link ">
    2.5.2.1. Performing source-to-image incremental builds
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-s2i-override-builder-image-scripts_build-strategies-docker" class="j-doc-nav__link ">
    2.5.2.2. Overriding source-to-image builder image scripts
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-s2i-environment-variables_build-strategies-docker" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5.2.3. Source-to-image environment variables
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5.2.3. Source-to-image environment variables"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5.2.3. Source-to-image environment variables"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-s2i-environment-files_build-strategies-docker" class="j-doc-nav__link ">
    2.5.2.3.1. Using source-to-image environment files
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-s2i-buildconfig-environment_build-strategies-docker" class="j-doc-nav__link ">
    2.5.2.3.2. Using source-to-image build configuration environment
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-s2i-ignore-source-files_build-strategies-docker" class="j-doc-nav__link ">
    2.5.2.4. Ignoring source-to-image source files
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-create-s2i_build-strategies-docker" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5.2.5. Creating images from source code with source-to-image
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5.2.5. Creating images from source code with source-to-image"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5.2.5. Creating images from source code with source-to-image"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-create-s2i-build_build-strategies-docker" class="j-doc-nav__link ">
    2.5.2.5.1. Understanding the source-to-image build process
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-create-s2i-scripts_build-strategies-docker" class="j-doc-nav__link ">
    2.5.2.5.2. How to write source-to-image scripts
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-using-build-volumes_build-strategies-s2i" class="j-doc-nav__link ">
    2.5.2.6. Using build volumes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-custom-build_build-strategies-s2i" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5.3. Custom build
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5.3. Custom build"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5.3. Custom build"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-custom-from-image_build-strategies-s2i" class="j-doc-nav__link ">
    2.5.3.1. Using FROM image for custom builds
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-custom-secrets_build-strategies-s2i" class="j-doc-nav__link ">
    2.5.3.2. Using secrets in custom builds
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-custom-environment-variables_build-strategies-s2i" class="j-doc-nav__link ">
    2.5.3.3. Using environment variables for custom builds
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-custom_build-strategies-s2i" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5.3.4. Using custom builder images
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5.3.4. Using custom builder images"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5.3.4. Using custom builder images"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-custom-builder-image-ref_build-strategies-s2i" class="j-doc-nav__link ">
    2.5.3.4.1. Custom builder image
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-custom-builder-flow_build-strategies-s2i" class="j-doc-nav__link ">
    2.5.3.4.2. Custom builder workflow
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-pipeline-build_build-strategies-s2i" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5.4. Pipeline build
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5.4. Pipeline build"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5.4. Pipeline build"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-understanding-openshift-pipeline_build-strategies-s2i" class="j-doc-nav__link ">
    2.5.4.1. Understanding OpenShift Container Platform pipelines
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-pipeline-providing-jenkinsfile_build-strategies-s2i" class="j-doc-nav__link ">
    2.5.4.2. Providing the Jenkins file for pipeline builds
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-pipeline-environment-variables_build-strategies-s2i" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5.4.3. Using environment variables for pipeline builds
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5.4.3. Using environment variables for pipeline builds"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5.4.3. Using environment variables for pipeline builds"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-pipeline-mapping-buildconfig-jenkins_build-strategies-s2i" class="j-doc-nav__link ">
    2.5.4.3.1. Mapping between BuildConfig environment variables and Jenkins job parameters
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-tutorial-pipeline_build-strategies-s2i" class="j-doc-nav__link ">
    2.5.4.4. Pipeline build tutorial
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-secrets-web-console_build-strategies-s2i" class="j-doc-nav__link ">
    2.5.5. Adding secrets with web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-enable-pulling-pushing_build-strategies-s2i" class="j-doc-nav__link ">
    2.5.6. Enabling pulling and pushing
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#custom-builds-buildah" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.6. Custom image builds with Buildah
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.6. Custom image builds with Buildah"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.6. Custom image builds with Buildah"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#prerequisites" class="j-doc-nav__link ">
    2.6.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-create-custom-build-artifacts_custom-builds-buildah" class="j-doc-nav__link ">
    2.6.2. Creating custom build artifacts
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-build-custom-builder-image_custom-builds-buildah" class="j-doc-nav__link ">
    2.6.3. Build custom builder image
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-use-custom-builder-image_custom-builds-buildah" class="j-doc-nav__link ">
    2.6.4. Use custom builder image
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#basic-build-operations" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.7. Performing and configuring basic builds
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.7. Performing and configuring basic builds"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.7. Performing and configuring basic builds"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-basic-start-build_basic-build-operations" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.7.1. Starting a build
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.7.1. Starting a build"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.7.1. Starting a build"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-basic-start-re-run_basic-build-operations" class="j-doc-nav__link ">
    2.7.1.1. Re-running a build
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-basic-start-logs_basic-build-operations" class="j-doc-nav__link ">
    2.7.1.2. Streaming build logs
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-basic-start-environment-variable_basic-build-operations" class="j-doc-nav__link ">
    2.7.1.3. Setting environment variables when starting a build
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-basic-start-source_basic-build-operations" class="j-doc-nav__link ">
    2.7.1.4. Starting a build with source
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-basic-cancel-build_basic-build-operations" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.7.2. Canceling a build
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.7.2. Canceling a build"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.7.2. Canceling a build"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-basic-cancel-multiple_basic-build-operations" class="j-doc-nav__link ">
    2.7.2.1. Canceling multiple builds
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-basic-cancel-all_basic-build-operations" class="j-doc-nav__link ">
    2.7.2.2. Canceling all builds
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-basic-cancel-all-state_basic-build-operations" class="j-doc-nav__link ">
    2.7.2.3. Canceling all builds in a given state
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-basic-edit-buildconfig_basic-build-operations" class="j-doc-nav__link ">
    2.7.3. Editing a BuildConfig
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-basic-delete-buildconfig_basic-build-operations" class="j-doc-nav__link ">
    2.7.4. Deleting a BuildConfig
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-basic-view-build-details_basic-build-operations" class="j-doc-nav__link ">
    2.7.5. Viewing build details
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-basic-access-build-logs_basic-build-operations" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.7.6. Accessing build logs
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.7.6. Accessing build logs"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.7.6. Accessing build logs"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-basic-access-buildconfig-logs_basic-build-operations" class="j-doc-nav__link ">
    2.7.6.1. Accessing BuildConfig logs
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-basic-access-buildconfig-version-logs_basic-build-operations" class="j-doc-nav__link ">
    2.7.6.2. Accessing BuildConfig logs for a given version build
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-basic-access-build-verbosity_basic-build-operations" class="j-doc-nav__link ">
    2.7.6.3. Enabling log verbosity
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#triggering-builds-build-hooks" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.8. Triggering and modifying builds
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.8. Triggering and modifying builds"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.8. Triggering and modifying builds"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-triggers_triggering-builds-build-hooks" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.8.1. Build triggers
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.8.1. Build triggers"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.8.1. Build triggers"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-webhook-triggers_triggering-builds-build-hooks" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.8.1.1. Webhook triggers
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.8.1.1. Webhook triggers"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.8.1.1. Webhook triggers"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-using-github-webhooks_triggering-builds-build-hooks" class="j-doc-nav__link ">
    2.8.1.1.1. Using GitHub webhooks
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-using-gitlab-webhooks_triggering-builds-build-hooks" class="j-doc-nav__link ">
    2.8.1.1.2. Using GitLab webhooks
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-using-bitbucket-webhooks_triggering-builds-build-hooks" class="j-doc-nav__link ">
    2.8.1.1.3. Using Bitbucket webhooks
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-using-generic-webhooks_triggering-builds-build-hooks" class="j-doc-nav__link ">
    2.8.1.1.4. Using generic webhooks
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-displaying-webhook-urls_triggering-builds-build-hooks" class="j-doc-nav__link ">
    2.8.1.1.5. Displaying webhook URLs
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-using-image-change-triggers_triggering-builds-build-hooks" class="j-doc-nav__link ">
    2.8.1.2. Using image change triggers
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-image-change-trigger-identification_triggering-builds-build-hooks" class="j-doc-nav__link ">
    2.8.1.3. Identifying the image change trigger of a build
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-configuration-change-triggers_triggering-builds-build-hooks" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.8.1.4. Configuration change triggers
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.8.1.4. Configuration change triggers"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.8.1.4. Configuration change triggers"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-setting-triggers-manually_triggering-builds-build-hooks" class="j-doc-nav__link ">
    2.8.1.4.1. Setting triggers manually
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-build-hooks_triggering-builds-build-hooks" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.8.2. Build hooks
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.8.2. Build hooks"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.8.2. Build hooks"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-configuring-post-commit-build-hooks_triggering-builds-build-hooks" class="j-doc-nav__link ">
    2.8.2.1. Configuring post commit build hooks
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-using-cli-post-commit-build-hooks_triggering-builds-build-hooks" class="j-doc-nav__link ">
    2.8.2.2. Using the CLI to set post commit build hooks
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#advanced-build-operations" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.9. Performing advanced builds
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.9. Performing advanced builds"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.9. Performing advanced builds"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-setting-build-resources_advanced-build-operations" class="j-doc-nav__link ">
    2.9.1. Setting build resources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-setting-maximum-duration_advanced-build-operations" class="j-doc-nav__link ">
    2.9.2. Setting maximum duration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-assigning-builds-to-nodes_advanced-build-operations" class="j-doc-nav__link ">
    2.9.3. Assigning builds to specific nodes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-chaining-builds_advanced-build-operations" class="j-doc-nav__link ">
    2.9.4. Chained builds
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-build-pruning_advanced-build-operations" class="j-doc-nav__link ">
    2.9.5. Pruning builds
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-build-run-policy_advanced-build-operations" class="j-doc-nav__link ">
    2.9.6. Build run policy
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#running-entitled-builds" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.10. Using Red Hat subscriptions in builds
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.10. Using Red Hat subscriptions in builds"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.10. Using Red Hat subscriptions in builds"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-create-imagestreamtag_running-entitled-builds" class="j-doc-nav__link ">
    2.10.1. Creating an image stream tag for the Red Hat Universal Base Image
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-source-secrets-entitlements_running-entitled-builds" class="j-doc-nav__link ">
    2.10.2. Adding subscription entitlements as a build secret
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#running-builds-with-subscription-manager" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.10.3. Running builds with Subscription Manager
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.10.3. Running builds with Subscription Manager"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.10.3. Running builds with Subscription Manager"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-docker-entitled-subman_running-entitled-builds" class="j-doc-nav__link ">
    2.10.3.1. Docker builds using Subscription Manager
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#running-builds-with-red-hat-satellite-subscriptions" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.10.4. Running builds with Red Hat Satellite subscriptions
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.10.4. Running builds with Red Hat Satellite subscriptions"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.10.4. Running builds with Red Hat Satellite subscriptions"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-source-input-satellite-config_running-entitled-builds" class="j-doc-nav__link ">
    2.10.4.1. Adding Red Hat Satellite configurations to builds
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-strategy-docker-entitled-satellite_running-entitled-builds" class="j-doc-nav__link ">
    2.10.4.2. Docker builds using Red Hat Satellite subscriptions
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-running-entitled-builds-with-sharedsecret-objects_running-entitled-builds" class="j-doc-nav__link ">
    2.10.5. Running entitled builds using SharedSecret objects
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#additional-resources" class="j-doc-nav__link ">
    2.10.6. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#securing-builds-by-strategy" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.11. Securing builds by strategy
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.11. Securing builds by strategy"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.11. Securing builds by strategy"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-disabling-build-strategy-globally_securing-builds-by-strategy" class="j-doc-nav__link ">
    2.11.1. Disabling access to a build strategy globally
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-restricting-build-strategy-globally_securing-builds-by-strategy" class="j-doc-nav__link ">
    2.11.2. Restricting build strategies to users globally
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-restricting-build-strategy-to-user_securing-builds-by-strategy" class="j-doc-nav__link ">
    2.11.3. Restricting build strategies to a user within a project
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#build-configuration" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.12. Build configuration resources
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.12. Build configuration resources"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.12. Build configuration resources"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-configuration-parameters_build-configuration" class="j-doc-nav__link ">
    2.12.1. Build controller configuration parameters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-configuration-file_build-configuration" class="j-doc-nav__link ">
    2.12.2. Configuring build settings
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#troubleshooting-builds_build-configuration" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.13. Troubleshooting builds
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.13. Troubleshooting builds"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.13. Troubleshooting builds"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-troubleshooting-access-resources_troubleshooting-builds" class="j-doc-nav__link ">
    2.13.1. Resolving denial for access to resources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#builds-troubleshooting-service-certificate-generation_troubleshooting-builds" class="j-doc-nav__link ">
    2.13.2. Service certificate generation failure
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#setting-up-trusted-ca" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.14. Setting up additional trusted certificate authorities for builds
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.14. Setting up additional trusted certificate authorities for builds"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.14. Setting up additional trusted certificate authorities for builds"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#configmap-adding-ca_setting-up-trusted-ca" class="j-doc-nav__link ">
    2.14.1. Adding certificate authorities to the cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#additional-resources-2" class="j-doc-nav__link ">
    2.14.2. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#pipelines" class="j-doc-nav__link j-doc-nav__link--has-children">
    3. Pipelines
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "3. Pipelines"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "3. Pipelines"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#about-pipelines" class="j-doc-nav__link ">
    3.1. About Red Hat OpenShift Pipelines
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#gitops" class="j-doc-nav__link j-doc-nav__link--has-children">
    4. GitOps
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4. GitOps"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4. GitOps"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#about-redhat-openshift-gitops" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.1. About Red Hat OpenShift GitOps
  </a>
                              <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.1. About Red Hat OpenShift GitOps"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.1. About Red Hat OpenShift GitOps"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#key-features" class="j-doc-nav__link ">
    4.1.1. Key features
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#additional-resources_about-op-gitops" class="j-doc-nav__link ">
    4.1.2. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#jenkins" class="j-doc-nav__link j-doc-nav__link--has-children">
    5. Jenkins
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5. Jenkins"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5. Jenkins"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.1. Configuring Jenkins images
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.1. Configuring Jenkins images"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.1. Configuring Jenkins images"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-config-customization_images-other-jenkins" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.1.1. Configuration and customization
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.1.1. Configuration and customization"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.1.1. Configuration and customization"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-oauth-auth_images-other-jenkins" class="j-doc-nav__link ">
    5.1.1.1. OpenShift Container Platform OAuth authentication
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-auth_images-other-jenkins" class="j-doc-nav__link ">
    5.1.1.2. Jenkins authentication
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-env-var_images-other-jenkins" class="j-doc-nav__link ">
    5.1.2. Jenkins environment variables
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-cross-project_images-other-jenkins" class="j-doc-nav__link ">
    5.1.3. Providing Jenkins cross project access
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-cross-volume-mount_images-other-jenkins" class="j-doc-nav__link ">
    5.1.4. Jenkins cross volume mount points
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-customize-s2i_images-other-jenkins" class="j-doc-nav__link ">
    5.1.5. Customizing the Jenkins image through source-to-image
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-config-kubernetes_images-other-jenkins" class="j-doc-nav__link ">
    5.1.6. Configuring the Jenkins Kubernetes plugin
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-permissions_images-other-jenkins" class="j-doc-nav__link ">
    5.1.7. Jenkins permissions
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-create-service_images-other-jenkins" class="j-doc-nav__link ">
    5.1.8. Creating a Jenkins service from a template
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-kubernetes-plugin_images-other-jenkins" class="j-doc-nav__link ">
    5.1.9. Using the Jenkins Kubernetes plugin
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-memory_images-other-jenkins" class="j-doc-nav__link ">
    5.1.10. Jenkins memory requirements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#additional-resources-3" class="j-doc-nav__link ">
    5.1.11. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-agent" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2. Jenkins agent
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2. Jenkins agent"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2. Jenkins agent"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-agent-images_images-other-jenkins-agent" class="j-doc-nav__link ">
    5.2.1. Jenkins agent images
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-agent-env-var_images-other-jenkins-agent" class="j-doc-nav__link ">
    5.2.2. Jenkins agent environment variables
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-agent-memory_images-other-jenkins-agent" class="j-doc-nav__link ">
    5.2.3. Jenkins agent memory requirements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-agent-gradle_images-other-jenkins-agent" class="j-doc-nav__link ">
    5.2.4. Jenkins agent Gradle builds
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#images-other-jenkins-agent-pod-retention_images-other-jenkins-agent" class="j-doc-nav__link ">
    5.2.5. Jenkins agent pod retention
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#migrating-from-jenkins-to-openshift-pipelines_images-other-jenkins-agent" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3. Migrating from Jenkins to OpenShift Pipelines or Tekton
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3. Migrating from Jenkins to OpenShift Pipelines or Tekton"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3. Migrating from Jenkins to OpenShift Pipelines or Tekton"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#jt-comparison-of-jenkins-and-openshift-pipelines-concepts_migrating-from-jenkins-to-openshift-pipelines" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.1. Comparison of Jenkins and OpenShift Pipelines concepts
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.1. Comparison of Jenkins and OpenShift Pipelines concepts"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.1. Comparison of Jenkins and OpenShift Pipelines concepts"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#jenkins-terminology" class="j-doc-nav__link ">
    5.3.1.1. Jenkins terminology
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#openshift-pipelines-terminology" class="j-doc-nav__link ">
    5.3.1.2. OpenShift Pipelines terminology
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#mapping-of-concepts" class="j-doc-nav__link ">
    5.3.1.3. Mapping of concepts
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#jt-migrating-a-sample-pipeline-from-jenkins-to-openshift-pipelines_migrating-from-jenkins-to-openshift-pipelines" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.2. Migrating a sample pipeline from Jenkins to OpenShift Pipelines
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.2. Migrating a sample pipeline from Jenkins to OpenShift Pipelines"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.2. Migrating a sample pipeline from Jenkins to OpenShift Pipelines"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#jenkins-pipeline" class="j-doc-nav__link ">
    5.3.2.1. Jenkins pipeline
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#openshift-pipelines-pipeline" class="j-doc-nav__link ">
    5.3.2.2. OpenShift Pipelines pipeline
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#jt-migrating-from-jenkins-plugins-to-openshift-pipelines-hub-tasks_migrating-from-jenkins-to-openshift-pipelines" class="j-doc-nav__link ">
    5.3.3. Migrating from Jenkins plugins to Tekton Hub tasks
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#jt-extending-openshift-pipelines-capabilities-using-custom-tasks-and-scripts_migrating-from-jenkins-to-openshift-pipelines" class="j-doc-nav__link ">
    5.3.4. Extending OpenShift Pipelines capabilities using custom tasks and scripts
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#jt-comparison-of-jenkins-openshift-pipelines-execution-models_migrating-from-jenkins-to-openshift-pipelines" class="j-doc-nav__link ">
    5.3.5. Comparison of Jenkins and OpenShift Pipelines execution models
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#jt-examples-of-common-use-cases_migrating-from-jenkins-to-openshift-pipelines" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.6. Examples of common use cases
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.6. Examples of common use cases"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.6. Examples of common use cases"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#running-a-maven-pipeline-in-jenkins-and-openshift-pipelines" class="j-doc-nav__link ">
    5.3.6.1. Running a Maven pipeline in Jenkins and OpenShift Pipelines
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#extending-the-core-capabilities-of-jenkins-and-openshift-pipelines-by-using-plugins" class="j-doc-nav__link ">
    5.3.6.2. Extending the core capabilities of Jenkins and OpenShift Pipelines by using plugins
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#sharing-reusable-code-in-jenkins-and-openshift-pipelines" class="j-doc-nav__link ">
    5.3.6.3. Sharing reusable code in Jenkins and OpenShift Pipelines
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#additional-resources-4" class="j-doc-nav__link ">
    5.3.7. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#important-changes-to-openshift-jenkins-images" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4. Important changes to OpenShift Jenkins images
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4. Important changes to OpenShift Jenkins images"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4. Important changes to OpenShift Jenkins images"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#relocation-of-openshift-jenkins-images_important-changes-to-openshift-jenkins-images" class="j-doc-nav__link ">
    5.4.1. Relocation of OpenShift Jenkins images
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#customizing-the-jenkins-image-stream-tag_important-changes-to-openshift-jenkins-images" class="j-doc-nav__link ">
    5.4.2. Customizing the Jenkins image stream tag
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#additional-resources_important-changes-to-openshift-jenkins-images_important-changes-to-openshift-jenkins-images" class="j-doc-nav__link ">
    5.4.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                    

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd#idm140458476713456" class="j-doc-nav__link ">
    Legal Notice
  </a>
  
          </li>
              </ol>
    
  </div>
</nav>


              </div>
            </div>
            <div class="j-options-container j-options-container--mobile">
              <button class="j-sidebar__menu-trigger j-sidebar__menu-trigger--options content-expander__trigger">
                <span class="j-sidebar__menu-trigger__open-headline">
                  Settings
                </span>
                <span class="j-sidebar__menu-trigger__close-text">Close</span>
              </button>
              

  <ul class="j-doc-options__list content-expander">
    <li class="j-doc-options__item">
          <label class="j-doc-option__label j-doc-option__label--language" for="j-doc-language">
        Language:
      </label>
      <select id="j-doc-language" class="j-doc-option__select">
                  <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd" selected=''>
            English
          </option>
                  <option value="/documentation/ja-jp/openshift_container_platform/4.13/html-single/cicd" >
            日本語
          </option>
                  <option value="/documentation/ko-kr/openshift_container_platform/4.13/html-single/cicd" >
            한국어
          </option>
                  <option value="/documentation/zh-cn/openshift_container_platform/4.13/html-single/cicd" >
            简体中文
          </option>
              </select>

            <noscript>
        <div class="j-doc-option__label j-doc-option__label--language" id="j-doc-option__label--language--nojs">
          Language:
        </div>
        <ul aria-labelledby="j-doc-option__label--language--nojs" class="j-doc-option__languages-list">
                      <li>
              <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd">English</a>
            </li>
                      <li>
              <a href="/documentation/ja-jp/openshift_container_platform/4.13/html-single/cicd">日本語</a>
            </li>
                      <li>
              <a href="/documentation/ko-kr/openshift_container_platform/4.13/html-single/cicd">한국어</a>
            </li>
                      <li>
              <a href="/documentation/zh-cn/openshift_container_platform/4.13/html-single/cicd">简体中文</a>
            </li>
                  </ul>
      </noscript>

      </li>

    <li class="j-doc-options__item">
    <label for="j-doc-mode" class="j-doc-option__label j-doc-option__label--format">
      Format:
    </label>
    <select id="j-doc-mode" class="j-doc-option__select">
              <option value="/documentation/en-us/openshift_container_platform/4.13/html/cicd"  class="j-doc-options__option j-doc-options__option--multi-page">
          Multi-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd" selected='' class="j-doc-options__option j-doc-options__option--single-page">
          Single-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/pdf/cicd/OpenShift_Container_Platform-4.13-CICD-en-US.pdf"  class="j-doc-options__option j-doc-options__option--pdf">
          PDF
        </option>
          </select>

        <noscript>
      <div class="j-doc-option__label j-doc-option__label--format" id="j-doc-option__label--format--nojs">
        Format:
      </div>
      <ul class="j-doc-option__format-list" aria-labelledby="j-doc-option__label--format--nojs">
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--multi-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html/cicd">Multi-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--single-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd">Single-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--pdf"><a href="/documentation/en-us/openshift_container_platform/4.13/pdf/cicd/OpenShift_Container_Platform-4.13-CICD-en-US.pdf">PDF</a></li>
              </ul>
    </noscript>
  </li>
</ul>


              </div>
          </div>
                <div class="pvof-doc__tertiary-sidebar j-doc__tertiary-sidebar">
          <div class="pvof-doc__tertiary-sidebar__inner j-doc__tertiary-sidebar__inner">
            <div class="j-doc__doc-options">
              <div class="j-options-container j-options-container--desktop">
                <button class="j-sidebar__menu-trigger j-sidebar__menu-trigger--tablet content-expander__trigger">
                  <span class="j-sidebar__menu-trigger-icon"></span>
                  <h2 class="visually-hidden">Language and Page Formatting Options</h2>
                </button>
                  

  <ul class="j-doc-options__list content-expander">
    <li class="j-doc-options__item">
          <label class="j-doc-option__label j-doc-option__label--language" for="j-doc-language--2">
        Language:
      </label>
      <select id="j-doc-language--2" class="j-doc-option__select">
                  <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd" selected=''>
            English
          </option>
                  <option value="/documentation/ja-jp/openshift_container_platform/4.13/html-single/cicd" >
            日本語
          </option>
                  <option value="/documentation/ko-kr/openshift_container_platform/4.13/html-single/cicd" >
            한국어
          </option>
                  <option value="/documentation/zh-cn/openshift_container_platform/4.13/html-single/cicd" >
            简体中文
          </option>
              </select>

            <noscript>
        <div class="j-doc-option__label j-doc-option__label--language" id="j-doc-option__label--language--nojs">
          Language:
        </div>
        <ul aria-labelledby="j-doc-option__label--language--nojs" class="j-doc-option__languages-list">
                      <li>
              <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd">English</a>
            </li>
                      <li>
              <a href="/documentation/ja-jp/openshift_container_platform/4.13/html-single/cicd">日本語</a>
            </li>
                      <li>
              <a href="/documentation/ko-kr/openshift_container_platform/4.13/html-single/cicd">한국어</a>
            </li>
                      <li>
              <a href="/documentation/zh-cn/openshift_container_platform/4.13/html-single/cicd">简体中文</a>
            </li>
                  </ul>
      </noscript>

      </li>

    <li class="j-doc-options__item">
    <label for="j-doc-mode--2" class="j-doc-option__label j-doc-option__label--format">
      Format:
    </label>
    <select id="j-doc-mode--2" class="j-doc-option__select">
              <option value="/documentation/en-us/openshift_container_platform/4.13/html/cicd"  class="j-doc-options__option j-doc-options__option--multi-page">
          Multi-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd" selected='' class="j-doc-options__option j-doc-options__option--single-page">
          Single-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/pdf/cicd/OpenShift_Container_Platform-4.13-CICD-en-US.pdf"  class="j-doc-options__option j-doc-options__option--pdf">
          PDF
        </option>
          </select>

        <noscript>
      <div class="j-doc-option__label j-doc-option__label--format" id="j-doc-option__label--format--nojs">
        Format:
      </div>
      <ul class="j-doc-option__format-list" aria-labelledby="j-doc-option__label--format--nojs">
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--multi-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html/cicd">Multi-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--single-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html-single/cicd">Single-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--pdf"><a href="/documentation/en-us/openshift_container_platform/4.13/pdf/cicd/OpenShift_Container_Platform-4.13-CICD-en-US.pdf">PDF</a></li>
              </ul>
    </noscript>
  </li>
</ul>


                </div>
              </div>
          </div>
        </div>

                  <div class="doc-wrapper pvof-doc__wrapper j-superdoc__content-wrapper" id="doc-wrapper">
            

  <div class="pane-page-title">
    <h1 class="title" itemprop="name">CI/CD</h1>
  </div>


  <div xml:lang="en-US" class="book" id="idm140458474444560"><div class="titlepage"><div><div class="producttitle"><span class="productname">OpenShift Container Platform</span> <span class="productnumber">4.13</span></div><div><h2 class="subtitle">Contains information on builds, pipelines and GitOps for OpenShift Container Platform </h2></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat OpenShift Documentation Team</span></div></div><div><a href="#idm140458476713456">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				CI/CD for the OpenShift Container Platform
			</div></div></div></div><hr/></div><section class="chapter" id="ci-cd-overview"><div class="titlepage"><div><div><h1 class="title">Chapter 1. OpenShift Container Platform CI/CD overview</h1></div></div></div><p>
			OpenShift Container Platform is an enterprise-ready Kubernetes platform for developers, which enables organizations to automate the application delivery process through DevOps practices, such as continuous integration (CI) and continuous delivery (CD). To meet your organizational needs, the OpenShift Container Platform provides the following CI/CD solutions:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					OpenShift Builds
				</li><li class="listitem">
					OpenShift Pipelines
				</li><li class="listitem">
					OpenShift GitOps
				</li></ul></div><section class="section" id="openshift-builds"><div class="titlepage"><div><div><h2 class="title">1.1. OpenShift Builds</h2></div></div></div><p>
				With OpenShift Builds, you can create cloud-native apps by using a declarative build process. You can define the build process in a YAML file that you use to create a BuildConfig object. This definition includes attributes such as build triggers, input parameters, and source code. When deployed, the BuildConfig object typically builds a runnable image and pushes it to a container image registry.
			</p><p>
				OpenShift Builds provides the following extensible support for build strategies:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Docker build
					</li><li class="listitem">
						Source-to-image (S2I) build
					</li><li class="listitem">
						Custom build
					</li></ul></div><p>
				For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#understanding-image-builds">Understanding image builds</a>
			</p></section><section class="section" id="openshift-pipelines"><div class="titlepage"><div><div><h2 class="title">1.2. OpenShift Pipelines</h2></div></div></div><p>
				OpenShift Pipelines provides a Kubernetes-native CI/CD framework to design and run each step of the CI/CD pipeline in its own container. It can scale independently to meet the on-demand pipelines with predictable outcomes.
			</p><p>
				For more information, see <a class="link" href="https://docs.openshift.com/pipelines/latest/about/understanding-openshift-pipelines.html">Understanding OpenShift Pipelines</a>.
			</p></section><section class="section" id="openshift-gitops"><div class="titlepage"><div><div><h2 class="title">1.3. OpenShift GitOps</h2></div></div></div><p>
				OpenShift GitOps is an Operator that uses Argo CD as the declarative GitOps engine. It enables GitOps workflows across multicluster OpenShift and Kubernetes infrastructure. Using OpenShift GitOps, administrators can consistently configure and deploy Kubernetes-based infrastructure and applications across clusters and development lifecycles.
			</p><p>
				For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#about-redhat-openshift-gitops">About Red Hat OpenShift GitOps</a>.
			</p></section><section class="section" id="jenkins-ci-cd"><div class="titlepage"><div><div><h2 class="title">1.4. Jenkins</h2></div></div></div><p>
				Jenkins automates the process of building, testing, and deploying applications and projects. OpenShift Developer Tools provides a Jenkins image that integrates directly with the OpenShift Container Platform. Jenkins can be deployed on OpenShift by using the Samples Operator templates or certified Helm chart.
			</p></section></section><section class="chapter" id="builds"><div class="titlepage"><div><div><h1 class="title">Chapter 2. Builds</h1></div></div></div><section class="section" id="understanding-image-builds"><div class="titlepage"><div><div><h2 class="title">2.1. Understanding image builds</h2></div></div></div><section class="section" id="builds-about_understanding-image-builds"><div class="titlepage"><div><div><h3 class="title">2.1.1. Builds</h3></div></div></div><p>
					A build is the process of transforming input parameters into a resulting object. Most often, the process is used to transform input parameters or source code into a runnable image. A <code class="literal">BuildConfig</code> object is the definition of the entire build process.
				</p><p>
					OpenShift Container Platform uses Kubernetes by creating containers from build images and pushing them to a container image registry.
				</p><p>
					Build objects share common characteristics including inputs for a build, the requirement to complete a build process, logging the build process, publishing resources from successful builds, and publishing the final status of the build. Builds take advantage of resource restrictions, specifying limitations on resources such as CPU usage, memory usage, and build or pod execution time.
				</p><p>
					The OpenShift Container Platform build system provides extensible support for build strategies that are based on selectable types specified in the build API. There are three primary build strategies available:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Docker build
						</li><li class="listitem">
							Source-to-image (S2I) build
						</li><li class="listitem">
							Custom build
						</li></ul></div><p>
					By default, docker builds and S2I builds are supported.
				</p><p>
					The resulting object of a build depends on the builder used to create it. For docker and S2I builds, the resulting objects are runnable images. For custom builds, the resulting objects are whatever the builder image author has specified.
				</p><p>
					Additionally, the pipeline build strategy can be used to implement sophisticated workflows:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Continuous integration
						</li><li class="listitem">
							Continuous deployment
						</li></ul></div><section class="section" id="builds-strategy-docker-build_understanding-image-builds"><div class="titlepage"><div><div><h4 class="title">2.1.1.1. Docker build</h4></div></div></div><p>
						OpenShift Container Platform uses Buildah to build a container image from a Dockerfile. For more information on building container images with Dockerfiles, see <a class="link" href="https://docs.docker.com/engine/reference/builder/">the Dockerfile reference documentation</a>.
					</p><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
						If you set Docker build arguments by using the <code class="literal">buildArgs</code> array, see <a class="link" href="https://docs.docker.com/engine/reference/builder/#understand-how-arg-and-from-interact">Understand how ARG and FROM interact</a> in the Dockerfile reference documentation.
					</p></div></div></section><section class="section" id="builds-strategy-s2i-build_understanding-image-builds"><div class="titlepage"><div><div><h4 class="title">2.1.1.2. Source-to-image build</h4></div></div></div><p>
						Source-to-image (S2I) is a tool for building reproducible container images. It produces ready-to-run images by injecting application source into a container image and assembling a new image. The new image incorporates the base image, the builder, and built source and is ready to use with the <code class="literal">buildah run</code> command. S2I supports incremental builds, which re-use previously downloaded dependencies, previously built artifacts, and so on.
					</p></section><section class="section" id="builds-strategy-custom-build_understanding-image-builds"><div class="titlepage"><div><div><h4 class="title">2.1.1.3. Custom build</h4></div></div></div><p>
						The custom build strategy allows developers to define a specific builder image responsible for the entire build process. Using your own builder image allows you to customize your build process.
					</p><p>
						A custom builder image is a plain container image embedded with build process logic, for example for building RPMs or base images.
					</p><p>
						Custom builds run with a high level of privilege and are not available to users by default. Only users who can be trusted with cluster administration permissions should be granted access to run custom builds.
					</p></section><section class="section" id="builds-strategy-pipeline-build_understanding-image-builds"><div class="titlepage"><div><div><h4 class="title">2.1.1.4. Pipeline build</h4></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							The Pipeline build strategy is deprecated in OpenShift Container Platform 4. Equivalent and improved functionality is present in the OpenShift Container Platform Pipelines based on Tekton.
						</p><p>
							Jenkins images on OpenShift Container Platform are fully supported and users should follow Jenkins user documentation for defining their <code class="literal">jenkinsfile</code> in a job or store it in a Source Control Management system.
						</p></div></div><p>
						The Pipeline build strategy allows developers to define a Jenkins pipeline for use by the Jenkins pipeline plugin. The build can be started, monitored, and managed by OpenShift Container Platform in the same way as any other build type.
					</p><p>
						Pipeline workflows are defined in a <code class="literal">jenkinsfile</code>, either embedded directly in the build configuration, or supplied in a Git repository and referenced by the build configuration.
					</p></section></section></section><section class="section" id="understanding-buildconfigs"><div class="titlepage"><div><div><h2 class="title">2.2. Understanding build configurations</h2></div></div></div><p>
				The following sections define the concept of a build, build configuration, and outline the primary build strategies available.
			</p><section class="section" id="builds-buildconfig_understanding-builds"><div class="titlepage"><div><div><h3 class="title">2.2.1. BuildConfigs</h3></div></div></div><p>
					A build configuration describes a single build definition and a set of triggers for when a new build is created. Build configurations are defined by a <code class="literal">BuildConfig</code>, which is a REST object that can be used in a POST to the API server to create a new instance.
				</p><p>
					A build configuration, or <code class="literal">BuildConfig</code>, is characterized by a build strategy and one or more sources. The strategy determines the process, while the sources provide its input.
				</p><p>
					Depending on how you choose to create your application using OpenShift Container Platform, a <code class="literal">BuildConfig</code> is typically generated automatically for you if you use the web console or CLI, and it can be edited at any time. Understanding the parts that make up a <code class="literal">BuildConfig</code> and their available options can help if you choose to manually change your configuration later.
				</p><p>
					The following example <code class="literal">BuildConfig</code> results in a new build every time a container image tag or the source code changes:
				</p><div class="formalpara"><p class="title"><strong><code class="literal">BuildConfig</code> object definition</strong></p><p>
						
<pre class="programlisting language-yaml">kind: BuildConfig
apiVersion: build.openshift.io/v1
metadata:
  name: "ruby-sample-build" <span id="CO1-1"><!--Empty--></span><span class="callout">1</span>
spec:
  runPolicy: "Serial" <span id="CO1-2"><!--Empty--></span><span class="callout">2</span>
  triggers: <span id="CO1-3"><!--Empty--></span><span class="callout">3</span>
    -
      type: "GitHub"
      github:
        secret: "secret101"
    - type: "Generic"
      generic:
        secret: "secret101"
    -
      type: "ImageChange"
  source: <span id="CO1-4"><!--Empty--></span><span class="callout">4</span>
    git:
      uri: "https://github.com/openshift/ruby-hello-world"
  strategy: <span id="CO1-5"><!--Empty--></span><span class="callout">5</span>
    sourceStrategy:
      from:
        kind: "ImageStreamTag"
        name: "ruby-20-centos7:latest"
  output: <span id="CO1-6"><!--Empty--></span><span class="callout">6</span>
    to:
      kind: "ImageStreamTag"
      name: "origin-ruby-sample:latest"
  postCommit: <span id="CO1-7"><!--Empty--></span><span class="callout">7</span>
      script: "bundle exec rake test"</pre>

					</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO1-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							This specification creates a new <code class="literal">BuildConfig</code> named <code class="literal">ruby-sample-build</code>.
						</div></dd><dt><a href="#CO1-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							The <code class="literal">runPolicy</code> field controls whether builds created from this build configuration can be run simultaneously. The default value is <code class="literal">Serial</code>, which means new builds run sequentially, not simultaneously.
						</div></dd><dt><a href="#CO1-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							You can specify a list of triggers, which cause a new build to be created.
						</div></dd><dt><a href="#CO1-4"><span class="callout">4</span></a> </dt><dd><div class="para">
							The <code class="literal">source</code> section defines the source of the build. The source type determines the primary source of input, and can be either <code class="literal">Git</code>, to point to a code repository location, <code class="literal">Dockerfile</code>, to build from an inline Dockerfile, or <code class="literal">Binary</code>, to accept binary payloads. It is possible to have multiple sources at once. See the documentation for each source type for details.
						</div></dd><dt><a href="#CO1-5"><span class="callout">5</span></a> </dt><dd><div class="para">
							The <code class="literal">strategy</code> section describes the build strategy used to execute the build. You can specify a <code class="literal">Source</code> , <code class="literal">Docker</code>, or <code class="literal">Custom</code> strategy here. This example uses the <code class="literal">ruby-20-centos7</code> container image that Source-to-image (S2I) uses for the application build.
						</div></dd><dt><a href="#CO1-6"><span class="callout">6</span></a> </dt><dd><div class="para">
							After the container image is successfully built, it is pushed into the repository described in the <code class="literal">output</code> section.
						</div></dd><dt><a href="#CO1-7"><span class="callout">7</span></a> </dt><dd><div class="para">
							The <code class="literal">postCommit</code> section defines an optional build hook.
						</div></dd></dl></div></section></section><section class="section" id="creating-build-inputs"><div class="titlepage"><div><div><h2 class="title">2.3. Creating build inputs</h2></div></div></div><p>
				Use the following sections for an overview of build inputs, instructions on how to use inputs to provide source content for builds to operate on, and how to use build environments and create secrets.
			</p><section class="section" id="builds-define-build-inputs_creating-build-inputs"><div class="titlepage"><div><div><h3 class="title">2.3.1. Build inputs</h3></div></div></div><p>
					A build input provides source content for builds to operate on. You can use the following build inputs to provide sources in OpenShift Container Platform, listed in order of precedence:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Inline Dockerfile definitions
						</li><li class="listitem">
							Content extracted from existing images
						</li><li class="listitem">
							Git repositories
						</li><li class="listitem">
							Binary (Local) inputs
						</li><li class="listitem">
							Input secrets
						</li><li class="listitem">
							External artifacts
						</li></ul></div><p>
					You can combine multiple inputs in a single build. However, as the inline Dockerfile takes precedence, it can overwrite any other file named Dockerfile provided by another input. Binary (local) input and Git repositories are mutually exclusive inputs.
				</p><p>
					You can use input secrets when you do not want certain resources or credentials used during a build to be available in the final application image produced by the build, or want to consume a value that is defined in a secret resource. External artifacts can be used to pull in additional files that are not available as one of the other build input types.
				</p><p>
					When you run a build:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							A working directory is constructed and all input content is placed in the working directory. For example, the input Git repository is cloned into the working directory, and files specified from input images are copied into the working directory using the target path.
						</li><li class="listitem">
							The build process changes directories into the <code class="literal">contextDir</code>, if one is defined.
						</li><li class="listitem">
							The inline Dockerfile, if any, is written to the current directory.
						</li><li class="listitem">
							The content from the current directory is provided to the build process for reference by the Dockerfile, custom builder logic, or <code class="literal">assemble</code> script. This means any input content that resides outside the <code class="literal">contextDir</code> is ignored by the build.
						</li></ol></div><p>
					The following example of a source definition includes multiple input types and an explanation of how they are combined. For more details on how each input type is defined, see the specific sections for each input type.
				</p><pre class="programlisting language-yaml">source:
  git:
    uri: https://github.com/openshift/ruby-hello-world.git <span id="CO2-1"><!--Empty--></span><span class="callout">1</span>
    ref: "master"
  images:
  - from:
      kind: ImageStreamTag
      name: myinputimage:latest
      namespace: mynamespace
    paths:
    - destinationDir: app/dir/injected/dir <span id="CO2-2"><!--Empty--></span><span class="callout">2</span>
      sourcePath: /usr/lib/somefile.jar
  contextDir: "app/dir" <span id="CO2-3"><!--Empty--></span><span class="callout">3</span>
  dockerfile: "FROM centos:7\nRUN yum install -y httpd" <span id="CO2-4"><!--Empty--></span><span class="callout">4</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO2-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							The repository to be cloned into the working directory for the build.
						</div></dd><dt><a href="#CO2-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							<code class="literal">/usr/lib/somefile.jar</code> from <code class="literal">myinputimage</code> is stored in <code class="literal">&lt;workingdir&gt;/app/dir/injected/dir</code>.
						</div></dd><dt><a href="#CO2-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							The working directory for the build becomes <code class="literal">&lt;original_workingdir&gt;/app/dir</code>.
						</div></dd><dt><a href="#CO2-4"><span class="callout">4</span></a> </dt><dd><div class="para">
							A Dockerfile with this content is created in <code class="literal">&lt;original_workingdir&gt;/app/dir</code>, overwriting any existing file with that name.
						</div></dd></dl></div></section><section class="section" id="builds-dockerfile-source_creating-build-inputs"><div class="titlepage"><div><div><h3 class="title">2.3.2. Dockerfile source</h3></div></div></div><p>
					When you supply a <code class="literal">dockerfile</code> value, the content of this field is written to disk as a file named <code class="literal">dockerfile</code>. This is done after other input sources are processed, so if the input source repository contains a Dockerfile in the root directory, it is overwritten with this content.
				</p><p>
					The source definition is part of the <code class="literal">spec</code> section in the <code class="literal">BuildConfig</code>:
				</p><pre class="programlisting language-yaml">source:
  dockerfile: "FROM centos:7\nRUN yum install -y httpd" <span id="CO3-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO3-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							The <code class="literal">dockerfile</code> field contains an inline Dockerfile that is built.
						</div></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							The typical use for this field is to provide a Dockerfile to a docker strategy build.
						</li></ul></div></section><section class="section" id="builds-image-source_creating-build-inputs"><div class="titlepage"><div><div><h3 class="title">2.3.3. Image source</h3></div></div></div><p>
					You can add additional files to the build process with images. Input images are referenced in the same way the <code class="literal">From</code> and <code class="literal">To</code> image targets are defined. This means both container images and image stream tags can be referenced. In conjunction with the image, you must provide one or more path pairs to indicate the path of the files or directories to copy the image and the destination to place them in the build context.
				</p><p>
					The source path can be any absolute path within the image specified. The destination must be a relative directory path. At build time, the image is loaded and the indicated files and directories are copied into the context directory of the build process. This is the same directory into which the source repository content is cloned. If the source path ends in <code class="literal">/.</code> then the content of the directory is copied, but the directory itself is not created at the destination.
				</p><p>
					Image inputs are specified in the <code class="literal">source</code> definition of the <code class="literal">BuildConfig</code>:
				</p><pre class="programlisting language-yaml">source:
  git:
    uri: https://github.com/openshift/ruby-hello-world.git
    ref: "master"
  images: <span id="CO4-1"><!--Empty--></span><span class="callout">1</span>
  - from: <span id="CO4-2"><!--Empty--></span><span class="callout">2</span>
      kind: ImageStreamTag
      name: myinputimage:latest
      namespace: mynamespace
    paths: <span id="CO4-3"><!--Empty--></span><span class="callout">3</span>
    - destinationDir: injected/dir <span id="CO4-4"><!--Empty--></span><span class="callout">4</span>
      sourcePath: /usr/lib/somefile.jar <span id="CO4-5"><!--Empty--></span><span class="callout">5</span>
  - from:
      kind: ImageStreamTag
      name: myotherinputimage:latest
      namespace: myothernamespace
    pullSecret: mysecret <span id="CO4-6"><!--Empty--></span><span class="callout">6</span>
    paths:
    - destinationDir: injected/dir
      sourcePath: /usr/lib/somefile.jar</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO4-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							An array of one or more input images and files.
						</div></dd><dt><a href="#CO4-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							A reference to the image containing the files to be copied.
						</div></dd><dt><a href="#CO4-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							An array of source/destination paths.
						</div></dd><dt><a href="#CO4-4"><span class="callout">4</span></a> </dt><dd><div class="para">
							The directory relative to the build root where the build process can access the file.
						</div></dd><dt><a href="#CO4-5"><span class="callout">5</span></a> </dt><dd><div class="para">
							The location of the file to be copied out of the referenced image.
						</div></dd><dt><a href="#CO4-6"><span class="callout">6</span></a> </dt><dd><div class="para">
							An optional secret provided if credentials are needed to access the input image.
						</div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								If your cluster uses an <code class="literal">ImageDigestMirrorSet</code> or <code class="literal">ImageTagMirrorSet</code> object to configure repository mirroring, you can use only global pull secrets for mirrored registries. You cannot add a pull secret to a project.
							</p></div></div></dd></dl></div><div class="formalpara"><p class="title"><strong>Images that require pull secrets</strong></p><p>
						When using an input image that requires a pull secret, you can link the pull secret to the service account used by the build. By default, builds use the <code class="literal">builder</code> service account. The pull secret is automatically added to the build if the secret contains a credential that matches the repository hosting the input image. To link a pull secret to the service account used by the build, run:
					</p></div><pre class="programlisting language-terminal">$ oc secrets link builder dockerhub</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						This feature is not supported for builds using the custom strategy.
					</p></div></div><div class="formalpara"><p class="title"><strong>Images on mirrored registries that require pull secrets</strong></p><p>
						When using an input image from a mirrored registry, if you get a <code class="literal">build error: failed to pull image</code> message, you can resolve the error by using either of the following methods:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Create an input secret that contains the authentication credentials for the builder image’s repository and all known mirrors. In this case, create a pull secret for credentials to the image registry and its mirrors.
						</li><li class="listitem">
							Use the input secret as the pull secret on the <code class="literal">BuildConfig</code> object.
						</li></ul></div></section><section class="section" id="builds-source-code_creating-build-inputs"><div class="titlepage"><div><div><h3 class="title">2.3.4. Git source</h3></div></div></div><p>
					When specified, source code is fetched from the supplied location.
				</p><p>
					If you supply an inline Dockerfile, it overwrites the Dockerfile in the <code class="literal">contextDir</code> of the Git repository.
				</p><p>
					The source definition is part of the <code class="literal">spec</code> section in the <code class="literal">BuildConfig</code>:
				</p><pre class="programlisting language-yaml">source:
  git: <span id="CO5-1"><!--Empty--></span><span class="callout">1</span>
    uri: "https://github.com/openshift/ruby-hello-world"
    ref: "master"
  contextDir: "app/dir" <span id="CO5-2"><!--Empty--></span><span class="callout">2</span>
  dockerfile: "FROM openshift/ruby-22-centos7\nUSER example" <span id="CO5-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO5-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							The <code class="literal">git</code> field contains the Uniform Resource Identifier (URI) to the remote Git repository of the source code. You must specify the value of the <code class="literal">ref</code> field to check out a specific Git reference. A valid <code class="literal">ref</code> can be a SHA1 tag or a branch name. The default value of the <code class="literal">ref</code> field is <code class="literal">master</code>.
						</div></dd><dt><a href="#CO5-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							The <code class="literal">contextDir</code> field allows you to override the default location inside the source code repository where the build looks for the application source code. If your application exists inside a sub-directory, you can override the default location (the root folder) using this field.
						</div></dd><dt><a href="#CO5-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							If the optional <code class="literal">dockerfile</code> field is provided, it should be a string containing a Dockerfile that overwrites any Dockerfile that may exist in the source repository.
						</div></dd></dl></div><p>
					If the <code class="literal">ref</code> field denotes a pull request, the system uses a <code class="literal">git fetch</code> operation and then checkout <code class="literal">FETCH_HEAD</code>.
				</p><p>
					When no <code class="literal">ref</code> value is provided, OpenShift Container Platform performs a shallow clone (<code class="literal">--depth=1</code>). In this case, only the files associated with the most recent commit on the default branch (typically <code class="literal">master</code>) are downloaded. This results in repositories downloading faster, but without the full commit history. To perform a full <code class="literal">git clone</code> of the default branch of a specified repository, set <code class="literal">ref</code> to the name of the default branch (for example <code class="literal">main</code>).
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Git clone operations that go through a proxy that is performing man in the middle (MITM) TLS hijacking or reencrypting of the proxied connection do not work.
					</p></div></div><section class="section" id="builds-using-proxy-git-cloning_creating-build-inputs"><div class="titlepage"><div><div><h4 class="title">2.3.4.1. Using a proxy</h4></div></div></div><p>
						If your Git repository can only be accessed using a proxy, you can define the proxy to use in the <code class="literal">source</code> section of the build configuration. You can configure both an HTTP and HTTPS proxy to use. Both fields are optional. Domains for which no proxying should be performed can also be specified in the <code class="literal">NoProxy</code> field.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Your source URI must use the HTTP or HTTPS protocol for this to work.
						</p></div></div><pre class="programlisting language-yaml">source:
  git:
    uri: "https://github.com/openshift/ruby-hello-world"
    ref: "master"
    httpProxy: http://proxy.example.com
    httpsProxy: https://proxy.example.com
    noProxy: somedomain.com, otherdomain.com</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							For Pipeline strategy builds, given the current restrictions with the Git plugin for Jenkins, any Git operations through the Git plugin do not leverage the HTTP or HTTPS proxy defined in the <code class="literal">BuildConfig</code>. The Git plugin only uses the proxy configured in the Jenkins UI at the Plugin Manager panel. This proxy is then used for all git interactions within Jenkins, across all jobs.
						</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								You can find instructions on how to configure proxies through the Jenkins UI at <a class="link" href="https://wiki.jenkins-ci.org/display/JENKINS/JenkinsBehindProxy">JenkinsBehindProxy</a>.
							</li></ul></div></section><section class="section" id="builds-adding-source-clone-secrets_creating-build-inputs"><div class="titlepage"><div><div><h4 class="title">2.3.4.2. Source Clone Secrets</h4></div></div></div><p>
						Builder pods require access to any Git repositories defined as source for a build. Source clone secrets are used to provide the builder pod with access it would not normally have access to, such as private repositories or repositories with self-signed or untrusted SSL certificates.
					</p><p>
						The following source clone secret configurations are supported:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								.gitconfig File
							</li><li class="listitem">
								Basic Authentication
							</li><li class="listitem">
								SSH Key Authentication
							</li><li class="listitem">
								Trusted Certificate Authorities
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You can also use combinations of these configurations to meet your specific needs.
						</p></div></div><section class="section" id="builds-automatically-add-source-clone-secrets_creating-build-inputs"><div class="titlepage"><div><div><h5 class="title">2.3.4.2.1. Automatically adding a source clone secret to a build configuration</h5></div></div></div><p>
							When a <code class="literal">BuildConfig</code> is created, OpenShift Container Platform can automatically populate its source clone secret reference. This behavior allows the resulting builds to automatically use the credentials stored in the referenced secret to authenticate to a remote Git repository, without requiring further configuration.
						</p><p>
							To use this functionality, a secret containing the Git repository credentials must exist in the namespace in which the <code class="literal">BuildConfig</code> is later created. This secrets must include one or more annotations prefixed with <code class="literal">build.openshift.io/source-secret-match-uri-</code>. The value of each of these annotations is a Uniform Resource Identifier (URI) pattern, which is defined as follows. When a <code class="literal">BuildConfig</code> is created without a source clone secret reference and its Git source URI matches a URI pattern in a secret annotation, OpenShift Container Platform automatically inserts a reference to that secret in the <code class="literal">BuildConfig</code>.
						</p><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
								A URI pattern must consist of:
							</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									A valid scheme: <code class="literal">*://</code>, <code class="literal">git://</code>, <code class="literal">http://</code>, <code class="literal">https://</code> or <code class="literal">ssh://</code>
								</li><li class="listitem">
									A host: *` or a valid hostname or IP address optionally preceded by <code class="literal">*.</code>
								</li><li class="listitem">
									A path: <code class="literal">/*</code> or <code class="literal">/</code> followed by any characters optionally including <code class="literal">*</code> characters
								</li></ul></div><p>
							In all of the above, a <code class="literal">*</code> character is interpreted as a wildcard.
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								URI patterns must match Git source URIs which are conformant to <a class="link" href="https://www.ietf.org/rfc/rfc3986.txt">RFC3986</a>. Do not include a username (or password) component in a URI pattern.
							</p><p>
								For example, if you use <code class="literal">ssh://git@bitbucket.atlassian.com:7999/ATLASSIAN jira.git</code> for a git repository URL, the source secret must be specified as <code class="literal">ssh://bitbucket.atlassian.com:7999/*</code> (and not <code class="literal">ssh://git@bitbucket.atlassian.com:7999/*</code>).
							</p><pre class="programlisting language-terminal">$ oc annotate secret mysecret \
    'build.openshift.io/source-secret-match-uri-1=ssh://bitbucket.atlassian.com:7999/*'</pre></div></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
								If multiple secrets match the Git URI of a particular <code class="literal">BuildConfig</code>, OpenShift Container Platform selects the secret with the longest match. This allows for basic overriding, as in the following example.
							</p></div><p>
							The following fragment shows two partial source clone secrets, the first matching any server in the domain <code class="literal">mycorp.com</code> accessed by HTTPS, and the second overriding access to servers <code class="literal">mydev1.mycorp.com</code> and <code class="literal">mydev2.mycorp.com</code>:
						</p><pre class="programlisting language-yaml">kind: Secret
apiVersion: v1
metadata:
  name: matches-all-corporate-servers-https-only
  annotations:
    build.openshift.io/source-secret-match-uri-1: https://*.mycorp.com/*
data:
  ...
---
kind: Secret
apiVersion: v1
metadata:
  name: override-for-my-dev-servers-https-only
  annotations:
    build.openshift.io/source-secret-match-uri-1: https://mydev1.mycorp.com/*
    build.openshift.io/source-secret-match-uri-2: https://mydev2.mycorp.com/*
data:
  ...</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Add a <code class="literal">build.openshift.io/source-secret-match-uri-</code> annotation to a pre-existing secret using:
								</p><pre class="programlisting language-terminal">$ oc annotate secret mysecret \
    'build.openshift.io/source-secret-match-uri-1=https://*.mycorp.com/*'</pre></li></ul></div></section><section class="section" id="builds-manually-add-source-clone-secrets_creating-build-inputs"><div class="titlepage"><div><div><h5 class="title">2.3.4.2.2. Manually adding a source clone secret</h5></div></div></div><p>
							Source clone secrets can be added manually to a build configuration by adding a <code class="literal">sourceSecret</code> field to the <code class="literal">source</code> section inside the <code class="literal">BuildConfig</code> and setting it to the name of the secret that you created. In this example, it is the <code class="literal">basicsecret</code>.
						</p><pre class="programlisting language-yaml">apiVersion: "v1"
kind: "BuildConfig"
metadata:
  name: "sample-build"
spec:
  output:
    to:
      kind: "ImageStreamTag"
      name: "sample-image:latest"
  source:
    git:
      uri: "https://github.com/user/app.git"
    sourceSecret:
      name: "basicsecret"
  strategy:
    sourceStrategy:
      from:
        kind: "ImageStreamTag"
        name: "python-33-centos7:latest"</pre><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
								You can also use the <code class="literal">oc set build-secret</code> command to set the source clone secret on an existing build configuration.
							</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To set the source clone secret on an existing build configuration, enter the following command:
								</p><pre class="programlisting language-terminal">$ oc set build-secret --source bc/sample-build basicsecret</pre></li></ul></div></section><section class="section" id="builds-gitconfig-file_creating-build-inputs"><div class="titlepage"><div><div><h5 class="title">2.3.4.2.3. Creating a secret from a .gitconfig file</h5></div></div></div><p>
							If the cloning of your application is dependent on a <code class="literal">.gitconfig</code> file, then you can create a secret that contains it. Add it to the builder service account and then your <code class="literal">BuildConfig</code>.
						</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									To create a secret from a <code class="literal">.gitconfig</code> file:
								</li></ul></div><pre class="programlisting language-terminal">$ oc create secret generic &lt;secret_name&gt; --from-file=&lt;path/to/.gitconfig&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								SSL verification can be turned off if <code class="literal">sslVerify=false</code> is set for the <code class="literal">http</code> section in your <code class="literal">.gitconfig</code> file:
							</p><pre class="programlisting language-text">[http]
        sslVerify=false</pre></div></div></section><section class="section" id="builds-gitconfig-file-secured-git_creating-build-inputs"><div class="titlepage"><div><div><h5 class="title">2.3.4.2.4. Creating a secret from a .gitconfig file for secured Git</h5></div></div></div><p>
							If your Git server is secured with two-way SSL and user name with password, you must add the certificate files to your source build and add references to the certificate files in the <code class="literal">.gitconfig</code> file.
						</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									You must have Git credentials.
								</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
								Add the certificate files to your source build and add references to the certificate files in the <code class="literal">.gitconfig</code> file.
							</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
									Add the <code class="literal">client.crt</code>, <code class="literal">cacert.crt</code>, and <code class="literal">client.key</code> files to the <code class="literal">/var/run/secrets/openshift.io/source/</code> folder in the application source code.
								</li><li class="listitem"><p class="simpara">
									In the <code class="literal">.gitconfig</code> file for the server, add the <code class="literal">[http]</code> section shown in the following example:
								</p><pre class="programlisting language-terminal"># cat .gitconfig</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">[user]
        name = &lt;name&gt;
        email = &lt;email&gt;
[http]
        sslVerify = false
        sslCert = /var/run/secrets/openshift.io/source/client.crt
        sslKey = /var/run/secrets/openshift.io/source/client.key
        sslCaInfo = /var/run/secrets/openshift.io/source/cacert.crt</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Create the secret:
								</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;secret_name&gt; \
--from-literal=username=&lt;user_name&gt; \ <span id="CO6-1"><!--Empty--></span><span class="callout">1</span>
--from-literal=password=&lt;password&gt; \ <span id="CO6-2"><!--Empty--></span><span class="callout">2</span>
--from-file=.gitconfig=.gitconfig \
--from-file=client.crt=/var/run/secrets/openshift.io/source/client.crt \
--from-file=cacert.crt=/var/run/secrets/openshift.io/source/cacert.crt \
--from-file=client.key=/var/run/secrets/openshift.io/source/client.key</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO6-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											The user’s Git user name.
										</div></dd><dt><a href="#CO6-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											The password for this user.
										</div></dd></dl></div></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								To avoid having to enter your password again, be sure to specify the source-to-image (S2I) image in your builds. However, if you cannot clone the repository, you must still specify your user name and password to promote the build.
							</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
									<code class="literal">/var/run/secrets/openshift.io/source/</code> folder in the application source code.
								</li></ul></div></section><section class="section" id="builds-source-secret-basic-auth_creating-build-inputs"><div class="titlepage"><div><div><h5 class="title">2.3.4.2.5. Creating a secret from source code basic authentication</h5></div></div></div><p>
							Basic authentication requires either a combination of <code class="literal">--username</code> and <code class="literal">--password</code>, or a token to authenticate against the software configuration management (SCM) server.
						</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									User name and password to access the private repository.
								</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Create the secret first before using the <code class="literal">--username</code> and <code class="literal">--password</code> to access the private repository:
								</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;secret_name&gt; \
    --from-literal=username=&lt;user_name&gt; \
    --from-literal=password=&lt;password&gt; \
    --type=kubernetes.io/basic-auth</pre></li><li class="listitem"><p class="simpara">
									Create a basic authentication secret with a token:
								</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;secret_name&gt; \
    --from-literal=password=&lt;token&gt; \
    --type=kubernetes.io/basic-auth</pre></li></ol></div></section><section class="section" id="builds-source-secret-ssh-key-auth_creating-build-inputs"><div class="titlepage"><div><div><h5 class="title">2.3.4.2.6. Creating a secret from source code SSH key authentication</h5></div></div></div><p>
							SSH key based authentication requires a private SSH key.
						</p><p>
							The repository keys are usually located in the <code class="literal">$HOME/.ssh/</code> directory, and are named <code class="literal">id_dsa.pub</code>, <code class="literal">id_ecdsa.pub</code>, <code class="literal">id_ed25519.pub</code>, or <code class="literal">id_rsa.pub</code> by default.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Generate SSH key credentials:
								</p><pre class="programlisting language-terminal">$ ssh-keygen -t ed25519 -C "your_email@example.com"</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Creating a passphrase for the SSH key prevents OpenShift Container Platform from building. When prompted for a passphrase, leave it blank.
									</p></div></div><p class="simpara">
									Two files are created: the public key and a corresponding private key (one of <code class="literal">id_dsa</code>, <code class="literal">id_ecdsa</code>, <code class="literal">id_ed25519</code>, or <code class="literal">id_rsa</code>). With both of these in place, consult your source control management (SCM) system’s manual on how to upload the public key. The private key is used to access your private repository.
								</p></li><li class="listitem"><p class="simpara">
									Before using the SSH key to access the private repository, create the secret:
								</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;secret_name&gt; \
    --from-file=ssh-privatekey=&lt;path/to/ssh/private/key&gt; \
    --from-file=&lt;path/to/known_hosts&gt; \ <span id="CO7-1"><!--Empty--></span><span class="callout">1</span>
    --type=kubernetes.io/ssh-auth</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO7-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Optional: Adding this field enables strict server host key check.
										</div></dd></dl></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
										Skipping the <code class="literal">known_hosts</code> file while creating the secret makes the build vulnerable to a potential man-in-the-middle (MITM) attack.
									</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Ensure that the <code class="literal">known_hosts</code> file includes an entry for the host of your source code.
									</p></div></div></li></ol></div></section><section class="section" id="builds-source-secret-trusted-ca_creating-build-inputs"><div class="titlepage"><div><div><h5 class="title">2.3.4.2.7. Creating a secret from source code trusted certificate authorities</h5></div></div></div><p>
							The set of Transport Layer Security (TLS) certificate authorities (CA) that are trusted during a Git clone operation are built into the OpenShift Container Platform infrastructure images. If your Git server uses a self-signed certificate or one signed by an authority not trusted by the image, you can create a secret that contains the certificate or disable TLS verification.
						</p><p>
							If you create a secret for the CA certificate, OpenShift Container Platform uses it to access your Git server during the Git clone operation. Using this method is significantly more secure than disabling Git SSL verification, which accepts any TLS certificate that is presented.
						</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
								Create a secret with a CA certificate file.
							</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									If your CA uses Intermediate Certificate Authorities, combine the certificates for all CAs in a <code class="literal">ca.crt</code> file. Enter the following command:
								</p><pre class="programlisting language-terminal">$ cat intermediateCA.crt intermediateCA.crt rootCA.crt &gt; ca.crt</pre><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Create the secret:
										</p><pre class="programlisting language-terminal">$ oc create secret generic mycert --from-file=ca.crt=&lt;/path/to/file&gt; <span id="CO8-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO8-1"><span class="callout">1</span></a> </dt><dd><div class="para">
													You must use the key name <code class="literal">ca.crt</code>.
												</div></dd></dl></div></li></ol></div></li></ol></div></section><section class="section" id="builds-source-secret-combinations_creating-build-inputs"><div class="titlepage"><div><div><h5 class="title">2.3.4.2.8. Source secret combinations</h5></div></div></div><p>
							You can combine the different methods for creating source clone secrets for your specific needs.
						</p><section class="section" id="builds-source-secret-combinations-ssh-gitconfig_creating-build-inputs"><div class="titlepage"><div><div><h6 class="title">2.3.4.2.8.1. Creating a SSH-based authentication secret with a <code class="literal">.gitconfig</code> file</h6></div></div></div><p>
								You can combine the different methods for creating source clone secrets for your specific needs, such as a SSH-based authentication secret with a <code class="literal">.gitconfig</code> file.
							</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
										SSH authentication
									</li><li class="listitem">
										.gitconfig file
									</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										To create a SSH-based authentication secret with a <code class="literal">.gitconfig</code> file, run:
									</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;secret_name&gt; \
    --from-file=ssh-privatekey=&lt;path/to/ssh/private/key&gt; \
    --from-file=&lt;path/to/.gitconfig&gt; \
    --type=kubernetes.io/ssh-auth</pre></li></ul></div></section><section class="section" id="builds-source-secret-combinations-gitconfig-ca_creating-build-inputs"><div class="titlepage"><div><div><h6 class="title">2.3.4.2.8.2. Creating a secret that combines a .gitconfig file and CA certificate</h6></div></div></div><p>
								You can combine the different methods for creating source clone secrets for your specific needs, such as a secret that combines a <code class="literal">.gitconfig</code> file and certificate authority (CA) certificate.
							</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
										.gitconfig file
									</li><li class="listitem">
										CA certificate
									</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										To create a secret that combines a <code class="literal">.gitconfig</code> file and CA certificate, run:
									</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;secret_name&gt; \
    --from-file=ca.crt=&lt;path/to/certificate&gt; \
    --from-file=&lt;path/to/.gitconfig&gt;</pre></li></ul></div></section><section class="section" id="builds-source-secret-combinations-basic-auth-ca_creating-build-inputs"><div class="titlepage"><div><div><h6 class="title">2.3.4.2.8.3. Creating a basic authentication secret with a CA certificate</h6></div></div></div><p>
								You can combine the different methods for creating source clone secrets for your specific needs, such as a secret that combines a basic authentication and certificate authority (CA) certificate.
							</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
										Basic authentication credentials
									</li><li class="listitem">
										CA certificate
									</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Create a basic authentication secret with a CA certificate, run:
									</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;secret_name&gt; \
    --from-literal=username=&lt;user_name&gt; \
    --from-literal=password=&lt;password&gt; \
    --from-file=ca-cert=&lt;/path/to/file&gt; \
    --type=kubernetes.io/basic-auth</pre></li></ul></div></section><section class="section" id="builds-source-secret-combinations-basic-auth-gitconfig_creating-build-inputs"><div class="titlepage"><div><div><h6 class="title">2.3.4.2.8.4. Creating a basic authentication secret with a .gitconfig file</h6></div></div></div><p>
								You can combine the different methods for creating source clone secrets for your specific needs, such as a secret that combines a basic authentication and <code class="literal">.gitconfig</code> file.
							</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
										Basic authentication credentials
									</li><li class="listitem">
										<code class="literal">.gitconfig</code> file
									</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										To create a basic authentication secret with a <code class="literal">.gitconfig</code> file, run:
									</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;secret_name&gt; \
    --from-literal=username=&lt;user_name&gt; \
    --from-literal=password=&lt;password&gt; \
    --from-file=&lt;/path/to/.gitconfig&gt; \
    --type=kubernetes.io/basic-auth</pre></li></ul></div></section><section class="section" id="builds-source-secret-combinations-basic-auth-gitconfig-ca_creating-build-inputs"><div class="titlepage"><div><div><h6 class="title">2.3.4.2.8.5. Creating a basic authentication secret with a .gitconfig file and CA certificate</h6></div></div></div><p>
								You can combine the different methods for creating source clone secrets for your specific needs, such as a secret that combines a basic authentication, <code class="literal">.gitconfig</code> file, and certificate authority (CA) certificate.
							</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
										Basic authentication credentials
									</li><li class="listitem">
										<code class="literal">.gitconfig</code> file
									</li><li class="listitem">
										CA certificate
									</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										To create a basic authentication secret with a <code class="literal">.gitconfig</code> file and CA certificate, run:
									</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;secret_name&gt; \
    --from-literal=username=&lt;user_name&gt; \
    --from-literal=password=&lt;password&gt; \
    --from-file=&lt;/path/to/.gitconfig&gt; \
    --from-file=ca-cert=&lt;/path/to/file&gt; \
    --type=kubernetes.io/basic-auth</pre></li></ul></div></section></section></section></section><section class="section" id="builds-binary-source_creating-build-inputs"><div class="titlepage"><div><div><h3 class="title">2.3.5. Binary (local) source</h3></div></div></div><p>
					Streaming content from a local file system to the builder is called a <code class="literal">Binary</code> type build. The corresponding value of <code class="literal">BuildConfig.spec.source.type</code> is <code class="literal">Binary</code> for these builds.
				</p><p>
					This source type is unique in that it is leveraged solely based on your use of the <code class="literal">oc start-build</code>.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Binary type builds require content to be streamed from the local file system, so automatically triggering a binary type build, like an image change trigger, is not possible. This is because the binary files cannot be provided. Similarly, you cannot launch binary type builds from the web console.
					</p></div></div><p>
					To utilize binary builds, invoke <code class="literal">oc start-build</code> with one of these options:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">--from-file</code>: The contents of the file you specify are sent as a binary stream to the builder. You can also specify a URL to a file. Then, the builder stores the data in a file with the same name at the top of the build context.
						</li><li class="listitem">
							<code class="literal">--from-dir</code> and <code class="literal">--from-repo</code>: The contents are archived and sent as a binary stream to the builder. Then, the builder extracts the contents of the archive within the build context directory. With <code class="literal">--from-dir</code>, you can also specify a URL to an archive, which is extracted.
						</li><li class="listitem">
							<code class="literal">--from-archive</code>: The archive you specify is sent to the builder, where it is extracted within the build context directory. This option behaves the same as <code class="literal">--from-dir</code>; an archive is created on your host first, whenever the argument to these options is a directory.
						</li></ul></div><p>
					In each of the previously listed cases:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If your <code class="literal">BuildConfig</code> already has a <code class="literal">Binary</code> source type defined, it is effectively ignored and replaced by what the client sends.
						</li><li class="listitem">
							If your <code class="literal">BuildConfig</code> has a <code class="literal">Git</code> source type defined, it is dynamically disabled, since <code class="literal">Binary</code> and <code class="literal">Git</code> are mutually exclusive, and the data in the binary stream provided to the builder takes precedence.
						</li></ul></div><p>
					Instead of a file name, you can pass a URL with HTTP or HTTPS schema to <code class="literal">--from-file</code> and <code class="literal">--from-archive</code>. When using <code class="literal">--from-file</code> with a URL, the name of the file in the builder image is determined by the <code class="literal">Content-Disposition</code> header sent by the web server, or the last component of the URL path if the header is not present. No form of authentication is supported and it is not possible to use custom TLS certificate or disable certificate validation.
				</p><p>
					When using <code class="literal">oc new-build --binary=true</code>, the command ensures that the restrictions associated with binary builds are enforced. The resulting <code class="literal">BuildConfig</code> has a source type of <code class="literal">Binary</code>, meaning that the only valid way to run a build for this <code class="literal">BuildConfig</code> is to use <code class="literal">oc start-build</code> with one of the <code class="literal">--from</code> options to provide the requisite binary data.
				</p><p>
					The Dockerfile and <code class="literal">contextDir</code> source options have special meaning with binary builds.
				</p><p>
					Dockerfile can be used with any binary build source. If Dockerfile is used and the binary stream is an archive, its contents serve as a replacement Dockerfile to any Dockerfile in the archive. If Dockerfile is used with the <code class="literal">--from-file</code> argument, and the file argument is named Dockerfile, the value from Dockerfile replaces the value from the binary stream.
				</p><p>
					In the case of the binary stream encapsulating extracted archive content, the value of the <code class="literal">contextDir</code> field is interpreted as a subdirectory within the archive, and, if valid, the builder changes into that subdirectory before executing the build.
				</p></section><section class="section" id="builds-input-secrets-configmaps_creating-build-inputs"><div class="titlepage"><div><div><h3 class="title">2.3.6. Input secrets and config maps</h3></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						To prevent the contents of input secrets and config maps from appearing in build output container images, use build volumes in your <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#builds-using-build-volumes_build-strategies-docker">Docker build</a> and <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#builds-using-build-volumes_build-strategies-s2i">source-to-image build</a> strategies.
					</p></div></div><p>
					In some scenarios, build operations require credentials or other configuration data to access dependent resources, but it is undesirable for that information to be placed in source control. You can define input secrets and input config maps for this purpose.
				</p><p>
					For example, when building a Java application with Maven, you can set up a private mirror of Maven Central or JCenter that is accessed by private keys. To download libraries from that private mirror, you have to supply the following:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							A <code class="literal">settings.xml</code> file configured with the mirror’s URL and connection settings.
						</li><li class="listitem">
							A private key referenced in the settings file, such as <code class="literal">~/.ssh/id_rsa</code>.
						</li></ol></div><p>
					For security reasons, you do not want to expose your credentials in the application image.
				</p><p>
					This example describes a Java application, but you can use the same approach for adding SSL certificates into the <code class="literal">/etc/ssl/certs</code> directory, API keys or tokens, license files, and more.
				</p><section class="section" id="builds-secrets-overview_creating-build-inputs"><div class="titlepage"><div><div><h4 class="title">2.3.6.1. What is a secret?</h4></div></div></div><p>
						The <code class="literal">Secret</code> object type provides a mechanism to hold sensitive information such as passwords, OpenShift Container Platform client configuration files, <code class="literal">dockercfg</code> files, private source repository credentials, and so on. Secrets decouple sensitive content from the pods. You can mount secrets into containers using a volume plugin or the system can use secrets to perform actions on behalf of a pod.
					</p><div class="formalpara"><p class="title"><strong>YAML Secret Object Definition</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: v1
kind: Secret
metadata:
  name: test-secret
  namespace: my-namespace
type: Opaque <span id="CO9-1"><!--Empty--></span><span class="callout">1</span>
data: <span id="CO9-2"><!--Empty--></span><span class="callout">2</span>
  username: &lt;username&gt; <span id="CO9-3"><!--Empty--></span><span class="callout">3</span>
  password: &lt;password&gt;
stringData: <span id="CO9-4"><!--Empty--></span><span class="callout">4</span>
  hostname: myapp.mydomain.com <span id="CO9-5"><!--Empty--></span><span class="callout">5</span></pre>

						</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO9-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Indicates the structure of the secret’s key names and values.
							</div></dd><dt><a href="#CO9-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								The allowable format for the keys in the <code class="literal">data</code> field must meet the guidelines in the <code class="literal">DNS_SUBDOMAIN</code> value in the Kubernetes identifiers glossary.
							</div></dd><dt><a href="#CO9-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								The value associated with keys in the <code class="literal">data</code> map must be base64 encoded.
							</div></dd><dt><a href="#CO9-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								Entries in the <code class="literal">stringData</code> map are converted to base64 and the entry are then moved to the <code class="literal">data</code> map automatically. This field is write-only. The value is only be returned by the <code class="literal">data</code> field.
							</div></dd><dt><a href="#CO9-5"><span class="callout">5</span></a> </dt><dd><div class="para">
								The value associated with keys in the <code class="literal">stringData</code> map is made up of plain text strings.
							</div></dd></dl></div><section class="section" id="builds-secrets-overview-properties_creating-build-inputs"><div class="titlepage"><div><div><h5 class="title">2.3.6.1.1. Properties of secrets</h5></div></div></div><p>
							Key properties include:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Secret data can be referenced independently from its definition.
								</li><li class="listitem">
									Secret data volumes are backed by temporary file-storage facilities (tmpfs) and never come to rest on a node.
								</li><li class="listitem">
									Secret data can be shared within a namespace.
								</li></ul></div></section><section class="section" id="builds-secrets-overview-types_creating-build-inputs"><div class="titlepage"><div><div><h5 class="title">2.3.6.1.2. Types of Secrets</h5></div></div></div><p>
							The value in the <code class="literal">type</code> field indicates the structure of the secret’s key names and values. The type can be used to enforce the presence of user names and keys in the secret object. If you do not want validation, use the <code class="literal">opaque</code> type, which is the default.
						</p><p>
							Specify one of the following types to trigger minimal server-side validation to ensure the presence of specific key names in the secret data:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">kubernetes.io/service-account-token</code>. Uses a service account token.
								</li><li class="listitem">
									<code class="literal">kubernetes.io/dockercfg</code>. Uses the <code class="literal">.dockercfg</code> file for required Docker credentials.
								</li><li class="listitem">
									<code class="literal">kubernetes.io/dockerconfigjson</code>. Uses the <code class="literal">.docker/config.json</code> file for required Docker credentials.
								</li><li class="listitem">
									<code class="literal">kubernetes.io/basic-auth</code>. Use with basic authentication.
								</li><li class="listitem">
									<code class="literal">kubernetes.io/ssh-auth</code>. Use with SSH key authentication.
								</li><li class="listitem">
									<code class="literal">kubernetes.io/tls</code>. Use with TLS certificate authorities.
								</li></ul></div><p>
							Specify <code class="literal">type= Opaque</code> if you do not want validation, which means the secret does not claim to conform to any convention for key names or values. An <code class="literal">opaque</code> secret, allows for unstructured <code class="literal">key:value</code> pairs that can contain arbitrary values.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								You can specify other arbitrary types, such as <code class="literal">example.com/my-secret-type</code>. These types are not enforced server-side, but indicate that the creator of the secret intended to conform to the key/value requirements of that type.
							</p></div></div></section><section class="section" id="builds-secrets-overview-updates_creating-build-inputs"><div class="titlepage"><div><div><h5 class="title">2.3.6.1.3. Updates to secrets</h5></div></div></div><p>
							When you modify the value of a secret, the value used by an already running pod does not dynamically change. To change a secret, you must delete the original pod and create a new pod, in some cases with an identical <code class="literal">PodSpec</code>.
						</p><p>
							Updating a secret follows the same workflow as deploying a new container image. You can use the <code class="literal">kubectl rolling-update</code> command.
						</p><p>
							The <code class="literal">resourceVersion</code> value in a secret is not specified when it is referenced. Therefore, if a secret is updated at the same time as pods are starting, the version of the secret that is used for the pod is not defined.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Currently, it is not possible to check the resource version of a secret object that was used when a pod was created. It is planned that pods report this information, so that a controller could restart ones using an old <code class="literal">resourceVersion</code>. In the interim, do not update the data of existing secrets, but create new ones with distinct names.
							</p></div></div></section></section><section class="section" id="builds-creating-secrets_creating-build-inputs"><div class="titlepage"><div><div><h4 class="title">2.3.6.2. Creating secrets</h4></div></div></div><p>
						You must create a secret before creating the pods that depend on that secret.
					</p><p>
						When creating secrets:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Create a secret object with secret data.
							</li><li class="listitem">
								Update the pod service account to allow the reference to the secret.
							</li><li class="listitem">
								Create a pod, which consumes the secret as an environment variable or as a file using a <code class="literal">secret</code> volume.
							</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Use the create command to create a secret object from a JSON or YAML file:
							</p><pre class="programlisting language-terminal">$ oc create -f &lt;filename&gt;</pre><p class="simpara">
								For example, you can create a secret from your local <code class="literal">.docker/config.json</code> file:
							</p><pre class="programlisting language-terminal">$ oc create secret generic dockerhub \
    --from-file=.dockerconfigjson=&lt;path/to/.docker/config.json&gt; \
    --type=kubernetes.io/dockerconfigjson</pre><p class="simpara">
								This command generates a JSON specification of the secret named <code class="literal">dockerhub</code> and creates the object.
							</p><div class="formalpara"><p class="title"><strong>YAML Opaque Secret Object Definition</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: v1
kind: Secret
metadata:
  name: mysecret
type: Opaque <span id="CO10-1"><!--Empty--></span><span class="callout">1</span>
data:
  username: &lt;username&gt;
  password: &lt;password&gt;</pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO10-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Specifies an <span class="emphasis"><em>opaque</em></span> secret.
									</div></dd></dl></div><div class="formalpara"><p class="title"><strong>Docker Configuration JSON File Secret Object Definition</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: v1
kind: Secret
metadata:
  name: aregistrykey
  namespace: myapps
type: kubernetes.io/dockerconfigjson <span id="CO11-1"><!--Empty--></span><span class="callout">1</span>
data:
  .dockerconfigjson:bm5ubm5ubm5ubm5ubm5ubm5ubm5ubmdnZ2dnZ2dnZ2dnZ2dnZ2dnZ2cgYXV0aCBrZXlzCg== <span id="CO11-2"><!--Empty--></span><span class="callout">2</span></pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO11-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Specifies that the secret is using a docker configuration JSON file.
									</div></dd><dt><a href="#CO11-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										The output of a base64-encoded the docker configuration JSON file
									</div></dd></dl></div></li></ul></div></section><section class="section" id="builds-using-secrets_creating-build-inputs"><div class="titlepage"><div><div><h4 class="title">2.3.6.3. Using secrets</h4></div></div></div><p>
						After creating secrets, you can create a pod to reference your secret, get logs, and delete the pod.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create the pod to reference your secret:
							</p><pre class="programlisting language-terminal">$ oc create -f &lt;your_yaml_file&gt;.yaml</pre></li><li class="listitem"><p class="simpara">
								Get the logs:
							</p><pre class="programlisting language-terminal">$ oc logs secret-example-pod</pre></li><li class="listitem"><p class="simpara">
								Delete the pod:
							</p><pre class="programlisting language-terminal">$ oc delete pod secret-example-pod</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem"><p class="simpara">
								Example YAML files with secret data:
							</p><div class="formalpara"><p class="title"><strong>YAML Secret That Will Create Four Files</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: v1
kind: Secret
metadata:
  name: test-secret
data:
  username: &lt;username&gt; <span id="CO12-1"><!--Empty--></span><span class="callout">1</span>
  password: &lt;password&gt; <span id="CO12-2"><!--Empty--></span><span class="callout">2</span>
stringData:
  hostname: myapp.mydomain.com <span id="CO12-3"><!--Empty--></span><span class="callout">3</span>
  secret.properties: |-     <span id="CO12-4"><!--Empty--></span><span class="callout">4</span>
    property1=valueA
    property2=valueB</pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO12-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										File contains decoded values.
									</div></dd><dt><a href="#CO12-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										File contains decoded values.
									</div></dd><dt><a href="#CO12-3"><span class="callout">3</span></a> </dt><dd><div class="para">
										File contains the provided string.
									</div></dd><dt><a href="#CO12-4"><span class="callout">4</span></a> </dt><dd><div class="para">
										File contains the provided data.
									</div></dd></dl></div><div class="formalpara"><p class="title"><strong>YAML of a pod populating files in a volume with secret data</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: v1
kind: Pod
metadata:
  name: secret-example-pod
spec:
  containers:
    - name: secret-test-container
      image: busybox
      command: [ "/bin/sh", "-c", "cat /etc/secret-volume/*" ]
      volumeMounts:
          # name must match the volume name below
          - name: secret-volume
            mountPath: /etc/secret-volume
            readOnly: true
  volumes:
    - name: secret-volume
      secret:
        secretName: test-secret
  restartPolicy: Never</pre>

								</p></div><div class="formalpara"><p class="title"><strong>YAML of a pod populating environment variables with secret data</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: v1
kind: Pod
metadata:
  name: secret-example-pod
spec:
  containers:
    - name: secret-test-container
      image: busybox
      command: [ "/bin/sh", "-c", "export" ]
      env:
        - name: TEST_SECRET_USERNAME_ENV_VAR
          valueFrom:
            secretKeyRef:
              name: test-secret
              key: username
  restartPolicy: Never</pre>

								</p></div><div class="formalpara"><p class="title"><strong>YAML of a Build Config Populating Environment Variables with Secret Data</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: build.openshift.io/v1
kind: BuildConfig
metadata:
  name: secret-example-bc
spec:
  strategy:
    sourceStrategy:
      env:
      - name: TEST_SECRET_USERNAME_ENV_VAR
        valueFrom:
          secretKeyRef:
            name: test-secret
            key: username</pre>

								</p></div></li></ul></div></section><section class="section" id="builds-adding-input-secrets-configmaps_creating-build-inputs"><div class="titlepage"><div><div><h4 class="title">2.3.6.4. Adding input secrets and config maps</h4></div></div></div><p>
						To provide credentials and other configuration data to a build without placing them in source control, you can define input secrets and input config maps.
					</p><p>
						In some scenarios, build operations require credentials or other configuration data to access dependent resources. To make that information available without placing it in source control, you can define input secrets and input config maps.
					</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							To add an input secret, config maps, or both to an existing <code class="literal">BuildConfig</code> object:
						</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create the <code class="literal">ConfigMap</code> object, if it does not exist:
							</p><pre class="programlisting language-terminal">$ oc create configmap settings-mvn \
    --from-file=settings.xml=&lt;path/to/settings.xml&gt;</pre><p class="simpara">
								This creates a new config map named <code class="literal">settings-mvn</code>, which contains the plain text content of the <code class="literal">settings.xml</code> file.
							</p><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
								You can alternatively apply the following YAML to create the config map:
							</p><pre class="programlisting language-yaml">apiVersion: core/v1
kind: ConfigMap
metadata:
  name: settings-mvn
data:
  settings.xml: |
    &lt;settings&gt;
    … # Insert maven settings here
    &lt;/settings&gt;</pre></div></div></li><li class="listitem"><p class="simpara">
								Create the <code class="literal">Secret</code> object, if it does not exist:
							</p><pre class="programlisting language-terminal">$ oc create secret generic secret-mvn \
    --from-file=ssh-privatekey=&lt;path/to/.ssh/id_rsa&gt;
    --type=kubernetes.io/ssh-auth</pre><p class="simpara">
								This creates a new secret named <code class="literal">secret-mvn</code>, which contains the base64 encoded content of the <code class="literal">id_rsa</code> private key.
							</p><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
								You can alternatively apply the following YAML to create the input secret:
							</p><pre class="programlisting language-yaml">apiVersion: core/v1
kind: Secret
metadata:
  name: secret-mvn
type: kubernetes.io/ssh-auth
data:
  ssh-privatekey: |
    # Insert ssh private key, base64 encoded</pre></div></div></li><li class="listitem"><p class="simpara">
								Add the config map and secret to the <code class="literal">source</code> section in the existing <code class="literal">BuildConfig</code> object:
							</p><pre class="programlisting language-yaml">source:
  git:
    uri: https://github.com/wildfly/quickstart.git
  contextDir: helloworld
  configMaps:
    - configMap:
        name: settings-mvn
  secrets:
    - secret:
        name: secret-mvn</pre></li></ol></div><p>
						To include the secret and config map in a new <code class="literal">BuildConfig</code> object, run the following command:
					</p><pre class="programlisting language-terminal">$ oc new-build \
    openshift/wildfly-101-centos7~https://github.com/wildfly/quickstart.git \
    --context-dir helloworld --build-secret “secret-mvn” \
    --build-config-map "settings-mvn"</pre><p>
						During the build, the <code class="literal">settings.xml</code> and <code class="literal">id_rsa</code> files are copied into the directory where the source code is located. In OpenShift Container Platform S2I builder images, this is the image working directory, which is set using the <code class="literal">WORKDIR</code> instruction in the <code class="literal">Dockerfile</code>. If you want to specify another directory, add a <code class="literal">destinationDir</code> to the definition:
					</p><pre class="programlisting language-yaml">source:
  git:
    uri: https://github.com/wildfly/quickstart.git
  contextDir: helloworld
  configMaps:
    - configMap:
        name: settings-mvn
      destinationDir: ".m2"
  secrets:
    - secret:
        name: secret-mvn
      destinationDir: ".ssh"</pre><p>
						You can also specify the destination directory when creating a new <code class="literal">BuildConfig</code> object:
					</p><pre class="programlisting language-terminal">$ oc new-build \
    openshift/wildfly-101-centos7~https://github.com/wildfly/quickstart.git \
    --context-dir helloworld --build-secret “secret-mvn:.ssh” \
    --build-config-map "settings-mvn:.m2"</pre><p>
						In both cases, the <code class="literal">settings.xml</code> file is added to the <code class="literal">./.m2</code> directory of the build environment, and the <code class="literal">id_rsa</code> key is added to the <code class="literal">./.ssh</code> directory.
					</p></section><section class="section" id="builds-source-to-image_creating-build-inputs"><div class="titlepage"><div><div><h4 class="title">2.3.6.5. Source-to-image strategy</h4></div></div></div><p>
						When using a <code class="literal">Source</code> strategy, all defined input secrets are copied to their respective <code class="literal">destinationDir</code>. If you left <code class="literal">destinationDir</code> empty, then the secrets are placed in the working directory of the builder image.
					</p><p>
						The same rule is used when a <code class="literal">destinationDir</code> is a relative path. The secrets are placed in the paths that are relative to the working directory of the image. The final directory in the <code class="literal">destinationDir</code> path is created if it does not exist in the builder image. All preceding directories in the <code class="literal">destinationDir</code> must exist, or an error will occur.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Input secrets are added as world-writable, have <code class="literal">0666</code> permissions, and are truncated to size zero after executing the <code class="literal">assemble</code> script. This means that the secret files exist in the resulting image, but they are empty for security reasons.
						</p><p>
							Input config maps are not truncated after the <code class="literal">assemble</code> script completes.
						</p></div></div></section><section class="section" id="builds-docker-strategy_creating-build-inputs"><div class="titlepage"><div><div><h4 class="title">2.3.6.6. Docker strategy</h4></div></div></div><p>
						When using a docker strategy, you can add all defined input secrets into your container image using the <a class="link" href="https://docs.docker.com/engine/reference/builder/#add"><code class="literal">ADD</code></a> and <a class="link" href="https://docs.docker.com/engine/reference/builder/#copy"><code class="literal">COPY</code> instructions</a> in your Dockerfile.
					</p><p>
						If you do not specify the <code class="literal">destinationDir</code> for a secret, then the files are copied into the same directory in which the Dockerfile is located. If you specify a relative path as <code class="literal">destinationDir</code>, then the secrets are copied into that directory, relative to your Dockerfile location. This makes the secret files available to the Docker build operation as part of the context directory used during the build.
					</p><div class="formalpara"><p class="title"><strong>Example of a Dockerfile referencing secret and config map data</strong></p><p>
							
<pre class="screen">FROM centos/ruby-22-centos7

USER root
COPY ./secret-dir /secrets
COPY ./config /

# Create a shell script that will output secrets and ConfigMaps when the image is run
RUN echo '#!/bin/sh' &gt; /input_report.sh
RUN echo '(test -f /secrets/secret1 &amp;&amp; echo -n "secret1=" &amp;&amp; cat /secrets/secret1)' &gt;&gt; /input_report.sh
RUN echo '(test -f /config &amp;&amp; echo -n "relative-configMap=" &amp;&amp; cat /config)' &gt;&gt; /input_report.sh
RUN chmod 755 /input_report.sh

CMD ["/bin/sh", "-c", "/input_report.sh"]</pre>

						</p></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Users normally remove their input secrets from the final application image so that the secrets are not present in the container running from that image. However, the secrets still exist in the image itself in the layer where they were added. This removal is part of the Dockerfile itself.
						</p><p>
							To prevent the contents of input secrets and config maps from appearing in the build output container images and avoid this removal process altogether, <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#builds-using-build-volumes_build-strategies-docker">use build volumes</a> in your Docker build strategy instead.
						</p></div></div></section><section class="section" id="builds-custom-strategy_creating-build-inputs"><div class="titlepage"><div><div><h4 class="title">2.3.6.7. Custom strategy</h4></div></div></div><p>
						When using a Custom strategy, all the defined input secrets and config maps are available in the builder container in the <code class="literal">/var/run/secrets/openshift.io/build</code> directory. The custom build image must use these secrets and config maps appropriately. With the Custom strategy, you can define secrets as described in Custom strategy options.
					</p><p>
						There is no technical difference between existing strategy secrets and the input secrets. However, your builder image can distinguish between them and use them differently, based on your build use case.
					</p><p>
						The input secrets are always mounted into the <code class="literal">/var/run/secrets/openshift.io/build</code> directory, or your builder can parse the <code class="literal">$BUILD</code> environment variable, which includes the full build object.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							If a pull secret for the registry exists in both the namespace and the node, builds default to using the pull secret in the namespace.
						</p></div></div></section></section><section class="section" id="builds-using-external-artifacts_creating-build-inputs"><div class="titlepage"><div><div><h3 class="title">2.3.7. External artifacts</h3></div></div></div><p>
					It is not recommended to store binary files in a source repository. Therefore, you must define a build which pulls additional files, such as Java <code class="literal">.jar</code> dependencies, during the build process. How this is done depends on the build strategy you are using.
				</p><p>
					For a Source build strategy, you must put appropriate shell commands into the <code class="literal">assemble</code> script:
				</p><div class="formalpara"><p class="title"><strong><code class="literal">.s2i/bin/assemble</code> File</strong></p><p>
						
<pre class="programlisting language-terminal">#!/bin/sh
APP_VERSION=1.0
wget http://repository.example.com/app/app-$APP_VERSION.jar -O app.jar</pre>

					</p></div><div class="formalpara"><p class="title"><strong><code class="literal">.s2i/bin/run</code> File</strong></p><p>
						
<pre class="programlisting language-terminal">#!/bin/sh
exec java -jar app.jar</pre>

					</p></div><p>
					For a Docker build strategy, you must modify the Dockerfile and invoke shell commands with the <a class="link" href="https://docs.docker.com/engine/reference/builder/#run"><code class="literal">RUN</code> instruction</a>:
				</p><div class="formalpara"><p class="title"><strong>Excerpt of Dockerfile</strong></p><p>
						
<pre class="programlisting language-terminal">FROM jboss/base-jdk:8

ENV APP_VERSION 1.0
RUN wget http://repository.example.com/app/app-$APP_VERSION.jar -O app.jar

EXPOSE 8080
CMD [ "java", "-jar", "app.jar" ]</pre>

					</p></div><p>
					In practice, you may want to use an environment variable for the file location so that the specific file to be downloaded can be customized using an environment variable defined on the <code class="literal">BuildConfig</code>, rather than updating the Dockerfile or <code class="literal">assemble</code> script.
				</p><p>
					You can choose between different methods of defining environment variables:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Using the <code class="literal">.s2i/environment</code> file] (only for a Source build strategy)
						</li><li class="listitem">
							Setting in <code class="literal">BuildConfig</code>
						</li><li class="listitem">
							Providing explicitly using <code class="literal">oc start-build --env</code> (only for builds that are triggered manually)
						</li></ul></div></section><section class="section" id="builds-docker-credentials-private-registries_creating-build-inputs"><div class="titlepage"><div><div><h3 class="title">2.3.8. Using docker credentials for private registries</h3></div></div></div><p>
					You can supply builds with a .<code class="literal">docker/config.json</code> file with valid credentials for private container registries. This allows you to push the output image into a private container image registry or pull a builder image from the private container image registry that requires authentication.
				</p><p>
					You can supply credentials for multiple repositories within the same registry, each with credentials specific to that registry path.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						For the OpenShift Container Platform container image registry, this is not required because secrets are generated automatically for you by OpenShift Container Platform.
					</p></div></div><p>
					The <code class="literal">.docker/config.json</code> file is found in your home directory by default and has the following format:
				</p><pre class="programlisting language-yaml">auths:
  index.docker.io/v1/: <span id="CO13-1"><!--Empty--></span><span class="callout">1</span>
    auth: "YWRfbGzhcGU6R2labnRib21ifTE=" <span id="CO13-2"><!--Empty--></span><span class="callout">2</span>
    email: "user@example.com" <span id="CO13-3"><!--Empty--></span><span class="callout">3</span>
  docker.io/my-namespace/my-user/my-image: <span id="CO13-4"><!--Empty--></span><span class="callout">4</span>
    auth: "GzhYWRGU6R2fbclabnRgbkSp=""
    email: "user@example.com"
  docker.io/my-namespace: <span id="CO13-5"><!--Empty--></span><span class="callout">5</span>
    auth: "GzhYWRGU6R2deesfrRgbkSp=""
    email: "user@example.com"</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO13-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							URL of the registry.
						</div></dd><dt><a href="#CO13-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							Encrypted password.
						</div></dd><dt><a href="#CO13-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							Email address for the login.
						</div></dd><dt><a href="#CO13-4"><span class="callout">4</span></a> </dt><dd><div class="para">
							URL and credentials for a specific image in a namespace.
						</div></dd><dt><a href="#CO13-5"><span class="callout">5</span></a> </dt><dd><div class="para">
							URL and credentials for a registry namespace.
						</div></dd></dl></div><p>
					You can define multiple container image registries or define multiple repositories in the same registry. Alternatively, you can also add authentication entries to this file by running the <code class="literal">docker login</code> command. The file will be created if it does not exist.
				</p><p>
					Kubernetes provides <code class="literal">Secret</code> objects, which can be used to store configuration and passwords.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You must have a <code class="literal">.docker/config.json</code> file.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create the secret from your local <code class="literal">.docker/config.json</code> file:
						</p><pre class="programlisting language-terminal">$ oc create secret generic dockerhub \
    --from-file=.dockerconfigjson=&lt;path/to/.docker/config.json&gt; \
    --type=kubernetes.io/dockerconfigjson</pre><p class="simpara">
							This generates a JSON specification of the secret named <code class="literal">dockerhub</code> and creates the object.
						</p></li><li class="listitem"><p class="simpara">
							Add a <code class="literal">pushSecret</code> field into the <code class="literal">output</code> section of the <code class="literal">BuildConfig</code> and set it to the name of the <code class="literal">secret</code> that you created, which in the previous example is <code class="literal">dockerhub</code>:
						</p><pre class="programlisting language-yaml">spec:
  output:
    to:
      kind: "DockerImage"
      name: "private.registry.com/org/private-image:latest"
    pushSecret:
      name: "dockerhub"</pre><p class="simpara">
							You can use the <code class="literal">oc set build-secret</code> command to set the push secret on the build configuration:
						</p><pre class="programlisting language-terminal">$ oc set build-secret --push bc/sample-build dockerhub</pre><p class="simpara">
							You can also link the push secret to the service account used by the build instead of specifying the <code class="literal">pushSecret</code> field. By default, builds use the <code class="literal">builder</code> service account. The push secret is automatically added to the build if the secret contains a credential that matches the repository hosting the build’s output image.
						</p><pre class="programlisting language-terminal">$ oc secrets link builder dockerhub</pre></li><li class="listitem"><p class="simpara">
							Pull the builder container image from a private container image registry by specifying the <code class="literal">pullSecret</code> field, which is part of the build strategy definition:
						</p><pre class="programlisting language-yaml">strategy:
  sourceStrategy:
    from:
      kind: "DockerImage"
      name: "docker.io/user/private_repository"
    pullSecret:
      name: "dockerhub"</pre><p class="simpara">
							You can use the <code class="literal">oc set build-secret</code> command to set the pull secret on the build configuration:
						</p><pre class="programlisting language-terminal">$ oc set build-secret --pull bc/sample-build dockerhub</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								This example uses <code class="literal">pullSecret</code> in a Source build, but it is also applicable in Docker and Custom builds.
							</p></div></div><p class="simpara">
							You can also link the pull secret to the service account used by the build instead of specifying the <code class="literal">pullSecret</code> field. By default, builds use the <code class="literal">builder</code> service account. The pull secret is automatically added to the build if the secret contains a credential that matches the repository hosting the build’s input image. To link the pull secret to the service account used by the build instead of specifying the <code class="literal">pullSecret</code> field, run:
						</p><pre class="programlisting language-terminal">$ oc secrets link builder dockerhub</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								You must specify a <code class="literal">from</code> image in the <code class="literal">BuildConfig</code> spec to take advantage of this feature. Docker strategy builds generated by <code class="literal">oc new-build</code> or <code class="literal">oc new-app</code> may not do this in some situations.
							</p></div></div></li></ol></div></section><section class="section" id="builds-build-environment_creating-build-inputs"><div class="titlepage"><div><div><h3 class="title">2.3.9. Build environments</h3></div></div></div><p>
					As with pod environment variables, build environment variables can be defined in terms of references to other resources or variables using the Downward API. There are some exceptions, which are noted.
				</p><p>
					You can also manage environment variables defined in the <code class="literal">BuildConfig</code> with the <code class="literal">oc set env</code> command.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Referencing container resources using <code class="literal">valueFrom</code> in build environment variables is not supported as the references are resolved before the container is created.
					</p></div></div><section class="section" id="builds-using-build-fields-as-environment-variables_creating-build-inputs"><div class="titlepage"><div><div><h4 class="title">2.3.9.1. Using build fields as environment variables</h4></div></div></div><p>
						You can inject information about the build object by setting the <code class="literal">fieldPath</code> environment variable source to the <code class="literal">JsonPath</code> of the field from which you are interested in obtaining the value.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Jenkins Pipeline strategy does not support <code class="literal">valueFrom</code> syntax for environment variables.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Set the <code class="literal">fieldPath</code> environment variable source to the <code class="literal">JsonPath</code> of the field from which you are interested in obtaining the value:
							</p><pre class="programlisting language-yaml">env:
  - name: FIELDREF_ENV
    valueFrom:
      fieldRef:
        fieldPath: metadata.name</pre></li></ul></div></section><section class="section" id="builds-using-secrets-as-environment-variables_creating-build-inputs"><div class="titlepage"><div><div><h4 class="title">2.3.9.2. Using secrets as environment variables</h4></div></div></div><p>
						You can make key values from secrets available as environment variables using the <code class="literal">valueFrom</code> syntax.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							This method shows the secrets as plain text in the output of the build pod console. To avoid this, use input secrets and config maps instead.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To use a secret as an environment variable, set the <code class="literal">valueFrom</code> syntax:
							</p><pre class="programlisting language-yaml">apiVersion: build.openshift.io/v1
kind: BuildConfig
metadata:
  name: secret-example-bc
spec:
  strategy:
    sourceStrategy:
      env:
      - name: MYVAL
        valueFrom:
          secretKeyRef:
            key: myval
            name: mysecret</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#builds-input-secrets-configmaps_creating-build-inputs">Input secrets and config maps</a>
							</li></ul></div></section></section><section class="section" id="builds-service-serving-certificate-secrets_creating-build-inputs"><div class="titlepage"><div><div><h3 class="title">2.3.10. Service serving certificate secrets</h3></div></div></div><p>
					Service serving certificate secrets are intended to support complex middleware applications that need out-of-the-box certificates. It has the same settings as the server certificates generated by the administrator tooling for nodes and masters.
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						To secure communication to your service, have the cluster generate a signed serving certificate/key pair into a secret in your namespace.
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Set the <code class="literal">service.beta.openshift.io/serving-cert-secret-name</code> annotation on your service with the value set to the name you want to use for your secret.
						</p><p class="simpara">
							Then, your <code class="literal">PodSpec</code> can mount that secret. When it is available, your pod runs. The certificate is good for the internal service DNS name, <code class="literal">&lt;service.name&gt;.&lt;service.namespace&gt;.svc</code>.
						</p><p class="simpara">
							The certificate and key are in PEM format, stored in <code class="literal">tls.crt</code> and <code class="literal">tls.key</code> respectively. The certificate/key pair is automatically replaced when it gets close to expiration. View the expiration date in the <code class="literal">service.beta.openshift.io/expiry</code> annotation on the secret, which is in RFC3339 format.
						</p></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						In most cases, the service DNS name <code class="literal">&lt;service.name&gt;.&lt;service.namespace&gt;.svc</code> is not externally routable. The primary use of <code class="literal">&lt;service.name&gt;.&lt;service.namespace&gt;.svc</code> is for intracluster or intraservice communication, and with re-encrypt routes.
					</p></div></div><p>
					Other pods can trust cluster-created certificates, which are only signed for internal DNS names, by using the certificate authority (CA) bundle in the <code class="literal">/var/run/secrets/kubernetes.io/serviceaccount/service-ca.crt</code> file that is automatically mounted in their pod.
				</p><p>
					The signature algorithm for this feature is <code class="literal">x509.SHA256WithRSA</code>. To manually rotate, delete the generated secret. A new certificate is created.
				</p></section><section class="section" id="builds-secrets-restrictions_creating-build-inputs"><div class="titlepage"><div><div><h3 class="title">2.3.11. Secrets restrictions</h3></div></div></div><p>
					To use a secret, a pod needs to reference the secret. A secret can be used with a pod in three ways:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							To populate environment variables for containers.
						</li><li class="listitem">
							As files in a volume mounted on one or more of its containers.
						</li><li class="listitem">
							By kubelet when pulling images for the pod.
						</li></ul></div><p>
					Volume type secrets write data into the container as a file using the volume mechanism. <code class="literal">imagePullSecrets</code> use service accounts for the automatic injection of the secret into all pods in a namespaces.
				</p><p>
					When a template contains a secret definition, the only way for the template to use the provided secret is to ensure that the secret volume sources are validated and that the specified object reference actually points to an object of type <code class="literal">Secret</code>. Therefore, a secret needs to be created before any pods that depend on it. The most effective way to ensure this is to have it get injected automatically through the use of a service account.
				</p><p>
					Secret API objects reside in a namespace. They can only be referenced by pods in that same namespace.
				</p><p>
					Individual secrets are limited to 1MB in size. This is to discourage the creation of large secrets that would exhaust apiserver and kubelet memory. However, creation of a number of smaller secrets could also exhaust memory.
				</p></section></section><section class="section" id="managing-build-output"><div class="titlepage"><div><div><h2 class="title">2.4. Managing build output</h2></div></div></div><p>
				Use the following sections for an overview of and instructions for managing build output.
			</p><section class="section" id="builds-docker-source-build-output_managing-build-output"><div class="titlepage"><div><div><h3 class="title">2.4.1. Build output</h3></div></div></div><p>
					Builds that use the docker or source-to-image (S2I) strategy result in the creation of a new container image. The image is then pushed to the container image registry specified in the <code class="literal">output</code> section of the <code class="literal">Build</code> specification.
				</p><p>
					If the output kind is <code class="literal">ImageStreamTag</code>, then the image will be pushed to the integrated OpenShift image registry and tagged in the specified imagestream. If the output is of type <code class="literal">DockerImage</code>, then the name of the output reference will be used as a docker push specification. The specification may contain a registry or will default to DockerHub if no registry is specified. If the output section of the build specification is empty, then the image will not be pushed at the end of the build.
				</p><div class="formalpara"><p class="title"><strong>Output to an ImageStreamTag</strong></p><p>
						
<pre class="programlisting language-yaml">spec:
  output:
    to:
      kind: "ImageStreamTag"
      name: "sample-image:latest"</pre>

					</p></div><div class="formalpara"><p class="title"><strong>Output to a docker Push Specification</strong></p><p>
						
<pre class="programlisting language-yaml">spec:
  output:
    to:
      kind: "DockerImage"
      name: "my-registry.mycompany.com:5000/myimages/myimage:tag"</pre>

					</p></div></section><section class="section" id="builds-output-image-environment-variables_managing-build-output"><div class="titlepage"><div><div><h3 class="title">2.4.2. Output image environment variables</h3></div></div></div><p>
					docker and source-to-image (S2I) strategy builds set the following environment variables on output images:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140458474103920" scope="col">Variable</th><th align="left" valign="top" id="idm140458474102832" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140458474103920"> <p>
									<code class="literal">OPENSHIFT_BUILD_NAME</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458474102832"> <p>
									Name of the build
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458474103920"> <p>
									<code class="literal">OPENSHIFT_BUILD_NAMESPACE</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458474102832"> <p>
									Namespace of the build
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458474103920"> <p>
									<code class="literal">OPENSHIFT_BUILD_SOURCE</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458474102832"> <p>
									The source URL of the build
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458474103920"> <p>
									<code class="literal">OPENSHIFT_BUILD_REFERENCE</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458474102832"> <p>
									The Git reference used in the build
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458474103920"> <p>
									<code class="literal">OPENSHIFT_BUILD_COMMIT</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458474102832"> <p>
									Source commit used in the build
								</p>
								 </td></tr></tbody></table></div><p>
					Additionally, any user-defined environment variable, for example those configured with S2I] or docker strategy options, will also be part of the output image environment variable list.
				</p></section><section class="section" id="builds-output-image-labels_managing-build-output"><div class="titlepage"><div><div><h3 class="title">2.4.3. Output image labels</h3></div></div></div><p>
					docker and source-to-image (S2I)` builds set the following labels on output images:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140458473693488" scope="col">Label</th><th align="left" valign="top" id="idm140458473692400" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140458473693488"> <p>
									<code class="literal">io.openshift.build.commit.author</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458473692400"> <p>
									Author of the source commit used in the build
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458473693488"> <p>
									<code class="literal">io.openshift.build.commit.date</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458473692400"> <p>
									Date of the source commit used in the build
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458473693488"> <p>
									<code class="literal">io.openshift.build.commit.id</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458473692400"> <p>
									Hash of the source commit used in the build
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458473693488"> <p>
									<code class="literal">io.openshift.build.commit.message</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458473692400"> <p>
									Message of the source commit used in the build
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458473693488"> <p>
									<code class="literal">io.openshift.build.commit.ref</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458473692400"> <p>
									Branch or reference specified in the source
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458473693488"> <p>
									<code class="literal">io.openshift.build.source-location</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458473692400"> <p>
									Source URL for the build
								</p>
								 </td></tr></tbody></table></div><p>
					You can also use the <code class="literal">BuildConfig.spec.output.imageLabels</code> field to specify a list of custom labels that will be applied to each image built from the build configuration.
				</p><div class="formalpara"><p class="title"><strong>Custom Labels to be Applied to Built Images</strong></p><p>
						
<pre class="programlisting language-yaml">spec:
  output:
    to:
      kind: "ImageStreamTag"
      name: "my-image:latest"
    imageLabels:
    - name: "vendor"
      value: "MyCompany"
    - name: "authoritative-source-url"
      value: "registry.mycompany.com"</pre>

					</p></div></section></section><section class="section" id="build-strategies"><div class="titlepage"><div><div><h2 class="title">2.5. Using build strategies</h2></div></div></div><p>
				The following sections define the primary supported build strategies, and how to use them.
			</p><section class="section" id="builds-strategy-docker-build_build-strategies"><div class="titlepage"><div><div><h3 class="title">2.5.1. Docker build</h3></div></div></div><p>
					OpenShift Container Platform uses Buildah to build a container image from a Dockerfile. For more information on building container images with Dockerfiles, see <a class="link" href="https://docs.docker.com/engine/reference/builder/">the Dockerfile reference documentation</a>.
				</p><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
					If you set Docker build arguments by using the <code class="literal">buildArgs</code> array, see <a class="link" href="https://docs.docker.com/engine/reference/builder/#understand-how-arg-and-from-interact">Understand how ARG and FROM interact</a> in the Dockerfile reference documentation.
				</p></div></div><section class="section" id="builds-strategy-docker-from-image_build-strategies"><div class="titlepage"><div><div><h4 class="title">2.5.1.1. Replacing Dockerfile FROM image</h4></div></div></div><p>
						You can replace the <code class="literal">FROM</code> instruction of the Dockerfile with the <code class="literal">from</code> of the <code class="literal">BuildConfig</code> object. If the Dockerfile uses multi-stage builds, the image in the last <code class="literal">FROM</code> instruction will be replaced.
					</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							To replace the <code class="literal">FROM</code> instruction of the Dockerfile with the <code class="literal">from</code> of the <code class="literal">BuildConfig</code>.
						</p></div><pre class="programlisting language-yaml">strategy:
  dockerStrategy:
    from:
      kind: "ImageStreamTag"
      name: "debian:latest"</pre></section><section class="section" id="builds-strategy-dockerfile-path_build-strategies"><div class="titlepage"><div><div><h4 class="title">2.5.1.2. Using Dockerfile path</h4></div></div></div><p>
						By default, docker builds use a Dockerfile located at the root of the context specified in the <code class="literal">BuildConfig.spec.source.contextDir</code> field.
					</p><p>
						The <code class="literal">dockerfilePath</code> field allows the build to use a different path to locate your Dockerfile, relative to the <code class="literal">BuildConfig.spec.source.contextDir</code> field. It can be a different file name than the default Dockerfile, such as <code class="literal">MyDockerfile</code>, or a path to a Dockerfile in a subdirectory, such as <code class="literal">dockerfiles/app1/Dockerfile</code>.
					</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							To use the <code class="literal">dockerfilePath</code> field for the build to use a different path to locate your Dockerfile, set:
						</p></div><pre class="programlisting language-yaml">strategy:
  dockerStrategy:
    dockerfilePath: dockerfiles/app1/Dockerfile</pre></section><section class="section" id="builds-strategy-docker-environment-variables_build-strategies"><div class="titlepage"><div><div><h4 class="title">2.5.1.3. Using docker environment variables</h4></div></div></div><p>
						To make environment variables available to the docker build process and resulting image, you can add environment variables to the <code class="literal">dockerStrategy</code> definition of the build configuration.
					</p><p>
						The environment variables defined there are inserted as a single <code class="literal">ENV</code> Dockerfile instruction right after the <code class="literal">FROM</code> instruction, so that it can be referenced later on within the Dockerfile.
					</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							The variables are defined during build and stay in the output image, therefore they will be present in any container that runs that image as well.
						</p></div><p>
						For example, defining a custom HTTP proxy to be used during build and runtime:
					</p><pre class="programlisting language-yaml">dockerStrategy:
...
  env:
    - name: "HTTP_PROXY"
      value: "http://myproxy.net:5187/"</pre><p>
						You can also manage environment variables defined in the build configuration with the <code class="literal">oc set env</code> command.
					</p></section><section class="section" id="builds-strategy-docker-build-arguments_build-strategies"><div class="titlepage"><div><div><h4 class="title">2.5.1.4. Adding docker build arguments</h4></div></div></div><p>
						You can set <a class="link" href="http://docs.docker.com/v1.7/reference/api/hub_registry_spec/#docker-registry-1-0">docker build arguments</a> using the <code class="literal">buildArgs</code> array. The build arguments are passed to docker when a build is started.
					</p><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
						See <a class="link" href="https://docs.docker.com/engine/reference/builder/#understand-how-arg-and-from-interact">Understand how ARG and FROM interact</a> in the Dockerfile reference documentation.
					</p></div></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							To set docker build arguments, add entries to the <code class="literal">buildArgs</code> array, which is located in the <code class="literal">dockerStrategy</code> definition of the <code class="literal">BuildConfig</code> object. For example:
						</p></div><pre class="programlisting language-yaml">dockerStrategy:
...
  buildArgs:
    - name: "foo"
      value: "bar"</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Only the <code class="literal">name</code> and <code class="literal">value</code> fields are supported. Any settings on the <code class="literal">valueFrom</code> field are ignored.
						</p></div></div></section><section class="section" id="builds-strategy-docker-squash-layers_build-strategies"><div class="titlepage"><div><div><h4 class="title">2.5.1.5. Squashing layers with docker builds</h4></div></div></div><p>
						Docker builds normally create a layer representing each instruction in a Dockerfile. Setting the <code class="literal">imageOptimizationPolicy</code> to <code class="literal">SkipLayers</code> merges all instructions into a single layer on top of the base image.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Set the <code class="literal">imageOptimizationPolicy</code> to <code class="literal">SkipLayers</code>:
							</p><pre class="programlisting language-yaml">strategy:
  dockerStrategy:
    imageOptimizationPolicy: SkipLayers</pre></li></ul></div></section><section class="section" id="builds-using-build-volumes_build-strategies-docker"><div class="titlepage"><div><div><h4 class="title">2.5.1.6. Using build volumes</h4></div></div></div><p>
						You can mount build volumes to give running builds access to information that you don’t want to persist in the output container image.
					</p><p>
						Build volumes provide sensitive information, such as repository credentials, that the build environment or configuration only needs at build time. Build volumes are different from <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#builds-define-build-inputs_creating-build-inputs">build inputs</a>, whose data can persist in the output container image.
					</p><p>
						The mount points of build volumes, from which the running build reads data, are functionally similar to <a class="link" href="https://kubernetes.io/docs/concepts/storage/volumes/">pod volume mounts</a>.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#builds-input-secrets-configmaps_creating-build-inputs">added an input secret, config map, or both to a BuildConfig object</a>.
							</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								In the <code class="literal">dockerStrategy</code> definition of the <code class="literal">BuildConfig</code> object, add any build volumes to the <code class="literal">volumes</code> array. For example:
							</p><pre class="programlisting language-yaml">spec:
  dockerStrategy:
    volumes:
      - name: secret-mvn <span id="CO14-1"><!--Empty--></span><span class="callout">1</span>
        mounts:
        - destinationPath: /opt/app-root/src/.ssh <span id="CO14-2"><!--Empty--></span><span class="callout">2</span>
        source:
          type: Secret <span id="CO14-3"><!--Empty--></span><span class="callout">3</span>
          secret:
            secretName: my-secret <span id="CO14-4"><!--Empty--></span><span class="callout">4</span>
      - name: settings-mvn <span id="CO14-5"><!--Empty--></span><span class="callout">5</span>
        mounts:
        - destinationPath: /opt/app-root/src/.m2  <span id="CO14-6"><!--Empty--></span><span class="callout">6</span>
        source:
          type: ConfigMap <span id="CO14-7"><!--Empty--></span><span class="callout">7</span>
          configMap:
            name: my-config <span id="CO14-8"><!--Empty--></span><span class="callout">8</span>
      - name: my-csi-volume <span id="CO14-9"><!--Empty--></span><span class="callout">9</span>
        mounts:
        - destinationPath: /opt/app-root/src/some_path  <span id="CO14-10"><!--Empty--></span><span class="callout">10</span>
        source:
          type: CSI <span id="CO14-11"><!--Empty--></span><span class="callout">11</span>
          csi:
            driver: csi.sharedresource.openshift.io <span id="CO14-12"><!--Empty--></span><span class="callout">12</span>
            readOnly: true <span id="CO14-13"><!--Empty--></span><span class="callout">13</span>
            volumeAttributes: <span id="CO14-14"><!--Empty--></span><span class="callout">14</span>
              attribute: value</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO14-1"><span class="callout">1</span></a> <a href="#CO14-5"><span class="callout">5</span></a> <a href="#CO14-9"><span class="callout">9</span></a> </dt><dd><div class="para">
										Required. A unique name.
									</div></dd><dt><a href="#CO14-2"><span class="callout">2</span></a> <a href="#CO14-6"><span class="callout">6</span></a> <a href="#CO14-10"><span class="callout">10</span></a> </dt><dd><div class="para">
										Required. The absolute path of the mount point. It must not contain <code class="literal">..</code> or <code class="literal">:</code> and doesn’t collide with the destination path generated by the builder. The <code class="literal">/opt/app-root/src</code> is the default home directory for many Red Hat S2I-enabled images.
									</div></dd><dt><a href="#CO14-3"><span class="callout">3</span></a> <a href="#CO14-7"><span class="callout">7</span></a> <a href="#CO14-11"><span class="callout">11</span></a> </dt><dd><div class="para">
										Required. The type of source, <code class="literal">ConfigMap</code>, <code class="literal">Secret</code>, or <code class="literal">CSI</code>.
									</div></dd><dt><a href="#CO14-4"><span class="callout">4</span></a> <a href="#CO14-8"><span class="callout">8</span></a> </dt><dd><div class="para">
										Required. The name of the source.
									</div></dd><dt><a href="#CO14-12"><span class="callout">12</span></a> </dt><dd><div class="para">
										Required. The driver that provides the ephemeral CSI volume.
									</div></dd><dt><a href="#CO14-13"><span class="callout">13</span></a> </dt><dd><div class="para">
										Required. This value must be set to <code class="literal">true</code>. Provides a read-only volume.
									</div></dd><dt><a href="#CO14-14"><span class="callout">14</span></a> </dt><dd><div class="para">
										Optional. The volume attributes of the ephemeral CSI volume. Consult the CSI driver’s documentation for supported attribute keys and values.
									</div></dd></dl></div></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The Shared Resource CSI Driver is supported as a Technology Preview feature.
						</p></div></div></section></section><section class="section" id="builds-strategy-s2i-build_build-strategies-docker"><div class="titlepage"><div><div><h3 class="title">2.5.2. Source-to-image build</h3></div></div></div><p>
					Source-to-image (S2I) is a tool for building reproducible container images. It produces ready-to-run images by injecting application source into a container image and assembling a new image. The new image incorporates the base image, the builder, and built source and is ready to use with the <code class="literal">buildah run</code> command. S2I supports incremental builds, which re-use previously downloaded dependencies, previously built artifacts, and so on.
				</p><section class="section" id="builds-strategy-s2i-incremental-builds_build-strategies-docker"><div class="titlepage"><div><div><h4 class="title">2.5.2.1. Performing source-to-image incremental builds</h4></div></div></div><p>
						Source-to-image (S2I) can perform incremental builds, which means it reuses artifacts from previously-built images.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To create an incremental build, create a with the following modification to the strategy definition:
							</p><pre class="programlisting language-yaml">strategy:
  sourceStrategy:
    from:
      kind: "ImageStreamTag"
      name: "incremental-image:latest" <span id="CO15-1"><!--Empty--></span><span class="callout">1</span>
    incremental: true <span id="CO15-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO15-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Specify an image that supports incremental builds. Consult the documentation of the builder image to determine if it supports this behavior.
									</div></dd><dt><a href="#CO15-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										This flag controls whether an incremental build is attempted. If the builder image does not support incremental builds, the build will still succeed, but you will get a log message stating the incremental build was not successful because of a missing <code class="literal">save-artifacts</code> script.
									</div></dd></dl></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								See S2I Requirements for information on how to create a builder image supporting incremental builds.
							</li></ul></div></section><section class="section" id="builds-strategy-s2i-override-builder-image-scripts_build-strategies-docker"><div class="titlepage"><div><div><h4 class="title">2.5.2.2. Overriding source-to-image builder image scripts</h4></div></div></div><p>
						You can override the <code class="literal">assemble</code>, <code class="literal">run</code>, and <code class="literal">save-artifacts</code> source-to-image (S2I) scripts provided by the builder image.
					</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							To override the <code class="literal">assemble</code>, <code class="literal">run</code>, and <code class="literal">save-artifacts</code> S2I scripts provided by the builder image, either:
						</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Provide an <code class="literal">assemble</code>, <code class="literal">run</code>, or <code class="literal">save-artifacts</code> script in the <code class="literal">.s2i/bin</code> directory of your application source repository.
							</li><li class="listitem"><p class="simpara">
								Provide a URL of a directory containing the scripts as part of the strategy definition. For example:
							</p><pre class="programlisting language-yaml">strategy:
  sourceStrategy:
    from:
      kind: "ImageStreamTag"
      name: "builder-image:latest"
    scripts: "http://somehost.com/scripts_directory" <span id="CO16-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO16-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										This path will have <code class="literal">run</code>, <code class="literal">assemble</code>, and <code class="literal">save-artifacts</code> appended to it. If any or all scripts are found they will be used in place of the same named scripts provided in the image.
									</div></dd></dl></div></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Files located at the <code class="literal">scripts</code> URL take precedence over files located in <code class="literal">.s2i/bin</code> of the source repository.
						</p></div></div></section><section class="section" id="builds-strategy-s2i-environment-variables_build-strategies-docker"><div class="titlepage"><div><div><h4 class="title">2.5.2.3. Source-to-image environment variables</h4></div></div></div><p>
						There are two ways to make environment variables available to the source build process and resulting image. Environment files and BuildConfig environment values. Variables provided will be present during the build process and in the output image.
					</p><section class="section" id="builds-strategy-s2i-environment-files_build-strategies-docker"><div class="titlepage"><div><div><h5 class="title">2.5.2.3.1. Using source-to-image environment files</h5></div></div></div><p>
							Source build enables you to set environment values, one per line, inside your application, by specifying them in a <code class="literal">.s2i/environment</code> file in the source repository. The environment variables specified in this file are present during the build process and in the output image.
						</p><p>
							If you provide a <code class="literal">.s2i/environment</code> file in your source repository, source-to-image (S2I) reads this file during the build. This allows customization of the build behavior as the <code class="literal">assemble</code> script may use these variables.
						</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
								For example, to disable assets compilation for your Rails application during the build:
							</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Add <code class="literal">DISABLE_ASSET_COMPILATION=true</code> in the <code class="literal">.s2i/environment</code> file.
								</li></ul></div><p>
							In addition to builds, the specified environment variables are also available in the running application itself. For example, to cause the Rails application to start in <code class="literal">development</code> mode instead of <code class="literal">production</code>:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Add <code class="literal">RAILS_ENV=development</code> to the <code class="literal">.s2i/environment</code> file.
								</li></ul></div><p>
							The complete list of supported environment variables is available in the using images section for each image.
						</p></section><section class="section" id="builds-strategy-s2i-buildconfig-environment_build-strategies-docker"><div class="titlepage"><div><div><h5 class="title">2.5.2.3.2. Using source-to-image build configuration environment</h5></div></div></div><p>
							You can add environment variables to the <code class="literal">sourceStrategy</code> definition of the build configuration. The environment variables defined there are visible during the <code class="literal">assemble</code> script execution and will be defined in the output image, making them also available to the <code class="literal">run</code> script and application code.
						</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									For example, to disable assets compilation for your Rails application:
								</p><pre class="programlisting language-yaml">sourceStrategy:
...
  env:
    - name: "DISABLE_ASSET_COMPILATION"
      value: "true"</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
									The build environment section provides more advanced instructions.
								</li><li class="listitem">
									You can also manage environment variables defined in the build configuration with the <code class="literal">oc set env</code> command.
								</li></ul></div></section></section><section class="section" id="builds-strategy-s2i-ignore-source-files_build-strategies-docker"><div class="titlepage"><div><div><h4 class="title">2.5.2.4. Ignoring source-to-image source files</h4></div></div></div><p>
						Source-to-image (S2I) supports a <code class="literal">.s2iignore</code> file, which contains a list of file patterns that should be ignored. Files in the build working directory, as provided by the various input sources, that match a pattern found in the <code class="literal">.s2iignore</code> file will not be made available to the <code class="literal">assemble</code> script.
					</p></section><section class="section" id="images-create-s2i_build-strategies-docker"><div class="titlepage"><div><div><h4 class="title">2.5.2.5. Creating images from source code with source-to-image</h4></div></div></div><p>
						Source-to-image (S2I) is a framework that makes it easy to write images that take application source code as an input and produce a new image that runs the assembled application as output.
					</p><p>
						The main advantage of using S2I for building reproducible container images is the ease of use for developers. As a builder image author, you must understand two basic concepts in order for your images to provide the best S2I performance, the build process and S2I scripts.
					</p><section class="section" id="images-create-s2i-build_build-strategies-docker"><div class="titlepage"><div><div><h5 class="title">2.5.2.5.1. Understanding the source-to-image build process</h5></div></div></div><p>
							The build process consists of the following three fundamental elements, which are combined into a final container image:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Sources
								</li><li class="listitem">
									Source-to-image (S2I) scripts
								</li><li class="listitem">
									Builder image
								</li></ul></div><p>
							S2I generates a Dockerfile with the builder image as the first <code class="literal">FROM</code> instruction. The Dockerfile generated by S2I is then passed to Buildah.
						</p></section><section class="section" id="images-create-s2i-scripts_build-strategies-docker"><div class="titlepage"><div><div><h5 class="title">2.5.2.5.2. How to write source-to-image scripts</h5></div></div></div><p>
							You can write source-to-image (S2I) scripts in any programming language, as long as the scripts are executable inside the builder image. S2I supports multiple options providing <code class="literal">assemble</code>/<code class="literal">run</code>/<code class="literal">save-artifacts</code> scripts. All of these locations are checked on each build in the following order:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
									A script specified in the build configuration.
								</li><li class="listitem">
									A script found in the application source <code class="literal">.s2i/bin</code> directory.
								</li><li class="listitem">
									A script found at the default image URL with the <code class="literal">io.openshift.s2i.scripts-url</code> label.
								</li></ol></div><p>
							Both the <code class="literal">io.openshift.s2i.scripts-url</code> label specified in the image and the script specified in a build configuration can take one of the following forms:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">image:///path_to_scripts_dir</code>: absolute path inside the image to a directory where the S2I scripts are located.
								</li><li class="listitem">
									<code class="literal">file:///path_to_scripts_dir</code>: relative or absolute path to a directory on the host where the S2I scripts are located.
								</li><li class="listitem">
									<code class="literal">http(s)://path_to_scripts_dir</code>: URL to a directory where the S2I scripts are located.
								</li></ul></div><div class="table" id="idm140458464397872"><p class="title"><strong>Table 2.1. S2I scripts</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 27%; " class="col_1"><!--Empty--></col><col style="width: 73%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140458464393040" scope="col">Script</th><th align="left" valign="top" id="idm140458464391952" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140458464393040"> <p>
											<code class="literal">assemble</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140458464391952"> <p>
											The <code class="literal">assemble</code> script builds the application artifacts from a source and places them into appropriate directories inside the image. This script is required. The workflow for this script is:
										</p>
										 <div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
													Optional: Restore build artifacts. If you want to support incremental builds, make sure to define <code class="literal">save-artifacts</code> as well.
												</li><li class="listitem">
													Place the application source in the desired location.
												</li><li class="listitem">
													Build the application artifacts.
												</li><li class="listitem">
													Install the artifacts into locations appropriate for them to run.
												</li></ol></div>
										 </td></tr><tr><td align="left" valign="top" headers="idm140458464393040"> <p>
											<code class="literal">run</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140458464391952"> <p>
											The <code class="literal">run</code> script executes your application. This script is required.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140458464393040"> <p>
											<code class="literal">save-artifacts</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140458464391952"> <p>
											The <code class="literal">save-artifacts</code> script gathers all dependencies that can speed up the build processes that follow. This script is optional. For example:
										</p>
										 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													For Ruby, <code class="literal">gems</code> installed by Bundler.
												</li><li class="listitem">
													For Java, <code class="literal">.m2</code> contents.
												</li></ul></div>
										 <p>
											These dependencies are gathered into a <code class="literal">tar</code> file and streamed to the standard output.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140458464393040"> <p>
											<code class="literal">usage</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140458464391952"> <p>
											The <code class="literal">usage</code> script allows you to inform the user how to properly use your image. This script is optional.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140458464393040"> <p>
											<code class="literal">test/run</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140458464391952"> <p>
											The <code class="literal">test/run</code> script allows you to create a process to check if the image is working correctly. This script is optional. The proposed flow of that process is:
										</p>
										 <div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
													Build the image.
												</li><li class="listitem">
													Run the image to verify the <code class="literal">usage</code> script.
												</li><li class="listitem">
													Run <code class="literal">s2i build</code> to verify the <code class="literal">assemble</code> script.
												</li><li class="listitem">
													Optional: Run <code class="literal">s2i build</code> again to verify the <code class="literal">save-artifacts</code> and <code class="literal">assemble</code> scripts save and restore artifacts functionality.
												</li><li class="listitem">
													Run the image to verify the test application is working.
												</li></ol></div>
										 <div class="admonition note"><div class="admonition_header">Note</div><div><p>
												The suggested location to put the test application built by your <code class="literal">test/run</code> script is the <code class="literal">test/test-app</code> directory in your image repository.
											</p></div></div>
										 </td></tr></tbody></table></div></div><p>
							<span class="strong strong"><strong>Example S2I scripts</strong></span>
						</p><p>
							The following example S2I scripts are written in Bash. Each example assumes its <code class="literal">tar</code> contents are unpacked into the <code class="literal">/tmp/s2i</code> directory.
						</p><div class="formalpara"><p class="title"><strong><code class="literal">assemble</code> script:</strong></p><p>
								
<pre class="programlisting language-bash">#!/bin/bash

# restore build artifacts
if [ "$(ls /tmp/s2i/artifacts/ 2&gt;/dev/null)" ]; then
    mv /tmp/s2i/artifacts/* $HOME/.
fi

# move the application source
mv /tmp/s2i/src $HOME/src

# build application artifacts
pushd ${HOME}
make all

# install the artifacts
make install
popd</pre>

							</p></div><div class="formalpara"><p class="title"><strong><code class="literal">run</code> script:</strong></p><p>
								
<pre class="programlisting language-bash">#!/bin/bash

# run the application
/opt/application/run.sh</pre>

							</p></div><div class="formalpara"><p class="title"><strong><code class="literal">save-artifacts</code> script:</strong></p><p>
								
<pre class="programlisting language-bash">#!/bin/bash

pushd ${HOME}
if [ -d deps ]; then
    # all deps contents to tar stream
    tar cf - deps
fi
popd</pre>

							</p></div><div class="formalpara"><p class="title"><strong><code class="literal">usage</code> script:</strong></p><p>
								
<pre class="programlisting language-bash">#!/bin/bash

# inform the user how to use the image
cat &lt;&lt;EOF
This is a S2I sample builder image, to use it, install
https://github.com/openshift/source-to-image
EOF</pre>

							</p></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
									<a class="link" href="https://blog.openshift.com/create-s2i-builder-image/">S2I Image Creation Tutorial</a>
								</li></ul></div></section></section><section class="section" id="builds-using-build-volumes_build-strategies-s2i"><div class="titlepage"><div><div><h4 class="title">2.5.2.6. Using build volumes</h4></div></div></div><p>
						You can mount build volumes to give running builds access to information that you don’t want to persist in the output container image.
					</p><p>
						Build volumes provide sensitive information, such as repository credentials, that the build environment or configuration only needs at build time. Build volumes are different from <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#builds-define-build-inputs_creating-build-inputs">build inputs</a>, whose data can persist in the output container image.
					</p><p>
						The mount points of build volumes, from which the running build reads data, are functionally similar to <a class="link" href="https://kubernetes.io/docs/concepts/storage/volumes/">pod volume mounts</a>.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#builds-input-secrets-configmaps_creating-build-inputs">added an input secret, config map, or both to a BuildConfig object</a>.
							</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								In the <code class="literal">sourceStrategy</code> definition of the <code class="literal">BuildConfig</code> object, add any build volumes to the <code class="literal">volumes</code> array. For example:
							</p><pre class="programlisting language-yaml">spec:
  sourceStrategy:
    volumes:
      - name: secret-mvn <span id="CO17-1"><!--Empty--></span><span class="callout">1</span>
        mounts:
        - destinationPath: /opt/app-root/src/.ssh <span id="CO17-2"><!--Empty--></span><span class="callout">2</span>
        source:
          type: Secret <span id="CO17-3"><!--Empty--></span><span class="callout">3</span>
          secret:
            secretName: my-secret <span id="CO17-4"><!--Empty--></span><span class="callout">4</span>
      - name: settings-mvn <span id="CO17-5"><!--Empty--></span><span class="callout">5</span>
        mounts:
        - destinationPath: /opt/app-root/src/.m2 <span id="CO17-6"><!--Empty--></span><span class="callout">6</span>
        source:
          type: ConfigMap <span id="CO17-7"><!--Empty--></span><span class="callout">7</span>
          configMap:
            name: my-config <span id="CO17-8"><!--Empty--></span><span class="callout">8</span>
      - name: my-csi-volume <span id="CO17-9"><!--Empty--></span><span class="callout">9</span>
        mounts:
        - destinationPath: /opt/app-root/src/some_path  <span id="CO17-10"><!--Empty--></span><span class="callout">10</span>
        source:
          type: CSI <span id="CO17-11"><!--Empty--></span><span class="callout">11</span>
          csi:
            driver: csi.sharedresource.openshift.io <span id="CO17-12"><!--Empty--></span><span class="callout">12</span>
            readOnly: true <span id="CO17-13"><!--Empty--></span><span class="callout">13</span>
            volumeAttributes: <span id="CO17-14"><!--Empty--></span><span class="callout">14</span>
              attribute: value</pre></li></ul></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO17-1"><span class="callout">1</span></a> <a href="#CO17-5"><span class="callout">5</span></a> <a href="#CO17-9"><span class="callout">9</span></a> </dt><dd><div class="para">
								Required. A unique name.
							</div></dd><dt><a href="#CO17-2"><span class="callout">2</span></a> <a href="#CO17-6"><span class="callout">6</span></a> <a href="#CO17-10"><span class="callout">10</span></a> </dt><dd><div class="para">
								Required. The absolute path of the mount point. It must not contain <code class="literal">..</code> or <code class="literal">:</code> and doesn’t collide with the destination path generated by the builder. The <code class="literal">/opt/app-root/src</code> is the default home directory for many Red Hat S2I-enabled images.
							</div></dd><dt><a href="#CO17-3"><span class="callout">3</span></a> <a href="#CO17-7"><span class="callout">7</span></a> <a href="#CO17-11"><span class="callout">11</span></a> </dt><dd><div class="para">
								Required. The type of source, <code class="literal">ConfigMap</code>, <code class="literal">Secret</code>, or <code class="literal">CSI</code>.
							</div></dd><dt><a href="#CO17-4"><span class="callout">4</span></a> <a href="#CO17-8"><span class="callout">8</span></a> </dt><dd><div class="para">
								Required. The name of the source.
							</div></dd><dt><a href="#CO17-12"><span class="callout">12</span></a> </dt><dd><div class="para">
								Required. The driver that provides the ephemeral CSI volume.
							</div></dd><dt><a href="#CO17-13"><span class="callout">13</span></a> </dt><dd><div class="para">
								Required. This value must be set to <code class="literal">true</code>. Provides a read-only volume.
							</div></dd><dt><a href="#CO17-14"><span class="callout">14</span></a> </dt><dd><div class="para">
								Optional. The volume attributes of the ephemeral CSI volume. Consult the CSI driver’s documentation for supported attribute keys and values.
							</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The Shared Resource CSI Driver is supported as a Technology Preview feature.
						</p></div></div></section></section><section class="section" id="builds-strategy-custom-build_build-strategies-s2i"><div class="titlepage"><div><div><h3 class="title">2.5.3. Custom build</h3></div></div></div><p>
					The custom build strategy allows developers to define a specific builder image responsible for the entire build process. Using your own builder image allows you to customize your build process.
				</p><p>
					A custom builder image is a plain container image embedded with build process logic, for example for building RPMs or base images.
				</p><p>
					Custom builds run with a high level of privilege and are not available to users by default. Only users who can be trusted with cluster administration permissions should be granted access to run custom builds.
				</p><section class="section" id="builds-strategy-custom-from-image_build-strategies-s2i"><div class="titlepage"><div><div><h4 class="title">2.5.3.1. Using FROM image for custom builds</h4></div></div></div><p>
						You can use the <code class="literal">customStrategy.from</code> section to indicate the image to use for the custom build
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Set the <code class="literal">customStrategy.from</code> section:
							</p><pre class="programlisting language-yaml">strategy:
  customStrategy:
    from:
      kind: "DockerImage"
      name: "openshift/sti-image-builder"</pre></li></ul></div></section><section class="section" id="builds-strategy-custom-secrets_build-strategies-s2i"><div class="titlepage"><div><div><h4 class="title">2.5.3.2. Using secrets in custom builds</h4></div></div></div><p>
						In addition to secrets for source and images that can be added to all build types, custom strategies allow adding an arbitrary list of secrets to the builder pod.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To mount each secret at a specific location, edit the <code class="literal">secretSource</code> and <code class="literal">mountPath</code> fields of the <code class="literal">strategy</code> YAML file:
							</p><pre class="programlisting language-yaml">strategy:
  customStrategy:
    secrets:
      - secretSource: <span id="CO18-1"><!--Empty--></span><span class="callout">1</span>
          name: "secret1"
        mountPath: "/tmp/secret1" <span id="CO18-2"><!--Empty--></span><span class="callout">2</span>
      - secretSource:
          name: "secret2"
        mountPath: "/tmp/secret2"</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO18-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										<code class="literal">secretSource</code> is a reference to a secret in the same namespace as the build.
									</div></dd><dt><a href="#CO18-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										<code class="literal">mountPath</code> is the path inside the custom builder where the secret should be mounted.
									</div></dd></dl></div></li></ul></div></section><section class="section" id="builds-strategy-custom-environment-variables_build-strategies-s2i"><div class="titlepage"><div><div><h4 class="title">2.5.3.3. Using environment variables for custom builds</h4></div></div></div><p>
						To make environment variables available to the custom build process, you can add environment variables to the <code class="literal">customStrategy</code> definition of the build configuration.
					</p><p>
						The environment variables defined there are passed to the pod that runs the custom build.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Define a custom HTTP proxy to be used during build:
							</p><pre class="programlisting language-yaml">customStrategy:
...
  env:
    - name: "HTTP_PROXY"
      value: "http://myproxy.net:5187/"</pre></li><li class="listitem"><p class="simpara">
								To manage environment variables defined in the build configuration, enter the following command:
							</p><pre class="programlisting language-terminal">$ oc set env &lt;enter_variables&gt;</pre></li></ol></div></section><section class="section" id="images-custom_build-strategies-s2i"><div class="titlepage"><div><div><h4 class="title">2.5.3.4. Using custom builder images</h4></div></div></div><p>
						OpenShift Container Platform’s custom build strategy enables you to define a specific builder image responsible for the entire build process. When you need a build to produce individual artifacts such as packages, JARs, WARs, installable ZIPs, or base images, use a custom builder image using the custom build strategy.
					</p><p>
						A custom builder image is a plain container image embedded with build process logic, which is used for building artifacts such as RPMs or base container images.
					</p><p>
						Additionally, the custom builder allows implementing any extended build process, such as a CI/CD flow that runs unit or integration tests.
					</p><section class="section" id="images-custom-builder-image-ref_build-strategies-s2i"><div class="titlepage"><div><div><h5 class="title">2.5.3.4.1. Custom builder image</h5></div></div></div><p>
							Upon invocation, a custom builder image receives the following environment variables with the information needed to proceed with the build:
						</p><div class="table" id="idm140458464089008"><p class="title"><strong>Table 2.2. Custom Builder Environment Variables</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 75%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140458467262416" scope="col">Variable Name</th><th align="left" valign="top" id="idm140458467261328" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140458467262416"> <p>
											<code class="literal">BUILD</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140458467261328"> <p>
											The entire serialized JSON of the <code class="literal">Build</code> object definition. If you must use a specific API version for serialization, you can set the <code class="literal">buildAPIVersion</code> parameter in the custom strategy specification of the build configuration.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140458467262416"> <p>
											<code class="literal">SOURCE_REPOSITORY</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140458467261328"> <p>
											The URL of a Git repository with source to be built.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140458467262416"> <p>
											<code class="literal">SOURCE_URI</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140458467261328"> <p>
											Uses the same value as <code class="literal">SOURCE_REPOSITORY</code>. Either can be used.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140458467262416"> <p>
											<code class="literal">SOURCE_CONTEXT_DIR</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140458467261328"> <p>
											Specifies the subdirectory of the Git repository to be used when building. Only present if defined.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140458467262416"> <p>
											<code class="literal">SOURCE_REF</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140458467261328"> <p>
											The Git reference to be built.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140458467262416"> <p>
											<code class="literal">ORIGIN_VERSION</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140458467261328"> <p>
											The version of the OpenShift Container Platform master that created this build object.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140458467262416"> <p>
											<code class="literal">OUTPUT_REGISTRY</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140458467261328"> <p>
											The container image registry to push the image to.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140458467262416"> <p>
											<code class="literal">OUTPUT_IMAGE</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140458467261328"> <p>
											The container image tag name for the image being built.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140458467262416"> <p>
											<code class="literal">PUSH_DOCKERCFG_PATH</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140458467261328"> <p>
											The path to the container registry credentials for running a <code class="literal">podman push</code> operation.
										</p>
										 </td></tr></tbody></table></div></div></section><section class="section" id="images-custom-builder-flow_build-strategies-s2i"><div class="titlepage"><div><div><h5 class="title">2.5.3.4.2. Custom builder workflow</h5></div></div></div><p>
							Although custom builder image authors have flexibility in defining the build process, your builder image must adhere to the following required steps necessary for running a build inside of OpenShift Container Platform:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
									The <code class="literal">Build</code> object definition contains all the necessary information about input parameters for the build.
								</li><li class="listitem">
									Run the build process.
								</li><li class="listitem">
									If your build produces an image, push it to the output location of the build if it is defined. Other output locations can be passed with environment variables.
								</li></ol></div></section></section></section><section class="section" id="builds-strategy-pipeline-build_build-strategies-s2i"><div class="titlepage"><div><div><h3 class="title">2.5.4. Pipeline build</h3></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The Pipeline build strategy is deprecated in OpenShift Container Platform 4. Equivalent and improved functionality is present in the OpenShift Container Platform Pipelines based on Tekton.
					</p><p>
						Jenkins images on OpenShift Container Platform are fully supported and users should follow Jenkins user documentation for defining their <code class="literal">jenkinsfile</code> in a job or store it in a Source Control Management system.
					</p></div></div><p>
					The Pipeline build strategy allows developers to define a Jenkins pipeline for use by the Jenkins pipeline plugin. The build can be started, monitored, and managed by OpenShift Container Platform in the same way as any other build type.
				</p><p>
					Pipeline workflows are defined in a <code class="literal">jenkinsfile</code>, either embedded directly in the build configuration, or supplied in a Git repository and referenced by the build configuration.
				</p><section class="section" id="builds-understanding-openshift-pipeline_build-strategies-s2i"><div class="titlepage"><div><div><h4 class="title">2.5.4.1. Understanding OpenShift Container Platform pipelines</h4></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							The Pipeline build strategy is deprecated in OpenShift Container Platform 4. Equivalent and improved functionality is present in the OpenShift Container Platform Pipelines based on Tekton.
						</p><p>
							Jenkins images on OpenShift Container Platform are fully supported and users should follow Jenkins user documentation for defining their <code class="literal">jenkinsfile</code> in a job or store it in a Source Control Management system.
						</p></div></div><p>
						Pipelines give you control over building, deploying, and promoting your applications on OpenShift Container Platform. Using a combination of the Jenkins Pipeline build strategy, <code class="literal">jenkinsfiles</code>, and the OpenShift Container Platform Domain Specific Language (DSL) provided by the Jenkins Client Plugin, you can create advanced build, test, deploy, and promote pipelines for any scenario.
					</p><p>
						<span class="strong strong"><strong>OpenShift Container Platform Jenkins Sync Plugin</strong></span>
					</p><p>
						The OpenShift Container Platform Jenkins Sync Plugin keeps the build configuration and build objects in sync with Jenkins jobs and builds, and provides the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Dynamic job and run creation in Jenkins.
							</li><li class="listitem">
								Dynamic creation of agent pod templates from image streams, image stream tags, or config maps.
							</li><li class="listitem">
								Injection of environment variables.
							</li><li class="listitem">
								Pipeline visualization in the OpenShift Container Platform web console.
							</li><li class="listitem">
								Integration with the Jenkins Git plugin, which passes commit information from OpenShift Container Platform builds to the Jenkins Git plugin.
							</li><li class="listitem">
								Synchronization of secrets into Jenkins credential entries.
							</li></ul></div><p>
						<span class="strong strong"><strong>OpenShift Container Platform Jenkins Client Plugin</strong></span>
					</p><p>
						The OpenShift Container Platform Jenkins Client Plugin is a Jenkins plugin which aims to provide a readable, concise, comprehensive, and fluent Jenkins Pipeline syntax for rich interactions with an OpenShift Container Platform API Server. The plugin uses the OpenShift Container Platform command line tool, <code class="literal">oc</code>, which must be available on the nodes executing the script.
					</p><p>
						The Jenkins Client Plugin must be installed on your Jenkins master so the OpenShift Container Platform DSL will be available to use within the <code class="literal">jenkinsfile</code> for your application. This plugin is installed and enabled by default when using the OpenShift Container Platform Jenkins image.
					</p><p>
						For OpenShift Container Platform Pipelines within your project, you will must use the Jenkins Pipeline Build Strategy. This strategy defaults to using a <code class="literal">jenkinsfile</code> at the root of your source repository, but also provides the following configuration options:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								An inline <code class="literal">jenkinsfile</code> field within your build configuration.
							</li><li class="listitem">
								A <code class="literal">jenkinsfilePath</code> field within your build configuration that references the location of the <code class="literal">jenkinsfile</code> to use relative to the source <code class="literal">contextDir</code>.
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The optional <code class="literal">jenkinsfilePath</code> field specifies the name of the file to use, relative to the source <code class="literal">contextDir</code>. If <code class="literal">contextDir</code> is omitted, it defaults to the root of the repository. If <code class="literal">jenkinsfilePath</code> is omitted, it defaults to <code class="literal">jenkinsfile</code>.
						</p></div></div></section><section class="section" id="builds-strategy-pipeline-providing-jenkinsfile_build-strategies-s2i"><div class="titlepage"><div><div><h4 class="title">2.5.4.2. Providing the Jenkins file for pipeline builds</h4></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							The Pipeline build strategy is deprecated in OpenShift Container Platform 4. Equivalent and improved functionality is present in the OpenShift Container Platform Pipelines based on Tekton.
						</p><p>
							Jenkins images on OpenShift Container Platform are fully supported and users should follow Jenkins user documentation for defining their <code class="literal">jenkinsfile</code> in a job or store it in a Source Control Management system.
						</p></div></div><p>
						The <code class="literal">jenkinsfile</code> uses the standard groovy language syntax to allow fine grained control over the configuration, build, and deployment of your application.
					</p><p>
						You can supply the <code class="literal">jenkinsfile</code> in one of the following ways:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A file located within your source code repository.
							</li><li class="listitem">
								Embedded as part of your build configuration using the <code class="literal">jenkinsfile</code> field.
							</li></ul></div><p>
						When using the first option, the <code class="literal">jenkinsfile</code> must be included in your applications source code repository at one of the following locations:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A file named <code class="literal">jenkinsfile</code> at the root of your repository.
							</li><li class="listitem">
								A file named <code class="literal">jenkinsfile</code> at the root of the source <code class="literal">contextDir</code> of your repository.
							</li><li class="listitem">
								A file name specified via the <code class="literal">jenkinsfilePath</code> field of the <code class="literal">JenkinsPipelineStrategy</code> section of your BuildConfig, which is relative to the source <code class="literal">contextDir</code> if supplied, otherwise it defaults to the root of the repository.
							</li></ul></div><p>
						The <code class="literal">jenkinsfile</code> is run on the Jenkins agent pod, which must have the OpenShift Container Platform client binaries available if you intend to use the OpenShift Container Platform DSL.
					</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							To provide the Jenkins file, you can either:
						</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Embed the Jenkins file in the build configuration.
							</li><li class="listitem">
								Include in the build configuration a reference to the Git repository that contains the Jenkins file.
							</li></ul></div><div class="formalpara"><p class="title"><strong>Embedded Definition</strong></p><p>
							
<pre class="programlisting language-yaml">kind: "BuildConfig"
apiVersion: "v1"
metadata:
  name: "sample-pipeline"
spec:
  strategy:
    jenkinsPipelineStrategy:
      jenkinsfile: |-
        node('agent') {
          stage 'build'
          openshiftBuild(buildConfig: 'ruby-sample-build', showBuildLogs: 'true')
          stage 'deploy'
          openshiftDeploy(deploymentConfig: 'frontend')
        }</pre>

						</p></div><div class="formalpara"><p class="title"><strong>Reference to Git Repository</strong></p><p>
							
<pre class="programlisting language-yaml">kind: "BuildConfig"
apiVersion: "v1"
metadata:
  name: "sample-pipeline"
spec:
  source:
    git:
      uri: "https://github.com/openshift/ruby-hello-world"
  strategy:
    jenkinsPipelineStrategy:
      jenkinsfilePath: some/repo/dir/filename <span id="CO19-1"><!--Empty--></span><span class="callout">1</span></pre>

						</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO19-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								The optional <code class="literal">jenkinsfilePath</code> field specifies the name of the file to use, relative to the source <code class="literal">contextDir</code>. If <code class="literal">contextDir</code> is omitted, it defaults to the root of the repository. If <code class="literal">jenkinsfilePath</code> is omitted, it defaults to <code class="literal">jenkinsfile</code>.
							</div></dd></dl></div></section><section class="section" id="builds-strategy-pipeline-environment-variables_build-strategies-s2i"><div class="titlepage"><div><div><h4 class="title">2.5.4.3. Using environment variables for pipeline builds</h4></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							The Pipeline build strategy is deprecated in OpenShift Container Platform 4. Equivalent and improved functionality is present in the OpenShift Container Platform Pipelines based on Tekton.
						</p><p>
							Jenkins images on OpenShift Container Platform are fully supported and users should follow Jenkins user documentation for defining their <code class="literal">jenkinsfile</code> in a job or store it in a Source Control Management system.
						</p></div></div><p>
						To make environment variables available to the Pipeline build process, you can add environment variables to the <code class="literal">jenkinsPipelineStrategy</code> definition of the build configuration.
					</p><p>
						Once defined, the environment variables will be set as parameters for any Jenkins job associated with the build configuration.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To define environment variables to be used during build, edit the YAML file:
							</p><pre class="programlisting language-yaml">jenkinsPipelineStrategy:
...
  env:
    - name: "FOO"
      value: "BAR"</pre></li></ul></div><p>
						You can also manage environment variables defined in the build configuration with the <code class="literal">oc set env</code> command.
					</p><section class="section" id="builds-strategy-pipeline-mapping-buildconfig-jenkins_build-strategies-s2i"><div class="titlepage"><div><div><h5 class="title">2.5.4.3.1. Mapping between BuildConfig environment variables and Jenkins job parameters</h5></div></div></div><p>
							When a Jenkins job is created or updated based on changes to a Pipeline strategy build configuration, any environment variables in the build configuration are mapped to Jenkins job parameters definitions, where the default values for the Jenkins job parameters definitions are the current values of the associated environment variables.
						</p><p>
							After the Jenkins job’s initial creation, you can still add additional parameters to the job from the Jenkins console. The parameter names differ from the names of the environment variables in the build configuration. The parameters are honored when builds are started for those Jenkins jobs.
						</p><p>
							How you start builds for the Jenkins job dictates how the parameters are set.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									If you start with <code class="literal">oc start-build</code>, the values of the environment variables in the build configuration are the parameters set for the corresponding job instance. Any changes you make to the parameters' default values from the Jenkins console are ignored. The build configuration values take precedence.
								</li><li class="listitem"><p class="simpara">
									If you start with <code class="literal">oc start-build -e</code>, the values for the environment variables specified in the <code class="literal">-e</code> option take precedence.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											If you specify an environment variable not listed in the build configuration, they will be added as a Jenkins job parameter definitions.
										</li><li class="listitem">
											Any changes you make from the Jenkins console to the parameters corresponding to the environment variables are ignored. The build configuration and what you specify with <code class="literal">oc start-build -e</code> takes precedence.
										</li></ul></div></li><li class="listitem">
									If you start the Jenkins job with the Jenkins console, then you can control the setting of the parameters with the Jenkins console as part of starting a build for the job.
								</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								It is recommended that you specify in the build configuration all possible environment variables to be associated with job parameters. Doing so reduces disk I/O and improves performance during Jenkins processing.
							</p></div></div></section></section><section class="section" id="builds-tutorial-pipeline_build-strategies-s2i"><div class="titlepage"><div><div><h4 class="title">2.5.4.4. Pipeline build tutorial</h4></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							The Pipeline build strategy is deprecated in OpenShift Container Platform 4. Equivalent and improved functionality is present in the OpenShift Container Platform Pipelines based on Tekton.
						</p><p>
							Jenkins images on OpenShift Container Platform are fully supported and users should follow Jenkins user documentation for defining their <code class="literal">jenkinsfile</code> in a job or store it in a Source Control Management system.
						</p></div></div><p>
						This example demonstrates how to create an OpenShift Container Platform Pipeline that will build, deploy, and verify a <code class="literal">Node.js/MongoDB</code> application using the <code class="literal">nodejs-mongodb.json</code> template.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create the Jenkins master:
							</p><pre class="programlisting language-terminal">  $ oc project &lt;project_name&gt;</pre><p class="simpara">
								Select the project that you want to use or create a new project with <code class="literal">oc new-project &lt;project_name&gt;</code>.
							</p><pre class="programlisting language-terminal">  $ oc new-app jenkins-ephemeral <span id="CO20-1"><!--Empty--></span><span class="callout">1</span></pre><p class="simpara">
								If you want to use persistent storage, use <code class="literal">jenkins-persistent</code> instead.
							</p></li><li class="listitem"><p class="simpara">
								Create a file named <code class="literal">nodejs-sample-pipeline.yaml</code> with the following content:
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									This creates a <code class="literal">BuildConfig</code> object that employs the Jenkins pipeline strategy to build, deploy, and scale the <code class="literal">Node.js/MongoDB</code> example application.
								</p></div></div><pre class="programlisting language-yaml">kind: "BuildConfig"
apiVersion: "v1"
metadata:
  name: "nodejs-sample-pipeline"
spec:
  strategy:
    jenkinsPipelineStrategy:
      jenkinsfile: &lt;pipeline content from below&gt;
    type: JenkinsPipeline</pre></li><li class="listitem"><p class="simpara">
								After you create a <code class="literal">BuildConfig</code> object with a <code class="literal">jenkinsPipelineStrategy</code>, tell the pipeline what to do by using an inline <code class="literal">jenkinsfile</code>:
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									This example does not set up a Git repository for the application.
								</p><p>
									The following <code class="literal">jenkinsfile</code> content is written in Groovy using the OpenShift Container Platform DSL. For this example, include inline content in the <code class="literal">BuildConfig</code> object using the YAML Literal Style, though including a <code class="literal">jenkinsfile</code> in your source repository is the preferred method.
								</p></div></div><pre class="programlisting language-groovy">def templatePath = 'https://raw.githubusercontent.com/openshift/nodejs-ex/master/openshift/templates/nodejs-mongodb.json' <span id="CO20-2"><!--Empty--></span><span class="callout">1</span>
def templateName = 'nodejs-mongodb-example' <span id="CO20-3"><!--Empty--></span><span class="callout">2</span>
pipeline {
  agent {
    node {
      label 'nodejs' <span id="CO20-4"><!--Empty--></span><span class="callout">3</span>
    }
  }
  options {
    timeout(time: 20, unit: 'MINUTES') <span id="CO20-5"><!--Empty--></span><span class="callout">4</span>
  }
  stages {
    stage('preamble') {
        steps {
            script {
                openshift.withCluster() {
                    openshift.withProject() {
                        echo "Using project: ${openshift.project()}"
                    }
                }
            }
        }
    }
    stage('cleanup') {
      steps {
        script {
            openshift.withCluster() {
                openshift.withProject() {
                  openshift.selector("all", [ template : templateName ]).delete() <span id="CO20-6"><!--Empty--></span><span class="callout">5</span>
                  if (openshift.selector("secrets", templateName).exists()) { <span id="CO20-7"><!--Empty--></span><span class="callout">6</span>
                    openshift.selector("secrets", templateName).delete()
                  }
                }
            }
        }
      }
    }
    stage('create') {
      steps {
        script {
            openshift.withCluster() {
                openshift.withProject() {
                  openshift.newApp(templatePath) <span id="CO20-8"><!--Empty--></span><span class="callout">7</span>
                }
            }
        }
      }
    }
    stage('build') {
      steps {
        script {
            openshift.withCluster() {
                openshift.withProject() {
                  def builds = openshift.selector("bc", templateName).related('builds')
                  timeout(5) { <span id="CO20-9"><!--Empty--></span><span class="callout">8</span>
                    builds.untilEach(1) {
                      return (it.object().status.phase == "Complete")
                    }
                  }
                }
            }
        }
      }
    }
    stage('deploy') {
      steps {
        script {
            openshift.withCluster() {
                openshift.withProject() {
                  def rm = openshift.selector("dc", templateName).rollout()
                  timeout(5) { <span id="CO20-10"><!--Empty--></span><span class="callout">9</span>
                    openshift.selector("dc", templateName).related('pods').untilEach(1) {
                      return (it.object().status.phase == "Running")
                    }
                  }
                }
            }
        }
      }
    }
    stage('tag') {
      steps {
        script {
            openshift.withCluster() {
                openshift.withProject() {
                  openshift.tag("${templateName}:latest", "${templateName}-staging:latest") <span id="CO20-11"><!--Empty--></span><span class="callout">10</span>
                }
            }
        }
      }
    }
  }
}</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO20-2"><span class="callout">1</span></a> </dt><dd><div class="para">
										Path of the template to use.
									</div></dd><dt><a href="#CO20-1"><span class="callout">1</span></a> <a href="#CO20-3"><span class="callout">2</span></a> </dt><dd><div class="para">
										Name of the template that will be created.
									</div></dd><dt><a href="#CO20-4"><span class="callout">3</span></a> </dt><dd><div class="para">
										Spin up a <code class="literal">node.js</code> agent pod on which to run this build.
									</div></dd><dt><a href="#CO20-5"><span class="callout">4</span></a> </dt><dd><div class="para">
										Set a timeout of 20 minutes for this pipeline.
									</div></dd><dt><a href="#CO20-6"><span class="callout">5</span></a> </dt><dd><div class="para">
										Delete everything with this template label.
									</div></dd><dt><a href="#CO20-7"><span class="callout">6</span></a> </dt><dd><div class="para">
										Delete any secrets with this template label.
									</div></dd><dt><a href="#CO20-8"><span class="callout">7</span></a> </dt><dd><div class="para">
										Create a new application from the <code class="literal">templatePath</code>.
									</div></dd><dt><a href="#CO20-9"><span class="callout">8</span></a> </dt><dd><div class="para">
										Wait up to five minutes for the build to complete.
									</div></dd><dt><a href="#CO20-10"><span class="callout">9</span></a> </dt><dd><div class="para">
										Wait up to five minutes for the deployment to complete.
									</div></dd><dt><a href="#CO20-11"><span class="callout">10</span></a> </dt><dd><div class="para">
										If everything else succeeded, tag the <code class="literal">$ {templateName}:latest</code> image as <code class="literal">$ {templateName}-staging:latest</code>. A pipeline build configuration for the staging environment can watch for the <code class="literal">$ {templateName}-staging:latest</code> image to change and then deploy it to the staging environment.
									</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The previous example was written using the declarative pipeline style, but the older scripted pipeline style is also supported.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Create the Pipeline <code class="literal">BuildConfig</code> in your OpenShift Container Platform cluster:
							</p><pre class="programlisting language-terminal">$ oc create -f nodejs-sample-pipeline.yaml</pre><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										If you do not want to create your own file, you can use the sample from the Origin repository by running:
									</p><pre class="programlisting language-terminal">$ oc create -f https://raw.githubusercontent.com/openshift/origin/master/examples/jenkins/pipeline/nodejs-sample-pipeline.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								Start the Pipeline:
							</p><pre class="programlisting language-terminal">$ oc start-build nodejs-sample-pipeline</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Alternatively, you can start your pipeline with the OpenShift Container Platform web console by navigating to the Builds → Pipeline section and clicking <span class="strong strong"><strong>Start Pipeline</strong></span>, or by visiting the Jenkins Console, navigating to the Pipeline that you created, and clicking <span class="strong strong"><strong>Build Now</strong></span>.
								</p></div></div><p class="simpara">
								Once the pipeline is started, you should see the following actions performed within your project:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										A job instance is created on the Jenkins server.
									</li><li class="listitem">
										An agent pod is launched, if your pipeline requires one.
									</li><li class="listitem"><p class="simpara">
										The pipeline runs on the agent pod, or the master if no agent is required.
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												Any previously created resources with the <code class="literal">template=nodejs-mongodb-example</code> label will be deleted.
											</li><li class="listitem">
												A new application, and all of its associated resources, will be created from the <code class="literal">nodejs-mongodb-example</code> template.
											</li><li class="listitem"><p class="simpara">
												A build will be started using the <code class="literal">nodejs-mongodb-example</code> <code class="literal">BuildConfig</code>.
											</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
														The pipeline will wait until the build has completed to trigger the next stage.
													</li></ul></div></li><li class="listitem"><p class="simpara">
												A deployment will be started using the <code class="literal">nodejs-mongodb-example</code> deployment configuration.
											</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
														The pipeline will wait until the deployment has completed to trigger the next stage.
													</li></ul></div></li><li class="listitem">
												If the build and deploy are successful, the <code class="literal">nodejs-mongodb-example:latest</code> image will be tagged as <code class="literal">nodejs-mongodb-example:stage</code>.
											</li></ul></div></li><li class="listitem"><p class="simpara">
										The agent pod is deleted, if one was required for the pipeline.
									</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											The best way to visualize the pipeline execution is by viewing it in the OpenShift Container Platform web console. You can view your pipelines by logging in to the web console and navigating to Builds → Pipelines.
										</p></div></div></li></ul></div></li></ol></div></section></section><section class="section" id="builds-strategy-secrets-web-console_build-strategies-s2i"><div class="titlepage"><div><div><h3 class="title">2.5.5. Adding secrets with web console</h3></div></div></div><p>
					You can add a secret to your build configuration so that it can access a private repository.
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						To add a secret to your build configuration so that it can access a private repository from the OpenShift Container Platform web console:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Create a new OpenShift Container Platform project.
						</li><li class="listitem">
							Create a secret that contains credentials for accessing a private source code repository.
						</li><li class="listitem">
							Create a build configuration.
						</li><li class="listitem">
							On the build configuration editor page or in the <code class="literal">create app from builder image</code> page of the web console, set the <span class="strong strong"><strong>Source Secret</strong></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Save</strong></span>.
						</li></ol></div></section><section class="section" id="builds-strategy-enable-pulling-pushing_build-strategies-s2i"><div class="titlepage"><div><div><h3 class="title">2.5.6. Enabling pulling and pushing</h3></div></div></div><p>
					You can enable pulling to a private registry by setting the pull secret and pushing by setting the push secret in the build configuration.
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						To enable pulling to a private registry:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Set the pull secret in the build configuration.
						</li></ul></div><p>
					To enable pushing:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Set the push secret in the build configuration.
						</li></ul></div></section></section><section class="section" id="custom-builds-buildah"><div class="titlepage"><div><div><h2 class="title">2.6. Custom image builds with Buildah</h2></div></div></div><p>
				With OpenShift Container Platform 4.13, a docker socket will not be present on the host nodes. This means the <span class="emphasis"><em>mount docker socket</em></span> option of a custom build is not guaranteed to provide an accessible docker socket for use within a custom build image.
			</p><p>
				If you require this capability in order to build and push images, add the Buildah tool your custom build image and use it to build and push the image within your custom build logic. The following is an example of how to run custom builds with Buildah.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Using the custom build strategy requires permissions that normal users do not have by default because it allows the user to execute arbitrary code inside a privileged container running on the cluster. This level of access can be used to compromise the cluster and therefore should be granted only to users who are trusted with administrative privileges on the cluster.
				</p></div></div><section class="section" id="prerequisites"><div class="titlepage"><div><div><h3 class="title">2.6.1. Prerequisites</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Review how to <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#securing-builds-by-strategy">grant custom build permissions</a>.
						</li></ul></div></section><section class="section" id="builds-create-custom-build-artifacts_custom-builds-buildah"><div class="titlepage"><div><div><h3 class="title">2.6.2. Creating custom build artifacts</h3></div></div></div><p>
					You must create the image you want to use as your custom build image.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Starting with an empty directory, create a file named <code class="literal">Dockerfile</code> with the following content:
						</p><pre class="programlisting language-terminal">FROM registry.redhat.io/rhel8/buildah
# In this example, `/tmp/build` contains the inputs that build when this
# custom builder image is run. Normally the custom builder image fetches
# this content from some location at build time, by using git clone as an example.
ADD dockerfile.sample /tmp/input/Dockerfile
ADD build.sh /usr/bin
RUN chmod a+x /usr/bin/build.sh
# /usr/bin/build.sh contains the actual custom build logic that will be run when
# this custom builder image is run.
ENTRYPOINT ["/usr/bin/build.sh"]</pre></li><li class="listitem"><p class="simpara">
							In the same directory, create a file named <code class="literal">dockerfile.sample</code>. This file is included in the custom build image and defines the image that is produced by the custom build:
						</p><pre class="programlisting language-terminal">FROM registry.access.redhat.com/ubi9/ubi
RUN touch /tmp/build</pre></li><li class="listitem"><p class="simpara">
							In the same directory, create a file named <code class="literal">build.sh</code>. This file contains the logic that is run when the custom build runs:
						</p><pre class="programlisting language-terminal">#!/bin/sh
# Note that in this case the build inputs are part of the custom builder image, but normally this
# is retrieved from an external source.
cd /tmp/input
# OUTPUT_REGISTRY and OUTPUT_IMAGE are env variables provided by the custom
# build framework
TAG="${OUTPUT_REGISTRY}/${OUTPUT_IMAGE}"


# performs the build of the new image defined by dockerfile.sample
buildah --storage-driver vfs bud --isolation chroot -t ${TAG} .


# buildah requires a slight modification to the push secret provided by the service
# account to use it for pushing the image
cp /var/run/secrets/openshift.io/push/.dockercfg /tmp
(echo "{ \"auths\": " ; cat /var/run/secrets/openshift.io/push/.dockercfg ; echo "}") &gt; /tmp/.dockercfg


# push the new image to the target for the build
buildah --storage-driver vfs push --tls-verify=false --authfile /tmp/.dockercfg ${TAG}</pre></li></ol></div></section><section class="section" id="builds-build-custom-builder-image_custom-builds-buildah"><div class="titlepage"><div><div><h3 class="title">2.6.3. Build custom builder image</h3></div></div></div><p>
					You can use OpenShift Container Platform to build and push custom builder images to use in a custom strategy.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Define all the inputs that will go into creating your new custom builder image.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Define a <code class="literal">BuildConfig</code> object that will build your custom builder image:
						</p><pre class="programlisting language-terminal">$ oc new-build --binary --strategy=docker --name custom-builder-image</pre></li><li class="listitem"><p class="simpara">
							From the directory in which you created your custom build image, run the build:
						</p><pre class="programlisting language-terminal">$ oc start-build custom-builder-image --from-dir . -F</pre><p class="simpara">
							After the build completes, your new custom builder image is available in your project in an image stream tag that is named <code class="literal">custom-builder-image:latest</code>.
						</p></li></ol></div></section><section class="section" id="builds-use-custom-builder-image_custom-builds-buildah"><div class="titlepage"><div><div><h3 class="title">2.6.4. Use custom builder image</h3></div></div></div><p>
					You can define a <code class="literal">BuildConfig</code> object that uses the custom strategy in conjunction with your custom builder image to execute your custom build logic.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Define all the required inputs for new custom builder image.
						</li><li class="listitem">
							Build your custom builder image.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a file named <code class="literal">buildconfig.yaml</code>. This file defines the <code class="literal">BuildConfig</code> object that is created in your project and executed:
						</p><pre class="programlisting language-yaml">kind: BuildConfig
apiVersion: build.openshift.io/v1
metadata:
  name: sample-custom-build
  labels:
    name: sample-custom-build
  annotations:
    template.alpha.openshift.io/wait-for-ready: 'true'
spec:
  strategy:
    type: Custom
    customStrategy:
      forcePull: true
      from:
        kind: ImageStreamTag
        name: custom-builder-image:latest
        namespace: &lt;yourproject&gt; <span id="CO21-1"><!--Empty--></span><span class="callout">1</span>
  output:
    to:
      kind: ImageStreamTag
      name: sample-custom:latest</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO21-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Specify your project name.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">BuildConfig</code>:
						</p><pre class="programlisting language-terminal">$ oc create -f buildconfig.yaml</pre></li><li class="listitem"><p class="simpara">
							Create a file named <code class="literal">imagestream.yaml</code>. This file defines the image stream to which the build will push the image:
						</p><pre class="programlisting language-yaml">kind: ImageStream
apiVersion: image.openshift.io/v1
metadata:
  name: sample-custom
spec: {}</pre></li><li class="listitem"><p class="simpara">
							Create the imagestream:
						</p><pre class="programlisting language-terminal">$ oc create -f imagestream.yaml</pre></li><li class="listitem"><p class="simpara">
							Run your custom build:
						</p><pre class="programlisting language-terminal">$ oc start-build sample-custom-build -F</pre><p class="simpara">
							When the build runs, it launches a pod running the custom builder image that was built earlier. The pod runs the <code class="literal">build.sh</code> logic that is defined as the entrypoint for the custom builder image. The <code class="literal">build.sh</code> logic invokes Buildah to build the <code class="literal">dockerfile.sample</code> that was embedded in the custom builder image, and then uses Buildah to push the new image to the <code class="literal">sample-custom image stream</code>.
						</p></li></ol></div></section></section><section class="section" id="basic-build-operations"><div class="titlepage"><div><div><h2 class="title">2.7. Performing and configuring basic builds</h2></div></div></div><p>
				The following sections provide instructions for basic build operations, including starting and canceling builds, editing <code class="literal">BuildConfigs</code>, deleting <code class="literal">BuildConfigs</code>, viewing build details, and accessing build logs.
			</p><section class="section" id="builds-basic-start-build_basic-build-operations"><div class="titlepage"><div><div><h3 class="title">2.7.1. Starting a build</h3></div></div></div><p>
					You can manually start a new build from an existing build configuration in your current project.
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						To manually start a build, enter the following command:
					</p></div><pre class="programlisting language-terminal">$ oc start-build &lt;buildconfig_name&gt;</pre><section class="section" id="builds-basic-start-re-run_basic-build-operations"><div class="titlepage"><div><div><h4 class="title">2.7.1.1. Re-running a build</h4></div></div></div><p>
						You can manually re-run a build using the <code class="literal">--from-build</code> flag.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To manually re-run a build, enter the following command:
							</p><pre class="programlisting language-terminal">$ oc start-build --from-build=&lt;build_name&gt;</pre></li></ul></div></section><section class="section" id="builds-basic-start-logs_basic-build-operations"><div class="titlepage"><div><div><h4 class="title">2.7.1.2. Streaming build logs</h4></div></div></div><p>
						You can specify the <code class="literal">--follow</code> flag to stream the build’s logs in <code class="literal">stdout</code>.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To manually stream a build’s logs in <code class="literal">stdout</code>, enter the following command:
							</p><pre class="programlisting language-terminal">$ oc start-build &lt;buildconfig_name&gt; --follow</pre></li></ul></div></section><section class="section" id="builds-basic-start-environment-variable_basic-build-operations"><div class="titlepage"><div><div><h4 class="title">2.7.1.3. Setting environment variables when starting a build</h4></div></div></div><p>
						You can specify the <code class="literal">--env</code> flag to set any desired environment variable for the build.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To specify a desired environment variable, enter the following command:
							</p><pre class="programlisting language-terminal">$ oc start-build &lt;buildconfig_name&gt; --env=&lt;key&gt;=&lt;value&gt;</pre></li></ul></div></section><section class="section" id="builds-basic-start-source_basic-build-operations"><div class="titlepage"><div><div><h4 class="title">2.7.1.4. Starting a build with source</h4></div></div></div><p>
						Rather than relying on a Git source pull or a Dockerfile for a build, you can also start a build by directly pushing your source, which could be the contents of a Git or SVN working directory, a set of pre-built binary artifacts you want to deploy, or a single file. This can be done by specifying one of the following options for the <code class="literal">start-build</code> command:
					</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 67%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140458472598880" scope="col">Option</th><th align="left" valign="top" id="idm140458472597792" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140458472598880"> <p>
										<code class="literal">--from-dir=&lt;directory&gt;</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140458472597792"> <p>
										Specifies a directory that will be archived and used as a binary input for the build.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140458472598880"> <p>
										<code class="literal">--from-file=&lt;file&gt;</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140458472597792"> <p>
										Specifies a single file that will be the only file in the build source. The file is placed in the root of an empty directory with the same file name as the original file provided.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140458472598880"> <p>
										<code class="literal">--from-repo=&lt;local_source_repo&gt;</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140458472597792"> <p>
										Specifies a path to a local repository to use as the binary input for a build. Add the <code class="literal">--commit</code> option to control which branch, tag, or commit is used for the build.
									</p>
									 </td></tr></tbody></table></div><p>
						When passing any of these options directly to the build, the contents are streamed to the build and override the current build source settings.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Builds triggered from binary input will not preserve the source on the server, so rebuilds triggered by base image changes will use the source specified in the build configuration.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Start a build from a source using the following command to send the contents of a local Git repository as an archive from the tag <code class="literal">v2</code>:
							</p><pre class="programlisting language-terminal">$ oc start-build hello-world --from-repo=../hello-world --commit=v2</pre></li></ul></div></section></section><section class="section" id="builds-basic-cancel-build_basic-build-operations"><div class="titlepage"><div><div><h3 class="title">2.7.2. Canceling a build</h3></div></div></div><p>
					You can cancel a build using the web console, or with the following CLI command.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To manually cancel a build, enter the following command:
						</p><pre class="programlisting language-terminal">$ oc cancel-build &lt;build_name&gt;</pre></li></ul></div><section class="section" id="builds-basic-cancel-multiple_basic-build-operations"><div class="titlepage"><div><div><h4 class="title">2.7.2.1. Canceling multiple builds</h4></div></div></div><p>
						You can cancel multiple builds with the following CLI command.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To manually cancel multiple builds, enter the following command:
							</p><pre class="programlisting language-terminal">$ oc cancel-build &lt;build1_name&gt; &lt;build2_name&gt; &lt;build3_name&gt;</pre></li></ul></div></section><section class="section" id="builds-basic-cancel-all_basic-build-operations"><div class="titlepage"><div><div><h4 class="title">2.7.2.2. Canceling all builds</h4></div></div></div><p>
						You can cancel all builds from the build configuration with the following CLI command.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To cancel all builds, enter the following command:
							</p><pre class="programlisting language-terminal">$ oc cancel-build bc/&lt;buildconfig_name&gt;</pre></li></ul></div></section><section class="section" id="builds-basic-cancel-all-state_basic-build-operations"><div class="titlepage"><div><div><h4 class="title">2.7.2.3. Canceling all builds in a given state</h4></div></div></div><p>
						You can cancel all builds in a given state, such as <code class="literal">new</code> or <code class="literal">pending</code>, while ignoring the builds in other states.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To cancel all in a given state, enter the following command:
							</p><pre class="programlisting language-terminal">$ oc cancel-build bc/&lt;buildconfig_name&gt;</pre></li></ul></div></section></section><section class="section" id="builds-basic-edit-buildconfig_basic-build-operations"><div class="titlepage"><div><div><h3 class="title">2.7.3. Editing a BuildConfig</h3></div></div></div><p>
					To edit your build configurations, you use the <span class="strong strong"><strong>Edit BuildConfig</strong></span> option in the <span class="strong strong"><strong>Builds</strong></span> view of the <span class="strong strong"><strong>Developer</strong></span> perspective.
				</p><p>
					You can use either of the following views to edit a <code class="literal">BuildConfig</code>:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The <span class="strong strong"><strong>Form view</strong></span> enables you to edit your <code class="literal">BuildConfig</code> using the standard form fields and checkboxes.
						</li><li class="listitem">
							The <span class="strong strong"><strong>YAML view</strong></span> enables you to edit your <code class="literal">BuildConfig</code> with full control over the operations.
						</li></ul></div><p>
					You can switch between the <span class="strong strong"><strong>Form view</strong></span> and <span class="strong strong"><strong>YAML view</strong></span> without losing any data. The data in the <span class="strong strong"><strong>Form view</strong></span> is transferred to the <span class="strong strong"><strong>YAML view</strong></span> and vice versa.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the <span class="strong strong"><strong>Builds</strong></span> view of the <span class="strong strong"><strong>Developer</strong></span> perspective, click the menu 
							<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-CICD-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
							 to see the <span class="strong strong"><strong>Edit BuildConfig</strong></span> option.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Edit BuildConfig</strong></span> to see the <span class="strong strong"><strong>Form view</strong></span> option.
						</li><li class="listitem"><p class="simpara">
							In the <span class="strong strong"><strong>Git</strong></span> section, enter the Git repository URL for the codebase you want to use to create an application. The URL is then validated.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Optional: Click <span class="strong strong"><strong>Show Advanced Git Options</strong></span> to add details such as:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<span class="strong strong"><strong>Git Reference</strong></span> to specify a branch, tag, or commit that contains code you want to use to build the application.
										</li><li class="listitem">
											<span class="strong strong"><strong>Context Dir</strong></span> to specify the subdirectory that contains code you want to use to build the application.
										</li><li class="listitem">
											<span class="strong strong"><strong>Source Secret</strong></span> to create a <span class="strong strong"><strong>Secret Name</strong></span> with credentials for pulling your source code from a private repository.
										</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
							In the <span class="strong strong"><strong>Build from</strong></span> section, select the option that you would like to build from. You can use the following options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Image Stream tag</strong></span> references an image for a given image stream and tag. Enter the project, image stream, and tag of the location you would like to build from and push to.
								</li><li class="listitem">
									<span class="strong strong"><strong>Image Stream image</strong></span> references an image for a given image stream and image name. Enter the image stream image you would like to build from. Also enter the project, image stream, and tag to push to.
								</li><li class="listitem">
									<span class="strong strong"><strong>Docker image</strong></span>: The Docker image is referenced through a Docker image repository. You will also need to enter the project, image stream, and tag to refer to where you would like to push to.
								</li></ul></div></li><li class="listitem">
							Optional: In the <span class="strong strong"><strong>Environment Variables</strong></span> section, add the environment variables associated with the project by using the <span class="strong strong"><strong>Name</strong></span> and <span class="strong strong"><strong>Value</strong></span> fields. To add more environment variables, use <span class="strong strong"><strong>Add Value</strong></span>, or <span class="strong strong"><strong>Add from ConfigMap</strong></span> and <span class="strong strong"><strong>Secret</strong></span> .
						</li><li class="listitem"><p class="simpara">
							Optional: To further customize your application, use the following advanced options:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Trigger</span></dt><dd>
										Triggers a new image build when the builder image changes. Add more triggers by clicking <span class="strong strong"><strong>Add Trigger</strong></span> and selecting the <span class="strong strong"><strong>Type</strong></span> and <span class="strong strong"><strong>Secret</strong></span>.
									</dd><dt><span class="term">Secrets</span></dt><dd>
										Adds secrets for your application. Add more secrets by clicking <span class="strong strong"><strong>Add secret</strong></span> and selecting the <span class="strong strong"><strong>Secret</strong></span> and <span class="strong strong"><strong>Mount point</strong></span>.
									</dd><dt><span class="term">Policy</span></dt><dd>
										Click <span class="strong strong"><strong>Run policy</strong></span> to select the build run policy. The selected policy determines the order in which builds created from the build configuration must run.
									</dd><dt><span class="term">Hooks</span></dt><dd>
										Select <span class="strong strong"><strong>Run build hooks after image is built</strong></span> to run commands at the end of the build and verify the image. Add <span class="strong strong"><strong>Hook type</strong></span>, <span class="strong strong"><strong>Command</strong></span>, and <span class="strong strong"><strong>Arguments</strong></span> to append to the command.
									</dd></dl></div></li><li class="listitem">
							Click <span class="strong strong"><strong>Save</strong></span> to save the <code class="literal">BuildConfig</code>.
						</li></ol></div></section><section class="section" id="builds-basic-delete-buildconfig_basic-build-operations"><div class="titlepage"><div><div><h3 class="title">2.7.4. Deleting a BuildConfig</h3></div></div></div><p>
					You can delete a <code class="literal">BuildConfig</code> using the following command.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To delete a <code class="literal">BuildConfig</code>, enter the following command:
						</p><pre class="programlisting language-terminal">$ oc delete bc &lt;BuildConfigName&gt;</pre><p class="simpara">
							This also deletes all builds that were instantiated from this <code class="literal">BuildConfig</code>.
						</p></li><li class="listitem"><p class="simpara">
							To delete a <code class="literal">BuildConfig</code> and keep the builds instatiated from the <code class="literal">BuildConfig</code>, specify the <code class="literal">--cascade=false</code> flag when you enter the following command:
						</p><pre class="programlisting language-terminal">$ oc delete --cascade=false bc &lt;BuildConfigName&gt;</pre></li></ul></div></section><section class="section" id="builds-basic-view-build-details_basic-build-operations"><div class="titlepage"><div><div><h3 class="title">2.7.5. Viewing build details</h3></div></div></div><p>
					You can view build details with the web console or by using the <code class="literal">oc describe</code> CLI command.
				</p><p>
					This displays information including:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The build source.
						</li><li class="listitem">
							The build strategy.
						</li><li class="listitem">
							The output destination.
						</li><li class="listitem">
							Digest of the image in the destination registry.
						</li><li class="listitem">
							How the build was created.
						</li></ul></div><p>
					If the build uses the <code class="literal">Docker</code> or <code class="literal">Source</code> strategy, the <code class="literal">oc describe</code> output also includes information about the source revision used for the build, including the commit ID, author, committer, and message.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To view build details, enter the following command:
						</p><pre class="programlisting language-terminal">$ oc describe build &lt;build_name&gt;</pre></li></ul></div></section><section class="section" id="builds-basic-access-build-logs_basic-build-operations"><div class="titlepage"><div><div><h3 class="title">2.7.6. Accessing build logs</h3></div></div></div><p>
					You can access build logs using the web console or the CLI.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To stream the logs using the build directly, enter the following command:
						</p><pre class="programlisting language-terminal">$ oc describe build &lt;build_name&gt;</pre></li></ul></div><section class="section" id="builds-basic-access-buildconfig-logs_basic-build-operations"><div class="titlepage"><div><div><h4 class="title">2.7.6.1. Accessing BuildConfig logs</h4></div></div></div><p>
						You can access <code class="literal">BuildConfig</code> logs using the web console or the CLI.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To stream the logs of the latest build for a <code class="literal">BuildConfig</code>, enter the following command:
							</p><pre class="programlisting language-terminal">$ oc logs -f bc/&lt;buildconfig_name&gt;</pre></li></ul></div></section><section class="section" id="builds-basic-access-buildconfig-version-logs_basic-build-operations"><div class="titlepage"><div><div><h4 class="title">2.7.6.2. Accessing BuildConfig logs for a given version build</h4></div></div></div><p>
						You can access logs for a given version build for a <code class="literal">BuildConfig</code> using the web console or the CLI.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To stream the logs for a given version build for a <code class="literal">BuildConfig</code>, enter the following command:
							</p><pre class="programlisting language-terminal">$ oc logs --version=&lt;number&gt; bc/&lt;buildconfig_name&gt;</pre></li></ul></div></section><section class="section" id="builds-basic-access-build-verbosity_basic-build-operations"><div class="titlepage"><div><div><h4 class="title">2.7.6.3. Enabling log verbosity</h4></div></div></div><p>
						You can enable a more verbose output by passing the <code class="literal">BUILD_LOGLEVEL</code> environment variable as part of the <code class="literal">sourceStrategy</code> or <code class="literal">dockerStrategy</code> in a <code class="literal">BuildConfig</code>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							An administrator can set the default build verbosity for the entire OpenShift Container Platform instance by configuring <code class="literal">env/BUILD_LOGLEVEL</code>. This default can be overridden by specifying <code class="literal">BUILD_LOGLEVEL</code> in a given <code class="literal">BuildConfig</code>. You can specify a higher priority override on the command line for non-binary builds by passing <code class="literal">--build-loglevel</code> to <code class="literal">oc start-build</code>.
						</p></div></div><p>
						Available log levels for source builds are as follows:
					</p><div class="horizontal"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 15%; "><!--Empty--></col><col style="width: 85%; "><!--Empty--></col></colgroup><tbody valign="top"><tr><td valign="top"> <p>
										Level 0
									</p>
									 </td><td valign="top"> <p>
										Produces output from containers running the <code class="literal">assemble</code> script and all encountered errors. This is the default.
									</p>
									 </td></tr><tr><td valign="top"> <p>
										Level 1
									</p>
									 </td><td valign="top"> <p>
										Produces basic information about the executed process.
									</p>
									 </td></tr><tr><td valign="top"> <p>
										Level 2
									</p>
									 </td><td valign="top"> <p>
										Produces very detailed information about the executed process.
									</p>
									 </td></tr><tr><td valign="top"> <p>
										Level 3
									</p>
									 </td><td valign="top"> <p>
										Produces very detailed information about the executed process, and a listing of the archive contents.
									</p>
									 </td></tr><tr><td valign="top"> <p>
										Level 4
									</p>
									 </td><td valign="top"> <p>
										Currently produces the same information as level 3.
									</p>
									 </td></tr><tr><td valign="top"> <p>
										Level 5
									</p>
									 </td><td valign="top"> <p>
										Produces everything mentioned on previous levels and additionally provides docker push messages.
									</p>
									 </td></tr></tbody></table></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To enable more verbose output, pass the <code class="literal">BUILD_LOGLEVEL</code> environment variable as part of the <code class="literal">sourceStrategy</code> or <code class="literal">dockerStrategy</code> in a <code class="literal">BuildConfig</code>:
							</p><pre class="programlisting language-yaml">sourceStrategy:
...
  env:
    - name: "BUILD_LOGLEVEL"
      value: "2" <span id="CO22-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO22-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Adjust this value to the desired log level.
									</div></dd></dl></div></li></ul></div></section></section></section><section class="section" id="triggering-builds-build-hooks"><div class="titlepage"><div><div><h2 class="title">2.8. Triggering and modifying builds</h2></div></div></div><p>
				The following sections outline how to trigger builds and modify builds using build hooks.
			</p><section class="section" id="builds-triggers_triggering-builds-build-hooks"><div class="titlepage"><div><div><h3 class="title">2.8.1. Build triggers</h3></div></div></div><p>
					When defining a <code class="literal">BuildConfig</code>, you can define triggers to control the circumstances in which the <code class="literal">BuildConfig</code> should be run. The following build triggers are available:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Webhook
						</li><li class="listitem">
							Image change
						</li><li class="listitem">
							Configuration change
						</li></ul></div><section class="section" id="builds-webhook-triggers_triggering-builds-build-hooks"><div class="titlepage"><div><div><h4 class="title">2.8.1.1. Webhook triggers</h4></div></div></div><p>
						Webhook triggers allow you to trigger a new build by sending a request to the OpenShift Container Platform API endpoint. You can define these triggers using GitHub, GitLab, Bitbucket, or Generic webhooks.
					</p><p>
						Currently, OpenShift Container Platform webhooks only support the analogous versions of the push event for each of the Git-based Source Code Management (SCM) systems. All other event types are ignored.
					</p><p>
						When the push events are processed, the OpenShift Container Platform control plane host confirms if the branch reference inside the event matches the branch reference in the corresponding <code class="literal">BuildConfig</code>. If so, it then checks out the exact commit reference noted in the webhook event on the OpenShift Container Platform build. If they do not match, no build is triggered.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							<code class="literal">oc new-app</code> and <code class="literal">oc new-build</code> create GitHub and Generic webhook triggers automatically, but any other needed webhook triggers must be added manually. You can manually add triggers by setting triggers.
						</p></div></div><p>
						For all webhooks, you must define a secret with a key named <code class="literal">WebHookSecretKey</code> and the value being the value to be supplied when invoking the webhook. The webhook definition must then reference the secret. The secret ensures the uniqueness of the URL, preventing others from triggering the build. The value of the key is compared to the secret provided during the webhook invocation.
					</p><p>
						For example here is a GitHub webhook with a reference to a secret named <code class="literal">mysecret</code>:
					</p><pre class="programlisting language-yaml">type: "GitHub"
github:
  secretReference:
    name: "mysecret"</pre><p>
						The secret is then defined as follows. Note that the value of the secret is base64 encoded as is required for any <code class="literal">data</code> field of a <code class="literal">Secret</code> object.
					</p><pre class="programlisting language-yaml">- kind: Secret
  apiVersion: v1
  metadata:
    name: mysecret
    creationTimestamp:
  data:
    WebHookSecretKey: c2VjcmV0dmFsdWUx</pre><section class="section" id="builds-using-github-webhooks_triggering-builds-build-hooks"><div class="titlepage"><div><div><h5 class="title">2.8.1.1.1. Using GitHub webhooks</h5></div></div></div><p>
							GitHub webhooks handle the call made by GitHub when a repository is updated. When defining the trigger, you must specify a secret, which is part of the URL you supply to GitHub when configuring the webhook.
						</p><p>
							Example GitHub webhook definition:
						</p><pre class="programlisting language-yaml">type: "GitHub"
github:
  secretReference:
    name: "mysecret"</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The secret used in the webhook trigger configuration is not the same as <code class="literal">secret</code> field you encounter when configuring webhook in GitHub UI. The former is to make the webhook URL unique and hard to predict, the latter is an optional string field used to create HMAC hex digest of the body, which is sent as an <code class="literal">X-Hub-Signature</code> header.
							</p></div></div><p>
							The payload URL is returned as the GitHub Webhook URL by the <code class="literal">oc describe</code> command (see Displaying Webhook URLs), and is structured as follows:
						</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">https://&lt;openshift_api_host:port&gt;/apis/build.openshift.io/v1/namespaces/&lt;namespace&gt;/buildconfigs/&lt;name&gt;/webhooks/&lt;secret&gt;/github</pre>

							</p></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									Create a <code class="literal">BuildConfig</code> from a GitHub repository.
								</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									To configure a GitHub Webhook:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											After creating a <code class="literal">BuildConfig</code> from a GitHub repository, run:
										</p><pre class="programlisting language-terminal">$ oc describe bc/&lt;name-of-your-BuildConfig&gt;</pre><p class="simpara">
											This generates a webhook GitHub URL that looks like:
										</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
												
<pre class="programlisting language-terminal">&lt;https://api.starter-us-east-1.openshift.com:443/apis/build.openshift.io/v1/namespaces/&lt;namespace&gt;/buildconfigs/&lt;name&gt;/webhooks/&lt;secret&gt;/github</pre>

											</p></div></li><li class="listitem">
											Cut and paste this URL into GitHub, from the GitHub web console.
										</li><li class="listitem">
											In your GitHub repository, select <span class="strong strong"><strong>Add Webhook</strong></span> from <span class="strong strong"><strong>Settings → Webhooks</strong></span>.
										</li><li class="listitem">
											Paste the URL output into the <span class="strong strong"><strong>Payload URL</strong></span> field.
										</li><li class="listitem">
											Change the <span class="strong strong"><strong>Content Type</strong></span> from GitHub’s default <code class="literal">application/x-www-form-urlencoded</code> to <code class="literal">application/json</code>.
										</li><li class="listitem"><p class="simpara">
											Click <span class="strong strong"><strong>Add webhook</strong></span>.
										</p><p class="simpara">
											You should see a message from GitHub stating that your webhook was successfully configured.
										</p><p class="simpara">
											Now, when you push a change to your GitHub repository, a new build automatically starts, and upon a successful build a new deployment starts.
										</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												<a class="link" href="https://gogs.io">Gogs</a> supports the same webhook payload format as GitHub. Therefore, if you are using a Gogs server, you can define a GitHub webhook trigger on your <code class="literal">BuildConfig</code> and trigger it by your Gogs server as well.
											</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
									Given a file containing a valid JSON payload, such as <code class="literal">payload.json</code>, you can manually trigger the webhook with <code class="literal">curl</code>:
								</p><pre class="programlisting language-terminal">$ curl -H "X-GitHub-Event: push" -H "Content-Type: application/json" -k -X POST --data-binary @payload.json https://&lt;openshift_api_host:port&gt;/apis/build.openshift.io/v1/namespaces/&lt;namespace&gt;/buildconfigs/&lt;name&gt;/webhooks/&lt;secret&gt;/github</pre><p class="simpara">
									The <code class="literal">-k</code> argument is only necessary if your API server does not have a properly signed certificate.
								</p></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The build will only be triggered if the <code class="literal">ref</code> value from GitHub webhook event matches the <code class="literal">ref</code> value specified in the <code class="literal">source.git</code> field of the <code class="literal">BuildConfig</code> resource.
							</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
									<a class="link" href="https://gogs.io">Gogs</a>
								</li></ul></div></section><section class="section" id="builds-using-gitlab-webhooks_triggering-builds-build-hooks"><div class="titlepage"><div><div><h5 class="title">2.8.1.1.2. Using GitLab webhooks</h5></div></div></div><p>
							GitLab webhooks handle the call made by GitLab when a repository is updated. As with the GitHub triggers, you must specify a secret. The following example is a trigger definition YAML within the <code class="literal">BuildConfig</code>:
						</p><pre class="programlisting language-yaml">type: "GitLab"
gitlab:
  secretReference:
    name: "mysecret"</pre><p>
							The payload URL is returned as the GitLab Webhook URL by the <code class="literal">oc describe</code> command, and is structured as follows:
						</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">https://&lt;openshift_api_host:port&gt;/apis/build.openshift.io/v1/namespaces/&lt;namespace&gt;/buildconfigs/&lt;name&gt;/webhooks/&lt;secret&gt;/gitlab</pre>

							</p></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									To configure a GitLab Webhook:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Describe the <code class="literal">BuildConfig</code> to get the webhook URL:
										</p><pre class="programlisting language-terminal">$ oc describe bc &lt;name&gt;</pre></li><li class="listitem">
											Copy the webhook URL, replacing <code class="literal">&lt;secret&gt;</code> with your secret value.
										</li><li class="listitem">
											Follow the <a class="link" href="https://docs.gitlab.com/ce/user/project/integrations/webhooks.html#webhooks">GitLab setup instructions</a> to paste the webhook URL into your GitLab repository settings.
										</li></ol></div></li><li class="listitem"><p class="simpara">
									Given a file containing a valid JSON payload, such as <code class="literal">payload.json</code>, you can manually trigger the webhook with <code class="literal">curl</code>:
								</p><pre class="programlisting language-terminal">$ curl -H "X-GitLab-Event: Push Hook" -H "Content-Type: application/json" -k -X POST --data-binary @payload.json https://&lt;openshift_api_host:port&gt;/apis/build.openshift.io/v1/namespaces/&lt;namespace&gt;/buildconfigs/&lt;name&gt;/webhooks/&lt;secret&gt;/gitlab</pre><p class="simpara">
									The <code class="literal">-k</code> argument is only necessary if your API server does not have a properly signed certificate.
								</p></li></ol></div></section><section class="section" id="builds-using-bitbucket-webhooks_triggering-builds-build-hooks"><div class="titlepage"><div><div><h5 class="title">2.8.1.1.3. Using Bitbucket webhooks</h5></div></div></div><p>
							<a class="link" href="https://confluence.atlassian.com/bitbucket/manage-webhooks-735643732.html">Bitbucket webhooks</a> handle the call made by Bitbucket when a repository is updated. Similar to the previous triggers, you must specify a secret. The following example is a trigger definition YAML within the <code class="literal">BuildConfig</code>:
						</p><pre class="programlisting language-yaml">type: "Bitbucket"
bitbucket:
  secretReference:
    name: "mysecret"</pre><p>
							The payload URL is returned as the Bitbucket Webhook URL by the <code class="literal">oc describe</code> command, and is structured as follows:
						</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">https://&lt;openshift_api_host:port&gt;/apis/build.openshift.io/v1/namespaces/&lt;namespace&gt;/buildconfigs/&lt;name&gt;/webhooks/&lt;secret&gt;/bitbucket</pre>

							</p></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									To configure a Bitbucket Webhook:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Describe the 'BuildConfig' to get the webhook URL:
										</p><pre class="programlisting language-terminal">$ oc describe bc &lt;name&gt;</pre></li><li class="listitem">
											Copy the webhook URL, replacing <code class="literal">&lt;secret&gt;</code> with your secret value.
										</li><li class="listitem">
											Follow the <a class="link" href="https://confluence.atlassian.com/bitbucket/manage-webhooks-735643732.html">Bitbucket setup instructions</a> to paste the webhook URL into your Bitbucket repository settings.
										</li></ol></div></li><li class="listitem"><p class="simpara">
									Given a file containing a valid JSON payload, such as <code class="literal">payload.json</code>, you can manually trigger the webhook with <code class="literal">curl</code>:
								</p><pre class="programlisting language-terminal">$ curl -H "X-Event-Key: repo:push" -H "Content-Type: application/json" -k -X POST --data-binary @payload.json https://&lt;openshift_api_host:port&gt;/apis/build.openshift.io/v1/namespaces/&lt;namespace&gt;/buildconfigs/&lt;name&gt;/webhooks/&lt;secret&gt;/bitbucket</pre><p class="simpara">
									The <code class="literal">-k</code> argument is only necessary if your API server does not have a properly signed certificate.
								</p></li></ol></div></section><section class="section" id="builds-using-generic-webhooks_triggering-builds-build-hooks"><div class="titlepage"><div><div><h5 class="title">2.8.1.1.4. Using generic webhooks</h5></div></div></div><p>
							Generic webhooks are invoked from any system capable of making a web request. As with the other webhooks, you must specify a secret, which is part of the URL that the caller must use to trigger the build. The secret ensures the uniqueness of the URL, preventing others from triggering the build. The following is an example trigger definition YAML within the <code class="literal">BuildConfig</code>:
						</p><pre class="programlisting language-yaml">type: "Generic"
generic:
  secretReference:
    name: "mysecret"
  allowEnv: true <span id="CO23-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO23-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Set to <code class="literal">true</code> to allow a generic webhook to pass in environment variables.
								</div></dd></dl></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									To set up the caller, supply the calling system with the URL of the generic webhook endpoint for your build:
								</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">https://&lt;openshift_api_host:port&gt;/apis/build.openshift.io/v1/namespaces/&lt;namespace&gt;/buildconfigs/&lt;name&gt;/webhooks/&lt;secret&gt;/generic</pre>

									</p></div><p class="simpara">
									The caller must invoke the webhook as a <code class="literal">POST</code> operation.
								</p></li><li class="listitem"><p class="simpara">
									To invoke the webhook manually you can use <code class="literal">curl</code>:
								</p><pre class="programlisting language-terminal">$ curl -X POST -k https://&lt;openshift_api_host:port&gt;/apis/build.openshift.io/v1/namespaces/&lt;namespace&gt;/buildconfigs/&lt;name&gt;/webhooks/&lt;secret&gt;/generic</pre><p class="simpara">
									The HTTP verb must be set to <code class="literal">POST</code>. The insecure <code class="literal">-k</code> flag is specified to ignore certificate validation. This second flag is not necessary if your cluster has properly signed certificates.
								</p><p class="simpara">
									The endpoint can accept an optional payload with the following format:
								</p><pre class="programlisting language-yaml">git:
  uri: "&lt;url to git repository&gt;"
  ref: "&lt;optional git reference&gt;"
  commit: "&lt;commit hash identifying a specific git commit&gt;"
  author:
    name: "&lt;author name&gt;"
    email: "&lt;author e-mail&gt;"
  committer:
    name: "&lt;committer name&gt;"
    email: "&lt;committer e-mail&gt;"
  message: "&lt;commit message&gt;"
env: <span id="CO24-1"><!--Empty--></span><span class="callout">1</span>
   - name: "&lt;variable name&gt;"
     value: "&lt;variable value&gt;"</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO24-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Similar to the <code class="literal">BuildConfig</code> environment variables, the environment variables defined here are made available to your build. If these variables collide with the <code class="literal">BuildConfig</code> environment variables, these variables take precedence. By default, environment variables passed by webhook are ignored. Set the <code class="literal">allowEnv</code> field to <code class="literal">true</code> on the webhook definition to enable this behavior.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									To pass this payload using <code class="literal">curl</code>, define it in a file named <code class="literal">payload_file.yaml</code> and run:
								</p><pre class="programlisting language-terminal">$ curl -H "Content-Type: application/yaml" --data-binary @payload_file.yaml -X POST -k https://&lt;openshift_api_host:port&gt;/apis/build.openshift.io/v1/namespaces/&lt;namespace&gt;/buildconfigs/&lt;name&gt;/webhooks/&lt;secret&gt;/generic</pre><p class="simpara">
									The arguments are the same as the previous example with the addition of a header and a payload. The <code class="literal">-H</code> argument sets the <code class="literal">Content-Type</code> header to <code class="literal">application/yaml</code> or <code class="literal">application/json</code> depending on your payload format. The <code class="literal">--data-binary</code> argument is used to send a binary payload with newlines intact with the <code class="literal">POST</code> request.
								</p></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								OpenShift Container Platform permits builds to be triggered by the generic webhook even if an invalid request payload is presented, for example, invalid content type, unparsable or invalid content, and so on. This behavior is maintained for backwards compatibility. If an invalid request payload is presented, OpenShift Container Platform returns a warning in JSON format as part of its <code class="literal">HTTP 200 OK</code> response.
							</p></div></div></section><section class="section" id="builds-displaying-webhook-urls_triggering-builds-build-hooks"><div class="titlepage"><div><div><h5 class="title">2.8.1.1.5. Displaying webhook URLs</h5></div></div></div><p>
							You can use the following command to display webhook URLs associated with a build configuration. If the command does not display any webhook URLs, then no webhook trigger is defined for that build configuration.
						</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									To display any webhook URLs associated with a <code class="literal">BuildConfig</code>, run:
								</li></ul></div><pre class="programlisting language-terminal">$ oc describe bc &lt;name&gt;</pre></section></section><section class="section" id="builds-using-image-change-triggers_triggering-builds-build-hooks"><div class="titlepage"><div><div><h4 class="title">2.8.1.2. Using image change triggers</h4></div></div></div><p>
						As a developer, you can configure your build to run automatically every time a base image changes.
					</p><p>
						You can use image change triggers to automatically invoke your build when a new version of an upstream image is available. For example, if a build is based on a RHEL image, you can trigger that build to run any time the RHEL image changes. As a result, the application image is always running on the latest RHEL base image.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Image streams that point to container images in <a class="link" href="http://docs.docker.com/v1.7/reference/api/hub_registry_spec/#docker-registry-1-0">v1 container registries</a> only trigger a build once when the image stream tag becomes available and not on subsequent image updates. This is due to the lack of uniquely identifiable images in v1 container registries.
						</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Define an <code class="literal">ImageStream</code> that points to the upstream image you want to use as a trigger:
							</p><pre class="programlisting language-yaml">kind: "ImageStream"
apiVersion: "v1"
metadata:
  name: "ruby-20-centos7"</pre><p class="simpara">
								This defines the image stream that is tied to a container image repository located at <code class="literal"><span class="emphasis"><em>&lt;system-registry&gt;</em></span>/<span class="emphasis"><em>&lt;namespace&gt;</em></span>/ruby-20-centos7</code>. The <code class="literal">&lt;system-registry&gt;</code> is defined as a service with the name <code class="literal">docker-registry</code> running in OpenShift Container Platform.
							</p></li><li class="listitem"><p class="simpara">
								If an image stream is the base image for the build, set the <code class="literal">from</code> field in the build strategy to point to the <code class="literal">ImageStream</code>:
							</p><pre class="programlisting language-yaml">strategy:
  sourceStrategy:
    from:
      kind: "ImageStreamTag"
      name: "ruby-20-centos7:latest"</pre><p class="simpara">
								In this case, the <code class="literal">sourceStrategy</code> definition is consuming the <code class="literal">latest</code> tag of the image stream named <code class="literal">ruby-20-centos7</code> located within this namespace.
							</p></li><li class="listitem"><p class="simpara">
								Define a build with one or more triggers that point to <code class="literal">ImageStreams</code>:
							</p><pre class="programlisting language-yaml">type: "ImageChange" <span id="CO25-1"><!--Empty--></span><span class="callout">1</span>
imageChange: {}
type: "ImageChange" <span id="CO25-2"><!--Empty--></span><span class="callout">2</span>
imageChange:
  from:
    kind: "ImageStreamTag"
    name: "custom-image:latest"</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO25-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										An image change trigger that monitors the <code class="literal">ImageStream</code> and <code class="literal">Tag</code> as defined by the build strategy’s <code class="literal">from</code> field. The <code class="literal">imageChange</code> object here must be empty.
									</div></dd><dt><a href="#CO25-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										An image change trigger that monitors an arbitrary image stream. The <code class="literal">imageChange</code> part, in this case, must include a <code class="literal">from</code> field that references the <code class="literal">ImageStreamTag</code> to monitor.
									</div></dd></dl></div></li></ol></div><p>
						When using an image change trigger for the strategy image stream, the generated build is supplied with an immutable docker tag that points to the latest image corresponding to that tag. This new image reference is used by the strategy when it executes for the build.
					</p><p>
						For other image change triggers that do not reference the strategy image stream, a new build is started, but the build strategy is not updated with a unique image reference.
					</p><p>
						Since this example has an image change trigger for the strategy, the resulting build is:
					</p><pre class="programlisting language-yaml">strategy:
  sourceStrategy:
    from:
      kind: "DockerImage"
      name: "172.30.17.3:5001/mynamespace/ruby-20-centos7:&lt;immutableid&gt;"</pre><p>
						This ensures that the triggered build uses the new image that was just pushed to the repository, and the build can be re-run any time with the same inputs.
					</p><p>
						You can pause an image change trigger to allow multiple changes on the referenced image stream before a build is started. You can also set the <code class="literal">paused</code> attribute to true when initially adding an <code class="literal">ImageChangeTrigger</code> to a <code class="literal">BuildConfig</code> to prevent a build from being immediately triggered.
					</p><pre class="programlisting language-yaml">type: "ImageChange"
imageChange:
  from:
    kind: "ImageStreamTag"
    name: "custom-image:latest"
  paused: true</pre><p>
						In addition to setting the image field for all <code class="literal">Strategy</code> types, for custom builds, the <code class="literal">OPENSHIFT_CUSTOM_BUILD_BASE_IMAGE</code> environment variable is checked. If it does not exist, then it is created with the immutable image reference. If it does exist, then it is updated with the immutable image reference.
					</p><p>
						If a build is triggered due to a webhook trigger or manual request, the build that is created uses the <code class="literal">&lt;immutableid&gt;</code> resolved from the <code class="literal">ImageStream</code> referenced by the <code class="literal">Strategy</code>. This ensures that builds are performed using consistent image tags for ease of reproduction.
					</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="http://docs.docker.com/v1.7/reference/api/hub_registry_spec/#docker-registry-1-0">v1 container registries</a>
							</li></ul></div></section><section class="section" id="builds-image-change-trigger-identification_triggering-builds-build-hooks"><div class="titlepage"><div><div><h4 class="title">2.8.1.3. Identifying the image change trigger of a build</h4></div></div></div><p>
						As a developer, if you have image change triggers, you can identify which image change initiated the last build. This can be useful for debugging or troubleshooting builds.
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">BuildConfig</code></strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: build.openshift.io/v1
kind: BuildConfig
metadata:
  name: bc-ict-example
  namespace: bc-ict-example-namespace
spec:

# ...

  triggers:
  - imageChange:
      from:
        kind: ImageStreamTag
        name: input:latest
        namespace: bc-ict-example-namespace
  - imageChange:
      from:
        kind: ImageStreamTag
        name: input2:latest
        namespace: bc-ict-example-namespace
    type: ImageChange
status:
  imageChangeTriggers:
  - from:
      name: input:latest
      namespace: bc-ict-example-namespace
    lastTriggerTime: "2021-06-30T13:47:53Z"
    lastTriggeredImageID: image-registry.openshift-image-registry.svc:5000/bc-ict-example-namespace/input@sha256:0f88ffbeb9d25525720bfa3524cb1bf0908b7f791057cf1acfae917b11266a69
  - from:
      name: input2:latest
      namespace: bc-ict-example-namespace
    lastTriggeredImageID:  image-registry.openshift-image-registry.svc:5000/bc-ict-example-namespace/input2@sha256:0f88ffbeb9d25525720bfa3524cb2ce0908b7f791057cf1acfae917b11266a69

  lastVersion: 1</pre>

						</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							This example omits elements that are not related to image change triggers.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have configured multiple image change triggers. These triggers have triggered one or more builds.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								In <code class="literal">buildConfig.status.imageChangeTriggers</code> to identify the <code class="literal">lastTriggerTime</code> that has the latest timestamp.
							</p><p class="simpara">
								This <code class="literal">ImageChangeTriggerStatus</code>
							</p><pre class="literallayout">Then you use the `name` and `namespace` from that build to find the corresponding image change trigger in `buildConfig.spec.triggers`.</pre></li><li class="listitem">
								Under <code class="literal">imageChangeTriggers</code>, compare timestamps to identify the latest
							</li></ol></div><div class="formalpara"><p class="title"><strong>Image change triggers</strong></p><p>
							In your build configuration, <code class="literal">buildConfig.spec.triggers</code> is an array of build trigger policies, <code class="literal">BuildTriggerPolicy</code>.
						</p></div><p>
						Each <code class="literal">BuildTriggerPolicy</code> has a <code class="literal">type</code> field and set of pointers fields. Each pointer field corresponds to one of the allowed values for the <code class="literal">type</code> field. As such, you can only set <code class="literal">BuildTriggerPolicy</code> to only one pointer field.
					</p><p>
						For image change triggers, the value of <code class="literal">type</code> is <code class="literal">ImageChange</code>. Then, the <code class="literal">imageChange</code> field is the pointer to an <code class="literal">ImageChangeTrigger</code> object, which has the following fields:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">lastTriggeredImageID</code>: This field, which is not shown in the example, is deprecated in OpenShift Container Platform 4.8 and will be ignored in a future release. It contains the resolved image reference for the <code class="literal">ImageStreamTag</code> when the last build was triggered from this <code class="literal">BuildConfig</code>.
							</li><li class="listitem">
								<code class="literal">paused</code>: You can use this field, which is not shown in the example, to temporarily disable this particular image change trigger.
							</li><li class="listitem">
								<code class="literal">from</code>: You use this field to reference the <code class="literal">ImageStreamTag</code> that drives this image change trigger. Its type is the core Kubernetes type, <code class="literal">OwnerReference</code>.
							</li></ul></div><p>
						The <code class="literal">from</code> field has the following fields of note: <span class="strong strong"><strong> <code class="literal">kind</code>: For image change triggers, the only supported value is <code class="literal">ImageStreamTag</code>. </strong></span> <code class="literal">namespace</code>: You use this field to specify the namespace of the <code class="literal">ImageStreamTag</code>. ** <code class="literal">name</code>: You use this field to specify the <code class="literal">ImageStreamTag</code>.
					</p><div class="formalpara"><p class="title"><strong>Image change trigger status</strong></p><p>
							In your build configuration, <code class="literal">buildConfig.status.imageChangeTriggers</code> is an array of <code class="literal">ImageChangeTriggerStatus</code> elements. Each <code class="literal">ImageChangeTriggerStatus</code> element includes the <code class="literal">from</code>, <code class="literal">lastTriggeredImageID</code>, and <code class="literal">lastTriggerTime</code> elements shown in the preceding example.
						</p></div><p>
						The <code class="literal">ImageChangeTriggerStatus</code> that has the most recent <code class="literal">lastTriggerTime</code> triggered the most recent build. You use its <code class="literal">name</code> and <code class="literal">namespace</code> to identify the image change trigger in <code class="literal">buildConfig.spec.triggers</code> that triggered the build.
					</p><p>
						The <code class="literal">lastTriggerTime</code> with the most recent timestamp signifies the <code class="literal">ImageChangeTriggerStatus</code> of the last build. This <code class="literal">ImageChangeTriggerStatus</code> has the same <code class="literal">name</code> and <code class="literal">namespace</code> as the image change trigger in <code class="literal">buildConfig.spec.triggers</code> that triggered the build.
					</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="http://docs.docker.com/v1.7/reference/api/hub_registry_spec/#docker-registry-1-0">v1 container registries</a>
							</li></ul></div></section><section class="section" id="builds-configuration-change-triggers_triggering-builds-build-hooks"><div class="titlepage"><div><div><h4 class="title">2.8.1.4. Configuration change triggers</h4></div></div></div><p>
						A configuration change trigger allows a build to be automatically invoked as soon as a new <code class="literal">BuildConfig</code> is created.
					</p><p>
						The following is an example trigger definition YAML within the <code class="literal">BuildConfig</code>:
					</p><pre class="programlisting language-yaml">  type: "ConfigChange"</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Configuration change triggers currently only work when creating a new <code class="literal">BuildConfig</code>. In a future release, configuration change triggers will also be able to launch a build whenever a <code class="literal">BuildConfig</code> is updated.
						</p></div></div><section class="section" id="builds-setting-triggers-manually_triggering-builds-build-hooks"><div class="titlepage"><div><div><h5 class="title">2.8.1.4.1. Setting triggers manually</h5></div></div></div><p>
							Triggers can be added to and removed from build configurations with <code class="literal">oc set triggers</code>.
						</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To set a GitHub webhook trigger on a build configuration, use:
								</p><pre class="programlisting language-terminal">$ oc set triggers bc &lt;name&gt; --from-github</pre></li><li class="listitem"><p class="simpara">
									To set an imagechange trigger, use:
								</p><pre class="programlisting language-terminal">$ oc set triggers bc &lt;name&gt; --from-image='&lt;image&gt;'</pre></li><li class="listitem"><p class="simpara">
									To remove a trigger, add <code class="literal">--remove</code>:
								</p><pre class="programlisting language-terminal">$ oc set triggers bc &lt;name&gt; --from-bitbucket --remove</pre></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								When a webhook trigger already exists, adding it again regenerates the webhook secret.
							</p></div></div><p>
							For more information, consult the help documentation with by running:
						</p><pre class="programlisting language-terminal">$ oc set triggers --help</pre></section></section></section><section class="section" id="builds-build-hooks_triggering-builds-build-hooks"><div class="titlepage"><div><div><h3 class="title">2.8.2. Build hooks</h3></div></div></div><p>
					Build hooks allow behavior to be injected into the build process.
				</p><p>
					The <code class="literal">postCommit</code> field of a <code class="literal">BuildConfig</code> object runs commands inside a temporary container that is running the build output image. The hook is run immediately after the last layer of the image has been committed and before the image is pushed to a registry.
				</p><p>
					The current working directory is set to the image’s <code class="literal">WORKDIR</code>, which is the default working directory of the container image. For most images, this is where the source code is located.
				</p><p>
					The hook fails if the script or command returns a non-zero exit code or if starting the temporary container fails. When the hook fails it marks the build as failed and the image is not pushed to a registry. The reason for failing can be inspected by looking at the build logs.
				</p><p>
					Build hooks can be used to run unit tests to verify the image before the build is marked complete and the image is made available in a registry. If all tests pass and the test runner returns with exit code <code class="literal">0</code>, the build is marked successful. In case of any test failure, the build is marked as failed. In all cases, the build log contains the output of the test runner, which can be used to identify failed tests.
				</p><p>
					The <code class="literal">postCommit</code> hook is not only limited to running tests, but can be used for other commands as well. Since it runs in a temporary container, changes made by the hook do not persist, meaning that running the hook cannot affect the final image. This behavior allows for, among other uses, the installation and usage of test dependencies that are automatically discarded and are not present in the final image.
				</p><section class="section" id="builds-configuring-post-commit-build-hooks_triggering-builds-build-hooks"><div class="titlepage"><div><div><h4 class="title">2.8.2.1. Configuring post commit build hooks</h4></div></div></div><p>
						There are different ways to configure the post build hook. All forms in the following examples are equivalent and run <code class="literal">bundle exec rake test --verbose</code>.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Shell script:
							</p><pre class="programlisting language-yaml">postCommit:
  script: "bundle exec rake test --verbose"</pre><p class="simpara">
								The <code class="literal">script</code> value is a shell script to be run with <code class="literal">/bin/sh -ic</code>. Use this when a shell script is appropriate to execute the build hook. For example, for running unit tests as above. To control the image entry point, or if the image does not have <code class="literal">/bin/sh</code>, use <code class="literal">command</code> and/or <code class="literal">args</code>.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The additional <code class="literal">-i</code> flag was introduced to improve the experience working with CentOS and RHEL images, and may be removed in a future release.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Command as the image entry point:
							</p><pre class="programlisting language-yaml">postCommit:
  command: ["/bin/bash", "-c", "bundle exec rake test --verbose"]</pre><p class="simpara">
								In this form, <code class="literal">command</code> is the command to run, which overrides the image entry point in the exec form, as documented in the <a class="link" href="https://docs.docker.com/engine/reference/builder/#entrypoint">Dockerfile reference</a>. This is needed if the image does not have <code class="literal">/bin/sh</code>, or if you do not want to use a shell. In all other cases, using <code class="literal">script</code> might be more convenient.
							</p></li><li class="listitem"><p class="simpara">
								Command with arguments:
							</p><pre class="programlisting language-yaml">postCommit:
  command: ["bundle", "exec", "rake", "test"]
  args: ["--verbose"]</pre><p class="simpara">
								This form is equivalent to appending the arguments to <code class="literal">command</code>.
							</p></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Providing both <code class="literal">script</code> and <code class="literal">command</code> simultaneously creates an invalid build hook.
						</p></div></div></section><section class="section" id="builds-using-cli-post-commit-build-hooks_triggering-builds-build-hooks"><div class="titlepage"><div><div><h4 class="title">2.8.2.2. Using the CLI to set post commit build hooks</h4></div></div></div><p>
						The <code class="literal">oc set build-hook</code> command can be used to set the build hook for a build configuration.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To set a command as the post-commit build hook:
							</p><pre class="programlisting language-terminal">$ oc set build-hook bc/mybc \
    --post-commit \
    --command \
    -- bundle exec rake test --verbose</pre></li><li class="listitem"><p class="simpara">
								To set a script as the post-commit build hook:
							</p><pre class="programlisting language-terminal">$ oc set build-hook bc/mybc --post-commit --script="bundle exec rake test --verbose"</pre></li></ol></div></section></section></section><section class="section" id="advanced-build-operations"><div class="titlepage"><div><div><h2 class="title">2.9. Performing advanced builds</h2></div></div></div><p>
				The following sections provide instructions for advanced build operations including setting build resources and maximum duration, assigning builds to nodes, chaining builds, build pruning, and build run policies.
			</p><section class="section" id="builds-setting-build-resources_advanced-build-operations"><div class="titlepage"><div><div><h3 class="title">2.9.1. Setting build resources</h3></div></div></div><p>
					By default, builds are completed by pods using unbound resources, such as memory and CPU. These resources can be limited.
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						You can limit resource use in two ways:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Limit resource use by specifying resource limits in the default container limits of a project.
						</li><li class="listitem"><p class="simpara">
							Limit resource use by specifying resource limits as part of the build configuration. ** In the following example, each of the <code class="literal">resources</code>, <code class="literal">cpu</code>, and <code class="literal">memory</code> parameters are optional:
						</p><pre class="programlisting language-yaml">apiVersion: "v1"
kind: "BuildConfig"
metadata:
  name: "sample-build"
spec:
  resources:
    limits:
      cpu: "100m" <span id="CO26-1"><!--Empty--></span><span class="callout">1</span>
      memory: "256Mi" <span id="CO26-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO26-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									<code class="literal">cpu</code> is in CPU units: <code class="literal">100m</code> represents 0.1 CPU units (100 * 1e-3).
								</div></dd><dt><a href="#CO26-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									<code class="literal">memory</code> is in bytes: <code class="literal">256Mi</code> represents 268435456 bytes (256 * 2 ^ 20).
								</div></dd></dl></div><p class="simpara">
							However, if a quota has been defined for your project, one of the following two items is required:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
									A <code class="literal">resources</code> section set with an explicit <code class="literal">requests</code>:
								</p><pre class="programlisting language-yaml">resources:
  requests: <span id="CO27-1"><!--Empty--></span><span class="callout">1</span>
    cpu: "100m"
    memory: "256Mi"</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO27-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											The <code class="literal">requests</code> object contains the list of resources that correspond to the list of resources in the quota.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									A limit range defined in your project, where the defaults from the <code class="literal">LimitRange</code> object apply to pods created during the build process.
								</p><p class="simpara">
									Otherwise, build pod creation will fail, citing a failure to satisfy quota.
								</p></li></ul></div></li></ul></div></section><section class="section" id="builds-setting-maximum-duration_advanced-build-operations"><div class="titlepage"><div><div><h3 class="title">2.9.2. Setting maximum duration</h3></div></div></div><p>
					When defining a <code class="literal">BuildConfig</code> object, you can define its maximum duration by setting the <code class="literal">completionDeadlineSeconds</code> field. It is specified in seconds and is not set by default. When not set, there is no maximum duration enforced.
				</p><p>
					The maximum duration is counted from the time when a build pod gets scheduled in the system, and defines how long it can be active, including the time needed to pull the builder image. After reaching the specified timeout, the build is terminated by OpenShift Container Platform.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To set maximum duration, specify <code class="literal">completionDeadlineSeconds</code> in your <code class="literal">BuildConfig</code>. The following example shows the part of a <code class="literal">BuildConfig</code> specifying <code class="literal">completionDeadlineSeconds</code> field for 30 minutes:
						</p><pre class="programlisting language-yaml">spec:
  completionDeadlineSeconds: 1800</pre></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						This setting is not supported with the Pipeline Strategy option.
					</p></div></div></section><section class="section" id="builds-assigning-builds-to-nodes_advanced-build-operations"><div class="titlepage"><div><div><h3 class="title">2.9.3. Assigning builds to specific nodes</h3></div></div></div><p>
					Builds can be targeted to run on specific nodes by specifying labels in the <code class="literal">nodeSelector</code> field of a build configuration. The <code class="literal">nodeSelector</code> value is a set of key-value pairs that are matched to <code class="literal">Node</code> labels when scheduling the build pod.
				</p><p>
					The <code class="literal">nodeSelector</code> value can also be controlled by cluster-wide default and override values. Defaults will only be applied if the build configuration does not define any key-value pairs for the <code class="literal">nodeSelector</code> and also does not define an explicitly empty map value of <code class="literal">nodeSelector:{}</code>. Override values will replace values in the build configuration on a key by key basis.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If the specified <code class="literal">NodeSelector</code> cannot be matched to a node with those labels, the build still stay in the <code class="literal">Pending</code> state indefinitely.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Assign builds to run on specific nodes by assigning labels in the <code class="literal">nodeSelector</code> field of the <code class="literal">BuildConfig</code>, for example:
						</p><pre class="programlisting language-yaml">apiVersion: "v1"
kind: "BuildConfig"
metadata:
  name: "sample-build"
spec:
  nodeSelector:<span id="CO28-1"><!--Empty--></span><span class="callout">1</span>
    key1: value1
    key2: value2</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO28-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Builds associated with this build configuration will run only on nodes with the <code class="literal">key1=value2</code> and <code class="literal">key2=value2</code> labels.
								</div></dd></dl></div></li></ul></div></section><section class="section" id="builds-chaining-builds_advanced-build-operations"><div class="titlepage"><div><div><h3 class="title">2.9.4. Chained builds</h3></div></div></div><p>
					For compiled languages such as Go, C, C++, and Java, including the dependencies necessary for compilation in the application image might increase the size of the image or introduce vulnerabilities that can be exploited.
				</p><p>
					To avoid these problems, two builds can be chained together. One build that produces the compiled artifact, and a second build that places that artifact in a separate image that runs the artifact.
				</p><p>
					In the following example, a source-to-image (S2I) build is combined with a docker build to compile an artifact that is then placed in a separate runtime image.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Although this example chains a S2I build and a docker build, the first build can use any strategy that produces an image containing the desired artifacts, and the second build can use any strategy that can consume input content from an image.
					</p></div></div><p>
					The first build takes the application source and produces an image containing a <code class="literal">WAR</code> file. The image is pushed to the <code class="literal">artifact-image</code> image stream. The path of the output artifact depends on the <code class="literal">assemble</code> script of the S2I builder used. In this case, it is output to <code class="literal">/wildfly/standalone/deployments/ROOT.war</code>.
				</p><pre class="programlisting language-yaml">apiVersion: build.openshift.io/v1
kind: BuildConfig
metadata:
  name: artifact-build
spec:
  output:
    to:
      kind: ImageStreamTag
      name: artifact-image:latest
  source:
    git:
      uri: https://github.com/openshift/openshift-jee-sample.git
      ref: "master"
  strategy:
    sourceStrategy:
      from:
        kind: ImageStreamTag
        name: wildfly:10.1
        namespace: openshift</pre><p>
					The second build uses image source with a path to the WAR file inside the output image from the first build. An inline <code class="literal">dockerfile</code> copies that <code class="literal">WAR</code> file into a runtime image.
				</p><pre class="programlisting language-yaml">apiVersion: build.openshift.io/v1
kind: BuildConfig
metadata:
  name: image-build
spec:
  output:
    to:
      kind: ImageStreamTag
      name: image-build:latest
  source:
    dockerfile: |-
      FROM jee-runtime:latest
      COPY ROOT.war /deployments/ROOT.war
    images:
    - from: <span id="CO29-1"><!--Empty--></span><span class="callout">1</span>
        kind: ImageStreamTag
        name: artifact-image:latest
      paths: <span id="CO29-2"><!--Empty--></span><span class="callout">2</span>
      - sourcePath: /wildfly/standalone/deployments/ROOT.war
        destinationDir: "."
  strategy:
    dockerStrategy:
      from: <span id="CO29-3"><!--Empty--></span><span class="callout">3</span>
        kind: ImageStreamTag
        name: jee-runtime:latest
  triggers:
  - imageChange: {}
    type: ImageChange</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO29-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							<code class="literal">from</code> specifies that the docker build should include the output of the image from the <code class="literal">artifact-image</code> image stream, which was the target of the previous build.
						</div></dd><dt><a href="#CO29-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							<code class="literal">paths</code> specifies which paths from the target image to include in the current docker build.
						</div></dd><dt><a href="#CO29-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							The runtime image is used as the source image for the docker build.
						</div></dd></dl></div><p>
					The result of this setup is that the output image of the second build does not have to contain any of the build tools that are needed to create the <code class="literal">WAR</code> file. Also, because the second build contains an image change trigger, whenever the first build is run and produces a new image with the binary artifact, the second build is automatically triggered to produce a runtime image that contains that artifact. Therefore, both builds behave as a single build with two stages.
				</p></section><section class="section" id="builds-build-pruning_advanced-build-operations"><div class="titlepage"><div><div><h3 class="title">2.9.5. Pruning builds</h3></div></div></div><p>
					By default, builds that have completed their lifecycle are persisted indefinitely. You can limit the number of previous builds that are retained.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Limit the number of previous builds that are retained by supplying a positive integer value for <code class="literal">successfulBuildsHistoryLimit</code> or <code class="literal">failedBuildsHistoryLimit</code> in your <code class="literal">BuildConfig</code>, for example:
						</p><pre class="programlisting language-yaml">apiVersion: "v1"
kind: "BuildConfig"
metadata:
  name: "sample-build"
spec:
  successfulBuildsHistoryLimit: 2 <span id="CO30-1"><!--Empty--></span><span class="callout">1</span>
  failedBuildsHistoryLimit: 2 <span id="CO30-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO30-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									<code class="literal">successfulBuildsHistoryLimit</code> will retain up to two builds with a status of <code class="literal">completed</code>.
								</div></dd><dt><a href="#CO30-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									<code class="literal">failedBuildsHistoryLimit</code> will retain up to two builds with a status of <code class="literal">failed</code>, <code class="literal">canceled</code>, or <code class="literal">error</code>.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Trigger build pruning by one of the following actions:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Updating a build configuration.
								</li><li class="listitem">
									Waiting for a build to complete its lifecycle.
								</li></ul></div></li></ol></div><p>
					Builds are sorted by their creation timestamp with the oldest builds being pruned first.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Administrators can manually prune builds using the 'oc adm' object pruning command.
					</p></div></div></section><section class="section" id="builds-build-run-policy_advanced-build-operations"><div class="titlepage"><div><div><h3 class="title">2.9.6. Build run policy</h3></div></div></div><p>
					The build run policy describes the order in which the builds created from the build configuration should run. This can be done by changing the value of the <code class="literal">runPolicy</code> field in the <code class="literal">spec</code> section of the <code class="literal">Build</code> specification.
				</p><p>
					It is also possible to change the <code class="literal">runPolicy</code> value for existing build configurations, by:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Changing <code class="literal">Parallel</code> to <code class="literal">Serial</code> or <code class="literal">SerialLatestOnly</code> and triggering a new build from this configuration causes the new build to wait until all parallel builds complete as the serial build can only run alone.
						</li><li class="listitem">
							Changing <code class="literal">Serial</code> to <code class="literal">SerialLatestOnly</code> and triggering a new build causes cancellation of all existing builds in queue, except the currently running build and the most recently created build. The newest build runs next.
						</li></ul></div></section></section><section class="section" id="running-entitled-builds"><div class="titlepage"><div><div><h2 class="title">2.10. Using Red Hat subscriptions in builds</h2></div></div></div><p class="_abstract _abstract">
				Use the following sections to run entitled builds on OpenShift Container Platform.
			</p><section class="section" id="builds-create-imagestreamtag_running-entitled-builds"><div class="titlepage"><div><div><h3 class="title">2.10.1. Creating an image stream tag for the Red Hat Universal Base Image</h3></div></div></div><p>
					To use Red Hat subscriptions within a build, you create an image stream tag to reference the Universal Base Image (UBI).
				</p><p>
					To make the UBI available <span class="strong strong"><strong>in every project</strong></span> in the cluster, you add the image stream tag to the <code class="literal">openshift</code> namespace. Otherwise, to make it available <span class="strong strong"><strong>in a specific project</strong></span>, you add the image stream tag to that project.
				</p><p>
					The benefit of using image stream tags this way is that doing so grants access to the UBI based on the <code class="literal">registry.redhat.io</code> credentials in the install pull secret without exposing the pull secret to other users. This is more convenient than requiring each developer to install pull secrets with <code class="literal">registry.redhat.io</code> credentials in each project.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To create an <code class="literal">ImageStreamTag</code> in the <code class="literal">openshift</code> namespace, so it is available to developers in all projects, enter:
						</p><pre class="programlisting language-terminal">$ oc tag --source=docker registry.redhat.io/ubi9/ubi:latest ubi:latest -n openshift</pre><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
							You can alternatively apply the following YAML to create an <code class="literal">ImageStreamTag</code> in the <code class="literal">openshift</code> namespace:
						</p><pre class="programlisting language-yaml">apiVersion: image.openshift.io/v1
kind: ImageStream
metadata:
  name: ubi
  namespace: openshift
spec:
  tags:
  - from:
      kind: DockerImage
      name: registry.redhat.io/ubi9/ubi:latest
    name: latest
    referencePolicy:
      type: Source</pre></div></div></li><li class="listitem"><p class="simpara">
							To create an <code class="literal">ImageStreamTag</code> in a single project, enter:
						</p><pre class="programlisting language-terminal">$ oc tag --source=docker registry.redhat.io/ubi9/ubi:latest ubi:latest</pre><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
							You can alternatively apply the following YAML to create an <code class="literal">ImageStreamTag</code> in a single project:
						</p><pre class="programlisting language-yaml">apiVersion: image.openshift.io/v1
kind: ImageStream
metadata:
  name: ubi
spec:
  tags:
  - from:
      kind: DockerImage
      name: registry.redhat.io/ubi9/ubi:latest
    name: latest
    referencePolicy:
      type: Source</pre></div></div></li></ul></div></section><section class="section" id="builds-source-secrets-entitlements_running-entitled-builds"><div class="titlepage"><div><div><h3 class="title">2.10.2. Adding subscription entitlements as a build secret</h3></div></div></div><p>
					Builds that use Red Hat subscriptions to install content must include the entitlement keys as a build secret.
				</p><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
						You must have access to Red Hat entitlements through your subscription. The entitlement secret is automatically created by the Insights Operator.
					</p></div><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
					When you perform an Entitlement Build using Red Hat Enterprise Linux (RHEL) 7, you must have the following instructions in your Dockerfile before you run any <code class="literal">yum</code> commands:
				</p><pre class="programlisting language-terminal">RUN rm /etc/rhsm-host</pre></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Add the etc-pki-entitlement secret as a build volume in the build configuration’s Docker strategy:
						</p><pre class="programlisting language-yaml">strategy:
  dockerStrategy:
    from:
      kind: ImageStreamTag
      name: ubi:latest
    volumes:
    - name: etc-pki-entitlement
      mounts:
      - destinationPath: /etc/pki/entitlement
      source:
        type: Secret
        secret:
          secretName: etc-pki-entitlement</pre></li></ol></div></section><section class="section" id="running-builds-with-subscription-manager"><div class="titlepage"><div><div><h3 class="title">2.10.3. Running builds with Subscription Manager</h3></div></div></div><section class="section" id="builds-strategy-docker-entitled-subman_running-entitled-builds"><div class="titlepage"><div><div><h4 class="title">2.10.3.1. Docker builds using Subscription Manager</h4></div></div></div><p>
						Docker strategy builds can use the Subscription Manager to install subscription content.
					</p><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
							The entitlement keys must be added as build strategy volumes.
						</p></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							Use the following as an example Dockerfile to install content with the Subscription Manager:
						</p></div><pre class="programlisting language-terminal">FROM registry.redhat.io/ubi9/ubi:latest
RUN dnf search kernel-devel --showduplicates &amp;&amp; \
        dnf install -y kernel-devel</pre></section></section><section class="section" id="running-builds-with-red-hat-satellite-subscriptions"><div class="titlepage"><div><div><h3 class="title">2.10.4. Running builds with Red Hat Satellite subscriptions</h3></div></div></div><section class="section" id="builds-source-input-satellite-config_running-entitled-builds"><div class="titlepage"><div><div><h4 class="title">2.10.4.1. Adding Red Hat Satellite configurations to builds</h4></div></div></div><p>
						Builds that use Red Hat Satellite to install content must provide appropriate configurations to obtain content from Satellite repositories.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								You must provide or create a <code class="literal">yum</code>-compatible repository configuration file that downloads content from your Satellite instance.
							</p><div class="formalpara"><p class="title"><strong>Sample repository configuration</strong></p><p>
									
<pre class="programlisting language-terminal">[test-&lt;name&gt;]
name=test-&lt;number&gt;
baseurl = https://satellite.../content/dist/rhel/server/7/7Server/x86_64/os
enabled=1
gpgcheck=0
sslverify=0
sslclientkey = /etc/pki/entitlement/...-key.pem
sslclientcert = /etc/pki/entitlement/....pem</pre>

								</p></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a <code class="literal">ConfigMap</code> containing the Satellite repository configuration file:
							</p><pre class="programlisting language-terminal">$ oc create configmap yum-repos-d --from-file /path/to/satellite.repo</pre></li><li class="listitem"><p class="simpara">
								Add the Satellite repository configuration and entitlement key as a build volumes:
							</p><pre class="programlisting language-yaml">strategy:
  dockerStrategy:
    from:
      kind: ImageStreamTag
      name: ubi:latest
    volumes:
    - name: yum-repos-d
      mounts:
      - destinationPath: /etc/yum.repos.d
      source:
        type: ConfigMap
        configMap:
          name: yum-repos-d
    - name: etc-pki-entitlement
      mounts:
      - destinationPath: /etc/pki/entitlement
      source:
        type: Secret
        secret:
          secretName: etc-pki-entitlement</pre></li></ol></div></section><section class="section" id="builds-strategy-docker-entitled-satellite_running-entitled-builds"><div class="titlepage"><div><div><h4 class="title">2.10.4.2. Docker builds using Red Hat Satellite subscriptions</h4></div></div></div><p>
						Docker strategy builds can use Red Hat Satellite repositories to install subscription content.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have added the entitlement keys and Satellite repository configurations as build volumes.
							</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							Use the following as an example Dockerfile to install content with Satellite:
						</p></div><pre class="programlisting language-terminal">FROM registry.redhat.io/ubi9/ubi:latest
RUN dnf search kernel-devel --showduplicates &amp;&amp; \
        dnf install -y kernel-devel</pre><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/solutions/5847331">How to use builds with Red Hat Satellite subscriptions and which certificate to use</a>
							</li></ul></div></section></section><section class="section" id="builds-running-entitled-builds-with-sharedsecret-objects_running-entitled-builds"><div class="titlepage"><div><div><h3 class="title">2.10.5. Running entitled builds using SharedSecret objects</h3></div></div></div><p>
					You can configure and perform a build in one namespace that securely uses RHEL entitlements from a <code class="literal">Secret</code> object in another namespace.
				</p><p>
					You can still access RHEL entitlements from OpenShift Builds by creating a <code class="literal">Secret</code> object with your subscription credentials in the same namespace as your <code class="literal">Build</code> object. However, now, in OpenShift Container Platform 4.10 and later, you can access your credentials and certificates from a <code class="literal">Secret</code> object in one of the OpenShift Container Platform system namespaces. You run entitled builds with a CSI volume mount of a <code class="literal">SharedSecret</code> custom resource (CR) instance that references the <code class="literal">Secret</code> object.
				</p><p>
					This procedure relies on the newly introduced Shared Resources CSI Driver feature, which you can use to declare CSI Volume mounts in OpenShift Container Platform Builds. It also relies on the OpenShift Container Platform Insights Operator.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The Shared Resources CSI Driver and The Build CSI Volumes are both Technology Preview features, which are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
					</p><p>
						For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
					</p><p>
						The Shared Resources CSI Driver and the Build CSI Volumes features also belong to the <code class="literal">TechPreviewNoUpgrade</code> feature set, which is a subset of the current Technology Preview features. You can enable the <code class="literal">TechPreviewNoUpgrade</code> feature set on test clusters, where you can fully test them while leaving the features disabled on production clusters. Enabling this feature set cannot be undone and prevents minor version updates. This feature set is not recommended on production clusters. See "Enabling Technology Preview features using feature gates" in the following "Additional resources" section.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have enabled the <code class="literal">TechPreviewNoUpgrade</code> feature set by using the feature gates.
						</li><li class="listitem">
							You have a <code class="literal">SharedSecret</code> custom resource (CR) instance that references the <code class="literal">Secret</code> object where the Insights Operator stores the subscription credentials.
						</li><li class="listitem"><p class="simpara">
							You must have permission to perform the following actions:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Create build configs and start builds.
								</li><li class="listitem">
									Discover which <code class="literal">SharedSecret</code> CR instances are available by entering the <code class="literal">oc get sharedsecrets</code> command and getting a non-empty list back.
								</li><li class="listitem">
									Determine if the <code class="literal">builder</code> service account available to you in your namespace is allowed to use the given <code class="literal">SharedSecret</code> CR instance. In other words, you can run <code class="literal">oc adm policy who-can use &lt;identifier of specific SharedSecret&gt;</code> to see if the <code class="literal">builder</code> service account in your namespace is listed.
								</li></ul></div></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If neither of the last two prerequisites in this list are met, establish, or ask someone to establish, the necessary role-based access control (RBAC) so that you can discover <code class="literal">SharedSecret</code> CR instances and enable service accounts to use <code class="literal">SharedSecret</code> CR instances.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Grant the <code class="literal">builder</code> service account RBAC permissions to use the <code class="literal">SharedSecret</code> CR instance by using <code class="literal">oc apply</code> with YAML content:
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Currently, <code class="literal">kubectl</code> and <code class="literal">oc</code> have hard-coded special case logic restricting the <code class="literal">use</code> verb to roles centered around pod security. Therefore, you cannot use <code class="literal">oc create role …​</code> to create the role needed for consuming <code class="literal">SharedSecret</code> CR instances.
							</p></div></div><div class="formalpara"><p class="title"><strong>Example <code class="literal">oc apply -f</code> command with YAML <code class="literal">Role</code> object definition</strong></p><p>
								
<pre class="programlisting language-terminal">$ oc apply -f - &lt;&lt;EOF
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: shared-resource-my-share
  namespace: my-namespace
rules:
  - apiGroups:
      - sharedresource.openshift.io
    resources:
      - sharedsecrets
    resourceNames:
      - my-share
    verbs:
      - use
EOF</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">RoleBinding</code> associated with the role by using the <code class="literal">oc</code> command:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">oc create rolebinding</code> command</strong></p><p>
								
<pre class="programlisting language-terminal">$ oc create rolebinding shared-resource-my-share --role=shared-resource-my-share --serviceaccount=my-namespace:builder</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">BuildConfig</code> object that accesses the RHEL entitlements.
						</p><div class="formalpara"><p class="title"><strong>Example YAML <code class="literal">BuildConfig</code> object definition</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: build.openshift.io/v1
kind: BuildConfig
metadata:
  name: my-csi-bc
  namespace: my-csi-app-namespace
spec:
  runPolicy: Serial
  source:
    dockerfile: |
      FROM registry.redhat.io/ubi9/ubi:latest
      RUN ls -la /etc/pki/entitlement
      RUN rm /etc/rhsm-host
      RUN yum repolist --disablerepo=*
      RUN subscription-manager repos --enable rhocp-4.9-for-rhel-8-x86_64-rpms
      RUN yum -y update
      RUN yum install -y openshift-clients.x86_64
  strategy:
    type: Docker
    dockerStrategy:
      volumes:
        - mounts:
            - destinationPath: "/etc/pki/entitlement"
          name: my-csi-shared-secret
          source:
            csi:
              driver: csi.sharedresource.openshift.io
              readOnly: true
              volumeAttributes:
                sharedSecret: my-share-bc
            type: CSI</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Start a build from the <code class="literal">BuildConfig</code> object and follow the logs with the <code class="literal">oc</code> command.
						</p><div class="formalpara"><p class="title"><strong>Example oc start-build command</strong></p><p>
								
<pre class="programlisting language-terminal">$ oc start-build my-csi-bc -F</pre>

							</p></div><div class="example" id="idm140458464832880"><p class="title"><strong>Example 2.1. Example output from the oc start-build command</strong></p><div class="example-contents"><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Some sections of the following output have been replaced with <code class="literal">…​</code>
								</p></div></div><pre class="programlisting language-terminal">build.build.openshift.io/my-csi-bc-1 started
Caching blobs under "/var/cache/blobs".

Pulling image registry.redhat.io/ubi9/ubi:latest ...
Trying to pull registry.redhat.io/ubi9/ubi:latest...
Getting image source signatures
Copying blob sha256:5dcbdc60ea6b60326f98e2b49d6ebcb7771df4b70c6297ddf2d7dede6692df6e
Copying blob sha256:8671113e1c57d3106acaef2383f9bbfe1c45a26eacb03ec82786a494e15956c3
Copying config sha256:b81e86a2cb9a001916dc4697d7ed4777a60f757f0b8dcc2c4d8df42f2f7edb3a
Writing manifest to image destination
Storing signatures
Adding transient rw bind mount for /run/secrets/rhsm
STEP 1/9: FROM registry.redhat.io/ubi9/ubi:latest
STEP 2/9: RUN ls -la /etc/pki/entitlement
total 360
drwxrwxrwt. 2 root root 	80 Feb  3 20:28 .
drwxr-xr-x. 10 root root	154 Jan 27 15:53 ..
-rw-r--r--. 1 root root   3243 Feb  3 20:28 entitlement-key.pem
-rw-r--r--. 1 root root 362540 Feb  3 20:28 entitlement.pem
time="2022-02-03T20:28:32Z" level=warning msg="Adding metacopy option, configured globally"
--&gt; 1ef7c6d8c1a
STEP 3/9: RUN rm /etc/rhsm-host
time="2022-02-03T20:28:33Z" level=warning msg="Adding metacopy option, configured globally"
--&gt; b1c61f88b39
STEP 4/9: RUN yum repolist --disablerepo=*
Updating Subscription Management repositories.


...

--&gt; b067f1d63eb
STEP 5/9: RUN subscription-manager repos --enable rhocp-4.9-for-rhel-8-x86_64-rpms
Repository 'rhocp-4.9-for-rhel-8-x86_64-rpms' is enabled for this system.
time="2022-02-03T20:28:40Z" level=warning msg="Adding metacopy option, configured globally"
--&gt; 03927607ebd
STEP 6/9: RUN yum -y update
Updating Subscription Management repositories.

...

Upgraded:
  systemd-239-51.el8_5.3.x86_64      	systemd-libs-239-51.el8_5.3.x86_64
  systemd-pam-239-51.el8_5.3.x86_64
Installed:
  diffutils-3.6-6.el8.x86_64           	libxkbcommon-0.9.1-1.el8.x86_64
  xkeyboard-config-2.28-1.el8.noarch

Complete!
time="2022-02-03T20:29:05Z" level=warning msg="Adding metacopy option, configured globally"
--&gt; db57e92ff63
STEP 7/9: RUN yum install -y openshift-clients.x86_64
Updating Subscription Management repositories.

...

Installed:
  bash-completion-1:2.7-5.el8.noarch
  libpkgconf-1.4.2-1.el8.x86_64
  openshift-clients-4.9.0-202201211735.p0.g3f16530.assembly.stream.el8.x86_64
  pkgconf-1.4.2-1.el8.x86_64
  pkgconf-m4-1.4.2-1.el8.noarch
  pkgconf-pkg-config-1.4.2-1.el8.x86_64

Complete!
time="2022-02-03T20:29:19Z" level=warning msg="Adding metacopy option, configured globally"
--&gt; 609507b059e
STEP 8/9: ENV "OPENSHIFT_BUILD_NAME"="my-csi-bc-1" "OPENSHIFT_BUILD_NAMESPACE"="my-csi-app-namespace"
--&gt; cab2da3efc4
STEP 9/9: LABEL "io.openshift.build.name"="my-csi-bc-1" "io.openshift.build.namespace"="my-csi-app-namespace"
COMMIT temp.builder.openshift.io/my-csi-app-namespace/my-csi-bc-1:edfe12ca
--&gt; 821b582320b
Successfully tagged temp.builder.openshift.io/my-csi-app-namespace/my-csi-bc-1:edfe12ca
821b582320b41f1d7bab4001395133f86fa9cc99cc0b2b64c5a53f2b6750db91
Build complete, no image push requested</pre></div></div></li></ol></div></section><section class="section _additional-resources" id="additional-resources"><div class="titlepage"><div><div><h3 class="title">2.10.6. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/support/#insights-operator-simple-access">Importing simple content access certificates with Insights Operator</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-cluster-enabling">Enabling features using feature gates</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#image-streams-managing">Managing image streams</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#build-strategies">build strategy</a>
						</li></ul></div></section></section><section class="section" id="securing-builds-by-strategy"><div class="titlepage"><div><div><h2 class="title">2.11. Securing builds by strategy</h2></div></div></div><p>
				Builds in OpenShift Container Platform are run in privileged containers. Depending on the build strategy used, if you have privileges, you can run builds to escalate their permissions on the cluster and host nodes. And as a security measure, it limits who can run builds and the strategy that is used for those builds. Custom builds are inherently less safe than source builds, because they can execute any code within a privileged container, and are disabled by default. Grant docker build permissions with caution, because a vulnerability in the Dockerfile processing logic could result in a privileges being granted on the host node.
			</p><p>
				By default, all users that can create builds are granted permission to use the docker and Source-to-image (S2I) build strategies. Users with cluster administrator privileges can enable the custom build strategy, as referenced in the restricting build strategies to a user globally section.
			</p><p>
				You can control who can build and which build strategies they can use by using an authorization policy. Each build strategy has a corresponding build subresource. A user must have permission to create a build and permission to create on the build strategy subresource to create builds using that strategy. Default roles are provided that grant the create permission on the build strategy subresource.
			</p><div class="table" id="idm140458465467424"><p class="title"><strong>Table 2.3. Build Strategy Subresources and Roles</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140458465461648" scope="col">Strategy</th><th align="left" valign="top" id="idm140458465460560" scope="col">Subresource</th><th align="left" valign="top" id="idm140458465459472" scope="col">Role</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140458465461648"> <p>
								Docker
							</p>
							 </td><td align="left" valign="top" headers="idm140458465460560"> <p>
								builds/docker
							</p>
							 </td><td align="left" valign="top" headers="idm140458465459472"> <p>
								system:build-strategy-docker
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140458465461648"> <p>
								Source-to-Image
							</p>
							 </td><td align="left" valign="top" headers="idm140458465460560"> <p>
								builds/source
							</p>
							 </td><td align="left" valign="top" headers="idm140458465459472"> <p>
								system:build-strategy-source
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140458465461648"> <p>
								Custom
							</p>
							 </td><td align="left" valign="top" headers="idm140458465460560"> <p>
								builds/custom
							</p>
							 </td><td align="left" valign="top" headers="idm140458465459472"> <p>
								system:build-strategy-custom
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140458465461648"> <p>
								JenkinsPipeline
							</p>
							 </td><td align="left" valign="top" headers="idm140458465460560"> <p>
								builds/jenkinspipeline
							</p>
							 </td><td align="left" valign="top" headers="idm140458465459472"> <p>
								system:build-strategy-jenkinspipeline
							</p>
							 </td></tr></tbody></table></div></div><section class="section" id="builds-disabling-build-strategy-globally_securing-builds-by-strategy"><div class="titlepage"><div><div><h3 class="title">2.11.1. Disabling access to a build strategy globally</h3></div></div></div><p>
					To prevent access to a particular build strategy globally, log in as a user with cluster administrator privileges, remove the corresponding role from the <code class="literal">system:authenticated</code> group, and apply the annotation <code class="literal">rbac.authorization.kubernetes.io/autoupdate: "false"</code> to protect them from changes between the API restarts. The following example shows disabling the docker build strategy.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Apply the <code class="literal">rbac.authorization.kubernetes.io/autoupdate</code> annotation:
						</p><pre class="programlisting language-terminal">$ oc edit clusterrolebinding system:build-strategy-docker-binding</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    rbac.authorization.kubernetes.io/autoupdate: "false" <span id="CO31-1"><!--Empty--></span><span class="callout">1</span>
  creationTimestamp: 2018-08-10T01:24:14Z
  name: system:build-strategy-docker-binding
  resourceVersion: "225"
  selfLink: /apis/rbac.authorization.k8s.io/v1/clusterrolebindings/system%3Abuild-strategy-docker-binding
  uid: 17b1f3d4-9c3c-11e8-be62-0800277d20bf
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: system:build-strategy-docker
subjects:
- apiGroup: rbac.authorization.k8s.io
  kind: Group
  name: system:authenticated</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO31-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Change the <code class="literal">rbac.authorization.kubernetes.io/autoupdate</code> annotation’s value to <code class="literal">"false"</code>.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Remove the role:
						</p><pre class="programlisting language-terminal">$ oc adm policy remove-cluster-role-from-group system:build-strategy-docker system:authenticated</pre></li><li class="listitem"><p class="simpara">
							Ensure the build strategy subresources are also removed from these roles:
						</p><pre class="programlisting language-terminal">$ oc edit clusterrole admin</pre><pre class="programlisting language-terminal">$ oc edit clusterrole edit</pre></li><li class="listitem"><p class="simpara">
							For each role, specify the subresources that correspond to the resource of the strategy to disable.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Disable the docker Build Strategy for <span class="strong strong"><strong>admin</strong></span>:
								</p><pre class="programlisting language-yaml">kind: ClusterRole
metadata:
  name: admin
...
- apiGroups:
  - ""
  - build.openshift.io
  resources:
  - buildconfigs
  - buildconfigs/webhooks
  - builds/custom <span id="CO32-1"><!--Empty--></span><span class="callout">1</span>
  - builds/source
  verbs:
  - create
  - delete
  - deletecollection
  - get
  - list
  - patch
  - update
  - watch
...</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO32-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Add <code class="literal">builds/custom</code> and <code class="literal">builds/source</code> to disable docker builds globally for users with the <span class="strong strong"><strong>admin</strong></span> role.
										</div></dd></dl></div></li></ol></div></li></ol></div></section><section class="section" id="builds-restricting-build-strategy-globally_securing-builds-by-strategy"><div class="titlepage"><div><div><h3 class="title">2.11.2. Restricting build strategies to users globally</h3></div></div></div><p>
					You can allow a set of specific users to create builds with a particular strategy.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Disable global access to the build strategy.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Assign the role that corresponds to the build strategy to a specific user. For example, to add the <code class="literal">system:build-strategy-docker</code> cluster role to the user <code class="literal">devuser</code>:
						</p><pre class="programlisting language-terminal">$ oc adm policy add-cluster-role-to-user system:build-strategy-docker devuser</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								Granting a user access at the cluster level to the <code class="literal">builds/docker</code> subresource means that the user can create builds with the docker strategy in any project in which they can create builds.
							</p></div></div></li></ul></div></section><section class="section" id="builds-restricting-build-strategy-to-user_securing-builds-by-strategy"><div class="titlepage"><div><div><h3 class="title">2.11.3. Restricting build strategies to a user within a project</h3></div></div></div><p>
					Similar to granting the build strategy role to a user globally, you can allow a set of specific users within a project to create builds with a particular strategy.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Disable global access to the build strategy.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Assign the role that corresponds to the build strategy to a specific user within a project. For example, to add the <code class="literal">system:build-strategy-docker</code> role within the project <code class="literal">devproject</code> to the user <code class="literal">devuser</code>:
						</p><pre class="programlisting language-terminal">$ oc adm policy add-role-to-user system:build-strategy-docker devuser -n devproject</pre></li></ul></div></section></section><section class="section" id="build-configuration"><div class="titlepage"><div><div><h2 class="title">2.12. Build configuration resources</h2></div></div></div><p>
				Use the following procedure to configure build settings.
			</p><section class="section" id="builds-configuration-parameters_build-configuration"><div class="titlepage"><div><div><h3 class="title">2.12.1. Build controller configuration parameters</h3></div></div></div><p>
					The <code class="literal">build.config.openshift.io/cluster</code> resource offers the following configuration parameters.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 27%; " class="col_1"><!--Empty--></col><col style="width: 73%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140458473034864" scope="col">Parameter</th><th align="left" valign="top" id="idm140458473033776" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140458473034864"> <p>
									<code class="literal">Build</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458473033776"> <p>
									Holds cluster-wide information on how to handle builds. The canonical, and only valid name is <code class="literal">cluster</code>.
								</p>
								 <p>
									<code class="literal">spec</code>: Holds user-settable values for the build controller configuration.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458473034864"> <p>
									<code class="literal">buildDefaults</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458473033776"> <p>
									Controls the default information for builds.
								</p>
								 <p>
									<code class="literal">defaultProxy</code>: Contains the default proxy settings for all build operations, including image pull or push and source download.
								</p>
								 <p>
									You can override values by setting the <code class="literal">HTTP_PROXY</code>, <code class="literal">HTTPS_PROXY</code>, and <code class="literal">NO_PROXY</code> environment variables in the <code class="literal">BuildConfig</code> strategy.
								</p>
								 <p>
									<code class="literal">gitProxy</code>: Contains the proxy settings for Git operations only. If set, this overrides any proxy settings for all Git commands, such as <code class="literal">git clone</code>.
								</p>
								 <p>
									Values that are not set here are inherited from DefaultProxy.
								</p>
								 <p>
									<code class="literal">env</code>: A set of default environment variables that are applied to the build if the specified variables do not exist on the build.
								</p>
								 <p>
									<code class="literal">imageLabels</code>: A list of labels that are applied to the resulting image. You can override a default label by providing a label with the same name in the <code class="literal">BuildConfig</code>.
								</p>
								 <p>
									<code class="literal">resources</code>: Defines resource requirements to execute the build.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458473034864"> <p>
									<code class="literal">ImageLabel</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458473033776"> <p>
									<code class="literal">name</code>: Defines the name of the label. It must have non-zero length.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458473034864"> <p>
									<code class="literal">buildOverrides</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458473033776"> <p>
									Controls override settings for builds.
								</p>
								 <p>
									<code class="literal">imageLabels</code>: A list of labels that are applied to the resulting image. If you provided a label in the <code class="literal">BuildConfig</code> with the same name as one in this table, your label will be overwritten.
								</p>
								 <p>
									<code class="literal">nodeSelector</code>: A selector which must be true for the build pod to fit on a node.
								</p>
								 <p>
									<code class="literal">tolerations</code>: A list of tolerations that overrides any existing tolerations set on a build pod.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458473034864"> <p>
									<code class="literal">BuildList</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458473033776"> <p>
									<code class="literal">items</code>: Standard object’s metadata.
								</p>
								 </td></tr></tbody></table></div></section><section class="section" id="builds-configuration-file_build-configuration"><div class="titlepage"><div><div><h3 class="title">2.12.2. Configuring build settings</h3></div></div></div><p>
					You can configure build settings by editing the <code class="literal">build.config.openshift.io/cluster</code> resource.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">build.config.openshift.io/cluster</code> resource:
						</p><pre class="programlisting language-terminal">$ oc edit build.config.openshift.io/cluster</pre><p class="simpara">
							The following is an example <code class="literal">build.config.openshift.io/cluster</code> resource:
						</p><pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1
kind: Build<span id="CO33-1"><!--Empty--></span><span class="callout">1</span>
metadata:
  annotations:
    release.openshift.io/create-only: "true"
  creationTimestamp: "2019-05-17T13:44:26Z"
  generation: 2
  name: cluster
  resourceVersion: "107233"
  selfLink: /apis/config.openshift.io/v1/builds/cluster
  uid: e2e9cc14-78a9-11e9-b92b-06d6c7da38dc
spec:
  buildDefaults:<span id="CO33-2"><!--Empty--></span><span class="callout">2</span>
    defaultProxy:<span id="CO33-3"><!--Empty--></span><span class="callout">3</span>
      httpProxy: http://proxy.com
      httpsProxy: https://proxy.com
      noProxy: internal.com
    env:<span id="CO33-4"><!--Empty--></span><span class="callout">4</span>
    - name: envkey
      value: envvalue
    gitProxy:<span id="CO33-5"><!--Empty--></span><span class="callout">5</span>
      httpProxy: http://gitproxy.com
      httpsProxy: https://gitproxy.com
      noProxy: internalgit.com
    imageLabels:<span id="CO33-6"><!--Empty--></span><span class="callout">6</span>
    - name: labelkey
      value: labelvalue
    resources:<span id="CO33-7"><!--Empty--></span><span class="callout">7</span>
      limits:
        cpu: 100m
        memory: 50Mi
      requests:
        cpu: 10m
        memory: 10Mi
  buildOverrides:<span id="CO33-8"><!--Empty--></span><span class="callout">8</span>
    imageLabels:<span id="CO33-9"><!--Empty--></span><span class="callout">9</span>
    - name: labelkey
      value: labelvalue
    nodeSelector:<span id="CO33-10"><!--Empty--></span><span class="callout">10</span>
      selectorkey: selectorvalue
    tolerations:<span id="CO33-11"><!--Empty--></span><span class="callout">11</span>
    - effect: NoSchedule
      key: node-role.kubernetes.io/builds
operator: Exists</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO33-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									<code class="literal">Build</code>: Holds cluster-wide information on how to handle builds. The canonical, and only valid name is <code class="literal">cluster</code>.
								</div></dd><dt><a href="#CO33-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									<code class="literal">buildDefaults</code>: Controls the default information for builds.
								</div></dd><dt><a href="#CO33-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									<code class="literal">defaultProxy</code>: Contains the default proxy settings for all build operations, including image pull or push and source download.
								</div></dd><dt><a href="#CO33-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									<code class="literal">env</code>: A set of default environment variables that are applied to the build if the specified variables do not exist on the build.
								</div></dd><dt><a href="#CO33-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									<code class="literal">gitProxy</code>: Contains the proxy settings for Git operations only. If set, this overrides any Proxy settings for all Git commands, such as <code class="literal">git clone</code>.
								</div></dd><dt><a href="#CO33-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									<code class="literal">imageLabels</code>: A list of labels that are applied to the resulting image. You can override a default label by providing a label with the same name in the <code class="literal">BuildConfig</code>.
								</div></dd><dt><a href="#CO33-7"><span class="callout">7</span></a> </dt><dd><div class="para">
									<code class="literal">resources</code>: Defines resource requirements to execute the build.
								</div></dd><dt><a href="#CO33-8"><span class="callout">8</span></a> </dt><dd><div class="para">
									<code class="literal">buildOverrides</code>: Controls override settings for builds.
								</div></dd><dt><a href="#CO33-9"><span class="callout">9</span></a> </dt><dd><div class="para">
									<code class="literal">imageLabels</code>: A list of labels that are applied to the resulting image. If you provided a label in the <code class="literal">BuildConfig</code> with the same name as one in this table, your label will be overwritten.
								</div></dd><dt><a href="#CO33-10"><span class="callout">10</span></a> </dt><dd><div class="para">
									<code class="literal">nodeSelector</code>: A selector which must be true for the build pod to fit on a node.
								</div></dd><dt><a href="#CO33-11"><span class="callout">11</span></a> </dt><dd><div class="para">
									<code class="literal">tolerations</code>: A list of tolerations that overrides any existing tolerations set on a build pod.
								</div></dd></dl></div></li></ul></div></section></section><section class="section" id="troubleshooting-builds_build-configuration"><div class="titlepage"><div><div><h2 class="title">2.13. Troubleshooting builds</h2></div></div></div><p>
				Use the following to troubleshoot build issues.
			</p><section class="section" id="builds-troubleshooting-access-resources_troubleshooting-builds"><div class="titlepage"><div><div><h3 class="title">2.13.1. Resolving denial for access to resources</h3></div></div></div><p>
					If your request for access to resources is denied:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Issue</span></dt><dd>
								A build fails with:
							</dd></dl></div><pre class="programlisting language-terminal">requested access to the resource is denied</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term">Resolution</span></dt><dd>
								You have exceeded one of the image quotas set on your project. Check your current quota and verify the limits applied and storage in use:
							</dd></dl></div><pre class="programlisting language-terminal">$ oc describe quota</pre></section><section class="section" id="builds-troubleshooting-service-certificate-generation_troubleshooting-builds"><div class="titlepage"><div><div><h3 class="title">2.13.2. Service certificate generation failure</h3></div></div></div><p>
					If your request for access to resources is denied:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Issue</span></dt><dd>
								If a service certificate generation fails with (service’s <code class="literal">service.beta.openshift.io/serving-cert-generation-error</code> annotation contains):
							</dd></dl></div><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">secret/ssl-key references serviceUID 62ad25ca-d703-11e6-9d6f-0e9c0057b608, which does not match 77b6dd80-d716-11e6-9d6f-0e9c0057b60</pre>

					</p></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Resolution</span></dt><dd>
								The service that generated the certificate no longer exists, or has a different <code class="literal">serviceUID</code>. You must force certificates regeneration by removing the old secret, and clearing the following annotations on the service: <code class="literal">service.beta.openshift.io/serving-cert-generation-error</code> and <code class="literal">service.beta.openshift.io/serving-cert-generation-error-num</code>:
							</dd></dl></div><pre class="programlisting language-terminal">$ oc delete secret &lt;secret_name&gt;</pre><pre class="programlisting language-terminal">$ oc annotate service &lt;service_name&gt; service.beta.openshift.io/serving-cert-generation-error-</pre><pre class="programlisting language-terminal">$ oc annotate service &lt;service_name&gt; service.beta.openshift.io/serving-cert-generation-error-num-</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The command removing annotation has a <code class="literal">-</code> after the annotation name to be removed.
					</p></div></div></section></section><section class="section" id="setting-up-trusted-ca"><div class="titlepage"><div><div><h2 class="title">2.14. Setting up additional trusted certificate authorities for builds</h2></div></div></div><p>
				Use the following sections to set up additional certificate authorities (CA) to be trusted by builds when pulling images from an image registry.
			</p><p>
				The procedure requires a cluster administrator to create a <code class="literal">ConfigMap</code> and add additional CAs as keys in the <code class="literal">ConfigMap</code>.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">ConfigMap</code> must be created in the <code class="literal">openshift-config</code> namespace.
					</li><li class="listitem"><p class="simpara">
						<code class="literal">domain</code> is the key in the <code class="literal">ConfigMap</code> and <code class="literal">value</code> is the PEM-encoded certificate.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Each CA must be associated with a domain. The domain format is <code class="literal">hostname[..port]</code>.
							</li></ul></div></li><li class="listitem">
						The <code class="literal">ConfigMap</code> name must be set in the <code class="literal">image.config.openshift.io/cluster</code> cluster scoped configuration resource’s <code class="literal">spec.additionalTrustedCA</code> field.
					</li></ul></div><section class="section" id="configmap-adding-ca_setting-up-trusted-ca"><div class="titlepage"><div><div><h3 class="title">2.14.1. Adding certificate authorities to the cluster</h3></div></div></div><p>
					You can add certificate authorities (CA) to the cluster for use when pushing and pulling images with the following procedure.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You must have access to the public certificates of the registry, usually a <code class="literal">hostname/ca.crt</code> file located in the <code class="literal">/etc/docker/certs.d/</code> directory.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a <code class="literal">ConfigMap</code> in the <code class="literal">openshift-config</code> namespace containing the trusted certificates for the registries that use self-signed certificates. For each CA file, ensure the key in the <code class="literal">ConfigMap</code> is the hostname of the registry in the <code class="literal">hostname[..port]</code> format:
						</p><pre class="programlisting language-terminal">$ oc create configmap registry-cas -n openshift-config \
--from-file=myregistry.corp.com..5000=/etc/docker/certs.d/myregistry.corp.com:5000/ca.crt \
--from-file=otherregistry.com=/etc/docker/certs.d/otherregistry.com/ca.crt</pre></li><li class="listitem"><p class="simpara">
							Update the cluster image configuration:
						</p><pre class="programlisting language-terminal">$ oc patch image.config.openshift.io/cluster --patch '{"spec":{"additionalTrustedCA":{"name":"registry-cas"}}}' --type=merge</pre></li></ol></div></section><section class="section _additional-resources" id="additional-resources-2"><div class="titlepage"><div><div><h3 class="title">2.14.2. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/#create-a-configmap">Create a <code class="literal">ConfigMap</code></a>
						</li><li class="listitem">
							<a class="link" href="https://kubectl.docs.kubernetes.io/guides/config_management/secrets_configmaps/">Secrets and <code class="literal">ConfigMaps</code></a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#configuring-a-custom-pki">Configuring a custom PKI</a>
						</li></ul></div></section></section></section><section class="chapter" id="pipelines"><div class="titlepage"><div><div><h1 class="title">Chapter 3. Pipelines</h1></div></div></div><section class="section" id="about-pipelines"><div class="titlepage"><div><div><h2 class="title">3.1. About Red Hat OpenShift Pipelines</h2></div></div></div><p>
				Red Hat OpenShift Pipelines is a cloud-native, continuous integration and continuous delivery (CI/CD) solution based on Kubernetes resources. It uses Tekton building blocks to automate deployments across multiple platforms by abstracting away the underlying implementation details. Tekton introduces a number of standard custom resource definitions (CRDs) for defining CI/CD pipelines that are portable across Kubernetes distributions.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Because Red Hat OpenShift Pipelines releases on a different cadence from OpenShift Container Platform, the Red Hat OpenShift Pipelines documentation is now available as separate documentation sets for each minor version of the product.
				</p><p>
					The Red Hat OpenShift Pipelines documentation is available at <a class="link" href="https://docs.openshift.com/pipelines/">https://docs.openshift.com/pipelines/</a>.
				</p><p>
					Documentation for specific versions is available using the version selector drop-down list, or directly by adding the version to the URL, for example, <a class="link" href="https://docs.openshift.com/pipelines/1.11">https://docs.openshift.com/pipelines/1.11</a>.
				</p><p>
					In addition, the Red Hat OpenShift Pipelines documentation is also available on the Red Hat Customer Portal at <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openshift_pipelines/">https://access.redhat.com/documentation/en-us/red_hat_openshift_pipelines/</a>.
				</p><p>
					For additional information about the Red Hat OpenShift Pipelines life cycle and supported platforms, refer to the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#pipelines">Platform Life Cycle Policy</a>.
				</p></div></div></section></section><section class="chapter" id="gitops"><div class="titlepage"><div><div><h1 class="title">Chapter 4. GitOps</h1></div></div></div><section class="section" id="about-redhat-openshift-gitops"><div class="titlepage"><div><div><h2 class="title">4.1. About Red Hat OpenShift GitOps</h2></div></div></div><p>
				Red Hat OpenShift GitOps is an Operator that uses Argo CD as the declarative GitOps engine. It enables GitOps workflows across multicluster OpenShift and Kubernetes infrastructure. Using Red Hat OpenShift GitOps, administrators can consistently configure and deploy Kubernetes-based infrastructure and applications across clusters and development lifecycles. Red Hat OpenShift GitOps is based on the open source project <a class="link" href="https://argoproj.github.io/cd/">Argo CD</a> and provides a similar set of features to what the upstream offers, with additional automation, integration into Red Hat {OCP} and the benefits of Red Hat’s enterprise support, quality assurance and focus on enterprise security.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Because Red Hat OpenShift GitOps releases on a different cadence from {OCP}, the Red Hat OpenShift GitOps documentation is now available as separate documentation sets for each minor version of the product.
				</p><p>
					The Red Hat OpenShift GitOps documentation is available at <a class="link" href="https://docs.openshift.com/gitops/">https://docs.openshift.com/gitops/</a>.
				</p><p>
					Documentation for specific versions is available using the version selector dropdown, or directly by adding the version to the URL, for example, <a class="link" href="https://docs.openshift.com/gitops/1.8">https://docs.openshift.com/gitops/1.8</a>.
				</p><p>
					In addition, the Red Hat OpenShift GitOps documentation is also available on the Red Hat Portal at <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openshift_gitops/">https://access.redhat.com/documentation/en-us/red_hat_openshift_gitops/</a>.
				</p><p>
					For additional information about the Red Hat OpenShift GitOps life cycle and supported platforms, refer to the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#gitops">Platform Life Cycle Policy</a>.
				</p></div></div><p>
				Red Hat OpenShift GitOps ensures consistency in applications when you deploy them to different clusters in different environments, such as: development, staging, and production. Red Hat OpenShift GitOps organizes the deployment process around the configuration repositories and makes them the central element. It always has at least two repositories:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Application repository with the source code
					</li><li class="listitem">
						Environment configuration repository that defines the desired state of the application
					</li></ol></div><p>
				These repositories contain a declarative description of the infrastructure you need in your specified environment. They also contain an automated process to make your environment match the described state.
			</p><p>
				Red Hat OpenShift GitOps uses Argo CD to maintain cluster resources. Argo CD is an open-source declarative tool for the continuous integration and continuous deployment (CI/CD) of applications. Red Hat OpenShift GitOps implements Argo CD as a controller so that it continuously monitors application definitions and configurations defined in a Git repository. Then, Argo CD compares the specified state of these configurations with their live state on the cluster.
			</p><p>
				Argo CD reports any configurations that deviate from their specified state. These reports allow administrators to automatically or manually resync configurations to the defined state. Therefore, Argo CD enables you to deliver global custom resources, like the resources that are used to configure {OCP} clusters.
			</p><section class="section" id="key-features"><div class="titlepage"><div><div><h3 class="title">4.1.1. Key features</h3></div></div></div><p>
					Red Hat OpenShift GitOps helps you automate the following tasks:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Ensure that the clusters have similar states for configuration, monitoring, and storage
						</li><li class="listitem">
							Apply or revert configuration changes to multiple {OCP} clusters
						</li><li class="listitem">
							Associate templated configuration with different environments
						</li><li class="listitem">
							Promote applications across clusters, from staging to production
						</li></ul></div></section><section class="section _additional-resources" id="additional-resources_about-op-gitops"><div class="titlepage"><div><div><h3 class="title">4.1.2. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://docs.openshift.com/container-platform/latest/operators/understanding/crds/crd-extending-api-with-crds.html#crd-extending-api-with-crds">Extending the Kubernetes API with custom resource definitions</a>
						</li><li class="listitem">
							<a class="link" href="https://docs.openshift.com/container-platform/latest/operators/understanding/crds/crd-managing-resources-from-crds.html#crd-managing-resources-from-crds">Managing resources from custom resource definitions</a>
						</li><li class="listitem">
							<a class="link" href="https://docs.openshift.com/gitops/latest/understanding_openshift_gitops/what-is-gitops.html#what-is-gitops">What is GitOps?</a>
						</li></ul></div></section></section></section><section class="chapter" id="jenkins"><div class="titlepage"><div><div><h1 class="title">Chapter 5. Jenkins</h1></div></div></div><section class="section" id="images-other-jenkins"><div class="titlepage"><div><div><h2 class="title">5.1. Configuring Jenkins images</h2></div></div></div><p>
				OpenShift Container Platform provides a container image for running Jenkins. This image provides a Jenkins server instance, which can be used to set up a basic flow for continuous testing, integration, and delivery.
			</p><p>
				The image is based on the Red Hat Universal Base Images (UBI).
			</p><p>
				OpenShift Container Platform follows the <a class="link" href="https://jenkins.io/changelog-stable/">LTS</a> release of Jenkins. OpenShift Container Platform provides an image that contains Jenkins 2.x.
			</p><p>
				The OpenShift Container Platform Jenkins images are available on <a class="link" href="https://quay.io">Quay.io</a> or <a class="link" href="https://registry.redhat.io">registry.redhat.io</a>.
			</p><p>
				For example:
			</p><pre class="programlisting language-terminal">$ podman pull registry.redhat.io/ocp-tools-4/jenkins-rhel8:&lt;image_tag&gt;</pre><p>
				To use these images, you can either access them directly from these registries or push them into your OpenShift Container Platform container image registry. Additionally, you can create an image stream that points to the image, either in your container image registry or at the external location. Your OpenShift Container Platform resources can then reference the image stream.
			</p><p>
				But for convenience, OpenShift Container Platform provides image streams in the <code class="literal">openshift</code> namespace for the core Jenkins image as well as the example Agent images provided for OpenShift Container Platform integration with Jenkins.
			</p><section class="section" id="images-other-jenkins-config-customization_images-other-jenkins"><div class="titlepage"><div><div><h3 class="title">5.1.1. Configuration and customization</h3></div></div></div><p>
					You can manage Jenkins authentication in two ways:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							OpenShift Container Platform OAuth authentication provided by the OpenShift Container Platform Login plugin.
						</li><li class="listitem">
							Standard authentication provided by Jenkins.
						</li></ul></div><section class="section" id="images-other-jenkins-oauth-auth_images-other-jenkins"><div class="titlepage"><div><div><h4 class="title">5.1.1.1. OpenShift Container Platform OAuth authentication</h4></div></div></div><p>
						OAuth authentication is activated by configuring options on the <span class="strong strong"><strong>Configure Global Security</strong></span> panel in the Jenkins UI, or by setting the <code class="literal">OPENSHIFT_ENABLE_OAUTH</code> environment variable on the Jenkins <span class="strong strong"><strong>Deployment configuration</strong></span> to anything other than <code class="literal">false</code>. This activates the OpenShift Container Platform Login plugin, which retrieves the configuration information from pod data or by interacting with the OpenShift Container Platform API server.
					</p><p>
						Valid credentials are controlled by the OpenShift Container Platform identity provider.
					</p><p>
						Jenkins supports both browser and non-browser access.
					</p><p>
						Valid users are automatically added to the Jenkins authorization matrix at log in, where OpenShift Container Platform roles dictate the specific Jenkins permissions that users have. The roles used by default are the predefined <code class="literal">admin</code>, <code class="literal">edit</code>, and <code class="literal">view</code>. The login plugin executes self-SAR requests against those roles in the project or namespace that Jenkins is running in.
					</p><p>
						Users with the <code class="literal">admin</code> role have the traditional Jenkins administrative user permissions. Users with the <code class="literal">edit</code> or <code class="literal">view</code> role have progressively fewer permissions.
					</p><p>
						The default OpenShift Container Platform <code class="literal">admin</code>, <code class="literal">edit</code>, and <code class="literal">view</code> roles and the Jenkins permissions those roles are assigned in the Jenkins instance are configurable.
					</p><p>
						When running Jenkins in an OpenShift Container Platform pod, the login plugin looks for a config map named <code class="literal">openshift-jenkins-login-plugin-config</code> in the namespace that Jenkins is running in.
					</p><p>
						If this plugin finds and can read in that config map, you can define the role to Jenkins Permission mappings. Specifically:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The login plugin treats the key and value pairs in the config map as Jenkins permission to OpenShift Container Platform role mappings.
							</li><li class="listitem">
								The key is the Jenkins permission group short ID and the Jenkins permission short ID, with those two separated by a hyphen character.
							</li><li class="listitem">
								If you want to add the <code class="literal">Overall Jenkins Administer</code> permission to an OpenShift Container Platform role, the key should be <code class="literal">Overall-Administer</code>.
							</li><li class="listitem">
								To get a sense of which permission groups and permissions IDs are available, go to the matrix authorization page in the Jenkins console and IDs for the groups and individual permissions in the table they provide.
							</li><li class="listitem">
								The value of the key and value pair is the list of OpenShift Container Platform roles the permission should apply to, with each role separated by a comma.
							</li><li class="listitem">
								If you want to add the <code class="literal">Overall Jenkins Administer</code> permission to both the default <code class="literal">admin</code> and <code class="literal">edit</code> roles, as well as a new Jenkins role you have created, the value for the key <code class="literal">Overall-Administer</code> would be <code class="literal">admin,edit,jenkins</code>.
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The <code class="literal">admin</code> user that is pre-populated in the OpenShift Container Platform Jenkins image with administrative privileges is not given those privileges when OpenShift Container Platform OAuth is used. To grant these permissions the OpenShift Container Platform cluster administrator must explicitly define that user in the OpenShift Container Platform identity provider and assigns the <code class="literal">admin</code> role to the user.
						</p></div></div><p>
						Jenkins users' permissions that are stored can be changed after the users are initially established. The OpenShift Container Platform Login plugin polls the OpenShift Container Platform API server for permissions and updates the permissions stored in Jenkins for each user with the permissions retrieved from OpenShift Container Platform. If the Jenkins UI is used to update permissions for a Jenkins user, the permission changes are overwritten the next time the plugin polls OpenShift Container Platform.
					</p><p>
						You can control how often the polling occurs with the <code class="literal">OPENSHIFT_PERMISSIONS_POLL_INTERVAL</code> environment variable. The default polling interval is five minutes.
					</p><p>
						The easiest way to create a new Jenkins service using OAuth authentication is to use a template.
					</p></section><section class="section" id="images-other-jenkins-auth_images-other-jenkins"><div class="titlepage"><div><div><h4 class="title">5.1.1.2. Jenkins authentication</h4></div></div></div><p>
						Jenkins authentication is used by default if the image is run directly, without using a template.
					</p><p>
						The first time Jenkins starts, the configuration is created along with the administrator user and password. The default user credentials are <code class="literal">admin</code> and <code class="literal">password</code>. Configure the default password by setting the <code class="literal">JENKINS_PASSWORD</code> environment variable when using, and only when using, standard Jenkins authentication.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Create a Jenkins application that uses standard Jenkins authentication:
							</p><pre class="programlisting language-terminal">$ oc new-app -e \
    JENKINS_PASSWORD=&lt;password&gt; \
    ocp-tools-4/jenkins-rhel8</pre></li></ul></div></section></section><section class="section" id="images-other-jenkins-env-var_images-other-jenkins"><div class="titlepage"><div><div><h3 class="title">5.1.2. Jenkins environment variables</h3></div></div></div><p>
					The Jenkins server can be configured with the following environment variables:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140458467409472" scope="col">Variable</th><th align="left" valign="top" id="idm140458467408384" scope="col">Definition</th><th align="left" valign="top" id="idm140458467407296" scope="col">Example values and settings</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140458467409472"> <p>
									<code class="literal">OPENSHIFT_ENABLE_OAUTH</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458467408384"> <p>
									Determines whether the OpenShift Container Platform Login plugin manages authentication when logging in to Jenkins. To enable, set to <code class="literal">true</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140458467407296"> <p>
									Default: <code class="literal">false</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458467409472"> <p>
									<code class="literal">JENKINS_PASSWORD</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458467408384"> <p>
									The password for the <code class="literal">admin</code> user when using standard Jenkins authentication. Not applicable when <code class="literal">OPENSHIFT_ENABLE_OAUTH</code> is set to <code class="literal">true</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140458467407296"> <p>
									Default: <code class="literal">password</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458467409472"> <p>
									<code class="literal">JAVA_MAX_HEAP_PARAM</code>, <code class="literal">CONTAINER_HEAP_PERCENT</code>, <code class="literal">JENKINS_MAX_HEAP_UPPER_BOUND_MB</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458467408384"> <p>
									These values control the maximum heap size of the Jenkins JVM. If <code class="literal">JAVA_MAX_HEAP_PARAM</code> is set, its value takes precedence. Otherwise, the maximum heap size is dynamically calculated as <code class="literal">CONTAINER_HEAP_PERCENT</code> of the container memory limit, optionally capped at <code class="literal">JENKINS_MAX_HEAP_UPPER_BOUND_MB</code> MiB.
								</p>
								 <p>
									By default, the maximum heap size of the Jenkins JVM is set to 50% of the container memory limit with no cap.
								</p>
								 </td><td align="left" valign="top" headers="idm140458467407296"> <p>
									<code class="literal">JAVA_MAX_HEAP_PARAM</code> example setting: <code class="literal">-Xmx512m</code>
								</p>
								 <p>
									<code class="literal">CONTAINER_HEAP_PERCENT</code> default: <code class="literal">0.5</code>, or 50%
								</p>
								 <p>
									<code class="literal">JENKINS_MAX_HEAP_UPPER_BOUND_MB</code> example setting: <code class="literal">512 MiB</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458467409472"> <p>
									<code class="literal">JAVA_INITIAL_HEAP_PARAM</code>, <code class="literal">CONTAINER_INITIAL_PERCENT</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458467408384"> <p>
									These values control the initial heap size of the Jenkins JVM. If <code class="literal">JAVA_INITIAL_HEAP_PARAM</code> is set, its value takes precedence. Otherwise, the initial heap size is dynamically calculated as <code class="literal">CONTAINER_INITIAL_PERCENT</code> of the dynamically calculated maximum heap size.
								</p>
								 <p>
									By default, the JVM sets the initial heap size.
								</p>
								 </td><td align="left" valign="top" headers="idm140458467407296"> <p>
									<code class="literal">JAVA_INITIAL_HEAP_PARAM</code> example setting: <code class="literal">-Xms32m</code>
								</p>
								 <p>
									<code class="literal">CONTAINER_INITIAL_PERCENT</code> example setting: <code class="literal">0.1</code>, or 10%
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458467409472"> <p>
									<code class="literal">CONTAINER_CORE_LIMIT</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458467408384"> <p>
									If set, specifies an integer number of cores used for sizing numbers of internal JVM threads.
								</p>
								 </td><td align="left" valign="top" headers="idm140458467407296"> <p>
									Example setting: <code class="literal">2</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458467409472"> <p>
									<code class="literal">JAVA_TOOL_OPTIONS</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458467408384"> <p>
									Specifies options to apply to all JVMs running in this container. It is not recommended to override this value.
								</p>
								 </td><td align="left" valign="top" headers="idm140458467407296"> <p>
									Default: <code class="literal">-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -Dsun.zip.disableMemoryMapping=true</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458467409472"> <p>
									<code class="literal">JAVA_GC_OPTS</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458467408384"> <p>
									Specifies Jenkins JVM garbage collection parameters. It is not recommended to override this value.
								</p>
								 </td><td align="left" valign="top" headers="idm140458467407296"> <p>
									Default: <code class="literal">-XX:+UseParallelGC -XX:MinHeapFreeRatio=5 -XX:MaxHeapFreeRatio=10 -XX:GCTimeRatio=4 -XX:AdaptiveSizePolicyWeight=90</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458467409472"> <p>
									<code class="literal">JENKINS_JAVA_OVERRIDES</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458467408384"> <p>
									Specifies additional options for the Jenkins JVM. These options are appended to all other options, including the Java options above, and may be used to override any of them if necessary. Separate each additional option with a space; if any option contains space characters, escape them with a backslash.
								</p>
								 </td><td align="left" valign="top" headers="idm140458467407296"> <p>
									Example settings: <code class="literal">-Dfoo -Dbar</code>; <code class="literal">-Dfoo=first\ value -Dbar=second\ value</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458467409472"> <p>
									<code class="literal">JENKINS_OPTS</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458467408384"> <p>
									Specifies arguments to Jenkins.
								</p>
								 </td><td align="left" valign="top" headers="idm140458467407296"> </td></tr><tr><td align="left" valign="top" headers="idm140458467409472"> <p>
									<code class="literal">INSTALL_PLUGINS</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458467408384"> <p>
									Specifies additional Jenkins plugins to install when the container is first run or when <code class="literal">OVERRIDE_PV_PLUGINS_WITH_IMAGE_PLUGINS</code> is set to <code class="literal">true</code>. Plugins are specified as a comma-delimited list of name:version pairs.
								</p>
								 </td><td align="left" valign="top" headers="idm140458467407296"> <p>
									Example setting: <code class="literal">git:3.7.0,subversion:2.10.2</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458467409472"> <p>
									<code class="literal">OPENSHIFT_PERMISSIONS_POLL_INTERVAL</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458467408384"> <p>
									Specifies the interval in milliseconds that the OpenShift Container Platform Login plugin polls OpenShift Container Platform for the permissions that are associated with each user that is defined in Jenkins.
								</p>
								 </td><td align="left" valign="top" headers="idm140458467407296"> <p>
									Default: <code class="literal">300000</code> - 5 minutes
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458467409472"> <p>
									<code class="literal">OVERRIDE_PV_CONFIG_WITH_IMAGE_CONFIG</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458467408384"> <p>
									When running this image with an OpenShift Container Platform persistent volume (PV) for the Jenkins configuration directory, the transfer of configuration from the image to the PV is performed only the first time the image starts because the PV is assigned when the persistent volume claim (PVC) is created. If you create a custom image that extends this image and updates the configuration in the custom image after the initial startup, the configuration is not copied over unless you set this environment variable to <code class="literal">true</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140458467407296"> <p>
									Default: <code class="literal">false</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458467409472"> <p>
									<code class="literal">OVERRIDE_PV_PLUGINS_WITH_IMAGE_PLUGINS</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458467408384"> <p>
									When running this image with an OpenShift Container Platform PV for the Jenkins configuration directory, the transfer of plugins from the image to the PV is performed only the first time the image starts because the PV is assigned when the PVC is created. If you create a custom image that extends this image and updates plugins in the custom image after the initial startup, the plugins are not copied over unless you set this environment variable to <code class="literal">true</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140458467407296"> <p>
									Default: <code class="literal">false</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458467409472"> <p>
									<code class="literal">ENABLE_FATAL_ERROR_LOG_FILE</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458467408384"> <p>
									When running this image with an OpenShift Container Platform PVC for the Jenkins configuration directory, this environment variable allows the fatal error log file to persist when a fatal error occurs. The fatal error file is saved at <code class="literal">/var/lib/jenkins/logs</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140458467407296"> <p>
									Default: <code class="literal">false</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458467409472"> <p>
									<code class="literal">AGENT_BASE_IMAGE</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458467408384"> <p>
									Setting this value overrides the image used for the <code class="literal">jnlp</code> container in the sample Kubernetes plugin pod templates provided with this image. Otherwise, the image from the <code class="literal">jenkins-agent-base-rhel8:latest</code> image stream tag in the <code class="literal">openshift</code> namespace is used.
								</p>
								 </td><td align="left" valign="top" headers="idm140458467407296"> <p>
									Default: <code class="literal">image-registry.openshift-image-registry.svc:5000/openshift/jenkins-agent-base-rhel8:latest</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458467409472"> <p>
									<code class="literal">JAVA_BUILDER_IMAGE</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458467408384"> <p>
									Setting this value overrides the image used for the <code class="literal">java-builder</code> container in the <code class="literal">java-builder</code> sample Kubernetes plugin pod templates provided with this image. Otherwise, the image from the <code class="literal">java:latest</code> image stream tag in the <code class="literal">openshift</code> namespace is used.
								</p>
								 </td><td align="left" valign="top" headers="idm140458467407296"> <p>
									Default: <code class="literal">image-registry.openshift-image-registry.svc:5000/openshift/java:latest</code>
								</p>
								 </td></tr></tbody></table></div></section><section class="section" id="images-other-jenkins-cross-project_images-other-jenkins"><div class="titlepage"><div><div><h3 class="title">5.1.3. Providing Jenkins cross project access</h3></div></div></div><p>
					If you are going to run Jenkins somewhere other than your same project, you must provide an access token to Jenkins to access your project.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Identify the secret for the service account that has appropriate permissions to access the project Jenkins must access:
						</p><pre class="programlisting language-terminal">$ oc describe serviceaccount jenkins</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Name:       default
Labels:     &lt;none&gt;
Secrets:    {  jenkins-token-uyswp    }
            {  jenkins-dockercfg-xcr3d    }
Tokens:     jenkins-token-izv1u
            jenkins-token-uyswp</pre>

							</p></div><p class="simpara">
							In this case the secret is named <code class="literal">jenkins-token-uyswp</code>.
						</p></li><li class="listitem"><p class="simpara">
							Retrieve the token from the secret:
						</p><pre class="programlisting language-terminal">$ oc describe secret &lt;secret name from above&gt;</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Name:       jenkins-token-uyswp
Labels:     &lt;none&gt;
Annotations:    kubernetes.io/service-account.name=jenkins,kubernetes.io/service-account.uid=32f5b661-2a8f-11e5-9528-3c970e3bf0b7
Type:   kubernetes.io/service-account-token
Data
====
ca.crt: 1066 bytes
token:  eyJhbGc..&lt;content cut&gt;....wRA</pre>

							</p></div><p class="simpara">
							The token parameter contains the token value Jenkins requires to access the project.
						</p></li></ol></div></section><section class="section" id="images-other-jenkins-cross-volume-mount_images-other-jenkins"><div class="titlepage"><div><div><h3 class="title">5.1.4. Jenkins cross volume mount points</h3></div></div></div><p>
					The Jenkins image can be run with mounted volumes to enable persistent storage for the configuration:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">/var/lib/jenkins</code> is the data directory where Jenkins stores configuration files, including job definitions.
						</li></ul></div></section><section class="section" id="images-other-jenkins-customize-s2i_images-other-jenkins"><div class="titlepage"><div><div><h3 class="title">5.1.5. Customizing the Jenkins image through source-to-image</h3></div></div></div><p>
					To customize the official OpenShift Container Platform Jenkins image, you can use the image as a source-to-image (S2I) builder.
				</p><p>
					You can use S2I to copy your custom Jenkins jobs definitions, add additional plugins, or replace the provided <code class="literal">config.xml</code> file with your own, custom, configuration.
				</p><p>
					To include your modifications in the Jenkins image, you must have a Git repository with the following directory structure:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">plugins</code></span></dt><dd>
								This directory contains those binary Jenkins plugins you want to copy into Jenkins.
							</dd><dt><span class="term"><code class="literal">plugins.txt</code></span></dt><dd>
								This file lists the plugins you want to install using the following syntax:
							</dd></dl></div><pre class="screen">pluginId:pluginVersion</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">configuration/jobs</code></span></dt><dd>
								This directory contains the Jenkins job definitions.
							</dd><dt><span class="term"><code class="literal">configuration/config.xml</code></span></dt><dd>
								This file contains your custom Jenkins configuration.
							</dd></dl></div><p>
					The contents of the <code class="literal">configuration/</code> directory is copied to the <code class="literal">/var/lib/jenkins/</code> directory, so you can also include additional files, such as <code class="literal">credentials.xml</code>, there.
				</p><div class="formalpara"><p class="title"><strong>Sample build configuration customizes the Jenkins image in OpenShift Container Platform</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: build.openshift.io/v1
kind: BuildConfig
metadata:
  name: custom-jenkins-build
spec:
  source:                       <span id="CO34-1"><!--Empty--></span><span class="callout">1</span>
    git:
      uri: https://github.com/custom/repository
    type: Git
  strategy:                     <span id="CO34-2"><!--Empty--></span><span class="callout">2</span>
    sourceStrategy:
      from:
        kind: ImageStreamTag
        name: jenkins:2
        namespace: openshift
    type: Source
  output:                       <span id="CO34-3"><!--Empty--></span><span class="callout">3</span>
    to:
      kind: ImageStreamTag
      name: custom-jenkins:latest</pre>

					</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO34-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							The <code class="literal">source</code> parameter defines the source Git repository with the layout described above.
						</div></dd><dt><a href="#CO34-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							The <code class="literal">strategy</code> parameter defines the original Jenkins image to use as a source image for the build.
						</div></dd><dt><a href="#CO34-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							The <code class="literal">output</code> parameter defines the resulting, customized Jenkins image that you can use in deployment configurations instead of the official Jenkins image.
						</div></dd></dl></div></section><section class="section" id="images-other-jenkins-config-kubernetes_images-other-jenkins"><div class="titlepage"><div><div><h3 class="title">5.1.6. Configuring the Jenkins Kubernetes plugin</h3></div></div></div><p>
					The OpenShift Jenkins image includes the pre-installed <a class="link" href="https://wiki.jenkins-ci.org/display/JENKINS/Kubernetes+Plugin">Kubernetes plugin for Jenkins</a> so that Jenkins agents can be dynamically provisioned on multiple container hosts using Kubernetes and OpenShift Container Platform.
				</p><p>
					To use the Kubernetes plugin, OpenShift Container Platform provides an OpenShift Agent Base image that is suitable for use as a Jenkins agent.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						OpenShift Container Platform 4.11 moves the OpenShift Jenkins and OpenShift Agent Base images to the <code class="literal">ocp-tools-4</code> repository at <code class="literal">registry.redhat.io</code> so that Red Hat can produce and update the images outside the OpenShift Container Platform lifecycle. Previously, these images were in the OpenShift Container Platform install payload and the <code class="literal">openshift4</code> repository at <code class="literal">registry.redhat.io</code>.
					</p><p>
						The OpenShift Jenkins Maven and NodeJS Agent images were removed from the OpenShift Container Platform 4.11 payload. Red Hat no longer produces these images, and they are not available from the <code class="literal">ocp-tools-4</code> repository at <code class="literal">registry.redhat.io</code>. Red Hat maintains the 4.10 and earlier versions of these images for any significant bug fixes or security CVEs, following the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift">OpenShift Container Platform lifecycle policy</a>.
					</p><p>
						For more information, see the "Important changes to OpenShift Jenkins images" link in the following "Additional resources" section.
					</p></div></div><p>
					The Maven and Node.js agent images are automatically configured as Kubernetes pod template images within the OpenShift Container Platform Jenkins image configuration for the Kubernetes plugin. That configuration includes labels for each image that you can apply to any of your Jenkins jobs under their <code class="literal">Restrict where this project can be run</code> setting. If the label is applied, jobs run under an OpenShift Container Platform pod running the respective agent image.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						In OpenShift Container Platform 4.10 and later, the recommended pattern for running Jenkins agents using the Kubernetes plugin is to use pod templates with both <code class="literal">jnlp</code> and <code class="literal">sidecar</code> containers. The <code class="literal">jnlp</code> container uses the OpenShift Container Platform Jenkins Base agent image to facilitate launching a separate pod for your build. The <code class="literal">sidecar</code> container image has the tools needed to build in a particular language within the separate pod that was launched. Many container images from the Red Hat Container Catalog are referenced in the sample image streams in the <code class="literal">openshift</code> namespace. The OpenShift Container Platform Jenkins image has a pod template named <code class="literal">java-build</code> with sidecar containers that demonstrate this approach. This pod template uses the latest Java version provided by the <code class="literal">java</code> image stream in the <code class="literal">openshift</code> namespace.
					</p></div></div><p>
					The Jenkins image also provides auto-discovery and auto-configuration of additional agent images for the Kubernetes plugin.
				</p><p>
					With the OpenShift Container Platform sync plugin, on Jenkins startup, the Jenkins image searches within the project it is running, or the projects listed in the plugin’s configuration, for the following items:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Image streams with the <code class="literal">role</code> label set to <code class="literal">jenkins-agent</code>.
						</li><li class="listitem">
							Image stream tags with the <code class="literal">role</code> annotation set to <code class="literal">jenkins-agent</code>.
						</li><li class="listitem">
							Config maps with the <code class="literal">role</code> label set to <code class="literal">jenkins-agent</code>.
						</li></ul></div><p>
					When the Jenkins image finds an image stream with the appropriate label, or an image stream tag with the appropriate annotation, it generates the corresponding Kubernetes plugin configuration. This way, you can assign your Jenkins jobs to run in a pod running the container image provided by the image stream.
				</p><p>
					The name and image references of the image stream, or image stream tag, are mapped to the name and image fields in the Kubernetes plugin pod template. You can control the label field of the Kubernetes plugin pod template by setting an annotation on the image stream, or image stream tag object, with the key <code class="literal">agent-label</code>. Otherwise, the name is used as the label.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Do not log in to the Jenkins console and change the pod template configuration. If you do so after the pod template is created, and the OpenShift Container Platform Sync plugin detects that the image associated with the image stream or image stream tag has changed, it replaces the pod template and overwrites those configuration changes. You cannot merge a new configuration with the existing configuration.
					</p><p>
						Consider the config map approach if you have more complex configuration needs.
					</p></div></div><p>
					When it finds a config map with the appropriate label, the Jenkins image assumes that any values in the key-value data payload of the config map contain Extensible Markup Language (XML) consistent with the configuration format for Jenkins and the Kubernetes plugin pod templates. One key advantage of config maps over image streams and image stream tags is that you can control all the Kubernetes plugin pod template parameters.
				</p><div class="formalpara"><p class="title"><strong>Sample config map for <code class="literal">jenkins-agent</code></strong></p><p>
						
<pre class="programlisting language-yaml">kind: ConfigMap
apiVersion: v1
metadata:
  name: jenkins-agent
  labels:
    role: jenkins-agent
data:
  template1: |-
    &lt;org.csanchez.jenkins.plugins.kubernetes.PodTemplate&gt;
      &lt;inheritFrom&gt;&lt;/inheritFrom&gt;
      &lt;name&gt;template1&lt;/name&gt;
      &lt;instanceCap&gt;2147483647&lt;/instanceCap&gt;
      &lt;idleMinutes&gt;0&lt;/idleMinutes&gt;
      &lt;label&gt;template1&lt;/label&gt;
      &lt;serviceAccount&gt;jenkins&lt;/serviceAccount&gt;
      &lt;nodeSelector&gt;&lt;/nodeSelector&gt;
      &lt;volumes/&gt;
      &lt;containers&gt;
        &lt;org.csanchez.jenkins.plugins.kubernetes.ContainerTemplate&gt;
          &lt;name&gt;jnlp&lt;/name&gt;
          &lt;image&gt;openshift/jenkins-agent-maven-35-centos7:v3.10&lt;/image&gt;
          &lt;privileged&gt;false&lt;/privileged&gt;
          &lt;alwaysPullImage&gt;true&lt;/alwaysPullImage&gt;
          &lt;workingDir&gt;/tmp&lt;/workingDir&gt;
          &lt;command&gt;&lt;/command&gt;
          &lt;args&gt;${computer.jnlpmac} ${computer.name}&lt;/args&gt;
          &lt;ttyEnabled&gt;false&lt;/ttyEnabled&gt;
          &lt;resourceRequestCpu&gt;&lt;/resourceRequestCpu&gt;
          &lt;resourceRequestMemory&gt;&lt;/resourceRequestMemory&gt;
          &lt;resourceLimitCpu&gt;&lt;/resourceLimitCpu&gt;
          &lt;resourceLimitMemory&gt;&lt;/resourceLimitMemory&gt;
          &lt;envVars/&gt;
        &lt;/org.csanchez.jenkins.plugins.kubernetes.ContainerTemplate&gt;
      &lt;/containers&gt;
      &lt;envVars/&gt;
      &lt;annotations/&gt;
      &lt;imagePullSecrets/&gt;
      &lt;nodeProperties/&gt;
    &lt;/org.csanchez.jenkins.plugins.kubernetes.PodTemplate&gt;</pre>

					</p></div><p>
					The following example shows two containers that reference image streams in the <code class="literal">openshift</code> namespace. One container handles the JNLP contract for launching Pods as Jenkins Agents. The other container uses an image with tools for building code in a particular coding language:
				</p><pre class="programlisting language-yaml">kind: ConfigMap
apiVersion: v1
metadata:
  name: jenkins-agent
  labels:
    role: jenkins-agent
data:
  template2: |-
        &lt;org.csanchez.jenkins.plugins.kubernetes.PodTemplate&gt;
          &lt;inheritFrom&gt;&lt;/inheritFrom&gt;
          &lt;name&gt;template2&lt;/name&gt;
          &lt;instanceCap&gt;2147483647&lt;/instanceCap&gt;
          &lt;idleMinutes&gt;0&lt;/idleMinutes&gt;
          &lt;label&gt;template2&lt;/label&gt;
          &lt;serviceAccount&gt;jenkins&lt;/serviceAccount&gt;
          &lt;nodeSelector&gt;&lt;/nodeSelector&gt;
          &lt;volumes/&gt;
          &lt;containers&gt;
            &lt;org.csanchez.jenkins.plugins.kubernetes.ContainerTemplate&gt;
              &lt;name&gt;jnlp&lt;/name&gt;
              &lt;image&gt;image-registry.openshift-image-registry.svc:5000/openshift/jenkins-agent-base-rhel8:latest&lt;/image&gt;
              &lt;privileged&gt;false&lt;/privileged&gt;
              &lt;alwaysPullImage&gt;true&lt;/alwaysPullImage&gt;
              &lt;workingDir&gt;/home/jenkins/agent&lt;/workingDir&gt;
              &lt;command&gt;&lt;/command&gt;
              &lt;args&gt;\$(JENKINS_SECRET) \$(JENKINS_NAME)&lt;/args&gt;
              &lt;ttyEnabled&gt;false&lt;/ttyEnabled&gt;
              &lt;resourceRequestCpu&gt;&lt;/resourceRequestCpu&gt;
              &lt;resourceRequestMemory&gt;&lt;/resourceRequestMemory&gt;
              &lt;resourceLimitCpu&gt;&lt;/resourceLimitCpu&gt;
              &lt;resourceLimitMemory&gt;&lt;/resourceLimitMemory&gt;
              &lt;envVars/&gt;
            &lt;/org.csanchez.jenkins.plugins.kubernetes.ContainerTemplate&gt;
            &lt;org.csanchez.jenkins.plugins.kubernetes.ContainerTemplate&gt;
              &lt;name&gt;java&lt;/name&gt;
              &lt;image&gt;image-registry.openshift-image-registry.svc:5000/openshift/java:latest&lt;/image&gt;
              &lt;privileged&gt;false&lt;/privileged&gt;
              &lt;alwaysPullImage&gt;true&lt;/alwaysPullImage&gt;
              &lt;workingDir&gt;/home/jenkins/agent&lt;/workingDir&gt;
              &lt;command&gt;cat&lt;/command&gt;
              &lt;args&gt;&lt;/args&gt;
              &lt;ttyEnabled&gt;true&lt;/ttyEnabled&gt;
              &lt;resourceRequestCpu&gt;&lt;/resourceRequestCpu&gt;
              &lt;resourceRequestMemory&gt;&lt;/resourceRequestMemory&gt;
              &lt;resourceLimitCpu&gt;&lt;/resourceLimitCpu&gt;
              &lt;resourceLimitMemory&gt;&lt;/resourceLimitMemory&gt;
              &lt;envVars/&gt;
            &lt;/org.csanchez.jenkins.plugins.kubernetes.ContainerTemplate&gt;
          &lt;/containers&gt;
          &lt;envVars/&gt;
          &lt;annotations/&gt;
          &lt;imagePullSecrets/&gt;
          &lt;nodeProperties/&gt;
        &lt;/org.csanchez.jenkins.plugins.kubernetes.PodTemplate&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Do not log in to the Jenkins console and change the pod template configuration. If you do so after the pod template is created, and the OpenShift Container Platform Sync plugin detects that the image associated with the image stream or image stream tag has changed, it replaces the pod template and overwrites those configuration changes. You cannot merge a new configuration with the existing configuration.
					</p><p>
						Consider the config map approach if you have more complex configuration needs.
					</p></div></div><p>
					After it is installed, the OpenShift Container Platform Sync plugin monitors the API server of OpenShift Container Platform for updates to image streams, image stream tags, and config maps and adjusts the configuration of the Kubernetes plugin.
				</p><p>
					The following rules apply:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Removing the label or annotation from the config map, image stream, or image stream tag deletes any existing <code class="literal">PodTemplate</code> from the configuration of the Kubernetes plugin.
						</li><li class="listitem">
							If those objects are removed, the corresponding configuration is removed from the Kubernetes plugin.
						</li><li class="listitem">
							If you create appropriately labeled or annotated <code class="literal">ConfigMap</code>, <code class="literal">ImageStream</code>, or <code class="literal">ImageStreamTag</code> objects, or add labels after their initial creation, this results in the creation of a <code class="literal">PodTemplate</code> in the Kubernetes-plugin configuration.
						</li><li class="listitem">
							In the case of the <code class="literal">PodTemplate</code> by config map form, changes to the config map data for the <code class="literal">PodTemplate</code> are applied to the <code class="literal">PodTemplate</code> settings in the Kubernetes plugin configuration. The changes also override any changes that were made to the <code class="literal">PodTemplate</code> through the Jenkins UI between changes to the config map.
						</li></ul></div><p>
					To use a container image as a Jenkins agent, the image must run the agent as an entry point. For more details, see the official <a class="link" href="https://wiki.jenkins-ci.org/display/JENKINS/Distributed+builds#Distributedbuilds-Launchslaveagentheadlessly">Jenkins documentation</a>.
				</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#important-changes-to-openshift-jenkins-images">Important changes to OpenShift Jenkins images</a>
						</li></ul></div></section><section class="section" id="images-other-jenkins-permissions_images-other-jenkins"><div class="titlepage"><div><div><h3 class="title">5.1.7. Jenkins permissions</h3></div></div></div><p>
					If in the config map the <code class="literal">&lt;serviceAccount&gt;</code> element of the pod template XML is the OpenShift Container Platform service account used for the resulting pod, the service account credentials are mounted into the pod. The permissions are associated with the service account and control which operations against the OpenShift Container Platform master are allowed from the pod.
				</p><p>
					Consider the following scenario with service accounts used for the pod, which is launched by the Kubernetes Plugin that runs in the OpenShift Container Platform Jenkins image.
				</p><p>
					If you use the example template for Jenkins that is provided by OpenShift Container Platform, the <code class="literal">jenkins</code> service account is defined with the <code class="literal">edit</code> role for the project Jenkins runs in, and the master Jenkins pod has that service account mounted.
				</p><p>
					The two default Maven and NodeJS pod templates that are injected into the Jenkins configuration are also set to use the same service account as the Jenkins master.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Any pod templates that are automatically discovered by the OpenShift Container Platform sync plugin because their image streams or image stream tags have the required label or annotations are configured to use the Jenkins master service account as their service account.
						</li><li class="listitem">
							For the other ways you can provide a pod template definition into Jenkins and the Kubernetes plugin, you have to explicitly specify the service account to use. Those other ways include the Jenkins console, the <code class="literal">podTemplate</code> pipeline DSL that is provided by the Kubernetes plugin, or labeling a config map whose data is the XML configuration for a pod template.
						</li><li class="listitem">
							If you do not specify a value for the service account, the <code class="literal">default</code> service account is used.
						</li><li class="listitem">
							Ensure that whatever service account is used has the necessary permissions, roles, and so on defined within OpenShift Container Platform to manipulate whatever projects you choose to manipulate from the within the pod.
						</li></ul></div></section><section class="section" id="images-other-jenkins-create-service_images-other-jenkins"><div class="titlepage"><div><div><h3 class="title">5.1.8. Creating a Jenkins service from a template</h3></div></div></div><p>
					Templates provide parameter fields to define all the environment variables with predefined default values. OpenShift Container Platform provides templates to make creating a new Jenkins service easy. The Jenkins templates should be registered in the default <code class="literal">openshift</code> project by your cluster administrator during the initial cluster setup.
				</p><p>
					The two available templates both define deployment configuration and a service. The templates differ in their storage strategy, which affects whether the Jenkins content persists across a pod restart.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						A pod might be restarted when it is moved to another node or when an update of the deployment configuration triggers a redeployment.
					</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">jenkins-ephemeral</code> uses ephemeral storage. On pod restart, all data is lost. This template is only useful for development or testing.
						</li><li class="listitem">
							<code class="literal">jenkins-persistent</code> uses a Persistent Volume (PV) store. Data survives a pod restart.
						</li></ul></div><p>
					To use a PV store, the cluster administrator must define a PV pool in the OpenShift Container Platform deployment.
				</p><p>
					After you select which template you want, you must instantiate the template to be able to use Jenkins.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a new Jenkins application using one of the following methods:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									A PV:
								</p><pre class="programlisting language-terminal">$ oc new-app jenkins-persistent</pre></li><li class="listitem"><p class="simpara">
									Or an <code class="literal">emptyDir</code> type volume where configuration does not persist across pod restarts:
								</p><pre class="programlisting language-terminal">$ oc new-app jenkins-ephemeral</pre></li></ul></div></li></ol></div><p>
					With both templates, you can run <code class="literal">oc describe</code> on them to see all the parameters available for overriding.
				</p><p>
					For example:
				</p><pre class="programlisting language-terminal">$ oc describe jenkins-ephemeral</pre></section><section class="section" id="images-other-jenkins-kubernetes-plugin_images-other-jenkins"><div class="titlepage"><div><div><h3 class="title">5.1.9. Using the Jenkins Kubernetes plugin</h3></div></div></div><p>
					In the following example, the <code class="literal">openshift-jee-sample</code> <code class="literal">BuildConfig</code> object causes a Jenkins Maven agent pod to be dynamically provisioned. The pod clones some Java source code, builds a WAR file, and causes a second <code class="literal">BuildConfig</code>, <code class="literal">openshift-jee-sample-docker</code> to run. The second <code class="literal">BuildConfig</code> layers the new WAR file into a container image.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						OpenShift Container Platform 4.11 removed the OpenShift Jenkins Maven and NodeJS Agent images from its payload. Red Hat no longer produces these images, and they are not available from the <code class="literal">ocp-tools-4</code> repository at <code class="literal">registry.redhat.io</code>. Red Hat maintains the 4.10 and earlier versions of these images for any significant bug fixes or security CVEs, following the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift">OpenShift Container Platform lifecycle policy</a>.
					</p><p>
						For more information, see the "Important changes to OpenShift Jenkins images" link in the following "Additional resources" section.
					</p></div></div><div class="formalpara"><p class="title"><strong>Sample <code class="literal">BuildConfig</code> that uses the Jenkins Kubernetes plugin</strong></p><p>
						
<pre class="programlisting language-yaml">kind: List
apiVersion: v1
items:
- kind: ImageStream
  apiVersion: image.openshift.io/v1
  metadata:
    name: openshift-jee-sample
- kind: BuildConfig
  apiVersion: build.openshift.io/v1
  metadata:
    name: openshift-jee-sample-docker
  spec:
    strategy:
      type: Docker
    source:
      type: Docker
      dockerfile: |-
        FROM openshift/wildfly-101-centos7:latest
        COPY ROOT.war /wildfly/standalone/deployments/ROOT.war
        CMD $STI_SCRIPTS_PATH/run
      binary:
        asFile: ROOT.war
    output:
      to:
        kind: ImageStreamTag
        name: openshift-jee-sample:latest
- kind: BuildConfig
  apiVersion: build.openshift.io/v1
  metadata:
    name: openshift-jee-sample
  spec:
    strategy:
      type: JenkinsPipeline
      jenkinsPipelineStrategy:
        jenkinsfile: |-
          node("maven") {
            sh "git clone https://github.com/openshift/openshift-jee-sample.git ."
            sh "mvn -B -Popenshift package"
            sh "oc start-build -F openshift-jee-sample-docker --from-file=target/ROOT.war"
          }
    triggers:
    - type: ConfigChange</pre>

					</p></div><p>
					It is also possible to override the specification of the dynamically created Jenkins agent pod. The following is a modification to the preceding example, which overrides the container memory and specifies an environment variable.
				</p><div class="formalpara"><p class="title"><strong>Sample <code class="literal">BuildConfig</code> that uses the Jenkins Kubernetes plugin, specifying memory limit and environment variable</strong></p><p>
						
<pre class="programlisting language-yaml">kind: BuildConfig
apiVersion: build.openshift.io/v1
metadata:
  name: openshift-jee-sample
spec:
  strategy:
    type: JenkinsPipeline
    jenkinsPipelineStrategy:
      jenkinsfile: |-
        podTemplate(label: "mypod", <span id="CO35-1"><!--Empty--></span><span class="callout">1</span>
                    cloud: "openshift", <span id="CO35-2"><!--Empty--></span><span class="callout">2</span>
                    inheritFrom: "maven", <span id="CO35-3"><!--Empty--></span><span class="callout">3</span>
                    containers: [
            containerTemplate(name: "jnlp", <span id="CO35-4"><!--Empty--></span><span class="callout">4</span>
                              image: "openshift/jenkins-agent-maven-35-centos7:v3.10", <span id="CO35-5"><!--Empty--></span><span class="callout">5</span>
                              resourceRequestMemory: "512Mi", <span id="CO35-6"><!--Empty--></span><span class="callout">6</span>
                              resourceLimitMemory: "512Mi", <span id="CO35-7"><!--Empty--></span><span class="callout">7</span>
                              envVars: [
              envVar(key: "CONTAINER_HEAP_PERCENT", value: "0.25") <span id="CO35-8"><!--Empty--></span><span class="callout">8</span>
            ])
          ]) {
          node("mypod") { <span id="CO35-9"><!--Empty--></span><span class="callout">9</span>
            sh "git clone https://github.com/openshift/openshift-jee-sample.git ."
            sh "mvn -B -Popenshift package"
            sh "oc start-build -F openshift-jee-sample-docker --from-file=target/ROOT.war"
          }
        }
  triggers:
  - type: ConfigChange</pre>

					</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO35-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							A new pod template called <code class="literal">mypod</code> is defined dynamically. The new pod template name is referenced in the node stanza.
						</div></dd><dt><a href="#CO35-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							The <code class="literal">cloud</code> value must be set to <code class="literal">openshift</code>.
						</div></dd><dt><a href="#CO35-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							The new pod template can inherit its configuration from an existing pod template. In this case, inherited from the Maven pod template that is pre-defined by OpenShift Container Platform.
						</div></dd><dt><a href="#CO35-4"><span class="callout">4</span></a> </dt><dd><div class="para">
							This example overrides values in the pre-existing container, and must be specified by name. All Jenkins agent images shipped with OpenShift Container Platform use the Container name <code class="literal">jnlp</code>.
						</div></dd><dt><a href="#CO35-5"><span class="callout">5</span></a> </dt><dd><div class="para">
							Specify the container image name again. This is a known issue.
						</div></dd><dt><a href="#CO35-6"><span class="callout">6</span></a> </dt><dd><div class="para">
							A memory request of <code class="literal">512 Mi</code> is specified.
						</div></dd><dt><a href="#CO35-7"><span class="callout">7</span></a> </dt><dd><div class="para">
							A memory limit of <code class="literal">512 Mi</code> is specified.
						</div></dd><dt><a href="#CO35-8"><span class="callout">8</span></a> </dt><dd><div class="para">
							An environment variable <code class="literal">CONTAINER_HEAP_PERCENT</code>, with value <code class="literal">0.25</code>, is specified.
						</div></dd><dt><a href="#CO35-9"><span class="callout">9</span></a> </dt><dd><div class="para">
							The node stanza references the name of the defined pod template.
						</div></dd></dl></div><p>
					By default, the pod is deleted when the build completes. This behavior can be modified with the plugin or within a pipeline Jenkinsfile.
				</p><p>
					Upstream Jenkins has more recently introduced a YAML declarative format for defining a <code class="literal">podTemplate</code> pipeline DSL in-line with your pipelines. An example of this format, using the sample <code class="literal">java-builder</code> pod template that is defined in the OpenShift Container Platform Jenkins image:
				</p><pre class="programlisting language-yaml">def nodeLabel = 'java-buidler'

pipeline {
  agent {
    kubernetes {
      cloud 'openshift'
      label nodeLabel
      yaml """
apiVersion: v1
kind: Pod
metadata:
  labels:
    worker: ${nodeLabel}
spec:
  containers:
  - name: jnlp
    image: image-registry.openshift-image-registry.svc:5000/openshift/jenkins-agent-base-rhel8:latest
    args: ['\$(JENKINS_SECRET)', '\$(JENKINS_NAME)']
  - name: java
    image: image-registry.openshift-image-registry.svc:5000/openshift/java:latest
    command:
    - cat
    tty: true
"""
    }
  }

  options {
    timeout(time: 20, unit: 'MINUTES')
  }

  stages {
    stage('Build App') {
      steps {
        container("java") {
          sh "mvn --version"
        }
     }
    }
  }
}</pre><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#important-changes-to-openshift-jenkins-images">Important changes to OpenShift Jenkins images</a>
						</li></ul></div></section><section class="section" id="images-other-jenkins-memory_images-other-jenkins"><div class="titlepage"><div><div><h3 class="title">5.1.10. Jenkins memory requirements</h3></div></div></div><p>
					When deployed by the provided Jenkins Ephemeral or Jenkins Persistent templates, the default memory limit is <code class="literal">1 Gi</code>.
				</p><p>
					By default, all other process that run in the Jenkins container cannot use more than a total of <code class="literal">512 MiB</code> of memory. If they require more memory, the container halts. It is therefore highly recommended that pipelines run external commands in an agent container wherever possible.
				</p><p>
					And if <code class="literal">Project</code> quotas allow for it, see recommendations from the Jenkins documentation on what a Jenkins master should have from a memory perspective. Those recommendations proscribe to allocate even more memory for the Jenkins master.
				</p><p>
					It is recommended to specify memory request and limit values on agent containers created by the Jenkins Kubernetes plugin. Admin users can set default values on a per-agent image basis through the Jenkins configuration. The memory request and limit parameters can also be overridden on a per-container basis.
				</p><p>
					You can increase the amount of memory available to Jenkins by overriding the <code class="literal">MEMORY_LIMIT</code> parameter when instantiating the Jenkins Ephemeral or Jenkins Persistent template.
				</p></section><section class="section _additional-resources" id="additional-resources-3"><div class="titlepage"><div><div><h3 class="title">5.1.11. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/architecture/#base-image-options">Base image options</a> for more information about the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux_atomic_host/7/html-single/getting_started_with_containers/index#using_red_hat_base_container_images_standard_and_minimal">Red Hat Universal Base Images</a> (UBI).
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#important-changes-to-openshift-jenkins-images">Important changes to OpenShift Jenkins images</a>
						</li></ul></div></section></section><section class="section" id="images-other-jenkins-agent"><div class="titlepage"><div><div><h2 class="title">5.2. Jenkins agent</h2></div></div></div><p>
				OpenShift Container Platform provides a base image for use as a Jenkins agent.
			</p><p>
				The Base image for Jenkins agents does the following:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Pulls in both the required tools, headless Java, the Jenkins JNLP client, and the useful ones, including <code class="literal">git</code>, <code class="literal">tar</code>, <code class="literal">zip</code>, and <code class="literal">nss</code>, among others.
					</li><li class="listitem">
						Establishes the JNLP agent as the entry point.
					</li><li class="listitem">
						Includes the <code class="literal">oc</code> client tool for invoking command line operations from within Jenkins jobs.
					</li><li class="listitem">
						Provides Dockerfiles for both Red Hat Enterprise Linux (RHEL) and <code class="literal">localdev</code> images.
					</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Use a version of the agent image that is appropriate for your OpenShift Container Platform release version. Embedding an <code class="literal">oc</code> client version that is not compatible with the OpenShift Container Platform version can cause unexpected behavior.
				</p></div></div><p>
				The OpenShift Container Platform Jenkins image also defines the following sample <code class="literal">java-builder</code> pod template to illustrate how you can use the agent image with the Jenkins Kubernetes plugin.
			</p><p>
				The <code class="literal">java-builder</code> pod template employs two containers: * A <code class="literal">jnlp</code> container that uses the OpenShift Container Platform Base agent image and handles the JNLP contract for starting and stopping Jenkins agents. * A <code class="literal">java</code> container that uses the <code class="literal">java</code> OpenShift Container Platform Sample ImageStream, which contains the various Java binaries, including the Maven binary <code class="literal">mvn</code>, for building code.
			</p><section class="section" id="images-other-jenkins-agent-images_images-other-jenkins-agent"><div class="titlepage"><div><div><h3 class="title">5.2.1. Jenkins agent images</h3></div></div></div><p>
					The OpenShift Container Platform Jenkins agent images are available on <a class="link" href="https://quay.io">Quay.io</a> or <a class="link" href="https://registry.redhat.io">registry.redhat.io</a>.
				</p><p>
					Jenkins images are available through the Red Hat Registry:
				</p><pre class="programlisting language-terminal">$ docker pull registry.redhat.io/ocp-tools-4/jenkins-rhel8:&lt;image_tag&gt;</pre><pre class="programlisting language-terminal">$ docker pull registry.redhat.io/ocp-tools-4/jenkins-agent-base-rhel8:&lt;image_tag&gt;</pre><p>
					To use these images, you can either access them directly from <a class="link" href="https://quay.io">Quay.io</a> or <a class="link" href="https://registry.redhat.io">registry.redhat.io</a> or push them into your OpenShift Container Platform container image registry.
				</p></section><section class="section" id="images-other-jenkins-agent-env-var_images-other-jenkins-agent"><div class="titlepage"><div><div><h3 class="title">5.2.2. Jenkins agent environment variables</h3></div></div></div><p>
					Each Jenkins agent container can be configured with the following environment variables.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140458466865328" scope="col">Variable</th><th align="left" valign="top" id="idm140458466864240" scope="col">Definition</th><th align="left" valign="top" id="idm140458466863152" scope="col">Example values and settings</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140458466865328"> <p>
									<code class="literal">JAVA_MAX_HEAP_PARAM</code>, <code class="literal">CONTAINER_HEAP_PERCENT</code>, <code class="literal">JENKINS_MAX_HEAP_UPPER_BOUND_MB</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458466864240"> <p>
									These values control the maximum heap size of the Jenkins JVM. If <code class="literal">JAVA_MAX_HEAP_PARAM</code> is set, its value takes precedence. Otherwise, the maximum heap size is dynamically calculated as <code class="literal">CONTAINER_HEAP_PERCENT</code> of the container memory limit, optionally capped at <code class="literal">JENKINS_MAX_HEAP_UPPER_BOUND_MB</code> MiB.
								</p>
								 <p>
									By default, the maximum heap size of the Jenkins JVM is set to 50% of the container memory limit with no cap.
								</p>
								 </td><td align="left" valign="top" headers="idm140458466863152"> <p>
									<code class="literal">JAVA_MAX_HEAP_PARAM</code> example setting: <code class="literal">-Xmx512m</code>
								</p>
								 <p>
									<code class="literal">CONTAINER_HEAP_PERCENT</code> default: <code class="literal">0.5</code>, or 50%
								</p>
								 <p>
									<code class="literal">JENKINS_MAX_HEAP_UPPER_BOUND_MB</code> example setting: <code class="literal">512 MiB</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458466865328"> <p>
									<code class="literal">JAVA_INITIAL_HEAP_PARAM</code>, <code class="literal">CONTAINER_INITIAL_PERCENT</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458466864240"> <p>
									These values control the initial heap size of the Jenkins JVM. If <code class="literal">JAVA_INITIAL_HEAP_PARAM</code> is set, its value takes precedence. Otherwise, the initial heap size is dynamically calculated as <code class="literal">CONTAINER_INITIAL_PERCENT</code> of the dynamically calculated maximum heap size.
								</p>
								 <p>
									By default, the JVM sets the initial heap size.
								</p>
								 </td><td align="left" valign="top" headers="idm140458466863152"> <p>
									<code class="literal">JAVA_INITIAL_HEAP_PARAM</code> example setting: <code class="literal">-Xms32m</code>
								</p>
								 <p>
									<code class="literal">CONTAINER_INITIAL_PERCENT</code> example setting: <code class="literal">0.1</code>, or 10%
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458466865328"> <p>
									<code class="literal">CONTAINER_CORE_LIMIT</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458466864240"> <p>
									If set, specifies an integer number of cores used for sizing numbers of internal JVM threads.
								</p>
								 </td><td align="left" valign="top" headers="idm140458466863152"> <p>
									Example setting: <code class="literal">2</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458466865328"> <p>
									<code class="literal">JAVA_TOOL_OPTIONS</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458466864240"> <p>
									Specifies options to apply to all JVMs running in this container. It is not recommended to override this value.
								</p>
								 </td><td align="left" valign="top" headers="idm140458466863152"> <p>
									Default: <code class="literal">-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -Dsun.zip.disableMemoryMapping=true</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458466865328"> <p>
									<code class="literal">JAVA_GC_OPTS</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458466864240"> <p>
									Specifies Jenkins JVM garbage collection parameters. It is not recommended to override this value.
								</p>
								 </td><td align="left" valign="top" headers="idm140458466863152"> <p>
									Default: <code class="literal">-XX:+UseParallelGC -XX:MinHeapFreeRatio=5 -XX:MaxHeapFreeRatio=10 -XX:GCTimeRatio=4 -XX:AdaptiveSizePolicyWeight=90</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458466865328"> <p>
									<code class="literal">JENKINS_JAVA_OVERRIDES</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458466864240"> <p>
									Specifies additional options for the Jenkins JVM. These options are appended to all other options, including the Java options above, and can be used to override any of them, if necessary. Separate each additional option with a space and if any option contains space characters, escape them with a backslash.
								</p>
								 </td><td align="left" valign="top" headers="idm140458466863152"> <p>
									Example settings: <code class="literal">-Dfoo -Dbar</code>; <code class="literal">-Dfoo=first\ value -Dbar=second\ value</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458466865328"> <p>
									<code class="literal">USE_JAVA_VERSION</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140458466864240"> <p>
									Specifies the version of Java version to use to run the agent in its container. The container base image has two versions of java installed: <code class="literal">java-11</code> and <code class="literal">java-1.8.0</code>. If you extend the container base image, you can specify any alternative version of java using its associated suffix.
								</p>
								 </td><td align="left" valign="top" headers="idm140458466863152"> <p>
									The default value is <code class="literal">java-11</code>.
								</p>
								 <p>
									Example setting: <code class="literal">java-1.8.0</code>
								</p>
								 </td></tr></tbody></table></div></section><section class="section" id="images-other-jenkins-agent-memory_images-other-jenkins-agent"><div class="titlepage"><div><div><h3 class="title">5.2.3. Jenkins agent memory requirements</h3></div></div></div><p>
					A JVM is used in all Jenkins agents to host the Jenkins JNLP agent as well as to run any Java applications such as <code class="literal">javac</code>, Maven, or Gradle.
				</p><p>
					By default, the Jenkins JNLP agent JVM uses 50% of the container memory limit for its heap. This value can be modified by the <code class="literal">CONTAINER_HEAP_PERCENT</code> environment variable. It can also be capped at an upper limit or overridden entirely.
				</p><p>
					By default, any other processes run in the Jenkins agent container, such as shell scripts or <code class="literal">oc</code> commands run from pipelines, cannot use more than the remaining 50% memory limit without provoking an OOM kill.
				</p><p>
					By default, each further JVM process that runs in a Jenkins agent container uses up to 25% of the container memory limit for its heap. It might be necessary to tune this limit for many build workloads.
				</p></section><section class="section" id="images-other-jenkins-agent-gradle_images-other-jenkins-agent"><div class="titlepage"><div><div><h3 class="title">5.2.4. Jenkins agent Gradle builds</h3></div></div></div><p>
					Hosting Gradle builds in the Jenkins agent on OpenShift Container Platform presents additional complications because in addition to the Jenkins JNLP agent and Gradle JVMs, Gradle spawns a third JVM to run tests if they are specified.
				</p><p>
					The following settings are suggested as a starting point for running Gradle builds in a memory constrained Jenkins agent on OpenShift Container Platform. You can modify these settings as required.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Ensure the long-lived Gradle daemon is disabled by adding <code class="literal">org.gradle.daemon=false</code> to the <code class="literal">gradle.properties</code> file.
						</li><li class="listitem">
							Disable parallel build execution by ensuring <code class="literal">org.gradle.parallel=true</code> is not set in the <code class="literal">gradle.properties</code> file and that <code class="literal">--parallel</code> is not set as a command line argument.
						</li><li class="listitem">
							To prevent Java compilations running out-of-process, set <code class="literal">java { options.fork = false }</code> in the <code class="literal">build.gradle</code> file.
						</li><li class="listitem">
							Disable multiple additional test processes by ensuring <code class="literal">test { maxParallelForks = 1 }</code> is set in the <code class="literal">build.gradle</code> file.
						</li><li class="listitem">
							Override the Gradle JVM memory parameters by the <code class="literal">GRADLE_OPTS</code>, <code class="literal">JAVA_OPTS</code> or <code class="literal">JAVA_TOOL_OPTIONS</code> environment variables.
						</li><li class="listitem">
							Set the maximum heap size and JVM arguments for any Gradle test JVM by defining the <code class="literal">maxHeapSize</code> and <code class="literal">jvmArgs</code> settings in <code class="literal">build.gradle</code>, or through the <code class="literal">-Dorg.gradle.jvmargs</code> command line argument.
						</li></ul></div></section><section class="section" id="images-other-jenkins-agent-pod-retention_images-other-jenkins-agent"><div class="titlepage"><div><div><h3 class="title">5.2.5. Jenkins agent pod retention</h3></div></div></div><p>
					Jenkins agent pods, are deleted by default after the build completes or is stopped. This behavior can be changed by the Kubernetes plugin pod retention setting. Pod retention can be set for all Jenkins builds, with overrides for each pod template. The following behaviors are supported:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">Always</code> keeps the build pod regardless of build result.
						</li><li class="listitem">
							<code class="literal">Default</code> uses the plugin value, which is the pod template only.
						</li><li class="listitem">
							<code class="literal">Never</code> always deletes the pod.
						</li><li class="listitem">
							<code class="literal">On Failure</code> keeps the pod if it fails during the build.
						</li></ul></div><p>
					You can override pod retention in the pipeline Jenkinsfile:
				</p><pre class="programlisting language-groovy">podTemplate(label: "mypod",
  cloud: "openshift",
  inheritFrom: "maven",
  podRetention: onFailure(), <span id="CO36-1"><!--Empty--></span><span class="callout">1</span>
  containers: [
    ...
  ]) {
  node("mypod") {
    ...
  }
}</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO36-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							Allowed values for <code class="literal">podRetention</code> are <code class="literal">never()</code>, <code class="literal">onFailure()</code>, <code class="literal">always()</code>, and <code class="literal">default()</code>.
						</div></dd></dl></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Pods that are kept might continue to run and count against resource quotas.
					</p></div></div></section></section><section class="section" id="migrating-from-jenkins-to-openshift-pipelines_images-other-jenkins-agent"><div class="titlepage"><div><div><h2 class="title">5.3. Migrating from Jenkins to OpenShift Pipelines or Tekton</h2></div></div></div><p>
				You can migrate your CI/CD workflows from Jenkins to <a class="link" href="https://docs.openshift.com/pipelines/latest/about/understanding-openshift-pipelines.html">Red Hat OpenShift Pipelines</a>, a cloud-native CI/CD experience based on the Tekton project.
			</p><section class="section" id="jt-comparison-of-jenkins-and-openshift-pipelines-concepts_migrating-from-jenkins-to-openshift-pipelines"><div class="titlepage"><div><div><h3 class="title">5.3.1. Comparison of Jenkins and OpenShift Pipelines concepts</h3></div></div></div><p>
					You can review and compare the following equivalent terms used in Jenkins and OpenShift Pipelines.
				</p><section class="section" id="jenkins-terminology"><div class="titlepage"><div><div><h4 class="title">5.3.1.1. Jenkins terminology</h4></div></div></div><p>
						Jenkins offers declarative and scripted pipelines that are extensible using shared libraries and plugins. Some basic terms in Jenkins are as follows:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Pipeline</strong></span>: Automates the entire process of building, testing, and deploying applications by using <a class="link" href="https://groovy-lang.org/">Groovy</a> syntax.
							</li><li class="listitem">
								<span class="strong strong"><strong>Node</strong></span>: A machine capable of either orchestrating or executing a scripted pipeline.
							</li><li class="listitem">
								<span class="strong strong"><strong>Stage</strong></span>: A conceptually distinct subset of tasks performed in a pipeline. Plugins or user interfaces often use this block to display the status or progress of tasks.
							</li><li class="listitem">
								<span class="strong strong"><strong>Step</strong></span>: A single task that specifies the exact action to be taken, either by using a command or a script.
							</li></ul></div></section><section class="section" id="openshift-pipelines-terminology"><div class="titlepage"><div><div><h4 class="title">5.3.1.2. OpenShift Pipelines terminology</h4></div></div></div><p>
						OpenShift Pipelines uses <a class="link" href="https://yaml.org/">YAML</a> syntax for declarative pipelines and consists of tasks. Some basic terms in OpenShift Pipelines are as follows:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Pipeline</strong></span>: A set of tasks in a series, in parallel, or both.
							</li><li class="listitem">
								<span class="strong strong"><strong>Task</strong></span>: A sequence of steps as commands, binaries, or scripts.
							</li><li class="listitem">
								<span class="strong strong"><strong>PipelineRun</strong></span>: Execution of a pipeline with one or more tasks.
							</li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>TaskRun</strong></span>: Execution of a task with one or more steps.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									You can initiate a PipelineRun or a TaskRun with a set of inputs such as parameters and workspaces, and the execution results in a set of outputs and artifacts.
								</p></div></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Workspace</strong></span>: In OpenShift Pipelines, workspaces are conceptual blocks that serve the following purposes:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Storage of inputs, outputs, and build artifacts.
									</li><li class="listitem">
										Common space to share data among tasks.
									</li><li class="listitem">
										Mount points for credentials held in secrets, configurations held in config maps, and common tools shared by an organization.
									</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									In Jenkins, there is no direct equivalent of OpenShift Pipelines workspaces. You can think of the control node as a workspace, as it stores the cloned code repository, build history, and artifacts. When a job is assigned to a different node, the cloned code and the generated artifacts are stored in that node, but the control node maintains the build history.
								</p></div></div></li></ul></div></section><section class="section" id="mapping-of-concepts"><div class="titlepage"><div><div><h4 class="title">5.3.1.3. Mapping of concepts</h4></div></div></div><p>
						The building blocks of Jenkins and OpenShift Pipelines are not equivalent, and a specific comparison does not provide a technically accurate mapping. The following terms and concepts in Jenkins and OpenShift Pipelines correlate in general:
					</p><div class="table" id="idm140458464497504"><p class="title"><strong>Table 5.1. Jenkins and OpenShift Pipelines - basic comparison</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140458464492640" scope="col">Jenkins</th><th align="left" valign="top" id="idm140458464491552" scope="col">OpenShift Pipelines</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140458464492640"> <p>
										Pipeline
									</p>
									 </td><td align="left" valign="top" headers="idm140458464491552"> <p>
										Pipeline and PipelineRun
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140458464492640"> <p>
										Stage
									</p>
									 </td><td align="left" valign="top" headers="idm140458464491552"> <p>
										Task
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140458464492640"> <p>
										Step
									</p>
									 </td><td align="left" valign="top" headers="idm140458464491552"> <p>
										A step in a task
									</p>
									 </td></tr></tbody></table></div></div></section></section><section class="section" id="jt-migrating-a-sample-pipeline-from-jenkins-to-openshift-pipelines_migrating-from-jenkins-to-openshift-pipelines"><div class="titlepage"><div><div><h3 class="title">5.3.2. Migrating a sample pipeline from Jenkins to OpenShift Pipelines</h3></div></div></div><p>
					You can use the following equivalent examples to help migrate your build, test, and deploy pipelines from Jenkins to OpenShift Pipelines.
				</p><section class="section" id="jenkins-pipeline"><div class="titlepage"><div><div><h4 class="title">5.3.2.1. Jenkins pipeline</h4></div></div></div><p>
						Consider a Jenkins pipeline written in Groovy for building, testing, and deploying:
					</p><pre class="programlisting language-groovy">pipeline {
   agent any
   stages {
       stage('Build') {
           steps {
               sh 'make'
           }
       }
       stage('Test'){
           steps {
               sh 'make check'
               junit 'reports/**/*.xml'
           }
       }
       stage('Deploy') {
           steps {
               sh 'make publish'
           }
       }
   }
}</pre></section><section class="section" id="openshift-pipelines-pipeline"><div class="titlepage"><div><div><h4 class="title">5.3.2.2. OpenShift Pipelines pipeline</h4></div></div></div><p>
						To create a pipeline in OpenShift Pipelines that is equivalent to the preceding Jenkins pipeline, you create the following three tasks:
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">build</code> task YAML definition file</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: myproject-build
spec:
  workspaces:
  - name: source
  steps:
  - image: my-ci-image
    command: ["make"]
    workingDir: $(workspaces.source.path)</pre>

						</p></div><div class="formalpara"><p class="title"><strong>Example <code class="literal">test</code> task YAML definition file</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: myproject-test
spec:
  workspaces:
  - name: source
  steps:
  - image: my-ci-image
    command: ["make check"]
    workingDir: $(workspaces.source.path)
  - image: junit-report-image
    script: |
      #!/usr/bin/env bash
      junit-report reports/**/*.xml
    workingDir: $(workspaces.source.path)</pre>

						</p></div><div class="formalpara"><p class="title"><strong>Example <code class="literal">deploy</code> task YAML definition file</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: myprojectd-deploy
spec:
  workspaces:
  - name: source
  steps:
  - image: my-deploy-image
    command: ["make deploy"]
    workingDir: $(workspaces.source.path)</pre>

						</p></div><p>
						You can combine the three tasks sequentially to form a pipeline in OpenShift Pipelines:
					</p><div class="formalpara"><p class="title"><strong>Example: OpenShift Pipelines pipeline for building, testing, and deployment</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: tekton.dev/v1beta1
kind: Pipeline
metadata:
  name: myproject-pipeline
spec:
  workspaces:
  - name: shared-dir
  tasks:
  - name: build
    taskRef:
      name: myproject-build
    workspaces:
    - name: source
      workspace: shared-dir
  - name: test
    taskRef:
      name: myproject-test
    workspaces:
    - name: source
      workspace: shared-dir
  - name: deploy
    taskRef:
      name: myproject-deploy
    workspaces:
    - name: source
      workspace: shared-dir</pre>

						</p></div></section></section><section class="section" id="jt-migrating-from-jenkins-plugins-to-openshift-pipelines-hub-tasks_migrating-from-jenkins-to-openshift-pipelines"><div class="titlepage"><div><div><h3 class="title">5.3.3. Migrating from Jenkins plugins to Tekton Hub tasks</h3></div></div></div><p>
					You can extend the capability of Jenkins by using <a class="link" href="https://plugins.jenkinsci.org">plugins</a>. To achieve similar extensibility in OpenShift Pipelines, use any of the tasks available from <a class="link" href="https://hub.tekton.dev">Tekton Hub</a>.
				</p><p>
					For example, consider the <a class="link" href="https://hub.tekton.dev/tekton/task/git-clone">git-clone</a> task in Tekton Hub, which corresponds to the <a class="link" href="https://plugins.jenkins.io/git/">git plugin</a> for Jenkins.
				</p><div class="formalpara"><p class="title"><strong>Example: <code class="literal">git-clone</code> task from Tekton Hub</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: tekton.dev/v1beta1
kind: Pipeline
metadata:
 name: demo-pipeline
spec:
 params:
   - name: repo_url
   - name: revision
 workspaces:
   - name: source
 tasks:
   - name: fetch-from-git
     taskRef:
       name: git-clone
     params:
       - name: url
         value: $(params.repo_url)
       - name: revision
         value: $(params.revision)
     workspaces:
     - name: output
       workspace: source</pre>

					</p></div></section><section class="section" id="jt-extending-openshift-pipelines-capabilities-using-custom-tasks-and-scripts_migrating-from-jenkins-to-openshift-pipelines"><div class="titlepage"><div><div><h3 class="title">5.3.4. Extending OpenShift Pipelines capabilities using custom tasks and scripts</h3></div></div></div><p>
					In OpenShift Pipelines, if you do not find the right task in Tekton Hub, or need greater control over tasks, you can create custom tasks and scripts to extend the capabilities of OpenShift Pipelines.
				</p><div class="formalpara"><p class="title"><strong>Example: A custom task for running the <code class="literal">maven test</code> command</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: maven-test
spec:
  workspaces:
  - name: source
  steps:
  - image: my-maven-image
    command: ["mvn test"]
    workingDir: $(workspaces.source.path)</pre>

					</p></div><div class="formalpara"><p class="title"><strong>Example: Run a custom shell script by providing its path</strong></p><p>
						
<pre class="programlisting language-yaml">...
steps:
  image: ubuntu
  script: |
      #!/usr/bin/env bash
      /workspace/my-script.sh
...</pre>

					</p></div><div class="formalpara"><p class="title"><strong>Example: Run a custom Python script by writing it in the YAML file</strong></p><p>
						
<pre class="programlisting language-yaml">...
steps:
  image: python
  script: |
      #!/usr/bin/env python3
      print(“hello from python!”)
...</pre>

					</p></div></section><section class="section" id="jt-comparison-of-jenkins-openshift-pipelines-execution-models_migrating-from-jenkins-to-openshift-pipelines"><div class="titlepage"><div><div><h3 class="title">5.3.5. Comparison of Jenkins and OpenShift Pipelines execution models</h3></div></div></div><p>
					Jenkins and OpenShift Pipelines offer similar functions but are different in architecture and execution.
				</p><div class="table" id="idm140458463585328"><p class="title"><strong>Table 5.2. Comparison of execution models in Jenkins and OpenShift Pipelines</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140458463580448" scope="col">Jenkins</th><th align="left" valign="top" id="idm140458463579360" scope="col">OpenShift Pipelines</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140458463580448"> <p>
									Jenkins has a controller node. Jenkins runs pipelines and steps centrally, or orchestrates jobs running in other nodes.
								</p>
								 </td><td align="left" valign="top" headers="idm140458463579360"> <p>
									OpenShift Pipelines is serverless and distributed, and there is no central dependency for execution.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458463580448"> <p>
									Containers are launched by the Jenkins controller node through the pipeline.
								</p>
								 </td><td align="left" valign="top" headers="idm140458463579360"> <p>
									OpenShift Pipelines adopts a 'container-first' approach, where every step runs as a container in a pod (equivalent to nodes in Jenkins).
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140458463580448"> <p>
									Extensibility is achieved by using plugins.
								</p>
								 </td><td align="left" valign="top" headers="idm140458463579360"> <p>
									Extensibility is achieved by using tasks in Tekton Hub or by creating custom tasks and scripts.
								</p>
								 </td></tr></tbody></table></div></div></section><section class="section" id="jt-examples-of-common-use-cases_migrating-from-jenkins-to-openshift-pipelines"><div class="titlepage"><div><div><h3 class="title">5.3.6. Examples of common use cases</h3></div></div></div><p>
					Both Jenkins and OpenShift Pipelines offer capabilities for common CI/CD use cases, such as:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Compiling, building, and deploying images using Apache Maven
						</li><li class="listitem">
							Extending the core capabilities by using plugins
						</li><li class="listitem">
							Reusing shareable libraries and custom scripts
						</li></ul></div><section class="section" id="running-a-maven-pipeline-in-jenkins-and-openshift-pipelines"><div class="titlepage"><div><div><h4 class="title">5.3.6.1. Running a Maven pipeline in Jenkins and OpenShift Pipelines</h4></div></div></div><p>
						You can use Maven in both Jenkins and OpenShift Pipelines workflows for compiling, building, and deploying images. To map your existing Jenkins workflow to OpenShift Pipelines, consider the following examples:
					</p><div class="formalpara"><p class="title"><strong>Example: Compile and build an image and deploy it to OpenShift using Maven in Jenkins</strong></p><p>
							
<pre class="programlisting language-groovy">#!/usr/bin/groovy
node('maven') {
    stage 'Checkout'
    checkout scm

    stage 'Build'
    sh 'cd helloworld &amp;&amp; mvn clean'
    sh 'cd helloworld &amp;&amp; mvn compile'

    stage 'Run Unit Tests'
    sh 'cd helloworld &amp;&amp; mvn test'

    stage 'Package'
    sh 'cd helloworld &amp;&amp; mvn package'

    stage 'Archive artifact'
    sh 'mkdir -p artifacts/deployments &amp;&amp; cp helloworld/target/*.war artifacts/deployments'
    archive 'helloworld/target/*.war'

    stage 'Create Image'
    sh 'oc login https://kubernetes.default -u admin -p admin --insecure-skip-tls-verify=true'
    sh 'oc new-project helloworldproject'
    sh 'oc project helloworldproject'
    sh 'oc process -f helloworld/jboss-eap70-binary-build.json | oc create -f -'
    sh 'oc start-build eap-helloworld-app --from-dir=artifacts/'

    stage 'Deploy'
    sh 'oc new-app helloworld/jboss-eap70-deploy.json' }</pre>

						</p></div><div class="formalpara"><p class="title"><strong>Example: Compile and build an image and deploy it to OpenShift using Maven in OpenShift Pipelines.</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: tekton.dev/v1beta1
kind: Pipeline
metadata:
  name: maven-pipeline
spec:
  workspaces:
    - name: shared-workspace
    - name: maven-settings
    - name: kubeconfig-dir
      optional: true
  params:
    - name: repo-url
    - name: revision
    - name: context-path
  tasks:
    - name: fetch-repo
      taskRef:
        name: git-clone
      workspaces:
        - name: output
          workspace: shared-workspace
      params:
        - name: url
          value: "$(params.repo-url)"
        - name: subdirectory
          value: ""
        - name: deleteExisting
          value: "true"
        - name: revision
          value: $(params.revision)
    - name: mvn-build
      taskRef:
        name: maven
      runAfter:
        - fetch-repo
      workspaces:
        - name: source
          workspace: shared-workspace
        - name: maven-settings
          workspace: maven-settings
      params:
        - name: CONTEXT_DIR
          value: "$(params.context-path)"
        - name: GOALS
          value: ["-DskipTests", "clean", "compile"]
    - name: mvn-tests
      taskRef:
        name: maven
      runAfter:
        - mvn-build
      workspaces:
        - name: source
          workspace: shared-workspace
        - name: maven-settings
          workspace: maven-settings
      params:
        - name: CONTEXT_DIR
          value: "$(params.context-path)"
        - name: GOALS
          value: ["test"]
    - name: mvn-package
      taskRef:
        name: maven
      runAfter:
        - mvn-tests
      workspaces:
        - name: source
          workspace: shared-workspace
        - name: maven-settings
          workspace: maven-settings
      params:
        - name: CONTEXT_DIR
          value: "$(params.context-path)"
        - name: GOALS
          value: ["package"]
    - name: create-image-and-deploy
      taskRef:
        name: openshift-client
      runAfter:
        - mvn-package
      workspaces:
        - name: manifest-dir
          workspace: shared-workspace
        - name: kubeconfig-dir
          workspace: kubeconfig-dir
      params:
        - name: SCRIPT
          value: |
            cd "$(params.context-path)"
            mkdir -p ./artifacts/deployments &amp;&amp; cp ./target/*.war ./artifacts/deployments
            oc new-project helloworldproject
            oc project helloworldproject
            oc process -f jboss-eap70-binary-build.json | oc create -f -
            oc start-build eap-helloworld-app --from-dir=artifacts/
            oc new-app jboss-eap70-deploy.json</pre>

						</p></div></section><section class="section" id="extending-the-core-capabilities-of-jenkins-and-openshift-pipelines-by-using-plugins"><div class="titlepage"><div><div><h4 class="title">5.3.6.2. Extending the core capabilities of Jenkins and OpenShift Pipelines by using plugins</h4></div></div></div><p>
						Jenkins has the advantage of a large ecosystem of numerous plugins developed over the years by its extensive user base. You can search and browse the plugins in the <a class="link" href="https://plugins.jenkins.io/">Jenkins Plugin Index</a>.
					</p><p>
						OpenShift Pipelines also has many tasks developed and contributed by the community and enterprise users. A publicly available catalog of reusable OpenShift Pipelines tasks are available in the <a class="link" href="https://hub.tekton.dev/">Tekton Hub</a>.
					</p><p>
						In addition, OpenShift Pipelines incorporates many of the plugins of the Jenkins ecosystem within its core capabilities. For example, authorization is a critical function in both Jenkins and OpenShift Pipelines. While Jenkins ensures authorization using the <a class="link" href="https://plugins.jenkins.io/role-strategy/">Role-based Authorization Strategy</a> plugin, OpenShift Pipelines uses OpenShift’s built-in Role-based Access Control system.
					</p></section><section class="section" id="sharing-reusable-code-in-jenkins-and-openshift-pipelines"><div class="titlepage"><div><div><h4 class="title">5.3.6.3. Sharing reusable code in Jenkins and OpenShift Pipelines</h4></div></div></div><p>
						Jenkins <a class="link" href="https://www.jenkins.io/doc/book/pipeline/shared-libraries/">shared libraries</a> provide reusable code for parts of Jenkins pipelines. The libraries are shared between <a class="link" href="https://www.jenkins.io/doc/book/pipeline/jenkinsfile/">Jenkinsfiles</a> to create highly modular pipelines without code repetition.
					</p><p>
						Although there is no direct equivalent of Jenkins shared libraries in OpenShift Pipelines, you can achieve similar workflows by using tasks from the <a class="link" href="https://hub.tekton.dev/">Tekton Hub</a> in combination with custom tasks and scripts.
					</p></section></section><section class="section _additional-resources" id="additional-resources-4"><div class="titlepage"><div><div><h3 class="title">5.3.7. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://docs.openshift.com/pipelines/latest/about/understanding-openshift-pipelines.html">Understanding OpenShift Pipelines</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#using-rbac">Role-based Access Control</a>
						</li></ul></div></section></section><section class="section" id="important-changes-to-openshift-jenkins-images"><div class="titlepage"><div><div><h2 class="title">5.4. Important changes to OpenShift Jenkins images</h2></div></div></div><p>
				OpenShift Container Platform 4.11 moves the OpenShift Jenkins and OpenShift Agent Base images to the <code class="literal">ocp-tools-4</code> repository at <code class="literal">registry.redhat.io</code>. It also removes the OpenShift Jenkins Maven and NodeJS Agent images from its payload:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						OpenShift Container Platform 4.11 moves the OpenShift Jenkins and OpenShift Agent Base images to the <code class="literal">ocp-tools-4</code> repository at <code class="literal">registry.redhat.io</code> so that Red Hat can produce and update the images outside the OpenShift Container Platform lifecycle. Previously, these images were in the OpenShift Container Platform install payload and the <code class="literal">openshift4</code> repository at <code class="literal">registry.redhat.io</code>.
					</li><li class="listitem">
						OpenShift Container Platform 4.10 deprecated the OpenShift Jenkins Maven and NodeJS Agent images. OpenShift Container Platform 4.11 removes these images from its payload. Red Hat no longer produces these images, and they are not available from the <code class="literal">ocp-tools-4</code> repository at <code class="literal">registry.redhat.io</code>. Red Hat maintains the 4.10 and earlier versions of these images for any significant bug fixes or security CVEs, following the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift">OpenShift Container Platform lifecycle policy</a>.
					</li></ul></div><p>
				These changes support the OpenShift Container Platform 4.10 recommendation to use <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#images-other-jenkins-config-kubernetes_images-other-jenkins">multiple container Pod Templates with the Jenkins Kubernetes Plugin</a>.
			</p><section class="section" id="relocation-of-openshift-jenkins-images_important-changes-to-openshift-jenkins-images"><div class="titlepage"><div><div><h3 class="title">5.4.1. Relocation of OpenShift Jenkins images</h3></div></div></div><p>
					OpenShift Container Platform 4.11 makes significant changes to the location and availability of specific OpenShift Jenkins images. Additionally, you can configure when and how to update these images.
				</p><div class="itemizedlist"><p class="title"><strong>What stays the same with the OpenShift Jenkins images?</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The Cluster Samples Operator manages the <code class="literal">ImageStream</code> and <code class="literal">Template</code> objects for operating the OpenShift Jenkins images.
						</li><li class="listitem">
							By default, the Jenkins <code class="literal">DeploymentConfig</code> object from the Jenkins pod template triggers a redeployment when the Jenkins image changes. By default, this image is referenced by the <code class="literal">jenkins:2</code> image stream tag of Jenkins image stream in the <code class="literal">openshift</code> namespace in the <code class="literal">ImageStream</code> YAML file in the Samples Operator payload.
						</li><li class="listitem">
							If you upgrade from OpenShift Container Platform 4.10 and earlier to 4.11, the deprecated <code class="literal">maven</code> and <code class="literal">nodejs</code> pod templates are still in the default image configuration.
						</li><li class="listitem">
							If you upgrade from OpenShift Container Platform 4.10 and earlier to 4.11, the <code class="literal">jenkins-agent-maven</code> and <code class="literal">jenkins-agent-nodejs</code> image streams still exist in your cluster. To maintain these image streams, see the following section, "What happens with the <code class="literal">jenkins-agent-maven</code> and <code class="literal">jenkins-agent-nodejs</code> image streams in the <code class="literal">openshift</code> namespace?"
						</li></ul></div><div class="formalpara"><p class="title"><strong>What changes in the support matrix of the OpenShift Jenkins image?</strong></p><p>
						Each new image in the <code class="literal">ocp-tools-4</code> repository in the <code class="literal">registry.redhat.io</code> registry supports multiple versions of OpenShift Container Platform. When Red Hat updates one of these new images, it is simultaneously available for all versions. This availability is ideal when Red Hat updates an image in response to a security advisory. Initially, this change applies to OpenShift Container Platform 4.11 and later. It is planned that this change will eventually apply to OpenShift Container Platform 4.9 and later.
					</p></div><p>
					Previously, each Jenkins image supported only one version of OpenShift Container Platform and Red Hat might update those images sequentially over time.
				</p><div class="formalpara"><p class="title"><strong>What additions are there with the OpenShift Jenkins and Jenkins Agent Base ImageStream and ImageStreamTag objects?</strong></p><p>
						By moving from an in-payload image stream to an image stream that references non-payload images, OpenShift Container Platform can define additional image stream tags. Red Hat has created a series of new image stream tags to go along with the existing <code class="literal">"value": "jenkins:2"</code> and <code class="literal">"value": "image-registry.openshift-image-registry.svc:5000/openshift/jenkins-agent-base-rhel8:latest"</code> image stream tags present in OpenShift Container Platform 4.10 and earlier. These new image stream tags address some requests to improve how the Jenkins-related image streams are maintained.
					</p></div><p>
					About the new image stream tags:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ocp-upgrade-redeploy</code></span></dt><dd>
								To update your Jenkins image when you upgrade OpenShift Container Platform, use this image stream tag in your Jenkins deployment configuration. This image stream tag corresponds to the existing <code class="literal">2</code> image stream tag of the <code class="literal">jenkins</code> image stream and the <code class="literal">latest</code> image stream tag of the <code class="literal">jenkins-agent-base-rhel8</code> image stream. It employs an image tag specific to only one SHA or image digest. When the <code class="literal">ocp-tools-4</code> image changes, such as for Jenkins security advisories, Red Hat Engineering updates the Cluster Samples Operator payload.
							</dd><dt><span class="term"><code class="literal">user-maintained-upgrade-redeploy</code></span></dt><dd>
								To manually redeploy Jenkins after you upgrade OpenShift Container Platform, use this image stream tag in your Jenkins deployment configuration. This image stream tag uses the least specific image version indicator available. When you redeploy Jenkins, run the following command: <code class="literal">$ oc import-image jenkins:user-maintained-upgrade-redeploy -n openshift</code>. When you issue this command, the OpenShift Container Platform <code class="literal">ImageStream</code> controller accesses the <code class="literal">registry.redhat.io</code> image registry and stores any updated images in the OpenShift image registry’s slot for that Jenkins <code class="literal">ImageStreamTag</code> object. Otherwise, if you do not run this command, your Jenkins deployment configuration does not trigger a redeployment.
							</dd><dt><span class="term"><code class="literal">scheduled-upgrade-redeploy</code></span></dt><dd>
								To automatically redeploy the latest version of the Jenkins image when it is released, use this image stream tag in your Jenkins deployment configuration. This image stream tag uses the periodic importing of image stream tags feature of the OpenShift Container Platform image stream controller, which checks for changes in the backing image. If the image changes, for example, due to a recent Jenkins security advisory, OpenShift Container Platform triggers a redeployment of your Jenkins deployment configuration. See "Configuring periodic importing of image stream tags" in the following "Additional resources."
							</dd></dl></div><div class="formalpara"><p class="title"><strong>What happens with the <code class="literal">jenkins-agent-maven</code> and <code class="literal">jenkins-agent-nodejs</code> image streams in the <code class="literal">openshift</code> namespace?</strong></p><p>
						The OpenShift Jenkins Maven and NodeJS Agent images for OpenShift Container Platform were deprecated in 4.10, and are removed from the OpenShift Container Platform install payload in 4.11. They do not have alternatives defined in the <code class="literal">ocp-tools-4</code> repository. However, you can work around this by using the sidecar pattern described in the "Jenkins agent" topic mentioned in the following "Additional resources" section.
					</p></div><p>
					However, the Cluster Samples Operator does not delete the <code class="literal">jenkins-agent-maven</code> and <code class="literal">jenkins-agent-nodejs</code> image streams created by prior releases, which point to the tags of the respective OpenShift Container Platform payload images on <code class="literal">registry.redhat.io</code>. Therefore, you can pull updates to these images by running the following commands:
				</p><pre class="programlisting language-terminal">$ oc import-image jenkins-agent-nodejs -n openshift</pre><pre class="programlisting language-terminal">$ oc import-image jenkins-agent-maven -n openshift</pre></section><section class="section" id="customizing-the-jenkins-image-stream-tag_important-changes-to-openshift-jenkins-images"><div class="titlepage"><div><div><h3 class="title">5.4.2. Customizing the Jenkins image stream tag</h3></div></div></div><p>
					To override the default upgrade behavior and control how the Jenkins image is upgraded, you set the image stream tag value that your Jenkins deployment configurations use.
				</p><p>
					The default upgrade behavior is the behavior that existed when the Jenkins image was part of the install payload. The image stream tag names, <code class="literal">2</code> and <code class="literal">ocp-upgrade-redeploy</code>, in the <code class="literal">jenkins-rhel.json</code> image stream file use SHA-specific image references. Therefore, when those tags are updated with a new SHA, the OpenShift Container Platform image change controller automatically redeploys the Jenkins deployment configuration from the associated templates, such as <code class="literal">jenkins-ephemeral.json</code> or <code class="literal">jenkins-persistent.json</code>.
				</p><p>
					For new deployments, to override that default value, you change the value of the <code class="literal">JENKINS_IMAGE_STREAM_TAG</code> in the <code class="literal">jenkins-ephemeral.json</code> Jenkins template. For example, replace the <code class="literal">2</code> in <code class="literal">"value": "jenkins:2"</code> with one of the following image stream tags:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">ocp-upgrade-redeploy</code>, the default value, updates your Jenkins image when you upgrade OpenShift Container Platform.
						</li><li class="listitem">
							<code class="literal">user-maintained-upgrade-redeploy</code> requires you to manually redeploy Jenkins by running <code class="literal">$ oc import-image jenkins:user-maintained-upgrade-redeploy -n openshift</code> after upgrading OpenShift Container Platform.
						</li><li class="listitem">
							<code class="literal">scheduled-upgrade-redeploy</code> periodically checks the given <code class="literal">&lt;image&gt;:&lt;tag&gt;</code> combination for changes and upgrades the image when it changes. The image change controller pulls the changed image and redeploys the Jenkins deployment configuration provisioned by the templates. For more information about this scheduled import policy, see the "Adding tags to image streams" in the following "Additional resources."
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						To override the current upgrade value for existing deployments, change the values of the environment variables that correspond to those template parameters.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You are running OpenShift Jenkins on OpenShift Container Platform 4.13.
						</li><li class="listitem">
							You know the namespace where OpenShift Jenkins is deployed.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Set the image stream tag value, replacing <code class="literal">&lt;namespace&gt;</code> with namespace where OpenShift Jenkins is deployed and <code class="literal">&lt;image_stream_tag&gt;</code> with an image stream tag:
						</p><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
								
<pre class="programlisting language-terminal">$ oc patch dc jenkins -p '{"spec":{"triggers":[{"type":"ImageChange","imageChangeParams":{"automatic":true,"containerNames":["jenkins"],"from":{"kind":"ImageStreamTag","namespace":"&lt;namespace&gt;","name":"jenkins:&lt;image_stream_tag&gt;"}}}]}}'</pre>

							</p></div><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
							Alternatively, to edit the Jenkins deployment configuration YAML, enter <code class="literal">$ oc edit dc/jenkins -n &lt;namespace&gt;</code> and update the <code class="literal">value: 'jenkins:&lt;image_stream_tag&gt;'</code> line.
						</p></div></div></li></ul></div></section><section class="section _additional-resources" id="additional-resources_important-changes-to-openshift-jenkins-images_important-changes-to-openshift-jenkins-images"><div class="titlepage"><div><div><h3 class="title">5.4.3. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#images-add-tags-to-imagestreams_tagging-images">Adding tags to image streams</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#images-imagestream-import_image-streams-managing">Configuring periodic importing of image stream tags</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#images-other-jenkins-agent">Jenkins agent</a>
						</li><li class="listitem">
							<a class="link" href="https://catalog.redhat.com/software/containers/search?q=Jenkins%202&amp;p=1">Certified <code class="literal">jenkins</code> images</a>
						</li><li class="listitem">
							<a class="link" href="https://catalog.redhat.com/software/containers/search?q=Jenkins%20Agent%20Base&amp;p=1">Certified <code class="literal">jenkins-agent-base</code> images</a>
						</li><li class="listitem">
							<a class="link" href="https://catalog.redhat.com/software/containers/search?q=jenkins-agent-maven&amp;p=1">Certified <code class="literal">jenkins-agent-maven</code> images</a>
						</li><li class="listitem">
							<a class="link" href="https://catalog.redhat.com/software/containers/search?q=jenkins-agent-nodejs&amp;p=1">Certified <code class="literal">jenkins-agent-nodejs</code> images</a>
						</li></ul></div></section></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm140458476713456"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2023 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div>


  <nav class="pvof-doc__book-nav">
  <ol class="book-nav__list">
              </ol>
</nav>


          </div>
              </div>
              <div id="comments-footer" class="book-comments">
          

  

        </div>
          </div>
  </article>
<meta itemscope="" itemref="md1">



    </div>
      <!-- CP_PRIMER_FOOTER -->            </div>
        </main>
    </div>
    <!--googleoff: all-->
    <div id="to-top"><a class="btn_slideto" href="#masthead" aria-label="Back to Top"><span class="web-icon-upload"></span></a></div>
    <footer class="footer-main">
        <div class="footer-top">
            <div class="container">

              <div class="brand">
                <a href="https://redhat.com">
                  <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                    <defs>
                      <style>
                        .rh-logo-hat {
                          fill: #e00;
                        }
                        .rh-logo-type {
                          fill: #fff;
                        }
                      </style>
                    </defs>
                    <title>Red Hat</title>
                    <path
                      class="rh-logo-hat"
                      d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
                      <path class="rh-logo-band"
                      d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
                      <path
                      class="rh-logo-type"
                      d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
                  </svg>
                </a>
              </div>

              <div role="navigation" aria-label="quick">
                  <h3>Quick Links</h3>
                  <ul>
                      <li><a class="download-software" href="https://access.redhat.com/downloads/">Downloads</a></li>
                      <li><a class="manage-subscriptions" href="https://access.redhat.com/management">Subscriptions</a></li>
                      <li><a class="support-cases" href="https://access.redhat.com/support">Support Cases</a></li>
                      <li><a class="customer-service" href="https://access.redhat.com/support/customer-service">Customer Service</a></li>
                      <li><a class="quick-docs" href="https://access.redhat.com/documentation">Product Documentation</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="help">
                  <h3>Help</h3>
                  <ul>
                      <li><a class="contact-us" href="https://access.redhat.com/support/contact/">Contact Us</a></li>
                      <li><a class="cp-faqs" href="https://access.redhat.com/articles/33844">Customer Portal FAQ</a></li>
                      <li><a class="login-problems" href="https://access.redhat.com/help/login_assistance">Log-in Assistance</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="site">
                  <h3>Site Info</h3>
                  <ul>
                      <li><a class="trust-red-hat" href="https://www.redhat.com/en/trust">Trust Red Hat</a></li>
                      <li><a class="browser-support-policy" href="https://www.redhat.com/en/about/browser-support">Browser Support Policy</a></li>
                      <li><a class="accessibility" href="https://www.redhat.com/en/about/digital-accessibility">Accessibility</a></li>
                      <li><a class="recognition" href="https://access.redhat.com/recognition/">Awards and Recognition</a></li>
                      <li><a class="colophon" href="https://access.redhat.com/help/colophon/">Colophon</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="other">
                  <h3>Related Sites</h3>
                  <ul>
                      <li><a href="https://www.redhat.com/" class="red-hat-com">redhat.com</a></li>
                      <li><a href="http://developers.redhat.com/" class="red-hat-developers">developers.redhat.com</a></li>
                      <li><a href="https://connect.redhat.com/" class="partner-connect">connect.redhat.com</a></li>
                      <li><a href="https://cloud.redhat.com/" class="cloud-com">cloud.redhat.com</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="about">
                  <h3>About</h3>
                  <ul>
                      <li><a href="https://access.redhat.com/subscription-value" class="subscription-value">Red Hat Subscription Value</a></li>
                      <li><a href="https://www.redhat.com/about/" class="about-red-hat">About Red Hat</a></li>
                      <li><a href="http://jobs.redhat.com" class="about-jobs">Red Hat Jobs</a></li>
                  </ul>
              </div>

            </div>
        </div>

        <div class="anchor">
            <div class="container">
                <div class="status-legal">
                    <a hidden href="https://status.redhat.com" class="status-page-widget">
                        <span class="status-description"></span>
                        <span class="status-dot shape-circle"></span>
                    </a>
                    <div class="legal-copyright">
                        <div class="copyright">Copyright © 2023 Red Hat, Inc.</div>
                        <div role="navigation" aria-label="legal" class="legal">
                            <ul>
                                <li><a href="http://www.redhat.com/en/about/privacy-policy" class="privacy-policy">Privacy Statement</a></li>
                                <li><a href="https://www.redhat.com/en/about/terms-use" class="terms-of-use">Terms of Use</a></li>
                                <li><a href="http://www.redhat.com/en/about/all-policies-guidelines" class="all-policies">All Policies and Guidelines</a></li>
                                <li><a id="teconsent"></a></li>
                            </ul>
                            <div id="privacy_policy">We've updated our <a href='http://www.redhat.com/en/about/privacy-policy' class='privacy-policy'>Privacy Statement</a> effective September 15, 2023.
                            </div>
                          </div>
                        </div>
                </div>
                <div class="social">
                    <a href="http://www.redhat.com/summit/" class="summit">
                        <img src="https://access.redhat.com/chrome_themes/nimbus/img/rh-summit-red-a.svg" alt="Red Hat Summit" /> <span class="offscreen">Red Hat Summit</span>
                    </a>

                    <div class="social-media">
                        <a href="https://twitter.com/RedHat" class="sm-icon twitter"><span class="nicon-twitter"></span><span class="offscreen">Twitter</span></a>                        
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- TrustArc -->
    <div id="consent_blackbar"></div> 
    <!--googleon: all-->
</div>
<!-- /CP_PRIMER_FOOTER -->


  </div>

    
  </body>
</html>
