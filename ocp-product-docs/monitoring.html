<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="og: https://ogp.me/ns#">
  <head>
    <meta charset="utf-8" />
<link rel="canonical" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/index" />
<link rel="shortlink" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/index" />
<meta property="og:site_name" content="Red Hat Customer Portal" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/index" />
<meta property="og:title" content="Monitoring OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<meta property="og:description" content="This document provides instructions for configuring and using the Prometheus monitoring stack in OpenShift Container Platform." />
<meta property="og:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="This document provides instructions for configuring and using the Prometheus monitoring stack in OpenShift Container Platform." />
<meta name="twitter:title" content="Monitoring OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<meta name="twitter:url" content="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/index" />
<meta name="twitter:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="title" content="Monitoring OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<link rel="alternate" hreflang="en" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/index" />
<link rel="alternate" hreflang="ko" href="https://access.redhat.com/documentation/ko-kr/openshift_container_platform/4.13/html-single/monitoring/index" />
<link rel="alternate" hreflang="zh-hans" href="https://access.redhat.com/documentation/zh-cn/openshift_container_platform/4.13/html-single/monitoring/index" />
<link rel="alternate" hreflang="ja" href="https://access.redhat.com/documentation/ja-jp/openshift_container_platform/4.13/html-single/monitoring/index" />
<link rel="alternate" hreflang="es" href="https://access.redhat.com/documentation/es-es/openshift_container_platform/4.13/html-single/monitoring/index" />
<link rel="alternate" hreflang="ru" href="https://access.redhat.com/documentation/ru-ru/openshift_container_platform/4.13/html-single/monitoring/index" />
<link rel="alternate" hreflang="pt-br" href="https://access.redhat.com/documentation/pt-br/openshift_container_platform/4.13/html-single/monitoring/index" />
<link rel="alternate" hreflang="it" href="https://access.redhat.com/documentation/it-it/openshift_container_platform/4.13/html-single/monitoring/index" />
<link rel="alternate" hreflang="de" href="https://access.redhat.com/documentation/de-de/openshift_container_platform/4.13/html-single/monitoring/index" />
<link rel="alternate" hreflang="fr" href="https://access.redhat.com/documentation/fr-fr/openshift_container_platform/4.13/html-single/monitoring/index" />
<link rel="alternate" hreflang="zh-hant" href="https://access.redhat.com/documentation/zh-tw/openshift_container_platform/4.13/html-single/monitoring/index" />
<link rel="alternate" hreflang="id" href="https://access.redhat.com/documentation/id-id/openshift_container_platform/4.13/html-single/monitoring/index" />
<link rel="alternate" hreflang="th" href="https://access.redhat.com/documentation/th-th/openshift_container_platform/4.13/html-single/monitoring/index" />
<link rel="alternate" hreflang="vi" href="https://access.redhat.com/documentation/vi-vn/openshift_container_platform/4.13/html-single/monitoring/index" />
<meta name="Generator" content="Drupal 9 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="revision" product="b0738f19-59ac-47eb-9512-8a439cd6dfb0" title="664fe539-4698-41ef-8d5e-1c00d2cf5d81" page="bdd84f1f-9098-479f-980d-f95d96d67745" revision="a9b2f940183f7b22b049f578bab422b40265d849:en-us" body="c8475bc2d166b9605e301084c8ee89d8.html" toc="2861497ea36cd6f9d02ae88ec63dd39f.json" />

    <title>Monitoring OpenShift Container Platform 4.13 | Red Hat Customer Portal</title>
    <link rel="stylesheet" media="all" href="/sites/dxp-docs/files/css/css_87GMcmxT1ib8ziQiU2KUAnTDFtZQV6iP-KGslA9LigM.css" />
<link rel="stylesheet" media="all" href="/sites/dxp-docs/files/css/css__Xq4GfgPDJw9K_yYJFmlRZGJeCENu3R3r4s0K7Tr_9g.css" />

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"documentation\/en-us\/openshift_container_platform\/4.13\/html-single\/monitoring\/index","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"red_hat_jwt":{"client_id":"customer-portal","cookie_name":"rh_jwt","leeway":"0","realm":"redhat-external","sso_host":"https:\/\/sso.redhat.com\/","user_integration":1,"user_plugin":"drupal_user_auth","use_external_js":0,"use_internal_js":0,"use_in_admin":0},"user":{"uid":0,"permissionsHash":"d8ea0bce2d740dacbdfe0257cf55baa0e33f7fb8468a26d055ce75daaaa2d315"}}</script>
<script src="/sites/dxp-docs/files/js/js_EQWKo9EokWkWS99x_e1oM-NEM0zlKyTkp_83mGdm5Ks.js"></script>

    <!-- CP_PRIMER_HEAD -->  <!-- TrustArc & DTM -->
  <script src="//static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>
  <script src="//www.redhat.com/dtm.js"></script><meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<!--[if IEMobile]><meta http-equiv="cleartype" content="on"><![endif]-->

<!-- metaInclude -->
<meta name="avalon-host-info" content="dxp-kbase-prod-139-77b4fb8768-25dr9" />
<meta name="avalon-version" content="27861f77" />
<meta name="cp-chrome-build-date" content="2023-10-06T19:17:59.039Z" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#000000">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#000000">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-status-bar-style" content="#000000">
<link rel="manifest" href="https://access.redhat.com/webassets/avalon/j/manifest.json">
<!-- Open Search - Tap to search -->
<link rel="search" type="application/opensearchdescription+xml" title="Red Hat Customer Portal" href="https://access.redhat.com/webassets/avalon/j/opensearch.xml" />
<!-- title -->
<title>Red Hat Customer Portal - Access to 24x7 support and knowledge</title>
<!-- /title -->
<script type="text/javascript">
    window.portal = {
        analytics : {},
        host      : "https://access.redhat.com",
        idp_url   : "https://sso.redhat.com",
        lang      : "en", 
        version   : "27861f77",
        builddate : "2023-10-06T19:17:59.039Z",        fetchdate : "2023-10-10T17:45:08-0400",        nrid      : "NOLONGERSUPPORTED",
        nrlk      : "NOLONGERSUPPORTED"
    };
</script>
<script type="text/javascript">
    if (!/\/logout.*/.test(location.pathname) && portal.host === location.origin && document.cookie.indexOf('rh_sso_session') >= 0 && !(document.cookie.indexOf('rh_jwt') >= 0)) window.location = '/login?redirectTo=' + encodeURIComponent(window.location.href);
</script>
<!-- cssInclude -->

<link rel="shortcut icon" href="https://access.redhat.com/webassets/avalon/g/favicon.ico" /><link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/bootstrap.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/bootstrap-grid.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/main.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/components.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/pages.css?v=27861f77" />

<link href="https://access.redhat.com/webassets/avalon/s/chosen.css?v=27861f77" rel="stylesheet" type="text/css" />

<!--[if lte IE 9]>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/ie.css" />
<![endif]--><noscript>
    <style type="text/css" media="screen"> .primary-nav { display: block; } </style>
</noscript>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/webassets/avalon/j/public_modules/node_modules/@cpelements/pfe-navigation/dist/pfe-navigation--lightdom.min.css" />
<!-- /cssInclude -->
<script src="https://access.redhat.com/webassets/avalon/j/public_modules/node_modules/@cpelements/pfe-navigation/dist/ie-polyfills.js?v=27861f77"></script>

<script async>
  if (!HTMLScriptElement.supports || !HTMLScriptElement.supports('importmap')) {
    import("https://www.redhatstatic.com/dx/v1-alpha/es-module-shims@1.7.3.js");
  }
</script>
<script type="importmap">
{
  "imports": {
    "@patternfly/elements/" : "https://www.redhatstatic.com/dx/v1-alpha/@patternfly/elements@2.2.2/",
    "@rhds/elements/":"https://www.redhatstatic.com/dx/v1-alpha/@rhds/elements@1.1.0/elements/",
    "@rhds/elements/lib/":"https://www.redhatstatic.com/dx/v1-alpha/@rhds/elements@1.1.0/lib/",
    "@cpelements/elements/":"https://www.redhatstatic.com/dx/v1-alpha/@cpelements/elements@2.0.0-alpha.7/elements/"
  }
}
</script><script type="text/javascript" src="https://access.redhat.com/webassets/avalon/j/lib/require.js?v=27861f77" data-main="/webassets/avalon/j/"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<script src="https://access.redhat.com/chrome_themes/nimbus/js/ie8.js"></script>
<![endif]-->
<script type="text/javascript" src="https://access.redhat.com/chrome_themes/nimbus/js/new-nav.js?v=27861f77" ></script>
<!-- /CP_PRIMER_HEAD -->

  </head>
  <body>
    
      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
      <!-- CP_PRIMER_HEADER -->
<div id="page-wrap" class="page-wrap">
    <div id="pers-top-page-wrap" class="top-page-wrap pers-loader-bg">

      <div id="hero-bg-top-left" class="summit-bg-shapes"></div>
      <div id="hero-bg-top-right" class="summit-bg-shapes"></div>

        <!--googleoff: all-->
        <header class="masthead" id="masthead">

            <a href="#pfe-navigation" id="global-skip-to-nav" class="skip-link visually-hidden">Skip to navigation</a>
            <a href="#cp-main" class="skip-link visually-hidden">Skip to main content</a>            <nav id="portal-utility-nav" class="utility-navigation utility-navigation--bar hidden-at-mobile" data-analytics-region="utility" aria-labelledby="nav__utility-nav--desktop">
                <h3 id="nav__utility-nav--desktop" class="element-invisible">Utilities
                </h3>
                <ul aria-labelledby="nav__utility-nav--desktop">
                    <li id="nav-subscription" data-portal-tour-1="1">
                        <a class="top-nav-subscriptions" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Subscription" href="https://access.redhat.com/management/" >Subscriptions
                        </a>
                    </li>
                    <li id="nav-downloads" data-portal-tour-1="2">
                        <a class="top-nav-downloads" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Downloads" href="https://access.redhat.com/downloads/" >Downloads
                        </a>
                    </li>
                    <li id="nav-containers">
                        <a class="top-nav-containers" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Containers" href="https://catalog.redhat.com/software/containers/explore/" >Containers
                        </a>
                    </li>
                    <li id="nav-support" data-portal-tour-1="3">
                        <a class="top-nav-support-cases" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Support Cases" href="https://access.redhat.com/support/cases/" >Support Cases
                        </a>
                    </li>
                </ul>
            </nav>

            <pfe-navigation id="pfe-navigation" data-analytics-region="mega menu">
                <div class="pfe-navigation__logo-wrapper" id="pfe-navigation__logo-wrapper">
                    <a href="https://access.redhat.com/" class="pfe-navigation__logo-link" data-analytics-text="logo" data-analytics-category="MM|logo">
                        <img class="pfe-navigation__logo-image" alt="Red Hat Customer Portal" src="https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg" />
                    </a>
                </div>

                <nav class="pfe-navigation" aria-label="Main Navigation" data-analytics-region="main nav">
                    <ul class="pfe-navigation__menu" id="pfe-navigation__menu">                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-subscription--mobile" data-portal-tour-1="1">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Subscription" href="https://access.redhat.com/management/" >Subscriptions
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-downloads--mobile" data-portal-tour-1="2">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Downloads" href="https://access.redhat.com/downloads/" >Downloads
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-containers--mobile">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Containers" href="https://catalog.redhat.com/software/containers/explore/" >Containers
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-support--mobile" data-portal-tour-1="3">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Support Cases" href="https://access.redhat.com/support/cases/" >Support Cases
                            </a>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a href="https://access.redhat.com/products/" class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Products and Services">Products &amp; Services
                            </a>
                            <div class="pfe-navigation__dropdown has-primary-detail">                                <div class="desktop-col-span-2 tablet-col-span-all">
                                    <h3>
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Products" href="https://access.redhat.com/products/">Products
                                        </a>
                                    </h3>
                                    <slot name="main-menu__dropdown--product__product-listing"></slot>
                                </div>                                <div>
                                    <h3 id="nav__products__support">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Support" href="https://access.redhat.com/support">Support
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__support">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Production Support" href="https://access.redhat.com/support/offerings/production/">Production Support
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Development Support" href="https://access.redhat.com/support/offerings/developer/">Development Support
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Product Life Cycles" href="https://access.redhat.com/product-life-cycles/">Product Life Cycles
                                                    </a></li>
                                    </ul>

                                    <h3 id="nav__products__services">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Services" href="https://www.redhat.com/en/services">Services
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__services">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Consulting" href="https://www.redhat.com/en/services/consulting">Consulting
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Technical Account Management" href="https://access.redhat.com/support/offerings/tam/">Technical Account Management
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Training and Certifications" href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications
                                                    </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__products__documentation">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Documentation" href="https://access.redhat.com/documentation">Documentation
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__documentation">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat Enterprise Linux" href="https://access.redhat.com/documentation/en/red_hat_enterprise_linux">Red Hat Enterprise Linux
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat JBoss Enterprise Application Platform" href="https://access.redhat.com/documentation/en/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat OpenStack Platform" href="https://access.redhat.com/documentation/en/red_hat_openstack_platform">Red Hat OpenStack Platform
                                                    </a></li>
                                                    <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat OpenShift Container Platform" href="https://access.redhat.com/documentation/en/openshift_container_platform">Red Hat OpenShift Container Platform
                                                        </a></li>
                                    </ul>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="All Documentation" data-analytics-linkType="cta" href="https://access.redhat.com/documentation">All Documentation
                                        </a>
                                    </pfe-cta>

                                    <h3 id="nav__products__catalog"><a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Ecosystem Catalog" href="https://catalog.redhat.com/">Ecosystem Catalog
                                        </a></h3>
                                        <ul aria-labelledby="nav__products__catalog">
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Ecosystem Catalog" data-analytics-text="Red Hat Partner Ecosystem" href="https://access.redhat.com/ecosystem/">Red Hat Partner Ecosystem
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Ecosystem Catalog" data-analytics-text="Partner Resources" href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources
                                                    </a></li>
                                        </ul>
                                </div>
                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Tools" href="https://access.redhat.com/labs/">Tools
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="nav__tools__tools" data-analytics-level="2" data-analytics-text="Tools" data-analytics-category="Tools">Tools
                                    </h3>
                                    <ul aria-labelledby="nav__tools__tools">
                                        <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Solution Engine" href="https://access.redhat.com/support/cases/#/troubleshoot">Troubleshoot a product issue
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Packages" href="https://access.redhat.com/downloads/content/package-browser">Packages
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Errata" href="https://access.redhat.com/errata/">Errata
                                                    </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__tools__labs">
                                        <a data-analytics-level="2" data-analytics-category="Tools" data-analytics-text="Customer Portal Labs" href="https://access.redhat.com/labs/">Customer Portal Labs
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__tools__labs">
                                        <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Configuration" href="https://access.redhat.com/labs/#!?type=config">Configuration
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Deployment" href="https://access.redhat.com/labs/#!?type=deploy">Deployment
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Security" href="https://access.redhat.com/labs/#!?type=security">Security
                                                    </a></li>                                                    <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Troubleshooting" href="https://access.redhat.com/labs/#!?type=troubleshoot">Troubleshoot
                                                        </a></li>
                                    </ul>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="All Labs" data-analytics-linkType="cta" href="https://access.redhat.com/labs/">All labs
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h4 id="nav__tools__red-hat-insights">
                                        <a data-analytics-level="2" data-analytics-category="Tools" data-analytics-text="Red Hat Insights" href="//www.redhat.com/en/technologies/management/insights">Red Hat Insights
                                        </a>
                                    </h4>
                                    <p>Increase visibility into IT operations to detect and resolve technical issues before they impact your business.</p>
                                    <a data-analytics-level="3" data-analytics-category="Tools|Red Hat Insights" data-analytics-text="Learn more" href="https://www.redhat.com/en/technologies/management/insights">Learn More
                                    </a>
                                    <br>
                                    <a data-analytics-level="3" data-analytics-category="Tools|Red Hat Insights" data-analytics-text="Go to Insights" href="https://cloud.redhat.com/insights">Go to Insights
                                    </a>
                                </div>
                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Security" href="https://access.redhat.com/security/">Security
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="security__security-center">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Red Hat Product Security Center" href="https://access.redhat.com/security">Red Hat Product Security Center
                                        </a>
                                    </h3>
                                    <p>Engage with our Red Hat Product Security team, access security updates, and ensure your environments are not exposed to any known security vulnerabilities.
                                    </p>
                                    <pfe-cta pfe-priority="primary">
                                        <a data-analytics-level="3" data-analytics-category="Security|Red Hat Product Security Center" data-analytics-text="Product Security Center" data-analytics-linkType="cta" href="https://access.redhat.com/security/">Product Security Center
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__security__updates" data-analytics-level="2" data-analytics-text="Security Updates" data-analytics-category="Security">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Security Updates" href="/security">Security Updates
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__security__updates">
                                        <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Security Advisories" href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Red Hat CVE Database" href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Security Labs" href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs
                                                    </a></li>
                                    </ul>
                                    <p class="margin-top-xl">Keep your systems secure with Red Hat&#039;s specialized responses to security vulnerabilities.
                                    </p>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="View Responses" data-analytics-linkType="cta" href="https://access.redhat.com/security/vulnerability">View Responses
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__security__resources">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Resources" href="https://access.redhat.com/security/overview">Resources
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__security__resources">                                            <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Security Blog" href="//redhat.com/en/blog/channel/security">Security Blog
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Security Measurement" href="https://www.redhat.com/security/data/metrics/">Security Measurement
                                                    </a></li>
                                                    <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Severity Ratings" href="https://access.redhat.com/security/updates/classification/">Severity Ratings
                                                        </a></li>
                                                        <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Backporting Policies" href="https://access.redhat.com/security/updates/backporting/">Backporting Policies
                                                            </a></li>
                                                            <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Product Signing (GPG) Keys" href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys
                                                                </a></li>
                                    </ul>
                                </div>

                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a href="https://access.redhat.com/community/" class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Community">Community
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="nav__community__cp-community">
                                        <a href="https://access.redhat.com/community" data-analytics-level="2" data-analytics-text="Customer Portal Community" data-analytics-text="Customer Portal Community" data-analytics-category="Community">Customer Portal Community
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__community__cp-community">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Discussions" href="https://access.redhat.com/discussions">Discussions
                                            </a></li>                                                <li><a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Private Groups" href="https://access.redhat.com/groups/">Private Groups
                                                    </a></li>
                                    </ul>

                                    <pfe-cta pfe-priority="primary">
                                        <a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Community Activity" data-analytics-linkType="cta" href="https://access.redhat.com/community/">Community Activity
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__community__events" data-analytics-level="2" data-analytics-text="Customer Events" data-analytics-category="Community">Customer Events
                                    </h3>
                                    <ul aria-labelledby="nav__community__events">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Customer Events" data-analytics-text="Red Hat Convergence" href="https://access.redhat.com/convergence/">Red Hat Convergence
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Community|Customer Events" data-analytics-text="Red Hat Summit" href="http://www.redhat.com/summit/">Red Hat Summit
                                                </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__community__stories" data-analytics-level="2" data-analytics-text="Stories" data-analytics-category="Community">Stories
                                    </h3>
                                    <ul aria-labelledby="nav__community__stories">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Stories" data-analytics-text="Red Hat Subscription Value" href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-text="You Asked. We Acted." data-analytics-category="Community|Stories" href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Community|Stories" data-analytics-text="Open Source Communities" href="http://www.redhat.com/en/open-source">Open Source Communities
                                                    </a></li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                    </ul>                </nav>                <div id="site-search" slot="search" class="utility-link site-search">
                    <div class="content">
                        <form class="ng-pristine ng-valid topSearchForm" id="topSearchForm" name="topSearchForm" action="/search/browse/search/" method="get" enctype="application/x-www-form-urlencoded">
                            <cp-search-autocomplete class="push-bottom" path="/webassets/avalon/j/data.json"></cp-search-autocomplete>                            <div>Or <a href="/support/cases/#/troubleshoot">troubleshoot an issue</a>.
                            </div>
                        </form>
                    </div>
                </div>


                <div slot="secondary-links" id="localesMenu">
                    <button class="pfe-navigation__secondary-link">
                        <pfe-icon icon="web-icon-globe" size="sm" aria-hidden="true"></pfe-icon>English
                    </button>

                    <pfe-navigation-dropdown dropdown-width="single">
                        <h2 class="utility-header">Select Your Language
                        </h2>
                        <ul class="reset">
                            <li><a href="https://access.redhat.com/changeLanguage?language=en" data-lang="en" id="en" data-analytics-text="English">English</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=ko" data-lang="ko" id="ko" data-analytics-text="Korean">한국어</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=ja"    data-lang="ja"    id="ja" data-analytics-text="Japanese">日本語</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" data-lang="zh_CN" id="zh_CN" data-analytics-text="Chinese">中文 (中国)</a></li>
                        </ul>

                    </pfe-navigation-dropdown>
                </div>                <rh-account-dropdown slot="account"></rh-account-dropdown>                <pfe-primary-detail breakpoint-width="600" class="main-menu__dropdown--product__product-listing" slot="main-menu__dropdown--product__product-listing" consistent-height>
                    <h3 slot="details-nav">Infrastructure and Management                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Enterprise Linux" href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Satellite" href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Subscription Management" href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Insights" href="https://access.redhat.com/products/red-hat-insights/">Red Hat Insights
                                </a>
                            </li>
                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Ansible Automation Platform" href="https://access.redhat.com/products/red-hat-ansible-automation-platform/">Red Hat Ansible Automation Platform
                                </a></li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Cloud Computing                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift" href="https://access.redhat.com/products/openshift">Red Hat OpenShift
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenStack Platform" href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat OpenShift Container Platform" href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat OpenShift Data Science" href="https://access.redhat.com/products/red-hat-openshift-data-science/">Red Hat OpenShift Data Science
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift Dedicated" href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat Advanced Cluster Security for Kubernetes" href="https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/">Red Hat Advanced Cluster Security for Kubernetes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat Advanced Cluster Management for Kubernetes" href="https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/">Red Hat Advanced Cluster Management for Kubernetes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat Quay" href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat CodeReady Workspaces" href="https://access.redhat.com/products/red-hat-codeready-workspaces/">OpenShift Dev Spaces
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift Service on AWS" href="https://access.redhat.com/products/red-hat-openshift-service-aws">Red Hat OpenShift Service on AWS
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Storage                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Gluster Storage" href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Hyperconverged Infrastructure" href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Ceph Storage" href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Openshift Container Storage" href="https://access.redhat.com/products/red-hat-openshift-data-foundation">Red Hat OpenShift Data Foundation
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Runtimes                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Runtimes" href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat JBoss Enterprise Application Platform" href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Data Grid" href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat JBoss Web Server" href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Single Sign On" href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat support for Spring Boot" href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat build of Node.js" href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js
                                </a>
                            </li>                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat build of Quarkus" href="https://access.redhat.com/products/quarkus/">Red Hat build of Quarkus
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Integration and Automation                    </h3>
                    <div slot="details">
                        <ul class="border-bottom" id="portal-menu-border-bottom">
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat Application Foundations" href="https://access.redhat.com/products/red-hat-application-foundations/">Red Hat Application Foundations
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat Fuse" href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat AMQ" href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat 3scale API Management" href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div slot="details-nav--footer">
                        <pfe-cta pfe-priority="primary">
                            <a href="https://access.redhat.com/products/" class="pfe-navigation__menu-link" data-analytics-level="2" data-analytics-text="All Products" data-analytics-category="Products and Services|Products:" data-analytics-linkType="cta">All Products
                            </a>
                        </pfe-cta>
                    </div>
                </pfe-primary-detail>

            </pfe-navigation>

            <div id="scroll-anchor"></div>

            <!--[if IE 8]>
                <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                <span class="icon-warning alert-icon" aria-hidden="true"></span>
                You are using an unsupported web browser. Update to a supported browser for the best experience. <a href="/announcements/2120951">Read the announcement</a>.
                </div>
                </div>
            <![endif]-->
            <!--[if IE 9]>
                <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                <span class="icon-warning alert-icon" aria-hidden="true"></span>As of March 1, 2016, the Red Hat Customer Portal will no longer support Internet Explorer 9. See our new <a href="/help/browsers">browser support policy</a> for more information.
                </div>
                </div>
            <![endif]-->
            <div id="site-section"></div>
        </header>
        <!--googleon: all-->

        <main id="cp-main" class="portal-content-area">
            <div id="cp-content" class="main-content">                            <!-- /CP_PRIMER_HEADER -->

      <div class="container">
        

                                                                                                        <script>breadcrumbs = [["Products & Services","\/products\/"],["Product Documentation","\/documentation"],["OpenShift Container Platform","\/documentation\/en-us\/openshift_container_platform"],["4.13","\/documentation\/en-us\/openshift_container_platform\/4.13"],["Monitoring","\/documentation\/en-us\/openshift_container_platform\/4.13\/html\/monitoring"],["Monitoring","\/documentation\/en-us\/openshift_container_platform\/4.13\/html\/monitoring\/--single-page-document--"]]</script>

<div data-drupal-messages-fallback class="hidden"></div>


    </div>
        <div class="container">
        

  

  


  <article class="pvof-doc__content-wrapper__outer pvof-doc__content-wrapper__outer--css-not-removed">
    <script>
      'use strict';

            var $outerWrapper = document.querySelector('.pvof-doc__content-wrapper__outer');
      if ($outerWrapper && $outerWrapper.closest) {
        var $containerWrapper = $outerWrapper.closest('.container');
        if ($containerWrapper) {
          $containerWrapper.classList.remove('container');
          $containerWrapper.classList.add('j-chrome-content-container');
        }
      }

            var cssRemoved = false;
      try {
        var $crapCss = document.querySelectorAll(
          'link[href*="/chrome_themes/nimbus/css/pages.css"], link[href*="/chrome_themes/nimbus/css/components.css"]'
        );
        if ($crapCss.length) {
          for (let index = 0; index < $crapCss.length; index++) {
            const $stylesheet = $crapCss[index];
            $stylesheet.remove();
          }
        }
        cssRemoved = true;
      }
      catch (error) {
        console.error('Ran into an issue while trying to retheme page', error);
        cssRemoved = false;
      }

            if (cssRemoved) {
        var $pvofOuterWrapper = document.querySelector('.pvof-doc__content-wrapper__outer--css-not-removed');
        if ($pvofOuterWrapper) {
          $pvofOuterWrapper.classList.remove('pvof-doc__content-wrapper__outer--css-not-removed');
        }
      }
    </script>
    <div itemscope="" itemtype="https://schema.org/TechArticle" itemref="techArticle-md1 techArticle-md2 techArticle-md3"></div>
    <div itemscope="" itemtype="https://schema.org/SoftwareApplication" itemref="softwareApplication-md1 softwareApplication-md2 softwareApplication-md3 softwareApplication-md4"></div>
    <div class="pvof-doc__content-wrapper pvof-doc__content-wrapper--has-sidebar">
                                <div class="pvof-doc__content-wrapper__inner j-superdoc j-superdoc--has-nav">
                            <div class="pvof-sidebar__wrapper j-doc-nav j-superdoc__nav">
            <div class="j-sidebar__menu-container">
              <button class="j-sidebar__menu-trigger content-expander__trigger">
                <span class="j-sidebar__menu-trigger__open-text">Jump To</span>
                <span class="j-sidebar__menu-trigger__close-text">Close</span>
              </button>

              <div class="pvof-sidebar__inner-wrapper j-doc-nav__wrapper content-expander">
                <div class="j-sidebar__menu-details-container">
                  <button class="j-sidebar__menu-details-button j-sidebar__menu-details-button--expand">
                    Expand all
                  </button>
                  <button class="j-sidebar__menu-details-button j-sidebar__menu-details-button--collapse">
                    Collapse all
                  </button>
                </div>
                

  <nav id="pvof-doc__toc" class="pvof-doc__toc">
  <h2 class="j-doc-nav__title" id="j-doc-nav__title">
    Table of contents
  </h2>
  <div class="pvof-doc__toc-inner">
              <ol class="j-doc-nav__list" aria-labelledby="j-doc-nav__title">
                  <li class="j-doc-nav__list-item">
                                    

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring" class="j-doc-nav__link ">
    Monitoring
  </a>
  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#monitoring-overview" class="j-doc-nav__link j-doc-nav__link--has-children">
    1. Monitoring overview
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1. Monitoring overview"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1. Monitoring overview"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#about-openshift-monitoring" class="j-doc-nav__link ">
    1.1. About OpenShift Container Platform monitoring
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#understanding-the-monitoring-stack_monitoring-overview" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2. Understanding the monitoring stack
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2. Understanding the monitoring stack"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2. Understanding the monitoring stack"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#default-monitoring-components_monitoring-overview" class="j-doc-nav__link ">
    1.2.1. Default monitoring components
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#default-monitoring-targets_monitoring-overview" class="j-doc-nav__link ">
    1.2.2. Default monitoring targets
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#components-for-monitoring-user-defined-projects_monitoring-overview" class="j-doc-nav__link ">
    1.2.3. Components for monitoring user-defined projects
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#monitoring-targets-for-user-defined-projects_monitoring-overview" class="j-doc-nav__link ">
    1.2.4. Monitoring targets for user-defined projects
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#openshift-monitoring-common-terms_monitoring-overview" class="j-doc-nav__link ">
    1.3. Glossary of common terms for OpenShift Container Platform monitoring
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#additional-resources_monitoring-overview" class="j-doc-nav__link ">
    1.4. Additional resources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#next-steps_monitoring-overview" class="j-doc-nav__link ">
    1.5. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#configuring-the-monitoring-stack" class="j-doc-nav__link j-doc-nav__link--has-children">
    2. Configuring the monitoring stack
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2. Configuring the monitoring stack"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2. Configuring the monitoring stack"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#prerequisites" class="j-doc-nav__link ">
    2.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#maintenance-and-support_configuring-the-monitoring-stack" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.2. Maintenance and support for monitoring
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.2. Maintenance and support for monitoring"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.2. Maintenance and support for monitoring"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#support-considerations_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.2.1. Support considerations for monitoring
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#unmanaged-monitoring-operators_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.2.2. Support policy for monitoring Operators
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#preparing-to-configure-the-monitoring-stack" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.3. Preparing to configure the monitoring stack
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.3. Preparing to configure the monitoring stack"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.3. Preparing to configure the monitoring stack"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#creating-cluster-monitoring-configmap_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.3.1. Creating a cluster monitoring config map
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#creating-user-defined-workload-monitoring-configmap_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.3.2. Creating a user-defined workload monitoring config map
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#configuring-the-monitoring-stack_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.4. Configuring the monitoring stack
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#configurable-monitoring-components_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.5. Configurable monitoring components
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#using-node-selectors-to-move-monitoring-components_configuring-the-monitoring-stack" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.6. Using node selectors to move monitoring components
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.6. Using node selectors to move monitoring components"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.6. Using node selectors to move monitoring components"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#how-node-selectors-work-with-other-constraints_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.6.1. How node selectors work with other constraints
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#moving-monitoring-components-to-different-nodes_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.6.2. Moving monitoring components to different nodes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#assigning-tolerations-to-monitoring-components_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.7. Assigning tolerations to monitoring components
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#setting-the-body-size-limit-for-metrics-scraping_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.8. Setting the body size limit for metrics scraping
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#configuring-a-dedicated-service-monitor_configuring-the-monitoring-stack" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.9. Configuring a dedicated service monitor
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.9. Configuring a dedicated service monitor"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.9. Configuring a dedicated service monitor"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#enabling-a-dedicated-service-monitor_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.9.1. Enabling a dedicated service monitor
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#configuring_persistent_storage_configuring-the-monitoring-stack" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.10. Configuring persistent storage
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.10. Configuring persistent storage"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.10. Configuring persistent storage"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#persistent-storage-prerequisites" class="j-doc-nav__link ">
    2.10.1. Persistent storage prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#configuring-a-local-persistent-volume-claim_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.10.2. Configuring a local persistent volume claim
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#resizing-a-persistent-storage-volume_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.10.3. Resizing a persistent storage volume
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#modifying-retention-time-and-size-for-prometheus-metrics-data_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.10.4. Modifying the retention time and size for Prometheus metrics data
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#modifying-the-retention-time-for-thanos-ruler-metrics-data_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.10.5. Modifying the retention time for Thanos Ruler metrics data
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#configuring_remote_write_storage_configuring-the-monitoring-stack" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.11. Configuring remote write storage
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.11. Configuring remote write storage"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.11. Configuring remote write storage"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#supported_remote_write_authentication_settings_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.11.1. Supported remote write authentication settings
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#example-remote-write-authentication-settings_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.11.2. Example remote write authentication settings
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#adding-cluster-id-labels-to-metrics_configuring-the-monitoring-stack" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.12. Adding cluster ID labels to metrics
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.12. Adding cluster ID labels to metrics"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.12. Adding cluster ID labels to metrics"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#creating-cluster-id-labels-for-metrics_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.12.1. Creating cluster ID labels for metrics
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#configuring-metrics-collection-profiles_configuring-the-monitoring-stack" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.13. Configuring metrics collection profiles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.13. Configuring metrics collection profiles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.13. Configuring metrics collection profiles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#about-metrics-collection-profiles_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.13.1. About metrics collection profiles
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#choosing-a-metrics-collection-profile_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.13.2. Choosing a metrics collection profile
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#controlling-the-impact-of-unbound-attributes-in-user-defined-projects_configuring-the-monitoring-stack" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.14. Controlling the impact of unbound metrics attributes in user-defined projects
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.14. Controlling the impact of unbound metrics attributes in user-defined projects"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.14. Controlling the impact of unbound metrics attributes in user-defined projects"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#setting-scrape-sample-and-label-limits-for-user-defined-projects_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.14.1. Setting scrape sample and label limits for user-defined projects
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#creating-scrape-sample-alerts_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    2.14.2. Creating scrape sample alerts
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                    

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#monitoring-configuring-external-alertmanagers_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    3. Configuring external Alertmanager instances
  </a>
  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#monitoring-configuring-secrets-for-alertmanager_configuring-the-monitoring-stack" class="j-doc-nav__link j-doc-nav__link--has-children">
    4. Configuring secrets for Alertmanager
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4. Configuring secrets for Alertmanager"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4. Configuring secrets for Alertmanager"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#monitoring-adding-a-secret-to-the-alertmanager-configuration_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    4.1. Adding a secret to the Alertmanager configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#attaching-additional-labels-to-your-time-series-and-alerts_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    4.2. Attaching additional labels to your time series and alerts
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#configuring_pod_topology_spread_constraintsfor_monitoring_configuring-the-monitoring-stack" class="j-doc-nav__link j-doc-nav__link--has-children">
    5. Configuring pod topology spread constraints for monitoring
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5. Configuring pod topology spread constraints for monitoring"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5. Configuring pod topology spread constraints for monitoring"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#setting-up-pod-topology-spread-constraints-for-prometheus_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    5.1. Setting up pod topology spread constraints for Prometheus
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#setting-up-pod-topology-spread-constraints-for-alertmanager_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    5.2. Setting up pod topology spread constraints for Alertmanager
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#setting-up-pod-topology-spread-constraints-for-thanos-ruler_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    5.3. Setting up pod topology spread constraints for Thanos Ruler
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#setting-log-levels-for-monitoring-components_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    5.4. Setting log levels for monitoring components
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#setting-query-log-file-for-prometheus_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    5.5. Enabling the query log file for Prometheus
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#enabling-query-logging-for-thanos-querier_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    5.6. Enabling query logging for Thanos Querier
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#setting-audit-log-levels-for-the-prometheus-adapter_configuring-the-monitoring-stack" class="j-doc-nav__link j-doc-nav__link--has-children">
    6. Setting audit log levels for the Prometheus Adapter
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6. Setting audit log levels for the Prometheus Adapter"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6. Setting audit log levels for the Prometheus Adapter"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#monitoring-disabling-the-local-alertmanager_configuring-the-monitoring-stack" class="j-doc-nav__link ">
    6.1. Disabling the local Alertmanager
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#next-steps" class="j-doc-nav__link ">
    6.2. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#enabling-monitoring-for-user-defined-projects" class="j-doc-nav__link j-doc-nav__link--has-children">
    7. Enabling monitoring for user-defined projects
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7. Enabling monitoring for user-defined projects"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7. Enabling monitoring for user-defined projects"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#enabling-monitoring-for-user-defined-projects_enabling-monitoring-for-user-defined-projects" class="j-doc-nav__link ">
    7.1. Enabling monitoring for user-defined projects
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#granting-users-permission-to-monitor-user-defined-projects_enabling-monitoring-for-user-defined-projects" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.2. Granting users permission to monitor user-defined projects
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.2. Granting users permission to monitor user-defined projects"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.2. Granting users permission to monitor user-defined projects"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#granting-user-permissions-using-the-web-console_enabling-monitoring-for-user-defined-projects" class="j-doc-nav__link ">
    7.2.1. Granting user permissions by using the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#granting-user-permissions-using-the-cli_enabling-monitoring-for-user-defined-projects" class="j-doc-nav__link ">
    7.2.2. Granting user permissions by using the CLI
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#granting-users-permission-to-configure-monitoring-for-user-defined-projects_enabling-monitoring-for-user-defined-projects" class="j-doc-nav__link ">
    7.3. Granting users permission to configure monitoring for user-defined projects
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#accessing-metrics-from-outside-cluster_enabling-monitoring-for-user-defined-projects" class="j-doc-nav__link ">
    7.4. Accessing metrics from outside the cluster for custom applications
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#excluding-a-user-defined-project-from-monitoring_enabling-monitoring-for-user-defined-projects" class="j-doc-nav__link ">
    7.5. Excluding a user-defined project from monitoring
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#disabling-monitoring-for-user-defined-projects_enabling-monitoring-for-user-defined-projects" class="j-doc-nav__link ">
    7.6. Disabling monitoring for user-defined projects
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#next-steps-2" class="j-doc-nav__link ">
    7.7. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#enabling-alert-routing-for-user-defined-projects" class="j-doc-nav__link j-doc-nav__link--has-children">
    8. Enabling alert routing for user-defined projects
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8. Enabling alert routing for user-defined projects"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8. Enabling alert routing for user-defined projects"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#understanding-alert-routing-for-user-defined-projects_enabling-alert-routing-for-user-defined-projects" class="j-doc-nav__link ">
    8.1. Understanding alert routing for user-defined projects
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#enabling-the-platform-alertmanager-instance-for-user-defined-alert-routing_enabling-alert-routing-for-user-defined-projects" class="j-doc-nav__link ">
    8.2. Enabling the platform Alertmanager instance for user-defined alert routing
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#enabling-a-separate-alertmanager-instance-for-user-defined-alert-routing_enabling-alert-routing-for-user-defined-projects" class="j-doc-nav__link ">
    8.3. Enabling a separate Alertmanager instance for user-defined alert routing
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#granting-users-permission-to-configure-alert-routing-for-user-defined-projects_enabling-alert-routing-for-user-defined-projects" class="j-doc-nav__link ">
    8.4. Granting users permission to configure alert routing for user-defined projects
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#next-steps-3" class="j-doc-nav__link ">
    8.5. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#managing-metrics" class="j-doc-nav__link j-doc-nav__link--has-children">
    9. Managing metrics
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "9. Managing metrics"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "9. Managing metrics"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#understanding-metrics_managing-metrics" class="j-doc-nav__link ">
    9.1. Understanding metrics
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#setting-up-metrics-collection-for-user-defined-projects_managing-metrics" class="j-doc-nav__link j-doc-nav__link--has-children">
    9.2. Setting up metrics collection for user-defined projects
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "9.2. Setting up metrics collection for user-defined projects"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "9.2. Setting up metrics collection for user-defined projects"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#deploying-a-sample-service_managing-metrics" class="j-doc-nav__link ">
    9.2.1. Deploying a sample service
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#specifying-how-a-service-is-monitored_managing-metrics" class="j-doc-nav__link ">
    9.2.2. Specifying how a service is monitored
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#viewing-a-list-of-available-metrics_managing-metrics" class="j-doc-nav__link ">
    9.3. Viewing a list of available metrics
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#about-querying-metrics_managing-metrics" class="j-doc-nav__link j-doc-nav__link--has-children">
    9.4. Querying metrics
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "9.4. Querying metrics"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "9.4. Querying metrics"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#querying-metrics-for-all-projects-as-an-administrator_managing-metrics" class="j-doc-nav__link ">
    9.4.1. Querying metrics for all projects as a cluster administrator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#querying-metrics-for-user-defined-projects-as-a-developer_managing-metrics" class="j-doc-nav__link ">
    9.4.2. Querying metrics for user-defined projects as a developer
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#getting-detailed-information-about-a-target_managing-metrics" class="j-doc-nav__link ">
    9.5. Getting detailed information about a metrics target
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#managing-alerts" class="j-doc-nav__link j-doc-nav__link--has-children">
    10. Managing alerts
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "10. Managing alerts"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "10. Managing alerts"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#accessing_the_alerting_ui_managing-alerts" class="j-doc-nav__link ">
    10.1. Accessing the Alerting UI in the Administrator and Developer perspectives
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#searching-alerts-silences-and-alerting-rules_managing-alerts" class="j-doc-nav__link ">
    10.2. Searching and filtering alerts, silences, and alerting rules
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#getting-information-about-alerts-silences-and-alerting-rules_managing-alerts" class="j-doc-nav__link ">
    10.3. Getting information about alerts, silences, and alerting rules
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#managing-silences_managing-alerts" class="j-doc-nav__link j-doc-nav__link--has-children">
    10.4. Managing silences
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "10.4. Managing silences"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "10.4. Managing silences"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#silencing-alerts_managing-alerts" class="j-doc-nav__link ">
    10.4.1. Silencing alerts
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#editing-silences_managing-alerts" class="j-doc-nav__link ">
    10.4.2. Editing silences
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#expiring-silences_managing-alerts" class="j-doc-nav__link ">
    10.4.3. Expiring silences
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#managing-alerting-rules-for-user-defined-projects_managing-alerts" class="j-doc-nav__link j-doc-nav__link--has-children">
    10.5. Managing alerting rules for user-defined projects
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "10.5. Managing alerting rules for user-defined projects"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "10.5. Managing alerting rules for user-defined projects"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#Optimizing-alerting-for-user-defined-projects_managing-alerts" class="j-doc-nav__link ">
    10.5.1. Optimizing alerting for user-defined projects
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#creating-alerting-rules-for-user-defined-projects_managing-alerts" class="j-doc-nav__link ">
    10.5.2. Creating alerting rules for user-defined projects
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#reducing-latency-for-alerting-rules-that-do-not-query-platform-metrics_managing-alerts" class="j-doc-nav__link ">
    10.5.3. Reducing latency for alerting rules that do not query platform metrics
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#accessing-alerting-rules-for-your-project_managing-alerts" class="j-doc-nav__link ">
    10.5.4. Accessing alerting rules for user-defined projects
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#listing-alerting-rules-for-all-projects-in-a-single-view_managing-alerts" class="j-doc-nav__link ">
    10.5.5. Listing alerting rules for all projects in a single view
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#removing-alerting-rules-for-user-defined-projects_managing-alerts" class="j-doc-nav__link ">
    10.5.6. Removing alerting rules for user-defined projects
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#managing-core-platform-alerting-rules_managing-alerts" class="j-doc-nav__link j-doc-nav__link--has-children">
    10.6. Managing alerting rules for core platform monitoring
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "10.6. Managing alerting rules for core platform monitoring"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "10.6. Managing alerting rules for core platform monitoring"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#modifying-core-platform-alerting-rules_managing-alerts" class="j-doc-nav__link ">
    10.6.1. Modifying core platform alerting rules
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#creating-new-alerting-rules_managing-alerts" class="j-doc-nav__link ">
    10.6.2. Creating new alerting rules
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#sending-notifications-to-external-systems_managing-alerts" class="j-doc-nav__link j-doc-nav__link--has-children">
    10.7. Sending notifications to external systems
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "10.7. Sending notifications to external systems"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "10.7. Sending notifications to external systems"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#configuring-alert-receivers_managing-alerts" class="j-doc-nav__link ">
    10.7.1. Configuring alert receivers
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#creating-alert-routing-for-user-defined-projects_managing-alerts" class="j-doc-nav__link ">
    10.7.2. Creating alert routing for user-defined projects
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#applying-custom-alertmanager-configuration_managing-alerts" class="j-doc-nav__link ">
    10.8. Applying a custom Alertmanager configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#applying-a-custom-configuration-to-alertmanager-for-user-defined-alert-routing_managing-alerts" class="j-doc-nav__link ">
    10.9. Applying a custom configuration to Alertmanager for user-defined alert routing
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#next-steps-4" class="j-doc-nav__link ">
    10.10. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#reviewing-monitoring-dashboards" class="j-doc-nav__link j-doc-nav__link--has-children">
    11. Reviewing monitoring dashboards
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "11. Reviewing monitoring dashboards"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "11. Reviewing monitoring dashboards"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#reviewing-monitoring-dashboards-admin_reviewing-monitoring-dashboards" class="j-doc-nav__link ">
    11.1. Reviewing monitoring dashboards as a cluster administrator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#reviewing-monitoring-dashboards-developer_reviewing-monitoring-dashboards" class="j-doc-nav__link ">
    11.2. Reviewing monitoring dashboards as a developer
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#next-steps_reviewing-monitoring-dashboards" class="j-doc-nav__link ">
    11.3. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#using-rfhe" class="j-doc-nav__link j-doc-nav__link--has-children">
    12. Monitoring bare-metal events with the Bare Metal Event Relay
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "12. Monitoring bare-metal events with the Bare Metal Event Relay"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "12. Monitoring bare-metal events with the Bare Metal Event Relay"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#about-using-redfish-hardware-events" class="j-doc-nav__link ">
    12.1. About bare-metal events
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#nw-rfhe-introduction_using-rfhe" class="j-doc-nav__link j-doc-nav__link--has-children">
    12.2. How bare-metal events work
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "12.2. How bare-metal events work"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "12.2. How bare-metal events work"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#rfhe-elements_using-rfhe" class="j-doc-nav__link j-doc-nav__link--has-children">
    12.2.1. Bare Metal Event Relay data flow
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "12.2.1. Bare Metal Event Relay data flow"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "12.2.1. Bare Metal Event Relay data flow"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#operator-managed-pod" class="j-doc-nav__link ">
    12.2.1.1. Operator-managed pod
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#bare-metal-event-relay" class="j-doc-nav__link ">
    12.2.1.2. Bare Metal Event Relay
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#cloud-native-event" class="j-doc-nav__link ">
    12.2.1.3. Cloud native event
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#cncf-cloudevents" class="j-doc-nav__link ">
    12.2.1.4. CNCF CloudEvents
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#http-transport-or-amqp-dispatch-router" class="j-doc-nav__link ">
    12.2.1.5. HTTP transport or AMQP dispatch router
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#cloud-event-proxy-sidecar" class="j-doc-nav__link ">
    12.2.1.6. Cloud event proxy sidecar
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#rfhe-data-flow_using-rfhe" class="j-doc-nav__link ">
    12.2.2. Redfish message parsing service
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#nw-rfhe-installing-operator-cli_using-rfhe" class="j-doc-nav__link ">
    12.2.3. Installing the Bare Metal Event Relay using the CLI
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#nw-rfhe-installing-operator-web-console_using-rfhe" class="j-doc-nav__link ">
    12.2.4. Installing the Bare Metal Event Relay using the web console
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#hw-installing-amq-interconnect-messaging-bus_using-rfhe" class="j-doc-nav__link ">
    12.3. Installing the AMQ messaging bus
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#subscribing-hw-events" class="j-doc-nav__link j-doc-nav__link--has-children">
    12.4. Subscribing to Redfish BMC bare-metal events for a cluster node
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "12.4. Subscribing to Redfish BMC bare-metal events for a cluster node"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "12.4. Subscribing to Redfish BMC bare-metal events for a cluster node"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#nw-rfhe-creating-bmc-event-sub_using-rfhe" class="j-doc-nav__link ">
    12.4.1. Subscribing to bare-metal events
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#nw-rfhe-querying-redfish-hardware-event-subs_using-rfhe" class="j-doc-nav__link ">
    12.4.2. Querying Redfish bare-metal event subscriptions with curl
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#nw-rfhe-creating-hardware-event_using-rfhe" class="j-doc-nav__link ">
    12.4.3. Creating the bare-metal event and Secret CRs
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#cnf-rfhe-notifications-api-refererence_using-rfhe" class="j-doc-nav__link ">
    12.5. Subscribing applications to bare-metal events REST API reference
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#cnf-migrating-from-amqp-to-http-transport_using-rfhe" class="j-doc-nav__link ">
    12.6. Migrating consumer applications to use HTTP transport for PTP or bare-metal events
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#accessing-third-party-monitoring-apis" class="j-doc-nav__link j-doc-nav__link--has-children">
    13. Accessing third-party monitoring APIs
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "13. Accessing third-party monitoring APIs"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "13. Accessing third-party monitoring APIs"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#accessing-third-party-monitoring-web-service-apis_accessing-third-party-monitoring-apis" class="j-doc-nav__link ">
    13.1. Accessing third-party monitoring web service APIs
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#monitoring-querying-metrics-by-using-the-federation-endpoint-for-prometheus_accessing-third-party-monitoring-apis" class="j-doc-nav__link ">
    13.2. Querying metrics by using the federation endpoint for Prometheus
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#additional-resources_accessing-third-party-monitoring-apis" class="j-doc-nav__link ">
    13.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#troubleshooting-monitoring-issues" class="j-doc-nav__link j-doc-nav__link--has-children">
    14. Troubleshooting monitoring issues
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "14. Troubleshooting monitoring issues"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "14. Troubleshooting monitoring issues"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#investigating-why-user-defined-metrics-are-unavailable_troubleshooting-monitoring-issues" class="j-doc-nav__link ">
    14.1. Investigating why user-defined project metrics are unavailable
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#determining-why-prometheus-is-consuming-disk-space_troubleshooting-monitoring-issues" class="j-doc-nav__link ">
    14.2. Determining why Prometheus is consuming a lot of disk space
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#config-map-reference-for-the-cluster-monitoring-operator" class="j-doc-nav__link j-doc-nav__link--has-children">
    15. Config map reference for the Cluster Monitoring Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15. Config map reference for the Cluster Monitoring Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15. Config map reference for the Cluster Monitoring Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#cluster-monitoring-operator-configuration-reference" class="j-doc-nav__link ">
    15.1. Cluster Monitoring Operator configuration reference
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#additionalalertmanagerconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.2. AdditionalAlertmanagerConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.2. AdditionalAlertmanagerConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.2. AdditionalAlertmanagerConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-6" class="j-doc-nav__link ">
    15.2.1. Description
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#required" class="j-doc-nav__link ">
    15.2.2. Required
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#alertmanagermainconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.3. AlertmanagerMainConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.3. AlertmanagerMainConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.3. AlertmanagerMainConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-7" class="j-doc-nav__link ">
    15.3.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#alertmanageruserworkloadconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.4. AlertmanagerUserWorkloadConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.4. AlertmanagerUserWorkloadConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.4. AlertmanagerUserWorkloadConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-8" class="j-doc-nav__link ">
    15.4.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#clustermonitoringconfiguration" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.5. ClusterMonitoringConfiguration
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.5. ClusterMonitoringConfiguration"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.5. ClusterMonitoringConfiguration"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-9" class="j-doc-nav__link ">
    15.5.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#dedicatedservicemonitors" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.6. DedicatedServiceMonitors
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.6. DedicatedServiceMonitors"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.6. DedicatedServiceMonitors"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-10" class="j-doc-nav__link ">
    15.6.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#k8sprometheusadapter" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.7. K8sPrometheusAdapter
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.7. K8sPrometheusAdapter"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.7. K8sPrometheusAdapter"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-11" class="j-doc-nav__link ">
    15.7.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#kubestatemetricsconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.8. KubeStateMetricsConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.8. KubeStateMetricsConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.8. KubeStateMetricsConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-12" class="j-doc-nav__link ">
    15.8.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#nodeexportercollectorbuddyinfoconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.9. NodeExporterCollectorBuddyInfoConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.9. NodeExporterCollectorBuddyInfoConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.9. NodeExporterCollectorBuddyInfoConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-13" class="j-doc-nav__link ">
    15.9.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#nodeexportercollectorconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.10. NodeExporterCollectorConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.10. NodeExporterCollectorConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.10. NodeExporterCollectorConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-14" class="j-doc-nav__link ">
    15.10.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#nodeexportercollectorcpufreqconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.11. NodeExporterCollectorCpufreqConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.11. NodeExporterCollectorCpufreqConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.11. NodeExporterCollectorCpufreqConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-15" class="j-doc-nav__link ">
    15.11.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#nodeexportercollectornetclassconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.12. NodeExporterCollectorNetClassConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.12. NodeExporterCollectorNetClassConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.12. NodeExporterCollectorNetClassConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-16" class="j-doc-nav__link ">
    15.12.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#nodeexportercollectornetdevconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.13. NodeExporterCollectorNetDevConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.13. NodeExporterCollectorNetDevConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.13. NodeExporterCollectorNetDevConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-17" class="j-doc-nav__link ">
    15.13.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#nodeexportercollectortcpstatconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.14. NodeExporterCollectorTcpStatConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.14. NodeExporterCollectorTcpStatConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.14. NodeExporterCollectorTcpStatConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-18" class="j-doc-nav__link ">
    15.14.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#nodeexporterconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.15. NodeExporterConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.15. NodeExporterConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.15. NodeExporterConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-19" class="j-doc-nav__link ">
    15.15.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#openshiftstatemetricsconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.16. OpenShiftStateMetricsConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.16. OpenShiftStateMetricsConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.16. OpenShiftStateMetricsConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-20" class="j-doc-nav__link ">
    15.16.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#prometheusk8sconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.17. PrometheusK8sConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.17. PrometheusK8sConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.17. PrometheusK8sConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-21" class="j-doc-nav__link ">
    15.17.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#prometheusoperatorconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.18. PrometheusOperatorConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.18. PrometheusOperatorConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.18. PrometheusOperatorConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-22" class="j-doc-nav__link ">
    15.18.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#prometheusrestrictedconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.19. PrometheusRestrictedConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.19. PrometheusRestrictedConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.19. PrometheusRestrictedConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-23" class="j-doc-nav__link ">
    15.19.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#remotewritespec" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.20. RemoteWriteSpec
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.20. RemoteWriteSpec"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.20. RemoteWriteSpec"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-24" class="j-doc-nav__link ">
    15.20.1. Description
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#required-2" class="j-doc-nav__link ">
    15.20.2. Required
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#tlsconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.21. TLSConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.21. TLSConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.21. TLSConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-25" class="j-doc-nav__link ">
    15.21.1. Description
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#required-3" class="j-doc-nav__link ">
    15.21.2. Required
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#telemeterclientconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.22. TelemeterClientConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.22. TelemeterClientConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.22. TelemeterClientConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-26" class="j-doc-nav__link ">
    15.22.1. Description
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#required-4" class="j-doc-nav__link ">
    15.22.2. Required
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#thanosquerierconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.23. ThanosQuerierConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.23. ThanosQuerierConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.23. ThanosQuerierConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-27" class="j-doc-nav__link ">
    15.23.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#thanosrulerconfig" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.24. ThanosRulerConfig
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.24. ThanosRulerConfig"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.24. ThanosRulerConfig"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-28" class="j-doc-nav__link ">
    15.24.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#userworkloadconfiguration" class="j-doc-nav__link j-doc-nav__link--has-children">
    15.25. UserWorkloadConfiguration
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15.25. UserWorkloadConfiguration"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15.25. UserWorkloadConfiguration"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#description-29" class="j-doc-nav__link ">
    15.25.1. Description
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                    

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring#idm140408917945440" class="j-doc-nav__link ">
    Legal Notice
  </a>
  
          </li>
              </ol>
    
  </div>
</nav>


              </div>
            </div>
            <div class="j-options-container j-options-container--mobile">
              <button class="j-sidebar__menu-trigger j-sidebar__menu-trigger--options content-expander__trigger">
                <span class="j-sidebar__menu-trigger__open-headline">
                  Settings
                </span>
                <span class="j-sidebar__menu-trigger__close-text">Close</span>
              </button>
              

  <ul class="j-doc-options__list content-expander">
    <li class="j-doc-options__item">
          <label class="j-doc-option__label j-doc-option__label--language" for="j-doc-language">
        Language:
      </label>
      <select id="j-doc-language" class="j-doc-option__select">
                  <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring" selected=''>
            English
          </option>
                  <option value="/documentation/zh-cn/openshift_container_platform/4.13/html-single/monitoring" >
            简体中文
          </option>
                  <option value="/documentation/ko-kr/openshift_container_platform/4.13/html-single/monitoring" >
            한국어
          </option>
                  <option value="/documentation/ja-jp/openshift_container_platform/4.13/html-single/monitoring" >
            日本語
          </option>
              </select>

            <noscript>
        <div class="j-doc-option__label j-doc-option__label--language" id="j-doc-option__label--language--nojs">
          Language:
        </div>
        <ul aria-labelledby="j-doc-option__label--language--nojs" class="j-doc-option__languages-list">
                      <li>
              <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring">English</a>
            </li>
                      <li>
              <a href="/documentation/zh-cn/openshift_container_platform/4.13/html-single/monitoring">简体中文</a>
            </li>
                      <li>
              <a href="/documentation/ko-kr/openshift_container_platform/4.13/html-single/monitoring">한국어</a>
            </li>
                      <li>
              <a href="/documentation/ja-jp/openshift_container_platform/4.13/html-single/monitoring">日本語</a>
            </li>
                  </ul>
      </noscript>

      </li>

    <li class="j-doc-options__item">
    <label for="j-doc-mode" class="j-doc-option__label j-doc-option__label--format">
      Format:
    </label>
    <select id="j-doc-mode" class="j-doc-option__select">
              <option value="/documentation/en-us/openshift_container_platform/4.13/html/monitoring"  class="j-doc-options__option j-doc-options__option--multi-page">
          Multi-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring" selected='' class="j-doc-options__option j-doc-options__option--single-page">
          Single-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/pdf/monitoring/OpenShift_Container_Platform-4.13-Monitoring-en-US.pdf"  class="j-doc-options__option j-doc-options__option--pdf">
          PDF
        </option>
          </select>

        <noscript>
      <div class="j-doc-option__label j-doc-option__label--format" id="j-doc-option__label--format--nojs">
        Format:
      </div>
      <ul class="j-doc-option__format-list" aria-labelledby="j-doc-option__label--format--nojs">
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--multi-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html/monitoring">Multi-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--single-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring">Single-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--pdf"><a href="/documentation/en-us/openshift_container_platform/4.13/pdf/monitoring/OpenShift_Container_Platform-4.13-Monitoring-en-US.pdf">PDF</a></li>
              </ul>
    </noscript>
  </li>
</ul>


              </div>
          </div>
                <div class="pvof-doc__tertiary-sidebar j-doc__tertiary-sidebar">
          <div class="pvof-doc__tertiary-sidebar__inner j-doc__tertiary-sidebar__inner">
            <div class="j-doc__doc-options">
              <div class="j-options-container j-options-container--desktop">
                <button class="j-sidebar__menu-trigger j-sidebar__menu-trigger--tablet content-expander__trigger">
                  <span class="j-sidebar__menu-trigger-icon"></span>
                  <h2 class="visually-hidden">Language and Page Formatting Options</h2>
                </button>
                  

  <ul class="j-doc-options__list content-expander">
    <li class="j-doc-options__item">
          <label class="j-doc-option__label j-doc-option__label--language" for="j-doc-language--2">
        Language:
      </label>
      <select id="j-doc-language--2" class="j-doc-option__select">
                  <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring" selected=''>
            English
          </option>
                  <option value="/documentation/zh-cn/openshift_container_platform/4.13/html-single/monitoring" >
            简体中文
          </option>
                  <option value="/documentation/ko-kr/openshift_container_platform/4.13/html-single/monitoring" >
            한국어
          </option>
                  <option value="/documentation/ja-jp/openshift_container_platform/4.13/html-single/monitoring" >
            日本語
          </option>
              </select>

            <noscript>
        <div class="j-doc-option__label j-doc-option__label--language" id="j-doc-option__label--language--nojs">
          Language:
        </div>
        <ul aria-labelledby="j-doc-option__label--language--nojs" class="j-doc-option__languages-list">
                      <li>
              <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring">English</a>
            </li>
                      <li>
              <a href="/documentation/zh-cn/openshift_container_platform/4.13/html-single/monitoring">简体中文</a>
            </li>
                      <li>
              <a href="/documentation/ko-kr/openshift_container_platform/4.13/html-single/monitoring">한국어</a>
            </li>
                      <li>
              <a href="/documentation/ja-jp/openshift_container_platform/4.13/html-single/monitoring">日本語</a>
            </li>
                  </ul>
      </noscript>

      </li>

    <li class="j-doc-options__item">
    <label for="j-doc-mode--2" class="j-doc-option__label j-doc-option__label--format">
      Format:
    </label>
    <select id="j-doc-mode--2" class="j-doc-option__select">
              <option value="/documentation/en-us/openshift_container_platform/4.13/html/monitoring"  class="j-doc-options__option j-doc-options__option--multi-page">
          Multi-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring" selected='' class="j-doc-options__option j-doc-options__option--single-page">
          Single-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/pdf/monitoring/OpenShift_Container_Platform-4.13-Monitoring-en-US.pdf"  class="j-doc-options__option j-doc-options__option--pdf">
          PDF
        </option>
          </select>

        <noscript>
      <div class="j-doc-option__label j-doc-option__label--format" id="j-doc-option__label--format--nojs">
        Format:
      </div>
      <ul class="j-doc-option__format-list" aria-labelledby="j-doc-option__label--format--nojs">
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--multi-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html/monitoring">Multi-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--single-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring">Single-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--pdf"><a href="/documentation/en-us/openshift_container_platform/4.13/pdf/monitoring/OpenShift_Container_Platform-4.13-Monitoring-en-US.pdf">PDF</a></li>
              </ul>
    </noscript>
  </li>
</ul>


                </div>
              </div>
          </div>
        </div>

                  <div class="doc-wrapper pvof-doc__wrapper j-superdoc__content-wrapper" id="doc-wrapper">
            

  <div class="pane-page-title">
    <h1 class="title" itemprop="name">Monitoring</h1>
  </div>


  <div xml:lang="en-US" class="book" id="idm140408913118288"><div class="titlepage"><div><div class="producttitle"><span class="productname">OpenShift Container Platform</span> <span class="productnumber">4.13</span></div><div><h2 class="subtitle">Configuring and using the monitoring stack in OpenShift Container Platform </h2></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat OpenShift Documentation Team</span></div></div><div><a href="#idm140408917945440">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				This document provides instructions for configuring and using the Prometheus monitoring stack in OpenShift Container Platform.
			</div></div></div></div><hr/></div><section class="chapter" id="monitoring-overview"><div class="titlepage"><div><div><h1 class="title">Chapter 1. Monitoring overview</h1></div></div></div><section class="section" id="about-openshift-monitoring"><div class="titlepage"><div><div><h2 class="title">1.1. About OpenShift Container Platform monitoring</h2></div></div></div><p class="_abstract _abstract">
				OpenShift Container Platform includes a preconfigured, preinstalled, and self-updating monitoring stack that provides monitoring for core platform components. You also have the option to <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#enabling-monitoring-for-user-defined-projects">enable monitoring for user-defined projects</a>.
			</p><p>
				A cluster administrator can <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#configuring-the-monitoring-stack">configure the monitoring stack</a> with the supported configurations. OpenShift Container Platform delivers monitoring best practices out of the box.
			</p><p>
				A set of alerts are included by default that immediately notify administrators about issues with a cluster. Default dashboards in the OpenShift Container Platform web console include visual representations of cluster metrics to help you to quickly understand the state of your cluster. With the OpenShift Container Platform web console, you can <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#managing-metrics">view and manage metrics</a>, <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#managing-alerts">alerts</a>, and <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#reviewing-monitoring-dashboards">review monitoring dashboards</a>.
			</p><p>
				In the <span class="strong strong"><strong>Observe</strong></span> section of OpenShift Container Platform web console, you can access and manage monitoring features such as <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#managing-metrics">metrics</a>, <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#managing-alerts">alerts</a>, <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#reviewing-monitoring-dashboards">monitoring dashboards</a>, and <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#getting-detailed-information-about-a-target_managing-metrics">metrics targets</a>.
			</p><p>
				After installing OpenShift Container Platform, cluster administrators can optionally enable monitoring for user-defined projects. By using this feature, cluster administrators, developers, and other users can specify how services and pods are monitored in their own projects. As a cluster administrator, you can find answers to common problems such as user metrics unavailability and high consumption of disk space by Prometheus in <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#troubleshooting-monitoring-issues">Troubleshooting monitoring issues</a>.
			</p></section><section class="section" id="understanding-the-monitoring-stack_monitoring-overview"><div class="titlepage"><div><div><h2 class="title">1.2. Understanding the monitoring stack</h2></div></div></div><p>
				The OpenShift Container Platform monitoring stack is based on the <a class="link" href="https://prometheus.io/">Prometheus</a> open source project and its wider ecosystem. The monitoring stack includes the following:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Default platform monitoring components</strong></span>. A set of platform monitoring components are installed in the <code class="literal">openshift-monitoring</code> project by default during an OpenShift Container Platform installation. This provides monitoring for core cluster components including Kubernetes services. The default monitoring stack also enables remote health monitoring for clusters.
					</p><p class="simpara">
						These components are illustrated in the <span class="strong strong"><strong>Installed by default</strong></span> section in the following diagram.
					</p></li><li class="listitem">
						<span class="strong strong"><strong>Components for monitoring user-defined projects</strong></span>. After optionally enabling monitoring for user-defined projects, additional monitoring components are installed in the <code class="literal">openshift-user-workload-monitoring</code> project. This provides monitoring for user-defined projects. These components are illustrated in the <span class="strong strong"><strong>User</strong></span> section in the following diagram.
					</li></ul></div><p>
				<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Monitoring-en-US/images/b44143e74de2402af66d9ddb8195c66f/monitoring-architecture.png" alt="OpenShift Container Platform monitoring architecture"/></span>

			</p><section class="section" id="default-monitoring-components_monitoring-overview"><div class="titlepage"><div><div><h3 class="title">1.2.1. Default monitoring components</h3></div></div></div><p>
					By default, the OpenShift Container Platform 4.13 monitoring stack includes these components:
				</p><div class="table" id="idm140408909614720"><p class="title"><strong>Table 1.1. Default monitoring stack components</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408908924640" scope="col">Component</th><th align="left" valign="top" id="idm140408908923552" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408908924640"> <p>
									Cluster Monitoring Operator
								</p>
								 </td><td align="left" valign="top" headers="idm140408908923552"> <p>
									The Cluster Monitoring Operator (CMO) is a central component of the monitoring stack. It deploys, manages, and automatically updates Prometheus and Alertmanager instances, Thanos Querier, Telemeter Client, and metrics targets. The CMO is deployed by the Cluster Version Operator (CVO).
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408908924640"> <p>
									Prometheus Operator
								</p>
								 </td><td align="left" valign="top" headers="idm140408908923552"> <p>
									The Prometheus Operator (PO) in the <code class="literal">openshift-monitoring</code> project creates, configures, and manages platform Prometheus instances and Alertmanager instances. It also automatically generates monitoring target configurations based on Kubernetes label queries.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408908924640"> <p>
									Prometheus
								</p>
								 </td><td align="left" valign="top" headers="idm140408908923552"> <p>
									Prometheus is the monitoring system on which the OpenShift Container Platform monitoring stack is based. Prometheus is a time-series database and a rule evaluation engine for metrics. Prometheus sends alerts to Alertmanager for processing.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408908924640"> <p>
									Prometheus Adapter
								</p>
								 </td><td align="left" valign="top" headers="idm140408908923552"> <p>
									The Prometheus Adapter (PA in the preceding diagram) translates Kubernetes node and pod queries for use in Prometheus. The resource metrics that are translated include CPU and memory utilization metrics. The Prometheus Adapter exposes the cluster resource metrics API for horizontal pod autoscaling. The Prometheus Adapter is also used by the <code class="literal">oc adm top nodes</code> and <code class="literal">oc adm top pods</code> commands.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408908924640"> <p>
									Alertmanager
								</p>
								 </td><td align="left" valign="top" headers="idm140408908923552"> <p>
									The Alertmanager service handles alerts received from Prometheus. Alertmanager is also responsible for sending the alerts to external notification systems.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408908924640"> <p>
									<code class="literal">kube-state-metrics</code> agent
								</p>
								 </td><td align="left" valign="top" headers="idm140408908923552"> <p>
									The <code class="literal">kube-state-metrics</code> exporter agent (KSM in the preceding diagram) converts Kubernetes objects to metrics that Prometheus can use.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408908924640"> <p>
									<code class="literal">openshift-state-metrics</code> agent
								</p>
								 </td><td align="left" valign="top" headers="idm140408908923552"> <p>
									The <code class="literal">openshift-state-metrics</code> exporter (OSM in the preceding diagram) expands upon <code class="literal">kube-state-metrics</code> by adding metrics for OpenShift Container Platform-specific resources.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408908924640"> <p>
									<code class="literal">node-exporter</code> agent
								</p>
								 </td><td align="left" valign="top" headers="idm140408908923552"> <p>
									The <code class="literal">node-exporter</code> agent (NE in the preceding diagram) collects metrics about every node in a cluster. The <code class="literal">node-exporter</code> agent is deployed on every node.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408908924640"> <p>
									Thanos Querier
								</p>
								 </td><td align="left" valign="top" headers="idm140408908923552"> <p>
									Thanos Querier aggregates and optionally deduplicates core OpenShift Container Platform metrics and metrics for user-defined projects under a single, multi-tenant interface.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408908924640"> <p>
									Telemeter Client
								</p>
								 </td><td align="left" valign="top" headers="idm140408908923552"> <p>
									Telemeter Client sends a subsection of the data from platform Prometheus instances to Red Hat to facilitate Remote Health Monitoring for clusters.
								</p>
								 </td></tr></tbody></table></div></div><p>
					All of the components in the monitoring stack are monitored by the stack and are automatically updated when OpenShift Container Platform is updated.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						All components of the monitoring stack use the TLS security profile settings that are centrally configured by a cluster administrator. If you configure a monitoring stack component that uses TLS security settings, the component uses the TLS security profile settings that already exist in the <code class="literal">tlsSecurityProfile</code> field in the global OpenShift Container Platform <code class="literal">apiservers.config.openshift.io/cluster</code> resource.
					</p></div></div></section><section class="section" id="default-monitoring-targets_monitoring-overview"><div class="titlepage"><div><div><h3 class="title">1.2.2. Default monitoring targets</h3></div></div></div><p>
					In addition to the components of the stack itself, the default monitoring stack monitors:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							CoreDNS
						</li><li class="listitem">
							Elasticsearch (if Logging is installed)
						</li><li class="listitem">
							etcd
						</li><li class="listitem">
							Fluentd (if Logging is installed)
						</li><li class="listitem">
							HAProxy
						</li><li class="listitem">
							Image registry
						</li><li class="listitem">
							Kubelets
						</li><li class="listitem">
							Kubernetes API server
						</li><li class="listitem">
							Kubernetes controller manager
						</li><li class="listitem">
							Kubernetes scheduler
						</li><li class="listitem">
							OpenShift API server
						</li><li class="listitem">
							OpenShift Controller Manager
						</li><li class="listitem">
							Operator Lifecycle Manager (OLM)
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Each OpenShift Container Platform component is responsible for its monitoring configuration. For problems with the monitoring of an OpenShift Container Platform component, open a <a class="link" href="https://issues.redhat.com/secure/CreateIssueDetails!init.jspa?pid=12332330&amp;summary=Monitoring_issue&amp;issuetype=1&amp;priority=10200&amp;versions=12391126">Jira issue</a> against that component, not against the general monitoring component.
					</p></div></div><p>
					Other OpenShift Container Platform framework components might be exposing metrics as well. For details, see their respective documentation.
				</p></section><section class="section" id="components-for-monitoring-user-defined-projects_monitoring-overview"><div class="titlepage"><div><div><h3 class="title">1.2.3. Components for monitoring user-defined projects</h3></div></div></div><p>
					OpenShift Container Platform includes an optional enhancement to the monitoring stack that enables you to monitor services and pods in user-defined projects. This feature includes the following components:
				</p><div class="table" id="idm140408913643040"><p class="title"><strong>Table 1.2. Components for monitoring user-defined projects</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408933933392" scope="col">Component</th><th align="left" valign="top" id="idm140408933932304" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408933933392"> <p>
									Prometheus Operator
								</p>
								 </td><td align="left" valign="top" headers="idm140408933932304"> <p>
									The Prometheus Operator (PO) in the <code class="literal">openshift-user-workload-monitoring</code> project creates, configures, and manages Prometheus and Thanos Ruler instances in the same project.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408933933392"> <p>
									Prometheus
								</p>
								 </td><td align="left" valign="top" headers="idm140408933932304"> <p>
									Prometheus is the monitoring system through which monitoring is provided for user-defined projects. Prometheus sends alerts to Alertmanager for processing.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408933933392"> <p>
									Thanos Ruler
								</p>
								 </td><td align="left" valign="top" headers="idm140408933932304"> <p>
									The Thanos Ruler is a rule evaluation engine for Prometheus that is deployed as a separate process. In OpenShift Container Platform , Thanos Ruler provides rule and alerting evaluation for the monitoring of user-defined projects.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408933933392"> <p>
									Alertmanager
								</p>
								 </td><td align="left" valign="top" headers="idm140408933932304"> <p>
									The Alertmanager service handles alerts received from Prometheus and Thanos Ruler. Alertmanager is also responsible for sending user-defined alerts to external notification systems. Deploying this service is optional.
								</p>
								 </td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The components in the preceding table are deployed after monitoring is enabled for user-defined projects.
					</p></div></div><p>
					All of these components are monitored by the stack and are automatically updated when OpenShift Container Platform is updated.
				</p></section><section class="section" id="monitoring-targets-for-user-defined-projects_monitoring-overview"><div class="titlepage"><div><div><h3 class="title">1.2.4. Monitoring targets for user-defined projects</h3></div></div></div><p>
					When monitoring is enabled for user-defined projects, you can monitor:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Metrics provided through service endpoints in user-defined projects.
						</li><li class="listitem">
							Pods running in user-defined projects.
						</li></ul></div></section></section><section class="section" id="openshift-monitoring-common-terms_monitoring-overview"><div class="titlepage"><div><div><h2 class="title">1.3. Glossary of common terms for OpenShift Container Platform monitoring</h2></div></div></div><p>
				This glossary defines common terms that are used in OpenShift Container Platform architecture.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Alertmanager</span></dt><dd>
							Alertmanager handles alerts received from Prometheus. Alertmanager is also responsible for sending the alerts to external notification systems.
						</dd><dt><span class="term">Alerting rules</span></dt><dd>
							Alerting rules contain a set of conditions that outline a particular state within a cluster. Alerts are triggered when those conditions are true. An alerting rule can be assigned a severity that defines how the alerts are routed.
						</dd><dt><span class="term">Cluster Monitoring Operator</span></dt><dd>
							The Cluster Monitoring Operator (CMO) is a central component of the monitoring stack. It deploys and manages Prometheus instances such as, the Thanos Querier, the Telemeter Client, and metrics targets to ensure that they are up to date. The CMO is deployed by the Cluster Version Operator (CVO).
						</dd><dt><span class="term">Cluster Version Operator</span></dt><dd>
							The Cluster Version Operator (CVO) manages the lifecycle of cluster Operators, many of which are installed in OpenShift Container Platform by default.
						</dd><dt><span class="term">config map</span></dt><dd>
							A config map provides a way to inject configuration data into pods. You can reference the data stored in a config map in a volume of type <code class="literal">ConfigMap</code>. Applications running in a pod can use this data.
						</dd><dt><span class="term">Container</span></dt><dd>
							A container is a lightweight and executable image that includes software and all its dependencies. Containers virtualize the operating system. As a result, you can run containers anywhere from a data center to a public or private cloud as well as a developer’s laptop.
						</dd><dt><span class="term">custom resource (CR)</span></dt><dd>
							A CR is an extension of the Kubernetes API. You can create custom resources.
						</dd><dt><span class="term">etcd</span></dt><dd>
							etcd is the key-value store for OpenShift Container Platform, which stores the state of all resource objects.
						</dd><dt><span class="term">Fluentd</span></dt><dd>
							Fluentd gathers logs from nodes and feeds them to Elasticsearch.
						</dd><dt><span class="term">Kubelets</span></dt><dd>
							Runs on nodes and reads the container manifests. Ensures that the defined containers have started and are running.
						</dd><dt><span class="term">Kubernetes API server</span></dt><dd>
							Kubernetes API server validates and configures data for the API objects.
						</dd><dt><span class="term">Kubernetes controller manager</span></dt><dd>
							Kubernetes controller manager governs the state of the cluster.
						</dd><dt><span class="term">Kubernetes scheduler</span></dt><dd>
							Kubernetes scheduler allocates pods to nodes.
						</dd><dt><span class="term">labels</span></dt><dd>
							Labels are key-value pairs that you can use to organize and select subsets of objects such as a pod.
						</dd><dt><span class="term">node</span></dt><dd>
							A worker machine in the OpenShift Container Platform cluster. A node is either a virtual machine (VM) or a physical machine.
						</dd><dt><span class="term">Operator</span></dt><dd>
							The preferred method of packaging, deploying, and managing a Kubernetes application in an OpenShift Container Platform cluster. An Operator takes human operational knowledge and encodes it into software that is packaged and shared with customers.
						</dd><dt><span class="term">Operator Lifecycle Manager (OLM)</span></dt><dd>
							OLM helps you install, update, and manage the lifecycle of Kubernetes native applications. OLM is an open source toolkit designed to manage Operators in an effective, automated, and scalable way.
						</dd><dt><span class="term">Persistent storage</span></dt><dd>
							Stores the data even after the device is shut down. Kubernetes uses persistent volumes to store the application data.
						</dd><dt><span class="term">Persistent volume claim (PVC)</span></dt><dd>
							You can use a PVC to mount a PersistentVolume into a Pod. You can access the storage without knowing the details of the cloud environment.
						</dd><dt><span class="term">pod</span></dt><dd>
							The pod is the smallest logical unit in Kubernetes. A pod is comprised of one or more containers to run in a worker node.
						</dd><dt><span class="term">Prometheus</span></dt><dd>
							Prometheus is the monitoring system on which the OpenShift Container Platform monitoring stack is based. Prometheus is a time-series database and a rule evaluation engine for metrics. Prometheus sends alerts to Alertmanager for processing.
						</dd><dt><span class="term">Prometheus adapter</span></dt><dd>
							The Prometheus Adapter translates Kubernetes node and pod queries for use in Prometheus. The resource metrics that are translated include CPU and memory utilization. The Prometheus Adapter exposes the cluster resource metrics API for horizontal pod autoscaling.
						</dd><dt><span class="term">Prometheus Operator</span></dt><dd>
							The Prometheus Operator (PO) in the <code class="literal">openshift-monitoring</code> project creates, configures, and manages platform Prometheus and Alertmanager instances. It also automatically generates monitoring target configurations based on Kubernetes label queries.
						</dd><dt><span class="term">Silences</span></dt><dd>
							A silence can be applied to an alert to prevent notifications from being sent when the conditions for an alert are true. You can mute an alert after the initial notification, while you work on resolving the underlying issue.
						</dd><dt><span class="term">storage</span></dt><dd>
							OpenShift Container Platform supports many types of storage, both for on-premise and cloud providers. You can manage container storage for persistent and non-persistent data in an OpenShift Container Platform cluster.
						</dd><dt><span class="term">Thanos Ruler</span></dt><dd>
							The Thanos Ruler is a rule evaluation engine for Prometheus that is deployed as a separate process. In OpenShift Container Platform, Thanos Ruler provides rule and alerting evaluation for the monitoring of user-defined projects.
						</dd><dt><span class="term">web console</span></dt><dd>
							A user interface (UI) to manage OpenShift Container Platform.
						</dd></dl></div></section><section class="section _additional-resources" id="additional-resources_monitoring-overview"><div class="titlepage"><div><div><h2 class="title">1.4. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/support/#about-remote-health-monitoring">About remote health monitoring</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#granting-users-permission-to-monitor-user-defined-projects_enabling-monitoring-for-user-defined-projects">Granting users permission to monitor user-defined projects</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#tls-security-profiles">Configuring TLS security profiles</a>
					</li></ul></div></section><section class="section" id="next-steps_monitoring-overview"><div class="titlepage"><div><div><h2 class="title">1.5. Next steps</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#configuring-the-monitoring-stack">Configuring the monitoring stack</a>
					</li></ul></div></section></section><section class="chapter" id="configuring-the-monitoring-stack"><div class="titlepage"><div><div><h1 class="title">Chapter 2. Configuring the monitoring stack</h1></div></div></div><p>
			The OpenShift Container Platform 4 installation program provides only a low number of configuration options before installation. Configuring most OpenShift Container Platform framework components, including the cluster monitoring stack, happens post-installation.
		</p><p>
			This section explains what configuration is supported, shows how to configure the monitoring stack, and demonstrates several common configuration scenarios.
		</p><section class="section" id="prerequisites"><div class="titlepage"><div><div><h2 class="title">2.1. Prerequisites</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The monitoring stack imposes additional resource requirements. Consult the computing resources recommendations in <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/scalability_and_performance/#scaling-cluster-monitoring-operator">Scaling the Cluster Monitoring Operator</a> and verify that you have sufficient resources.
					</li></ul></div></section><section class="section" id="maintenance-and-support_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">2.2. Maintenance and support for monitoring</h2></div></div></div><p>
				The supported way of configuring OpenShift Container Platform Monitoring is by configuring it using the options described in this document. <span class="strong strong"><strong>Do not use other configurations, as they are unsupported.</strong></span> Configuration paradigms might change across Prometheus releases, and such cases can only be handled gracefully if all configuration possibilities are controlled. If you use configurations other than those described in this section, your changes will disappear because the <code class="literal">cluster-monitoring-operator</code> reconciles any differences. The Operator resets everything to the defined state by default and by design.
			</p><section class="section" id="support-considerations_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.2.1. Support considerations for monitoring</h3></div></div></div><p>
					The following modifications are explicitly not supported:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Creating additional <code class="literal">ServiceMonitor</code>, <code class="literal">PodMonitor</code>, and <code class="literal">PrometheusRule</code> objects in the <code class="literal">openshift-*</code> and <code class="literal">kube-*</code> projects.</strong></span>
						</li><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>Modifying any resources or objects deployed in the <code class="literal">openshift-monitoring</code> or <code class="literal">openshift-user-workload-monitoring</code> projects.</strong></span> The resources created by the OpenShift Container Platform monitoring stack are not meant to be used by any other resources, as there are no guarantees about their backward compatibility.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The Alertmanager configuration is deployed as a secret resource in the <code class="literal">openshift-monitoring</code> namespace. If you have enabled a separate Alertmanager instance for user-defined alert routing, an Alertmanager configuration is also deployed as a secret resource in the <code class="literal">openshift-user-workload-monitoring</code> namespace. To configure additional routes for any instance of Alertmanager, you need to decode, modify, and then encode that secret. This procedure is a supported exception to the preceding statement.
							</p></div></div></li><li class="listitem">
							<span class="strong strong"><strong>Modifying resources of the stack.</strong></span> The OpenShift Container Platform monitoring stack ensures its resources are always in the state it expects them to be. If they are modified, the stack will reset them.
						</li><li class="listitem">
							<span class="strong strong"><strong>Deploying user-defined workloads to <code class="literal">openshift-*</code>, and <code class="literal">kube-*</code> projects.</strong></span> These projects are reserved for Red Hat provided components and they should not be used for user-defined workloads.
						</li><li class="listitem">
							<span class="strong strong"><strong>Enabling symptom based monitoring by using the <code class="literal">Probe</code> custom resource definition (CRD) in Prometheus Operator.</strong></span>
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Backward compatibility for metrics, recording rules, or alerting rules is not guaranteed.
					</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Installing custom Prometheus instances on OpenShift Container Platform.</strong></span> A custom instance is a Prometheus custom resource (CR) managed by the Prometheus Operator.
						</li></ul></div></section><section class="section" id="unmanaged-monitoring-operators_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.2.2. Support policy for monitoring Operators</h3></div></div></div><p>
					Monitoring Operators ensure that OpenShift Container Platform monitoring resources function as designed and tested. If Cluster Version Operator (CVO) control of an Operator is overridden, the Operator does not respond to configuration changes, reconcile the intended state of cluster objects, or receive updates.
				</p><p>
					While overriding CVO control for an Operator can be helpful during debugging, this is unsupported and the cluster administrator assumes full control of the individual component configurations and upgrades.
				</p><div class="formalpara"><p class="title"><strong>Overriding the Cluster Version Operator</strong></p><p>
						The <code class="literal">spec.overrides</code> parameter can be added to the configuration for the CVO to allow administrators to provide a list of overrides to the behavior of the CVO for a component. Setting the <code class="literal">spec.overrides[].unmanaged</code> parameter to <code class="literal">true</code> for a component blocks cluster upgrades and alerts the administrator after a CVO override has been set:
					</p></div><pre class="programlisting language-terminal">Disabling ownership via cluster version overrides prevents upgrades. Please remove overrides before continuing.</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Setting a CVO override puts the entire cluster in an unsupported state and prevents the monitoring stack from being reconciled to its intended state. This impacts the reliability features built into Operators and prevents updates from being received. Reported issues must be reproduced after removing any overrides for support to proceed.
					</p></div></div></section></section><section class="section" id="preparing-to-configure-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">2.3. Preparing to configure the monitoring stack</h2></div></div></div><p>
				You can configure the monitoring stack by creating and updating monitoring config maps.
			</p><section class="section" id="creating-cluster-monitoring-configmap_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.3.1. Creating a cluster monitoring config map</h3></div></div></div><p>
					To configure core OpenShift Container Platform monitoring components, you must create the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> project.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						When you save your changes to the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object, some or all of the pods in the <code class="literal">openshift-monitoring</code> project might be redeployed. It can sometimes take a while for these components to redeploy.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Check whether the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object exists:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring get configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
							If the <code class="literal">ConfigMap</code> object does not exist:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create the following YAML manifest. In this example the file is called <code class="literal">cluster-monitoring-config.yaml</code>:
								</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |</pre></li><li class="listitem"><p class="simpara">
									Apply the configuration to create the <code class="literal">ConfigMap</code> object:
								</p><pre class="programlisting language-terminal">$ oc apply -f cluster-monitoring-config.yaml</pre></li></ol></div></li></ol></div></section><section class="section" id="creating-user-defined-workload-monitoring-configmap_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.3.2. Creating a user-defined workload monitoring config map</h3></div></div></div><p>
					To configure the components that monitor user-defined projects, you must create the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						When you save your changes to the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object, some or all of the pods in the <code class="literal">openshift-user-workload-monitoring</code> project might be redeployed. It can sometimes take a while for these components to redeploy. You can create and configure the config map before you first enable monitoring for user-defined projects, to prevent having to redeploy the pods often.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Check whether the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object exists:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring get configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
							If the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object does not exist:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create the following YAML manifest. In this example the file is called <code class="literal">user-workload-monitoring-config.yaml</code>:
								</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |</pre></li><li class="listitem"><p class="simpara">
									Apply the configuration to create the <code class="literal">ConfigMap</code> object:
								</p><pre class="programlisting language-terminal">$ oc apply -f user-workload-monitoring-config.yaml</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Configurations applied to the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object are not activated unless a cluster administrator has enabled monitoring for user-defined projects.
									</p></div></div></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#enabling-monitoring-for-user-defined-projects">Enabling monitoring for user-defined projects</a>
						</li></ul></div></section></section><section class="section" id="configuring-the-monitoring-stack_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">2.4. Configuring the monitoring stack</h2></div></div></div><p>
				In OpenShift Container Platform 4.13, you can configure the monitoring stack using the <code class="literal">cluster-monitoring-config</code> or <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> objects. Config maps configure the Cluster Monitoring Operator (CMO), which in turn configures the components of the stack.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>If you are configuring core OpenShift Container Platform monitoring components</strong></span>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
							</li><li class="listitem">
								You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>If you are configuring components that monitor user-defined projects</strong></span>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role, or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
							</li><li class="listitem">
								You have created the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
							</li></ul></div></li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">ConfigMap</code> object.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>To configure core OpenShift Container Platform monitoring components</strong></span>:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> project:
									</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
										Add your configuration under <code class="literal">data/config.yaml</code> as a key-value pair <code class="literal">&lt;component_name&gt;: &lt;component_configuration&gt;</code>:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    &lt;component&gt;:
      &lt;configuration_for_the_component&gt;</pre><p class="simpara">
										Substitute <code class="literal">&lt;component&gt;</code> and <code class="literal">&lt;configuration_for_the_component&gt;</code> accordingly.
									</p><p class="simpara">
										The following example <code class="literal">ConfigMap</code> object configures a persistent volume claim (PVC) for Prometheus. This relates to the Prometheus instance that monitors core OpenShift Container Platform components only:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s: <span id="CO1-1"><!--Empty--></span><span class="callout">1</span>
      volumeClaimTemplate:
        spec:
          storageClassName: fast
          volumeMode: Filesystem
          resources:
            requests:
              storage: 40Gi</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO1-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												Defines the Prometheus component and the subsequent lines define its configuration.
											</div></dd></dl></div></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>To configure components that monitor user-defined projects</strong></span>:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Edit the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project:
									</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
										Add your configuration under <code class="literal">data/config.yaml</code> as a key-value pair <code class="literal">&lt;component_name&gt;: &lt;component_configuration&gt;</code>:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    &lt;component&gt;:
      &lt;configuration_for_the_component&gt;</pre><p class="simpara">
										Substitute <code class="literal">&lt;component&gt;</code> and <code class="literal">&lt;configuration_for_the_component&gt;</code> accordingly.
									</p><p class="simpara">
										The following example <code class="literal">ConfigMap</code> object configures a data retention period and minimum container resource requests for Prometheus. This relates to the Prometheus instance that monitors user-defined projects only:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    prometheus: <span id="CO2-1"><!--Empty--></span><span class="callout">1</span>
      retention: 24h <span id="CO2-2"><!--Empty--></span><span class="callout">2</span>
      resources:
        requests:
          cpu: 200m <span id="CO2-3"><!--Empty--></span><span class="callout">3</span>
          memory: 2Gi <span id="CO2-4"><!--Empty--></span><span class="callout">4</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO2-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												Defines the Prometheus component and the subsequent lines define its configuration.
											</div></dd><dt><a href="#CO2-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												Configures a twenty-four hour data retention period for the Prometheus instance that monitors user-defined projects.
											</div></dd><dt><a href="#CO2-3"><span class="callout">3</span></a> </dt><dd><div class="para">
												Defines a minimum resource request of 200 millicores for the Prometheus container.
											</div></dd><dt><a href="#CO2-4"><span class="callout">4</span></a> </dt><dd><div class="para">
												Defines a minimum pod resource request of 2 GiB of memory for the Prometheus container.
											</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											The Prometheus config map component is called <code class="literal">prometheusK8s</code> in the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object and <code class="literal">prometheus</code> in the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
										</p></div></div></li></ol></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Save the file to apply the changes to the <code class="literal">ConfigMap</code> object. The pods affected by the new configuration are restarted automatically.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Configurations applied to the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object are not activated unless a cluster administrator has enabled monitoring for user-defined projects.
						</p></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							When changes are saved to a monitoring config map, the pods and other resources in the related project might be redeployed. The running monitoring processes in that project might also be restarted.
						</p></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						Configuration reference for the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#clustermonitoringconfiguration"><code class="literal">cluster-monitoring-config</code></a> config map
					</li><li class="listitem">
						Configuration reference for the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#userworkloadconfiguration"><code class="literal">user-workload-monitoring-config</code></a> config map
					</li><li class="listitem">
						See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#preparing-to-configure-the-monitoring-stack">Preparing to configure the monitoring stack</a> for steps to create monitoring config maps
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#enabling-monitoring-for-user-defined-projects">Enabling monitoring for user-defined projects</a>
					</li></ul></div></section><section class="section" id="configurable-monitoring-components_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">2.5. Configurable monitoring components</h2></div></div></div><p>
				This table shows the monitoring components you can configure and the keys used to specify the components in the <code class="literal">cluster-monitoring-config</code> and <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> objects.
			</p><div class="table" id="idm140408910058080"><p class="title"><strong>Table 2.1. Configurable monitoring components</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408908335792" scope="col">Component</th><th align="left" valign="top" id="idm140408908334704" scope="col">cluster-monitoring-config config map key</th><th align="left" valign="top" id="idm140408914376464" scope="col">user-workload-monitoring-config config map key</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408908335792"> <p>
								Prometheus Operator
							</p>
							 </td><td align="left" valign="top" headers="idm140408908334704"> <p>
								<code class="literal">prometheusOperator</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140408914376464"> <p>
								<code class="literal">prometheusOperator</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140408908335792"> <p>
								Prometheus
							</p>
							 </td><td align="left" valign="top" headers="idm140408908334704"> <p>
								<code class="literal">prometheusK8s</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140408914376464"> <p>
								<code class="literal">prometheus</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140408908335792"> <p>
								Alertmanager
							</p>
							 </td><td align="left" valign="top" headers="idm140408908334704"> <p>
								<code class="literal">alertmanagerMain</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140408914376464"> <p>
								<code class="literal">alertmanager</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140408908335792"> <p>
								kube-state-metrics
							</p>
							 </td><td align="left" valign="top" headers="idm140408908334704"> <p>
								<code class="literal">kubeStateMetrics</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140408914376464"> </td></tr><tr><td align="left" valign="top" headers="idm140408908335792"> <p>
								openshift-state-metrics
							</p>
							 </td><td align="left" valign="top" headers="idm140408908334704"> <p>
								<code class="literal">openshiftStateMetrics</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140408914376464"> </td></tr><tr><td align="left" valign="top" headers="idm140408908335792"> <p>
								Telemeter Client
							</p>
							 </td><td align="left" valign="top" headers="idm140408908334704"> <p>
								<code class="literal">telemeterClient</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140408914376464"> </td></tr><tr><td align="left" valign="top" headers="idm140408908335792"> <p>
								Prometheus Adapter
							</p>
							 </td><td align="left" valign="top" headers="idm140408908334704"> <p>
								<code class="literal">k8sPrometheusAdapter</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140408914376464"> </td></tr><tr><td align="left" valign="top" headers="idm140408908335792"> <p>
								Thanos Querier
							</p>
							 </td><td align="left" valign="top" headers="idm140408908334704"> <p>
								<code class="literal">thanosQuerier</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140408914376464"> </td></tr><tr><td align="left" valign="top" headers="idm140408908335792"> <p>
								Thanos Ruler
							</p>
							 </td><td align="left" valign="top" headers="idm140408908334704"> </td><td align="left" valign="top" headers="idm140408914376464"> <p>
								<code class="literal">thanosRuler</code>
							</p>
							 </td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The Prometheus key is called <code class="literal">prometheusK8s</code> in the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object and <code class="literal">prometheus</code> in the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
				</p></div></div></section><section class="section" id="using-node-selectors-to-move-monitoring-components_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">2.6. Using node selectors to move monitoring components</h2></div></div></div><p>
				By using the <code class="literal">nodeSelector</code> constraint with labeled nodes, you can move any of the monitoring stack components to specific nodes. By doing so, you can control the placement and distribution of the monitoring components across a cluster.
			</p><p>
				By controlling placement and distribution of monitoring components, you can optimize system resource use, improve performance, and segregate workloads based on specific requirements or policies.
			</p><section class="section" id="how-node-selectors-work-with-other-constraints_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.6.1. How node selectors work with other constraints</h3></div></div></div><p>
					If you move monitoring components by using node selector constraints, be aware that other constraints to control pod scheduling might exist for a cluster:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Topology spread constraints might be in place to control pod placement.
						</li><li class="listitem">
							Hard anti-affinity rules are in place for Prometheus, Thanos Querier, Alertmanager, and other monitoring components to ensure that multiple pods for these components are always spread across different nodes and are therefore always highly available.
						</li></ul></div><p>
					When scheduling pods onto nodes, the pod scheduler tries to satisfy all existing constraints when determining pod placement. That is, all constraints compound when the pod scheduler determines which pods will be placed on which nodes.
				</p><p>
					Therefore, if you configure a node selector constraint but existing constraints cannot all be satisfied, the pod scheduler cannot match all constraints and will not schedule a pod for placement onto a node.
				</p><p>
					To maintain resilience and high availability for monitoring components, ensure that enough nodes are available and match all constraints when you configure a node selector constraint to move a component.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-nodes-working-updating_nodes-nodes-working">Understanding how to update labels on nodes</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-scheduler-node-selectors">Placing pods on specific nodes using node selectors</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#placing-pods-relative-to-other-pods-using-pod-affinity-and-anti-affinity-rules">Placing pods relative to other pods using affinity and anti-affinity rules</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#controlling-pod-placement-using-pod-topology-spread-constraints">Controlling pod placement by using pod topology spread constraints</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#configuring_pod_topology_spread_constraintsfor_monitoring_configuring-the-monitoring-stack">Configuring pod topology spread constraints for monitoring</a>
						</li><li class="listitem">
							<a class="link" href="https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#nodeselector">Kubernetes documentation about node selectors</a>
						</li></ul></div></section><section class="section" id="moving-monitoring-components-to-different-nodes_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.6.2. Moving monitoring components to different nodes</h3></div></div></div><p>
					To specify the nodes in your cluster on which monitoring stack components will run, configure the <code class="literal">nodeSelector</code> constraint in the component’s <code class="literal">ConfigMap</code> object to match labels assigned to the nodes.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						You cannot add a node selector constraint directly to an existing scheduled pod.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>If you are configuring core OpenShift Container Platform monitoring components</strong></span>:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
								</li><li class="listitem">
									You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>If you are configuring components that monitor user-defined projects</strong></span>:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
								</li><li class="listitem">
									You have created the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
								</li></ul></div></li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							If you have not done so yet, add a label to the nodes on which you want to run the monitoring components:
						</p><pre class="programlisting language-terminal">$ oc label nodes &lt;node-name&gt; &lt;node-label&gt;</pre></li><li class="listitem"><p class="simpara">
							Edit the <code class="literal">ConfigMap</code> object:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>To move a component that monitors core OpenShift Container Platform projects</strong></span>:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> project:
										</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
											Specify the node labels for the <code class="literal">nodeSelector</code> constraint for the component under <code class="literal">data/config.yaml</code>:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    &lt;component&gt;: <span id="CO3-1"><!--Empty--></span><span class="callout">1</span>
      nodeSelector:
        &lt;node-label-1&gt; <span id="CO3-2"><!--Empty--></span><span class="callout">2</span>
        &lt;node-label-2&gt; <span id="CO3-3"><!--Empty--></span><span class="callout">3</span>
        &lt;...&gt;</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO3-1"><span class="callout">1</span></a> </dt><dd><div class="para">
													Substitute <code class="literal">&lt;component&gt;</code> with the appropriate monitoring stack component name.
												</div></dd><dt><a href="#CO3-2"><span class="callout">2</span></a> </dt><dd><div class="para">
													Substitute <code class="literal">&lt;node-label-1&gt;</code> with the label you added to the node.
												</div></dd><dt><a href="#CO3-3"><span class="callout">3</span></a> </dt><dd><div class="para">
													Optional: Specify additional labels. If you specify additional labels, the pods for the component are only scheduled on the nodes that contain all of the specified labels.
												</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												If monitoring components remain in a <code class="literal">Pending</code> state after configuring the <code class="literal">nodeSelector</code> constraint, check the pod events for errors relating to taints and tolerations.
											</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>To move a component that monitors user-defined projects</strong></span>:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Edit the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project:
										</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
											Specify the node labels for the <code class="literal">nodeSelector</code> constraint for the component under <code class="literal">data/config.yaml</code>:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    &lt;component&gt;: <span id="CO4-1"><!--Empty--></span><span class="callout">1</span>
      nodeSelector:
        &lt;node-label-1&gt; <span id="CO4-2"><!--Empty--></span><span class="callout">2</span>
        &lt;node-label-2&gt; <span id="CO4-3"><!--Empty--></span><span class="callout">3</span>
        &lt;...&gt;</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO4-1"><span class="callout">1</span></a> </dt><dd><div class="para">
													Substitute <code class="literal">&lt;component&gt;</code> with the appropriate monitoring stack component name.
												</div></dd><dt><a href="#CO4-2"><span class="callout">2</span></a> </dt><dd><div class="para">
													Substitute <code class="literal">&lt;node-label-1&gt;</code> with the label you added to the node.
												</div></dd><dt><a href="#CO4-3"><span class="callout">3</span></a> </dt><dd><div class="para">
													Optional: Specify additional labels. If you specify additional labels, the pods for the component are only scheduled on the nodes that contain all of the specified labels.
												</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												If monitoring components remain in a <code class="literal">Pending</code> state after configuring the <code class="literal">nodeSelector</code> constraint, check the pod events for errors relating to taints and tolerations.
											</p></div></div></li></ol></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Save the file to apply the changes. The components specified in the new configuration are moved to the new nodes automatically.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Configurations applied to the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object are not activated unless a cluster administrator has enabled monitoring for user-defined projects.
							</p></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								When you save changes to a monitoring config map, the pods and other resources in the project might be redeployed. The running monitoring processes in that project might also restart.
							</p></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#preparing-to-configure-the-monitoring-stack">Preparing to configure the monitoring stack</a> for steps to create monitoring config maps
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#enabling-monitoring-for-user-defined-projects">Enabling monitoring for user-defined projects</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-nodes-working-updating_nodes-nodes-working">Understanding how to update labels on nodes</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-scheduler-node-selectors">Placing pods on specific nodes using node selectors</a>
						</li><li class="listitem">
							See the <a class="link" href="https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#nodeselector">Kubernetes documentation</a> for details on the <code class="literal">nodeSelector</code> constraint
						</li></ul></div></section></section><section class="section" id="assigning-tolerations-to-monitoring-components_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">2.7. Assigning tolerations to monitoring components</h2></div></div></div><p>
				You can assign tolerations to any of the monitoring stack components to enable moving them to tainted nodes.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>If you are configuring core OpenShift Container Platform monitoring components</strong></span>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
							</li><li class="listitem">
								You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>If you are configuring components that monitor user-defined projects</strong></span>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role, or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
							</li><li class="listitem">
								You have created the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
							</li></ul></div></li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">ConfigMap</code> object:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>To assign tolerations to a component that monitors core OpenShift Container Platform projects</strong></span>:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> project:
									</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
										Specify <code class="literal">tolerations</code> for the component:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    &lt;component&gt;:
      tolerations:
        &lt;toleration_specification&gt;</pre><p class="simpara">
										Substitute <code class="literal">&lt;component&gt;</code> and <code class="literal">&lt;toleration_specification&gt;</code> accordingly.
									</p><p class="simpara">
										For example, <code class="literal">oc adm taint nodes node1 key1=value1:NoSchedule</code> adds a taint to <code class="literal">node1</code> with the key <code class="literal">key1</code> and the value <code class="literal">value1</code>. This prevents monitoring components from deploying pods on <code class="literal">node1</code> unless a toleration is configured for that taint. The following example configures the <code class="literal">alertmanagerMain</code> component to tolerate the example taint:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    alertmanagerMain:
      tolerations:
      - key: "key1"
        operator: "Equal"
        value: "value1"
        effect: "NoSchedule"</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>To assign tolerations to a component that monitors user-defined projects</strong></span>:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Edit the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project:
									</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
										Specify <code class="literal">tolerations</code> for the component:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    &lt;component&gt;:
      tolerations:
        &lt;toleration_specification&gt;</pre><p class="simpara">
										Substitute <code class="literal">&lt;component&gt;</code> and <code class="literal">&lt;toleration_specification&gt;</code> accordingly.
									</p><p class="simpara">
										For example, <code class="literal">oc adm taint nodes node1 key1=value1:NoSchedule</code> adds a taint to <code class="literal">node1</code> with the key <code class="literal">key1</code> and the value <code class="literal">value1</code>. This prevents monitoring components from deploying pods on <code class="literal">node1</code> unless a toleration is configured for that taint. The following example configures the <code class="literal">thanosRuler</code> component to tolerate the example taint:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    thanosRuler:
      tolerations:
      - key: "key1"
        operator: "Equal"
        value: "value1"
        effect: "NoSchedule"</pre></li></ol></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Save the file to apply the changes. The new component placement configuration is applied automatically.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Configurations applied to the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object are not activated unless a cluster administrator has enabled monitoring for user-defined projects.
						</p></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							When changes are saved to a monitoring config map, the pods and other resources in the related project might be redeployed. The running monitoring processes in that project might also be restarted.
						</p></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#preparing-to-configure-the-monitoring-stack">Preparing to configure the monitoring stack</a> for steps to create monitoring config maps
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#enabling-monitoring-for-user-defined-projects">Enabling monitoring for user-defined projects</a>
					</li><li class="listitem">
						See the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-scheduler-taints-tolerations">OpenShift Container Platform documentation</a> on taints and tolerations
					</li><li class="listitem">
						See the <a class="link" href="https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/">Kubernetes documentation</a> on taints and tolerations
					</li></ul></div></section><section class="section" id="setting-the-body-size-limit-for-metrics-scraping_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">2.8. Setting the body size limit for metrics scraping</h2></div></div></div><p>
				By default, no limit exists for the uncompressed body size for data returned from scraped metrics targets. You can set a body size limit to help avoid situations in which Prometheus consumes excessive amounts of memory when scraped targets return a response that contains a large amount of data. In addition, by setting a body size limit, you can reduce the impact that a malicious target might have on Prometheus and on the cluster as a whole.
			</p><p>
				After you set a value for <code class="literal">enforcedBodySizeLimit</code>, the alert <code class="literal">PrometheusScrapeBodySizeLimitHit</code> fires when at least one Prometheus scrape target replies with a response body larger than the configured value.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					If metrics data scraped from a target has an uncompressed body size exceeding the configured size limit, the scrape fails. Prometheus then considers this target to be down and sets its <code class="literal">up</code> metric value to <code class="literal">0</code>, which can trigger the <code class="literal">TargetDown</code> alert.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
					</li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> namespace:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
						Add a value for <code class="literal">enforcedBodySizeLimit</code> to <code class="literal">data/config.yaml/prometheusK8s</code> to limit the body size that can be accepted per target scrape:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |-
    prometheusK8s:
      enforcedBodySizeLimit: 40MB <span id="CO5-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO5-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Specify the maximum body size for scraped metrics targets. This <code class="literal">enforcedBodySizeLimit</code> example limits the uncompressed size per target scrape to 40 megabytes. Valid numeric values use the Prometheus data size format: B (bytes), KB (kilobytes), MB (megabytes), GB (gigabytes), TB (terabytes), PB (petabytes), and EB (exabytes). The default value is <code class="literal">0</code>, which specifies no limit. You can also set the value to <code class="literal">automatic</code> to calculate the limit automatically based on cluster capacity.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Save the file to apply the changes automatically.
					</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							When you save changes to a <code class="literal">cluster-monitoring-config</code> config map, the pods and other resources in the <code class="literal">openshift-monitoring</code> project might be redeployed. The running monitoring processes in that project might also restart.
						</p></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/#scrape_config">Prometheus scrape configuration documentation</a>
					</li></ul></div></section><section class="section" id="configuring-a-dedicated-service-monitor_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">2.9. Configuring a dedicated service monitor</h2></div></div></div><p>
				You can configure OpenShift Container Platform core platform monitoring to use dedicated service monitors to collect metrics for the resource metrics pipeline.
			</p><p>
				When enabled, a dedicated service monitor exposes two additional metrics from the kubelet endpoint and sets the value of the <code class="literal">honorTimestamps</code> field to true.
			</p><p>
				By enabling a dedicated service monitor, you can improve the consistency of Prometheus Adapter-based CPU usage measurements used by, for example, the <code class="literal">oc adm top pod</code> command or the Horizontal Pod Autoscaler.
			</p><section class="section" id="enabling-a-dedicated-service-monitor_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.9.1. Enabling a dedicated service monitor</h3></div></div></div><p>
					You can configure core platform monitoring to use a dedicated service monitor by configuring the <code class="literal">dedicatedServiceMonitors</code> key in the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> namespace.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
						</li><li class="listitem">
							You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> namespace:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
							Add an <code class="literal">enabled: true</code> key-value pair as shown in the following sample:
						</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    k8sPrometheusAdapter:
      dedicatedServiceMonitors:
        enabled: true <span id="CO6-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO6-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Set the value of the <code class="literal">enabled</code> field to <code class="literal">true</code> to deploy a dedicated service monitor that exposes the kubelet <code class="literal">/metrics/resource</code> endpoint.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Save the file to apply the changes automatically.
						</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								When you save changes to a <code class="literal">cluster-monitoring-config</code> config map, the pods and other resources in the <code class="literal">openshift-monitoring</code> project might be redeployed. The running monitoring processes in that project might also restart.
							</p></div></div></li></ol></div></section></section><section class="section" id="configuring_persistent_storage_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">2.10. Configuring persistent storage</h2></div></div></div><p>
				Running cluster monitoring with persistent storage means that your metrics are stored to a persistent volume (PV) and can survive a pod being restarted or recreated. This is ideal if you require your metrics or alerting data to be guarded from data loss. For production environments, it is highly recommended to configure persistent storage. Because of the high IO demands, it is advantageous to use local storage.
			</p><section class="section" id="persistent-storage-prerequisites"><div class="titlepage"><div><div><h3 class="title">2.10.1. Persistent storage prerequisites</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Dedicate sufficient local persistent storage to ensure that the disk does not become full. How much storage you need depends on the number of pods.
						</li><li class="listitem">
							Verify that you have a persistent volume (PV) ready to be claimed by the persistent volume claim (PVC), one PV for each replica. Because Prometheus and Alertmanager both have two replicas, you need four PVs to support the entire monitoring stack. The PVs are available from the Local Storage Operator, but not if you have enabled dynamically provisioned storage.
						</li><li class="listitem"><p class="simpara">
							Use <code class="literal">Filesystem</code> as the storage type value for the <code class="literal">volumeMode</code> parameter when you configure the persistent volume.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								If you use a local volume for persistent storage, do not use a raw block volume, which is described with <code class="literal">volumeMode: Block</code> in the <code class="literal">LocalVolume</code> object. Prometheus cannot use raw block volumes.
							</p></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								Prometheus does not support file systems that are not POSIX compliant. For example, some NFS file system implementations are not POSIX compliant. If you want to use an NFS file system for storage, verify with the vendor that their NFS implementation is fully POSIX compliant.
							</p></div></div></li></ul></div></section><section class="section" id="configuring-a-local-persistent-volume-claim_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.10.2. Configuring a local persistent volume claim</h3></div></div></div><p>
					For monitoring components to use a persistent volume (PV), you must configure a persistent volume claim (PVC).
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>If you are configuring core OpenShift Container Platform monitoring components</strong></span>:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
								</li><li class="listitem">
									You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>If you are configuring components that monitor user-defined projects</strong></span>:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role, or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
								</li><li class="listitem">
									You have created the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
								</li></ul></div></li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">ConfigMap</code> object:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>To configure a PVC for a component that monitors core OpenShift Container Platform projects</strong></span>:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> project:
										</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
											Add your PVC configuration for the component under <code class="literal">data/config.yaml</code>:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    &lt;component&gt;:
      volumeClaimTemplate:
        spec:
          storageClassName: &lt;storage_class&gt;
          resources:
            requests:
              storage: &lt;amount_of_storage&gt;</pre><p class="simpara">
											See the <a class="link" href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#persistentvolumeclaims">Kubernetes documentation on PersistentVolumeClaims</a> for information on how to specify <code class="literal">volumeClaimTemplate</code>.
										</p><p class="simpara">
											The following example configures a PVC that claims local persistent storage for the Prometheus instance that monitors core OpenShift Container Platform components:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      volumeClaimTemplate:
        spec:
          storageClassName: local-storage
          resources:
            requests:
              storage: 40Gi</pre><p class="simpara">
											In the above example, the storage class created by the Local Storage Operator is called <code class="literal">local-storage</code>.
										</p><p class="simpara">
											The following example configures a PVC that claims local persistent storage for Alertmanager:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    alertmanagerMain:
      volumeClaimTemplate:
        spec:
          storageClassName: local-storage
          resources:
            requests:
              storage: 10Gi</pre></li></ol></div></li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>To configure a PVC for a component that monitors user-defined projects</strong></span>:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Edit the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project:
										</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
											Add your PVC configuration for the component under <code class="literal">data/config.yaml</code>:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    &lt;component&gt;:
      volumeClaimTemplate:
        spec:
          storageClassName: &lt;storage_class&gt;
          resources:
            requests:
              storage: &lt;amount_of_storage&gt;</pre><p class="simpara">
											See the <a class="link" href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#persistentvolumeclaims">Kubernetes documentation on PersistentVolumeClaims</a> for information on how to specify <code class="literal">volumeClaimTemplate</code>.
										</p><p class="simpara">
											The following example configures a PVC that claims local persistent storage for the Prometheus instance that monitors user-defined projects:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    prometheus:
      volumeClaimTemplate:
        spec:
          storageClassName: local-storage
          resources:
            requests:
              storage: 40Gi</pre><p class="simpara">
											In the above example, the storage class created by the Local Storage Operator is called <code class="literal">local-storage</code>.
										</p><p class="simpara">
											The following example configures a PVC that claims local persistent storage for Thanos Ruler:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    thanosRuler:
      volumeClaimTemplate:
        spec:
          storageClassName: local-storage
          resources:
            requests:
              storage: 10Gi</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												Storage requirements for the <code class="literal">thanosRuler</code> component depend on the number of rules that are evaluated and how many samples each rule generates.
											</p></div></div></li></ol></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Save the file to apply the changes. The pods affected by the new configuration are restarted automatically and the new storage configuration is applied.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Configurations applied to the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object are not activated unless a cluster administrator has enabled monitoring for user-defined projects.
							</p></div></div></li></ol></div></section><section class="section" id="resizing-a-persistent-storage-volume_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.10.3. Resizing a persistent storage volume</h3></div></div></div><p>
					OpenShift Container Platform does not support resizing an existing persistent storage volume used by <code class="literal">StatefulSet</code> resources, even if the underlying <code class="literal">StorageClass</code> resource used supports persistent volume sizing. Therefore, even if you update the <code class="literal">storage</code> field for an existing persistent volume claim (PVC) with a larger size, this setting will not be propagated to the associated persistent volume (PV).
				</p><p>
					However, resizing a PV is still possible by using a manual process. If you want to resize a PV for a monitoring component such as Prometheus, Thanos Ruler, or Alertmanager, you can update the appropriate config map in which the component is configured. Then, patch the PVC, and delete and orphan the pods. Orphaning the pods recreates the <code class="literal">StatefulSet</code> resource immediately and automatically updates the size of the volumes mounted in the pods with the new PVC settings. No service disruption occurs during this process.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>If you are configuring core OpenShift Container Platform monitoring components</strong></span>:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
								</li><li class="listitem">
									You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
								</li><li class="listitem">
									You have configured at least one PVC for core OpenShift Container Platform monitoring components.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>If you are configuring components that monitor user-defined projects</strong></span>:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role, or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
								</li><li class="listitem">
									You have created the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
								</li><li class="listitem">
									You have configured at least one PVC for components that monitor user-defined projects.
								</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">ConfigMap</code> object:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>To resize a PVC for a component that monitors core OpenShift Container Platform projects</strong></span>:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> project:
										</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
											Add a new storage size for the PVC configuration for the component under <code class="literal">data/config.yaml</code>:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    &lt;component&gt;: <span id="CO7-1"><!--Empty--></span><span class="callout">1</span>
      volumeClaimTemplate:
        spec:
          storageClassName: &lt;storage_class&gt; <span id="CO7-2"><!--Empty--></span><span class="callout">2</span>
          resources:
            requests:
              storage: &lt;amount_of_storage&gt; <span id="CO7-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO7-1"><span class="callout">1</span></a> </dt><dd><div class="para">
													Specify the core monitoring component.
												</div></dd><dt><a href="#CO7-2"><span class="callout">2</span></a> </dt><dd><div class="para">
													Specify the storage class.
												</div></dd><dt><a href="#CO7-3"><span class="callout">3</span></a> </dt><dd><div class="para">
													Specify the new size for the storage volume.
												</div></dd></dl></div><p class="simpara">
											The following example configures a PVC that sets the local persistent storage to 100 gigabytes for the Prometheus instance that monitors core OpenShift Container Platform components:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      volumeClaimTemplate:
        spec:
          storageClassName: local-storage
          resources:
            requests:
              storage: 100Gi</pre><p class="simpara">
											The following example configures a PVC that sets the local persistent storage for Alertmanager to 40 gigabytes:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    alertmanagerMain:
      volumeClaimTemplate:
        spec:
          storageClassName: local-storage
          resources:
            requests:
              storage: 40Gi</pre></li></ol></div></li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>To resize a PVC for a component that monitors user-defined projects</strong></span>:
								</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										You can resize the volumes for the Thanos Ruler and Prometheus instances that monitor user-defined projects.
									</p></div></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Edit the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project:
										</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
											Update the PVC configuration for the monitoring component under <code class="literal">data/config.yaml</code>:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    &lt;component&gt;: <span id="CO8-1"><!--Empty--></span><span class="callout">1</span>
      volumeClaimTemplate:
        spec:
          storageClassName: &lt;storage_class&gt; <span id="CO8-2"><!--Empty--></span><span class="callout">2</span>
          resources:
            requests:
              storage: &lt;amount_of_storage&gt; <span id="CO8-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO8-1"><span class="callout">1</span></a> </dt><dd><div class="para">
													Specify the core monitoring component.
												</div></dd><dt><a href="#CO8-2"><span class="callout">2</span></a> </dt><dd><div class="para">
													Specify the storage class.
												</div></dd><dt><a href="#CO8-3"><span class="callout">3</span></a> </dt><dd><div class="para">
													Specify the new size for the storage volume.
												</div></dd></dl></div><p class="simpara">
											The following example configures the PVC size to 100 gigabytes for the Prometheus instance that monitors user-defined projects:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    prometheus:
      volumeClaimTemplate:
        spec:
          storageClassName: local-storage
          resources:
            requests:
              storage: 100Gi</pre><p class="simpara">
											The following example sets the PVC size to 20 gigabytes for Thanos Ruler:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    thanosRuler:
      volumeClaimTemplate:
        spec:
          storageClassName: local-storage
          resources:
            requests:
              storage: 20Gi</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												Storage requirements for the <code class="literal">thanosRuler</code> component depend on the number of rules that are evaluated and how many samples each rule generates.
											</p></div></div></li></ol></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Save the file to apply the changes. The pods affected by the new configuration restart automatically.
						</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								When you save changes to a monitoring config map, the pods and other resources in the related project might be redeployed. The monitoring processes running in that project might also be restarted.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Manually patch every PVC with the updated storage request. The following example resizes the storage size for the Prometheus component in the <code class="literal">openshift-monitoring</code> namespace to 100Gi:
						</p><pre class="programlisting language-terminal">$ for p in $(oc -n openshift-monitoring get pvc -l app.kubernetes.io/name=prometheus -o jsonpath='{range .items[*]}{.metadata.name} {end}'); do \
  oc -n openshift-monitoring patch pvc/${p} --patch '{"spec": {"resources": {"requests": {"storage":"100Gi"}}}}'; \
  done</pre></li><li class="listitem"><p class="simpara">
							Delete the underlying StatefulSet with the <code class="literal">--cascade=orphan</code> parameter:
						</p><pre class="programlisting language-terminal">$ oc delete statefulset -l app.kubernetes.io/name=prometheus --cascade=orphan</pre></li></ol></div></section><section class="section" id="modifying-retention-time-and-size-for-prometheus-metrics-data_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.10.4. Modifying the retention time and size for Prometheus metrics data</h3></div></div></div><p>
					By default, Prometheus automatically retains metrics data for 15 days. You can modify the retention time for Prometheus to change how soon the data is deleted. You can also set the maximum amount of disk space the retained metrics data uses. If the data reaches this size limit, Prometheus deletes the oldest data first until the disk space used is again below the limit.
				</p><p>
					Note the following behaviors of these data retention settings:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The size-based retention policy applies to all data block directories in the <code class="literal">/prometheus</code> directory, including persistent blocks, write-ahead log (WAL) data, and m-mapped chunks.
						</li><li class="listitem">
							Data in the <code class="literal">/wal</code> and <code class="literal">/head_chunks</code> directories counts toward the retention size limit, but Prometheus never purges data from these directories based on size- or time-based retention policies. Thus, if you set a retention size limit lower than the maximum size set for the <code class="literal">/wal</code> and <code class="literal">/head_chunks</code> directories, you have configured the system not to retain any data blocks in the <code class="literal">/prometheus</code> data directories.
						</li><li class="listitem">
							The size-based retention policy is applied only when Prometheus cuts a new data block, which occurs every two hours after the WAL contains at least three hours of data.
						</li><li class="listitem">
							If you do not explicitly define values for either <code class="literal">retention</code> or <code class="literal">retentionSize</code>, retention time defaults to 15 days, and retention size is not set.
						</li><li class="listitem">
							If you define values for both <code class="literal">retention</code> and <code class="literal">retentionSize</code>, both values apply. If any data blocks exceed the defined retention time or the defined size limit, Prometheus purges these data blocks.
						</li><li class="listitem">
							If you define a value for <code class="literal">retentionSize</code> and do not define <code class="literal">retention</code>, only the <code class="literal">retentionSize</code> value applies.
						</li><li class="listitem">
							If you do not define a value for <code class="literal">retentionSize</code> and only define a value for <code class="literal">retention</code>, only the <code class="literal">retention</code> value applies.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>If you are configuring core OpenShift Container Platform monitoring components</strong></span>:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
								</li><li class="listitem">
									You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>If you are configuring components that monitor user-defined projects</strong></span>:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									A cluster administrator has enabled monitoring for user-defined projects.
								</li><li class="listitem">
									You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role, or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
								</li><li class="listitem">
									You have created the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
								</li></ul></div></li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">ConfigMap</code> object:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>To modify the retention time and size for the Prometheus instance that monitors core OpenShift Container Platform projects</strong></span>:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> project:
										</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
											Add the retention time and size configuration under <code class="literal">data/config.yaml</code>:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      retention: &lt;time_specification&gt; <span id="CO9-1"><!--Empty--></span><span class="callout">1</span>
      retentionSize: &lt;size_specification&gt; <span id="CO9-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO9-1"><span class="callout">1</span></a> </dt><dd><div class="para">
													The retention time: a number directly followed by <code class="literal">ms</code> (milliseconds), <code class="literal">s</code> (seconds), <code class="literal">m</code> (minutes), <code class="literal">h</code> (hours), <code class="literal">d</code> (days), <code class="literal">w</code> (weeks), or <code class="literal">y</code> (years). You can also combine time values for specific times, such as <code class="literal">1h30m15s</code>.
												</div></dd><dt><a href="#CO9-2"><span class="callout">2</span></a> </dt><dd><div class="para">
													The retention size: a number directly followed by <code class="literal">B</code> (bytes), <code class="literal">KB</code> (kilobytes), <code class="literal">MB</code> (megabytes), <code class="literal">GB</code> (gigabytes), <code class="literal">TB</code> (terabytes), <code class="literal">PB</code> (petabytes), and <code class="literal">EB</code> (exabytes).
												</div></dd></dl></div><p class="simpara">
											The following example sets the retention time to 24 hours and the retention size to 10 gigabytes for the Prometheus instance that monitors core OpenShift Container Platform components:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      retention: 24h
      retentionSize: 10GB</pre></li></ol></div></li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>To modify the retention time and size for the Prometheus instance that monitors user-defined projects</strong></span>:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Edit the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project:
										</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
											Add the retention time and size configuration under <code class="literal">data/config.yaml</code>:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    prometheus:
      retention: &lt;time_specification&gt; <span id="CO10-1"><!--Empty--></span><span class="callout">1</span>
      retentionSize: &lt;size_specification&gt; <span id="CO10-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO10-1"><span class="callout">1</span></a> </dt><dd><div class="para">
													The retention time: a number directly followed by <code class="literal">ms</code> (milliseconds), <code class="literal">s</code> (seconds), <code class="literal">m</code> (minutes), <code class="literal">h</code> (hours), <code class="literal">d</code> (days), <code class="literal">w</code> (weeks), or <code class="literal">y</code> (years). You can also combine time values for specific times, such as <code class="literal">1h30m15s</code>.
												</div></dd><dt><a href="#CO10-2"><span class="callout">2</span></a> </dt><dd><div class="para">
													The retention size: a number directly followed by <code class="literal">B</code> (bytes), <code class="literal">KB</code> (kilobytes), <code class="literal">MB</code> (megabytes), <code class="literal">GB</code> (gigabytes), <code class="literal">TB</code> (terabytes), <code class="literal">PB</code> (petabytes), or <code class="literal">EB</code> (exabytes).
												</div></dd></dl></div><p class="simpara">
											The following example sets the retention time to 24 hours and the retention size to 10 gigabytes for the Prometheus instance that monitors user-defined projects:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    prometheus:
      retention: 24h
      retentionSize: 10GB</pre></li></ol></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Save the file to apply the changes. The pods affected by the new configuration restart automatically.
						</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								When changes are saved to a monitoring config map, the pods and other resources in the related project might be redeployed. The running monitoring processes in that project might also be restarted.
							</p></div></div></li></ol></div></section><section class="section" id="modifying-the-retention-time-for-thanos-ruler-metrics-data_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.10.5. Modifying the retention time for Thanos Ruler metrics data</h3></div></div></div><p>
					By default, for user-defined projects, Thanos Ruler automatically retains metrics data for 24 hours. You can modify the retention time to change how long this data is retained by specifying a time value in the <code class="literal">user-workload-monitoring-config</code> config map in the <code class="literal">openshift-user-workload-monitoring</code> namespace.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
						</li><li class="listitem">
							A cluster administrator has enabled monitoring for user-defined projects.
						</li><li class="listitem">
							You have created the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
							Add the retention time configuration under <code class="literal">data/config.yaml</code>:
						</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    thanosRuler:
      retention: &lt;time_specification&gt; <span id="CO11-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO11-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Specify the retention time in the following format: a number directly followed by <code class="literal">ms</code> (milliseconds), <code class="literal">s</code> (seconds), <code class="literal">m</code> (minutes), <code class="literal">h</code> (hours), <code class="literal">d</code> (days), <code class="literal">w</code> (weeks), or <code class="literal">y</code> (years). You can also combine time values for specific times, such as <code class="literal">1h30m15s</code>. The default is <code class="literal">24h</code>.
								</div></dd></dl></div><p class="simpara">
							The following example sets the retention time to 10 days for Thanos Ruler data:
						</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    thanosRuler:
      retention: 10d</pre></li><li class="listitem"><p class="simpara">
							Save the file to apply the changes. The pods affected by the new configuration automatically restart.
						</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								Saving changes to a monitoring config map might restart monitoring processes and redeploy the pods and other resources in the related project. The running monitoring processes in that project might also restart.
							</p></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#creating-cluster-monitoring-configmap_configuring-the-monitoring-stack">Creating a cluster monitoring config map</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/scalability_and_performance/#prometheus-database-storage-requirements_cluster-monitoring-operator">Prometheus database storage requirements</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/scalability_and_performance/#optimizing-storage">Recommended configurable storage technology</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/storage/#understanding-persistent-storage">Understanding persistent storage</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/scalability_and_performance/#optimizing-storage">Optimizing storage</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/storage/#persistent-storage-using-local-volume">Configure local persistent storage</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#enabling-monitoring-for-user-defined-projects">Enabling monitoring for user-defined projects</a>
						</li></ul></div></section></section><section class="section" id="configuring_remote_write_storage_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">2.11. Configuring remote write storage</h2></div></div></div><p class="_abstract _abstract">
				You can configure remote write storage to enable Prometheus to send ingested metrics to remote systems for long-term storage. Doing so has no impact on how or for how long Prometheus stores metrics.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>If you are configuring core OpenShift Container Platform monitoring components:</strong></span>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
							</li><li class="listitem">
								You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>If you are configuring components that monitor user-defined projects:</strong></span>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
							</li><li class="listitem">
								You have created the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
							</li></ul></div></li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li><li class="listitem">
						You have set up a remote write compatible endpoint (such as Thanos) and know the endpoint URL. See the <a class="link" href="https://prometheus.io/docs/operating/integrations/#remote-endpoints-and-storage">Prometheus remote endpoints and storage documentation</a> for information about endpoints that are compatible with the remote write feature.
					</li><li class="listitem"><p class="simpara">
						You have set up authentication credentials in a <code class="literal">Secret</code> object for the remote write endpoint. You must create the secret in the same namespace as the Prometheus object for which you configure remote write: the <code class="literal">openshift-monitoring</code> namespace for default platform monitoring or the <code class="literal">openshift-user-workload-monitoring</code> namespace for user workload monitoring.
					</p><div class="admonition caution"><div class="admonition_header">Caution</div><div><p>
						To reduce security risks, use HTTPS and authentication to send metrics to an endpoint.
					</p></div></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">ConfigMap</code> object:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>To configure remote write for the Prometheus instance that monitors core OpenShift Container Platform projects</strong></span>:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> project:
									</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem">
										Add a <code class="literal">remoteWrite:</code> section under <code class="literal">data/config.yaml/prometheusK8s</code>.
									</li><li class="listitem"><p class="simpara">
										Add an endpoint URL and authentication credentials in this section:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      remoteWrite:
      - url: "https://remote-write-endpoint.example.com" <span id="CO12-1"><!--Empty--></span><span class="callout">1</span>
        &lt;endpoint_authentication_credentials&gt; <span id="CO12-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO12-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												The URL of the remote write endpoint.
											</div></dd><dt><a href="#CO12-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												The authentication method and credentials for the endpoint. Currently supported authentication methods are AWS Signature Version 4, authentication using HTTP in an <code class="literal">Authorization</code> request header, Basic authentication, OAuth 2.0, and TLS client. See <span class="emphasis"><em>Supported remote write authentication settings</em></span> for sample configurations of supported authentication methods.
											</div></dd></dl></div></li><li class="listitem"><p class="simpara">
										Add write relabel configuration values after the authentication credentials:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      remoteWrite:
      - url: "https://remote-write-endpoint.example.com"
        &lt;endpoint_authentication_credentials&gt;
        &lt;write_relabel_configs&gt; <span id="CO13-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO13-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												The write relabel configuration settings.
											</div></dd></dl></div><p class="simpara">
										For <code class="literal">&lt;write_relabel_configs&gt;</code> substitute a list of write relabel configurations for metrics that you want to send to the remote endpoint.
									</p><p class="simpara">
										The following sample shows how to forward a single metric called <code class="literal">my_metric</code>:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      remoteWrite:
      - url: "https://remote-write-endpoint.example.com"
        writeRelabelConfigs:
        - sourceLabels: [__name__]
          regex: 'my_metric'
          action: keep</pre><p class="simpara">
										See the <a class="link" href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/#relabel_config">Prometheus relabel_config documentation</a> for information about write relabel configuration options.
									</p></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>To configure remote write for the Prometheus instance that monitors user-defined projects</strong></span>:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Edit the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project:
									</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem">
										Add a <code class="literal">remoteWrite:</code> section under <code class="literal">data/config.yaml/prometheus</code>.
									</li><li class="listitem"><p class="simpara">
										Add an endpoint URL and authentication credentials in this section:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    prometheus:
      remoteWrite:
      - url: "https://remote-write-endpoint.example.com" <span id="CO14-1"><!--Empty--></span><span class="callout">1</span>
        &lt;endpoint_authentication_credentials&gt; <span id="CO14-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO14-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												The URL of the remote write endpoint.
											</div></dd><dt><a href="#CO14-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												The authentication method and credentials for the endpoint. Currently supported authentication methods are AWS Signature Version 4, authentication using HTTP an <code class="literal">Authorization</code> request header, basic authentication, OAuth 2.0, and TLS client. See <span class="emphasis"><em>Supported remote write authentication settings</em></span> below for sample configurations of supported authentication methods.
											</div></dd></dl></div></li><li class="listitem"><p class="simpara">
										Add write relabel configuration values after the authentication credentials:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    prometheus:
      remoteWrite:
      - url: "https://remote-write-endpoint.example.com"
        &lt;endpoint_authentication_credentials&gt;
        &lt;write_relabel_configs&gt; <span id="CO15-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO15-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												The write relabel configuration settings.
											</div></dd></dl></div><p class="simpara">
										For <code class="literal">&lt;write_relabel_configs&gt;</code> substitute a list of write relabel configurations for metrics that you want to send to the remote endpoint.
									</p><p class="simpara">
										The following sample shows how to forward a single metric called <code class="literal">my_metric</code>:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    prometheus:
      remoteWrite:
      - url: "https://remote-write-endpoint.example.com"
        writeRelabelConfigs:
        - sourceLabels: [__name__]
          regex: 'my_metric'
          action: keep</pre><p class="simpara">
										See the <a class="link" href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/#relabel_config">Prometheus relabel_config documentation</a> for information about write relabel configuration options.
									</p></li></ol></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Save the file to apply the changes. The pods affected by the new configuration restart automatically.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Configurations applied to the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object are not activated unless a cluster administrator has enabled monitoring for user-defined projects.
						</p></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							Saving changes to a monitoring <code class="literal">ConfigMap</code> object might redeploy the pods and other resources in the related project. Saving changes might also restart the running monitoring processes in that project.
						</p></div></div></li></ol></div><section class="section" id="supported_remote_write_authentication_settings_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.11.1. Supported remote write authentication settings</h3></div></div></div><p>
					You can use different methods to authenticate with a remote write endpoint. Currently supported authentication methods are AWS Signature Version 4, basic authentication, authorization, OAuth 2.0, and TLS client. The following table provides details about supported authentication methods for use with remote write.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408910681248" scope="col">Authentication method</th><th align="left" valign="top" id="idm140408910680160" scope="col">Config map field</th><th align="left" valign="top" id="idm140408910679072" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408910681248"> <p>
									AWS Signature Version 4
								</p>
								 </td><td align="left" valign="top" headers="idm140408910680160"> <p>
									<code class="literal">sigv4</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140408910679072"> <p>
									This method uses AWS Signature Version 4 authentication to sign requests. You cannot use this method simultaneously with authorization, OAuth 2.0, or Basic authentication.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408910681248"> <p>
									Basic authentication
								</p>
								 </td><td align="left" valign="top" headers="idm140408910680160"> <p>
									<code class="literal">basicAuth</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140408910679072"> <p>
									Basic authentication sets the authorization header on every remote write request with the configured username and password.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408910681248"> <p>
									authorization
								</p>
								 </td><td align="left" valign="top" headers="idm140408910680160"> <p>
									<code class="literal">authorization</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140408910679072"> <p>
									Authorization sets the <code class="literal">Authorization</code> header on every remote write request using the configured token.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408910681248"> <p>
									OAuth 2.0
								</p>
								 </td><td align="left" valign="top" headers="idm140408910680160"> <p>
									<code class="literal">oauth2</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140408910679072"> <p>
									An OAuth 2.0 configuration uses the client credentials grant type. Prometheus fetches an access token from <code class="literal">tokenUrl</code> with the specified client ID and client secret to access the remote write endpoint. You cannot use this method simultaneously with authorization, AWS Signature Version 4, or Basic authentication.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408910681248"> <p>
									TLS client
								</p>
								 </td><td align="left" valign="top" headers="idm140408910680160"> <p>
									<code class="literal">tlsConfig</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140408910679072"> <p>
									A TLS client configuration specifies the CA certificate, the client certificate, and the client key file information used to authenticate with the remote write endpoint server using TLS. The sample configuration assumes that you have already created a CA certificate file, a client certificate file, and a client key file.
								</p>
								 </td></tr></tbody></table></div></section><section class="section" id="example-remote-write-authentication-settings_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.11.2. Example remote write authentication settings</h3></div></div></div><p>
					The following samples show different authentication settings you can use to connect to a remote write endpoint. Each sample also shows how to configure a corresponding <code class="literal">Secret</code> object that contains authentication credentials and other relevant settings. Each sample configures authentication for use with default platform monitoring in the <code class="literal">openshift-monitoring</code> namespace.
				</p><div class="example" id="idm140408910842400"><p class="title"><strong>Example 2.1. Sample YAML for AWS Signature Version 4 authentication</strong></p><div class="example-contents"><p>
						The following shows the settings for a <code class="literal">sigv4</code> secret named <code class="literal">sigv4-credentials</code> in the <code class="literal">openshift-monitoring</code> namespace.
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Secret
metadata:
  name: sigv4-credentials
  namespace: openshift-monitoring
stringData:
  accessKey: &lt;AWS_access_key&gt; <span id="CO16-1"><!--Empty--></span><span class="callout">1</span>
  secretKey: &lt;AWS_secret_key&gt; <span id="CO16-2"><!--Empty--></span><span class="callout">2</span>
type: Opaque</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO16-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								The AWS API access key.
							</div></dd><dt><a href="#CO16-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								The AWS API secret key.
							</div></dd></dl></div><p>
						The following shows sample AWS Signature Version 4 remote write authentication settings that use a <code class="literal">Secret</code> object named <code class="literal">sigv4-credentials</code> in the <code class="literal">openshift-monitoring</code> namespace:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      remoteWrite:
      - url: "https://authorization.example.com/api/write"
        sigv4:
          region: &lt;AWS_region&gt; <span id="CO17-1"><!--Empty--></span><span class="callout">1</span>
          accessKey:
            name: sigv4-credentials <span id="CO17-2"><!--Empty--></span><span class="callout">2</span>
            key: accessKey <span id="CO17-3"><!--Empty--></span><span class="callout">3</span>
          secretKey:
            name: sigv4-credentials <span id="CO17-4"><!--Empty--></span><span class="callout">4</span>
            key: secretKey <span id="CO17-5"><!--Empty--></span><span class="callout">5</span>
          profile: &lt;AWS_profile_name&gt; <span id="CO17-6"><!--Empty--></span><span class="callout">6</span>
          roleArn: &lt;AWS_role_arn&gt; <span id="CO17-7"><!--Empty--></span><span class="callout">7</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO17-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								The AWS region.
							</div></dd><dt><a href="#CO17-2"><span class="callout">2</span></a> <a href="#CO17-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								The name of the <code class="literal">Secret</code> object containing the AWS API access credentials.
							</div></dd><dt><a href="#CO17-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								The key that contains the AWS API access key in the specified <code class="literal">Secret</code> object.
							</div></dd><dt><a href="#CO17-5"><span class="callout">5</span></a> </dt><dd><div class="para">
								The key that contains the AWS API secret key in the specified <code class="literal">Secret</code> object.
							</div></dd><dt><a href="#CO17-6"><span class="callout">6</span></a> </dt><dd><div class="para">
								The name of the AWS profile that is being used to authenticate.
							</div></dd><dt><a href="#CO17-7"><span class="callout">7</span></a> </dt><dd><div class="para">
								The unique identifier for the Amazon Resource Name (ARN) assigned to your role.
							</div></dd></dl></div></div></div><div class="example" id="idm140408910868176"><p class="title"><strong>Example 2.2. Sample YAML for basic authentication</strong></p><div class="example-contents"><p>
						The following shows sample basic authentication settings for a <code class="literal">Secret</code> object named <code class="literal">rw-basic-auth</code> in the <code class="literal">openshift-monitoring</code> namespace:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Secret
metadata:
  name: rw-basic-auth
  namespace: openshift-monitoring
stringData:
  user: &lt;basic_username&gt; <span id="CO18-1"><!--Empty--></span><span class="callout">1</span>
  password: &lt;basic_password&gt; <span id="CO18-2"><!--Empty--></span><span class="callout">2</span>
type: Opaque</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO18-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								The username.
							</div></dd><dt><a href="#CO18-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								The password.
							</div></dd></dl></div><p>
						The following sample shows a <code class="literal">basicAuth</code> remote write configuration that uses a <code class="literal">Secret</code> object named <code class="literal">rw-basic-auth</code> in the <code class="literal">openshift-monitoring</code> namespace. It assumes that you have already set up authentication credentials for the endpoint.
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      remoteWrite:
      - url: "https://basicauth.example.com/api/write"
        basicAuth:
          username:
            name: rw-basic-auth <span id="CO19-1"><!--Empty--></span><span class="callout">1</span>
            key: user <span id="CO19-2"><!--Empty--></span><span class="callout">2</span>
          password:
            name: rw-basic-auth <span id="CO19-3"><!--Empty--></span><span class="callout">3</span>
            key: password <span id="CO19-4"><!--Empty--></span><span class="callout">4</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO19-1"><span class="callout">1</span></a> <a href="#CO19-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								The name of the <code class="literal">Secret</code> object that contains the authentication credentials.
							</div></dd><dt><a href="#CO19-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								The key that contains the username in the specified <code class="literal">Secret</code> object.
							</div></dd><dt><a href="#CO19-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								The key that contains the password in the specified <code class="literal">Secret</code> object.
							</div></dd></dl></div></div></div><div class="example" id="idm140408906438544"><p class="title"><strong>Example 2.3. Sample YAML for authentication with a bearer token using a <code class="literal">Secret</code> Object</strong></p><div class="example-contents"><p>
						The following shows bearer token settings for a <code class="literal">Secret</code> object named <code class="literal">rw-bearer-auth</code> in the <code class="literal">openshift-monitoring</code> namespace:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Secret
metadata:
  name: rw-bearer-auth
  namespace: openshift-monitoring
stringData:
  token: &lt;authentication_token&gt; <span id="CO20-1"><!--Empty--></span><span class="callout">1</span>
type: Opaque</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO20-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								The authentication token.
							</div></dd></dl></div><p>
						The following shows sample bearer token config map settings that use a <code class="literal">Secret</code> object named <code class="literal">rw-bearer-auth</code> in the <code class="literal">openshift-monitoring</code> namespace:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    enableUserWorkload: true
    prometheusK8s:
      remoteWrite:
      - url: "https://authorization.example.com/api/write"
        authorization:
          type: Bearer <span id="CO21-1"><!--Empty--></span><span class="callout">1</span>
          credentials:
            name: rw-bearer-auth <span id="CO21-2"><!--Empty--></span><span class="callout">2</span>
            key: token <span id="CO21-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO21-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								The authentication type of the request. The default value is <code class="literal">Bearer</code>.
							</div></dd><dt><a href="#CO21-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								The name of the <code class="literal">Secret</code> object that contains the authentication credentials.
							</div></dd><dt><a href="#CO21-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								The key that contains the authentication token in the specified <code class="literal">Secret</code> object.
							</div></dd></dl></div></div></div><div class="example" id="idm140408909638256"><p class="title"><strong>Example 2.4. Sample YAML for OAuth 2.0 authentication</strong></p><div class="example-contents"><p>
						The following shows sample OAuth 2.0 settings for a <code class="literal">Secret</code> object named <code class="literal">oauth2-credentials</code> in the <code class="literal">openshift-monitoring</code> namespace:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Secret
metadata:
  name: oauth2-credentials
  namespace: openshift-monitoring
stringData:
  id: &lt;oauth2_id&gt; <span id="CO22-1"><!--Empty--></span><span class="callout">1</span>
  secret: &lt;oauth2_secret&gt; <span id="CO22-2"><!--Empty--></span><span class="callout">2</span>
  token: &lt;oauth2_authentication_token&gt; <span id="CO22-3"><!--Empty--></span><span class="callout">3</span>
type: Opaque</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO22-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								The Oauth 2.0 ID.
							</div></dd><dt><a href="#CO22-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								The OAuth 2.0 secret.
							</div></dd><dt><a href="#CO22-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								The OAuth 2.0 token.
							</div></dd></dl></div><p>
						The following shows an <code class="literal">oauth2</code> remote write authentication sample configuration that uses a <code class="literal">Secret</code> object named <code class="literal">oauth2-credentials</code> in the <code class="literal">openshift-monitoring</code> namespace:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      remoteWrite:
      - url: "https://test.example.com/api/write"
        oauth2:
          clientId:
            secret:
              name: oauth2-credentials <span id="CO23-1"><!--Empty--></span><span class="callout">1</span>
              key: id <span id="CO23-2"><!--Empty--></span><span class="callout">2</span>
          clientSecret:
            name: oauth2-credentials <span id="CO23-3"><!--Empty--></span><span class="callout">3</span>
            key: secret <span id="CO23-4"><!--Empty--></span><span class="callout">4</span>
          tokenUrl: https://example.com/oauth2/token <span id="CO23-5"><!--Empty--></span><span class="callout">5</span>
          scopes: <span id="CO23-6"><!--Empty--></span><span class="callout">6</span>
          - &lt;scope_1&gt;
          - &lt;scope_2&gt;
          endpointParams: <span id="CO23-7"><!--Empty--></span><span class="callout">7</span>
            param1: &lt;parameter_1&gt;
            param2: &lt;parameter_2&gt;</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO23-1"><span class="callout">1</span></a> <a href="#CO23-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								The name of the corresponding <code class="literal">Secret</code> object. Note that <code class="literal">ClientId</code> can alternatively refer to a <code class="literal">ConfigMap</code> object, although <code class="literal">clientSecret</code> must refer to a <code class="literal">Secret</code> object.
							</div></dd><dt><a href="#CO23-2"><span class="callout">2</span></a> <a href="#CO23-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								The key that contains the OAuth 2.0 credentials in the specified <code class="literal">Secret</code> object.
							</div></dd><dt><a href="#CO23-5"><span class="callout">5</span></a> </dt><dd><div class="para">
								The URL used to fetch a token with the specified <code class="literal">clientId</code> and <code class="literal">clientSecret</code>.
							</div></dd><dt><a href="#CO23-6"><span class="callout">6</span></a> </dt><dd><div class="para">
								The OAuth 2.0 scopes for the authorization request. These scopes limit what data the tokens can access.
							</div></dd><dt><a href="#CO23-7"><span class="callout">7</span></a> </dt><dd><div class="para">
								The OAuth 2.0 authorization request parameters required for the authorization server.
							</div></dd></dl></div></div></div><div class="example" id="idm140408906572544"><p class="title"><strong>Example 2.5. Sample YAML for TLS client authentication</strong></p><div class="example-contents"><p>
						The following shows sample TLS client settings for a <code class="literal">tls</code> <code class="literal">Secret</code> object named <code class="literal">mtls-bundle</code> in the <code class="literal">openshift-monitoring</code> namespace.
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Secret
metadata:
  name: mtls-bundle
  namespace: openshift-monitoring
data:
  ca.crt: &lt;ca_cert&gt; <span id="CO24-1"><!--Empty--></span><span class="callout">1</span>
  client.crt: &lt;client_cert&gt; <span id="CO24-2"><!--Empty--></span><span class="callout">2</span>
  client.key: &lt;client_key&gt; <span id="CO24-3"><!--Empty--></span><span class="callout">3</span>
type: tls</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO24-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								The CA certificate in the Prometheus container with which to validate the server certificate.
							</div></dd><dt><a href="#CO24-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								The client certificate for authentication with the server.
							</div></dd><dt><a href="#CO24-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								The client key.
							</div></dd></dl></div><p>
						The following sample shows a <code class="literal">tlsConfig</code> remote write authentication configuration that uses a TLS <code class="literal">Secret</code> object named <code class="literal">mtls-bundle</code>.
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      remoteWrite:
      - url: "https://remote-write-endpoint.example.com"
        tlsConfig:
          ca:
            secret:
              name: mtls-bundle <span id="CO25-1"><!--Empty--></span><span class="callout">1</span>
              key: ca.crt <span id="CO25-2"><!--Empty--></span><span class="callout">2</span>
          cert:
            secret:
              name: mtls-bundle <span id="CO25-3"><!--Empty--></span><span class="callout">3</span>
              key: client.crt <span id="CO25-4"><!--Empty--></span><span class="callout">4</span>
          keySecret:
            name: mtls-bundle <span id="CO25-5"><!--Empty--></span><span class="callout">5</span>
            key: client.key <span id="CO25-6"><!--Empty--></span><span class="callout">6</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO25-1"><span class="callout">1</span></a> <a href="#CO25-3"><span class="callout">3</span></a> <a href="#CO25-5"><span class="callout">5</span></a> </dt><dd><div class="para">
								The name of the corresponding <code class="literal">Secret</code> object that contains the TLS authentication credentials. Note that <code class="literal">ca</code> and <code class="literal">cert</code> can alternatively refer to a <code class="literal">ConfigMap</code> object, though <code class="literal">keySecret</code> must refer to a <code class="literal">Secret</code> object.
							</div></dd><dt><a href="#CO25-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								The key in the specified <code class="literal">Secret</code> object that contains the CA certificate for the endpoint.
							</div></dd><dt><a href="#CO25-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								The key in the specified <code class="literal">Secret</code> object that contains the client certificate for the endpoint.
							</div></dd><dt><a href="#CO25-6"><span class="callout">6</span></a> </dt><dd><div class="para">
								The key in the specified <code class="literal">Secret</code> object that contains the client key secret.
							</div></dd></dl></div></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							See <a class="link" href="https://prometheus.io/docs/operating/integrations/#remote-endpoints-and-storage">Setting up remote write compatible endpoints</a> for steps to create a remote write compatible endpoint (such as Thanos).
						</li><li class="listitem">
							See <a class="link" href="https://prometheus.io/docs/practices/remote_write/#remote-write-tuning">Tuning remote write settings</a> for information about how to optimize remote write settings for different use cases.
						</li><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-pods-secrets-about_nodes-pods-secrets">Understanding secrets</a> for steps to create and configure <code class="literal">Secret</code> objects in OpenShift Container Platform.
						</li><li class="listitem">
							See the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/api_reference/#spec-remotewrite-2">Prometheus REST API reference for remote write</a> for information about additional optional fields.
						</li></ul></div></section></section><section class="section" id="adding-cluster-id-labels-to-metrics_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">2.12. Adding cluster ID labels to metrics</h2></div></div></div><p>
				If you manage multiple OpenShift Container Platform clusters and use the remote write feature to send metrics data from these clusters to an external storage location, you can add cluster ID labels to identify the metrics data coming from different clusters. You can then query these labels to identify the source cluster for a metric and distinguish that data from similar metrics data sent by other clusters.
			</p><p>
				This way, if you manage many clusters for multiple customers and send metrics data to a single centralized storage system, you can use cluster ID labels to query metrics for a particular cluster or customer.
			</p><p>
				Creating and using cluster ID labels involves three general steps:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Configuring the write relabel settings for remote write storage.
					</li><li class="listitem">
						Adding cluster ID labels to the metrics.
					</li><li class="listitem">
						Querying these labels to identify the source cluster or customer for a metric.
					</li></ul></div><section class="section" id="creating-cluster-id-labels-for-metrics_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.12.1. Creating cluster ID labels for metrics</h3></div></div></div><p>
					You can create cluster ID labels for metrics for default platform monitoring and for user workload monitoring.
				</p><p>
					For default platform monitoring, you add cluster ID labels for metrics in the <code class="literal">write_relabel</code> settings for remote write storage in the <code class="literal">cluster-monitoring-config</code> config map in the <code class="literal">openshift-monitoring</code> namespace.
				</p><p>
					For user workload monitoring, you edit the settings in the <code class="literal">user-workload-monitoring-config</code> config map in the <code class="literal">openshift-user-workload-monitoring</code> namespace.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>If you are configuring default platform monitoring components:</strong></span>
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
								</li><li class="listitem">
									You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>If you are configuring components that monitor user-defined projects:</strong></span>
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
								</li><li class="listitem">
									You have created the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
								</li></ul></div></li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li><li class="listitem">
							You have configured remote write storage.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">ConfigMap</code> object:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>To create cluster ID labels for core OpenShift Container Platform metrics:</strong></span>
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> project:
										</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
											In the <code class="literal">writeRelabelConfigs:</code> section under <code class="literal">data/config.yaml/prometheusK8s/remoteWrite</code>, add cluster ID relabel configuration values:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      remoteWrite:
      - url: "https://remote-write-endpoint.example.com"
        &lt;endpoint_authentication_credentials&gt;
        writeRelabelConfigs: <span id="CO26-1"><!--Empty--></span><span class="callout">1</span>
          - &lt;relabel_config&gt; <span id="CO26-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO26-1"><span class="callout">1</span></a> </dt><dd><div class="para">
													Add a list of write relabel configurations for metrics that you want to send to the remote endpoint.
												</div></dd><dt><a href="#CO26-2"><span class="callout">2</span></a> </dt><dd><div class="para">
													Substitute the label configuration for the metrics sent to the remote write endpoint.
												</div></dd></dl></div><p class="simpara">
											The following sample shows how to forward a metric with the cluster ID label <code class="literal">cluster_id</code> in default platform monitoring:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      remoteWrite:
      - url: "https://remote-write-endpoint.example.com"
        writeRelabelConfigs:
        - sourceLabels:
          - __tmp_openshift_cluster_id__ <span id="CO27-1"><!--Empty--></span><span class="callout">1</span>
          targetLabel: cluster_id <span id="CO27-2"><!--Empty--></span><span class="callout">2</span>
          action: replace <span id="CO27-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO27-1"><span class="callout">1</span></a> </dt><dd><div class="para">
													The system initially applies a temporary cluster ID source label named <code class="literal">__tmp_openshift_cluster_id__</code>. This temporary label gets replaced by the cluster ID label name that you specify.
												</div></dd><dt><a href="#CO27-2"><span class="callout">2</span></a> </dt><dd><div class="para">
													Specify the name of the cluster ID label for metrics sent to remote write storage. If you use a label name that already exists for a metric, that value is overwritten with the name of this cluster ID label. For the label name, do not use <code class="literal">__tmp_openshift_cluster_id__</code>. The final relabeling step removes labels that use this name.
												</div></dd><dt><a href="#CO27-3"><span class="callout">3</span></a> </dt><dd><div class="para">
													The <code class="literal">replace</code> write relabel action replaces the temporary label with the target label for outgoing metrics. This action is the default and is applied if no action is specified.
												</div></dd></dl></div></li></ol></div></li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>To create cluster ID labels for user-defined project metrics:</strong></span>
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Edit the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project:
										</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
											In the <code class="literal">writeRelabelConfigs:</code> section under <code class="literal">data/config.yaml/prometheus/remoteWrite</code>, add cluster ID relabel configuration values:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    prometheus:
      remoteWrite:
      - url: "https://remote-write-endpoint.example.com"
        &lt;endpoint_authentication_credentials&gt;
        writeRelabelConfigs: <span id="CO28-1"><!--Empty--></span><span class="callout">1</span>
          - &lt;relabel_config&gt; <span id="CO28-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO28-1"><span class="callout">1</span></a> </dt><dd><div class="para">
													Add a list of write relabel configurations for metrics that you want to send to the remote endpoint.
												</div></dd><dt><a href="#CO28-2"><span class="callout">2</span></a> </dt><dd><div class="para">
													Substitute the label configuration for the metrics sent to the remote write endpoint.
												</div></dd></dl></div><p class="simpara">
											The following sample shows how to forward a metric with the cluster ID label <code class="literal">cluster_id</code> in user-workload monitoring:
										</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    prometheus:
      remoteWrite:
      - url: "https://remote-write-endpoint.example.com"
        writeRelabelConfigs:
        - sourceLabels:
          - __tmp_openshift_cluster_id__ <span id="CO29-1"><!--Empty--></span><span class="callout">1</span>
          targetLabel: cluster_id <span id="CO29-2"><!--Empty--></span><span class="callout">2</span>
          action: replace <span id="CO29-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO29-1"><span class="callout">1</span></a> </dt><dd><div class="para">
													The system initially applies a temporary cluster ID source label named <code class="literal">__tmp_openshift_cluster_id__</code>. This temporary label gets replaced by the cluster ID label name that you specify.
												</div></dd><dt><a href="#CO29-2"><span class="callout">2</span></a> </dt><dd><div class="para">
													Specify the name of the cluster ID label for metrics sent to remote write storage. If you use a label name that already exists for a metric, that value is overwritten with the name of this cluster ID label. For the label name, do not use <code class="literal">__tmp_openshift_cluster_id__</code>. The final relabeling step removes labels that use this name.
												</div></dd><dt><a href="#CO29-3"><span class="callout">3</span></a> </dt><dd><div class="para">
													The <code class="literal">replace</code> write relabel action replaces the temporary label with the target label for outgoing metrics. This action is the default and is applied if no action is specified.
												</div></dd></dl></div></li></ol></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Save the file to apply the changes to the <code class="literal">ConfigMap</code> object. The pods affected by the updated configuration automatically restart.
						</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								Saving changes to a monitoring <code class="literal">ConfigMap</code> object might redeploy the pods and other resources in the related project. Saving changes might also restart the running monitoring processes in that project.
							</p></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							For details about write relabel configuration, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#configuring_remote_write_storage_configuring-the-monitoring-stack">Configuring remote write storage</a>.
						</li></ul></div></section></section><section class="section" id="configuring-metrics-collection-profiles_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">2.13. Configuring metrics collection profiles</h2></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Using a metrics collection profile is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
				</p><p>
					For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview">https://access.redhat.com/support/offerings/techpreview</a>.
				</p></div></div><p>
				By default, Prometheus collects metrics exposed by all default metrics targets in OpenShift Container Platform components. However, you might want Prometheus to collect fewer metrics from a cluster in certain scenarios:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						If cluster administrators require only alert, telemetry, and console metrics and do not require other metrics to be available.
					</li><li class="listitem">
						If a cluster increases in size, and the increased size of the default metrics data collected now requires a significant increase in CPU and memory resources.
					</li></ul></div><p>
				You can use a metrics collection profile to collect either the default amount of metrics data or a minimal amount of metrics data. When you collect minimal metrics data, basic monitoring features such as alerting continue to work. At the same time, the CPU and memory resources required by Prometheus decrease.
			</p><section class="section" id="about-metrics-collection-profiles_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.13.1. About metrics collection profiles</h3></div></div></div><p>
					You can enable one of two metrics collection profiles:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>full</strong></span>: Prometheus collects metrics data exposed by all platform components. This setting is the default.
						</li><li class="listitem">
							<span class="strong strong"><strong>minimal</strong></span>: Prometheus collects only the metrics data required for platform alerts, recording rules, telemetry, and console dashboards.
						</li></ul></div></section><section class="section" id="choosing-a-metrics-collection-profile_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.13.2. Choosing a metrics collection profile</h3></div></div></div><p>
					To choose a metrics collection profile for core OpenShift Container Platform monitoring components, edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li><li class="listitem">
							You have enabled Technology Preview features by using the <code class="literal">FeatureGate</code> custom resource (CR).
						</li><li class="listitem">
							You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
						</li><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
						</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Saving changes to a monitoring config map might restart monitoring processes and redeploy the pods and other resources in the related project. The running monitoring processes in that project might also restart.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> project:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
							Add the metrics collection profile setting under <code class="literal">data/config.yaml/prometheusK8s</code>:
						</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      collectionProfile: &lt;metrics_collection_profile_name&gt; <span id="CO30-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO30-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									The name of the metrics collection profile. The available values are <code class="literal">full</code> or <code class="literal">minimal</code>. If you do not specify a value or if the <code class="literal">collectionProfile</code> key name does not exist in the config map, the default setting of <code class="literal">full</code> is used.
								</div></dd></dl></div><p class="simpara">
							The following example sets the metrics collection profile to <code class="literal">minimal</code> for the core platform instance of Prometheus:
						</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      collectionProfile: <span class="strong strong"><strong>minimal</strong></span></pre></li><li class="listitem">
							Save the file to apply the changes. The pods affected by the new configuration restart automatically.
						</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#viewing-a-list-of-available-metrics_managing-metrics">Viewing a list of available metrics</a> for steps to view a list of metrics being collected for a cluster.
						</li><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#enabling-features-using-featuregates">Enabling features using feature gates</a> for steps to enable Technology Preview features.
						</li></ul></div></section></section><section class="section" id="controlling-the-impact-of-unbound-attributes-in-user-defined-projects_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">2.14. Controlling the impact of unbound metrics attributes in user-defined projects</h2></div></div></div><p>
				Developers can create labels to define attributes for metrics in the form of key-value pairs. The number of potential key-value pairs corresponds to the number of possible values for an attribute. An attribute that has an unlimited number of potential values is called an unbound attribute. For example, a <code class="literal">customer_id</code> attribute is unbound because it has an infinite number of possible values.
			</p><p>
				Every assigned key-value pair has a unique time series. The use of many unbound attributes in labels can result in an exponential increase in the number of time series created. This can impact Prometheus performance and can consume a lot of disk space.
			</p><p>
				Cluster administrators can use the following measures to control the impact of unbound metrics attributes in user-defined projects:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Limit the number of samples that can be accepted per target scrape in user-defined projects
					</li><li class="listitem">
						Limit the number of scraped labels, the length of label names, and the length of label values
					</li><li class="listitem">
						Create alerts that fire when a scrape sample threshold is reached or when the target cannot be scraped
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Limiting scrape samples can help prevent the issues caused by adding many unbound attributes to labels. Developers can also prevent the underlying cause by limiting the number of unbound attributes that they define for metrics. Using attributes that are bound to a limited set of possible values reduces the number of potential key-value pair combinations.
				</p></div></div><section class="section" id="setting-scrape-sample-and-label-limits-for-user-defined-projects_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.14.1. Setting scrape sample and label limits for user-defined projects</h3></div></div></div><p>
					You can limit the number of samples that can be accepted per target scrape in user-defined projects. You can also limit the number of scraped labels, the length of label names, and the length of label values.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						If you set sample or label limits, no further sample data is ingested for that target scrape after the limit is reached.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role, or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
						</li><li class="listitem">
							You have enabled monitoring for user-defined projects.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
							Add the <code class="literal">enforcedSampleLimit</code> configuration to <code class="literal">data/config.yaml</code> to limit the number of samples that can be accepted per target scrape in user-defined projects:
						</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    prometheus:
      enforcedSampleLimit: 50000 <span id="CO31-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO31-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									A value is required if this parameter is specified. This <code class="literal">enforcedSampleLimit</code> example limits the number of samples that can be accepted per target scrape in user-defined projects to 50,000.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Add the <code class="literal">enforcedLabelLimit</code>, <code class="literal">enforcedLabelNameLengthLimit</code>, and <code class="literal">enforcedLabelValueLengthLimit</code> configurations to <code class="literal">data/config.yaml</code> to limit the number of scraped labels, the length of label names, and the length of label values in user-defined projects:
						</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    prometheus:
      enforcedLabelLimit: 500 <span id="CO32-1"><!--Empty--></span><span class="callout">1</span>
      enforcedLabelNameLengthLimit: 50 <span id="CO32-2"><!--Empty--></span><span class="callout">2</span>
      enforcedLabelValueLengthLimit: 600 <span id="CO32-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO32-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Specifies the maximum number of labels per scrape. The default value is <code class="literal">0</code>, which specifies no limit.
								</div></dd><dt><a href="#CO32-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Specifies the maximum length in characters of a label name. The default value is <code class="literal">0</code>, which specifies no limit.
								</div></dd><dt><a href="#CO32-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Specifies the maximum length in characters of a label value. The default value is <code class="literal">0</code>, which specifies no limit.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Save the file to apply the changes. The limits are applied automatically.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Configurations applied to the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object are not activated unless a cluster administrator has enabled monitoring for user-defined projects.
							</p></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								When changes are saved to the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object, the pods and other resources in the <code class="literal">openshift-user-workload-monitoring</code> project might be redeployed. The running monitoring processes in that project might also be restarted.
							</p></div></div></li></ol></div></section><section class="section" id="creating-scrape-sample-alerts_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h3 class="title">2.14.2. Creating scrape sample alerts</h3></div></div></div><p>
					You can create alerts that notify you when:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The target cannot be scraped or is not available for the specified <code class="literal">for</code> duration
						</li><li class="listitem">
							A scrape sample threshold is reached or is exceeded for the specified <code class="literal">for</code> duration
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role, or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
						</li><li class="listitem">
							You have enabled monitoring for user-defined projects.
						</li><li class="listitem">
							You have created the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
						</li><li class="listitem">
							You have limited the number of samples that can be accepted per target scrape in user-defined projects, by using <code class="literal">enforcedSampleLimit</code>.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a YAML file with alerts that inform you when the targets are down and when the enforced sample limit is approaching. The file in this example is called <code class="literal">monitoring-stack-alerts.yaml</code>:
						</p><pre class="programlisting language-yaml">apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  labels:
    prometheus: k8s
    role: alert-rules
  name: monitoring-stack-alerts <span id="CO33-1"><!--Empty--></span><span class="callout">1</span>
  namespace: ns1 <span id="CO33-2"><!--Empty--></span><span class="callout">2</span>
spec:
  groups:
  - name: general.rules
    rules:
    - alert: TargetDown <span id="CO33-3"><!--Empty--></span><span class="callout">3</span>
      annotations:
        message: '{{ printf "%.4g" $value }}% of the {{ $labels.job }}/{{ $labels.service
          }} targets in {{ $labels.namespace }} namespace are down.' <span id="CO33-4"><!--Empty--></span><span class="callout">4</span>
      expr: 100 * (count(up == 0) BY (job, namespace, service) / count(up) BY (job,
        namespace, service)) &gt; 10
      for: 10m <span id="CO33-5"><!--Empty--></span><span class="callout">5</span>
      labels:
        severity: warning <span id="CO33-6"><!--Empty--></span><span class="callout">6</span>
    - alert: ApproachingEnforcedSamplesLimit <span id="CO33-7"><!--Empty--></span><span class="callout">7</span>
      annotations:
        message: '{{ $labels.container }} container of the {{ $labels.pod }} pod in the {{ $labels.namespace }} namespace consumes {{ $value | humanizePercentage }} of the samples limit budget.' <span id="CO33-8"><!--Empty--></span><span class="callout">8</span>
      expr: scrape_samples_scraped/50000 &gt; 0.8 <span id="CO33-9"><!--Empty--></span><span class="callout">9</span>
      for: 10m <span id="CO33-10"><!--Empty--></span><span class="callout">10</span>
      labels:
        severity: warning <span id="CO33-11"><!--Empty--></span><span class="callout">11</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO33-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Defines the name of the alerting rule.
								</div></dd><dt><a href="#CO33-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Specifies the user-defined project where the alerting rule will be deployed.
								</div></dd><dt><a href="#CO33-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									The <code class="literal">TargetDown</code> alert will fire if the target cannot be scraped or is not available for the <code class="literal">for</code> duration.
								</div></dd><dt><a href="#CO33-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									The message that will be output when the <code class="literal">TargetDown</code> alert fires.
								</div></dd><dt><a href="#CO33-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									The conditions for the <code class="literal">TargetDown</code> alert must be true for this duration before the alert is fired.
								</div></dd><dt><a href="#CO33-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									Defines the severity for the <code class="literal">TargetDown</code> alert.
								</div></dd><dt><a href="#CO33-7"><span class="callout">7</span></a> </dt><dd><div class="para">
									The <code class="literal">ApproachingEnforcedSamplesLimit</code> alert will fire when the defined scrape sample threshold is reached or exceeded for the specified <code class="literal">for</code> duration.
								</div></dd><dt><a href="#CO33-8"><span class="callout">8</span></a> </dt><dd><div class="para">
									The message that will be output when the <code class="literal">ApproachingEnforcedSamplesLimit</code> alert fires.
								</div></dd><dt><a href="#CO33-9"><span class="callout">9</span></a> </dt><dd><div class="para">
									The threshold for the <code class="literal">ApproachingEnforcedSamplesLimit</code> alert. In this example the alert will fire when the number of samples per target scrape has exceeded 80% of the enforced sample limit of <code class="literal">50000</code>. The <code class="literal">for</code> duration must also have passed before the alert will fire. The <code class="literal">&lt;number&gt;</code> in the expression <code class="literal">scrape_samples_scraped/&lt;number&gt; &gt; &lt;threshold&gt;</code> must match the <code class="literal">enforcedSampleLimit</code> value defined in the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
								</div></dd><dt><a href="#CO33-10"><span class="callout">10</span></a> </dt><dd><div class="para">
									The conditions for the <code class="literal">ApproachingEnforcedSamplesLimit</code> alert must be true for this duration before the alert is fired.
								</div></dd><dt><a href="#CO33-11"><span class="callout">11</span></a> </dt><dd><div class="para">
									Defines the severity for the <code class="literal">ApproachingEnforcedSamplesLimit</code> alert.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Apply the configuration to the user-defined project:
						</p><pre class="programlisting language-terminal">$ oc apply -f monitoring-stack-alerts.yaml</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#creating-user-defined-workload-monitoring-configmap_configuring-the-monitoring-stack">Creating a user-defined workload monitoring config map</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#enabling-monitoring-for-user-defined-projects">Enabling monitoring for user-defined projects</a>
						</li><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#determining-why-prometheus-is-consuming-disk-space_troubleshooting-monitoring-issues">Determining why Prometheus is consuming a lot of disk space</a> for steps to query which metrics have the highest number of scrape samples.
						</li></ul></div></section></section></section><section class="chapter" id="monitoring-configuring-external-alertmanagers_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h1 class="title">Chapter 3. Configuring external Alertmanager instances</h1></div></div></div><p>
			The OpenShift Container Platform monitoring stack includes a local Alertmanager instance that routes alerts from Prometheus. You can add external Alertmanager instances to route alerts for core OpenShift Container Platform projects or user-defined projects.
		</p><p>
			If you add the same external Alertmanager configuration for multiple clusters and disable the local instance for each cluster, you can then manage alert routing for multiple clusters by using a single external Alertmanager instance.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					<span class="strong strong"><strong>If you are configuring core OpenShift Container Platform monitoring components in the <code class="literal">openshift-monitoring</code> project</strong></span>:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
						</li><li class="listitem">
							You have created the <code class="literal">cluster-monitoring-config</code> config map.
						</li></ul></div></li><li class="listitem"><p class="simpara">
					<span class="strong strong"><strong>If you are configuring components that monitor user-defined projects</strong></span>:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role, or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
						</li><li class="listitem">
							You have created the <code class="literal">user-workload-monitoring-config</code> config map.
						</li></ul></div></li><li class="listitem">
					You have installed the OpenShift CLI (<code class="literal">oc</code>).
				</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
					Edit the <code class="literal">ConfigMap</code> object.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>To configure additional Alertmanagers for routing alerts from core OpenShift Container Platform projects</strong></span>:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Edit the <code class="literal">cluster-monitoring-config</code> config map in the <code class="literal">openshift-monitoring</code> project:
								</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem">
									Add an <code class="literal">additionalAlertmanagerConfigs:</code> section under <code class="literal">data/config.yaml/prometheusK8s</code>.
								</li><li class="listitem"><p class="simpara">
									Add the configuration details for additional Alertmanagers in this section:
								</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      additionalAlertmanagerConfigs:
      - &lt;alertmanager_specification&gt;</pre><p class="simpara">
									For <code class="literal">&lt;alertmanager_specification&gt;</code>, substitute authentication and other configuration details for additional Alertmanager instances. Currently supported authentication methods are bearer token (<code class="literal">bearerToken</code>) and client TLS (<code class="literal">tlsConfig</code>). The following sample config map configures an additional Alertmanager using a bearer token with client TLS authentication:
								</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      additionalAlertmanagerConfigs:
      - scheme: https
        pathPrefix: /
        timeout: "30s"
        apiVersion: v1
        bearerToken:
          name: alertmanager-bearer-token
          key: token
        tlsConfig:
          key:
            name: alertmanager-tls
            key: tls.key
          cert:
            name: alertmanager-tls
            key: tls.crt
          ca:
            name: alertmanager-tls
            key: tls.ca
        staticConfigs:
        - external-alertmanager1-remote.com
        - external-alertmanager1-remote2.com</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>To configure additional Alertmanager instances for routing alerts from user-defined projects</strong></span>:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Edit the <code class="literal">user-workload-monitoring-config</code> config map in the <code class="literal">openshift-user-workload-monitoring</code> project:
								</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem">
									Add a <code class="literal">&lt;component&gt;/additionalAlertmanagerConfigs:</code> section under <code class="literal">data/config.yaml/</code>.
								</li><li class="listitem"><p class="simpara">
									Add the configuration details for additional Alertmanagers in this section:
								</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    &lt;component&gt;:
      additionalAlertmanagerConfigs:
      - &lt;alertmanager_specification&gt;</pre><p class="simpara">
									For <code class="literal">&lt;component&gt;</code>, substitute one of two supported external Alertmanager components: <code class="literal">prometheus</code> or <code class="literal">thanosRuler</code>.
								</p><p class="simpara">
									For <code class="literal">&lt;alertmanager_specification&gt;</code>, substitute authentication and other configuration details for additional Alertmanager instances. Currently supported authentication methods are bearer token (<code class="literal">bearerToken</code>) and client TLS (<code class="literal">tlsConfig</code>). The following sample config map configures an additional Alertmanager using Thanos Ruler with a bearer token and client TLS authentication:
								</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    thanosRuler:
      additionalAlertmanagerConfigs:
      - scheme: https
        pathPrefix: /
        timeout: "30s"
        apiVersion: v1
        bearerToken:
          name: alertmanager-bearer-token
          key: token
        tlsConfig:
          key:
            name: alertmanager-tls
            key: tls.key
          cert:
            name: alertmanager-tls
            key: tls.crt
          ca:
            name: alertmanager-tls
            key: tls.ca
        staticConfigs:
        - external-alertmanager1-remote.com
        - external-alertmanager1-remote2.com</pre></li></ol></div></li></ul></div></li><li class="listitem"><p class="simpara">
					Save the file to apply the changes to the <code class="literal">ConfigMap</code> object. The new component placement configuration is applied automatically.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Configurations applied to the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object are not activated unless a cluster administrator has enabled monitoring for user-defined projects.
					</p></div></div></li><li class="listitem">
					Save the file to apply the changes to the <code class="literal">ConfigMap</code> object. The new component placement configuration is applied automatically.
				</li></ol></div></section><section class="chapter" id="monitoring-configuring-secrets-for-alertmanager_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h1 class="title">Chapter 4. Configuring secrets for Alertmanager</h1></div></div></div><p>
			The OpenShift Container Platform monitoring stack includes Alertmanager, which routes alerts from Prometheus to endpoint receivers. If you need to authenticate with a receiver so that Alertmanager can send alerts to it, you can configure Alertmanager to use a secret that contains authentication credentials for the receiver.
		</p><p>
			For example, you can configure Alertmanager to use a secret to authenticate with an endpoint receiver that requires a certificate issued by a private Certificate Authority (CA). You can also configure Alertmanager to use a secret to authenticate with a receiver that requires a password file for Basic HTTP authentication. In either case, authentication details are contained in the <code class="literal">Secret</code> object rather than in the <code class="literal">ConfigMap</code> object.
		</p><section class="section" id="monitoring-adding-a-secret-to-the-alertmanager-configuration_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">4.1. Adding a secret to the Alertmanager configuration</h2></div></div></div><p>
				You can add secrets to the Alertmanager configuration for core platform monitoring components by editing the <code class="literal">cluster-monitoring-config</code> config map in the <code class="literal">openshift-monitoring</code> project.
			</p><p>
				After you add a secret to the config map, the secret is mounted as a volume at <code class="literal">/etc/alertmanager/secrets/&lt;secret_name&gt;</code> within the <code class="literal">alertmanager</code> container for the Alertmanager pods.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>If you are configuring core OpenShift Container Platform monitoring components in the <code class="literal">openshift-monitoring</code> project</strong></span>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
							</li><li class="listitem">
								You have created the <code class="literal">cluster-monitoring-config</code> config map.
							</li><li class="listitem">
								You have created the secret to be configured in Alertmanager in the <code class="literal">openshift-monitoring</code> project.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>If you are configuring components that monitor user-defined projects</strong></span>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								A cluster administrator has enabled monitoring for user-defined projects.
							</li><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role, or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
							</li><li class="listitem">
								You have created the secret to be configured in Alertmanager in the <code class="literal">openshift-user-workload-monitoring</code> project.
							</li></ul></div></li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">ConfigMap</code> object.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>To add a secret configuration to Alertmanager for core platform monitoring</strong></span>:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Edit the <code class="literal">cluster-monitoring-config</code> config map in the <code class="literal">openshift-monitoring</code> project:
									</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
										Add a <code class="literal">secrets:</code> section under <code class="literal">data/config.yaml/alertmanagerMain</code> with the following configuration:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    alertmanagerMain:
      secrets: <span id="CO34-1"><!--Empty--></span><span class="callout">1</span>
      - &lt;secret_name_1&gt; <span id="CO34-2"><!--Empty--></span><span class="callout">2</span>
      - &lt;secret_name_2&gt;</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO34-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												This section contains the secrets to be mounted into Alertmanager. The secrets must be located within the same namespace as the Alertmanager object.
											</div></dd><dt><a href="#CO34-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												The name of the <code class="literal">Secret</code> object that contains authentication credentials for the receiver. If you add multiple secrets, place each one on a new line.
											</div></dd></dl></div><p class="simpara">
										The following sample config map settings configure Alertmanager to use two <code class="literal">Secret</code> objects named <code class="literal">test-secret-basic-auth</code> and <code class="literal">test-secret-api-token</code>:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    alertmanagerMain:
      secrets:
      - test-secret-basic-auth
      - test-secret-api-token</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>To add a secret configuration to Alertmanager for user-defined project monitoring</strong></span>:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Edit the <code class="literal">user-workload-monitoring-config</code> config map in the <code class="literal">openshift-user-workload-monitoring</code> project:
									</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
										Add a <code class="literal">secrets:</code> section under <code class="literal">data/config.yaml/alertmanager/secrets</code> with the following configuration:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    alertmanager:
      secrets: <span id="CO35-1"><!--Empty--></span><span class="callout">1</span>
      - &lt;secret_name_1&gt; <span id="CO35-2"><!--Empty--></span><span class="callout">2</span>
      - &lt;secret_name_2&gt;</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO35-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												This section contains the secrets to be mounted into Alertmanager. The secrets must be located within the same namespace as the Alertmanager object.
											</div></dd><dt><a href="#CO35-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												The name of the <code class="literal">Secret</code> object that contains authentication credentials for the receiver. If you add multiple secrets, place each one on a new line.
											</div></dd></dl></div><p class="simpara">
										The following sample config map settings configure Alertmanager to use two <code class="literal">Secret</code> objects named <code class="literal">test-secret</code> and <code class="literal">test-secret-api-token</code>:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    alertmanager:
      enabled: true
      secrets:
      - test-secret
      - test-api-receiver-token</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											Configurations applied to the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object are not activated unless a cluster administrator has enabled monitoring for user-defined projects.
										</p></div></div></li></ol></div></li></ul></div></li><li class="listitem">
						Save the file to apply the changes to the <code class="literal">ConfigMap</code> object. The new configuration is applied automatically.
					</li></ol></div></section><section class="section" id="attaching-additional-labels-to-your-time-series-and-alerts_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">4.2. Attaching additional labels to your time series and alerts</h2></div></div></div><p>
				Using the external labels feature of Prometheus, you can attach custom labels to all time series and alerts leaving Prometheus.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>If you are configuring core OpenShift Container Platform monitoring components</strong></span>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
							</li><li class="listitem">
								You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>If you are configuring components that monitor user-defined projects</strong></span>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role, or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
							</li><li class="listitem">
								You have created the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
							</li></ul></div></li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">ConfigMap</code> object:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>To attach custom labels to all time series and alerts leaving the Prometheus instance that monitors core OpenShift Container Platform projects</strong></span>:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> project:
									</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
										Define a map of labels you want to add for every metric under <code class="literal">data/config.yaml</code>:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      externalLabels:
        &lt;key&gt;: &lt;value&gt; <span id="CO36-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO36-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												Substitute <code class="literal">&lt;key&gt;: &lt;value&gt;</code> with a map of key-value pairs where <code class="literal">&lt;key&gt;</code> is a unique name for the new label and <code class="literal">&lt;value&gt;</code> is its value.
											</div></dd></dl></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
											Do not use <code class="literal">prometheus</code> or <code class="literal">prometheus_replica</code> as key names, because they are reserved and will be overwritten.
										</p></div></div><p class="simpara">
										For example, to add metadata about the region and environment to all time series and alerts, use:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      externalLabels:
        region: eu
        environment: prod</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>To attach custom labels to all time series and alerts leaving the Prometheus instance that monitors user-defined projects</strong></span>:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Edit the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project:
									</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
										Define a map of labels you want to add for every metric under <code class="literal">data/config.yaml</code>:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    prometheus:
      externalLabels:
        &lt;key&gt;: &lt;value&gt; <span id="CO37-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO37-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												Substitute <code class="literal">&lt;key&gt;: &lt;value&gt;</code> with a map of key-value pairs where <code class="literal">&lt;key&gt;</code> is a unique name for the new label and <code class="literal">&lt;value&gt;</code> is its value.
											</div></dd></dl></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
											Do not use <code class="literal">prometheus</code> or <code class="literal">prometheus_replica</code> as key names, because they are reserved and will be overwritten.
										</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											In the <code class="literal">openshift-user-workload-monitoring</code> project, Prometheus handles metrics and Thanos Ruler handles alerting and recording rules. Setting <code class="literal">externalLabels</code> for <code class="literal">prometheus</code> in the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object will only configure external labels for metrics and not for any rules.
										</p></div></div><p class="simpara">
										For example, to add metadata about the region and environment to all time series and alerts related to user-defined projects, use:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    prometheus:
      externalLabels:
        region: eu
        environment: prod</pre></li></ol></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Save the file to apply the changes. The new configuration is applied automatically.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Configurations applied to the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object are not activated unless a cluster administrator has enabled monitoring for user-defined projects.
						</p></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							When changes are saved to a monitoring config map, the pods and other resources in the related project might be redeployed. The running monitoring processes in that project might also be restarted.
						</p></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#preparing-to-configure-the-monitoring-stack">Preparing to configure the monitoring stack</a> for steps to create monitoring config maps.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#enabling-monitoring-for-user-defined-projects">Enabling monitoring for user-defined projects</a>
					</li></ul></div></section></section><section class="chapter" id="configuring_pod_topology_spread_constraintsfor_monitoring_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h1 class="title">Chapter 5. Configuring pod topology spread constraints for monitoring</h1></div></div></div><p>
			You can use pod topology spread constraints to control how Prometheus, Thanos Ruler, and Alertmanager pods are spread across a network topology when OpenShift Container Platform pods are deployed in multiple availability zones.
		</p><p>
			Pod topology spread constraints are suitable for controlling pod scheduling within hierarchical topologies in which nodes are spread across different infrastructure levels, such as regions and zones within those regions. Additionally, by being able to schedule pods in different zones, you can improve network latency in certain scenarios.
		</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-scheduler-pod-topology-spread-constraints-about">Controlling pod placement by using pod topology spread constraints</a>
				</li><li class="listitem">
					<a class="link" href="https://kubernetes.io/docs/concepts/scheduling-eviction/topology-spread-constraints/">Kubernetes Pod Topology Spread Constraints documentation</a>
				</li></ul></div><section class="section" id="setting-up-pod-topology-spread-constraints-for-prometheus_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">5.1. Setting up pod topology spread constraints for Prometheus</h2></div></div></div><p>
				For core OpenShift Container Platform platform monitoring, you can set up pod topology spread constraints for Prometheus to fine tune how pod replicas are scheduled to nodes across zones. Doing so helps ensure that Prometheus pods are highly available and run more efficiently, because workloads are spread across nodes in different data centers or hierarchical infrastructure zones.
			</p><p>
				You configure pod topology spread constraints for Prometheus in the <code class="literal">cluster-monitoring-config</code> config map.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
					</li><li class="listitem">
						You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
					</li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> namespace:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
						Add values for the following settings under <code class="literal">data/config.yaml/prometheusK8s</code> to configure pod topology spread constraints:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      topologySpreadConstraints:
      - maxSkew: 1 <span id="CO38-1"><!--Empty--></span><span class="callout">1</span>
        topologyKey: monitoring <span id="CO38-2"><!--Empty--></span><span class="callout">2</span>
        whenUnsatisfiable: DoNotSchedule <span id="CO38-3"><!--Empty--></span><span class="callout">3</span>
        labelSelector:
          matchLabels: <span id="CO38-4"><!--Empty--></span><span class="callout">4</span>
            app.kubernetes.io/name: prometheus</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO38-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Specify a numeric value for <code class="literal">maxSkew</code>, which defines the degree to which pods are allowed to be unevenly distributed. This field is required, and the value must be greater than zero. The value specified has a different effect depending on what value you specify for <code class="literal">whenUnsatisfiable</code>.
							</div></dd><dt><a href="#CO38-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Specify a key of node labels for <code class="literal">topologyKey</code>. This field is required. Nodes that have a label with this key and identical values are considered to be in the same topology. The scheduler will try to put a balanced number of pods into each domain.
							</div></dd><dt><a href="#CO38-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								Specify a value for <code class="literal">whenUnsatisfiable</code>. This field is required. Available options are <code class="literal">DoNotSchedule</code> and <code class="literal">ScheduleAnyway</code>. Specify <code class="literal">DoNotSchedule</code> if you want the <code class="literal">maxSkew</code> value to define the maximum difference allowed between the number of matching pods in the target topology and the global minimum. Specify <code class="literal">ScheduleAnyway</code> if you want the scheduler to still schedule the pod but to give higher priority to nodes that might reduce the skew.
							</div></dd><dt><a href="#CO38-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								Specify a value for <code class="literal">matchLabels</code>. This value is used to identify the set of matching pods to which to apply the constraints.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Save the file to apply the changes automatically.
					</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							When you save changes to the <code class="literal">cluster-monitoring-config</code> config map, the pods and other resources in the <code class="literal">openshift-monitoring</code> project might be redeployed. The running monitoring processes in that project might also restart.
						</p></div></div></li></ol></div></section><section class="section" id="setting-up-pod-topology-spread-constraints-for-alertmanager_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">5.2. Setting up pod topology spread constraints for Alertmanager</h2></div></div></div><p>
				For core OpenShift Container Platform platform monitoring, you can set up pod topology spread constraints for Alertmanager to fine tune how pod replicas are scheduled to nodes across zones. Doing so helps ensure that Alertmanager pods are highly available and run more efficiently, because workloads are spread across nodes in different data centers or hierarchical infrastructure zones.
			</p><p>
				You configure pod topology spread constraints for Alertmanager in the <code class="literal">cluster-monitoring-config</code> config map.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
					</li><li class="listitem">
						You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
					</li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> namespace:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
						Add values for the following settings under <code class="literal">data/config.yaml/alertmanagermain</code> to configure pod topology spread constraints:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    alertmanagerMain:
      topologySpreadConstraints:
      - maxSkew: 1 <span id="CO39-1"><!--Empty--></span><span class="callout">1</span>
        topologyKey: monitoring <span id="CO39-2"><!--Empty--></span><span class="callout">2</span>
        whenUnsatisfiable: DoNotSchedule <span id="CO39-3"><!--Empty--></span><span class="callout">3</span>
        labelSelector:
          matchLabels: <span id="CO39-4"><!--Empty--></span><span class="callout">4</span>
            app.kubernetes.io/name: alertmanager</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO39-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Specify a numeric value for <code class="literal">maxSkew</code>, which defines the degree to which pods are allowed to be unevenly distributed. This field is required, and the value must be greater than zero. The value specified has a different effect depending on what value you specify for <code class="literal">whenUnsatisfiable</code>.
							</div></dd><dt><a href="#CO39-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Specify a key of node labels for <code class="literal">topologyKey</code>. This field is required. Nodes that have a label with this key and identical values are considered to be in the same topology. The scheduler will try to put a balanced number of pods into each domain.
							</div></dd><dt><a href="#CO39-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								Specify a value for <code class="literal">whenUnsatisfiable</code>. This field is required. Available options are <code class="literal">DoNotSchedule</code> and <code class="literal">ScheduleAnyway</code>. Specify <code class="literal">DoNotSchedule</code> if you want the <code class="literal">maxSkew</code> value to define the maximum difference allowed between the number of matching pods in the target topology and the global minimum. Specify <code class="literal">ScheduleAnyway</code> if you want the scheduler to still schedule the pod but to give higher priority to nodes that might reduce the skew.
							</div></dd><dt><a href="#CO39-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								Specify a value for <code class="literal">matchLabels</code>. This value is used to identify the set of matching pods to which to apply the constraints.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Save the file to apply the changes automatically.
					</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							When you save changes to the <code class="literal">cluster-monitoring-config</code> config map, the pods and other resources in the <code class="literal">openshift-monitoring</code> project might be redeployed. The running monitoring processes in that project might also restart.
						</p></div></div></li></ol></div></section><section class="section" id="setting-up-pod-topology-spread-constraints-for-thanos-ruler_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">5.3. Setting up pod topology spread constraints for Thanos Ruler</h2></div></div></div><p>
				For user-defined monitoring, you can set up pod topology spread constraints for Thanos Ruler to fine tune how pod replicas are scheduled to nodes across zones. Doing so helps ensure that Thanos Ruler pods are highly available and run more efficiently, because workloads are spread across nodes in different data centers or hierarchical infrastructure zones.
			</p><p>
				You configure pod topology spread constraints for Thanos Ruler in the <code class="literal">user-workload-monitoring-config</code> config map.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A cluster administrator has enabled monitoring for user-defined projects.
					</li><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role, or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
					</li><li class="listitem">
						You have created the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
					</li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">user-workload-monitoring-config</code> config map in the <code class="literal">openshift-user-workload-monitoring</code> namespace:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
						Add values for the following settings under <code class="literal">data/config.yaml/thanosRuler</code> to configure pod topology spread constraints:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    thanosRuler:
      topologySpreadConstraints:
      - maxSkew: 1 <span id="CO40-1"><!--Empty--></span><span class="callout">1</span>
        topologyKey: monitoring <span id="CO40-2"><!--Empty--></span><span class="callout">2</span>
        whenUnsatisfiable: ScheduleAnyway <span id="CO40-3"><!--Empty--></span><span class="callout">3</span>
        labelSelector:
          matchLabels: <span id="CO40-4"><!--Empty--></span><span class="callout">4</span>
            app.kubernetes.io/name: thanos-ruler</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO40-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Specify a numeric value for <code class="literal">maxSkew</code>, which defines the degree to which pods are allowed to be unevenly distributed. This field is required, and the value must be greater than zero. The value specified has a different effect depending on what value you specify for <code class="literal">whenUnsatisfiable</code>.
							</div></dd><dt><a href="#CO40-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Specify a key of node labels for <code class="literal">topologyKey</code>. This field is required. Nodes that have a label with this key and identical values are considered to be in the same topology. The scheduler will try to put a balanced number of pods into each domain.
							</div></dd><dt><a href="#CO40-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								Specify a value for <code class="literal">whenUnsatisfiable</code>. This field is required. Available options are <code class="literal">DoNotSchedule</code> and <code class="literal">ScheduleAnyway</code>. Specify <code class="literal">DoNotSchedule</code> if you want the <code class="literal">maxSkew</code> value to define the maximum difference allowed between the number of matching pods in the target topology and the global minimum. Specify <code class="literal">ScheduleAnyway</code> if you want the scheduler to still schedule the pod but to give higher priority to nodes that might reduce the skew.
							</div></dd><dt><a href="#CO40-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								Specify a value for <code class="literal">matchLabels</code>. This value is used to identify the set of matching pods to which to apply the constraints.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Save the file to apply the changes automatically.
					</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							When you save changes to the <code class="literal">user-workload-monitoring-config</code> config map, the pods and other resources in the <code class="literal">openshift-user-workload-monitoring</code> project might be redeployed. The running monitoring processes in that project might also restart.
						</p></div></div></li></ol></div></section><section class="section" id="setting-log-levels-for-monitoring-components_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">5.4. Setting log levels for monitoring components</h2></div></div></div><p>
				You can configure the log level for Alertmanager, Prometheus Operator, Prometheus, Thanos Querier, and Thanos Ruler.
			</p><p>
				The following log levels can be applied to the relevant component in the <code class="literal">cluster-monitoring-config</code> and <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> objects:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">debug</code>. Log debug, informational, warning, and error messages.
					</li><li class="listitem">
						<code class="literal">info</code>. Log informational, warning, and error messages.
					</li><li class="listitem">
						<code class="literal">warn</code>. Log warning and error messages only.
					</li><li class="listitem">
						<code class="literal">error</code>. Log error messages only.
					</li></ul></div><p>
				The default log level is <code class="literal">info</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>If you are setting a log level for Alertmanager, Prometheus Operator, Prometheus, or Thanos Querier in the <code class="literal">openshift-monitoring</code> project</strong></span>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
							</li><li class="listitem">
								You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>If you are setting a log level for Prometheus Operator, Prometheus, or Thanos Ruler in the <code class="literal">openshift-user-workload-monitoring</code> project</strong></span>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role, or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
							</li><li class="listitem">
								You have created the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
							</li></ul></div></li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">ConfigMap</code> object:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>To set a log level for a component in the <code class="literal">openshift-monitoring</code> project</strong></span>:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> project:
									</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
										Add <code class="literal">logLevel: &lt;log_level&gt;</code> for a component under <code class="literal">data/config.yaml</code>:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    &lt;component&gt;: <span id="CO41-1"><!--Empty--></span><span class="callout">1</span>
      logLevel: &lt;log_level&gt; <span id="CO41-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO41-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												The monitoring stack component for which you are setting a log level. For default platform monitoring, available component values are <code class="literal">prometheusK8s</code>, <code class="literal">alertmanagerMain</code>, <code class="literal">prometheusOperator</code>, and <code class="literal">thanosQuerier</code>.
											</div></dd><dt><a href="#CO41-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												The log level to set for the component. The available values are <code class="literal">error</code>, <code class="literal">warn</code>, <code class="literal">info</code>, and <code class="literal">debug</code>. The default value is <code class="literal">info</code>.
											</div></dd></dl></div></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>To set a log level for a component in the <code class="literal">openshift-user-workload-monitoring</code> project</strong></span>:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Edit the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project:
									</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
										Add <code class="literal">logLevel: &lt;log_level&gt;</code> for a component under <code class="literal">data/config.yaml</code>:
									</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    &lt;component&gt;: <span id="CO42-1"><!--Empty--></span><span class="callout">1</span>
      logLevel: &lt;log_level&gt; <span id="CO42-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO42-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												The monitoring stack component for which you are setting a log level. For user workload monitoring, available component values are <code class="literal">alertmanager</code>, <code class="literal">prometheus</code>, <code class="literal">prometheusOperator</code>, and <code class="literal">thanosRuler</code>.
											</div></dd><dt><a href="#CO42-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												The log level to apply to the component. The available values are <code class="literal">error</code>, <code class="literal">warn</code>, <code class="literal">info</code>, and <code class="literal">debug</code>. The default value is <code class="literal">info</code>.
											</div></dd></dl></div></li></ol></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Save the file to apply the changes. The pods for the component restart automatically when you apply the log-level change.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Configurations applied to the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object are not activated unless a cluster administrator has enabled monitoring for user-defined projects.
						</p></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							When changes are saved to a monitoring config map, the pods and other resources in the related project might be redeployed. The running monitoring processes in that project might also be restarted.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Confirm that the log-level has been applied by reviewing the deployment or pod configuration in the related project. The following example checks the log level in the <code class="literal">prometheus-operator</code> deployment in the <code class="literal">openshift-user-workload-monitoring</code> project:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring get deploy prometheus-operator -o yaml | grep "log-level"</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">        - --log-level=debug</pre>

						</p></div></li><li class="listitem"><p class="simpara">
						Check that the pods for the component are running. The following example lists the status of pods in the <code class="literal">openshift-user-workload-monitoring</code> project:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring get pods</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If an unrecognized <code class="literal">logLevel</code> value is included in the <code class="literal">ConfigMap</code> object, the pods for the component might not restart successfully.
						</p></div></div></li></ol></div></section><section class="section" id="setting-query-log-file-for-prometheus_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">5.5. Enabling the query log file for Prometheus</h2></div></div></div><p class="_abstract _abstract">
				You can configure Prometheus to write all queries that have been run by the engine to a log file. You can do so for default platform monitoring and for user-defined workload monitoring.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Because log rotation is not supported, only enable this feature temporarily when you need to troubleshoot an issue. After you finish troubleshooting, disable query logging by reverting the changes you made to the <code class="literal">ConfigMap</code> object to enable the feature.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>If you are enabling the query log file feature for Prometheus in the <code class="literal">openshift-monitoring</code> project</strong></span>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
							</li><li class="listitem">
								You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>If you are enabling the query log file feature for Prometheus in the <code class="literal">openshift-user-workload-monitoring</code> project</strong></span>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role, or as a user with the <code class="literal">user-workload-monitoring-config-edit</code> role in the <code class="literal">openshift-user-workload-monitoring</code> project.
							</li><li class="listitem">
								You have created the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
							</li></ul></div></li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>To set the query log file for Prometheus in the <code class="literal">openshift-monitoring</code> project</strong></span>:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> project:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
								Add <code class="literal">queryLogFile: &lt;path&gt;</code> for <code class="literal">prometheusK8s</code> under <code class="literal">data/config.yaml</code>:
							</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    prometheusK8s:
      queryLogFile: &lt;path&gt; <span id="CO43-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO43-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										The full path to the file in which queries will be logged.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Save the file to apply the changes.
							</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
									When you save changes to a monitoring config map, pods and other resources in the related project might be redeployed. The running monitoring processes in that project might also be restarted.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Verify that the pods for the component are running. The following sample command lists the status of pods in the <code class="literal">openshift-monitoring</code> project:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring get pods</pre></li><li class="listitem"><p class="simpara">
								Read the query log:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring exec prometheus-k8s-0 -- cat &lt;path&gt;</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									Revert the setting in the config map after you have examined the logged query information.
								</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>To set the query log file for Prometheus in the <code class="literal">openshift-user-workload-monitoring</code> project</strong></span>:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Edit the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
								Add <code class="literal">queryLogFile: &lt;path&gt;</code> for <code class="literal">prometheus</code> under <code class="literal">data/config.yaml</code>:
							</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    prometheus:
      queryLogFile: &lt;path&gt; <span id="CO44-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO44-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										The full path to the file in which queries will be logged.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Save the file to apply the changes.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Configurations applied to the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object are not activated unless a cluster administrator has enabled monitoring for user-defined projects.
								</p></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
									When you save changes to a monitoring config map, pods and other resources in the related project might be redeployed. The running monitoring processes in that project might also be restarted.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Verify that the pods for the component are running. The following example command lists the status of pods in the <code class="literal">openshift-user-workload-monitoring</code> project:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring get pods</pre></li><li class="listitem"><p class="simpara">
								Read the query log:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring exec prometheus-user-workload-0 -- cat &lt;path&gt;</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									Revert the setting in the config map after you have examined the logged query information.
								</p></div></div></li></ol></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#preparing-to-configure-the-monitoring-stack">Preparing to configure the monitoring stack</a> for steps to create monitoring config maps
					</li><li class="listitem">
						See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#enabling-monitoring-for-user-defined-projects">Enabling monitoring for user-defined projects</a> for steps to enable user-defined monitoring.
					</li></ul></div></section><section class="section" id="enabling-query-logging-for-thanos-querier_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">5.6. Enabling query logging for Thanos Querier</h2></div></div></div><p class="_abstract _abstract">
				For default platform monitoring in the <code class="literal">openshift-monitoring</code> project, you can enable the Cluster Monitoring Operator to log all queries run by Thanos Querier.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Because log rotation is not supported, only enable this feature temporarily when you need to troubleshoot an issue. After you finish troubleshooting, disable query logging by reverting the changes you made to the <code class="literal">ConfigMap</code> object to enable the feature.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
					</li><li class="listitem">
						You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					You can enable query logging for Thanos Querier in the <code class="literal">openshift-monitoring</code> project:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> project:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
						Add a <code class="literal">thanosQuerier</code> section under <code class="literal">data/config.yaml</code> and add values as shown in the following example:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    thanosQuerier:
      enableRequestLogging: &lt;value&gt; <span id="CO45-1"><!--Empty--></span><span class="callout">1</span>
      logLevel: &lt;value&gt; <span id="CO45-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO45-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Set the value to <code class="literal">true</code> to enable logging and <code class="literal">false</code> to disable logging. The default value is <code class="literal">false</code>.
							</div></dd><dt><a href="#CO45-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Set the value to <code class="literal">debug</code>, <code class="literal">info</code>, <code class="literal">warn</code>, or <code class="literal">error</code>. If no value exists for <code class="literal">logLevel</code>, the log level defaults to <code class="literal">error</code>.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Save the file to apply the changes.
					</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							When you save changes to a monitoring config map, pods and other resources in the related project might be redeployed. The running monitoring processes in that project might also be restarted.
						</p></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that the Thanos Querier pods are running. The following sample command lists the status of pods in the <code class="literal">openshift-monitoring</code> project:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring get pods</pre></li><li class="listitem"><p class="simpara">
						Run a test query using the following sample commands as a model:
					</p><pre class="programlisting language-terminal">$ token=`oc create token prometheus-k8s -n openshift-monitoring`
$ oc -n openshift-monitoring exec -c prometheus prometheus-k8s-0 -- curl -k -H "Authorization: Bearer $token" 'https://thanos-querier.openshift-monitoring.svc:9091/api/v1/query?query=cluster_version'</pre></li><li class="listitem"><p class="simpara">
						Run the following command to read the query log:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring logs &lt;thanos_querier_pod_name&gt; -c thanos-query</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Because the <code class="literal">thanos-querier</code> pods are highly available (HA) pods, you might be able to see logs in only one pod.
						</p></div></div></li><li class="listitem">
						After you examine the logged query information, disable query logging by changing the <code class="literal">enableRequestLogging</code> value to <code class="literal">false</code> in the config map.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#preparing-to-configure-the-monitoring-stack">Preparing to configure the monitoring stack</a> for steps to create monitoring config maps.
					</li></ul></div></section></section><section class="chapter" id="setting-audit-log-levels-for-the-prometheus-adapter_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h1 class="title">Chapter 6. Setting audit log levels for the Prometheus Adapter</h1></div></div></div><p class="_abstract _abstract">
			In default platform monitoring, you can configure the audit log level for the Prometheus Adapter.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					You have installed the OpenShift CLI (<code class="literal">oc</code>).
				</li><li class="listitem">
					You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
				</li><li class="listitem">
					You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
				</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
				You can set an audit log level for the Prometheus Adapter in the default <code class="literal">openshift-monitoring</code> project:
			</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
					Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-monitoring</code> project:
				</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
					Add <code class="literal">profile:</code> in the <code class="literal">k8sPrometheusAdapter/audit</code> section under <code class="literal">data/config.yaml</code>:
				</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    k8sPrometheusAdapter:
      audit:
        profile: &lt;audit_log_level&gt; <span id="CO46-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO46-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							The audit log level to apply to the Prometheus Adapter.
						</div></dd></dl></div></li><li class="listitem"><p class="simpara">
					Set the audit log level by using one of the following values for the <code class="literal">profile:</code> parameter:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">None</code>: Do not log events.
						</li><li class="listitem">
							<code class="literal">Metadata</code>: Log only the metadata for the request, such as user, timestamp, and so forth. Do not log the request text and the response text. <code class="literal">Metadata</code> is the default audit log level.
						</li><li class="listitem">
							<code class="literal">Request</code>: Log only the metadata and the request text but not the response text. This option does not apply for non-resource requests.
						</li><li class="listitem">
							<code class="literal">RequestResponse</code>: Log event metadata, request text, and response text. This option does not apply for non-resource requests.
						</li></ul></div></li><li class="listitem"><p class="simpara">
					Save the file to apply the changes. The pods for the Prometheus Adapter restart automatically when you apply the change.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						When changes are saved to a monitoring config map, the pods and other resources in the related project might be redeployed. The running monitoring processes in that project might also be restarted.
					</p></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
					In the config map, under <code class="literal">k8sPrometheusAdapter/audit/profile</code>, set the log level to <code class="literal">Request</code> and save the file.
				</li><li class="listitem"><p class="simpara">
					Confirm that the pods for the Prometheus Adapter are running. The following example lists the status of pods in the <code class="literal">openshift-monitoring</code> project:
				</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring get pods</pre></li><li class="listitem"><p class="simpara">
					Confirm that the audit log level and audit log file path are correctly configured:
				</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring get deploy prometheus-adapter -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">...
  - --audit-policy-file=/etc/audit/request-profile.yaml
  - --audit-log-path=/var/log/adapter/audit.log</pre>

					</p></div></li><li class="listitem"><p class="simpara">
					Confirm that the correct log level has been applied in the <code class="literal">prometheus-adapter</code> deployment in the <code class="literal">openshift-monitoring</code> project:
				</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring exec deploy/prometheus-adapter -c prometheus-adapter -- cat /etc/audit/request-profile.yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">"apiVersion": "audit.k8s.io/v1"
"kind": "Policy"
"metadata":
  "name": "Request"
"omitStages":
- "RequestReceived"
"rules":
- "level": "Request"</pre>

					</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you enter an unrecognized <code class="literal">profile</code> value for the Prometheus Adapter in the <code class="literal">ConfigMap</code> object, no changes are made to the Prometheus Adapter, and an error is logged by the Cluster Monitoring Operator.
					</p></div></div></li><li class="listitem"><p class="simpara">
					Review the audit log for the Prometheus Adapter:
				</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring exec -c &lt;prometheus_adapter_pod_name&gt; -- cat /var/log/adapter/audit.log</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
					See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#preparing-to-configure-the-monitoring-stack">Preparing to configure the monitoring stack</a> for steps to create monitoring config maps.
				</li></ul></div><section class="section" id="monitoring-disabling-the-local-alertmanager_configuring-the-monitoring-stack"><div class="titlepage"><div><div><h2 class="title">6.1. Disabling the local Alertmanager</h2></div></div></div><p>
				A local Alertmanager that routes alerts from Prometheus instances is enabled by default in the <code class="literal">openshift-monitoring</code> project of the OpenShift Container Platform monitoring stack.
			</p><p>
				If you do not need the local Alertmanager, you can disable it by configuring the <code class="literal">cluster-monitoring-config</code> config map in the <code class="literal">openshift-monitoring</code> project.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
					</li><li class="listitem">
						You have created the <code class="literal">cluster-monitoring-config</code> config map.
					</li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">cluster-monitoring-config</code> config map in the <code class="literal">openshift-monitoring</code> project:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
						Add <code class="literal">enabled: false</code> for the <code class="literal">alertmanagerMain</code> component under <code class="literal">data/config.yaml</code>:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    alertmanagerMain:
      enabled: false</pre></li><li class="listitem">
						Save the file to apply the changes. The Alertmanager instance is disabled automatically when you apply the change.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://prometheus.io/docs/alerting/latest/alertmanager/">Prometheus Alertmanager documentation</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#">Managing alerts</a>
					</li></ul></div></section><section class="section" id="next-steps"><div class="titlepage"><div><div><h2 class="title">6.2. Next steps</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#enabling-monitoring-for-user-defined-projects">Enabling monitoring for user-defined projects</a>
					</li><li class="listitem">
						Learn about <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/support/#opting-out-remote-health-reporting_opting-out-remote-health-reporting">remote health reporting</a> and, if necessary, opt out of it.
					</li></ul></div></section></section><section class="chapter" id="enabling-monitoring-for-user-defined-projects"><div class="titlepage"><div><div><h1 class="title">Chapter 7. Enabling monitoring for user-defined projects</h1></div></div></div><p>
			In OpenShift Container Platform 4.13, you can enable monitoring for user-defined projects in addition to the default platform monitoring. You can monitor your own projects in OpenShift Container Platform without the need for an additional monitoring solution. Using this feature centralizes monitoring for core platform components and user-defined projects.
		</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				Versions of Prometheus Operator installed using Operator Lifecycle Manager (OLM) are not compatible with user-defined monitoring. Therefore, custom Prometheus instances installed as a Prometheus custom resource (CR) managed by the OLM Prometheus Operator are not supported in OpenShift Container Platform.
			</p></div></div><section class="section" id="enabling-monitoring-for-user-defined-projects_enabling-monitoring-for-user-defined-projects"><div class="titlepage"><div><div><h2 class="title">7.1. Enabling monitoring for user-defined projects</h2></div></div></div><p>
				Cluster administrators can enable monitoring for user-defined projects by setting the <code class="literal">enableUserWorkload: true</code> field in the cluster monitoring <code class="literal">ConfigMap</code> object.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					In OpenShift Container Platform 4.13 you must remove any custom Prometheus instances before enabling monitoring for user-defined projects.
				</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You must have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role to enable monitoring for user-defined projects in OpenShift Container Platform. Cluster administrators can then optionally grant users permission to configure the components that are responsible for monitoring user-defined projects.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
					</li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li><li class="listitem">
						You have created the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object.
					</li><li class="listitem"><p class="simpara">
						You have optionally created and configured the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project. You can add configuration options to this <code class="literal">ConfigMap</code> object for the components that monitor user-defined projects.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Every time you save configuration changes to the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object, the pods in the <code class="literal">openshift-user-workload-monitoring</code> project are redeployed. It can sometimes take a while for these components to redeploy. You can create and configure the <code class="literal">ConfigMap</code> object before you first enable monitoring for user-defined projects, to prevent having to redeploy the pods often.
						</p></div></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
						Add <code class="literal">enableUserWorkload: true</code> under <code class="literal">data/config.yaml</code>:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    enableUserWorkload: true <span id="CO47-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO47-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								When set to <code class="literal">true</code>, the <code class="literal">enableUserWorkload</code> parameter enables monitoring for user-defined projects in a cluster.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Save the file to apply the changes. Monitoring for user-defined projects is then enabled automatically.
					</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							When changes are saved to the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object, the pods and other resources in the <code class="literal">openshift-monitoring</code> project might be redeployed. The running monitoring processes in that project might also be restarted.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Check that the <code class="literal">prometheus-operator</code>, <code class="literal">prometheus-user-workload</code> and <code class="literal">thanos-ruler-user-workload</code> pods are running in the <code class="literal">openshift-user-workload-monitoring</code> project. It might take a short while for the pods to start:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring get pod</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">NAME                                   READY   STATUS        RESTARTS   AGE
prometheus-operator-6f7b748d5b-t7nbg   2/2     Running       0          3h
prometheus-user-workload-0             4/4     Running       1          3h
prometheus-user-workload-1             4/4     Running       1          3h
thanos-ruler-user-workload-0           3/3     Running       0          3h
thanos-ruler-user-workload-1           3/3     Running       0          3h</pre>

						</p></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#creating-cluster-monitoring-configmap_configuring-the-monitoring-stack">Creating a cluster monitoring config map</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#configuring-the-monitoring-stack">Configuring the monitoring stack</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#granting-users-permission-to-configure-monitoring-for-user-defined-projects_enabling-monitoring-for-user-defined-projects">Granting users permission to configure monitoring for user-defined projects</a>
					</li></ul></div></section><section class="section" id="granting-users-permission-to-monitor-user-defined-projects_enabling-monitoring-for-user-defined-projects"><div class="titlepage"><div><div><h2 class="title">7.2. Granting users permission to monitor user-defined projects</h2></div></div></div><p>
				Cluster administrators can monitor all core OpenShift Container Platform and user-defined projects.
			</p><p>
				Cluster administrators can grant developers and other users permission to monitor their own projects. Privileges are granted by assigning one of the following monitoring roles:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <span class="strong strong"><strong>monitoring-rules-view</strong></span> cluster role provides read access to <code class="literal">PrometheusRule</code> custom resources for a project.
					</li><li class="listitem">
						The <span class="strong strong"><strong>monitoring-rules-edit</strong></span> cluster role grants a user permission to create, modify, and deleting <code class="literal">PrometheusRule</code> custom resources for a project.
					</li><li class="listitem">
						The <span class="strong strong"><strong>monitoring-edit</strong></span> cluster role grants the same privileges as the <code class="literal">monitoring-rules-edit</code> cluster role. Additionally, it enables a user to create new scrape targets for services or pods. With this role, you can also create, modify, and delete <code class="literal">ServiceMonitor</code> and <code class="literal">PodMonitor</code> resources.
					</li></ul></div><p>
				You can also grant users permission to configure the components that are responsible for monitoring user-defined projects:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <span class="strong strong"><strong>user-workload-monitoring-config-edit</strong></span> role in the <code class="literal">openshift-user-workload-monitoring</code> project enables you to edit the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object. With this role, you can edit the <code class="literal">ConfigMap</code> object to configure Prometheus, Prometheus Operator, and Thanos Ruler for user-defined workload monitoring.
					</li></ul></div><p>
				You can also grant users permission to configure alert routing for user-defined projects:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <span class="strong strong"><strong>alert-routing-edit</strong></span> cluster role grants a user permission to create, update, and delete <code class="literal">AlertmanagerConfig</code> custom resources for a project.
					</li></ul></div><p>
				This section provides details on how to assign these roles by using the OpenShift Container Platform web console or the CLI.
			</p><section class="section" id="granting-user-permissions-using-the-web-console_enabling-monitoring-for-user-defined-projects"><div class="titlepage"><div><div><h3 class="title">7.2.1. Granting user permissions by using the web console</h3></div></div></div><p>
					You can grant users permissions to monitor their own projects, by using the OpenShift Container Platform web console.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
						</li><li class="listitem">
							The user account that you are assigning the role to already exists.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the <span class="strong strong"><strong>Administrator</strong></span> perspective within the OpenShift Container Platform web console, navigate to <span class="strong strong"><strong>User Management</strong></span> → <span class="strong strong"><strong>RoleBindings</strong></span> → <span class="strong strong"><strong>Create binding</strong></span>.
						</li><li class="listitem">
							In the <span class="strong strong"><strong>Binding Type</strong></span> section, select the "Namespace Role Binding" type.
						</li><li class="listitem">
							In the <span class="strong strong"><strong>Name</strong></span> field, enter a name for the role binding.
						</li><li class="listitem"><p class="simpara">
							In the <span class="strong strong"><strong>Namespace</strong></span> field, select the user-defined project where you want to grant the access.
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								The monitoring role will be bound to the project that you apply in the <span class="strong strong"><strong>Namespace</strong></span> field. The permissions that you grant to a user by using this procedure will apply only to the selected project.
							</p></div></div></li><li class="listitem">
							Select <code class="literal">monitoring-rules-view</code>, <code class="literal">monitoring-rules-edit</code>, or <code class="literal">monitoring-edit</code> in the <span class="strong strong"><strong>Role Name</strong></span> list.
						</li><li class="listitem">
							In the <span class="strong strong"><strong>Subject</strong></span> section, select <span class="strong strong"><strong>User</strong></span>.
						</li><li class="listitem">
							In the <span class="strong strong"><strong>Subject Name</strong></span> field, enter the name of the user.
						</li><li class="listitem">
							Select <span class="strong strong"><strong>Create</strong></span> to apply the role binding.
						</li></ol></div></section><section class="section" id="granting-user-permissions-using-the-cli_enabling-monitoring-for-user-defined-projects"><div class="titlepage"><div><div><h3 class="title">7.2.2. Granting user permissions by using the CLI</h3></div></div></div><p>
					You can grant users permissions to monitor their own projects, by using the OpenShift CLI (<code class="literal">oc</code>).
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
						</li><li class="listitem">
							The user account that you are assigning the role to already exists.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Assign a monitoring role to a user for a project:
						</p><pre class="programlisting language-terminal">$ oc policy add-role-to-user &lt;role&gt; &lt;user&gt; -n &lt;namespace&gt; <span id="CO48-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO48-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Substitute <code class="literal">&lt;role&gt;</code> with <code class="literal">monitoring-rules-view</code>, <code class="literal">monitoring-rules-edit</code>, or <code class="literal">monitoring-edit</code>.
								</div></dd></dl></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								Whichever role you choose, you must bind it against a specific project as a cluster administrator.
							</p></div></div><p class="simpara">
							As an example, substitute <code class="literal">&lt;role&gt;</code> with <code class="literal">monitoring-edit</code>, <code class="literal">&lt;user&gt;</code> with <code class="literal">johnsmith</code>, and <code class="literal">&lt;namespace&gt;</code> with <code class="literal">ns1</code>. This assigns the user <code class="literal">johnsmith</code> permission to set up metrics collection and to create alerting rules in the <code class="literal">ns1</code> namespace.
						</p></li></ul></div></section></section><section class="section" id="granting-users-permission-to-configure-monitoring-for-user-defined-projects_enabling-monitoring-for-user-defined-projects"><div class="titlepage"><div><div><h2 class="title">7.3. Granting users permission to configure monitoring for user-defined projects</h2></div></div></div><p>
				You can grant users permission to configure monitoring for user-defined projects.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
					</li><li class="listitem">
						The user account that you are assigning the role to already exists.
					</li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Assign the <code class="literal">user-workload-monitoring-config-edit</code> role to a user in the <code class="literal">openshift-user-workload-monitoring</code> project:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring adm policy add-role-to-user \
  user-workload-monitoring-config-edit &lt;user&gt; \
  --role-namespace openshift-user-workload-monitoring</pre></li></ul></div></section><section class="section" id="accessing-metrics-from-outside-cluster_enabling-monitoring-for-user-defined-projects"><div class="titlepage"><div><div><h2 class="title">7.4. Accessing metrics from outside the cluster for custom applications</h2></div></div></div><p>
				Learn how to query Prometheus statistics from the command line when monitoring your own services. You can access monitoring data from outside the cluster with the <code class="literal">thanos-querier</code> route.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You deployed your own service, following the <span class="emphasis"><em>Enabling monitoring for user-defined projects</em></span> procedure.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Extract a token to connect to Prometheus:
					</p><pre class="programlisting language-terminal">$ SECRET=`oc get secret -n openshift-user-workload-monitoring | grep  prometheus-user-workload-token | head -n 1 | awk '{print $1 }'`</pre><pre class="programlisting language-terminal">$ TOKEN=`echo $(oc get secret $SECRET -n openshift-user-workload-monitoring -o json | jq -r '.data.token') | base64 -d`</pre></li><li class="listitem"><p class="simpara">
						Extract your route host:
					</p><pre class="programlisting language-terminal">$ THANOS_QUERIER_HOST=`oc get route thanos-querier -n openshift-monitoring -o json | jq -r '.spec.host'`</pre></li><li class="listitem"><p class="simpara">
						Query the metrics of your own services in the command line. For example:
					</p><pre class="programlisting language-terminal">$ NAMESPACE=ns1</pre><pre class="programlisting language-terminal">$ curl -X GET -kG "https://$THANOS_QUERIER_HOST/api/v1/query?" --data-urlencode "query=up{namespace='$NAMESPACE'}" -H "Authorization: Bearer $TOKEN"</pre><p class="simpara">
						The output will show you the duration that your application pods have been up.
					</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">{"status":"success","data":{"resultType":"vector","result":[{"metric":{"__name__":"up","endpoint":"web","instance":"10.129.0.46:8080","job":"prometheus-example-app","namespace":"ns1","pod":"prometheus-example-app-68d47c4fb6-jztp2","service":"prometheus-example-app"},"value":[1591881154.748,"1"]}]}}</pre>

						</p></div></li></ol></div></section><section class="section" id="excluding-a-user-defined-project-from-monitoring_enabling-monitoring-for-user-defined-projects"><div class="titlepage"><div><div><h2 class="title">7.5. Excluding a user-defined project from monitoring</h2></div></div></div><p>
				Individual user-defined projects can be excluded from user workload monitoring. To do so, add the <code class="literal">openshift.io/user-monitoring</code> label to the project’s namespace with a value of <code class="literal">false</code>.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Add the label to the project namespace:
					</p><pre class="programlisting language-terminal">$ oc label namespace my-project 'openshift.io/user-monitoring=false'</pre></li><li class="listitem"><p class="simpara">
						To re-enable monitoring, remove the label from the namespace:
					</p><pre class="programlisting language-terminal">$ oc label namespace my-project 'openshift.io/user-monitoring-'</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If there were any active monitoring targets for the project, it may take a few minutes for Prometheus to stop scraping them after adding the label.
						</p></div></div></li></ol></div></section><section class="section" id="disabling-monitoring-for-user-defined-projects_enabling-monitoring-for-user-defined-projects"><div class="titlepage"><div><div><h2 class="title">7.6. Disabling monitoring for user-defined projects</h2></div></div></div><p>
				After enabling monitoring for user-defined projects, you can disable it again by setting <code class="literal">enableUserWorkload: false</code> in the cluster monitoring <code class="literal">ConfigMap</code> object.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Alternatively, you can remove <code class="literal">enableUserWorkload: true</code> to disable monitoring for user-defined projects.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Set <code class="literal">enableUserWorkload:</code> to <code class="literal">false</code> under <code class="literal">data/config.yaml</code>:
							</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    enableUserWorkload: false</pre></li></ol></div></li><li class="listitem">
						Save the file to apply the changes. Monitoring for user-defined projects is then disabled automatically.
					</li><li class="listitem"><p class="simpara">
						Check that the <code class="literal">prometheus-operator</code>, <code class="literal">prometheus-user-workload</code> and <code class="literal">thanos-ruler-user-workload</code> pods are terminated in the <code class="literal">openshift-user-workload-monitoring</code> project. This might take a short while:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring get pod</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">No resources found in openshift-user-workload-monitoring project.</pre>

						</p></div></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project is not automatically deleted when monitoring for user-defined projects is disabled. This is to preserve any custom configurations that you may have created in the <code class="literal">ConfigMap</code> object.
				</p></div></div></section><section class="section" id="next-steps-2"><div class="titlepage"><div><div><h2 class="title">7.7. Next steps</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#managing-metrics">Managing metrics</a>
					</li></ul></div></section></section><section class="chapter" id="enabling-alert-routing-for-user-defined-projects"><div class="titlepage"><div><div><h1 class="title">Chapter 8. Enabling alert routing for user-defined projects</h1></div></div></div><p class="_abstract _abstract">
			In OpenShift Container Platform 4.13, a cluster administrator can enable alert routing for user-defined projects. This process consists of two general steps:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Enable alert routing for user-defined projects to use the default platform Alertmanager instance or, optionally, a separate Alertmanager instance only for user-defined projects.
				</li><li class="listitem">
					Grant users permission to configure alert routing for user-defined projects.
				</li></ul></div><p>
			After you complete these steps, developers and other users can configure custom alerts and alert routing for their user-defined projects.
		</p><section class="section" id="understanding-alert-routing-for-user-defined-projects_enabling-alert-routing-for-user-defined-projects"><div class="titlepage"><div><div><h2 class="title">8.1. Understanding alert routing for user-defined projects</h2></div></div></div><p class="_abstract _abstract">
				As a cluster administrator, you can enable alert routing for user-defined projects. With this feature, you can allow users with the <span class="strong strong"><strong>alert-routing-edit</strong></span> role to configure alert notification routing and receivers for user-defined projects. These notifications are routed by the default Alertmanager instance or, if enabled, an optional Alertmanager instance dedicated to user-defined monitoring.
			</p><p>
				Users can then create and configure user-defined alert routing by creating or editing the <code class="literal">AlertmanagerConfig</code> objects for their user-defined projects without the help of an administrator.
			</p><p>
				After a user has defined alert routing for a user-defined project, user-defined alert notifications are routed as follows:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						To the <code class="literal">alertmanager-main</code> pods in the <code class="literal">openshift-monitoring</code> namespace if using the default platform Alertmanager instance.
					</li><li class="listitem">
						To the <code class="literal">alertmanager-user-workload</code> pods in the <code class="literal">openshift-user-workload-monitoring</code> namespace if you have enabled a separate instance of Alertmanager for user-defined projects.
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The following are limitations of alert routing for user-defined projects:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							For user-defined alerting rules, user-defined routing is scoped to the namespace in which the resource is defined. For example, a routing configuration in namespace <code class="literal">ns1</code> only applies to <code class="literal">PrometheusRules</code> resources in the same namespace.
						</li><li class="listitem">
							When a namespace is excluded from user-defined monitoring, <code class="literal">AlertmanagerConfig</code> resources in the namespace cease to be part of the Alertmanager configuration.
						</li></ul></div></div></div></section><section class="section" id="enabling-the-platform-alertmanager-instance-for-user-defined-alert-routing_enabling-alert-routing-for-user-defined-projects"><div class="titlepage"><div><div><h2 class="title">8.2. Enabling the platform Alertmanager instance for user-defined alert routing</h2></div></div></div><p>
				You can allow users to create user-defined alert routing configurations that use the main platform instance of Alertmanager.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
					</li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">cluster-monitoring-config</code> <code class="literal">ConfigMap</code> object:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit configmap cluster-monitoring-config</pre></li><li class="listitem"><p class="simpara">
						Add <code class="literal">enableUserAlertmanagerConfig: true</code> in the <code class="literal">alertmanagerMain</code> section under <code class="literal">data/config.yaml</code>:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    alertmanagerMain:
      enableUserAlertmanagerConfig: true <span id="CO49-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO49-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Set the <code class="literal">enableUserAlertmanagerConfig</code> value to <code class="literal">true</code> to allow users to create user-defined alert routing configurations that use the main platform instance of Alertmanager.
							</div></dd></dl></div></li><li class="listitem">
						Save the file to apply the changes.
					</li></ol></div></section><section class="section" id="enabling-a-separate-alertmanager-instance-for-user-defined-alert-routing_enabling-alert-routing-for-user-defined-projects"><div class="titlepage"><div><div><h2 class="title">8.3. Enabling a separate Alertmanager instance for user-defined alert routing</h2></div></div></div><p>
				In some clusters, you might want to deploy a dedicated Alertmanager instance for user-defined projects, which can help reduce the load on the default platform Alertmanager instance and can better separate user-defined alerts from default platform alerts. In these cases, you can optionally enable a separate instance of Alertmanager to send alerts for user-defined projects only.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
					</li><li class="listitem">
						You have enabled monitoring for user-defined projects in the <code class="literal">cluster-monitoring-config</code> config map for the <code class="literal">openshift-monitoring</code> namespace.
					</li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
						Add <code class="literal">enabled: true</code> and <code class="literal">enableAlertmanagerConfig: true</code> in the <code class="literal">alertmanager</code> section under <code class="literal">data/config.yaml</code>:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    alertmanager:
      enabled: true <span id="CO50-1"><!--Empty--></span><span class="callout">1</span>
      enableAlertmanagerConfig: true <span id="CO50-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO50-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Set the <code class="literal">enabled</code> value to <code class="literal">true</code> to enable a dedicated instance of the Alertmanager for user-defined projects in a cluster. Set the value to <code class="literal">false</code> or omit the key entirely to disable the Alertmanager for user-defined projects. If you set this value to <code class="literal">false</code> or if the key is omitted, user-defined alerts are routed to the default platform Alertmanager instance.
							</div></dd><dt><a href="#CO50-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Set the <code class="literal">enableAlertmanagerConfig</code> value to <code class="literal">true</code> to enable users to define their own alert routing configurations with <code class="literal">AlertmanagerConfig</code> objects.
							</div></dd></dl></div></li><li class="listitem">
						Save the file to apply the changes. The dedicated instance of Alertmanager for user-defined projects starts automatically.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that the <code class="literal">user-workload</code> Alertmanager instance has started:
					</p><pre class="programlisting language-terminal"># oc -n openshift-user-workload-monitoring get alertmanager</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">NAME            VERSION   REPLICAS   AGE
user-workload   0.24.0    2          100s</pre>

						</p></div></li></ul></div></section><section class="section" id="granting-users-permission-to-configure-alert-routing-for-user-defined-projects_enabling-alert-routing-for-user-defined-projects"><div class="titlepage"><div><div><h2 class="title">8.4. Granting users permission to configure alert routing for user-defined projects</h2></div></div></div><p class="_abstract _abstract">
				You can grant users permission to configure alert routing for user-defined projects.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
					</li><li class="listitem">
						You have enabled monitoring for user-defined projects in the <code class="literal">cluster-monitoring-config</code> config map for the <code class="literal">openshift-monitoring</code> namespace.
					</li><li class="listitem">
						The user account that you are assigning the role to already exists.
					</li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Assign the <code class="literal">alert-routing-edit</code> cluster role to a user in the user-defined project:
					</p><pre class="programlisting language-terminal">$ oc -n &lt;namespace&gt; adm policy add-role-to-user alert-routing-edit &lt;user&gt; <span id="CO51-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO51-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								For <code class="literal">&lt;namespace&gt;</code>, substitute the namespace for the user-defined project, such as <code class="literal">ns1</code>. For <code class="literal">&lt;user&gt;</code>, substitute the username for the account to which you want to assign the role.
							</div></dd></dl></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#enabling-monitoring-for-user-defined-projects">Enabling monitoring for user defined projects</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#creating-alert-routing-for-user-defined-projects_managing-alerts">Creating alert routing for user-defined projects</a>
					</li></ul></div></section><section class="section" id="next-steps-3"><div class="titlepage"><div><div><h2 class="title">8.5. Next steps</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#managing-alerts">Managing alerts</a>
					</li></ul></div></section></section><section class="chapter" id="managing-metrics"><div class="titlepage"><div><div><h1 class="title">Chapter 9. Managing metrics</h1></div></div></div><p class="_abstract _abstract">
			You can collect metrics to monitor how cluster components and your own workloads are performing.
		</p><section class="section" id="understanding-metrics_managing-metrics"><div class="titlepage"><div><div><h2 class="title">9.1. Understanding metrics</h2></div></div></div><p class="_abstract _abstract">
				In OpenShift Container Platform 4.13, cluster components are monitored by scraping metrics exposed through service endpoints. You can also configure metrics collection for user-defined projects. Metrics enable you to monitor how cluster components and your own workloads are performing.
			</p><p>
				You can define the metrics that you want to provide for your own workloads by using Prometheus client libraries at the application level.
			</p><p>
				In OpenShift Container Platform, metrics are exposed through an HTTP service endpoint under the <code class="literal">/metrics</code> canonical name. You can list all available metrics for a service by running a <code class="literal">curl</code> query against <code class="literal">http://&lt;endpoint&gt;/metrics</code>. For instance, you can expose a route to the <code class="literal">prometheus-example-app</code> example application and then run the following to view all of its available metrics:
			</p><pre class="programlisting language-terminal">$ curl http://&lt;example_app_endpoint&gt;/metrics</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
					
<pre class="programlisting language-terminal"># HELP http_requests_total Count of all HTTP requests
# TYPE http_requests_total counter
http_requests_total{code="200",method="get"} 4
http_requests_total{code="404",method="get"} 2
# HELP version Version information about this binary
# TYPE version gauge
version{version="v0.1.0"} 1</pre>

				</p></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://prometheus.io/docs/instrumenting/clientlibs/">Prometheus client library documentation</a>
					</li></ul></div></section><section class="section" id="setting-up-metrics-collection-for-user-defined-projects_managing-metrics"><div class="titlepage"><div><div><h2 class="title">9.2. Setting up metrics collection for user-defined projects</h2></div></div></div><p>
				You can create a <code class="literal">ServiceMonitor</code> resource to scrape metrics from a service endpoint in a user-defined project. This assumes that your application uses a Prometheus client library to expose metrics to the <code class="literal">/metrics</code> canonical name.
			</p><p>
				This section describes how to deploy a sample service in a user-defined project and then create a <code class="literal">ServiceMonitor</code> resource that defines how that service should be monitored.
			</p><section class="section" id="deploying-a-sample-service_managing-metrics"><div class="titlepage"><div><div><h3 class="title">9.2.1. Deploying a sample service</h3></div></div></div><p>
					To test monitoring of a service in a user-defined project, you can deploy a sample service.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Create a YAML file for the service configuration. In this example, it is called <code class="literal">prometheus-example-app.yaml</code>.
						</li><li class="listitem"><p class="simpara">
							Add the following deployment and service configuration details to the file:
						</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Namespace
metadata:
  name: ns1
---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: prometheus-example-app
  name: prometheus-example-app
  namespace: ns1
spec:
  replicas: 1
  selector:
    matchLabels:
      app: prometheus-example-app
  template:
    metadata:
      labels:
        app: prometheus-example-app
    spec:
      containers:
      - image: ghcr.io/rhobs/prometheus-example-app:0.4.1
        imagePullPolicy: IfNotPresent
        name: prometheus-example-app
---
apiVersion: v1
kind: Service
metadata:
  labels:
    app: prometheus-example-app
  name: prometheus-example-app
  namespace: ns1
spec:
  ports:
  - port: 8080
    protocol: TCP
    targetPort: 8080
    name: web
  selector:
    app: prometheus-example-app
  type: ClusterIP</pre><p class="simpara">
							This configuration deploys a service named <code class="literal">prometheus-example-app</code> in the user-defined <code class="literal">ns1</code> project. This service exposes the custom <code class="literal">version</code> metric.
						</p></li><li class="listitem"><p class="simpara">
							Apply the configuration to the cluster:
						</p><pre class="programlisting language-terminal">$ oc apply -f prometheus-example-app.yaml</pre><p class="simpara">
							It takes some time to deploy the service.
						</p></li><li class="listitem"><p class="simpara">
							You can check that the pod is running:
						</p><pre class="programlisting language-terminal">$ oc -n ns1 get pod</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                                      READY     STATUS    RESTARTS   AGE
prometheus-example-app-7857545cb7-sbgwq   1/1       Running   0          81m</pre>

							</p></div></li></ol></div></section><section class="section" id="specifying-how-a-service-is-monitored_managing-metrics"><div class="titlepage"><div><div><h3 class="title">9.2.2. Specifying how a service is monitored</h3></div></div></div><p class="_abstract _abstract">
					To use the metrics exposed by your service, you must configure OpenShift Container Platform monitoring to scrape metrics from the <code class="literal">/metrics</code> endpoint. You can do this using a <code class="literal">ServiceMonitor</code> custom resource definition (CRD) that specifies how a service should be monitored, or a <code class="literal">PodMonitor</code> CRD that specifies how a pod should be monitored. The former requires a <code class="literal">Service</code> object, while the latter does not, allowing Prometheus to directly scrape metrics from the metrics endpoint exposed by a pod.
				</p><p>
					This procedure shows you how to create a <code class="literal">ServiceMonitor</code> resource for a service in a user-defined project.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role or the <code class="literal">monitoring-edit</code> cluster role.
						</li><li class="listitem">
							You have enabled monitoring for user-defined projects.
						</li><li class="listitem"><p class="simpara">
							For this example, you have deployed the <code class="literal">prometheus-example-app</code> sample service in the <code class="literal">ns1</code> project.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The <code class="literal">prometheus-example-app</code> sample service does not support TLS authentication.
							</p></div></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Create a YAML file for the <code class="literal">ServiceMonitor</code> resource configuration. In this example, the file is called <code class="literal">example-app-service-monitor.yaml</code>.
						</li><li class="listitem"><p class="simpara">
							Add the following <code class="literal">ServiceMonitor</code> resource configuration details:
						</p><pre class="programlisting language-yaml">apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  labels:
    k8s-app: prometheus-example-monitor
  name: prometheus-example-monitor
  namespace: ns1
spec:
  endpoints:
  - interval: 30s
    port: web
    scheme: http
  selector:
    matchLabels:
      app: prometheus-example-app</pre><p class="simpara">
							This defines a <code class="literal">ServiceMonitor</code> resource that scrapes the metrics exposed by the <code class="literal">prometheus-example-app</code> sample service, which includes the <code class="literal">version</code> metric.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								A <code class="literal">ServiceMonitor</code> resource in a user-defined namespace can only discover services in the same namespace. That is, the <code class="literal">namespaceSelector</code> field of the <code class="literal">ServiceMonitor</code> resource is always ignored.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Apply the configuration to the cluster:
						</p><pre class="programlisting language-terminal">$ oc apply -f example-app-service-monitor.yaml</pre><p class="simpara">
							It takes some time to deploy the <code class="literal">ServiceMonitor</code> resource.
						</p></li><li class="listitem"><p class="simpara">
							You can check that the <code class="literal">ServiceMonitor</code> resource is running:
						</p><pre class="programlisting language-terminal">$ oc -n ns1 get servicemonitor</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                         AGE
prometheus-example-monitor   81m</pre>

							</p></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#enabling-monitoring-for-user-defined-projects">Enabling monitoring for user-defined projects</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/articles/6675491">How to scrape metrics using TLS in a ServiceMonitor configuration in a user-defined project</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/api_reference/#podmonitor-monitoring.coreos.com/v1">PodMonitor API</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/api_reference/#servicemonitor-monitoring.coreos.com/v1">ServiceMonitor API</a>
						</li></ul></div></section></section><section class="section" id="viewing-a-list-of-available-metrics_managing-metrics"><div class="titlepage"><div><div><h2 class="title">9.3. Viewing a list of available metrics</h2></div></div></div><p>
				As a cluster administrator or as a user with view permissions for all projects, you can view a list of metrics available in a cluster and output the list in JSON format.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are a cluster administrator, or you have access to the cluster as a user with the <code class="literal">cluster-monitoring-view</code> cluster role.
					</li><li class="listitem">
						You have installed the OpenShift Container Platform CLI (<code class="literal">oc</code>).
					</li><li class="listitem">
						You have obtained the OpenShift Container Platform API route for Thanos Querier.
					</li><li class="listitem"><p class="simpara">
						You are able to get a bearer token by using the <code class="literal">oc whoami -t</code> command.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							You can only use bearer token authentication to access the Thanos Querier API route.
						</p></div></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						If you have not obtained the OpenShift Container Platform API route for Thanos Querier, run the following command:
					</p><pre class="programlisting language-terminal">$ oc get routes -n openshift-monitoring thanos-querier -o jsonpath='{.status.ingress[0].host}'</pre></li><li class="listitem"><p class="simpara">
						Retrieve a list of metrics in JSON format from the Thanos Querier API route by running the following command. This command uses <code class="literal">oc</code> to authenticate with a bearer token.
					</p><pre class="programlisting language-terminal">$ curl -k -H "Authorization: Bearer $(oc whoami -t)" https://&lt;thanos_querier_route&gt;/api/v1/metadata <span id="CO52-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO52-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Replace <code class="literal">&lt;thanos_querier_route&gt;</code> with the OpenShift Container Platform API route for Thanos Querier.
							</div></dd></dl></div></li></ol></div></section><section class="section" id="about-querying-metrics_managing-metrics"><div class="titlepage"><div><div><h2 class="title">9.4. Querying metrics</h2></div></div></div><p>
				The OpenShift Container Platform monitoring dashboard enables you to run Prometheus Query Language (PromQL) queries to examine metrics visualized on a plot. This functionality provides information about the state of a cluster and any user-defined workloads that you are monitoring.
			</p><p>
				As a cluster administrator, you can query metrics for all core OpenShift Container Platform and user-defined projects.
			</p><p>
				As a developer, you must specify a project name when querying metrics. You must have the required privileges to view metrics for the selected project.
			</p><section class="section" id="querying-metrics-for-all-projects-as-an-administrator_managing-metrics"><div class="titlepage"><div><div><h3 class="title">9.4.1. Querying metrics for all projects as a cluster administrator</h3></div></div></div><p>
					As a cluster administrator or as a user with view permissions for all projects, you can access metrics for all default OpenShift Container Platform and user-defined projects in the Metrics UI.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role or with view permissions for all projects.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							From the <span class="strong strong"><strong>Administrator</strong></span> perspective in the OpenShift Container Platform web console, select <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Metrics</strong></span>.
						</li><li class="listitem"><p class="simpara">
							To add one or more queries, do any of the following:
						</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408934041072" scope="col">Option</th><th align="left" valign="top" id="idm140408934039984" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408934041072"> <p>
											Create a custom query.
										</p>
										 </td><td align="left" valign="top" headers="idm140408934039984"> <p>
											Add your Prometheus Query Language (PromQL) query to the <span class="strong strong"><strong>Expression</strong></span> field.
										</p>
										 <p>
											As you type a PromQL expression, autocomplete suggestions appear in a drop-down list. These suggestions include functions, metrics, labels, and time tokens. You can use the keyboard arrows to select one of these suggested items and then press Enter to add the item to your expression. You can also move your mouse pointer over a suggested item to view a brief description of that item.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140408934041072"> <p>
											Add multiple queries.
										</p>
										 </td><td align="left" valign="top" headers="idm140408934039984"> <p>
											Select <span class="strong strong"><strong>Add query</strong></span>.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140408934041072"> <p>
											Duplicate an existing query.
										</p>
										 </td><td align="left" valign="top" headers="idm140408934039984"> <p>
											Select the Options menu 
											<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Monitoring-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
											 next to the query, then choose <span class="strong strong"><strong>Duplicate query</strong></span>.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140408934041072"> <p>
											Disable a query from being run.
										</p>
										 </td><td align="left" valign="top" headers="idm140408934039984"> <p>
											Select the Options menu 
											<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Monitoring-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
											 next to the query and choose <span class="strong strong"><strong>Disable query</strong></span>.
										</p>
										 </td></tr></tbody></table></div></li><li class="listitem"><p class="simpara">
							To run queries that you created, select <span class="strong strong"><strong>Run queries</strong></span>. The metrics from the queries are visualized on the plot. If a query is invalid, the UI shows an error message.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Queries that operate on large amounts of data might time out or overload the browser when drawing time series graphs. To avoid this, select <span class="strong strong"><strong>Hide graph</strong></span> and calibrate your query using only the metrics table. Then, after finding a feasible query, enable the plot to draw the graphs.
							</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								By default, the query table shows an expanded view that lists every metric and its current value. You can select <span class="strong strong"><strong>˅</strong></span> to minimize the expanded view for a query.
							</p></div></div></li><li class="listitem">
							Optional: The page URL now contains the queries you ran. To use this set of queries again in the future, save this URL.
						</li><li class="listitem"><p class="simpara">
							Explore the visualized metrics. Initially, all metrics from all enabled queries are shown on the plot. You can select which metrics are shown by doing any of the following:
						</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408901255584" scope="col">Option</th><th align="left" valign="top" id="idm140408901254496" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408901255584"> <p>
											Hide all metrics from a query.
										</p>
										 </td><td align="left" valign="top" headers="idm140408901254496"> <p>
											Click the Options menu 
											<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Monitoring-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
											 for the query and click <span class="strong strong"><strong>Hide all series</strong></span>.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140408901255584"> <p>
											Hide a specific metric.
										</p>
										 </td><td align="left" valign="top" headers="idm140408901254496"> <p>
											Go to the query table and click the colored square near the metric name.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140408901255584"> <p>
											Zoom into the plot and change the time range.
										</p>
										 </td><td align="left" valign="top" headers="idm140408901254496"> <p>
											Either:
										</p>
										 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													Visually select the time range by clicking and dragging on the plot horizontally.
												</li><li class="listitem">
													Use the menu in the left upper corner to select the time range.
												</li></ul></div>
										 </td></tr><tr><td align="left" valign="top" headers="idm140408901255584"> <p>
											Reset the time range.
										</p>
										 </td><td align="left" valign="top" headers="idm140408901254496"> <p>
											Select <span class="strong strong"><strong>Reset zoom</strong></span>.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140408901255584"> <p>
											Display outputs for all queries at a specific point in time.
										</p>
										 </td><td align="left" valign="top" headers="idm140408901254496"> <p>
											Hold the mouse cursor on the plot at that point. The query outputs will appear in a pop-up box.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140408901255584"> <p>
											Hide the plot.
										</p>
										 </td><td align="left" valign="top" headers="idm140408901254496"> <p>
											Select <span class="strong strong"><strong>Hide graph</strong></span>.
										</p>
										 </td></tr></tbody></table></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							For more information about creating PromQL queries, see the <a class="link" href="https://prometheus.io/docs/prometheus/latest/querying/basics/">Prometheus query documentation</a>.
						</li></ul></div></section><section class="section" id="querying-metrics-for-user-defined-projects-as-a-developer_managing-metrics"><div class="titlepage"><div><div><h3 class="title">9.4.2. Querying metrics for user-defined projects as a developer</h3></div></div></div><p>
					You can access metrics for a user-defined project as a developer or as a user with view permissions for the project.
				</p><p>
					In the <span class="strong strong"><strong>Developer</strong></span> perspective, the Metrics UI includes some predefined CPU, memory, bandwidth, and network packet queries for the selected project. You can also run custom Prometheus Query Language (PromQL) queries for CPU, memory, bandwidth, network packet and application metrics for the project.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Developers can only use the <span class="strong strong"><strong>Developer</strong></span> perspective and not the <span class="strong strong"><strong>Administrator</strong></span> perspective. As a developer, you can only query metrics for one project at a time.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a developer or as a user with view permissions for the project that you are viewing metrics for.
						</li><li class="listitem">
							You have enabled monitoring for user-defined projects.
						</li><li class="listitem">
							You have deployed a service in a user-defined project.
						</li><li class="listitem">
							You have created a <code class="literal">ServiceMonitor</code> custom resource definition (CRD) for the service to define how the service is monitored.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							From the <span class="strong strong"><strong>Developer</strong></span> perspective in the OpenShift Container Platform web console, select <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Metrics</strong></span>.
						</li><li class="listitem">
							Select the project that you want to view metrics for in the <span class="strong strong"><strong>Project:</strong></span> list.
						</li><li class="listitem"><p class="simpara">
							Select a query from the <span class="strong strong"><strong>Select query</strong></span> list, or create a custom PromQL query based on the selected query by selecting <span class="strong strong"><strong>Show PromQL</strong></span>. The metrics from the queries are visualized on the plot.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								In the Developer perspective, you can only run one query at a time.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Explore the visualized metrics by doing any of the following:
						</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408918220944" scope="col">Option</th><th align="left" valign="top" id="idm140408918219856" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408918220944"> <p>
											Zoom into the plot and change the time range.
										</p>
										 </td><td align="left" valign="top" headers="idm140408918219856"> <p>
											Either:
										</p>
										 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													Visually select the time range by clicking and dragging on the plot horizontally.
												</li><li class="listitem">
													Use the menu in the left upper corner to select the time range.
												</li></ul></div>
										 </td></tr><tr><td align="left" valign="top" headers="idm140408918220944"> <p>
											Reset the time range.
										</p>
										 </td><td align="left" valign="top" headers="idm140408918219856"> <p>
											Select <span class="strong strong"><strong>Reset zoom</strong></span>.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140408918220944"> <p>
											Display outputs for all queries at a specific point in time.
										</p>
										 </td><td align="left" valign="top" headers="idm140408918219856"> <p>
											Hold the mouse cursor on the plot at that point. The query outputs appear in a pop-up box.
										</p>
										 </td></tr></tbody></table></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							For more information about creating PromQL queries, see the <a class="link" href="https://prometheus.io/docs/prometheus/latest/querying/basics/">Prometheus query documentation</a>.
						</li></ul></div></section></section><section class="section" id="getting-detailed-information-about-a-target_managing-metrics"><div class="titlepage"><div><div><h2 class="title">9.5. Getting detailed information about a metrics target</h2></div></div></div><p>
				In the <span class="strong strong"><strong>Administrator</strong></span> perspective in the OpenShift Container Platform web console, you can use the <span class="strong strong"><strong>Metrics targets</strong></span> page to view, search, and filter the endpoints that are currently targeted for scraping, which helps you to identify and troubleshoot problems. For example, you can view the current status of targeted endpoints to see when OpenShift Container Platform Monitoring is not able to scrape metrics from a targeted component.
			</p><p>
				The <span class="strong strong"><strong>Metrics targets</strong></span> page shows targets for default OpenShift Container Platform projects and for user-defined projects.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as an administrator for the project for which you want to view metrics targets.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						In the <span class="strong strong"><strong>Administrator</strong></span> perspective, select <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Targets</strong></span>. The <span class="strong strong"><strong>Metrics targets</strong></span> page opens with a list of all service endpoint targets that are being scraped for metrics.
					</p><p class="simpara">
						This page shows details about targets for default OpenShift Container Platform and user-defined projects. This page lists the following information for each target:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Service endpoint URL being scraped
							</li><li class="listitem">
								ServiceMonitor component being monitored
							</li><li class="listitem">
								The <span class="strong strong"><strong>up</strong></span> or <span class="strong strong"><strong>down</strong></span> status of the target
							</li><li class="listitem">
								Namespace
							</li><li class="listitem">
								Last scrape time
							</li><li class="listitem">
								Duration of the last scrape
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Optional: The list of metrics targets can be long. To find a specific target, do any of the following:
					</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408902506608" scope="col">Option</th><th align="left" valign="top" id="idm140408902505520" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408902506608"> <p>
										Filter the targets by status and source.
									</p>
									 </td><td align="left" valign="top" headers="idm140408902505520"> <p>
										Select filters in the <span class="strong strong"><strong>Filter</strong></span> list.
									</p>
									 <p>
										The following filtering options are available:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
												<span class="strong strong"><strong>Status</strong></span> filters:
											</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
														<span class="strong strong"><strong>Up</strong></span>. The target is currently up and being actively scraped for metrics.
													</li><li class="listitem">
														<span class="strong strong"><strong>Down</strong></span>. The target is currently down and not being scraped for metrics.
													</li></ul></div></li><li class="listitem"><p class="simpara">
												<span class="strong strong"><strong>Source</strong></span> filters:
											</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
														<span class="strong strong"><strong>Platform</strong></span>. Platform-level targets relate only to default Red Hat OpenShift Service on AWS projects. These projects provide core Red Hat OpenShift Service on AWS functionality.
													</li><li class="listitem">
														<span class="strong strong"><strong>User</strong></span>. User targets relate to user-defined projects. These projects are user-created and can be customized.
													</li></ul></div></li></ul></div>
									 </td></tr><tr><td align="left" valign="top" headers="idm140408902506608"> <p>
										Search for a target by name or label.
									</p>
									 </td><td align="left" valign="top" headers="idm140408902505520"> <p>
										Enter a search term in the <span class="strong strong"><strong>Text</strong></span> or <span class="strong strong"><strong>Label</strong></span> field next to the search box.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140408902506608"> <p>
										Sort the targets.
									</p>
									 </td><td align="left" valign="top" headers="idm140408902505520"> <p>
										Click one or more of the <span class="strong strong"><strong>Endpoint Status</strong></span>, <span class="strong strong"><strong>Namespace</strong></span>, <span class="strong strong"><strong>Last Scrape</strong></span>, and <span class="strong strong"><strong>Scrape Duration</strong></span> column headers.
									</p>
									 </td></tr></tbody></table></div></li><li class="listitem"><p class="simpara">
						Click the URL in the <span class="strong strong"><strong>Endpoint</strong></span> column for a target to navigate to its <span class="strong strong"><strong>Target details</strong></span> page. This page provides information about the target, including the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The endpoint URL being scraped for metrics
							</li><li class="listitem">
								The current <span class="strong strong"><strong>Up</strong></span> or <span class="strong strong"><strong>Down</strong></span> status of the target
							</li><li class="listitem">
								A link to the namespace
							</li><li class="listitem">
								A link to the ServiceMonitor details
							</li><li class="listitem">
								Labels attached to the target
							</li><li class="listitem">
								The most recent time that the target was scraped for metrics
							</li></ul></div></li></ol></div></section></section><section class="chapter" id="managing-alerts"><div class="titlepage"><div><div><h1 class="title">Chapter 10. Managing alerts</h1></div></div></div><p>
			In OpenShift Container Platform 4.13, the Alerting UI enables you to manage alerts, silences, and alerting rules.
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<span class="strong strong"><strong>Alerting rules</strong></span>. Alerting rules contain a set of conditions that outline a particular state within a cluster. Alerts are triggered when those conditions are true. An alerting rule can be assigned a severity that defines how the alerts are routed.
				</li><li class="listitem">
					<span class="strong strong"><strong>Alerts</strong></span>. An alert is fired when the conditions defined in an alerting rule are true. Alerts provide a notification that a set of circumstances are apparent within an OpenShift Container Platform cluster.
				</li><li class="listitem">
					<span class="strong strong"><strong>Silences</strong></span>. A silence can be applied to an alert to prevent notifications from being sent when the conditions for an alert are true. You can mute an alert after the initial notification, while you work on resolving the underlying issue.
				</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				The alerts, silences, and alerting rules that are available in the Alerting UI relate to the projects that you have access to. For example, if you are logged in as a user with the <code class="literal">cluster-admin</code> role, you can access all alerts, silences, and alerting rules.
			</p><p>
				If you are a non-administrator user, you can create and silence alerts if you are assigned the following user roles:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">cluster-monitoring-view</code> cluster role, which allows you to access Alertmanager
					</li><li class="listitem">
						The <code class="literal">monitoring-alertmanager-edit</code> role, which permits you to create and silence alerts in the <span class="strong strong"><strong>Administrator</strong></span> perspective in the web console
					</li><li class="listitem">
						The <code class="literal">monitoring-rules-edit</code> cluster role, which permits you to create and silence alerts in the <span class="strong strong"><strong>Developer</strong></span> perspective in the web console
					</li></ul></div></div></div><section class="section" id="accessing_the_alerting_ui_managing-alerts"><div class="titlepage"><div><div><h2 class="title">10.1. Accessing the Alerting UI in the Administrator and Developer perspectives</h2></div></div></div><p>
				The Alerting UI is accessible through the Administrator perspective and the Developer perspective in the OpenShift Container Platform web console.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						In the <span class="strong strong"><strong>Administrator</strong></span> perspective, select <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Alerting</strong></span>. The three main pages in the Alerting UI in this perspective are the <span class="strong strong"><strong>Alerts</strong></span>, <span class="strong strong"><strong>Silences</strong></span>, and <span class="strong strong"><strong>Alerting Rules</strong></span> pages.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						In the <span class="strong strong"><strong>Developer</strong></span> perspective, select <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>&lt;project_name&gt;</strong></span> → <span class="strong strong"><strong>Alerts</strong></span>. In this perspective, alerts, silences, and alerting rules are all managed from the <span class="strong strong"><strong>Alerts</strong></span> page. The results shown in the <span class="strong strong"><strong>Alerts</strong></span> page are specific to the selected project.
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					In the <span class="strong strong"><strong>Developer</strong></span> perspective, you can select from core OpenShift Container Platform and user-defined projects that you have access to in the <span class="strong strong"><strong>Project:</strong></span> list. However, alerts, silences, and alerting rules relating to core OpenShift Container Platform projects are not displayed if you are not logged in as a cluster administrator.
				</p></div></div></section><section class="section" id="searching-alerts-silences-and-alerting-rules_managing-alerts"><div class="titlepage"><div><div><h2 class="title">10.2. Searching and filtering alerts, silences, and alerting rules</h2></div></div></div><p>
				You can filter the alerts, silences, and alerting rules that are displayed in the Alerting UI. This section provides a description of each of the available filtering options.
			</p><h4 id="understanding-alert-filters">Understanding alert filters</h4><p>
				In the <span class="strong strong"><strong>Administrator</strong></span> perspective, the <span class="strong strong"><strong>Alerts</strong></span> page in the Alerting UI provides details about alerts relating to default OpenShift Container Platform and user-defined projects. The page includes a summary of severity, state, and source for each alert. The time at which an alert went into its current state is also shown.
			</p><p>
				You can filter by alert state, severity, and source. By default, only <span class="strong strong"><strong>Platform</strong></span> alerts that are <span class="strong strong"><strong>Firing</strong></span> are displayed. The following describes each alert filtering option:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Alert State</strong></span> filters:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<span class="strong strong"><strong>Firing</strong></span>. The alert is firing because the alert condition is true and the optional <code class="literal">for</code> duration has passed. The alert will continue to fire as long as the condition remains true.
							</li><li class="listitem">
								<span class="strong strong"><strong>Pending</strong></span>. The alert is active but is waiting for the duration that is specified in the alerting rule before it fires.
							</li><li class="listitem">
								<span class="strong strong"><strong>Silenced</strong></span>. The alert is now silenced for a defined time period. Silences temporarily mute alerts based on a set of label selectors that you define. Notifications will not be sent for alerts that match all the listed values or regular expressions.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Severity</strong></span> filters:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<span class="strong strong"><strong>Critical</strong></span>. The condition that triggered the alert could have a critical impact. The alert requires immediate attention when fired and is typically paged to an individual or to a critical response team.
							</li><li class="listitem">
								<span class="strong strong"><strong>Warning</strong></span>. The alert provides a warning notification about something that might require attention to prevent a problem from occurring. Warnings are typically routed to a ticketing system for non-immediate review.
							</li><li class="listitem">
								<span class="strong strong"><strong>Info</strong></span>. The alert is provided for informational purposes only.
							</li><li class="listitem">
								<span class="strong strong"><strong>None</strong></span>. The alert has no defined severity.
							</li><li class="listitem">
								You can also create custom severity definitions for alerts relating to user-defined projects.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Source</strong></span> filters:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<span class="strong strong"><strong>Platform</strong></span>. Platform-level alerts relate only to default OpenShift Container Platform projects. These projects provide core OpenShift Container Platform functionality.
							</li><li class="listitem">
								<span class="strong strong"><strong>User</strong></span>. User alerts relate to user-defined projects. These alerts are user-created and are customizable. User-defined workload monitoring can be enabled post-installation to provide observability into your own workloads.
							</li></ul></div></li></ul></div><h4 id="understanding-silence-filters">Understanding silence filters</h4><p>
				In the <span class="strong strong"><strong>Administrator</strong></span> perspective, the <span class="strong strong"><strong>Silences</strong></span> page in the Alerting UI provides details about silences applied to alerts in default OpenShift Container Platform and user-defined projects. The page includes a summary of the state of each silence and the time at which a silence ends.
			</p><p>
				You can filter by silence state. By default, only <span class="strong strong"><strong>Active</strong></span> and <span class="strong strong"><strong>Pending</strong></span> silences are displayed. The following describes each silence state filter option:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Silence State</strong></span> filters:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<span class="strong strong"><strong>Active</strong></span>. The silence is active and the alert will be muted until the silence is expired.
							</li><li class="listitem">
								<span class="strong strong"><strong>Pending</strong></span>. The silence has been scheduled and it is not yet active.
							</li><li class="listitem">
								<span class="strong strong"><strong>Expired</strong></span>. The silence has expired and notifications will be sent if the conditions for an alert are true.
							</li></ul></div></li></ul></div><h4 id="understanding-alerting-rule-filters">Understanding alerting rule filters</h4><p>
				In the <span class="strong strong"><strong>Administrator</strong></span> perspective, the <span class="strong strong"><strong>Alerting Rules</strong></span> page in the Alerting UI provides details about alerting rules relating to default OpenShift Container Platform and user-defined projects. The page includes a summary of the state, severity, and source for each alerting rule.
			</p><p>
				You can filter alerting rules by alert state, severity, and source. By default, only <span class="strong strong"><strong>Platform</strong></span> alerting rules are displayed. The following describes each alerting rule filtering option:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Alert State</strong></span> filters:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<span class="strong strong"><strong>Firing</strong></span>. The alert is firing because the alert condition is true and the optional <code class="literal">for</code> duration has passed. The alert will continue to fire as long as the condition remains true.
							</li><li class="listitem">
								<span class="strong strong"><strong>Pending</strong></span>. The alert is active but is waiting for the duration that is specified in the alerting rule before it fires.
							</li><li class="listitem">
								<span class="strong strong"><strong>Silenced</strong></span>. The alert is now silenced for a defined time period. Silences temporarily mute alerts based on a set of label selectors that you define. Notifications will not be sent for alerts that match all the listed values or regular expressions.
							</li><li class="listitem">
								<span class="strong strong"><strong>Not Firing</strong></span>. The alert is not firing.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Severity</strong></span> filters:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<span class="strong strong"><strong>Critical</strong></span>. The conditions defined in the alerting rule could have a critical impact. When true, these conditions require immediate attention. Alerts relating to the rule are typically paged to an individual or to a critical response team.
							</li><li class="listitem">
								<span class="strong strong"><strong>Warning</strong></span>. The conditions defined in the alerting rule might require attention to prevent a problem from occurring. Alerts relating to the rule are typically routed to a ticketing system for non-immediate review.
							</li><li class="listitem">
								<span class="strong strong"><strong>Info</strong></span>. The alerting rule provides informational alerts only.
							</li><li class="listitem">
								<span class="strong strong"><strong>None</strong></span>. The alerting rule has no defined severity.
							</li><li class="listitem">
								You can also create custom severity definitions for alerting rules relating to user-defined projects.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Source</strong></span> filters:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<span class="strong strong"><strong>Platform</strong></span>. Platform-level alerting rules relate only to default OpenShift Container Platform projects. These projects provide core OpenShift Container Platform functionality.
							</li><li class="listitem">
								<span class="strong strong"><strong>User</strong></span>. User-defined workload alerting rules relate to user-defined projects. These alerting rules are user-created and are customizable. User-defined workload monitoring can be enabled post-installation to provide observability into your own workloads.
							</li></ul></div></li></ul></div><h4 id="searching-and-filtering-alerts-silences-and-alerting-rules-in-the-developer-perspective">Searching and filtering alerts, silences, and alerting rules in the Developer perspective</h4><p>
				In the <span class="strong strong"><strong>Developer</strong></span> perspective, the Alerts page in the Alerting UI provides a combined view of alerts and silences relating to the selected project. A link to the governing alerting rule is provided for each displayed alert.
			</p><p>
				In this view, you can filter by alert state and severity. By default, all alerts in the selected project are displayed if you have permission to access the project. These filters are the same as those described for the <span class="strong strong"><strong>Administrator</strong></span> perspective.
			</p></section><section class="section" id="getting-information-about-alerts-silences-and-alerting-rules_managing-alerts"><div class="titlepage"><div><div><h2 class="title">10.3. Getting information about alerts, silences, and alerting rules</h2></div></div></div><p>
				The Alerting UI provides detailed information about alerts and their governing alerting rules and silences.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a developer or as a user with view permissions for the project that you are viewing metrics for.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					<span class="strong strong"><strong>To obtain information about alerts in the Administrator perspective</strong></span>:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Open the OpenShift Container Platform web console and navigate to the <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Alerting</strong></span> → <span class="strong strong"><strong>Alerts</strong></span> page.
					</li><li class="listitem">
						Optional: Search for alerts by name using the <span class="strong strong"><strong>Name</strong></span> field in the search list.
					</li><li class="listitem">
						Optional: Filter alerts by state, severity, and source by selecting filters in the <span class="strong strong"><strong>Filter</strong></span> list.
					</li><li class="listitem">
						Optional: Sort the alerts by clicking one or more of the <span class="strong strong"><strong>Name</strong></span>, <span class="strong strong"><strong>Severity</strong></span>, <span class="strong strong"><strong>State</strong></span>, and <span class="strong strong"><strong>Source</strong></span> column headers.
					</li><li class="listitem"><p class="simpara">
						Select the name of an alert to navigate to its <span class="strong strong"><strong>Alert Details</strong></span> page. The page includes a graph that illustrates alert time series data. It also provides information about the alert, including:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A description of the alert
							</li><li class="listitem">
								Messages associated with the alerts
							</li><li class="listitem">
								Labels attached to the alert
							</li><li class="listitem">
								A link to its governing alerting rule
							</li><li class="listitem">
								Silences for the alert, if any exist
							</li></ul></div></li></ol></div><p>
				<span class="strong strong"><strong>To obtain information about silences in the Administrator perspective</strong></span>:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Navigate to the <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Alerting</strong></span> → <span class="strong strong"><strong>Silences</strong></span> page.
					</li><li class="listitem">
						Optional: Filter the silences by name using the <span class="strong strong"><strong>Search by name</strong></span> field.
					</li><li class="listitem">
						Optional: Filter silences by state by selecting filters in the <span class="strong strong"><strong>Filter</strong></span> list. By default, <span class="strong strong"><strong>Active</strong></span> and <span class="strong strong"><strong>Pending</strong></span> filters are applied.
					</li><li class="listitem">
						Optional: Sort the silences by clicking one or more of the <span class="strong strong"><strong>Name</strong></span>, <span class="strong strong"><strong>Firing Alerts</strong></span>, and <span class="strong strong"><strong>State</strong></span> column headers.
					</li><li class="listitem"><p class="simpara">
						Select the name of a silence to navigate to its <span class="strong strong"><strong>Silence Details</strong></span> page. The page includes the following details:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Alert specification
							</li><li class="listitem">
								Start time
							</li><li class="listitem">
								End time
							</li><li class="listitem">
								Silence state
							</li><li class="listitem">
								Number and list of firing alerts
							</li></ul></div></li></ol></div><p>
				<span class="strong strong"><strong>To obtain information about alerting rules in the Administrator perspective</strong></span>:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Navigate to the <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Alerting</strong></span> → <span class="strong strong"><strong>Alerting Rules</strong></span> page.
					</li><li class="listitem">
						Optional: Filter alerting rules by state, severity, and source by selecting filters in the <span class="strong strong"><strong>Filter</strong></span> list.
					</li><li class="listitem">
						Optional: Sort the alerting rules by clicking one or more of the <span class="strong strong"><strong>Name</strong></span>, <span class="strong strong"><strong>Severity</strong></span>, <span class="strong strong"><strong>Alert State</strong></span>, and <span class="strong strong"><strong>Source</strong></span> column headers.
					</li><li class="listitem"><p class="simpara">
						Select the name of an alerting rule to navigate to its <span class="strong strong"><strong>Alerting Rule Details</strong></span> page. The page provides the following details about the alerting rule:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Alerting rule name, severity, and description
							</li><li class="listitem">
								The expression that defines the condition for firing the alert
							</li><li class="listitem">
								The time for which the condition should be true for an alert to fire
							</li><li class="listitem">
								A graph for each alert governed by the alerting rule, showing the value with which the alert is firing
							</li><li class="listitem">
								A table of all alerts governed by the alerting rule
							</li></ul></div></li></ol></div><p>
				<span class="strong strong"><strong>To obtain information about alerts, silences, and alerting rules in the Developer perspective</strong></span>:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Navigate to the <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>&lt;project_name&gt;</strong></span> → <span class="strong strong"><strong>Alerts</strong></span> page.
					</li><li class="listitem"><p class="simpara">
						View details for an alert, silence, or an alerting rule:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Alert Details</strong></span> can be viewed by selecting <span class="strong strong"><strong>&gt;</strong></span> to the left of an alert name and then selecting the alert in the list.
							</li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Silence Details</strong></span> can be viewed by selecting a silence in the <span class="strong strong"><strong>Silenced By</strong></span> section of the <span class="strong strong"><strong>Alert Details</strong></span> page. The <span class="strong strong"><strong>Silence Details</strong></span> page includes the following information:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Alert specification
									</li><li class="listitem">
										Start time
									</li><li class="listitem">
										End time
									</li><li class="listitem">
										Silence state
									</li><li class="listitem">
										Number and list of firing alerts
									</li></ul></div></li><li class="listitem">
								<span class="strong strong"><strong>Alerting Rule Details</strong></span> can be viewed by selecting <span class="strong strong"><strong>View Alerting Rule</strong></span> in the 
								<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Monitoring-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
								 menu on the right of an alert in the <span class="strong strong"><strong>Alerts</strong></span> page.
							</li></ul></div></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Only alerts, silences, and alerting rules relating to the selected project are displayed in the <span class="strong strong"><strong>Developer</strong></span> perspective.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <a class="link" href="https://github.com/openshift/runbooks/tree/master/alerts/cluster-monitoring-operator">Cluster Monitoring Operator runbooks</a> to help diagnose and resolve issues that trigger specific OpenShift Container Platform monitoring alerts.
					</li></ul></div></section><section class="section" id="managing-silences_managing-alerts"><div class="titlepage"><div><div><h2 class="title">10.4. Managing silences</h2></div></div></div><p>
				You can create a silence to stop receiving notifications about an alert when it is firing. It might be useful to silence an alert after being first notified, while you resolve the underlying issue.
			</p><p>
				When creating a silence, you must specify whether it becomes active immediately or at a later time. You must also set a duration period after which the silence expires.
			</p><p>
				You can view, edit, and expire existing silences.
			</p><section class="section" id="silencing-alerts_managing-alerts"><div class="titlepage"><div><div><h3 class="title">10.4.1. Silencing alerts</h3></div></div></div><p>
					You can either silence a specific alert or silence alerts that match a specification that you define.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							If you are a cluster administrator, you have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li><li class="listitem"><p class="simpara">
							If you are a non-administrator user, you have access to the cluster as a user with the following user roles:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									The <code class="literal">cluster-monitoring-view</code> cluster role, which allows you to access Alertmanager.
								</li><li class="listitem">
									The <code class="literal">monitoring-alertmanager-edit</code> role, which permits you to create and silence alerts in the <span class="strong strong"><strong>Administrator</strong></span> perspective in the web console.
								</li><li class="listitem">
									The <code class="literal">monitoring-rules-edit</code> cluster role, which permits you to create and silence alerts in the <span class="strong strong"><strong>Developer</strong></span> perspective in the web console.
								</li></ul></div></li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						To silence a specific alert:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							In the <span class="strong strong"><strong>Administrator</strong></span> perspective:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
									Navigate to the <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Alerting</strong></span> → <span class="strong strong"><strong>Alerts</strong></span> page of the OpenShift Container Platform web console.
								</li><li class="listitem">
									For the alert that you want to silence, select the 
									<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Monitoring-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
									 in the right-hand column and select <span class="strong strong"><strong>Silence Alert</strong></span>. The <span class="strong strong"><strong>Silence Alert</strong></span> form will appear with a pre-populated specification for the chosen alert.
								</li><li class="listitem">
									Optional: Modify the silence.
								</li><li class="listitem">
									You must add a comment before creating the silence.
								</li><li class="listitem">
									To create the silence, select <span class="strong strong"><strong>Silence</strong></span>.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							In the <span class="strong strong"><strong>Developer</strong></span> perspective:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
									Navigate to the <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>&lt;project_name&gt;</strong></span> → <span class="strong strong"><strong>Alerts</strong></span> page in the OpenShift Container Platform web console.
								</li><li class="listitem">
									Expand the details for an alert by selecting <span class="strong strong"><strong>&gt;</strong></span> to the left of the alert name. Select the name of the alert in the expanded view to open the <span class="strong strong"><strong>Alert Details</strong></span> page for the alert.
								</li><li class="listitem">
									Select <span class="strong strong"><strong>Silence Alert</strong></span>. The <span class="strong strong"><strong>Silence Alert</strong></span> form will appear with a prepopulated specification for the chosen alert.
								</li><li class="listitem">
									Optional: Modify the silence.
								</li><li class="listitem">
									You must add a comment before creating the silence.
								</li><li class="listitem">
									To create the silence, select <span class="strong strong"><strong>Silence</strong></span>.
								</li></ol></div></li></ul></div><p>
					To silence a set of alerts by creating an alert specification in the <span class="strong strong"><strong>Administrator</strong></span> perspective:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Alerting</strong></span> → <span class="strong strong"><strong>Silences</strong></span> page in the OpenShift Container Platform web console.
						</li><li class="listitem">
							Select <span class="strong strong"><strong>Create Silence</strong></span>.
						</li><li class="listitem">
							Set the schedule, duration, and label details for an alert in the <span class="strong strong"><strong>Create Silence</strong></span> form. You must also add a comment for the silence.
						</li><li class="listitem">
							To create silences for alerts that match the label sectors that you entered in the previous step, select <span class="strong strong"><strong>Silence</strong></span>.
						</li></ol></div></section><section class="section" id="editing-silences_managing-alerts"><div class="titlepage"><div><div><h3 class="title">10.4.2. Editing silences</h3></div></div></div><p>
					You can edit a silence, which will expire the existing silence and create a new one with the changed configuration.
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						To edit a silence in the <span class="strong strong"><strong>Administrator</strong></span> perspective:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Alerting</strong></span> → <span class="strong strong"><strong>Silences</strong></span> page.
						</li><li class="listitem"><p class="simpara">
							For the silence you want to modify, select the 
							<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Monitoring-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
							 in the last column and choose <span class="strong strong"><strong>Edit silence</strong></span>.
						</p><p class="simpara">
							Alternatively, you can select <span class="strong strong"><strong>Actions</strong></span> → <span class="strong strong"><strong>Edit Silence</strong></span> in the <span class="strong strong"><strong>Silence Details</strong></span> page for a silence.
						</p></li><li class="listitem">
							In the <span class="strong strong"><strong>Edit Silence</strong></span> page, enter your changes and select <span class="strong strong"><strong>Silence</strong></span>. This will expire the existing silence and create one with the chosen configuration.
						</li></ol></div><p>
					To edit a silence in the <span class="strong strong"><strong>Developer</strong></span> perspective:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>&lt;project_name&gt;</strong></span> → <span class="strong strong"><strong>Alerts</strong></span> page.
						</li><li class="listitem">
							Expand the details for an alert by selecting <span class="strong strong"><strong>&gt;</strong></span> to the left of the alert name. Select the name of the alert in the expanded view to open the <span class="strong strong"><strong>Alert Details</strong></span> page for the alert.
						</li><li class="listitem">
							Select the name of a silence in the <span class="strong strong"><strong>Silenced By</strong></span> section in that page to navigate to the <span class="strong strong"><strong>Silence Details</strong></span> page for the silence.
						</li><li class="listitem">
							Select the name of a silence to navigate to its <span class="strong strong"><strong>Silence Details</strong></span> page.
						</li><li class="listitem">
							Select <span class="strong strong"><strong>Actions</strong></span> → <span class="strong strong"><strong>Edit Silence</strong></span> in the <span class="strong strong"><strong>Silence Details</strong></span> page for a silence.
						</li><li class="listitem">
							In the <span class="strong strong"><strong>Edit Silence</strong></span> page, enter your changes and select <span class="strong strong"><strong>Silence</strong></span>. This will expire the existing silence and create one with the chosen configuration.
						</li></ol></div></section><section class="section" id="expiring-silences_managing-alerts"><div class="titlepage"><div><div><h3 class="title">10.4.3. Expiring silences</h3></div></div></div><p>
					You can expire a silence. Expiring a silence deactivates it forever.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						You cannot delete expired, silenced alerts. Expired silences older than 120 hours are garbage collected.
					</p></div></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						To expire a silence in the <span class="strong strong"><strong>Administrator</strong></span> perspective:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Alerting</strong></span> → <span class="strong strong"><strong>Silences</strong></span> page.
						</li><li class="listitem"><p class="simpara">
							For the silence you want to modify, select the 
							<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Monitoring-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
							 in the last column and choose <span class="strong strong"><strong>Expire silence</strong></span>.
						</p><p class="simpara">
							Alternatively, you can select <span class="strong strong"><strong>Actions</strong></span> → <span class="strong strong"><strong>Expire Silence</strong></span> in the <span class="strong strong"><strong>Silence Details</strong></span> page for a silence.
						</p></li></ol></div><p>
					To expire a silence in the <span class="strong strong"><strong>Developer</strong></span> perspective:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>&lt;project_name&gt;</strong></span> → <span class="strong strong"><strong>Alerts</strong></span> page.
						</li><li class="listitem">
							Expand the details for an alert by selecting <span class="strong strong"><strong>&gt;</strong></span> to the left of the alert name. Select the name of the alert in the expanded view to open the <span class="strong strong"><strong>Alert Details</strong></span> page for the alert.
						</li><li class="listitem">
							Select the name of a silence in the <span class="strong strong"><strong>Silenced By</strong></span> section in that page to navigate to the <span class="strong strong"><strong>Silence Details</strong></span> page for the silence.
						</li><li class="listitem">
							Select the name of a silence to navigate to its <span class="strong strong"><strong>Silence Details</strong></span> page.
						</li><li class="listitem">
							Select <span class="strong strong"><strong>Actions</strong></span> → <span class="strong strong"><strong>Expire Silence</strong></span> in the <span class="strong strong"><strong>Silence Details</strong></span> page for a silence.
						</li></ol></div></section></section><section class="section" id="managing-alerting-rules-for-user-defined-projects_managing-alerts"><div class="titlepage"><div><div><h2 class="title">10.5. Managing alerting rules for user-defined projects</h2></div></div></div><p>
				OpenShift Container Platform monitoring ships with a set of default alerting rules. As a cluster administrator, you can view the default alerting rules.
			</p><p>
				In OpenShift Container Platform 4.13, you can create, view, edit, and remove alerting rules in user-defined projects.
			</p><div class="itemizedlist"><p class="title"><strong>Alerting rule considerations</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The default alerting rules are used specifically for the OpenShift Container Platform cluster.
					</li><li class="listitem">
						Some alerting rules intentionally have identical names. They send alerts about the same event with different thresholds, different severity, or both.
					</li><li class="listitem">
						Inhibition rules prevent notifications for lower severity alerts that are firing when a higher severity alert is also firing.
					</li></ul></div><section class="section" id="Optimizing-alerting-for-user-defined-projects_managing-alerts"><div class="titlepage"><div><div><h3 class="title">10.5.1. Optimizing alerting for user-defined projects</h3></div></div></div><p>
					You can optimize alerting for your own projects by considering the following recommendations when creating alerting rules:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Minimize the number of alerting rules that you create for your project</strong></span>. Create alerting rules that notify you of conditions that impact you. It is more difficult to notice relevant alerts if you generate many alerts for conditions that do not impact you.
						</li><li class="listitem">
							<span class="strong strong"><strong>Create alerting rules for symptoms instead of causes</strong></span>. Create alerting rules that notify you of conditions regardless of the underlying cause. The cause can then be investigated. You will need many more alerting rules if each relates only to a specific cause. Some causes are then likely to be missed.
						</li><li class="listitem">
							<span class="strong strong"><strong>Plan before you write your alerting rules</strong></span>. Determine what symptoms are important to you and what actions you want to take if they occur. Then build an alerting rule for each symptom.
						</li><li class="listitem">
							<span class="strong strong"><strong>Provide clear alert messaging</strong></span>. State the symptom and recommended actions in the alert message.
						</li><li class="listitem">
							<span class="strong strong"><strong>Include severity levels in your alerting rules</strong></span>. The severity of an alert depends on how you need to react if the reported symptom occurs. For example, a critical alert should be triggered if a symptom requires immediate attention by an individual or a critical response team.
						</li><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>Optimize alert routing</strong></span>. Deploy an alerting rule directly on the Prometheus instance in the <code class="literal">openshift-user-workload-monitoring</code> project if the rule does not query default OpenShift Container Platform metrics. This reduces latency for alerting rules and minimizes the load on monitoring components.
						</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								Default OpenShift Container Platform metrics for user-defined projects provide information about CPU and memory usage, bandwidth statistics, and packet rate information. Those metrics cannot be included in an alerting rule if you route the rule directly to the Prometheus instance in the <code class="literal">openshift-user-workload-monitoring</code> project. Alerting rule optimization should be used only if you have read the documentation and have a comprehensive understanding of the monitoring architecture.
							</p></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							See the <a class="link" href="https://prometheus.io/docs/practices/alerting/">Prometheus alerting documentation</a> for further guidelines on optimizing alerts
						</li><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#monitoring-overview">Monitoring overview</a> for details about OpenShift Container Platform 4.13 monitoring architecture
						</li></ul></div></section><section class="section" id="creating-alerting-rules-for-user-defined-projects_managing-alerts"><div class="titlepage"><div><div><h3 class="title">10.5.2. Creating alerting rules for user-defined projects</h3></div></div></div><p>
					You can create alerting rules for user-defined projects. Those alerting rules will fire alerts based on the values of chosen metrics.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have enabled monitoring for user-defined projects.
						</li><li class="listitem">
							You are logged in as a user that has the <code class="literal">monitoring-rules-edit</code> cluster role for the project where you want to create an alerting rule.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Create a YAML file for alerting rules. In this example, it is called <code class="literal">example-app-alerting-rule.yaml</code>.
						</li><li class="listitem"><p class="simpara">
							Add an alerting rule configuration to the YAML file. For example:
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								When you create an alerting rule, a project label is enforced on it if a rule with the same name exists in another project.
							</p></div></div><pre class="programlisting language-yaml">apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: example-alert
  namespace: ns1
spec:
  groups:
  - name: example
    rules:
    - alert: VersionAlert
      expr: version{job="prometheus-example-app"} == 0</pre><p class="simpara">
							This configuration creates an alerting rule named <code class="literal">example-alert</code>. The alerting rule fires an alert when the <code class="literal">version</code> metric exposed by the sample service becomes <code class="literal">0</code>.
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								A user-defined alerting rule can include metrics for its own project and cluster metrics. You cannot include metrics for another user-defined project.
							</p><p>
								For example, an alerting rule for the user-defined project <code class="literal">ns1</code> can have metrics from <code class="literal">ns1</code> and cluster metrics, such as the CPU and memory metrics. However, the rule cannot include metrics from <code class="literal">ns2</code>.
							</p><p>
								Additionally, you cannot create alerting rules for the <code class="literal">openshift-*</code> core OpenShift Container Platform projects. OpenShift Container Platform monitoring by default provides a set of alerting rules for these projects.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Apply the configuration file to the cluster:
						</p><pre class="programlisting language-terminal">$ oc apply -f example-app-alerting-rule.yaml</pre><p class="simpara">
							It takes some time to create the alerting rule.
						</p></li></ol></div></section><section class="section" id="reducing-latency-for-alerting-rules-that-do-not-query-platform-metrics_managing-alerts"><div class="titlepage"><div><div><h3 class="title">10.5.3. Reducing latency for alerting rules that do not query platform metrics</h3></div></div></div><p>
					If an alerting rule for a user-defined project does not query default cluster metrics, you can deploy the rule directly on the Prometheus instance in the <code class="literal">openshift-user-workload-monitoring</code> project. This reduces latency for alerting rules by bypassing Thanos Ruler when it is not required. This also helps to minimize the overall load on monitoring components.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Default OpenShift Container Platform metrics for user-defined projects provide information about CPU and memory usage, bandwidth statistics, and packet rate information. Those metrics cannot be included in an alerting rule if you deploy the rule directly to the Prometheus instance in the <code class="literal">openshift-user-workload-monitoring</code> project. The procedure outlined in this section should only be used if you have read the documentation and have a comprehensive understanding of the monitoring architecture.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have enabled monitoring for user-defined projects.
						</li><li class="listitem">
							You are logged in as a user that has the <code class="literal">monitoring-rules-edit</code> cluster role for the project where you want to create an alerting rule.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Create a YAML file for alerting rules. In this example, it is called <code class="literal">example-app-alerting-rule.yaml</code>.
						</li><li class="listitem"><p class="simpara">
							Add an alerting rule configuration to the YAML file that includes a label with the key <code class="literal">openshift.io/prometheus-rule-evaluation-scope</code> and value <code class="literal">leaf-prometheus</code>. For example:
						</p><pre class="programlisting language-yaml">apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: example-alert
  namespace: ns1
  labels:
    openshift.io/prometheus-rule-evaluation-scope: leaf-prometheus
spec:
  groups:
  - name: example
    rules:
    - alert: VersionAlert
      expr: version{job="prometheus-example-app"} == 0</pre><p class="simpara">
							If that label is present, the alerting rule is deployed on the Prometheus instance in the <code class="literal">openshift-user-workload-monitoring</code> project. If the label is not present, the alerting rule is deployed to Thanos Ruler.
						</p></li><li class="listitem"><p class="simpara">
							Apply the configuration file to the cluster:
						</p><pre class="programlisting language-terminal">$ oc apply -f example-app-alerting-rule.yaml</pre><p class="simpara">
							It takes some time to create the alerting rule.
						</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#monitoring-overview">Monitoring overview</a> for details about OpenShift Container Platform 4.13 monitoring architecture.
						</li></ul></div></section><section class="section" id="accessing-alerting-rules-for-your-project_managing-alerts"><div class="titlepage"><div><div><h3 class="title">10.5.4. Accessing alerting rules for user-defined projects</h3></div></div></div><p>
					To list alerting rules for a user-defined project, you must have been assigned the <code class="literal">monitoring-rules-view</code> cluster role for the project.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have enabled monitoring for user-defined projects.
						</li><li class="listitem">
							You are logged in as a user that has the <code class="literal">monitoring-rules-view</code> cluster role for your project.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To list alerting rules in <code class="literal">&lt;project&gt;</code>:
						</p><pre class="programlisting language-terminal">$ oc -n &lt;project&gt; get prometheusrule</pre></li><li class="listitem"><p class="simpara">
							To list the configuration of an alerting rule, run the following:
						</p><pre class="programlisting language-terminal">$ oc -n &lt;project&gt; get prometheusrule &lt;rule&gt; -o yaml</pre></li></ol></div></section><section class="section" id="listing-alerting-rules-for-all-projects-in-a-single-view_managing-alerts"><div class="titlepage"><div><div><h3 class="title">10.5.5. Listing alerting rules for all projects in a single view</h3></div></div></div><p>
					As a cluster administrator, you can list alerting rules for core OpenShift Container Platform and user-defined projects together in a single view.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the <span class="strong strong"><strong>Administrator</strong></span> perspective, navigate to <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Alerting</strong></span> → <span class="strong strong"><strong>Alerting rules</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Select the <span class="strong strong"><strong>Platform</strong></span> and <span class="strong strong"><strong>User</strong></span> sources in the <span class="strong strong"><strong>Filter</strong></span> drop-down menu.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The <span class="strong strong"><strong>Platform</strong></span> source is selected by default.
							</p></div></div></li></ol></div></section><section class="section" id="removing-alerting-rules-for-user-defined-projects_managing-alerts"><div class="titlepage"><div><div><h3 class="title">10.5.6. Removing alerting rules for user-defined projects</h3></div></div></div><p>
					You can remove alerting rules for user-defined projects.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have enabled monitoring for user-defined projects.
						</li><li class="listitem">
							You are logged in as a user that has the <code class="literal">monitoring-rules-edit</code> cluster role for the project where you want to create an alerting rule.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To remove rule <code class="literal">&lt;foo&gt;</code> in <code class="literal">&lt;namespace&gt;</code>, run the following:
						</p><pre class="programlisting language-terminal">$ oc -n &lt;namespace&gt; delete prometheusrule &lt;foo&gt;</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							See the <a class="link" href="https://prometheus.io/docs/alerting/alertmanager/">Alertmanager documentation</a>
						</li></ul></div></section></section><section class="section" id="managing-core-platform-alerting-rules_managing-alerts"><div class="titlepage"><div><div><h2 class="title">10.6. Managing alerting rules for core platform monitoring</h2></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Creating and modifying alerting rules for core platform monitoring is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
				</p><p>
					For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
				</p></div></div><p>
				OpenShift Container Platform 4.13 monitoring ships with a large set of default alerting rules for platform metrics. As a cluster administrator, you can customize this set of rules in two ways:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Modify the settings for existing platform alerting rules by adjusting thresholds or by adding and modifying labels. For example, you can change the <code class="literal">severity</code> label for an alert from <code class="literal">warning</code> to <code class="literal">critical</code> to help you route and triage issues flagged by an alert.
					</li><li class="listitem">
						Define and add new custom alerting rules by constructing a query expression based on core platform metrics in the <code class="literal">openshift-monitoring</code> namespace.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Core platform alerting rule considerations</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						New alerting rules must be based on the default OpenShift Container Platform monitoring metrics.
					</li><li class="listitem">
						You can only add and modify alerting rules. You cannot create new recording rules or modify existing recording rules.
					</li><li class="listitem">
						If you modify existing platform alerting rules by using an <code class="literal">AlertRelabelConfig</code> object, your modifications are not reflected in the Prometheus alerts API. Therefore, any dropped alerts still appear in the OpenShift Container Platform web console even though they are no longer forwarded to Alertmanager. Additionally, any modifications to alerts, such as a changed <code class="literal">severity</code> label, do not appear in the web console.
					</li></ul></div><section class="section" id="modifying-core-platform-alerting-rules_managing-alerts"><div class="titlepage"><div><div><h3 class="title">10.6.1. Modifying core platform alerting rules</h3></div></div></div><p>
					As a cluster administrator, you can modify core platform alerts before Alertmanager routes them to a receiver. For example, you can change the severity label of an alert, add a custom label, or exclude an alert from being sent to Alertmanager.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li><li class="listitem">
							You have enabled Technology Preview features, and all nodes in the cluster are ready.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Create a new YAML configuration file named <code class="literal">example-modified-alerting-rule.yaml</code> in the <code class="literal">openshift-monitoring</code> namespace.
						</li><li class="listitem"><p class="simpara">
							Add an <code class="literal">AlertRelabelConfig</code> resource to the YAML file. The following example modifies the <code class="literal">severity</code> setting to <code class="literal">critical</code> for the default platform <code class="literal">watchdog</code> alerting rule:
						</p><pre class="programlisting language-yaml">apiVersion: monitoring.openshift.io/v1alpha1
kind: AlertRelabelConfig
metadata:
  name: watchdog
  namespace: openshift-monitoring
spec:
  configs:
  - sourceLabels: [alertname,severity] <span id="CO53-1"><!--Empty--></span><span class="callout">1</span>
    regex: "Watchdog;none" <span id="CO53-2"><!--Empty--></span><span class="callout">2</span>
    targetLabel: severity <span id="CO53-3"><!--Empty--></span><span class="callout">3</span>
    replacement: critical <span id="CO53-4"><!--Empty--></span><span class="callout">4</span>
    action: Replace <span id="CO53-5"><!--Empty--></span><span class="callout">5</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO53-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									The source labels for the values you want to modify.
								</div></dd><dt><a href="#CO53-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									The regular expression against which the value of <code class="literal">sourceLabels</code> is matched.
								</div></dd><dt><a href="#CO53-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									The target label of the value you want to modify.
								</div></dd><dt><a href="#CO53-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									The new value to replace the target label.
								</div></dd><dt><a href="#CO53-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									The relabel action that replaces the old value based on regex matching. The default action is <code class="literal">Replace</code>. Other possible values are <code class="literal">Keep</code>, <code class="literal">Drop</code>, <code class="literal">HashMod</code>, <code class="literal">LabelMap</code>, <code class="literal">LabelDrop</code>, and <code class="literal">LabelKeep</code>.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Apply the configuration file to the cluster:
						</p><pre class="programlisting language-terminal">$ oc apply -f example-modified-alerting-rule.yaml</pre></li></ol></div></section><section class="section" id="creating-new-alerting-rules_managing-alerts"><div class="titlepage"><div><div><h3 class="title">10.6.2. Creating new alerting rules</h3></div></div></div><p>
					As a cluster administrator, you can create new alerting rules based on platform metrics. These alerting rules trigger alerts based on the values of chosen metrics.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you create a customized <code class="literal">AlertingRule</code> resource based on an existing platform alerting rule, silence the original alert to avoid receiving conflicting alerts.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user that has the <code class="literal">cluster-admin</code> cluster role.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li><li class="listitem">
							You have enabled Technology Preview features, and all nodes in the cluster are ready.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Create a new YAML configuration file named <code class="literal">example-alerting-rule.yaml</code> in the <code class="literal">openshift-monitoring</code> namespace.
						</li><li class="listitem"><p class="simpara">
							Add an <code class="literal">AlertingRule</code> resource to the YAML file. The following example creates a new alerting rule named <code class="literal">example</code>, similar to the default <code class="literal">watchdog</code> alert:
						</p><pre class="programlisting language-yaml">apiVersion: monitoring.openshift.io/v1alpha1
kind: AlertingRule
metadata:
  name: example
  namespace: openshift-monitoring
spec:
  groups:
  - name: example-rules
    rules:
    - alert: ExampleAlert <span id="CO54-1"><!--Empty--></span><span class="callout">1</span>
      expr: vector(1) <span id="CO54-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO54-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									The name of the alerting rule you want to create.
								</div></dd><dt><a href="#CO54-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									The PromQL query expression that defines the new rule.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Apply the configuration file to the cluster:
						</p><pre class="programlisting language-terminal">$ oc apply -f example-alerting-rule.yaml</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#monitoring-overview">Monitoring overview</a> for details about OpenShift Container Platform 4.13 monitoring architecture.
						</li><li class="listitem">
							See the <a class="link" href="https://prometheus.io/docs/alerting/alertmanager/">Alertmanager documentation</a> for information about alerting rules.
						</li><li class="listitem">
							See the <a class="link" href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/#relabel_config">Prometheus relabeling documentation</a> for information about how relabeling works.
						</li><li class="listitem">
							See the <a class="link" href="https://prometheus.io/docs/practices/alerting/">Prometheus alerting documentation</a> for further guidelines on optimizing alerts.
						</li></ul></div></section></section><section class="section" id="sending-notifications-to-external-systems_managing-alerts"><div class="titlepage"><div><div><h2 class="title">10.7. Sending notifications to external systems</h2></div></div></div><p>
				In OpenShift Container Platform 4.13, firing alerts can be viewed in the Alerting UI. Alerts are not configured by default to be sent to any notification systems. You can configure OpenShift Container Platform to send alerts to the following receiver types:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						PagerDuty
					</li><li class="listitem">
						Webhook
					</li><li class="listitem">
						Email
					</li><li class="listitem">
						Slack
					</li></ul></div><p>
				Routing alerts to receivers enables you to send timely notifications to the appropriate teams when failures occur. For example, critical alerts require immediate attention and are typically paged to an individual or a critical response team. Alerts that provide non-critical warning notifications might instead be routed to a ticketing system for non-immediate review.
			</p><div class="formalpara"><p class="title"><strong>Checking that alerting is operational by using the watchdog alert</strong></p><p>
					OpenShift Container Platform monitoring includes a watchdog alert that fires continuously. Alertmanager repeatedly sends watchdog alert notifications to configured notification providers. The provider is usually configured to notify an administrator when it stops receiving the watchdog alert. This mechanism helps you quickly identify any communication issues between Alertmanager and the notification provider.
				</p></div><section class="section" id="configuring-alert-receivers_managing-alerts"><div class="titlepage"><div><div><h3 class="title">10.7.1. Configuring alert receivers</h3></div></div></div><p>
					You can configure alert receivers to ensure that you learn about important issues with your cluster.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							In the <span class="strong strong"><strong>Administrator</strong></span> perspective, navigate to <span class="strong strong"><strong>Administration</strong></span> → <span class="strong strong"><strong>Cluster Settings</strong></span> → <span class="strong strong"><strong>Configuration</strong></span> → <span class="strong strong"><strong>Alertmanager</strong></span>.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Alternatively, you can navigate to the same page through the notification drawer. Select the bell icon at the top right of the OpenShift Container Platform web console and choose <span class="strong strong"><strong>Configure</strong></span> in the <span class="strong strong"><strong>AlertmanagerReceiverNotConfigured</strong></span> alert.
							</p></div></div></li><li class="listitem">
							Select <span class="strong strong"><strong>Create Receiver</strong></span> in the <span class="strong strong"><strong>Receivers</strong></span> section of the page.
						</li><li class="listitem">
							In the <span class="strong strong"><strong>Create Receiver</strong></span> form, add a <span class="strong strong"><strong>Receiver Name</strong></span> and choose a <span class="strong strong"><strong>Receiver Type</strong></span> from the list.
						</li><li class="listitem"><p class="simpara">
							Edit the receiver configuration:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									For PagerDuty receivers:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
											Choose an integration type and add a PagerDuty integration key.
										</li><li class="listitem">
											Add the URL of your PagerDuty installation.
										</li><li class="listitem">
											Select <span class="strong strong"><strong>Show advanced configuration</strong></span> if you want to edit the client and incident details or the severity specification.
										</li></ol></div></li><li class="listitem"><p class="simpara">
									For webhook receivers:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
											Add the endpoint to send HTTP POST requests to.
										</li><li class="listitem">
											Select <span class="strong strong"><strong>Show advanced configuration</strong></span> if you want to edit the default option to send resolved alerts to the receiver.
										</li></ol></div></li><li class="listitem"><p class="simpara">
									For email receivers:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
											Add the email address to send notifications to.
										</li><li class="listitem">
											Add SMTP configuration details, including the address to send notifications from, the smarthost and port number used for sending emails, the hostname of the SMTP server, and authentication details.
										</li><li class="listitem">
											Choose whether TLS is required.
										</li><li class="listitem">
											Select <span class="strong strong"><strong>Show advanced configuration</strong></span> if you want to edit the default option not to send resolved alerts to the receiver or edit the body of email notifications configuration.
										</li></ol></div></li><li class="listitem"><p class="simpara">
									For Slack receivers:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
											Add the URL of the Slack webhook.
										</li><li class="listitem">
											Add the Slack channel or user name to send notifications to.
										</li><li class="listitem">
											Select <span class="strong strong"><strong>Show advanced configuration</strong></span> if you want to edit the default option not to send resolved alerts to the receiver or edit the icon and username configuration. You can also choose whether to find and link channel names and usernames.
										</li></ol></div></li></ul></div></li><li class="listitem"><p class="simpara">
							By default, firing alerts with labels that match all of the selectors will be sent to the receiver. If you want label values for firing alerts to be matched exactly before they are sent to the receiver:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Add routing label names and values in the <span class="strong strong"><strong>Routing Labels</strong></span> section of the form.
								</li><li class="listitem">
									Select <span class="strong strong"><strong>Regular Expression</strong></span> if want to use a regular expression.
								</li><li class="listitem">
									Select <span class="strong strong"><strong>Add Label</strong></span> to add further routing labels.
								</li></ol></div></li><li class="listitem">
							Select <span class="strong strong"><strong>Create</strong></span> to create the receiver.
						</li></ol></div></section><section class="section" id="creating-alert-routing-for-user-defined-projects_managing-alerts"><div class="titlepage"><div><div><h3 class="title">10.7.2. Creating alert routing for user-defined projects</h3></div></div></div><p class="_abstract _abstract">
					If you are a non-administrator user who has been given the <code class="literal">alert-routing-edit</code> cluster role, you can create or edit alert routing for user-defined projects.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							A cluster administrator has enabled monitoring for user-defined projects.
						</li><li class="listitem">
							A cluster administrator has enabled alert routing for user-defined projects.
						</li><li class="listitem">
							You are logged in as a user that has the <code class="literal">alert-routing-edit</code> cluster role for the project for which you want to create alert routing.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Create a YAML file for alert routing. The example in this procedure uses a file called <code class="literal">example-app-alert-routing.yaml</code>.
						</li><li class="listitem"><p class="simpara">
							Add an <code class="literal">AlertmanagerConfig</code> YAML definition to the file. For example:
						</p><pre class="programlisting language-yaml">apiVersion: monitoring.coreos.com/v1beta1
kind: AlertmanagerConfig
metadata:
  name: example-routing
  namespace: ns1
spec:
  route:
    receiver: default
    groupBy: [job]
  receivers:
  - name: default
    webhookConfigs:
    - url: https://example.org/post</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								For user-defined alerting rules, user-defined routing is scoped to the namespace in which the resource is defined. For example, a routing configuration defined in the <code class="literal">AlertmanagerConfig</code> object for namespace <code class="literal">ns1</code> only applies to <code class="literal">PrometheusRules</code> resources in the same namespace.
							</p></div></div></li><li class="listitem">
							Save the file.
						</li><li class="listitem"><p class="simpara">
							Apply the resource to the cluster:
						</p><pre class="programlisting language-terminal">$ oc apply -f example-app-alert-routing.yaml</pre><p class="simpara">
							The configuration is automatically applied to the Alertmanager pods.
						</p></li></ol></div></section></section><section class="section" id="applying-custom-alertmanager-configuration_managing-alerts"><div class="titlepage"><div><div><h2 class="title">10.8. Applying a custom Alertmanager configuration</h2></div></div></div><p>
				You can overwrite the default Alertmanager configuration by editing the <code class="literal">alertmanager-main</code> secret in the <code class="literal">openshift-monitoring</code> namespace for the platform instance of Alertmanager.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					To change the Alertmanager configuration from the CLI:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Print the currently active Alertmanager configuration into file <code class="literal">alertmanager.yaml</code>:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring get secret alertmanager-main --template='{{ index .data "alertmanager.yaml" }}' | base64 --decode &gt; alertmanager.yaml</pre></li><li class="listitem"><p class="simpara">
						Edit the configuration in <code class="literal">alertmanager.yaml</code>:
					</p><pre class="programlisting language-yaml">global:
  resolve_timeout: 5m
route:
  group_wait: 30s <span id="CO55-1"><!--Empty--></span><span class="callout">1</span>
  group_interval: 5m <span id="CO55-2"><!--Empty--></span><span class="callout">2</span>
  repeat_interval: 12h <span id="CO55-3"><!--Empty--></span><span class="callout">3</span>
  receiver: default
  routes:
  - matchers:
    - "alertname=Watchdog"
    repeat_interval: 2m
    receiver: watchdog
  - matchers:
    - "service=&lt;your_service&gt;" <span id="CO55-4"><!--Empty--></span><span class="callout">4</span>
    routes:
    - matchers:
      - &lt;your_matching_rules&gt; <span id="CO55-5"><!--Empty--></span><span class="callout">5</span>
      receiver: &lt;receiver&gt; <span id="CO55-6"><!--Empty--></span><span class="callout">6</span>
receivers:
- name: default
- name: watchdog
- name: &lt;receiver&gt;
#  &lt;receiver_configuration&gt;</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO55-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								The <code class="literal">group_wait</code> value specifies how long Alertmanager waits before sending an initial notification for a group of alerts. This value controls how long Alertmanager waits while collecting initial alerts for the same group before sending a notification.
							</div></dd><dt><a href="#CO55-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								The <code class="literal">group_interval</code> value specifies how much time must elapse before Alertmanager sends a notification about new alerts added to a group of alerts for which an initial notification was already sent.
							</div></dd><dt><a href="#CO55-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								The <code class="literal">repeat_interval</code> value specifies the minimum amount of time that must pass before an alert notification is repeated. If you want a notification to repeat at each group interval, set the <code class="literal">repeat_interval</code> value to less than the <code class="literal">group_interval</code> value. However, the repeated notification can still be delayed, for example, when certain Alertmanager pods are restarted or rescheduled.
							</div></dd><dt><a href="#CO55-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								The <code class="literal">service</code> value specifies the service that fires the alerts.
							</div></dd><dt><a href="#CO55-5"><span class="callout">5</span></a> </dt><dd><div class="para">
								The <code class="literal">&lt;your_matching_rules&gt;</code> value specifies the target alerts.
							</div></dd><dt><a href="#CO55-6"><span class="callout">6</span></a> </dt><dd><div class="para">
								The <code class="literal">receiver</code> value specifies the receiver to use for the alert.
							</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Use the <code class="literal">matchers</code> key name to indicate the matchers that an alert has to fulfill to match the node. Do not use the <code class="literal">match</code> or <code class="literal">match_re</code> key names, which are both deprecated and planned for removal in a future release.
						</p><p>
							In addition, if you define inhibition rules, use the <code class="literal">target_matchers</code> key name to indicate the target matchers and the <code class="literal">source_matchers</code> key name to indicate the source matchers. Do not use the <code class="literal">target_match</code>, <code class="literal">target_match_re</code>, <code class="literal">source_match</code>, or <code class="literal">source_match_re</code> key names, which are deprecated and planned for removal in a future release.
						</p></div></div><p class="simpara">
						The following Alertmanager configuration example configures PagerDuty as an alert receiver:
					</p><pre class="programlisting language-yaml">global:
  resolve_timeout: 5m
route:
  group_wait: 30s
  group_interval: 5m
  repeat_interval: 12h
  receiver: default
  routes:
  - matchers:
    - "alertname=Watchdog"
    repeat_interval: 2m
    receiver: watchdog
  - matchers:
    - "service=example-app"
    routes:
    - matchers:
      - "severity=critical"
      receiver: team-frontend-page*
receivers:
- name: default
- name: watchdog
- name: team-frontend-page
  pagerduty_configs:
  - service_key: "_your-key_"</pre><p class="simpara">
						With this configuration, alerts of <code class="literal">critical</code> severity that are fired by the <code class="literal">example-app</code> service are sent using the <code class="literal">team-frontend-page</code> receiver. Typically these types of alerts would be paged to an individual or a critical response team.
					</p></li><li class="listitem"><p class="simpara">
						Apply the new configuration in the file:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-monitoring create secret generic alertmanager-main --from-file=alertmanager.yaml --dry-run=client -o=yaml |  oc -n openshift-monitoring replace secret --filename=-</pre></li></ol></div><p>
				To change the Alertmanager configuration from the OpenShift Container Platform web console:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Navigate to the <span class="strong strong"><strong>Administration</strong></span> → <span class="strong strong"><strong>Cluster Settings</strong></span> → <span class="strong strong"><strong>Configuration</strong></span> → <span class="strong strong"><strong>Alertmanager</strong></span> → <span class="strong strong"><strong>YAML</strong></span> page of the web console.
					</li><li class="listitem">
						Modify the YAML configuration file.
					</li><li class="listitem">
						Select <span class="strong strong"><strong>Save</strong></span>.
					</li></ol></div></section><section class="section" id="applying-a-custom-configuration-to-alertmanager-for-user-defined-alert-routing_managing-alerts"><div class="titlepage"><div><div><h2 class="title">10.9. Applying a custom configuration to Alertmanager for user-defined alert routing</h2></div></div></div><p>
				If you have enabled a separate instance of Alertmanager dedicated to user-defined alert routing, you can overwrite the configuration for this instance of Alertmanager by editing the <code class="literal">alertmanager-user-workload</code> secret in the <code class="literal">openshift-user-workload-monitoring</code> namespace.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
					</li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Print the currently active Alertmanager configuration into the file <code class="literal">alertmanager.yaml</code>:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring get secret alertmanager-user-workload --template='{{ index .data "alertmanager.yaml" }}' | base64 --decode &gt; alertmanager.yaml</pre></li><li class="listitem"><p class="simpara">
						Edit the configuration in <code class="literal">alertmanager.yaml</code>:
					</p><pre class="programlisting language-yaml">route:
  receiver: Default
  group_by:
  - name: Default
  routes:
  - matchers:
    - "service = prometheus-example-monitor" <span id="CO56-1"><!--Empty--></span><span class="callout">1</span>
    receiver: &lt;receiver&gt; <span id="CO56-2"><!--Empty--></span><span class="callout">2</span>
receivers:
- name: Default
- name: &lt;receiver&gt;
#  &lt;receiver_configuration&gt;</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO56-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Specifies which alerts match the route. This example shows all alerts that have the <code class="literal">service="prometheus-example-monitor"</code> label.
							</div></dd><dt><a href="#CO56-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Specifies the receiver to use for the alerts group.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Apply the new configuration in the file:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring create secret generic alertmanager-user-workload --from-file=alertmanager.yaml --dry-run=client -o=yaml |  oc -n openshift-user-workload-monitoring replace secret --filename=-</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <a class="link" href="https://www.pagerduty.com/">the PagerDuty official site</a> for more information on PagerDuty.
					</li><li class="listitem">
						See <a class="link" href="https://www.pagerduty.com/docs/guides/prometheus-integration-guide/">the PagerDuty Prometheus Integration Guide</a> to learn how to retrieve the <code class="literal">service_key</code>.
					</li><li class="listitem">
						See <a class="link" href="https://prometheus.io/docs/alerting/configuration/">Alertmanager configuration</a> for configuring alerting through different alert receivers.
					</li><li class="listitem">
						See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#enabling-alert-routing-for-user-defined-projects">Enabling alert routing for user-defined projects</a> to learn how to enable a dedicated instance of Alertmanager for user-defined alert routing.
					</li></ul></div></section><section class="section" id="next-steps-4"><div class="titlepage"><div><div><h2 class="title">10.10. Next steps</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#reviewing-monitoring-dashboards">Reviewing monitoring dashboards</a>
					</li></ul></div></section></section><section class="chapter" id="reviewing-monitoring-dashboards"><div class="titlepage"><div><div><h1 class="title">Chapter 11. Reviewing monitoring dashboards</h1></div></div></div><p>
			OpenShift Container Platform 4.13 provides a comprehensive set of monitoring dashboards that help you understand the state of cluster components and user-defined workloads.
		</p><p>
			Use the <span class="strong strong"><strong>Administrator</strong></span> perspective to access dashboards for the core OpenShift Container Platform components, including the following items:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					API performance
				</li><li class="listitem">
					etcd
				</li><li class="listitem">
					Kubernetes compute resources
				</li><li class="listitem">
					Kubernetes network resources
				</li><li class="listitem">
					Prometheus
				</li><li class="listitem">
					USE method dashboards relating to cluster and node performance
				</li></ul></div><div class="figure" id="idm140408899014464"><p class="title"><strong>Figure 11.1. Example dashboard in the Administrator perspective</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Monitoring-en-US/images/07eb12a8940f9b9d8816198f840d6e76/monitoring-dashboard-administrator.png" alt="monitoring dashboard administrator"/></div></div></div><p>
			Use the <span class="strong strong"><strong>Developer</strong></span> perspective to access Kubernetes compute resources dashboards that provide the following application metrics for a selected project:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					CPU usage
				</li><li class="listitem">
					Memory usage
				</li><li class="listitem">
					Bandwidth information
				</li><li class="listitem">
					Packet rate information
				</li></ul></div><div class="figure" id="idm140408899004784"><p class="title"><strong>Figure 11.2. Example dashboard in the Developer perspective</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Monitoring-en-US/images/11da5c66c23f038344e924c0a8c4da33/observe-dashboard-developer.png" alt="observe dashboard developer"/></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				In the <span class="strong strong"><strong>Developer</strong></span> perspective, you can view dashboards for only one project at a time.
			</p></div></div><section class="section" id="reviewing-monitoring-dashboards-admin_reviewing-monitoring-dashboards"><div class="titlepage"><div><div><h2 class="title">11.1. Reviewing monitoring dashboards as a cluster administrator</h2></div></div></div><p>
				In the <span class="strong strong"><strong>Administrator</strong></span> perspective, you can view dashboards relating to core OpenShift Container Platform cluster components.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the <span class="strong strong"><strong>Administrator</strong></span> perspective in the OpenShift Container Platform web console, navigate to <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Dashboards</strong></span>.
					</li><li class="listitem">
						Choose a dashboard in the <span class="strong strong"><strong>Dashboard</strong></span> list. Some dashboards, such as <span class="strong strong"><strong>etcd</strong></span> and <span class="strong strong"><strong>Prometheus</strong></span> dashboards, produce additional sub-menus when selected.
					</li><li class="listitem"><p class="simpara">
						Optional: Select a time range for the graphs in the <span class="strong strong"><strong>Time Range</strong></span> list.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Select a pre-defined time period.
							</li><li class="listitem"><p class="simpara">
								Set a custom time range by selecting <span class="strong strong"><strong>Custom time range</strong></span> in the <span class="strong strong"><strong>Time Range</strong></span> list.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Input or select the <span class="strong strong"><strong>From</strong></span> and <span class="strong strong"><strong>To</strong></span> dates and times.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Save</strong></span> to save the custom time range.
									</li></ol></div></li></ul></div></li><li class="listitem">
						Optional: Select a <span class="strong strong"><strong>Refresh Interval</strong></span>.
					</li><li class="listitem">
						Hover over each of the graphs within a dashboard to display detailed information about specific items.
					</li></ol></div></section><section class="section" id="reviewing-monitoring-dashboards-developer_reviewing-monitoring-dashboards"><div class="titlepage"><div><div><h2 class="title">11.2. Reviewing monitoring dashboards as a developer</h2></div></div></div><p>
				In the <span class="strong strong"><strong>Developer</strong></span> perspective, you can view dashboards relating to a selected project. You must have access to monitor a project to view dashboard information for it.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a developer or as a user.
					</li><li class="listitem">
						You have view permissions for the project that you are viewing the dashboard for.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Developer perspective in the OpenShift Container Platform web console, navigate to <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Dashboard</strong></span>.
					</li><li class="listitem">
						Select a project from the <span class="strong strong"><strong>Project:</strong></span> drop-down list.
					</li><li class="listitem"><p class="simpara">
						Select a dashboard from the <span class="strong strong"><strong>Dashboard</strong></span> drop-down list to see the filtered metrics.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							All dashboards produce additional sub-menus when selected, except <span class="strong strong"><strong>Kubernetes / Compute Resources / Namespace (Pods)</strong></span>.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Optional: Select a time range for the graphs in the <span class="strong strong"><strong>Time Range</strong></span> list.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Select a pre-defined time period.
							</li><li class="listitem"><p class="simpara">
								Set a custom time range by selecting <span class="strong strong"><strong>Custom time range</strong></span> in the <span class="strong strong"><strong>Time Range</strong></span> list.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Input or select the <span class="strong strong"><strong>From</strong></span> and <span class="strong strong"><strong>To</strong></span> dates and times.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Save</strong></span> to save the custom time range.
									</li></ol></div></li></ul></div></li><li class="listitem">
						Optional: Select a <span class="strong strong"><strong>Refresh Interval</strong></span>.
					</li><li class="listitem">
						Hover over each of the graphs within a dashboard to display detailed information about specific items.
					</li></ol></div><div class="itemizedlist _additional-resources" id="additional-resources-reviewing-monitoring-dashboards"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/building_applications/#monitoring-project-and-application-metrics-using-developer-perspective">Monitoring project and application metrics using the Developer perspective</a>
					</li></ul></div></section><section class="section" id="next-steps_reviewing-monitoring-dashboards"><div class="titlepage"><div><div><h2 class="title">11.3. Next steps</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#accessing-third-party-monitoring-apis">Accessing third-party monitoring APIs</a>
					</li></ul></div></section></section><section class="chapter" id="using-rfhe"><div class="titlepage"><div><div><h1 class="title">Chapter 12. Monitoring bare-metal events with the Bare Metal Event Relay</h1></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
				Bare Metal Event Relay is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
			</p><p>
				For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
			</p></div></div><section class="section" id="about-using-redfish-hardware-events"><div class="titlepage"><div><div><h2 class="title">12.1. About bare-metal events</h2></div></div></div><p>
				Use the Bare Metal Event Relay to subscribe applications that run in your OpenShift Container Platform cluster to events that are generated on the underlying bare-metal host. The Redfish service publishes events on a node and transmits them on an advanced message queue to subscribed applications.
			</p><p>
				Bare-metal events are based on the open Redfish standard that is developed under the guidance of the Distributed Management Task Force (DMTF). Redfish provides a secure industry-standard protocol with a REST API. The protocol is used for the management of distributed, converged or software-defined resources and infrastructure.
			</p><p>
				Hardware-related events published through Redfish includes:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Breaches of temperature limits
					</li><li class="listitem">
						Server status
					</li><li class="listitem">
						Fan status
					</li></ul></div><p>
				Begin using bare-metal events by deploying the Bare Metal Event Relay Operator and subscribing your application to the service. The Bare Metal Event Relay Operator installs and manages the lifecycle of the Redfish bare-metal event service.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The Bare Metal Event Relay works only with Redfish-capable devices on single-node clusters provisioned on bare-metal infrastructure.
				</p></div></div></section><section class="section" id="nw-rfhe-introduction_using-rfhe"><div class="titlepage"><div><div><h2 class="title">12.2. How bare-metal events work</h2></div></div></div><p>
				The Bare Metal Event Relay enables applications running on bare-metal clusters to respond quickly to Redfish hardware changes and failures such as breaches of temperature thresholds, fan failure, disk loss, power outages, and memory failure. These hardware events are delivered over a reliable low-latency transport channel based on Advanced Message Queuing Protocol (AMQP). The latency of the messaging service is between 10 to 20 milliseconds.
			</p><p>
				The Bare Metal Event Relay provides a publish-subscribe service for the hardware events. Applications can use a REST API to subscribe to the events. The Bare Metal Event Relay supports hardware that complies with Redfish OpenAPI v1.8 or later.
			</p><section class="section" id="rfhe-elements_using-rfhe"><div class="titlepage"><div><div><h3 class="title">12.2.1. Bare Metal Event Relay data flow</h3></div></div></div><p>
					The following figure illustrates an example bare-metal events data flow:
				</p><div class="figure" id="idm140408902669248"><p class="title"><strong>Figure 12.1. Bare Metal Event Relay data flow</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Monitoring-en-US/images/fa52b76a8309238626fb6153b5c460e5/319_OpenShift_redfish_bare-metal_OCP_nodes_0323.png" alt="Bare-metal events data flow"/></div></div></div><section class="section" id="operator-managed-pod"><div class="titlepage"><div><div><h4 class="title">12.2.1.1. Operator-managed pod</h4></div></div></div><p>
						The Operator uses custom resources to manage the pod containing the Bare Metal Event Relay and its components using the <code class="literal">HardwareEvent</code> CR.
					</p></section><section class="section" id="bare-metal-event-relay"><div class="titlepage"><div><div><h4 class="title">12.2.1.2. Bare Metal Event Relay</h4></div></div></div><p>
						At startup, the Bare Metal Event Relay queries the Redfish API and downloads all the message registries, including custom registries. The Bare Metal Event Relay then begins to receive subscribed events from the Redfish hardware.
					</p><p>
						The Bare Metal Event Relay enables applications running on bare-metal clusters to respond quickly to Redfish hardware changes and failures such as breaches of temperature thresholds, fan failure, disk loss, power outages, and memory failure. The events are reported using the <code class="literal">HardwareEvent</code> CR.
					</p></section><section class="section" id="cloud-native-event"><div class="titlepage"><div><div><h4 class="title">12.2.1.3. Cloud native event</h4></div></div></div><p>
						Cloud native events (CNE) is a REST API specification for defining the format of event data.
					</p></section><section class="section" id="cncf-cloudevents"><div class="titlepage"><div><div><h4 class="title">12.2.1.4. CNCF CloudEvents</h4></div></div></div><p>
						<a class="link" href="https://cloudevents.io/">CloudEvents</a> is a vendor-neutral specification developed by the Cloud Native Computing Foundation (CNCF) for defining the format of event data.
					</p></section><section class="section" id="http-transport-or-amqp-dispatch-router"><div class="titlepage"><div><div><h4 class="title">12.2.1.5. HTTP transport or AMQP dispatch router</h4></div></div></div><p>
						The HTTP transport or AMQP dispatch router is responsible for the message delivery service between publisher and subscriber.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Use HTTP transport instead of AMQP for PTP and bare-metal events where possible. AMQ Interconnect is EOL from 30 June 2024. Extended life cycle support (ELS) for AMQ Interconnect ends 29 November 2029. For more information see, <a class="link" href="https://access.redhat.com/support/policy/updates/jboss_notes#p_Interconnect">Red Hat AMQ Interconnect support status</a>.
						</p></div></div></section><section class="section" id="cloud-event-proxy-sidecar"><div class="titlepage"><div><div><h4 class="title">12.2.1.6. Cloud event proxy sidecar</h4></div></div></div><p>
						The cloud event proxy sidecar container image is based on the O-RAN API specification and provides a publish-subscribe event framework for hardware events.
					</p></section></section><section class="section" id="rfhe-data-flow_using-rfhe"><div class="titlepage"><div><div><h3 class="title">12.2.2. Redfish message parsing service</h3></div></div></div><p>
					In addition to handling Redfish events, the Bare Metal Event Relay provides message parsing for events without a <code class="literal">Message</code> property. The proxy downloads all the Redfish message registries including vendor specific registries from the hardware when it starts. If an event does not contain a <code class="literal">Message</code> property, the proxy uses the Redfish message registries to construct the <code class="literal">Message</code> and <code class="literal">Resolution</code> properties and add them to the event before passing the event to the cloud events framework. This service allows Redfish events to have smaller message size and lower transmission latency.
				</p></section><section class="section" id="nw-rfhe-installing-operator-cli_using-rfhe"><div class="titlepage"><div><div><h3 class="title">12.2.3. Installing the Bare Metal Event Relay using the CLI</h3></div></div></div><p>
					As a cluster administrator, you can install the Bare Metal Event Relay Operator by using the CLI.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							A cluster that is installed on bare-metal hardware with nodes that have a RedFish-enabled Baseboard Management Controller (BMC).
						</li><li class="listitem">
							Install the OpenShift CLI (<code class="literal">oc</code>).
						</li><li class="listitem">
							Log in as a user with <code class="literal">cluster-admin</code> privileges.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a namespace for the Bare Metal Event Relay.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Save the following YAML in the <code class="literal">bare-metal-events-namespace.yaml</code> file:
								</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Namespace
metadata:
  name: openshift-bare-metal-events
  labels:
    name: openshift-bare-metal-events
    openshift.io/cluster-monitoring: "true"</pre></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">Namespace</code> CR:
								</p><pre class="programlisting language-terminal">$ oc create -f bare-metal-events-namespace.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create an Operator group for the Bare Metal Event Relay Operator.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Save the following YAML in the <code class="literal">bare-metal-events-operatorgroup.yaml</code> file:
								</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: bare-metal-event-relay-group
  namespace: openshift-bare-metal-events
spec:
  targetNamespaces:
  - openshift-bare-metal-events</pre></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">OperatorGroup</code> CR:
								</p><pre class="programlisting language-terminal">$ oc create -f bare-metal-events-operatorgroup.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Subscribe to the Bare Metal Event Relay.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Save the following YAML in the <code class="literal">bare-metal-events-sub.yaml</code> file:
								</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: bare-metal-event-relay-subscription
  namespace: openshift-bare-metal-events
spec:
  channel: "stable"
  name: bare-metal-event-relay
  source: redhat-operators
  sourceNamespace: openshift-marketplace</pre></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">Subscription</code> CR:
								</p><pre class="programlisting language-terminal">$ oc create -f bare-metal-events-sub.yaml</pre></li></ol></div></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
						To verify that the Bare Metal Event Relay Operator is installed, run the following command:
					</p></div><pre class="programlisting language-terminal">$ oc get csv -n openshift-bare-metal-events -o custom-columns=Name:.metadata.name,Phase:.status.phase</pre></section><section class="section" id="nw-rfhe-installing-operator-web-console_using-rfhe"><div class="titlepage"><div><div><h3 class="title">12.2.4. Installing the Bare Metal Event Relay using the web console</h3></div></div></div><p>
					As a cluster administrator, you can install the Bare Metal Event Relay Operator using the web console.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							A cluster that is installed on bare-metal hardware with nodes that have a RedFish-enabled Baseboard Management Controller (BMC).
						</li><li class="listitem">
							Log in as a user with <code class="literal">cluster-admin</code> privileges.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Install the Bare Metal Event Relay using the OpenShift Container Platform web console:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									In the OpenShift Container Platform web console, click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span>.
								</li><li class="listitem">
									Choose <span class="strong strong"><strong>Bare Metal Event Relay</strong></span> from the list of available Operators, and then click <span class="strong strong"><strong>Install</strong></span>.
								</li><li class="listitem">
									On the <span class="strong strong"><strong>Install Operator</strong></span> page, select or create a <span class="strong strong"><strong>Namespace</strong></span>, select <span class="strong strong"><strong>openshift-bare-metal-events</strong></span>, and then click <span class="strong strong"><strong>Install</strong></span>.
								</li></ol></div></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
						Optional: You can verify that the Operator installed successfully by performing the following check:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Switch to the <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> page.
						</li><li class="listitem"><p class="simpara">
							Ensure that <span class="strong strong"><strong>Bare Metal Event Relay</strong></span> is listed in the project with a <span class="strong strong"><strong>Status</strong></span> of <span class="strong strong"><strong>InstallSucceeded</strong></span>.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								During installation an Operator might display a <span class="strong strong"><strong>Failed</strong></span> status. If the installation later succeeds with an <span class="strong strong"><strong>InstallSucceeded</strong></span> message, you can ignore the <span class="strong strong"><strong>Failed</strong></span> message.
							</p></div></div></li></ol></div><p>
					If the Operator does not appear as installed, to troubleshoot further:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Go to the <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> page and inspect the <span class="strong strong"><strong>Operator Subscriptions</strong></span> and <span class="strong strong"><strong>Install Plans</strong></span> tabs for any failure or errors under <span class="strong strong"><strong>Status</strong></span>.
						</li><li class="listitem">
							Go to the <span class="strong strong"><strong>Workloads</strong></span> → <span class="strong strong"><strong>Pods</strong></span> page and check the logs for pods in the project namespace.
						</li></ul></div></section></section><section class="section" id="hw-installing-amq-interconnect-messaging-bus_using-rfhe"><div class="titlepage"><div><div><h2 class="title">12.3. Installing the AMQ messaging bus</h2></div></div></div><p>
				To pass Redfish bare-metal event notifications between publisher and subscriber on a node, you can install and configure an AMQ messaging bus to run locally on the node. You do this by installing the AMQ Interconnect Operator for use in the cluster.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Use HTTP transport instead of AMQP for PTP and bare-metal events where possible. AMQ Interconnect is EOL from 30 June 2024. Extended life cycle support (ELS) for AMQ Interconnect ends 29 November 2029. For more information see, <a class="link" href="https://access.redhat.com/support/policy/updates/jboss_notes#p_Interconnect">Red Hat AMQ Interconnect support status</a>.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Install the OpenShift Container Platform CLI (<code class="literal">oc</code>).
					</li><li class="listitem">
						Log in as a user with <code class="literal">cluster-admin</code> privileges.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Install the AMQ Interconnect Operator to its own <code class="literal">amq-interconnect</code> namespace. See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_amq/2021.q1/html/deploying_amq_interconnect_on_openshift/adding-operator-router-ocp">Installing the AMQ Interconnect Operator</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that the AMQ Interconnect Operator is available and the required pods are running:
					</p><pre class="programlisting language-terminal">$ oc get pods -n amq-interconnect</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">NAME                                    READY   STATUS    RESTARTS   AGE
amq-interconnect-645db76c76-k8ghs       1/1     Running   0          23h
interconnect-operator-5cb5fc7cc-4v7qm   1/1     Running   0          23h</pre>

						</p></div></li><li class="listitem"><p class="simpara">
						Verify that the required <code class="literal">bare-metal-event-relay</code> bare-metal event producer pod is running in the <code class="literal">openshift-bare-metal-events</code> namespace:
					</p><pre class="programlisting language-terminal">$ oc get pods -n openshift-bare-metal-events</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">NAME                                                            READY   STATUS    RESTARTS   AGE
hw-event-proxy-operator-controller-manager-74d5649b7c-dzgtl     2/2     Running   0          25s</pre>

						</p></div></li></ol></div></section><section class="section" id="subscribing-hw-events"><div class="titlepage"><div><div><h2 class="title">12.4. Subscribing to Redfish BMC bare-metal events for a cluster node</h2></div></div></div><p>
				You can subscribe to Redfish BMC events generated on a node in your cluster by creating a <code class="literal">BMCEventSubscription</code> custom resource (CR) for the node, creating a <code class="literal">HardwareEvent</code> CR for the event, and creating a <code class="literal">Secret</code> CR for the BMC.
			</p><section class="section" id="nw-rfhe-creating-bmc-event-sub_using-rfhe"><div class="titlepage"><div><div><h3 class="title">12.4.1. Subscribing to bare-metal events</h3></div></div></div><p>
					You can configure the baseboard management controller (BMC) to send bare-metal events to subscribed applications running in an OpenShift Container Platform cluster. Example Redfish bare-metal events include an increase in device temperature, or removal of a device. You subscribe applications to bare-metal events using a REST API.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						You can only create a <code class="literal">BMCEventSubscription</code> custom resource (CR) for physical hardware that supports Redfish and has a vendor interface set to <code class="literal">redfish</code> or <code class="literal">idrac-redfish</code>.
					</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Use the <code class="literal">BMCEventSubscription</code> CR to subscribe to predefined Redfish events. The Redfish standard does not provide an option to create specific alerts and thresholds. For example, to receive an alert event when an enclosure’s temperature exceeds 40° Celsius, you must manually configure the event according to the vendor’s recommendations.
					</p></div></div><p>
					Perform the following procedure to subscribe to bare-metal events for the node using a <code class="literal">BMCEventSubscription</code> CR.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Install the OpenShift CLI (<code class="literal">oc</code>).
						</li><li class="listitem">
							Log in as a user with <code class="literal">cluster-admin</code> privileges.
						</li><li class="listitem">
							Get the user name and password for the BMC.
						</li><li class="listitem"><p class="simpara">
							Deploy a bare-metal node with a Redfish-enabled Baseboard Management Controller (BMC) in your cluster, and enable Redfish events on the BMC.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Enabling Redfish events on specific hardware is outside the scope of this information. For more information about enabling Redfish events for your specific hardware, consult the BMC manufacturer documentation.
							</p></div></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Confirm that the node hardware has the Redfish <code class="literal">EventService</code> enabled by running the following <code class="literal">curl</code> command:
						</p><pre class="programlisting language-terminal">$ curl https://&lt;bmc_ip_address&gt;/redfish/v1/EventService --insecure -H 'Content-Type: application/json' -u "&lt;bmc_username&gt;:&lt;password&gt;"</pre><p class="simpara">
							where:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">bmc_ip_address</span></dt><dd>
										is the IP address of the BMC where the Redfish events are generated.
									</dd></dl></div><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">{
   "@odata.context": "/redfish/v1/$metadata#EventService.EventService",
   "@odata.id": "/redfish/v1/EventService",
   "@odata.type": "#EventService.v1_0_2.EventService",
   "Actions": {
      "#EventService.SubmitTestEvent": {
         "EventType@Redfish.AllowableValues": ["StatusChange", "ResourceUpdated", "ResourceAdded", "ResourceRemoved", "Alert"],
         "target": "/redfish/v1/EventService/Actions/EventService.SubmitTestEvent"
      }
   },
   "DeliveryRetryAttempts": 3,
   "DeliveryRetryIntervalSeconds": 30,
   "Description": "Event Service represents the properties for the service",
   "EventTypesForSubscription": ["StatusChange", "ResourceUpdated", "ResourceAdded", "ResourceRemoved", "Alert"],
   "EventTypesForSubscription@odata.count": 5,
   "Id": "EventService",
   "Name": "Event Service",
   "ServiceEnabled": true,
   "Status": {
      "Health": "OK",
      "HealthRollup": "OK",
      "State": "Enabled"
   },
   "Subscriptions": {
      "@odata.id": "/redfish/v1/EventService/Subscriptions"
   }
}</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Get the Bare Metal Event Relay service route for the cluster by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get route -n openshift-bare-metal-events</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME            HOST/PORT   PATH                                                                    SERVICES                 PORT   TERMINATION   WILDCARD
hw-event-proxy              hw-event-proxy-openshift-bare-metal-events.apps.compute-1.example.com   hw-event-proxy-service   9087   edge          None</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">BMCEventSubscription</code> resource to subscribe to the Redfish events:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Save the following YAML in the <code class="literal">bmc_sub.yaml</code> file:
								</p><pre class="programlisting language-yaml">apiVersion: metal3.io/v1alpha1
kind: BMCEventSubscription
metadata:
  name: sub-01
  namespace: openshift-machine-api
spec:
   hostName: &lt;hostname&gt; <span id="CO57-1"><!--Empty--></span><span class="callout">1</span>
   destination: &lt;proxy_service_url&gt; <span id="CO57-2"><!--Empty--></span><span class="callout">2</span>
   context: ''</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO57-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Specifies the name or UUID of the worker node where the Redfish events are generated.
										</div></dd><dt><a href="#CO57-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Specifies the bare-metal event proxy service, for example, <code class="literal"><a class="link" href="https://hw-event-proxy-openshift-bare-metal-events.apps.compute-1.example.com/webhook">https://hw-event-proxy-openshift-bare-metal-events.apps.compute-1.example.com/webhook</a></code>.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">BMCEventSubscription</code> CR:
								</p><pre class="programlisting language-terminal">$ oc create -f bmc_sub.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Optional: To delete the BMC event subscription, run the following command:
						</p><pre class="programlisting language-terminal">$ oc delete -f bmc_sub.yaml</pre></li><li class="listitem"><p class="simpara">
							Optional: To manually create a Redfish event subscription without creating a <code class="literal">BMCEventSubscription</code> CR, run the following <code class="literal">curl</code> command, specifying the BMC username and password.
						</p><pre class="programlisting language-terminal">$ curl -i -k -X POST -H "Content-Type: application/json"  -d '{"Destination": "https://&lt;proxy_service_url&gt;", "Protocol" : "Redfish", "EventTypes": ["Alert"], "Context": "root"}' -u &lt;bmc_username&gt;:&lt;password&gt; 'https://&lt;bmc_ip_address&gt;/redfish/v1/EventService/Subscriptions' –v</pre><p class="simpara">
							where:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">proxy_service_url</span></dt><dd>
										is the bare-metal event proxy service, for example, <code class="literal"><a class="link" href="https://hw-event-proxy-openshift-bare-metal-events.apps.compute-1.example.com/webhook">https://hw-event-proxy-openshift-bare-metal-events.apps.compute-1.example.com/webhook</a></code>.
									</dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">bmc_ip_address</span></dt><dd>
										is the IP address of the BMC where the Redfish events are generated.
									</dd></dl></div><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">HTTP/1.1 201 Created
Server: AMI MegaRAC Redfish Service
Location: /redfish/v1/EventService/Subscriptions/1
Allow: GET, POST
Access-Control-Allow-Origin: *
Access-Control-Expose-Headers: X-Auth-Token
Access-Control-Allow-Headers: X-Auth-Token
Access-Control-Allow-Credentials: true
Cache-Control: no-cache, must-revalidate
Link: &lt;http://redfish.dmtf.org/schemas/v1/EventDestination.v1_6_0.json&gt;; rel=describedby
Link: &lt;http://redfish.dmtf.org/schemas/v1/EventDestination.v1_6_0.json&gt;
Link: &lt;/redfish/v1/EventService/Subscriptions&gt;; path=
ETag: "1651135676"
Content-Type: application/json; charset=UTF-8
OData-Version: 4.0
Content-Length: 614
Date: Thu, 28 Apr 2022 08:47:57 GMT</pre>

							</p></div></li></ol></div></section><section class="section" id="nw-rfhe-querying-redfish-hardware-event-subs_using-rfhe"><div class="titlepage"><div><div><h3 class="title">12.4.2. Querying Redfish bare-metal event subscriptions with curl</h3></div></div></div><p>
					Some hardware vendors limit the amount of Redfish hardware event subscriptions. You can query the number of Redfish event subscriptions by using <code class="literal">curl</code>.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Get the user name and password for the BMC.
						</li><li class="listitem">
							Deploy a bare-metal node with a Redfish-enabled Baseboard Management Controller (BMC) in your cluster, and enable Redfish hardware events on the BMC.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Check the current subscriptions for the BMC by running the following <code class="literal">curl</code> command:
						</p><pre class="programlisting language-terminal">$ curl --globoff -H "Content-Type: application/json" -k -X GET --user &lt;bmc_username&gt;:&lt;password&gt; https://&lt;bmc_ip_address&gt;/redfish/v1/EventService/Subscriptions</pre><p class="simpara">
							where:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">bmc_ip_address</span></dt><dd>
										is the IP address of the BMC where the Redfish events are generated.
									</dd></dl></div><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">% Total % Received % Xferd Average Speed Time Time Time Current
Dload Upload Total Spent Left Speed
100 435 100 435 0 0 399 0 0:00:01 0:00:01 --:--:-- 399
{
  "@odata.context": "/redfish/v1/$metadata#EventDestinationCollection.EventDestinationCollection",
  "@odata.etag": ""
  1651137375 "",
  "@odata.id": "/redfish/v1/EventService/Subscriptions",
  "@odata.type": "#EventDestinationCollection.EventDestinationCollection",
  "Description": "Collection for Event Subscriptions",
  "Members": [
  {
    "@odata.id": "/redfish/v1/EventService/Subscriptions/1"
  }],
  "Members@odata.count": 1,
  "Name": "Event Subscriptions Collection"
}</pre>

							</p></div><p class="simpara">
							In this example, a single subscription is configured: <code class="literal">/redfish/v1/EventService/Subscriptions/1</code>.
						</p></li><li class="listitem"><p class="simpara">
							Optional: To remove the <code class="literal">/redfish/v1/EventService/Subscriptions/1</code> subscription with <code class="literal">curl</code>, run the following command, specifying the BMC username and password:
						</p><pre class="programlisting language-terminal">$ curl --globoff -L -w "%{http_code} %{url_effective}\n" -k -u &lt;bmc_username&gt;:&lt;password &gt;-H "Content-Type: application/json" -d '{}' -X DELETE https://&lt;bmc_ip_address&gt;/redfish/v1/EventService/Subscriptions/1</pre><p class="simpara">
							where:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">bmc_ip_address</span></dt><dd>
										is the IP address of the BMC where the Redfish events are generated.
									</dd></dl></div></li></ol></div></section><section class="section" id="nw-rfhe-creating-hardware-event_using-rfhe"><div class="titlepage"><div><div><h3 class="title">12.4.3. Creating the bare-metal event and Secret CRs</h3></div></div></div><p>
					To start using bare-metal events, create the <code class="literal">HardwareEvent</code> custom resource (CR) for the host where the Redfish hardware is present. Hardware events and faults are reported in the <code class="literal">hw-event-proxy</code> logs.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have installed the OpenShift Container Platform CLI (<code class="literal">oc</code>).
						</li><li class="listitem">
							You have logged in as a user with <code class="literal">cluster-admin</code> privileges.
						</li><li class="listitem">
							You have installed the Bare Metal Event Relay.
						</li><li class="listitem">
							You have created a <code class="literal">BMCEventSubscription</code> CR for the BMC Redfish hardware.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create the <code class="literal">HardwareEvent</code> custom resource (CR):
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Multiple <code class="literal">HardwareEvent</code> resources are not permitted.
							</p></div></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Save the following YAML in the <code class="literal">hw-event.yaml</code> file:
								</p><pre class="programlisting language-yaml">apiVersion: "event.redhat-cne.org/v1alpha1"
kind: "HardwareEvent"
metadata:
  name: "hardware-event"
spec:
  nodeSelector:
    node-role.kubernetes.io/hw-event: "" <span id="CO58-1"><!--Empty--></span><span class="callout">1</span>
  logLevel: "debug" <span id="CO58-2"><!--Empty--></span><span class="callout">2</span>
  msgParserTimeout: "10" <span id="CO58-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO58-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Required. Use the <code class="literal">nodeSelector</code> field to target nodes with the specified label, for example, <code class="literal">node-role.kubernetes.io/hw-event: ""</code>.
										</div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												In OpenShift Container Platform 4.13 or later, you do not need to set the <code class="literal">spec.transportHost</code> field in the <code class="literal">HardwareEvent</code> resource when you use HTTP transport for bare-metal events. Set <code class="literal">transportHost</code> only when you use AMQP transport for bare-metal events.
											</p></div></div></dd><dt><a href="#CO58-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Optional. The default value is <code class="literal">debug</code>. Sets the log level in <code class="literal">hw-event-proxy</code> logs. The following log levels are available: <code class="literal">fatal</code>, <code class="literal">error</code>, <code class="literal">warning</code>, <code class="literal">info</code>, <code class="literal">debug</code>, <code class="literal">trace</code>.
										</div></dd><dt><a href="#CO58-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Optional. Sets the timeout value in milliseconds for the Message Parser. If a message parsing request is not responded to within the timeout duration, the original hardware event message is passed to the cloud native event framework. The default value is 10.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Apply the <code class="literal">HardwareEvent</code> CR in the cluster:
								</p><pre class="programlisting language-terminal">$ oc create -f hardware-event.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create a BMC username and password <code class="literal">Secret</code> CR that enables the hardware events proxy to access the Redfish message registry for the bare-metal host.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Save the following YAML in the <code class="literal">hw-event-bmc-secret.yaml</code> file:
								</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Secret
metadata:
  name: redfish-basic-auth
type: Opaque
stringData: <span id="CO59-1"><!--Empty--></span><span class="callout">1</span>
  username: &lt;bmc_username&gt;
  password: &lt;bmc_password&gt;
  # BMC host DNS or IP address
  hostaddr: &lt;bmc_host_ip_address&gt;</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO59-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Enter plain text values for the various items under <code class="literal">stringData</code>.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">Secret</code> CR:
								</p><pre class="programlisting language-terminal">$ oc create -f hw-event-bmc-secret.yaml</pre></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/storage/#persistent-storage-using-local-volume">Persistent storage using local volumes</a>
						</li></ul></div></section></section><section class="section" id="cnf-rfhe-notifications-api-refererence_using-rfhe"><div class="titlepage"><div><div><h2 class="title">12.5. Subscribing applications to bare-metal events REST API reference</h2></div></div></div><p>
				Use the bare-metal events REST API to subscribe an application to the bare-metal events that are generated on the parent node.
			</p><p>
				Subscribe applications to Redfish events by using the resource address <code class="literal">/cluster/node/&lt;node_name&gt;/redfish/event</code>, where <code class="literal">&lt;node_name&gt;</code> is the cluster node running the application.
			</p><p>
				Deploy your <code class="literal">cloud-event-consumer</code> application container and <code class="literal">cloud-event-proxy</code> sidecar container in a separate application pod. The <code class="literal">cloud-event-consumer</code> application subscribes to the <code class="literal">cloud-event-proxy</code> container in the application pod.
			</p><p>
				Use the following API endpoints to subscribe the <code class="literal">cloud-event-consumer</code> application to Redfish events posted by the <code class="literal">cloud-event-proxy</code> container at <code class="literal">http://localhost:8089/api/ocloudNotifications/v1/</code> in the application pod:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<code class="literal">/api/ocloudNotifications/v1/subscriptions</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">POST</code>: Creates a new subscription
							</li><li class="listitem">
								<code class="literal">GET</code>: Retrieves a list of subscriptions
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<code class="literal">/api/ocloudNotifications/v1/subscriptions/&lt;subscription_id&gt;</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">GET</code>: Returns details for the specified subscription ID
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<code class="literal">api/ocloudNotifications/v1/subscriptions/status/&lt;subscription_id&gt;</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">PUT</code>: Creates a new status ping request for the specified subscription ID
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<code class="literal">/api/ocloudNotifications/v1/health</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">GET</code>: Returns the health status of <code class="literal">ocloudNotifications</code> API
							</li></ul></div></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					<code class="literal">9089</code> is the default port for the <code class="literal">cloud-event-consumer</code> container deployed in the application pod. You can configure a different port for your application as required.
				</p></div></div><h4 id="api-ocloudnotifications-v1-subscriptions">api/ocloudNotifications/v1/subscriptions</h4><h5 id="http-method">HTTP method</h5><p>
				<code class="literal">GET api/ocloudNotifications/v1/subscriptions</code>
			</p><h6 id="description">Description</h6><p>
				Returns a list of subscriptions. If subscriptions exist, a <code class="literal">200 OK</code> status code is returned along with the list of subscriptions.
			</p><div class="formalpara"><p class="title"><strong>Example API response</strong></p><p>
					
<pre class="programlisting language-json">[
 {
  "id": "ca11ab76-86f9-428c-8d3a-666c24e34d32",
  "endpointUri": "http://localhost:9089/api/ocloudNotifications/v1/dummy",
  "uriLocation": "http://localhost:8089/api/ocloudNotifications/v1/subscriptions/ca11ab76-86f9-428c-8d3a-666c24e34d32",
  "resource": "/cluster/node/openshift-worker-0.openshift.example.com/redfish/event"
 }
]</pre>

				</p></div><h5 id="http-method-2">HTTP method</h5><p>
				<code class="literal">POST api/ocloudNotifications/v1/subscriptions</code>
			</p><h6 id="description-2">Description</h6><p>
				Creates a new subscription. If a subscription is successfully created, or if it already exists, a <code class="literal">201 Created</code> status code is returned.
			</p><div class="table" id="idm140408901978288"><p class="title"><strong>Table 12.1. Query parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408901973456" scope="col">Parameter</th><th align="left" valign="top" id="idm140408901972368" scope="col">Type</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408901973456"> <p>
								subscription
							</p>
							 </td><td align="left" valign="top" headers="idm140408901972368"> <p>
								data
							</p>
							 </td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example payload</strong></p><p>
					
<pre class="programlisting language-json">{
  "uriLocation": "http://localhost:8089/api/ocloudNotifications/v1/subscriptions",
  "resource": "/cluster/node/openshift-worker-0.openshift.example.com/redfish/event"
}</pre>

				</p></div><h4 id="api-ocloudnotifications-v1-subscriptions-subscription_id">api/ocloudNotifications/v1/subscriptions/&lt;subscription_id&gt;</h4><h5 id="http-method-3">HTTP method</h5><p>
				<code class="literal">GET api/ocloudNotifications/v1/subscriptions/&lt;subscription_id&gt;</code>
			</p><h6 id="description-3">Description</h6><p>
				Returns details for the subscription with ID <code class="literal">&lt;subscription_id&gt;</code>
			</p><div class="table" id="idm140408900066928"><p class="title"><strong>Table 12.2. Query parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408900062096" scope="col">Parameter</th><th align="left" valign="top" id="idm140408900061008" scope="col">Type</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408900062096"> <p>
								<code class="literal">&lt;subscription_id&gt;</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140408900061008"> <p>
								string
							</p>
							 </td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example API response</strong></p><p>
					
<pre class="programlisting language-json">{
  "id":"ca11ab76-86f9-428c-8d3a-666c24e34d32",
  "endpointUri":"http://localhost:9089/api/ocloudNotifications/v1/dummy",
  "uriLocation":"http://localhost:8089/api/ocloudNotifications/v1/subscriptions/ca11ab76-86f9-428c-8d3a-666c24e34d32",
  "resource":"/cluster/node/openshift-worker-0.openshift.example.com/redfish/event"
}</pre>

				</p></div><h4 id="api-ocloudnotifications-v1-subscriptions-status-subscription_id">api/ocloudNotifications/v1/subscriptions/status/&lt;subscription_id&gt;</h4><h5 id="http-method-4">HTTP method</h5><p>
				<code class="literal">PUT api/ocloudNotifications/v1/subscriptions/status/&lt;subscription_id&gt;</code>
			</p><h6 id="description-4">Description</h6><p>
				Creates a new status ping request for subscription with ID <code class="literal">&lt;subscription_id&gt;</code>. If a subscription is present, the status request is successful and a <code class="literal">202 Accepted</code> status code is returned.
			</p><div class="table" id="idm140408900044448"><p class="title"><strong>Table 12.3. Query parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408900039616" scope="col">Parameter</th><th align="left" valign="top" id="idm140408900038528" scope="col">Type</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408900039616"> <p>
								<code class="literal">&lt;subscription_id&gt;</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140408900038528"> <p>
								string
							</p>
							 </td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example API response</strong></p><p>
					
<pre class="programlisting language-json">{"status":"ping sent"}</pre>

				</p></div><h4 id="api-ocloudnotifications-v1-health">api/ocloudNotifications/v1/health/</h4><h5 id="http-method-5">HTTP method</h5><p>
				<code class="literal">GET api/ocloudNotifications/v1/health/</code>
			</p><h6 id="description-5">Description</h6><p>
				Returns the health status for the <code class="literal">ocloudNotifications</code> REST API.
			</p><div class="formalpara"><p class="title"><strong>Example API response</strong></p><p>
					
<pre class="programlisting language-terminal">OK</pre>

				</p></div></section><section class="section" id="cnf-migrating-from-amqp-to-http-transport_using-rfhe"><div class="titlepage"><div><div><h2 class="title">12.6. Migrating consumer applications to use HTTP transport for PTP or bare-metal events</h2></div></div></div><p>
				If you have previously deployed PTP or bare-metal events consumer applications, you need to update the applications to use HTTP message transport.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li><li class="listitem">
						You have logged in as a user with <code class="literal">cluster-admin</code> privileges.
					</li><li class="listitem">
						You have updated the PTP Operator or Bare Metal Event Relay to version 4.13+ which uses HTTP transport by default.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Update your events consumer application to use HTTP transport. Set the <code class="literal">http-event-publishers</code> variable for the cloud event sidecar deployment.
					</p><p class="simpara">
						For example, in a cluster with PTP events configured, the following YAML snippet illustrates a cloud event sidecar deployment:
					</p><pre class="programlisting language-yaml">containers:
  - name: cloud-event-sidecar
    image: cloud-event-sidecar
    args:
      - "--metrics-addr=127.0.0.1:9091"
      - "--store-path=/store"
      - "--transport-host=consumer-events-subscription-service.cloud-events.svc.cluster.local:9043"
      - "--http-event-publishers=ptp-event-publisher-service-NODE_NAME.openshift-ptp.svc.cluster.local:9043" <span id="CO60-1"><!--Empty--></span><span class="callout">1</span>
      - "--api-port=8089"</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO60-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								The PTP Operator automatically resolves <code class="literal">NODE_NAME</code> to the host that is generating the PTP events. For example, <code class="literal">compute-1.example.com</code>.
							</div></dd></dl></div><p class="simpara">
						In a cluster with bare-metal events configured, set the <code class="literal">http-event-publishers</code> field to <code class="literal">hw-event-publisher-service.openshift-bare-metal-events.svc.cluster.local:9043</code> in the cloud event sidecar deployment CR.
					</p></li><li class="listitem"><p class="simpara">
						Deploy the <code class="literal">consumer-events-subscription-service</code> service alongside the events consumer application. For example:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Service
metadata:
  annotations:
    prometheus.io/scrape: "true"
    service.alpha.openshift.io/serving-cert-secret-name: sidecar-consumer-secret
  name: consumer-events-subscription-service
  namespace: cloud-events
  labels:
    app: consumer-service
spec:
  ports:
    - name: sub-port
      port: 9043
  selector:
    app: consumer
  clusterIP: None
  sessionAffinity: None
  type: ClusterIP</pre></li></ol></div></section></section><section class="chapter" id="accessing-third-party-monitoring-apis"><div class="titlepage"><div><div><h1 class="title">Chapter 13. Accessing third-party monitoring APIs</h1></div></div></div><p class="_abstract _abstract">
			In OpenShift Container Platform 4.13, you can access web service APIs for some third-party monitoring components from the command line interface (CLI).
		</p><section class="section" id="accessing-third-party-monitoring-web-service-apis_accessing-third-party-monitoring-apis"><div class="titlepage"><div><div><h2 class="title">13.1. Accessing third-party monitoring web service APIs</h2></div></div></div><p class="_abstract _abstract">
				You can directly access third-party web service APIs from the command line for the following monitoring stack components: Prometheus, Alertmanager, Thanos Ruler, and Thanos Querier.
			</p><p>
				The following example commands show how to query the service API receivers for Alertmanager. This example requires that the associated user account be bound against the <code class="literal">monitoring-alertmanager-edit</code> role in the <code class="literal">openshift-monitoring</code> namespace and that the account has the privilege to view the route. This access only supports using a Bearer Token for authentication.
			</p><pre class="programlisting language-terminal">$ oc login -u &lt;username&gt; -p &lt;password&gt;</pre><pre class="programlisting language-terminal">$ host=$(oc -n openshift-monitoring get route alertmanager-main -ojsonpath={.spec.host})</pre><pre class="programlisting language-terminal">$ token=$(oc whoami -t)</pre><pre class="programlisting language-terminal">$ curl -H "Authorization: Bearer $token" -k "https://$host/api/v2/receivers"</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					To access Thanos Ruler and Thanos Querier service APIs, the requesting account must have <code class="literal">get</code> permission on the namespaces resource, which can be done by granting the <code class="literal">cluster-monitoring-view</code> cluster role to the account.
				</p></div></div></section><section class="section" id="monitoring-querying-metrics-by-using-the-federation-endpoint-for-prometheus_accessing-third-party-monitoring-apis"><div class="titlepage"><div><div><h2 class="title">13.2. Querying metrics by using the federation endpoint for Prometheus</h2></div></div></div><p>
				You can use the federation endpoint to scrape platform and user-defined metrics from a network location outside the cluster. To do so, access the Prometheus <code class="literal">/federate</code> endpoint for the cluster via an OpenShift Container Platform route.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					A delay in retrieving metrics data occurs when you use federation. This delay can affect the accuracy and timeliness of the scraped metrics.
				</p><p>
					Using the federation endpoint can also degrade the performance and scalability of your cluster, especially if you use the federation endpoint to retrieve large amounts of metrics data. To avoid these issues, follow these recommendations:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Do not try to retrieve all metrics data via the federation endpoint. Query it only when you want to retrieve a limited, aggregated data set. For example, retrieving fewer than 1,000 samples for each request helps minimize the risk of performance degradation.
						</li><li class="listitem">
							Avoid querying the federation endpoint frequently. Limit queries to a maximum of one every 30 seconds.
						</li></ul></div><p>
					If you need to forward large amounts of data outside the cluster, use remote write instead. For more information, see the <span class="emphasis"><em>Configuring remote write storage</em></span> section.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li><li class="listitem">
						You have obtained the host URL for the OpenShift Container Platform route.
					</li><li class="listitem"><p class="simpara">
						You have access to the cluster as a user with the <code class="literal">cluster-monitoring-view</code> cluster role or have obtained a bearer token with <code class="literal">get</code> permission on the <code class="literal">namespaces</code> resource.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You can only use bearer token authentication to access the federation endpoint.
						</p></div></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Retrieve the bearer token:
					</p><pre class="programlisting language-terminal">$ token=`oc whoami -t`</pre></li><li class="listitem"><p class="simpara">
						Query metrics from the <code class="literal">/federate</code> route. The following example queries <code class="literal">up</code> metrics:
					</p><pre class="programlisting language-terminal">$ curl -G -s -k -H "Authorization: Bearer $token" \
    'https://&lt;federation_host&gt;/federate' \ <span id="CO61-1"><!--Empty--></span><span class="callout">1</span>
    --data-urlencode 'match[]=up'</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO61-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								For &lt;federation_host&gt;, substitute the host URL for the federation route.
							</div></dd></dl></div><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal"># TYPE up untyped
up{apiserver="kube-apiserver",endpoint="https",instance="10.0.143.148:6443",job="apiserver",namespace="default",service="kubernetes",prometheus="openshift-monitoring/k8s",prometheus_replica="prometheus-k8s-0"} 1 1657035322214
up{apiserver="kube-apiserver",endpoint="https",instance="10.0.148.166:6443",job="apiserver",namespace="default",service="kubernetes",prometheus="openshift-monitoring/k8s",prometheus_replica="prometheus-k8s-0"} 1 1657035338597
up{apiserver="kube-apiserver",endpoint="https",instance="10.0.173.16:6443",job="apiserver",namespace="default",service="kubernetes",prometheus="openshift-monitoring/k8s",prometheus_replica="prometheus-k8s-0"} 1 1657035343834
...</pre>

						</p></div></li></ol></div></section><section class="section _additional-resources" id="additional-resources_accessing-third-party-monitoring-apis"><div class="titlepage"><div><div><h2 class="title">13.3. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#configuring_remote_write_storage_configuring-the-monitoring-stack">Configuring remote write storage</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#managing-metrics">Managing metrics</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#managing-alerts">Managing alerts</a>
					</li></ul></div></section></section><section class="chapter" id="troubleshooting-monitoring-issues"><div class="titlepage"><div><div><h1 class="title">Chapter 14. Troubleshooting monitoring issues</h1></div></div></div><p>
			Find troubleshooting steps for common issues with core platform and user-defined project monitoring.
		</p><section class="section" id="investigating-why-user-defined-metrics-are-unavailable_troubleshooting-monitoring-issues"><div class="titlepage"><div><div><h2 class="title">14.1. Investigating why user-defined project metrics are unavailable</h2></div></div></div><p>
				<code class="literal">ServiceMonitor</code> resources enable you to determine how to use the metrics exposed by a service in user-defined projects. Follow the steps outlined in this procedure if you have created a <code class="literal">ServiceMonitor</code> resource but cannot see any corresponding metrics in the Metrics UI.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
					</li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li><li class="listitem">
						You have enabled and configured monitoring for user-defined workloads.
					</li><li class="listitem">
						You have created the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object.
					</li><li class="listitem">
						You have created a <code class="literal">ServiceMonitor</code> resource.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Check that the corresponding labels match</strong></span> in the service and <code class="literal">ServiceMonitor</code> resource configurations.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Obtain the label defined in the service. The following example queries the <code class="literal">prometheus-example-app</code> service in the <code class="literal">ns1</code> project:
							</p><pre class="programlisting language-terminal">$ oc -n ns1 get service prometheus-example-app -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">  labels:
    app: prometheus-example-app</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Check that the <code class="literal">matchLabels</code> <code class="literal">app</code> label in the <code class="literal">ServiceMonitor</code> resource configuration matches the label output in the preceding step:
							</p><pre class="programlisting language-terminal">$ oc -n ns1 get servicemonitor prometheus-example-monitor -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="screen">spec:
  endpoints:
  - interval: 30s
    port: web
    scheme: http
  selector:
    matchLabels:
      app: prometheus-example-app</pre>

								</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									You can check service and <code class="literal">ServiceMonitor</code> resource labels as a developer with view permissions for the project.
								</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Inspect the logs for the Prometheus Operator</strong></span> in the <code class="literal">openshift-user-workload-monitoring</code> project.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								List the pods in the <code class="literal">openshift-user-workload-monitoring</code> project:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring get pods</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                   READY   STATUS    RESTARTS   AGE
prometheus-operator-776fcbbd56-2nbfm   2/2     Running   0          132m
prometheus-user-workload-0             5/5     Running   1          132m
prometheus-user-workload-1             5/5     Running   1          132m
thanos-ruler-user-workload-0           3/3     Running   0          132m
thanos-ruler-user-workload-1           3/3     Running   0          132m</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Obtain the logs from the <code class="literal">prometheus-operator</code> container in the <code class="literal">prometheus-operator</code> pod. In the following example, the pod is called <code class="literal">prometheus-operator-776fcbbd56-2nbfm</code>:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring logs prometheus-operator-776fcbbd56-2nbfm -c prometheus-operator</pre><p class="simpara">
								If there is a issue with the service monitor, the logs might include an error similar to this example:
							</p><pre class="programlisting language-terminal">level=warn ts=2020-08-10T11:48:20.906739623Z caller=operator.go:1829 component=prometheusoperator msg="skipping servicemonitor" error="it accesses file system via bearer token file which Prometheus specification prohibits" servicemonitor=eagle/eagle namespace=openshift-user-workload-monitoring prometheus=user-workload</pre></li></ol></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Review the target status for your endpoint</strong></span> on the <span class="strong strong"><strong>Metrics targets</strong></span> page in the OpenShift Container Platform web console UI.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Log in to the OpenShift Container Platform web console and navigate to <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Targets</strong></span> in the <span class="strong strong"><strong>Administrator</strong></span> perspective.
							</li><li class="listitem">
								Locate the metrics endpoint in the list, and review the status of the target in the <span class="strong strong"><strong>Status</strong></span> column.
							</li><li class="listitem">
								If the <span class="strong strong"><strong>Status</strong></span> is <span class="strong strong"><strong>Down</strong></span>, click the URL for the endpoint to view more information on the <span class="strong strong"><strong>Target Details</strong></span> page for that metrics target.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Configure debug level logging for the Prometheus Operator</strong></span> in the <code class="literal">openshift-user-workload-monitoring</code> project.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Edit the <code class="literal">user-workload-monitoring-config</code> <code class="literal">ConfigMap</code> object in the <code class="literal">openshift-user-workload-monitoring</code> project:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring edit configmap user-workload-monitoring-config</pre></li><li class="listitem"><p class="simpara">
								Add <code class="literal">logLevel: debug</code> for <code class="literal">prometheusOperator</code> under <code class="literal">data/config.yaml</code> to set the log level to <code class="literal">debug</code>:
							</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-workload-monitoring-config
  namespace: openshift-user-workload-monitoring
data:
  config.yaml: |
    prometheusOperator:
      logLevel: debug</pre></li><li class="listitem"><p class="simpara">
								Save the file to apply the changes.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The <code class="literal">prometheus-operator</code> in the <code class="literal">openshift-user-workload-monitoring</code> project restarts automatically when you apply the log-level change.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Confirm that the <code class="literal">debug</code> log-level has been applied to the <code class="literal">prometheus-operator</code> deployment in the <code class="literal">openshift-user-workload-monitoring</code> project:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring get deploy prometheus-operator -o yaml |  grep "log-level"</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">        - --log-level=debug</pre>

								</p></div><p class="simpara">
								Debug level logging will show all calls made by the Prometheus Operator.
							</p></li><li class="listitem"><p class="simpara">
								Check that the <code class="literal">prometheus-operator</code> pod is running:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-user-workload-monitoring get pods</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									If an unrecognized Prometheus Operator <code class="literal">loglevel</code> value is included in the config map, the <code class="literal">prometheus-operator</code> pod might not restart successfully.
								</p></div></div></li><li class="listitem">
								Review the debug logs to see if the Prometheus Operator is using the <code class="literal">ServiceMonitor</code> resource. Review the logs for other related errors.
							</li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#creating-user-defined-workload-monitoring-configmap_configuring-the-monitoring-stack">Creating a user-defined workload monitoring config map</a>
					</li><li class="listitem">
						See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#specifying-how-a-service-is-monitored_managing-metrics">Specifying how a service is monitored</a> for details on how to create a <code class="literal">ServiceMonitor</code> or <code class="literal">PodMonitor</code> resource
					</li><li class="listitem">
						See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#getting-detailed-information-about-a-target_managing-metrics">Getting detailed information about metrics targets</a>
					</li></ul></div></section><section class="section" id="determining-why-prometheus-is-consuming-disk-space_troubleshooting-monitoring-issues"><div class="titlepage"><div><div><h2 class="title">14.2. Determining why Prometheus is consuming a lot of disk space</h2></div></div></div><p>
				Developers can create labels to define attributes for metrics in the form of key-value pairs. The number of potential key-value pairs corresponds to the number of possible values for an attribute. An attribute that has an unlimited number of potential values is called an unbound attribute. For example, a <code class="literal">customer_id</code> attribute is unbound because it has an infinite number of possible values.
			</p><p>
				Every assigned key-value pair has a unique time series. The use of many unbound attributes in labels can result in an exponential increase in the number of time series created. This can impact Prometheus performance and can consume a lot of disk space.
			</p><p>
				You can use the following measures when Prometheus consumes a lot of disk:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>Check the number of scrape samples</strong></span> that are being collected.
					</li><li class="listitem">
						<span class="strong strong"><strong>Check the time series database (TSDB) status using the Prometheus HTTP API</strong></span> for more information about which labels are creating the most time series. Doing so requires cluster administrator privileges.
					</li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Reduce the number of unique time series that are created</strong></span> by reducing the number of unbound attributes that are assigned to user-defined metrics.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Using attributes that are bound to a limited set of possible values reduces the number of potential key-value pair combinations.
						</p></div></div></li><li class="listitem">
						<span class="strong strong"><strong>Enforce limits on the number of samples that can be scraped</strong></span> across user-defined projects. This requires cluster administrator privileges.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> cluster role.
					</li><li class="listitem">
						You have installed the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the <span class="strong strong"><strong>Administrator</strong></span> perspective, navigate to <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Metrics</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Run the following Prometheus Query Language (PromQL) query in the <span class="strong strong"><strong>Expression</strong></span> field. This returns the ten metrics that have the highest number of scrape samples:
					</p><pre class="programlisting language-terminal">topk(10,count by (job)({__name__=~".+"}))</pre></li><li class="listitem"><p class="simpara">
						Investigate the number of unbound label values assigned to metrics with higher than expected scrape sample counts.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>If the metrics relate to a user-defined project</strong></span>, review the metrics key-value pairs assigned to your workload. These are implemented through Prometheus client libraries at the application level. Try to limit the number of unbound attributes referenced in your labels.
							</li><li class="listitem">
								<span class="strong strong"><strong>If the metrics relate to a core OpenShift Container Platform project</strong></span>, create a Red Hat support case on the <a class="link" href="https://access.redhat.com/">Red Hat Customer Portal</a>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Review the TSDB status using the Prometheus HTTP API by running the following commands as a cluster administrator:
					</p><pre class="programlisting language-terminal">$ oc login -u &lt;username&gt; -p &lt;password&gt;</pre><pre class="programlisting language-terminal">$ host=$(oc -n openshift-monitoring get route prometheus-k8s -ojsonpath={.spec.host})</pre><pre class="programlisting language-terminal">$ token=$(oc whoami -t)</pre><pre class="programlisting language-terminal">$ curl -H "Authorization: Bearer $token" -k "https://$host/api/v1/status/tsdb"</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">"status": "success",</pre>

						</p></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#setting-scrape-sample-and-label-limits-for-user-defined-projects_configuring-the-monitoring-stack">Setting a scrape sample limit for user-defined projects</a> for details on how to set a scrape sample limit and create related alerting rules
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/support/#support-submitting-a-case_getting-support">Submitting a support case</a>
					</li></ul></div></section></section><section class="chapter" id="config-map-reference-for-the-cluster-monitoring-operator"><div class="titlepage"><div><div><h1 class="title">Chapter 15. Config map reference for the Cluster Monitoring Operator</h1></div></div></div><section class="section" id="cluster-monitoring-operator-configuration-reference"><div class="titlepage"><div><div><h2 class="title">15.1. Cluster Monitoring Operator configuration reference</h2></div></div></div><p class="_abstract _abstract">
				Parts of OpenShift Container Platform cluster monitoring are configurable. The API is accessible by setting parameters defined in various config maps.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						To configure monitoring components, edit the <code class="literal">ConfigMap</code> object named <code class="literal">cluster-monitoring-config</code> in the <code class="literal">openshift-monitoring</code> namespace. These configurations are defined by <a class="link" href="#clustermonitoringconfiguration" title="15.5. ClusterMonitoringConfiguration">ClusterMonitoringConfiguration</a>.
					</li><li class="listitem">
						To configure monitoring components that monitor user-defined projects, edit the <code class="literal">ConfigMap</code> object named <code class="literal">user-workload-monitoring-config</code> in the <code class="literal">openshift-user-workload-monitoring</code> namespace. These configurations are defined by <a class="link" href="#userworkloadconfiguration" title="15.25. UserWorkloadConfiguration">UserWorkloadConfiguration</a>.
					</li></ul></div><p>
				The configuration file is always defined under the <code class="literal">config.yaml</code> key in the config map data.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Not all configuration parameters are exposed.
						</li><li class="listitem">
							Configuring cluster monitoring is optional.
						</li><li class="listitem">
							If a configuration does not exist or is empty, default values are used.
						</li><li class="listitem">
							If the configuration is invalid YAML data, the Cluster Monitoring Operator stops reconciling the resources and reports <code class="literal">Degraded=True</code> in the status conditions of the Operator.
						</li></ul></div></div></div></section><section class="section" id="additionalalertmanagerconfig"><div class="titlepage"><div><div><h2 class="title">15.2. AdditionalAlertmanagerConfig</h2></div></div></div><section class="section" id="description-6"><div class="titlepage"><div><div><h3 class="title">15.2.1. Description</h3></div></div></div><p>
					The <code class="literal">AdditionalAlertmanagerConfig</code> resource defines settings for how a component communicates with additional Alertmanager instances.
				</p></section><section class="section" id="required"><div class="titlepage"><div><div><h3 class="title">15.2.2. Required</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">apiVersion</code>
						</li></ul></div><p>
					Appears in: <a class="link" href="#prometheusk8sconfig" title="15.17. PrometheusK8sConfig">PrometheusK8sConfig</a>, <a class="link" href="#prometheusrestrictedconfig" title="15.19. PrometheusRestrictedConfig">PrometheusRestrictedConfig</a>, <a class="link" href="#thanosrulerconfig" title="15.24. ThanosRulerConfig">ThanosRulerConfig</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408900949744" scope="col">Property</th><th align="left" valign="top" id="idm140408900948656" scope="col">Type</th><th align="left" valign="top" id="idm140408900947568" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408900949744"> <p>
									apiVersion
								</p>
								 </td><td align="left" valign="top" headers="idm140408900948656"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408900947568"> <p>
									Defines the API version of Alertmanager. Possible values are <code class="literal">v1</code> or <code class="literal">v2</code>. The default is <code class="literal">v2</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900949744"> <p>
									bearerToken
								</p>
								 </td><td align="left" valign="top" headers="idm140408900948656"> <p>
									*v1.SecretKeySelector
								</p>
								 </td><td align="left" valign="top" headers="idm140408900947568"> <p>
									Defines the secret key reference containing the bearer token to use when authenticating to Alertmanager.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900949744"> <p>
									pathPrefix
								</p>
								 </td><td align="left" valign="top" headers="idm140408900948656"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408900947568"> <p>
									Defines the path prefix to add in front of the push endpoint path.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900949744"> <p>
									scheme
								</p>
								 </td><td align="left" valign="top" headers="idm140408900948656"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408900947568"> <p>
									Defines the URL scheme to use when communicating with Alertmanager instances. Possible values are <code class="literal">http</code> or <code class="literal">https</code>. The default value is <code class="literal">http</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900949744"> <p>
									staticConfigs
								</p>
								 </td><td align="left" valign="top" headers="idm140408900948656"> <p>
									[]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408900947568"> <p>
									A list of statically configured Alertmanager endpoints in the form of <code class="literal">&lt;hosts&gt;:&lt;port&gt;</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900949744"> <p>
									timeout
								</p>
								 </td><td align="left" valign="top" headers="idm140408900948656"> <p>
									*string
								</p>
								 </td><td align="left" valign="top" headers="idm140408900947568"> <p>
									Defines the timeout value used when sending alerts.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900949744"> <p>
									tlsConfig
								</p>
								 </td><td align="left" valign="top" headers="idm140408900948656"> <p>
									<a class="link" href="#tlsconfig" title="15.21. TLSConfig">TLSConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408900947568"> <p>
									Defines the TLS settings to use for Alertmanager connections.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="alertmanagermainconfig"><div class="titlepage"><div><div><h2 class="title">15.3. AlertmanagerMainConfig</h2></div></div></div><section class="section" id="description-7"><div class="titlepage"><div><div><h3 class="title">15.3.1. Description</h3></div></div></div><p>
					The <code class="literal">AlertmanagerMainConfig</code> resource defines settings for the Alertmanager component in the <code class="literal">openshift-monitoring</code> namespace.
				</p><p>
					Appears in: <a class="link" href="#clustermonitoringconfiguration" title="15.5. ClusterMonitoringConfiguration">ClusterMonitoringConfiguration</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408902554704" scope="col">Property</th><th align="left" valign="top" id="idm140408902553616" scope="col">Type</th><th align="left" valign="top" id="idm140408902552528" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408902554704"> <p>
									enabled
								</p>
								 </td><td align="left" valign="top" headers="idm140408902553616"> <p>
									*bool
								</p>
								 </td><td align="left" valign="top" headers="idm140408902552528"> <p>
									A Boolean flag that enables or disables the main Alertmanager instance in the <code class="literal">openshift-monitoring</code> namespace. The default value is <code class="literal">true</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408902554704"> <p>
									enableUserAlertmanagerConfig
								</p>
								 </td><td align="left" valign="top" headers="idm140408902553616"> <p>
									bool
								</p>
								 </td><td align="left" valign="top" headers="idm140408902552528"> <p>
									A Boolean flag that enables or disables user-defined namespaces to be selected for <code class="literal">AlertmanagerConfig</code> lookups. This setting only applies if the user workload monitoring instance of Alertmanager is not enabled. The default value is <code class="literal">false</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408902554704"> <p>
									logLevel
								</p>
								 </td><td align="left" valign="top" headers="idm140408902553616"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408902552528"> <p>
									Defines the log level setting for Alertmanager. The possible values are: <code class="literal">error</code>, <code class="literal">warn</code>, <code class="literal">info</code>, <code class="literal">debug</code>. The default value is <code class="literal">info</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408902554704"> <p>
									nodeSelector
								</p>
								 </td><td align="left" valign="top" headers="idm140408902553616"> <p>
									map[string]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408902552528"> <p>
									Defines the nodes on which the Pods are scheduled.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408902554704"> <p>
									resources
								</p>
								 </td><td align="left" valign="top" headers="idm140408902553616"> <p>
									*v1.ResourceRequirements
								</p>
								 </td><td align="left" valign="top" headers="idm140408902552528"> <p>
									Defines resource requests and limits for the Alertmanager container.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408902554704"> <p>
									secrets
								</p>
								 </td><td align="left" valign="top" headers="idm140408902553616"> <p>
									[]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408902552528"> <p>
									Defines a list of secrets to be mounted into Alertmanager. The secrets must reside within the same namespace as the Alertmanager object. They are added as volumes named <code class="literal">secret-&lt;secret-name&gt;</code> and mounted at <code class="literal">/etc/alertmanager/secrets/&lt;secret-name&gt;</code> in the <code class="literal">alertmanager</code> container of the Alertmanager pods.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408902554704"> <p>
									tolerations
								</p>
								 </td><td align="left" valign="top" headers="idm140408902553616"> <p>
									[]v1.Toleration
								</p>
								 </td><td align="left" valign="top" headers="idm140408902552528"> <p>
									Defines tolerations for the pods.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408902554704"> <p>
									topologySpreadConstraints
								</p>
								 </td><td align="left" valign="top" headers="idm140408902553616"> <p>
									[]v1.TopologySpreadConstraint
								</p>
								 </td><td align="left" valign="top" headers="idm140408902552528"> <p>
									Defines a pod’s topology spread constraints.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408902554704"> <p>
									volumeClaimTemplate
								</p>
								 </td><td align="left" valign="top" headers="idm140408902553616"> <p>
									*monv1.EmbeddedPersistentVolumeClaim
								</p>
								 </td><td align="left" valign="top" headers="idm140408902552528"> <p>
									Defines persistent storage for Alertmanager. Use this setting to configure the persistent volume claim, including storage class, volume size, and name.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="alertmanageruserworkloadconfig"><div class="titlepage"><div><div><h2 class="title">15.4. AlertmanagerUserWorkloadConfig</h2></div></div></div><section class="section" id="description-8"><div class="titlepage"><div><div><h3 class="title">15.4.1. Description</h3></div></div></div><p>
					The <code class="literal">AlertmanagerUserWorkloadConfig</code> resource defines the settings for the Alertmanager instance used for user-defined projects.
				</p><p>
					Appears in: <a class="link" href="#userworkloadconfiguration" title="15.25. UserWorkloadConfiguration">UserWorkloadConfiguration</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408900324096" scope="col">Property</th><th align="left" valign="top" id="idm140408900323008" scope="col">Type</th><th align="left" valign="top" id="idm140408900321920" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408900324096"> <p>
									enabled
								</p>
								 </td><td align="left" valign="top" headers="idm140408900323008"> <p>
									bool
								</p>
								 </td><td align="left" valign="top" headers="idm140408900321920"> <p>
									A Boolean flag that enables or disables a dedicated instance of Alertmanager for user-defined alerts in the <code class="literal">openshift-user-workload-monitoring</code> namespace. The default value is <code class="literal">false</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900324096"> <p>
									enableAlertmanagerConfig
								</p>
								 </td><td align="left" valign="top" headers="idm140408900323008"> <p>
									bool
								</p>
								 </td><td align="left" valign="top" headers="idm140408900321920"> <p>
									A Boolean flag to enable or disable user-defined namespaces to be selected for <code class="literal">AlertmanagerConfig</code> lookup. The default value is <code class="literal">false</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900324096"> <p>
									logLevel
								</p>
								 </td><td align="left" valign="top" headers="idm140408900323008"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408900321920"> <p>
									Defines the log level setting for Alertmanager for user workload monitoring. The possible values are <code class="literal">error</code>, <code class="literal">warn</code>, <code class="literal">info</code>, and <code class="literal">debug</code>. The default value is <code class="literal">info</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900324096"> <p>
									resources
								</p>
								 </td><td align="left" valign="top" headers="idm140408900323008"> <p>
									*v1.ResourceRequirements
								</p>
								 </td><td align="left" valign="top" headers="idm140408900321920"> <p>
									Defines resource requests and limits for the Alertmanager container.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900324096"> <p>
									secrets
								</p>
								 </td><td align="left" valign="top" headers="idm140408900323008"> <p>
									[]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408900321920"> <p>
									Defines a list of secrets to be mounted into Alertmanager. The secrets must be located within the same namespace as the Alertmanager object. They are added as volumes named <code class="literal">secret-&lt;secret-name&gt;</code> and mounted at <code class="literal">/etc/alertmanager/secrets/&lt;secret-name&gt;</code> in the <code class="literal">alertmanager</code> container of the Alertmanager pods.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900324096"> <p>
									nodeSelector
								</p>
								 </td><td align="left" valign="top" headers="idm140408900323008"> <p>
									map[string]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408900321920"> <p>
									Defines the nodes on which the pods are scheduled.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900324096"> <p>
									tolerations
								</p>
								 </td><td align="left" valign="top" headers="idm140408900323008"> <p>
									[]v1.Toleration
								</p>
								 </td><td align="left" valign="top" headers="idm140408900321920"> <p>
									Defines tolerations for the pods.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900324096"> <p>
									volumeClaimTemplate
								</p>
								 </td><td align="left" valign="top" headers="idm140408900323008"> <p>
									*monv1.EmbeddedPersistentVolumeClaim
								</p>
								 </td><td align="left" valign="top" headers="idm140408900321920"> <p>
									Defines persistent storage for Alertmanager. Use this setting to configure the persistent volume claim, including storage class, volume size and name.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="clustermonitoringconfiguration"><div class="titlepage"><div><div><h2 class="title">15.5. ClusterMonitoringConfiguration</h2></div></div></div><section class="section" id="description-9"><div class="titlepage"><div><div><h3 class="title">15.5.1. Description</h3></div></div></div><p>
					The <code class="literal">ClusterMonitoringConfiguration</code> resource defines settings that customize the default platform monitoring stack through the <code class="literal">cluster-monitoring-config</code> config map in the <code class="literal">openshift-monitoring</code> namespace.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408901122736" scope="col">Property</th><th align="left" valign="top" id="idm140408901121648" scope="col">Type</th><th align="left" valign="top" id="idm140408901120560" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408901122736"> <p>
									alertmanagerMain
								</p>
								 </td><td align="left" valign="top" headers="idm140408901121648"> <p>
									*<a class="link" href="#alertmanagermainconfig" title="15.3. AlertmanagerMainConfig">AlertmanagerMainConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901120560"> <p>
									<code class="literal">AlertmanagerMainConfig</code> defines settings for the Alertmanager component in the <code class="literal">openshift-monitoring</code> namespace.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901122736"> <p>
									enableUserWorkload
								</p>
								 </td><td align="left" valign="top" headers="idm140408901121648"> <p>
									*bool
								</p>
								 </td><td align="left" valign="top" headers="idm140408901120560"> <p>
									<code class="literal">UserWorkloadEnabled</code> is a Boolean flag that enables monitoring for user-defined projects.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901122736"> <p>
									k8sPrometheusAdapter
								</p>
								 </td><td align="left" valign="top" headers="idm140408901121648"> <p>
									*<a class="link" href="#k8sprometheusadapter" title="15.7. K8sPrometheusAdapter">K8sPrometheusAdapter</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901120560"> <p>
									<code class="literal">K8sPrometheusAdapter</code> defines settings for the Prometheus Adapter component.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901122736"> <p>
									kubeStateMetrics
								</p>
								 </td><td align="left" valign="top" headers="idm140408901121648"> <p>
									*<a class="link" href="#kubestatemetricsconfig" title="15.8. KubeStateMetricsConfig">KubeStateMetricsConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901120560"> <p>
									<code class="literal">KubeStateMetricsConfig</code> defines settings for the <code class="literal">kube-state-metrics</code> agent.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901122736"> <p>
									prometheusK8s
								</p>
								 </td><td align="left" valign="top" headers="idm140408901121648"> <p>
									*<a class="link" href="#prometheusk8sconfig" title="15.17. PrometheusK8sConfig">PrometheusK8sConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901120560"> <p>
									<code class="literal">PrometheusK8sConfig</code> defines settings for the Prometheus component.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901122736"> <p>
									prometheusOperator
								</p>
								 </td><td align="left" valign="top" headers="idm140408901121648"> <p>
									*<a class="link" href="#prometheusoperatorconfig" title="15.18. PrometheusOperatorConfig">PrometheusOperatorConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901120560"> <p>
									<code class="literal">PrometheusOperatorConfig</code> defines settings for the Prometheus Operator component.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901122736"> <p>
									openshiftStateMetrics
								</p>
								 </td><td align="left" valign="top" headers="idm140408901121648"> <p>
									*<a class="link" href="#openshiftstatemetricsconfig" title="15.16. OpenShiftStateMetricsConfig">OpenShiftStateMetricsConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901120560"> <p>
									<code class="literal">OpenShiftMetricsConfig</code> defines settings for the <code class="literal">openshift-state-metrics</code> agent.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901122736"> <p>
									telemeterClient
								</p>
								 </td><td align="left" valign="top" headers="idm140408901121648"> <p>
									*<a class="link" href="#telemeterclientconfig" title="15.22. TelemeterClientConfig">TelemeterClientConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901120560"> <p>
									<code class="literal">TelemeterClientConfig</code> defines settings for the Telemeter Client component.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901122736"> <p>
									thanosQuerier
								</p>
								 </td><td align="left" valign="top" headers="idm140408901121648"> <p>
									*<a class="link" href="#thanosquerierconfig" title="15.23. ThanosQuerierConfig">ThanosQuerierConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901120560"> <p>
									<code class="literal">ThanosQuerierConfig</code> defines settings for the Thanos Querier component.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901122736"> <p>
									nodeExporter
								</p>
								 </td><td align="left" valign="top" headers="idm140408901121648"> <p>
									<a class="link" href="#nodeexporterconfig" title="15.15. NodeExporterConfig">NodeExporterConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901120560"> <p>
									<code class="literal">NodeExporterConfig</code> defines settings for the <code class="literal">node-exporter</code> agent.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="dedicatedservicemonitors"><div class="titlepage"><div><div><h2 class="title">15.6. DedicatedServiceMonitors</h2></div></div></div><section class="section" id="description-10"><div class="titlepage"><div><div><h3 class="title">15.6.1. Description</h3></div></div></div><p>
					You can use the <code class="literal">DedicatedServiceMonitors</code> resource to configure dedicated Service Monitors for the Prometheus Adapter
				</p><p>
					Appears in: <a class="link" href="#k8sprometheusadapter" title="15.7. K8sPrometheusAdapter">K8sPrometheusAdapter</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408901867088" scope="col">Property</th><th align="left" valign="top" id="idm140408901866000" scope="col">Type</th><th align="left" valign="top" id="idm140408901864912" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408901867088"> <p>
									enabled
								</p>
								 </td><td align="left" valign="top" headers="idm140408901866000"> <p>
									bool
								</p>
								 </td><td align="left" valign="top" headers="idm140408901864912"> <p>
									When <code class="literal">enabled</code> is set to <code class="literal">true</code>, the Cluster Monitoring Operator (CMO) deploys a dedicated Service Monitor that exposes the kubelet <code class="literal">/metrics/resource</code> endpoint. This Service Monitor sets <code class="literal">honorTimestamps: true</code> and only keeps metrics that are relevant for the pod resource queries of Prometheus Adapter. Additionally, Prometheus Adapter is configured to use these dedicated metrics. Overall, this feature improves the consistency of Prometheus Adapter-based CPU usage measurements used by, for example, the <code class="literal">oc adm top pod</code> command or the Horizontal Pod Autoscaler.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="k8sprometheusadapter"><div class="titlepage"><div><div><h2 class="title">15.7. K8sPrometheusAdapter</h2></div></div></div><section class="section" id="description-11"><div class="titlepage"><div><div><h3 class="title">15.7.1. Description</h3></div></div></div><p>
					The <code class="literal">K8sPrometheusAdapter</code> resource defines settings for the Prometheus Adapter component.
				</p><p>
					Appears in: <a class="link" href="#clustermonitoringconfiguration" title="15.5. ClusterMonitoringConfiguration">ClusterMonitoringConfiguration</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408901843584" scope="col">Property</th><th align="left" valign="top" id="idm140408901842496" scope="col">Type</th><th align="left" valign="top" id="idm140408901841408" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408901843584"> <p>
									audit
								</p>
								 </td><td align="left" valign="top" headers="idm140408901842496"> <p>
									*Audit
								</p>
								 </td><td align="left" valign="top" headers="idm140408901841408"> <p>
									Defines the audit configuration used by the Prometheus Adapter instance. Possible profile values are: <code class="literal">metadata</code>, <code class="literal">request</code>, <code class="literal">requestresponse</code>, and <code class="literal">none</code>. The default value is <code class="literal">metadata</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901843584"> <p>
									nodeSelector
								</p>
								 </td><td align="left" valign="top" headers="idm140408901842496"> <p>
									map[string]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408901841408"> <p>
									Defines the nodes on which the pods are scheduled.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901843584"> <p>
									tolerations
								</p>
								 </td><td align="left" valign="top" headers="idm140408901842496"> <p>
									[]v1.Toleration
								</p>
								 </td><td align="left" valign="top" headers="idm140408901841408"> <p>
									Defines tolerations for the pods.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901843584"> <p>
									dedicatedServiceMonitors
								</p>
								 </td><td align="left" valign="top" headers="idm140408901842496"> <p>
									*<a class="link" href="#dedicatedservicemonitors" title="15.6. DedicatedServiceMonitors">DedicatedServiceMonitors</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901841408"> <p>
									Defines dedicated service monitors.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="kubestatemetricsconfig"><div class="titlepage"><div><div><h2 class="title">15.8. KubeStateMetricsConfig</h2></div></div></div><section class="section" id="description-12"><div class="titlepage"><div><div><h3 class="title">15.8.1. Description</h3></div></div></div><p>
					The <code class="literal">KubeStateMetricsConfig</code> resource defines settings for the <code class="literal">kube-state-metrics</code> agent.
				</p><p>
					Appears in: <a class="link" href="#clustermonitoringconfiguration" title="15.5. ClusterMonitoringConfiguration">ClusterMonitoringConfiguration</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408898018464" scope="col">Property</th><th align="left" valign="top" id="idm140408898017376" scope="col">Type</th><th align="left" valign="top" id="idm140408898016288" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408898018464"> <p>
									nodeSelector
								</p>
								 </td><td align="left" valign="top" headers="idm140408898017376"> <p>
									map[string]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408898016288"> <p>
									Defines the nodes on which the pods are scheduled.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408898018464"> <p>
									tolerations
								</p>
								 </td><td align="left" valign="top" headers="idm140408898017376"> <p>
									[]v1.Toleration
								</p>
								 </td><td align="left" valign="top" headers="idm140408898016288"> <p>
									Defines tolerations for the pods.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="nodeexportercollectorbuddyinfoconfig"><div class="titlepage"><div><div><h2 class="title">15.9. NodeExporterCollectorBuddyInfoConfig</h2></div></div></div><section class="section" id="description-13"><div class="titlepage"><div><div><h3 class="title">15.9.1. Description</h3></div></div></div><p>
					The <code class="literal">NodeExporterCollectorBuddyInfoConfig</code> resource works as an on/off switch for the <code class="literal">buddyinfo</code> collector of the <code class="literal">node-exporter</code> agent. By default, the <code class="literal">buddyinfo</code> collector is disabled.
				</p><p>
					Appears in: <a class="link" href="#nodeexportercollectorconfig" title="15.10. NodeExporterCollectorConfig">NodeExporterCollectorConfig</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408897990976" scope="col">Property</th><th align="left" valign="top" id="idm140408897989888" scope="col">Type</th><th align="left" valign="top" id="idm140408901341728" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408897990976"> <p>
									enabled
								</p>
								 </td><td align="left" valign="top" headers="idm140408897989888"> <p>
									bool
								</p>
								 </td><td align="left" valign="top" headers="idm140408901341728"> <p>
									A Boolean flag that enables or disables the <code class="literal">buddyinfo</code> collector.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="nodeexportercollectorconfig"><div class="titlepage"><div><div><h2 class="title">15.10. NodeExporterCollectorConfig</h2></div></div></div><section class="section" id="description-14"><div class="titlepage"><div><div><h3 class="title">15.10.1. Description</h3></div></div></div><p>
					The <code class="literal">NodeExporterCollectorConfig</code> resource defines settings for individual collectors of the <code class="literal">node-exporter</code> agent.
				</p><p>
					Appears in: <a class="link" href="#nodeexporterconfig" title="15.15. NodeExporterConfig">NodeExporterConfig</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408901322224" scope="col">Property</th><th align="left" valign="top" id="idm140408901321136" scope="col">Type</th><th align="left" valign="top" id="idm140408901320048" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408901322224"> <p>
									cpufreq
								</p>
								 </td><td align="left" valign="top" headers="idm140408901321136"> <p>
									<a class="link" href="#nodeexportercollectorcpufreqconfig" title="15.11. NodeExporterCollectorCpufreqConfig">NodeExporterCollectorCpufreqConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901320048"> <p>
									Defines the configuration of the <code class="literal">cpufreq</code> collector, which collects CPU frequency statistics. Disabled by default.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901322224"> <p>
									tcpstat
								</p>
								 </td><td align="left" valign="top" headers="idm140408901321136"> <p>
									<a class="link" href="#nodeexportercollectortcpstatconfig" title="15.14. NodeExporterCollectorTcpStatConfig">NodeExporterCollectorTcpStatConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901320048"> <p>
									Defines the configuration of the <code class="literal">tcpstat</code> collector, which collects TCP connection statistics. Disabled by default.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901322224"> <p>
									netdev
								</p>
								 </td><td align="left" valign="top" headers="idm140408901321136"> <p>
									<a class="link" href="#nodeexportercollectornetdevconfig" title="15.13. NodeExporterCollectorNetDevConfig">NodeExporterCollectorNetDevConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901320048"> <p>
									Defines the configuration of the <code class="literal">netdev</code> collector, which collects network devices statistics. Enabled by default.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901322224"> <p>
									netclass
								</p>
								 </td><td align="left" valign="top" headers="idm140408901321136"> <p>
									<a class="link" href="#nodeexportercollectornetclassconfig" title="15.12. NodeExporterCollectorNetClassConfig">NodeExporterCollectorNetClassConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901320048"> <p>
									Defines the configuration of the <code class="literal">netclass</code> collector, which collects information about network devices. Enabled by default.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901322224"> <p>
									buddyinfo
								</p>
								 </td><td align="left" valign="top" headers="idm140408901321136"> <p>
									<a class="link" href="#nodeexportercollectorbuddyinfoconfig" title="15.9. NodeExporterCollectorBuddyInfoConfig">NodeExporterCollectorBuddyInfoConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901320048"> <p>
									Defines the configuration of the <code class="literal">buddyinfo</code> collector, which collects statistics about memory fragmentation from the <code class="literal">node_buddyinfo_blocks</code> metric. This metric collects data from <code class="literal">/proc/buddyinfo</code>. Disabled by default.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="nodeexportercollectorcpufreqconfig"><div class="titlepage"><div><div><h2 class="title">15.11. NodeExporterCollectorCpufreqConfig</h2></div></div></div><section class="section" id="description-15"><div class="titlepage"><div><div><h3 class="title">15.11.1. Description</h3></div></div></div><p>
					The <code class="literal">NodeExporterCollectorCpufreqConfig</code> resource works as an on/off switch for the <code class="literal">cpufreq</code> collector of the <code class="literal">node-exporter</code> agent. By default, the <code class="literal">cpufreq</code> collector is disabled. Under certain circumstances, enabling the cpufreq collector increases CPU usage on machines with many cores. If you enable this collector and have machines with many cores, monitor your systems closely for excessive CPU usage.
				</p><p>
					Appears in: <a class="link" href="#nodeexportercollectorconfig" title="15.10. NodeExporterCollectorConfig">NodeExporterCollectorConfig</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408901227488" scope="col">Property</th><th align="left" valign="top" id="idm140408901226400" scope="col">Type</th><th align="left" valign="top" id="idm140408901225312" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408901227488"> <p>
									enabled
								</p>
								 </td><td align="left" valign="top" headers="idm140408901226400"> <p>
									bool
								</p>
								 </td><td align="left" valign="top" headers="idm140408901225312"> <p>
									A Boolean flag that enables or disables the <code class="literal">cpufreq</code> collector.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="nodeexportercollectornetclassconfig"><div class="titlepage"><div><div><h2 class="title">15.12. NodeExporterCollectorNetClassConfig</h2></div></div></div><section class="section" id="description-16"><div class="titlepage"><div><div><h3 class="title">15.12.1. Description</h3></div></div></div><p>
					The <code class="literal">NodeExporterCollectorNetClassConfig</code> resource works as an on/off switch for the <code class="literal">netclass</code> collector of the <code class="literal">node-exporter</code> agent. By default, the <code class="literal">netclass</code> collector is enabled. If disabled, these metrics become unavailable: <code class="literal">node_network_info</code>, <code class="literal">node_network_address_assign_type</code>, <code class="literal">node_network_carrier</code>, <code class="literal">node_network_carrier_changes_total</code>, <code class="literal">node_network_carrier_up_changes_total</code>, <code class="literal">node_network_carrier_down_changes_total</code>, <code class="literal">node_network_device_id</code>, <code class="literal">node_network_dormant</code>, <code class="literal">node_network_flags</code>, <code class="literal">node_network_iface_id</code>, <code class="literal">node_network_iface_link</code>, <code class="literal">node_network_iface_link_mode</code>, <code class="literal">node_network_mtu_bytes</code>, <code class="literal">node_network_name_assign_type</code>, <code class="literal">node_network_net_dev_group</code>, <code class="literal">node_network_speed_bytes</code>, <code class="literal">node_network_transmit_queue_length</code>, <code class="literal">node_network_protocol_type</code>.
				</p><p>
					Appears in: <a class="link" href="#nodeexportercollectorconfig" title="15.10. NodeExporterCollectorConfig">NodeExporterCollectorConfig</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408900743712" scope="col">Property</th><th align="left" valign="top" id="idm140408900742624" scope="col">Type</th><th align="left" valign="top" id="idm140408900741536" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408900743712"> <p>
									enabled
								</p>
								 </td><td align="left" valign="top" headers="idm140408900742624"> <p>
									bool
								</p>
								 </td><td align="left" valign="top" headers="idm140408900741536"> <p>
									A Boolean flag that enables or disables the <code class="literal">netclass</code> collector.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900743712"> <p>
									useNetlink
								</p>
								 </td><td align="left" valign="top" headers="idm140408900742624"> <p>
									bool
								</p>
								 </td><td align="left" valign="top" headers="idm140408900741536"> <p>
									A Boolean flag that activates the <code class="literal">netlink</code> implementation of the <code class="literal">netclass</code> collector. By default, it is disabled. This implementation improves the performance of the <code class="literal">netclass</code> collector by omitting these metrics: <code class="literal">node_network_address_assign_type</code>, <code class="literal">node_network_name_assign_type</code>, <code class="literal">node_network_device_id</code>, <code class="literal">node_network_speed_bytes</code>. In addition, the <code class="literal">node_network_info</code> metric lacks the <code class="literal">duplex</code> label.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="nodeexportercollectornetdevconfig"><div class="titlepage"><div><div><h2 class="title">15.13. NodeExporterCollectorNetDevConfig</h2></div></div></div><section class="section" id="description-17"><div class="titlepage"><div><div><h3 class="title">15.13.1. Description</h3></div></div></div><p>
					The <code class="literal">NodeExporterCollectorNetDevConfig</code> resource works as an on/off switch for the <code class="literal">netdev</code> collector of the <code class="literal">node-exporter</code> agent. By default, the <code class="literal">netdev</code> collector is enabled. If disabled, these metrics become unavailable: <code class="literal">node_network_receive_bytes_total</code>, <code class="literal">node_network_receive_compressed_total</code>, <code class="literal">node_network_receive_drop_total</code>, <code class="literal">node_network_receive_errs_total</code>, <code class="literal">node_network_receive_fifo_total</code>, <code class="literal">node_network_receive_frame_total</code>, <code class="literal">node_network_receive_multicast_total</code>, <code class="literal">node_network_receive_nohandler_total</code>, <code class="literal">node_network_receive_packets_total</code>, <code class="literal">node_network_transmit_bytes_total</code>, <code class="literal">node_network_transmit_carrier_total</code>, <code class="literal">node_network_transmit_colls_total</code>, <code class="literal">node_network_transmit_compressed_total</code>, <code class="literal">node_network_transmit_drop_total</code>, <code class="literal">node_network_transmit_errs_total</code>, <code class="literal">node_network_transmit_fifo_total</code>, <code class="literal">node_network_transmit_packets_total</code>.
				</p><p>
					Appears in: <a class="link" href="#nodeexportercollectorconfig" title="15.10. NodeExporterCollectorConfig">NodeExporterCollectorConfig</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408900702800" scope="col">Property</th><th align="left" valign="top" id="idm140408900701712" scope="col">Type</th><th align="left" valign="top" id="idm140408900700624" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408900702800"> <p>
									enabled
								</p>
								 </td><td align="left" valign="top" headers="idm140408900701712"> <p>
									bool
								</p>
								 </td><td align="left" valign="top" headers="idm140408900700624"> <p>
									A Boolean flag that enables or disables the <code class="literal">netdev</code> collector.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="nodeexportercollectortcpstatconfig"><div class="titlepage"><div><div><h2 class="title">15.14. NodeExporterCollectorTcpStatConfig</h2></div></div></div><section class="section" id="description-18"><div class="titlepage"><div><div><h3 class="title">15.14.1. Description</h3></div></div></div><p>
					The <code class="literal">NodeExporterCollectorTcpStatConfig</code> resource works as an on/off switch for the <code class="literal">tcpstat</code> collector of the <code class="literal">node-exporter</code> agent. By default, the <code class="literal">tcpstat</code> collector is disabled.
				</p><p>
					Appears in: <a class="link" href="#nodeexportercollectorconfig" title="15.10. NodeExporterCollectorConfig">NodeExporterCollectorConfig</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408898450096" scope="col">Property</th><th align="left" valign="top" id="idm140408898449008" scope="col">Type</th><th align="left" valign="top" id="idm140408898447920" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408898450096"> <p>
									enabled
								</p>
								 </td><td align="left" valign="top" headers="idm140408898449008"> <p>
									bool
								</p>
								 </td><td align="left" valign="top" headers="idm140408898447920"> <p>
									A Boolean flag that enables or disables the <code class="literal">tcpstat</code> collector.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="nodeexporterconfig"><div class="titlepage"><div><div><h2 class="title">15.15. NodeExporterConfig</h2></div></div></div><section class="section" id="description-19"><div class="titlepage"><div><div><h3 class="title">15.15.1. Description</h3></div></div></div><p>
					The <code class="literal">NodeExporterConfig</code> resource defines settings for the <code class="literal">node-exporter</code> agent.
				</p><p>
					Appears in: <a class="link" href="#clustermonitoringconfiguration" title="15.5. ClusterMonitoringConfiguration">ClusterMonitoringConfiguration</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408898428512" scope="col">Property</th><th align="left" valign="top" id="idm140408898427424" scope="col">Type</th><th align="left" valign="top" id="idm140408898426336" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408898428512"> <p>
									collectors
								</p>
								 </td><td align="left" valign="top" headers="idm140408898427424"> <p>
									<a class="link" href="#nodeexportercollectorconfig" title="15.10. NodeExporterCollectorConfig">NodeExporterCollectorConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408898426336"> <p>
									Defines which collectors are enabled and their additional configuration parameters.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="openshiftstatemetricsconfig"><div class="titlepage"><div><div><h2 class="title">15.16. OpenShiftStateMetricsConfig</h2></div></div></div><section class="section" id="description-20"><div class="titlepage"><div><div><h3 class="title">15.16.1. Description</h3></div></div></div><p>
					The <code class="literal">OpenShiftStateMetricsConfig</code> resource defines settings for the <code class="literal">openshift-state-metrics</code> agent.
				</p><p>
					Appears in: <a class="link" href="#clustermonitoringconfiguration" title="15.5. ClusterMonitoringConfiguration">ClusterMonitoringConfiguration</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408901616592" scope="col">Property</th><th align="left" valign="top" id="idm140408901615504" scope="col">Type</th><th align="left" valign="top" id="idm140408901614416" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408901616592"> <p>
									nodeSelector
								</p>
								 </td><td align="left" valign="top" headers="idm140408901615504"> <p>
									map[string]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408901614416"> <p>
									Defines the nodes on which the pods are scheduled.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901616592"> <p>
									tolerations
								</p>
								 </td><td align="left" valign="top" headers="idm140408901615504"> <p>
									[]v1.Toleration
								</p>
								 </td><td align="left" valign="top" headers="idm140408901614416"> <p>
									Defines tolerations for the pods.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="prometheusk8sconfig"><div class="titlepage"><div><div><h2 class="title">15.17. PrometheusK8sConfig</h2></div></div></div><section class="section" id="description-21"><div class="titlepage"><div><div><h3 class="title">15.17.1. Description</h3></div></div></div><p>
					The <code class="literal">PrometheusK8sConfig</code> resource defines settings for the Prometheus component.
				</p><p>
					Appears in: <a class="link" href="#clustermonitoringconfiguration" title="15.5. ClusterMonitoringConfiguration">ClusterMonitoringConfiguration</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408901590592" scope="col">Property</th><th align="left" valign="top" id="idm140408901589504" scope="col">Type</th><th align="left" valign="top" id="idm140408901588416" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408901590592"> <p>
									additionalAlertmanagerConfigs
								</p>
								 </td><td align="left" valign="top" headers="idm140408901589504"> <p>
									[]<a class="link" href="#additionalalertmanagerconfig" title="15.2. AdditionalAlertmanagerConfig">AdditionalAlertmanagerConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901588416"> <p>
									Configures additional Alertmanager instances that receive alerts from the Prometheus component. By default, no additional Alertmanager instances are configured.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901590592"> <p>
									enforcedBodySizeLimit
								</p>
								 </td><td align="left" valign="top" headers="idm140408901589504"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408901588416"> <p>
									Enforces a body size limit for Prometheus scraped metrics. If a scraped target’s body response is larger than the limit, the scrape will fail. The following values are valid: an empty value to specify no limit, a numeric value in Prometheus size format (such as <code class="literal">64MB</code>), or the string <code class="literal">automatic</code>, which indicates that the limit will be automatically calculated based on cluster capacity. The default value is empty, which indicates no limit.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901590592"> <p>
									externalLabels
								</p>
								 </td><td align="left" valign="top" headers="idm140408901589504"> <p>
									map[string]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408901588416"> <p>
									Defines labels to be added to any time series or alerts when communicating with external systems such as federation, remote storage, and Alertmanager. By default, no labels are added.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901590592"> <p>
									logLevel
								</p>
								 </td><td align="left" valign="top" headers="idm140408901589504"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408901588416"> <p>
									Defines the log level setting for Prometheus. The possible values are: <code class="literal">error</code>, <code class="literal">warn</code>, <code class="literal">info</code>, and <code class="literal">debug</code>. The default value is <code class="literal">info</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901590592"> <p>
									nodeSelector
								</p>
								 </td><td align="left" valign="top" headers="idm140408901589504"> <p>
									map[string]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408901588416"> <p>
									Defines the nodes on which the pods are scheduled.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901590592"> <p>
									queryLogFile
								</p>
								 </td><td align="left" valign="top" headers="idm140408901589504"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408901588416"> <p>
									Specifies the file to which PromQL queries are logged. This setting can be either a filename, in which case the queries are saved to an <code class="literal">emptyDir</code> volume at <code class="literal">/var/log/prometheus</code>, or a full path to a location where an <code class="literal">emptyDir</code> volume will be mounted and the queries saved. Writing to <code class="literal">/dev/stderr</code>, <code class="literal">/dev/stdout</code> or <code class="literal">/dev/null</code> is supported, but writing to any other <code class="literal">/dev/</code> path is not supported. Relative paths are also not supported. By default, PromQL queries are not logged.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901590592"> <p>
									remoteWrite
								</p>
								 </td><td align="left" valign="top" headers="idm140408901589504"> <p>
									[]<a class="link" href="#remotewritespec" title="15.20. RemoteWriteSpec">RemoteWriteSpec</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408901588416"> <p>
									Defines the remote write configuration, including URL, authentication, and relabeling settings.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901590592"> <p>
									resources
								</p>
								 </td><td align="left" valign="top" headers="idm140408901589504"> <p>
									*v1.ResourceRequirements
								</p>
								 </td><td align="left" valign="top" headers="idm140408901588416"> <p>
									Defines resource requests and limits for the Prometheus container.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901590592"> <p>
									retention
								</p>
								 </td><td align="left" valign="top" headers="idm140408901589504"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408901588416"> <p>
									Defines the duration for which Prometheus retains data. This definition must be specified using the following regular expression pattern: <code class="literal">[0-9]+(ms|s|m|h|d|w|y)</code> (ms = milliseconds, s= seconds,m = minutes, h = hours, d = days, w = weeks, y = years). The default value is <code class="literal">15d</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901590592"> <p>
									retentionSize
								</p>
								 </td><td align="left" valign="top" headers="idm140408901589504"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408901588416"> <p>
									Defines the maximum amount of disk space used by data blocks plus the write-ahead log (WAL). Supported values are <code class="literal">B</code>, <code class="literal">KB</code>, <code class="literal">KiB</code>, <code class="literal">MB</code>, <code class="literal">MiB</code>, <code class="literal">GB</code>, <code class="literal">GiB</code>, <code class="literal">TB</code>, <code class="literal">TiB</code>, <code class="literal">PB</code>, <code class="literal">PiB</code>, <code class="literal">EB</code>, and <code class="literal">EiB</code>. By default, no limit is defined.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901590592"> <p>
									tolerations
								</p>
								 </td><td align="left" valign="top" headers="idm140408901589504"> <p>
									[]v1.Toleration
								</p>
								 </td><td align="left" valign="top" headers="idm140408901588416"> <p>
									Defines tolerations for the pods.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901590592"> <p>
									topologySpreadConstraints
								</p>
								 </td><td align="left" valign="top" headers="idm140408901589504"> <p>
									[]v1.TopologySpreadConstraint
								</p>
								 </td><td align="left" valign="top" headers="idm140408901588416"> <p>
									Defines the pod’s topology spread constraints.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901590592"> <p>
									collectionProfile
								</p>
								 </td><td align="left" valign="top" headers="idm140408901589504"> <p>
									CollectionProfile
								</p>
								 </td><td align="left" valign="top" headers="idm140408901588416"> <p>
									Defines the metrics collection profile that Prometheus uses to collect metrics from the platform components. Supported values are <code class="literal">full</code> or <code class="literal">minimal</code>. In the <code class="literal">full</code> profile (default), Prometheus collects all metrics that are exposed by the platform components. In the <code class="literal">minimal</code> profile, Prometheus only collects metrics necessary for the default platform alerts, recording rules, telemetry, and console dashboards.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901590592"> <p>
									volumeClaimTemplate
								</p>
								 </td><td align="left" valign="top" headers="idm140408901589504"> <p>
									*monv1.EmbeddedPersistentVolumeClaim
								</p>
								 </td><td align="left" valign="top" headers="idm140408901588416"> <p>
									Defines persistent storage for Prometheus. Use this setting to configure the persistent volume claim, including storage class, volume size and name.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="prometheusoperatorconfig"><div class="titlepage"><div><div><h2 class="title">15.18. PrometheusOperatorConfig</h2></div></div></div><section class="section" id="description-22"><div class="titlepage"><div><div><h3 class="title">15.18.1. Description</h3></div></div></div><p>
					The <code class="literal">PrometheusOperatorConfig</code> resource defines settings for the Prometheus Operator component.
				</p><p>
					Appears in: <a class="link" href="#clustermonitoringconfiguration" title="15.5. ClusterMonitoringConfiguration">ClusterMonitoringConfiguration</a>, <a class="link" href="#userworkloadconfiguration" title="15.25. UserWorkloadConfiguration">UserWorkloadConfiguration</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408898970560" scope="col">Property</th><th align="left" valign="top" id="idm140408898969472" scope="col">Type</th><th align="left" valign="top" id="idm140408898968384" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408898970560"> <p>
									logLevel
								</p>
								 </td><td align="left" valign="top" headers="idm140408898969472"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408898968384"> <p>
									Defines the log level settings for Prometheus Operator. The possible values are <code class="literal">error</code>, <code class="literal">warn</code>, <code class="literal">info</code>, and <code class="literal">debug</code>. The default value is <code class="literal">info</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408898970560"> <p>
									nodeSelector
								</p>
								 </td><td align="left" valign="top" headers="idm140408898969472"> <p>
									map[string]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408898968384"> <p>
									Defines the nodes on which the pods are scheduled.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408898970560"> <p>
									tolerations
								</p>
								 </td><td align="left" valign="top" headers="idm140408898969472"> <p>
									[]v1.Toleration
								</p>
								 </td><td align="left" valign="top" headers="idm140408898968384"> <p>
									Defines tolerations for the pods.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="prometheusrestrictedconfig"><div class="titlepage"><div><div><h2 class="title">15.19. PrometheusRestrictedConfig</h2></div></div></div><section class="section" id="description-23"><div class="titlepage"><div><div><h3 class="title">15.19.1. Description</h3></div></div></div><p>
					The <code class="literal">PrometheusRestrictedConfig</code> resource defines the settings for the Prometheus component that monitors user-defined projects.
				</p><p>
					Appears in: <a class="link" href="#userworkloadconfiguration" title="15.25. UserWorkloadConfiguration">UserWorkloadConfiguration</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408900007536" scope="col">Property</th><th align="left" valign="top" id="idm140408900006448" scope="col">Type</th><th align="left" valign="top" id="idm140408900005360" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408900007536"> <p>
									additionalAlertmanagerConfigs
								</p>
								 </td><td align="left" valign="top" headers="idm140408900006448"> <p>
									[]<a class="link" href="#additionalalertmanagerconfig" title="15.2. AdditionalAlertmanagerConfig">AdditionalAlertmanagerConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408900005360"> <p>
									Configures additional Alertmanager instances that receive alerts from the Prometheus component. By default, no additional Alertmanager instances are configured.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900007536"> <p>
									enforcedLabelLimit
								</p>
								 </td><td align="left" valign="top" headers="idm140408900006448"> <p>
									*uint64
								</p>
								 </td><td align="left" valign="top" headers="idm140408900005360"> <p>
									Specifies a per-scrape limit on the number of labels accepted for a sample. If the number of labels exceeds this limit after metric relabeling, the entire scrape is treated as failed. The default value is <code class="literal">0</code>, which means that no limit is set.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900007536"> <p>
									enforcedLabelNameLengthLimit
								</p>
								 </td><td align="left" valign="top" headers="idm140408900006448"> <p>
									*uint64
								</p>
								 </td><td align="left" valign="top" headers="idm140408900005360"> <p>
									Specifies a per-scrape limit on the length of a label name for a sample. If the length of a label name exceeds this limit after metric relabeling, the entire scrape is treated as failed. The default value is <code class="literal">0</code>, which means that no limit is set.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900007536"> <p>
									enforcedLabelValueLengthLimit
								</p>
								 </td><td align="left" valign="top" headers="idm140408900006448"> <p>
									*uint64
								</p>
								 </td><td align="left" valign="top" headers="idm140408900005360"> <p>
									Specifies a per-scrape limit on the length of a label value for a sample. If the length of a label value exceeds this limit after metric relabeling, the entire scrape is treated as failed. The default value is <code class="literal">0</code>, which means that no limit is set.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900007536"> <p>
									enforcedSampleLimit
								</p>
								 </td><td align="left" valign="top" headers="idm140408900006448"> <p>
									*uint64
								</p>
								 </td><td align="left" valign="top" headers="idm140408900005360"> <p>
									Specifies a global limit on the number of scraped samples that will be accepted. This setting overrides the <code class="literal">SampleLimit</code> value set in any user-defined <code class="literal">ServiceMonitor</code> or <code class="literal">PodMonitor</code> object if the value is greater than <code class="literal">enforcedTargetLimit</code>. Administrators can use this setting to keep the overall number of samples under control. The default value is <code class="literal">0</code>, which means that no limit is set.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900007536"> <p>
									enforcedTargetLimit
								</p>
								 </td><td align="left" valign="top" headers="idm140408900006448"> <p>
									*uint64
								</p>
								 </td><td align="left" valign="top" headers="idm140408900005360"> <p>
									Specifies a global limit on the number of scraped targets. This setting overrides the <code class="literal">TargetLimit</code> value set in any user-defined <code class="literal">ServiceMonitor</code> or <code class="literal">PodMonitor</code> object if the value is greater than <code class="literal">enforcedSampleLimit</code>. Administrators can use this setting to keep the overall number of targets under control. The default value is <code class="literal">0</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900007536"> <p>
									externalLabels
								</p>
								 </td><td align="left" valign="top" headers="idm140408900006448"> <p>
									map[string]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408900005360"> <p>
									Defines labels to be added to any time series or alerts when communicating with external systems such as federation, remote storage, and Alertmanager. By default, no labels are added.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900007536"> <p>
									logLevel
								</p>
								 </td><td align="left" valign="top" headers="idm140408900006448"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408900005360"> <p>
									Defines the log level setting for Prometheus. The possible values are <code class="literal">error</code>, <code class="literal">warn</code>, <code class="literal">info</code>, and <code class="literal">debug</code>. The default setting is <code class="literal">info</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900007536"> <p>
									nodeSelector
								</p>
								 </td><td align="left" valign="top" headers="idm140408900006448"> <p>
									map[string]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408900005360"> <p>
									Defines the nodes on which the pods are scheduled.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900007536"> <p>
									queryLogFile
								</p>
								 </td><td align="left" valign="top" headers="idm140408900006448"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408900005360"> <p>
									Specifies the file to which PromQL queries are logged. This setting can be either a filename, in which case the queries are saved to an <code class="literal">emptyDir</code> volume at <code class="literal">/var/log/prometheus</code>, or a full path to a location where an <code class="literal">emptyDir</code> volume will be mounted and the queries saved. Writing to <code class="literal">/dev/stderr</code>, <code class="literal">/dev/stdout</code> or <code class="literal">/dev/null</code> is supported, but writing to any other <code class="literal">/dev/</code> path is not supported. Relative paths are also not supported. By default, PromQL queries are not logged.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900007536"> <p>
									remoteWrite
								</p>
								 </td><td align="left" valign="top" headers="idm140408900006448"> <p>
									[]<a class="link" href="#remotewritespec" title="15.20. RemoteWriteSpec">RemoteWriteSpec</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408900005360"> <p>
									Defines the remote write configuration, including URL, authentication, and relabeling settings.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900007536"> <p>
									resources
								</p>
								 </td><td align="left" valign="top" headers="idm140408900006448"> <p>
									*v1.ResourceRequirements
								</p>
								 </td><td align="left" valign="top" headers="idm140408900005360"> <p>
									Defines resource requests and limits for the Prometheus container.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900007536"> <p>
									retention
								</p>
								 </td><td align="left" valign="top" headers="idm140408900006448"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408900005360"> <p>
									Defines the duration for which Prometheus retains data. This definition must be specified using the following regular expression pattern: <code class="literal">[0-9]+(ms|s|m|h|d|w|y)</code> (ms = milliseconds, s= seconds,m = minutes, h = hours, d = days, w = weeks, y = years). The default value is <code class="literal">15d</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900007536"> <p>
									retentionSize
								</p>
								 </td><td align="left" valign="top" headers="idm140408900006448"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408900005360"> <p>
									Defines the maximum amount of disk space used by data blocks plus the write-ahead log (WAL). Supported values are <code class="literal">B</code>, <code class="literal">KB</code>, <code class="literal">KiB</code>, <code class="literal">MB</code>, <code class="literal">MiB</code>, <code class="literal">GB</code>, <code class="literal">GiB</code>, <code class="literal">TB</code>, <code class="literal">TiB</code>, <code class="literal">PB</code>, <code class="literal">PiB</code>, <code class="literal">EB</code>, and <code class="literal">EiB</code>. The default value is <code class="literal">nil</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900007536"> <p>
									tolerations
								</p>
								 </td><td align="left" valign="top" headers="idm140408900006448"> <p>
									[]v1.Toleration
								</p>
								 </td><td align="left" valign="top" headers="idm140408900005360"> <p>
									Defines tolerations for the pods.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900007536"> <p>
									volumeClaimTemplate
								</p>
								 </td><td align="left" valign="top" headers="idm140408900006448"> <p>
									*monv1.EmbeddedPersistentVolumeClaim
								</p>
								 </td><td align="left" valign="top" headers="idm140408900005360"> <p>
									Defines persistent storage for Prometheus. Use this setting to configure the storage class and size of a volume.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="remotewritespec"><div class="titlepage"><div><div><h2 class="title">15.20. RemoteWriteSpec</h2></div></div></div><section class="section" id="description-24"><div class="titlepage"><div><div><h3 class="title">15.20.1. Description</h3></div></div></div><p>
					The <code class="literal">RemoteWriteSpec</code> resource defines the settings for remote write storage.
				</p></section><section class="section" id="required-2"><div class="titlepage"><div><div><h3 class="title">15.20.2. Required</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">url</code>
						</li></ul></div><p>
					Appears in: <a class="link" href="#prometheusk8sconfig" title="15.17. PrometheusK8sConfig">PrometheusK8sConfig</a>, <a class="link" href="#prometheusrestrictedconfig" title="15.19. PrometheusRestrictedConfig">PrometheusRestrictedConfig</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408899507792" scope="col">Property</th><th align="left" valign="top" id="idm140408899506704" scope="col">Type</th><th align="left" valign="top" id="idm140408899505616" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408899507792"> <p>
									authorization
								</p>
								 </td><td align="left" valign="top" headers="idm140408899506704"> <p>
									*monv1.SafeAuthorization
								</p>
								 </td><td align="left" valign="top" headers="idm140408899505616"> <p>
									Defines the authorization settings for remote write storage.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899507792"> <p>
									basicAuth
								</p>
								 </td><td align="left" valign="top" headers="idm140408899506704"> <p>
									*monv1.BasicAuth
								</p>
								 </td><td align="left" valign="top" headers="idm140408899505616"> <p>
									Defines basic authentication settings for the remote write endpoint URL.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899507792"> <p>
									bearerTokenFile
								</p>
								 </td><td align="left" valign="top" headers="idm140408899506704"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408899505616"> <p>
									Defines the file that contains the bearer token for the remote write endpoint. However, because you cannot mount secrets in a pod, in practice you can only reference the token of the service account.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899507792"> <p>
									headers
								</p>
								 </td><td align="left" valign="top" headers="idm140408899506704"> <p>
									map[string]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408899505616"> <p>
									Specifies the custom HTTP headers to be sent along with each remote write request. Headers set by Prometheus cannot be overwritten.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899507792"> <p>
									metadataConfig
								</p>
								 </td><td align="left" valign="top" headers="idm140408899506704"> <p>
									*monv1.MetadataConfig
								</p>
								 </td><td align="left" valign="top" headers="idm140408899505616"> <p>
									Defines settings for sending series metadata to remote write storage.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899507792"> <p>
									name
								</p>
								 </td><td align="left" valign="top" headers="idm140408899506704"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408899505616"> <p>
									Defines the name of the remote write queue. This name is used in metrics and logging to differentiate queues. If specified, this name must be unique.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899507792"> <p>
									oauth2
								</p>
								 </td><td align="left" valign="top" headers="idm140408899506704"> <p>
									*monv1.OAuth2
								</p>
								 </td><td align="left" valign="top" headers="idm140408899505616"> <p>
									Defines OAuth2 authentication settings for the remote write endpoint.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899507792"> <p>
									proxyUrl
								</p>
								 </td><td align="left" valign="top" headers="idm140408899506704"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408899505616"> <p>
									Defines an optional proxy URL.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899507792"> <p>
									queueConfig
								</p>
								 </td><td align="left" valign="top" headers="idm140408899506704"> <p>
									*monv1.QueueConfig
								</p>
								 </td><td align="left" valign="top" headers="idm140408899505616"> <p>
									Allows tuning configuration for remote write queue parameters.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899507792"> <p>
									remoteTimeout
								</p>
								 </td><td align="left" valign="top" headers="idm140408899506704"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408899505616"> <p>
									Defines the timeout value for requests to the remote write endpoint.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899507792"> <p>
									sigv4
								</p>
								 </td><td align="left" valign="top" headers="idm140408899506704"> <p>
									*monv1.Sigv4
								</p>
								 </td><td align="left" valign="top" headers="idm140408899505616"> <p>
									Defines AWS Signature Version 4 authentication settings.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899507792"> <p>
									tlsConfig
								</p>
								 </td><td align="left" valign="top" headers="idm140408899506704"> <p>
									*monv1.SafeTLSConfig
								</p>
								 </td><td align="left" valign="top" headers="idm140408899505616"> <p>
									Defines TLS authentication settings for the remote write endpoint.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899507792"> <p>
									url
								</p>
								 </td><td align="left" valign="top" headers="idm140408899506704"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408899505616"> <p>
									Defines the URL of the remote write endpoint to which samples will be sent.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899507792"> <p>
									writeRelabelConfigs
								</p>
								 </td><td align="left" valign="top" headers="idm140408899506704"> <p>
									[]monv1.RelabelConfig
								</p>
								 </td><td align="left" valign="top" headers="idm140408899505616"> <p>
									Defines the list of remote write relabel configurations.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="tlsconfig"><div class="titlepage"><div><div><h2 class="title">15.21. TLSConfig</h2></div></div></div><section class="section" id="description-25"><div class="titlepage"><div><div><h3 class="title">15.21.1. Description</h3></div></div></div><p>
					The <code class="literal">TLSConfig</code> resource configures the settings for TLS connections.
				</p></section><section class="section" id="required-3"><div class="titlepage"><div><div><h3 class="title">15.21.2. Required</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">insecureSkipVerify</code>
						</li></ul></div><p>
					Appears in: <a class="link" href="#additionalalertmanagerconfig" title="15.2. AdditionalAlertmanagerConfig">AdditionalAlertmanagerConfig</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408900829616" scope="col">Property</th><th align="left" valign="top" id="idm140408900828528" scope="col">Type</th><th align="left" valign="top" id="idm140408900827440" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408900829616"> <p>
									ca
								</p>
								 </td><td align="left" valign="top" headers="idm140408900828528"> <p>
									*v1.SecretKeySelector
								</p>
								 </td><td align="left" valign="top" headers="idm140408900827440"> <p>
									Defines the secret key reference containing the Certificate Authority (CA) to use for the remote host.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900829616"> <p>
									cert
								</p>
								 </td><td align="left" valign="top" headers="idm140408900828528"> <p>
									*v1.SecretKeySelector
								</p>
								 </td><td align="left" valign="top" headers="idm140408900827440"> <p>
									Defines the secret key reference containing the public certificate to use for the remote host.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900829616"> <p>
									key
								</p>
								 </td><td align="left" valign="top" headers="idm140408900828528"> <p>
									*v1.SecretKeySelector
								</p>
								 </td><td align="left" valign="top" headers="idm140408900827440"> <p>
									Defines the secret key reference containing the private key to use for the remote host.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900829616"> <p>
									serverName
								</p>
								 </td><td align="left" valign="top" headers="idm140408900828528"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408900827440"> <p>
									Used to verify the hostname on the returned certificate.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900829616"> <p>
									insecureSkipVerify
								</p>
								 </td><td align="left" valign="top" headers="idm140408900828528"> <p>
									bool
								</p>
								 </td><td align="left" valign="top" headers="idm140408900827440"> <p>
									When set to <code class="literal">true</code>, disables the verification of the remote host’s certificate and name.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="telemeterclientconfig"><div class="titlepage"><div><div><h2 class="title">15.22. TelemeterClientConfig</h2></div></div></div><section class="section" id="description-26"><div class="titlepage"><div><div><h3 class="title">15.22.1. Description</h3></div></div></div><p>
					<code class="literal">TelemeterClientConfig</code> defines settings for the Telemeter Client component.
				</p></section><section class="section" id="required-4"><div class="titlepage"><div><div><h3 class="title">15.22.2. Required</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">nodeSelector</code>
						</li><li class="listitem">
							<code class="literal">tolerations</code>
						</li></ul></div><p>
					Appears in: <a class="link" href="#clustermonitoringconfiguration" title="15.5. ClusterMonitoringConfiguration">ClusterMonitoringConfiguration</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408901058064" scope="col">Property</th><th align="left" valign="top" id="idm140408901056976" scope="col">Type</th><th align="left" valign="top" id="idm140408901055888" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408901058064"> <p>
									nodeSelector
								</p>
								 </td><td align="left" valign="top" headers="idm140408901056976"> <p>
									map[string]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408901055888"> <p>
									Defines the nodes on which the pods are scheduled.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901058064"> <p>
									tolerations
								</p>
								 </td><td align="left" valign="top" headers="idm140408901056976"> <p>
									[]v1.Toleration
								</p>
								 </td><td align="left" valign="top" headers="idm140408901055888"> <p>
									Defines tolerations for the pods.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="thanosquerierconfig"><div class="titlepage"><div><div><h2 class="title">15.23. ThanosQuerierConfig</h2></div></div></div><section class="section" id="description-27"><div class="titlepage"><div><div><h3 class="title">15.23.1. Description</h3></div></div></div><p>
					The <code class="literal">ThanosQuerierConfig</code> resource defines settings for the Thanos Querier component.
				</p><p>
					Appears in: <a class="link" href="#clustermonitoringconfiguration" title="15.5. ClusterMonitoringConfiguration">ClusterMonitoringConfiguration</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408901032064" scope="col">Property</th><th align="left" valign="top" id="idm140408901030976" scope="col">Type</th><th align="left" valign="top" id="idm140408899337376" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408901032064"> <p>
									enableRequestLogging
								</p>
								 </td><td align="left" valign="top" headers="idm140408901030976"> <p>
									bool
								</p>
								 </td><td align="left" valign="top" headers="idm140408899337376"> <p>
									A Boolean flag that enables or disables request logging. The default value is <code class="literal">false</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901032064"> <p>
									logLevel
								</p>
								 </td><td align="left" valign="top" headers="idm140408901030976"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408899337376"> <p>
									Defines the log level setting for Thanos Querier. The possible values are <code class="literal">error</code>, <code class="literal">warn</code>, <code class="literal">info</code>, and <code class="literal">debug</code>. The default value is <code class="literal">info</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901032064"> <p>
									nodeSelector
								</p>
								 </td><td align="left" valign="top" headers="idm140408901030976"> <p>
									map[string]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408899337376"> <p>
									Defines the nodes on which the pods are scheduled.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901032064"> <p>
									resources
								</p>
								 </td><td align="left" valign="top" headers="idm140408901030976"> <p>
									*v1.ResourceRequirements
								</p>
								 </td><td align="left" valign="top" headers="idm140408899337376"> <p>
									Defines resource requests and limits for the Thanos Querier container.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408901032064"> <p>
									tolerations
								</p>
								 </td><td align="left" valign="top" headers="idm140408901030976"> <p>
									[]v1.Toleration
								</p>
								 </td><td align="left" valign="top" headers="idm140408899337376"> <p>
									Defines tolerations for the pods.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="thanosrulerconfig"><div class="titlepage"><div><div><h2 class="title">15.24. ThanosRulerConfig</h2></div></div></div><section class="section" id="description-28"><div class="titlepage"><div><div><h3 class="title">15.24.1. Description</h3></div></div></div><p>
					The <code class="literal">ThanosRulerConfig</code> resource defines configuration for the Thanos Ruler instance for user-defined projects.
				</p><p>
					Appears in: <a class="link" href="#userworkloadconfiguration" title="15.25. UserWorkloadConfiguration">UserWorkloadConfiguration</a>
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408899294832" scope="col">Property</th><th align="left" valign="top" id="idm140408899293744" scope="col">Type</th><th align="left" valign="top" id="idm140408899292656" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408899294832"> <p>
									additionalAlertmanagerConfigs
								</p>
								 </td><td align="left" valign="top" headers="idm140408899293744"> <p>
									[]<a class="link" href="#additionalalertmanagerconfig" title="15.2. AdditionalAlertmanagerConfig">AdditionalAlertmanagerConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408899292656"> <p>
									Configures how the Thanos Ruler component communicates with additional Alertmanager instances. The default value is <code class="literal">nil</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899294832"> <p>
									logLevel
								</p>
								 </td><td align="left" valign="top" headers="idm140408899293744"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408899292656"> <p>
									Defines the log level setting for Thanos Ruler. The possible values are <code class="literal">error</code>, <code class="literal">warn</code>, <code class="literal">info</code>, and <code class="literal">debug</code>. The default value is <code class="literal">info</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899294832"> <p>
									nodeSelector
								</p>
								 </td><td align="left" valign="top" headers="idm140408899293744"> <p>
									map[string]string
								</p>
								 </td><td align="left" valign="top" headers="idm140408899292656"> <p>
									Defines the nodes on which the Pods are scheduled.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899294832"> <p>
									resources
								</p>
								 </td><td align="left" valign="top" headers="idm140408899293744"> <p>
									*v1.ResourceRequirements
								</p>
								 </td><td align="left" valign="top" headers="idm140408899292656"> <p>
									Defines resource requests and limits for the Thanos Ruler container.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899294832"> <p>
									retention
								</p>
								 </td><td align="left" valign="top" headers="idm140408899293744"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140408899292656"> <p>
									Defines the duration for which Prometheus retains data. This definition must be specified using the following regular expression pattern: <code class="literal">[0-9]+(ms|s|m|h|d|w|y)</code> (ms = milliseconds, s= seconds,m = minutes, h = hours, d = days, w = weeks, y = years). The default value is <code class="literal">15d</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899294832"> <p>
									tolerations
								</p>
								 </td><td align="left" valign="top" headers="idm140408899293744"> <p>
									[]v1.Toleration
								</p>
								 </td><td align="left" valign="top" headers="idm140408899292656"> <p>
									Defines tolerations for the pods.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899294832"> <p>
									topologySpreadConstraints
								</p>
								 </td><td align="left" valign="top" headers="idm140408899293744"> <p>
									[]v1.TopologySpreadConstraint
								</p>
								 </td><td align="left" valign="top" headers="idm140408899292656"> <p>
									Defines topology spread constraints for the pods.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408899294832"> <p>
									volumeClaimTemplate
								</p>
								 </td><td align="left" valign="top" headers="idm140408899293744"> <p>
									*monv1.EmbeddedPersistentVolumeClaim
								</p>
								 </td><td align="left" valign="top" headers="idm140408899292656"> <p>
									Defines persistent storage for Thanos Ruler. Use this setting to configure the storage class and size of a volume.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="userworkloadconfiguration"><div class="titlepage"><div><div><h2 class="title">15.25. UserWorkloadConfiguration</h2></div></div></div><section class="section" id="description-29"><div class="titlepage"><div><div><h3 class="title">15.25.1. Description</h3></div></div></div><p>
					The <code class="literal">UserWorkloadConfiguration</code> resource defines the settings responsible for user-defined projects in the <code class="literal">user-workload-monitoring-config</code> config map in the <code class="literal">openshift-user-workload-monitoring</code> namespace. You can only enable <code class="literal">UserWorkloadConfiguration</code> after you have set <code class="literal">enableUserWorkload</code> to <code class="literal">true</code> in the <code class="literal">cluster-monitoring-config</code> config map under the <code class="literal">openshift-monitoring</code> namespace.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140408900609136" scope="col">Property</th><th align="left" valign="top" id="idm140408900608048" scope="col">Type</th><th align="left" valign="top" id="idm140408900606960" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140408900609136"> <p>
									alertmanager
								</p>
								 </td><td align="left" valign="top" headers="idm140408900608048"> <p>
									*<a class="link" href="#alertmanageruserworkloadconfig" title="15.4. AlertmanagerUserWorkloadConfig">AlertmanagerUserWorkloadConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408900606960"> <p>
									Defines the settings for the Alertmanager component in user workload monitoring.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900609136"> <p>
									prometheus
								</p>
								 </td><td align="left" valign="top" headers="idm140408900608048"> <p>
									*<a class="link" href="#prometheusrestrictedconfig" title="15.19. PrometheusRestrictedConfig">PrometheusRestrictedConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408900606960"> <p>
									Defines the settings for the Prometheus component in user workload monitoring.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900609136"> <p>
									prometheusOperator
								</p>
								 </td><td align="left" valign="top" headers="idm140408900608048"> <p>
									*<a class="link" href="#prometheusoperatorconfig" title="15.18. PrometheusOperatorConfig">PrometheusOperatorConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408900606960"> <p>
									Defines the settings for the Prometheus Operator component in user workload monitoring.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140408900609136"> <p>
									thanosRuler
								</p>
								 </td><td align="left" valign="top" headers="idm140408900608048"> <p>
									*<a class="link" href="#thanosrulerconfig" title="15.24. ThanosRulerConfig">ThanosRulerConfig</a>
								</p>
								 </td><td align="left" valign="top" headers="idm140408900606960"> <p>
									Defines the settings for the Thanos Ruler component in user workload monitoring.
								</p>
								 </td></tr></tbody></table></div></section></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm140408917945440"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2023 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div>


  <nav class="pvof-doc__book-nav">
  <ol class="book-nav__list">
              </ol>
</nav>


          </div>
              </div>
              <div id="comments-footer" class="book-comments">
          

  

        </div>
          </div>
  </article>
<meta itemscope="" itemref="md1">



    </div>
      <!-- CP_PRIMER_FOOTER -->            </div>
        </main>
    </div>
    <!--googleoff: all-->
    <div id="to-top"><a class="btn_slideto" href="#masthead" aria-label="Back to Top"><span class="web-icon-upload"></span></a></div>
    <footer class="footer-main">
        <div class="footer-top">
            <div class="container">

              <div class="brand">
                <a href="https://redhat.com">
                  <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                    <defs>
                      <style>
                        .rh-logo-hat {
                          fill: #e00;
                        }
                        .rh-logo-type {
                          fill: #fff;
                        }
                      </style>
                    </defs>
                    <title>Red Hat</title>
                    <path
                      class="rh-logo-hat"
                      d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
                      <path class="rh-logo-band"
                      d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
                      <path
                      class="rh-logo-type"
                      d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
                  </svg>
                </a>
              </div>

              <div role="navigation" aria-label="quick">
                  <h3>Quick Links</h3>
                  <ul>
                      <li><a class="download-software" href="https://access.redhat.com/downloads/">Downloads</a></li>
                      <li><a class="manage-subscriptions" href="https://access.redhat.com/management">Subscriptions</a></li>
                      <li><a class="support-cases" href="https://access.redhat.com/support">Support Cases</a></li>
                      <li><a class="customer-service" href="https://access.redhat.com/support/customer-service">Customer Service</a></li>
                      <li><a class="quick-docs" href="https://access.redhat.com/documentation">Product Documentation</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="help">
                  <h3>Help</h3>
                  <ul>
                      <li><a class="contact-us" href="https://access.redhat.com/support/contact/">Contact Us</a></li>
                      <li><a class="cp-faqs" href="https://access.redhat.com/articles/33844">Customer Portal FAQ</a></li>
                      <li><a class="login-problems" href="https://access.redhat.com/help/login_assistance">Log-in Assistance</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="site">
                  <h3>Site Info</h3>
                  <ul>
                      <li><a class="trust-red-hat" href="https://www.redhat.com/en/trust">Trust Red Hat</a></li>
                      <li><a class="browser-support-policy" href="https://www.redhat.com/en/about/browser-support">Browser Support Policy</a></li>
                      <li><a class="accessibility" href="https://www.redhat.com/en/about/digital-accessibility">Accessibility</a></li>
                      <li><a class="recognition" href="https://access.redhat.com/recognition/">Awards and Recognition</a></li>
                      <li><a class="colophon" href="https://access.redhat.com/help/colophon/">Colophon</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="other">
                  <h3>Related Sites</h3>
                  <ul>
                      <li><a href="https://www.redhat.com/" class="red-hat-com">redhat.com</a></li>
                      <li><a href="http://developers.redhat.com/" class="red-hat-developers">developers.redhat.com</a></li>
                      <li><a href="https://connect.redhat.com/" class="partner-connect">connect.redhat.com</a></li>
                      <li><a href="https://cloud.redhat.com/" class="cloud-com">cloud.redhat.com</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="about">
                  <h3>About</h3>
                  <ul>
                      <li><a href="https://access.redhat.com/subscription-value" class="subscription-value">Red Hat Subscription Value</a></li>
                      <li><a href="https://www.redhat.com/about/" class="about-red-hat">About Red Hat</a></li>
                      <li><a href="http://jobs.redhat.com" class="about-jobs">Red Hat Jobs</a></li>
                  </ul>
              </div>

            </div>
        </div>

        <div class="anchor">
            <div class="container">
                <div class="status-legal">
                    <a hidden href="https://status.redhat.com" class="status-page-widget">
                        <span class="status-description"></span>
                        <span class="status-dot shape-circle"></span>
                    </a>
                    <div class="legal-copyright">
                        <div class="copyright">Copyright © 2023 Red Hat, Inc.</div>
                        <div role="navigation" aria-label="legal" class="legal">
                            <ul>
                                <li><a href="http://www.redhat.com/en/about/privacy-policy" class="privacy-policy">Privacy Statement</a></li>
                                <li><a href="https://www.redhat.com/en/about/terms-use" class="terms-of-use">Terms of Use</a></li>
                                <li><a href="http://www.redhat.com/en/about/all-policies-guidelines" class="all-policies">All Policies and Guidelines</a></li>
                                <li><a id="teconsent"></a></li>
                            </ul>
                            <div id="privacy_policy">We've updated our <a href='http://www.redhat.com/en/about/privacy-policy' class='privacy-policy'>Privacy Statement</a> effective September 15, 2023.
                            </div>
                          </div>
                        </div>
                </div>
                <div class="social">
                    <a href="http://www.redhat.com/summit/" class="summit">
                        <img src="https://access.redhat.com/chrome_themes/nimbus/img/rh-summit-red-a.svg" alt="Red Hat Summit" /> <span class="offscreen">Red Hat Summit</span>
                    </a>

                    <div class="social-media">
                        <a href="https://twitter.com/RedHat" class="sm-icon twitter"><span class="nicon-twitter"></span><span class="offscreen">Twitter</span></a>                        
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- TrustArc -->
    <div id="consent_blackbar"></div> 
    <!--googleon: all-->
</div>
<!-- /CP_PRIMER_FOOTER -->


  </div>

    
  </body>
</html>
