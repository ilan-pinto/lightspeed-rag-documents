<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="og: https://ogp.me/ns#">
  <head>
    <meta charset="utf-8" />
<link rel="canonical" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<link rel="shortlink" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<meta property="og:site_name" content="Red Hat Customer Portal" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<meta property="og:title" content="Security and compliance OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<meta property="og:description" content="This document discusses container security, configuring certificates, and enabling encryption to help secure the cluster." />
<meta property="og:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="This document discusses container security, configuring certificates, and enabling encryption to help secure the cluster." />
<meta name="twitter:title" content="Security and compliance OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<meta name="twitter:url" content="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<meta name="twitter:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="title" content="Security and compliance OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<link rel="alternate" hreflang="en" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<link rel="alternate" hreflang="ko" href="https://access.redhat.com/documentation/ko-kr/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<link rel="alternate" hreflang="zh-hans" href="https://access.redhat.com/documentation/zh-cn/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<link rel="alternate" hreflang="ja" href="https://access.redhat.com/documentation/ja-jp/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<link rel="alternate" hreflang="es" href="https://access.redhat.com/documentation/es-es/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<link rel="alternate" hreflang="ru" href="https://access.redhat.com/documentation/ru-ru/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<link rel="alternate" hreflang="pt-br" href="https://access.redhat.com/documentation/pt-br/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<link rel="alternate" hreflang="it" href="https://access.redhat.com/documentation/it-it/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<link rel="alternate" hreflang="de" href="https://access.redhat.com/documentation/de-de/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<link rel="alternate" hreflang="fr" href="https://access.redhat.com/documentation/fr-fr/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<link rel="alternate" hreflang="zh-hant" href="https://access.redhat.com/documentation/zh-tw/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<link rel="alternate" hreflang="id" href="https://access.redhat.com/documentation/id-id/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<link rel="alternate" hreflang="th" href="https://access.redhat.com/documentation/th-th/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<link rel="alternate" hreflang="vi" href="https://access.redhat.com/documentation/vi-vn/openshift_container_platform/4.13/html-single/security_and_compliance/index" />
<meta name="Generator" content="Drupal 9 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="revision" product="b0738f19-59ac-47eb-9512-8a439cd6dfb0" title="ae1ca27f-d2ac-47c4-9073-cf643841a187" page="eccf4732-3b80-417b-920a-8956961f1504" revision="dccd48b1f252cc22dad43e9ae6252b9287d98ca1:en-us" body="4f64522098246ddbf0b549450e216855.html" toc="d16671ad2681d9ae91809221ce658115.json" />

    <title>Security and compliance OpenShift Container Platform 4.13 | Red Hat Customer Portal</title>
    <link rel="stylesheet" media="all" href="/sites/dxp-docs/files/css/css_87GMcmxT1ib8ziQiU2KUAnTDFtZQV6iP-KGslA9LigM.css" />
<link rel="stylesheet" media="all" href="/sites/dxp-docs/files/css/css__Xq4GfgPDJw9K_yYJFmlRZGJeCENu3R3r4s0K7Tr_9g.css" />

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"documentation\/en-us\/openshift_container_platform\/4.13\/html-single\/security_and_compliance\/index","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"red_hat_jwt":{"client_id":"customer-portal","cookie_name":"rh_jwt","leeway":"0","realm":"redhat-external","sso_host":"https:\/\/sso.redhat.com\/","user_integration":1,"user_plugin":"drupal_user_auth","use_external_js":0,"use_internal_js":0,"use_in_admin":0},"user":{"uid":0,"permissionsHash":"d8ea0bce2d740dacbdfe0257cf55baa0e33f7fb8468a26d055ce75daaaa2d315"}}</script>
<script src="/sites/dxp-docs/files/js/js_EQWKo9EokWkWS99x_e1oM-NEM0zlKyTkp_83mGdm5Ks.js"></script>

    <!-- CP_PRIMER_HEAD -->  <!-- TrustArc & DTM -->
  <script src="//static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>
  <script src="//www.redhat.com/dtm.js"></script><meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<!--[if IEMobile]><meta http-equiv="cleartype" content="on"><![endif]-->

<!-- metaInclude -->
<meta name="avalon-host-info" content="dxp-kbase-prod-139-77b4fb8768-25dr9" />
<meta name="avalon-version" content="27861f77" />
<meta name="cp-chrome-build-date" content="2023-10-06T19:17:59.039Z" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#000000">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#000000">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-status-bar-style" content="#000000">
<link rel="manifest" href="https://access.redhat.com/webassets/avalon/j/manifest.json">
<!-- Open Search - Tap to search -->
<link rel="search" type="application/opensearchdescription+xml" title="Red Hat Customer Portal" href="https://access.redhat.com/webassets/avalon/j/opensearch.xml" />
<!-- title -->
<title>Red Hat Customer Portal - Access to 24x7 support and knowledge</title>
<!-- /title -->
<script type="text/javascript">
    window.portal = {
        analytics : {},
        host      : "https://access.redhat.com",
        idp_url   : "https://sso.redhat.com",
        lang      : "en", 
        version   : "27861f77",
        builddate : "2023-10-06T19:17:59.039Z",        fetchdate : "2023-10-10T17:45:08-0400",        nrid      : "NOLONGERSUPPORTED",
        nrlk      : "NOLONGERSUPPORTED"
    };
</script>
<script type="text/javascript">
    if (!/\/logout.*/.test(location.pathname) && portal.host === location.origin && document.cookie.indexOf('rh_sso_session') >= 0 && !(document.cookie.indexOf('rh_jwt') >= 0)) window.location = '/login?redirectTo=' + encodeURIComponent(window.location.href);
</script>
<!-- cssInclude -->

<link rel="shortcut icon" href="https://access.redhat.com/webassets/avalon/g/favicon.ico" /><link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/bootstrap.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/bootstrap-grid.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/main.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/components.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/pages.css?v=27861f77" />

<link href="https://access.redhat.com/webassets/avalon/s/chosen.css?v=27861f77" rel="stylesheet" type="text/css" />

<!--[if lte IE 9]>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/ie.css" />
<![endif]--><noscript>
    <style type="text/css" media="screen"> .primary-nav { display: block; } </style>
</noscript>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/webassets/avalon/j/public_modules/node_modules/@cpelements/pfe-navigation/dist/pfe-navigation--lightdom.min.css" />
<!-- /cssInclude -->
<script src="https://access.redhat.com/webassets/avalon/j/public_modules/node_modules/@cpelements/pfe-navigation/dist/ie-polyfills.js?v=27861f77"></script>

<script async>
  if (!HTMLScriptElement.supports || !HTMLScriptElement.supports('importmap')) {
    import("https://www.redhatstatic.com/dx/v1-alpha/es-module-shims@1.7.3.js");
  }
</script>
<script type="importmap">
{
  "imports": {
    "@patternfly/elements/" : "https://www.redhatstatic.com/dx/v1-alpha/@patternfly/elements@2.2.2/",
    "@rhds/elements/":"https://www.redhatstatic.com/dx/v1-alpha/@rhds/elements@1.1.0/elements/",
    "@rhds/elements/lib/":"https://www.redhatstatic.com/dx/v1-alpha/@rhds/elements@1.1.0/lib/",
    "@cpelements/elements/":"https://www.redhatstatic.com/dx/v1-alpha/@cpelements/elements@2.0.0-alpha.7/elements/"
  }
}
</script><script type="text/javascript" src="https://access.redhat.com/webassets/avalon/j/lib/require.js?v=27861f77" data-main="/webassets/avalon/j/"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<script src="https://access.redhat.com/chrome_themes/nimbus/js/ie8.js"></script>
<![endif]-->
<script type="text/javascript" src="https://access.redhat.com/chrome_themes/nimbus/js/new-nav.js?v=27861f77" ></script>
<!-- /CP_PRIMER_HEAD -->

  </head>
  <body>
    
      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
      <!-- CP_PRIMER_HEADER -->
<div id="page-wrap" class="page-wrap">
    <div id="pers-top-page-wrap" class="top-page-wrap pers-loader-bg">

      <div id="hero-bg-top-left" class="summit-bg-shapes"></div>
      <div id="hero-bg-top-right" class="summit-bg-shapes"></div>

        <!--googleoff: all-->
        <header class="masthead" id="masthead">

            <a href="#pfe-navigation" id="global-skip-to-nav" class="skip-link visually-hidden">Skip to navigation</a>
            <a href="#cp-main" class="skip-link visually-hidden">Skip to main content</a>            <nav id="portal-utility-nav" class="utility-navigation utility-navigation--bar hidden-at-mobile" data-analytics-region="utility" aria-labelledby="nav__utility-nav--desktop">
                <h3 id="nav__utility-nav--desktop" class="element-invisible">Utilities
                </h3>
                <ul aria-labelledby="nav__utility-nav--desktop">
                    <li id="nav-subscription" data-portal-tour-1="1">
                        <a class="top-nav-subscriptions" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Subscription" href="https://access.redhat.com/management/" >Subscriptions
                        </a>
                    </li>
                    <li id="nav-downloads" data-portal-tour-1="2">
                        <a class="top-nav-downloads" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Downloads" href="https://access.redhat.com/downloads/" >Downloads
                        </a>
                    </li>
                    <li id="nav-containers">
                        <a class="top-nav-containers" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Containers" href="https://catalog.redhat.com/software/containers/explore/" >Containers
                        </a>
                    </li>
                    <li id="nav-support" data-portal-tour-1="3">
                        <a class="top-nav-support-cases" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Support Cases" href="https://access.redhat.com/support/cases/" >Support Cases
                        </a>
                    </li>
                </ul>
            </nav>

            <pfe-navigation id="pfe-navigation" data-analytics-region="mega menu">
                <div class="pfe-navigation__logo-wrapper" id="pfe-navigation__logo-wrapper">
                    <a href="https://access.redhat.com/" class="pfe-navigation__logo-link" data-analytics-text="logo" data-analytics-category="MM|logo">
                        <img class="pfe-navigation__logo-image" alt="Red Hat Customer Portal" src="https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg" />
                    </a>
                </div>

                <nav class="pfe-navigation" aria-label="Main Navigation" data-analytics-region="main nav">
                    <ul class="pfe-navigation__menu" id="pfe-navigation__menu">                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-subscription--mobile" data-portal-tour-1="1">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Subscription" href="https://access.redhat.com/management/" >Subscriptions
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-downloads--mobile" data-portal-tour-1="2">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Downloads" href="https://access.redhat.com/downloads/" >Downloads
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-containers--mobile">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Containers" href="https://catalog.redhat.com/software/containers/explore/" >Containers
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-support--mobile" data-portal-tour-1="3">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Support Cases" href="https://access.redhat.com/support/cases/" >Support Cases
                            </a>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a href="https://access.redhat.com/products/" class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Products and Services">Products &amp; Services
                            </a>
                            <div class="pfe-navigation__dropdown has-primary-detail">                                <div class="desktop-col-span-2 tablet-col-span-all">
                                    <h3>
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Products" href="https://access.redhat.com/products/">Products
                                        </a>
                                    </h3>
                                    <slot name="main-menu__dropdown--product__product-listing"></slot>
                                </div>                                <div>
                                    <h3 id="nav__products__support">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Support" href="https://access.redhat.com/support">Support
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__support">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Production Support" href="https://access.redhat.com/support/offerings/production/">Production Support
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Development Support" href="https://access.redhat.com/support/offerings/developer/">Development Support
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Product Life Cycles" href="https://access.redhat.com/product-life-cycles/">Product Life Cycles
                                                    </a></li>
                                    </ul>

                                    <h3 id="nav__products__services">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Services" href="https://www.redhat.com/en/services">Services
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__services">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Consulting" href="https://www.redhat.com/en/services/consulting">Consulting
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Technical Account Management" href="https://access.redhat.com/support/offerings/tam/">Technical Account Management
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Training and Certifications" href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications
                                                    </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__products__documentation">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Documentation" href="https://access.redhat.com/documentation">Documentation
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__documentation">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat Enterprise Linux" href="https://access.redhat.com/documentation/en/red_hat_enterprise_linux">Red Hat Enterprise Linux
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat JBoss Enterprise Application Platform" href="https://access.redhat.com/documentation/en/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat OpenStack Platform" href="https://access.redhat.com/documentation/en/red_hat_openstack_platform">Red Hat OpenStack Platform
                                                    </a></li>
                                                    <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat OpenShift Container Platform" href="https://access.redhat.com/documentation/en/openshift_container_platform">Red Hat OpenShift Container Platform
                                                        </a></li>
                                    </ul>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="All Documentation" data-analytics-linkType="cta" href="https://access.redhat.com/documentation">All Documentation
                                        </a>
                                    </pfe-cta>

                                    <h3 id="nav__products__catalog"><a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Ecosystem Catalog" href="https://catalog.redhat.com/">Ecosystem Catalog
                                        </a></h3>
                                        <ul aria-labelledby="nav__products__catalog">
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Ecosystem Catalog" data-analytics-text="Red Hat Partner Ecosystem" href="https://access.redhat.com/ecosystem/">Red Hat Partner Ecosystem
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Ecosystem Catalog" data-analytics-text="Partner Resources" href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources
                                                    </a></li>
                                        </ul>
                                </div>
                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Tools" href="https://access.redhat.com/labs/">Tools
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="nav__tools__tools" data-analytics-level="2" data-analytics-text="Tools" data-analytics-category="Tools">Tools
                                    </h3>
                                    <ul aria-labelledby="nav__tools__tools">
                                        <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Solution Engine" href="https://access.redhat.com/support/cases/#/troubleshoot">Troubleshoot a product issue
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Packages" href="https://access.redhat.com/downloads/content/package-browser">Packages
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Errata" href="https://access.redhat.com/errata/">Errata
                                                    </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__tools__labs">
                                        <a data-analytics-level="2" data-analytics-category="Tools" data-analytics-text="Customer Portal Labs" href="https://access.redhat.com/labs/">Customer Portal Labs
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__tools__labs">
                                        <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Configuration" href="https://access.redhat.com/labs/#!?type=config">Configuration
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Deployment" href="https://access.redhat.com/labs/#!?type=deploy">Deployment
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Security" href="https://access.redhat.com/labs/#!?type=security">Security
                                                    </a></li>                                                    <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Troubleshooting" href="https://access.redhat.com/labs/#!?type=troubleshoot">Troubleshoot
                                                        </a></li>
                                    </ul>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="All Labs" data-analytics-linkType="cta" href="https://access.redhat.com/labs/">All labs
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h4 id="nav__tools__red-hat-insights">
                                        <a data-analytics-level="2" data-analytics-category="Tools" data-analytics-text="Red Hat Insights" href="//www.redhat.com/en/technologies/management/insights">Red Hat Insights
                                        </a>
                                    </h4>
                                    <p>Increase visibility into IT operations to detect and resolve technical issues before they impact your business.</p>
                                    <a data-analytics-level="3" data-analytics-category="Tools|Red Hat Insights" data-analytics-text="Learn more" href="https://www.redhat.com/en/technologies/management/insights">Learn More
                                    </a>
                                    <br>
                                    <a data-analytics-level="3" data-analytics-category="Tools|Red Hat Insights" data-analytics-text="Go to Insights" href="https://cloud.redhat.com/insights">Go to Insights
                                    </a>
                                </div>
                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Security" href="https://access.redhat.com/security/">Security
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="security__security-center">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Red Hat Product Security Center" href="https://access.redhat.com/security">Red Hat Product Security Center
                                        </a>
                                    </h3>
                                    <p>Engage with our Red Hat Product Security team, access security updates, and ensure your environments are not exposed to any known security vulnerabilities.
                                    </p>
                                    <pfe-cta pfe-priority="primary">
                                        <a data-analytics-level="3" data-analytics-category="Security|Red Hat Product Security Center" data-analytics-text="Product Security Center" data-analytics-linkType="cta" href="https://access.redhat.com/security/">Product Security Center
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__security__updates" data-analytics-level="2" data-analytics-text="Security Updates" data-analytics-category="Security">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Security Updates" href="/security">Security Updates
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__security__updates">
                                        <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Security Advisories" href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Red Hat CVE Database" href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Security Labs" href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs
                                                    </a></li>
                                    </ul>
                                    <p class="margin-top-xl">Keep your systems secure with Red Hat&#039;s specialized responses to security vulnerabilities.
                                    </p>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="View Responses" data-analytics-linkType="cta" href="https://access.redhat.com/security/vulnerability">View Responses
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__security__resources">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Resources" href="https://access.redhat.com/security/overview">Resources
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__security__resources">                                            <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Security Blog" href="//redhat.com/en/blog/channel/security">Security Blog
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Security Measurement" href="https://www.redhat.com/security/data/metrics/">Security Measurement
                                                    </a></li>
                                                    <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Severity Ratings" href="https://access.redhat.com/security/updates/classification/">Severity Ratings
                                                        </a></li>
                                                        <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Backporting Policies" href="https://access.redhat.com/security/updates/backporting/">Backporting Policies
                                                            </a></li>
                                                            <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Product Signing (GPG) Keys" href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys
                                                                </a></li>
                                    </ul>
                                </div>

                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a href="https://access.redhat.com/community/" class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Community">Community
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="nav__community__cp-community">
                                        <a href="https://access.redhat.com/community" data-analytics-level="2" data-analytics-text="Customer Portal Community" data-analytics-text="Customer Portal Community" data-analytics-category="Community">Customer Portal Community
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__community__cp-community">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Discussions" href="https://access.redhat.com/discussions">Discussions
                                            </a></li>                                                <li><a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Private Groups" href="https://access.redhat.com/groups/">Private Groups
                                                    </a></li>
                                    </ul>

                                    <pfe-cta pfe-priority="primary">
                                        <a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Community Activity" data-analytics-linkType="cta" href="https://access.redhat.com/community/">Community Activity
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__community__events" data-analytics-level="2" data-analytics-text="Customer Events" data-analytics-category="Community">Customer Events
                                    </h3>
                                    <ul aria-labelledby="nav__community__events">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Customer Events" data-analytics-text="Red Hat Convergence" href="https://access.redhat.com/convergence/">Red Hat Convergence
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Community|Customer Events" data-analytics-text="Red Hat Summit" href="http://www.redhat.com/summit/">Red Hat Summit
                                                </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__community__stories" data-analytics-level="2" data-analytics-text="Stories" data-analytics-category="Community">Stories
                                    </h3>
                                    <ul aria-labelledby="nav__community__stories">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Stories" data-analytics-text="Red Hat Subscription Value" href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-text="You Asked. We Acted." data-analytics-category="Community|Stories" href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Community|Stories" data-analytics-text="Open Source Communities" href="http://www.redhat.com/en/open-source">Open Source Communities
                                                    </a></li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                    </ul>                </nav>                <div id="site-search" slot="search" class="utility-link site-search">
                    <div class="content">
                        <form class="ng-pristine ng-valid topSearchForm" id="topSearchForm" name="topSearchForm" action="/search/browse/search/" method="get" enctype="application/x-www-form-urlencoded">
                            <cp-search-autocomplete class="push-bottom" path="/webassets/avalon/j/data.json"></cp-search-autocomplete>                            <div>Or <a href="/support/cases/#/troubleshoot">troubleshoot an issue</a>.
                            </div>
                        </form>
                    </div>
                </div>


                <div slot="secondary-links" id="localesMenu">
                    <button class="pfe-navigation__secondary-link">
                        <pfe-icon icon="web-icon-globe" size="sm" aria-hidden="true"></pfe-icon>English
                    </button>

                    <pfe-navigation-dropdown dropdown-width="single">
                        <h2 class="utility-header">Select Your Language
                        </h2>
                        <ul class="reset">
                            <li><a href="https://access.redhat.com/changeLanguage?language=en" data-lang="en" id="en" data-analytics-text="English">English</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=ko" data-lang="ko" id="ko" data-analytics-text="Korean">한국어</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=ja"    data-lang="ja"    id="ja" data-analytics-text="Japanese">日本語</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" data-lang="zh_CN" id="zh_CN" data-analytics-text="Chinese">中文 (中国)</a></li>
                        </ul>

                    </pfe-navigation-dropdown>
                </div>                <rh-account-dropdown slot="account"></rh-account-dropdown>                <pfe-primary-detail breakpoint-width="600" class="main-menu__dropdown--product__product-listing" slot="main-menu__dropdown--product__product-listing" consistent-height>
                    <h3 slot="details-nav">Infrastructure and Management                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Enterprise Linux" href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Satellite" href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Subscription Management" href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Insights" href="https://access.redhat.com/products/red-hat-insights/">Red Hat Insights
                                </a>
                            </li>
                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Ansible Automation Platform" href="https://access.redhat.com/products/red-hat-ansible-automation-platform/">Red Hat Ansible Automation Platform
                                </a></li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Cloud Computing                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift" href="https://access.redhat.com/products/openshift">Red Hat OpenShift
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenStack Platform" href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat OpenShift Container Platform" href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat OpenShift Data Science" href="https://access.redhat.com/products/red-hat-openshift-data-science/">Red Hat OpenShift Data Science
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift Dedicated" href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat Advanced Cluster Security for Kubernetes" href="https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/">Red Hat Advanced Cluster Security for Kubernetes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat Advanced Cluster Management for Kubernetes" href="https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/">Red Hat Advanced Cluster Management for Kubernetes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat Quay" href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat CodeReady Workspaces" href="https://access.redhat.com/products/red-hat-codeready-workspaces/">OpenShift Dev Spaces
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift Service on AWS" href="https://access.redhat.com/products/red-hat-openshift-service-aws">Red Hat OpenShift Service on AWS
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Storage                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Gluster Storage" href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Hyperconverged Infrastructure" href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Ceph Storage" href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Openshift Container Storage" href="https://access.redhat.com/products/red-hat-openshift-data-foundation">Red Hat OpenShift Data Foundation
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Runtimes                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Runtimes" href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat JBoss Enterprise Application Platform" href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Data Grid" href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat JBoss Web Server" href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Single Sign On" href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat support for Spring Boot" href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat build of Node.js" href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js
                                </a>
                            </li>                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat build of Quarkus" href="https://access.redhat.com/products/quarkus/">Red Hat build of Quarkus
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Integration and Automation                    </h3>
                    <div slot="details">
                        <ul class="border-bottom" id="portal-menu-border-bottom">
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat Application Foundations" href="https://access.redhat.com/products/red-hat-application-foundations/">Red Hat Application Foundations
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat Fuse" href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat AMQ" href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat 3scale API Management" href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div slot="details-nav--footer">
                        <pfe-cta pfe-priority="primary">
                            <a href="https://access.redhat.com/products/" class="pfe-navigation__menu-link" data-analytics-level="2" data-analytics-text="All Products" data-analytics-category="Products and Services|Products:" data-analytics-linkType="cta">All Products
                            </a>
                        </pfe-cta>
                    </div>
                </pfe-primary-detail>

            </pfe-navigation>

            <div id="scroll-anchor"></div>

            <!--[if IE 8]>
                <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                <span class="icon-warning alert-icon" aria-hidden="true"></span>
                You are using an unsupported web browser. Update to a supported browser for the best experience. <a href="/announcements/2120951">Read the announcement</a>.
                </div>
                </div>
            <![endif]-->
            <!--[if IE 9]>
                <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                <span class="icon-warning alert-icon" aria-hidden="true"></span>As of March 1, 2016, the Red Hat Customer Portal will no longer support Internet Explorer 9. See our new <a href="/help/browsers">browser support policy</a> for more information.
                </div>
                </div>
            <![endif]-->
            <div id="site-section"></div>
        </header>
        <!--googleon: all-->

        <main id="cp-main" class="portal-content-area">
            <div id="cp-content" class="main-content">                            <!-- /CP_PRIMER_HEADER -->

      <div class="container">
        

                                                                                                        <script>breadcrumbs = [["Products & Services","\/products\/"],["Product Documentation","\/documentation"],["OpenShift Container Platform","\/documentation\/en-us\/openshift_container_platform"],["4.13","\/documentation\/en-us\/openshift_container_platform\/4.13"],["Security and compliance","\/documentation\/en-us\/openshift_container_platform\/4.13\/html\/security_and_compliance"],["Security and compliance","\/documentation\/en-us\/openshift_container_platform\/4.13\/html\/security_and_compliance\/--single-page-document--"]]</script>

<div data-drupal-messages-fallback class="hidden"></div>


    </div>
        <div class="container">
        

  

  


  <article class="pvof-doc__content-wrapper__outer pvof-doc__content-wrapper__outer--css-not-removed">
    <script>
      'use strict';

            var $outerWrapper = document.querySelector('.pvof-doc__content-wrapper__outer');
      if ($outerWrapper && $outerWrapper.closest) {
        var $containerWrapper = $outerWrapper.closest('.container');
        if ($containerWrapper) {
          $containerWrapper.classList.remove('container');
          $containerWrapper.classList.add('j-chrome-content-container');
        }
      }

            var cssRemoved = false;
      try {
        var $crapCss = document.querySelectorAll(
          'link[href*="/chrome_themes/nimbus/css/pages.css"], link[href*="/chrome_themes/nimbus/css/components.css"]'
        );
        if ($crapCss.length) {
          for (let index = 0; index < $crapCss.length; index++) {
            const $stylesheet = $crapCss[index];
            $stylesheet.remove();
          }
        }
        cssRemoved = true;
      }
      catch (error) {
        console.error('Ran into an issue while trying to retheme page', error);
        cssRemoved = false;
      }

            if (cssRemoved) {
        var $pvofOuterWrapper = document.querySelector('.pvof-doc__content-wrapper__outer--css-not-removed');
        if ($pvofOuterWrapper) {
          $pvofOuterWrapper.classList.remove('pvof-doc__content-wrapper__outer--css-not-removed');
        }
      }
    </script>
    <div itemscope="" itemtype="https://schema.org/TechArticle" itemref="techArticle-md1 techArticle-md2 techArticle-md3"></div>
    <div itemscope="" itemtype="https://schema.org/SoftwareApplication" itemref="softwareApplication-md1 softwareApplication-md2 softwareApplication-md3 softwareApplication-md4"></div>
    <div class="pvof-doc__content-wrapper pvof-doc__content-wrapper--has-sidebar">
                                <div class="pvof-doc__content-wrapper__inner j-superdoc j-superdoc--has-nav">
                            <div class="pvof-sidebar__wrapper j-doc-nav j-superdoc__nav">
            <div class="j-sidebar__menu-container">
              <button class="j-sidebar__menu-trigger content-expander__trigger">
                <span class="j-sidebar__menu-trigger__open-text">Jump To</span>
                <span class="j-sidebar__menu-trigger__close-text">Close</span>
              </button>

              <div class="pvof-sidebar__inner-wrapper j-doc-nav__wrapper content-expander">
                <div class="j-sidebar__menu-details-container">
                  <button class="j-sidebar__menu-details-button j-sidebar__menu-details-button--expand">
                    Expand all
                  </button>
                  <button class="j-sidebar__menu-details-button j-sidebar__menu-details-button--collapse">
                    Collapse all
                  </button>
                </div>
                

  <nav id="pvof-doc__toc" class="pvof-doc__toc">
  <h2 class="j-doc-nav__title" id="j-doc-nav__title">
    Table of contents
  </h2>
  <div class="pvof-doc__toc-inner">
              <ol class="j-doc-nav__list" aria-labelledby="j-doc-nav__title">
                  <li class="j-doc-nav__list-item">
                                    

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance" class="j-doc-nav__link ">
    Security and compliance
  </a>
  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-compliance-overview" class="j-doc-nav__link j-doc-nav__link--has-children">
    1. OpenShift Container Platform security and compliance
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1. OpenShift Container Platform security and compliance"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1. OpenShift Container Platform security and compliance"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-overview" class="j-doc-nav__link ">
    1.1. Security overview
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-overview" class="j-doc-nav__link ">
    1.2. Compliance overview
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#additional-resources_security-compliance-overview" class="j-doc-nav__link ">
    1.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#container-security-1" class="j-doc-nav__link j-doc-nav__link--has-children">
    2. Container security
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2. Container security"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2. Container security"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-understanding" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1. Understanding container security
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1. Understanding container security"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1. Understanding container security"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-understanding-containers_security-understanding" class="j-doc-nav__link ">
    2.1.1. What are containers?
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-understanding-openshift_security-understanding" class="j-doc-nav__link ">
    2.1.2. What is OpenShift Container Platform?
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-hosts-vms" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.2. Understanding host and VM security
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.2. Understanding host and VM security"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.2. Understanding host and VM security"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-hosts-vms-rhcos_security-hosts-vms" class="j-doc-nav__link ">
    2.2.1. Securing containers on Red Hat Enterprise Linux CoreOS (RHCOS)
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-hosts-vms-vs-containers_security-hosts-vms" class="j-doc-nav__link ">
    2.2.2. Comparing virtualization and containers
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-hosts-vms-openshift_security-hosts-vms" class="j-doc-nav__link ">
    2.2.3. Securing OpenShift Container Platform
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-hardening" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.3. Hardening RHCOS
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.3. Hardening RHCOS"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.3. Hardening RHCOS"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-hardening-what_security-hardening" class="j-doc-nav__link ">
    2.3.1. Choosing what to harden in RHCOS
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-hardening-how_security-hardening" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.3.2. Choosing how to harden RHCOS
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.3.2. Choosing how to harden RHCOS"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.3.2. Choosing how to harden RHCOS"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-harden-before-installation_security-hardening" class="j-doc-nav__link ">
    2.3.2.1. Hardening before installation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-harden-during-installation_security-hardening" class="j-doc-nav__link ">
    2.3.2.2. Hardening during installation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-harden-after-installation_security-hardening" class="j-doc-nav__link ">
    2.3.2.3. Hardening after the cluster is running
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-container-signature" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4. Container image signatures
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4. Container image signatures"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4. Container image signatures"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#containers-signature-verify-enable_security-container-signature" class="j-doc-nav__link ">
    2.4.1. Enabling signature verification for Red Hat Container Registries
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#containers-signature-verify-application_security-container-signature" class="j-doc-nav__link ">
    2.4.2. Verifying the signature verification configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#additional-resources_security-container-signature" class="j-doc-nav__link ">
    2.4.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-compliance" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5. Understanding compliance
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5. Understanding compliance"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5. Understanding compliance"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-compliance-nist_security-compliance" class="j-doc-nav__link ">
    2.5.1. Understanding compliance and risk management
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-container-content" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.6. Securing container content
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.6. Securing container content"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.6. Securing container content"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-container-content-inside_security-container-content" class="j-doc-nav__link ">
    2.6.1. Securing inside the container
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-container-content-universal_security-container-content" class="j-doc-nav__link ">
    2.6.2. Creating redistributable images with UBI
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-container-content-scanning_security-container-content" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.6.3. Security scanning in RHEL
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.6.3. Security scanning in RHEL"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.6.3. Security scanning in RHEL"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#quay-security-scan_security-container-content" class="j-doc-nav__link ">
    2.6.3.1. Scanning OpenShift images
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-container-content-external-scanning_security-container-content" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.6.4. Integrating external scanning
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.6.4. Integrating external scanning"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.6.4. Integrating external scanning"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-image-metadata_security-container-content" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.6.4.1. Image metadata
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.6.4.1. Image metadata"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.6.4.1. Image metadata"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-example-annotation-keys_security-container-content" class="j-doc-nav__link ">
    2.6.4.1.1. Example annotation keys
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-example-annotation-values_security-container-content" class="j-doc-nav__link ">
    2.6.4.1.2. Example annotation values
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-annotating-image-objects_security-container-content" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.6.4.2. Annotating image objects
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.6.4.2. Annotating image objects"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.6.4.2. Annotating image objects"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-example-annotate-CLI_security-container-content" class="j-doc-nav__link ">
    2.6.4.2.1. Example annotate CLI command
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#controlling-pod-execution_security-container-content" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.6.4.3. Controlling pod execution
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.6.4.3. Controlling pod execution"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.6.4.3. Controlling pod execution"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-controlling-pod-execution-example-annotation_security-container-content" class="j-doc-nav__link ">
    2.6.4.3.1. Example annotation
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-integration-reference_security-container-content" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.6.4.4. Integration reference
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.6.4.4. Integration reference"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.6.4.4. Integration reference"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-integration-reference-example-api-call_security-container-content" class="j-doc-nav__link ">
    2.6.4.4.1. Example REST API call
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-registries" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.7. Using container registries securely
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.7. Using container registries securely"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.7. Using container registries securely"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-registries-where_security-registries" class="j-doc-nav__link ">
    2.7.1. Knowing where containers come from?
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-registries-immutable_security-registries" class="j-doc-nav__link ">
    2.7.2. Immutable and certified containers
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-registries-ecosystem_security-registries" class="j-doc-nav__link ">
    2.7.3. Getting containers from Red Hat Registry and Ecosystem Catalog
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-registries-openshift_security-registries" class="j-doc-nav__link ">
    2.7.4. OpenShift Container Registry
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-registries-quay_security-registries" class="j-doc-nav__link ">
    2.7.5. Storing containers using Red Hat Quay
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-build" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.8. Securing the build process
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.8. Securing the build process"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.8. Securing the build process"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-build-once_security-build" class="j-doc-nav__link ">
    2.8.1. Building once, deploying everywhere
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-build-management_security-build" class="j-doc-nav__link ">
    2.8.2. Managing builds
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-build-inputs_security-build" class="j-doc-nav__link ">
    2.8.3. Securing inputs during builds
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-build-designing_security-build" class="j-doc-nav__link ">
    2.8.4. Designing your build process
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-build-knative_security-build" class="j-doc-nav__link ">
    2.8.5. Building Knative serverless applications
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#additional-resources_security-build" class="j-doc-nav__link ">
    2.8.6. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-deploy" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.9. Deploying containers
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.9. Deploying containers"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.9. Deploying containers"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-deploy-trigger_security-deploy" class="j-doc-nav__link ">
    2.9.1. Controlling container deployments with triggers
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-deploy-image-sources_security-deploy" class="j-doc-nav__link ">
    2.9.2. Controlling what image sources can be deployed
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-deploy-signature_security-deploy" class="j-doc-nav__link ">
    2.9.3. Using signature transports
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-deploy-secrets_security-deploy" class="j-doc-nav__link ">
    2.9.4. Creating secrets and config maps
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-deploy-continuous_security-deploy" class="j-doc-nav__link ">
    2.9.5. Automating continuous deployment
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-platform" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.10. Securing the container platform
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.10. Securing the container platform"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.10. Securing the container platform"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-platform-multi-tenancy_security-platform" class="j-doc-nav__link ">
    2.10.1. Isolating containers with multitenancy
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-platform-admission_security-platform" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.10.2. Protecting control plane with admission plugins
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.10.2. Protecting control plane with admission plugins"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.10.2. Protecting control plane with admission plugins"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-deployment-sccs_security-platform" class="j-doc-nav__link ">
    2.10.2.1. Security context constraints (SCCs)
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-service-account_security-platform" class="j-doc-nav__link ">
    2.10.2.2. Granting roles to service accounts
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-platform-authentication_security-platform" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.10.3. Authentication and authorization
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.10.3. Authentication and authorization"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.10.3. Authentication and authorization"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-platform-auth-controlling-access_security-platform" class="j-doc-nav__link ">
    2.10.3.1. Controlling access using OAuth
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-platform-api-access-control_security-platform" class="j-doc-nav__link ">
    2.10.3.2. API access control and management
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-platform-red-hat-sso_security-platform" class="j-doc-nav__link ">
    2.10.3.3. Red Hat Single Sign-On
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-platform-auth-secure-self-service-web-console_security-platform" class="j-doc-nav__link ">
    2.10.3.4. Secure self-service web console
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-platform-certificates_security-platform" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.10.4. Managing certificates for the platform
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.10.4. Managing certificates for the platform"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.10.4. Managing certificates for the platform"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-platform-config-custom-certs_security-platform" class="j-doc-nav__link ">
    2.10.4.1. Configuring custom certificates
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-network" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.11. Securing networks
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.11. Securing networks"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.11. Securing networks"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-network-namespaces_security-network" class="j-doc-nav__link ">
    2.11.1. Using network namespaces
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-network-policies_security-network" class="j-doc-nav__link ">
    2.11.2. Isolating pods with network policies
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-network-multiple-pod_security-network" class="j-doc-nav__link ">
    2.11.3. Using multiple pod networks
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-network-isolating_security-network" class="j-doc-nav__link ">
    2.11.4. Isolating applications
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-network-ingress_security-network" class="j-doc-nav__link ">
    2.11.5. Securing ingress traffic
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-network-egress_security-network" class="j-doc-nav__link ">
    2.11.6. Securing egress traffic
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-storage" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.12. Securing attached storage
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.12. Securing attached storage"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.12. Securing attached storage"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-network-storage-persistent_security-storage" class="j-doc-nav__link ">
    2.12.1. Persistent volume plugins
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-network-storage-shared_security-storage" class="j-doc-nav__link ">
    2.12.2. Shared storage
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-network-storage-block_security-storage" class="j-doc-nav__link ">
    2.12.3. Block storage
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-monitoring" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.13. Monitoring cluster events and logs
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.13. Monitoring cluster events and logs"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.13. Monitoring cluster events and logs"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-monitoring-events_security-monitoring" class="j-doc-nav__link ">
    2.13.1. Watching cluster events
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-monitoring-cluster-logging_security-monitoring" class="j-doc-nav__link ">
    2.13.2. Logging
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-monitoring-audit-logs_security-monitoring" class="j-doc-nav__link ">
    2.13.3. Audit logs
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#configuring-certificates" class="j-doc-nav__link j-doc-nav__link--has-children">
    3. Configuring certificates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "3. Configuring certificates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "3. Configuring certificates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#replacing-default-ingress" class="j-doc-nav__link j-doc-nav__link--has-children">
    3.1. Replacing the default ingress certificate
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "3.1. Replacing the default ingress certificate"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "3.1. Replacing the default ingress certificate"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#understanding-default-ingress_replacing-default-ingress" class="j-doc-nav__link ">
    3.1.1. Understanding the default ingress certificate
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#replacing-default-ingress_replacing-default-ingress" class="j-doc-nav__link ">
    3.1.2. Replacing the default ingress certificate
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#api-server-certificates" class="j-doc-nav__link j-doc-nav__link--has-children">
    3.2. Adding API server certificates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "3.2. Adding API server certificates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "3.2. Adding API server certificates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#customize-certificates-api-add-named_api-server-certificates" class="j-doc-nav__link ">
    3.2.1. Add an API server named certificate
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#add-service-serving" class="j-doc-nav__link j-doc-nav__link--has-children">
    3.3. Securing service traffic using service serving certificate secrets
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "3.3. Securing service traffic using service serving certificate secrets"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "3.3. Securing service traffic using service serving certificate secrets"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#understanding-service-serving_service-serving-certificate" class="j-doc-nav__link ">
    3.3.1. Understanding service serving certificates
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#add-service-certificate_service-serving-certificate" class="j-doc-nav__link ">
    3.3.2. Add a service certificate
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#add-service-certificate-configmap_service-serving-certificate" class="j-doc-nav__link ">
    3.3.3. Add the service CA bundle to a config map
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#add-service-certificate-apiservice_service-serving-certificate" class="j-doc-nav__link ">
    3.3.4. Add the service CA bundle to an API service
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#add-service-certificate-crd_service-serving-certificate" class="j-doc-nav__link ">
    3.3.5. Add the service CA bundle to a custom resource definition
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#add-service-certificate-mutating-webhook_service-serving-certificate" class="j-doc-nav__link ">
    3.3.6. Add the service CA bundle to a mutating webhook configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#add-service-certificate-validating-webhook_service-serving-certificate" class="j-doc-nav__link ">
    3.3.7. Add the service CA bundle to a validating webhook configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#rotate-service-serving_service-serving-certificate" class="j-doc-nav__link ">
    3.3.8. Manually rotate the generated service certificate
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#manually-rotate-service-ca_service-serving-certificate" class="j-doc-nav__link ">
    3.3.9. Manually rotate the service CA certificate
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#updating-ca-bundle" class="j-doc-nav__link j-doc-nav__link--has-children">
    3.4. Updating the CA bundle
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "3.4. Updating the CA bundle"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "3.4. Updating the CA bundle"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#ca-bundle-understanding_updating-ca-bundle" class="j-doc-nav__link ">
    3.4.1. Understanding the CA Bundle certificate
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#ca-bundle-replacing_updating-ca-bundle" class="j-doc-nav__link ">
    3.4.2. Replacing the CA Bundle certificate
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#certificate-types-and-descriptions" class="j-doc-nav__link j-doc-nav__link--has-children">
    4. Certificate types and descriptions
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4. Certificate types and descriptions"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4. Certificate types and descriptions"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-types-user-provided-certificates-for-the-api-server" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.1. User-provided certificates for the API server
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.1. User-provided certificates for the API server"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.1. User-provided certificates for the API server"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#purpose" class="j-doc-nav__link ">
    4.1.1. Purpose
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#location" class="j-doc-nav__link ">
    4.1.2. Location
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#management" class="j-doc-nav__link ">
    4.1.3. Management
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#expiration" class="j-doc-nav__link ">
    4.1.4. Expiration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#customization" class="j-doc-nav__link ">
    4.1.5. Customization
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-types-proxy-certificates" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.2. Proxy certificates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.2. Proxy certificates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.2. Proxy certificates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#purpose-2" class="j-doc-nav__link ">
    4.2.1. Purpose
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#managing-proxy-certificates-during-installation" class="j-doc-nav__link ">
    4.2.2. Managing proxy certificates during installation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#location-2" class="j-doc-nav__link ">
    4.2.3. Location
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#expiration-2" class="j-doc-nav__link ">
    4.2.4. Expiration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#services" class="j-doc-nav__link ">
    4.2.5. Services
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#management-2" class="j-doc-nav__link ">
    4.2.6. Management
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#customization-2" class="j-doc-nav__link ">
    4.2.7. Customization
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#renewal" class="j-doc-nav__link ">
    4.2.8. Renewal
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-types-service-ca-certificates" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.3. Service CA certificates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.3. Service CA certificates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.3. Service CA certificates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#purpose-3" class="j-doc-nav__link ">
    4.3.1. Purpose
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#expiration-3" class="j-doc-nav__link ">
    4.3.2. Expiration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#management-3" class="j-doc-nav__link ">
    4.3.3. Management
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#services-2" class="j-doc-nav__link ">
    4.3.4. Services
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-types-node-certificates" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.4. Node certificates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.4. Node certificates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.4. Node certificates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#purpose-4" class="j-doc-nav__link ">
    4.4.1. Purpose
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#management-4" class="j-doc-nav__link ">
    4.4.2. Management
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-types-bootstrap-certificates" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.5. Bootstrap certificates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.5. Bootstrap certificates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.5. Bootstrap certificates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#purpose-5" class="j-doc-nav__link ">
    4.5.1. Purpose
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#management-5" class="j-doc-nav__link ">
    4.5.2. Management
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#expiration-4" class="j-doc-nav__link ">
    4.5.3. Expiration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#customization-3" class="j-doc-nav__link ">
    4.5.4. Customization
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-types-etcd-certificates" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.6. etcd certificates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.6. etcd certificates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.6. etcd certificates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#purpose-6" class="j-doc-nav__link ">
    4.6.1. Purpose
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#expiration-5" class="j-doc-nav__link ">
    4.6.2. Expiration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#management-6" class="j-doc-nav__link ">
    4.6.3. Management
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#services-3" class="j-doc-nav__link ">
    4.6.4. Services
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-types-olm-certificates" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.7. OLM certificates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.7. OLM certificates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.7. OLM certificates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#management-7" class="j-doc-nav__link ">
    4.7.1. Management
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-types-aggregated-api-client-certificates" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.8. Aggregated API client certificates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.8. Aggregated API client certificates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.8. Aggregated API client certificates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#purpose-7" class="j-doc-nav__link ">
    4.8.1. Purpose
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#management-8" class="j-doc-nav__link ">
    4.8.2. Management
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#expiration-6" class="j-doc-nav__link ">
    4.8.3. Expiration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#customization-4" class="j-doc-nav__link ">
    4.8.4. Customization
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-types-machine-config-operator-certificates" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.9. Machine Config Operator certificates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.9. Machine Config Operator certificates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.9. Machine Config Operator certificates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#purpose-8" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.9.1. Purpose
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.9.1. Purpose"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.9.1. Purpose"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#provisioning-details" class="j-doc-nav__link ">
    4.9.1.1. Provisioning details
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#provisioning-chain-of-trust" class="j-doc-nav__link ">
    4.9.1.2. Provisioning chain of trust
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#key-material-inside-a-cluster" class="j-doc-nav__link ">
    4.9.1.3. Key material inside a cluster
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#management-9" class="j-doc-nav__link ">
    4.9.2. Management
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#expiration-7" class="j-doc-nav__link ">
    4.9.3. Expiration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#customization-5" class="j-doc-nav__link ">
    4.9.4. Customization
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-types-user-provided-certificates-for-default-ingress" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.10. User-provided certificates for default ingress
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.10. User-provided certificates for default ingress"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.10. User-provided certificates for default ingress"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#purpose-9" class="j-doc-nav__link ">
    4.10.1. Purpose
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#location-3" class="j-doc-nav__link ">
    4.10.2. Location
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#management-10" class="j-doc-nav__link ">
    4.10.3. Management
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#expiration-8" class="j-doc-nav__link ">
    4.10.4. Expiration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#services-4" class="j-doc-nav__link ">
    4.10.5. Services
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#customization-6" class="j-doc-nav__link ">
    4.10.6. Customization
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-types-ingress-certificates" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.11. Ingress certificates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.11. Ingress certificates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.11. Ingress certificates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#purpose-10" class="j-doc-nav__link ">
    4.11.1. Purpose
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#location-4" class="j-doc-nav__link ">
    4.11.2. Location
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#workflow" class="j-doc-nav__link ">
    4.11.3. Workflow
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#expiration-9" class="j-doc-nav__link ">
    4.11.4. Expiration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#services-5" class="j-doc-nav__link ">
    4.11.5. Services
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#management-11" class="j-doc-nav__link ">
    4.11.6. Management
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#renewal-2" class="j-doc-nav__link ">
    4.11.7. Renewal
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-types-monitoring-and-cluster-logging-operator-component-certificates" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.12. Monitoring and OpenShift Logging Operator component certificates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.12. Monitoring and OpenShift Logging Operator component certificates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.12. Monitoring and OpenShift Logging Operator component certificates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#expiration-10" class="j-doc-nav__link ">
    4.12.1. Expiration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#management-12" class="j-doc-nav__link ">
    4.12.2. Management
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-types-control-plane-certificates" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.13. Control plane certificates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.13. Control plane certificates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.13. Control plane certificates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#location-5" class="j-doc-nav__link ">
    4.13.1. Location
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#management-13" class="j-doc-nav__link ">
    4.13.2. Management
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator" class="j-doc-nav__link j-doc-nav__link--has-children">
    5. Compliance Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5. Compliance Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5. Compliance Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#co-overview" class="j-doc-nav__link ">
    5.1. Compliance Operator overview
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-release-notes" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2. Compliance Operator release notes
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2. Compliance Operator release notes"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2. Compliance Operator release notes"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-release-notes-1-3-0" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2.1. OpenShift Compliance Operator 1.3.0
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2.1. OpenShift Compliance Operator 1.3.0"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2.1. OpenShift Compliance Operator 1.3.0"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-1-3-0-new-features-and-enhancements" class="j-doc-nav__link ">
    5.2.1.1. New features and enhancements
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-release-notes-1-2-0" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2.2. OpenShift Compliance Operator 1.2.0
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2.2. OpenShift Compliance Operator 1.2.0"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2.2. OpenShift Compliance Operator 1.2.0"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-1-2-0-new-features-and-enhancements" class="j-doc-nav__link ">
    5.2.2.1. New features and enhancements
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-release-notes-1-1-0" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2.3. OpenShift Compliance Operator 1.1.0
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2.3. OpenShift Compliance Operator 1.1.0"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2.3. OpenShift Compliance Operator 1.1.0"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-1-1-0-new-features-and-enhancements" class="j-doc-nav__link ">
    5.2.3.1. New features and enhancements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-1-1-0-bug-fixes" class="j-doc-nav__link ">
    5.2.3.2. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-release-notes-1-0-0" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2.4. OpenShift Compliance Operator 1.0.0
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2.4. OpenShift Compliance Operator 1.0.0"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2.4. OpenShift Compliance Operator 1.0.0"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-1-0-0-new-features-and-enhancements" class="j-doc-nav__link ">
    5.2.4.1. New features and enhancements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-1-0-0-bug-fixes" class="j-doc-nav__link ">
    5.2.4.2. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-release-notes-0-1-61" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2.5. OpenShift Compliance Operator 0.1.61
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2.5. OpenShift Compliance Operator 0.1.61"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2.5. OpenShift Compliance Operator 0.1.61"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-61-new-features-and-enhancements" class="j-doc-nav__link ">
    5.2.5.1. New features and enhancements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-61-bug-fixes" class="j-doc-nav__link ">
    5.2.5.2. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-release-notes-0-1-59" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2.6. OpenShift Compliance Operator 0.1.59
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2.6. OpenShift Compliance Operator 0.1.59"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2.6. OpenShift Compliance Operator 0.1.59"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-59-new-features-and-enhancements" class="j-doc-nav__link ">
    5.2.6.1. New features and enhancements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-59-bug-fixes" class="j-doc-nav__link ">
    5.2.6.2. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-release-notes-0-1-57" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2.7. OpenShift Compliance Operator 0.1.57
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2.7. OpenShift Compliance Operator 0.1.57"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2.7. OpenShift Compliance Operator 0.1.57"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-57-new-features-and-enhancements" class="j-doc-nav__link ">
    5.2.7.1. New features and enhancements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-57-bug-fixes" class="j-doc-nav__link ">
    5.2.7.2. Bug fixes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-57-deprecations" class="j-doc-nav__link ">
    5.2.7.3. Deprecations
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-release-notes-0-1-53" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2.8. OpenShift Compliance Operator 0.1.53
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2.8. OpenShift Compliance Operator 0.1.53"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2.8. OpenShift Compliance Operator 0.1.53"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-53-bug-fixes" class="j-doc-nav__link ">
    5.2.8.1. Bug fixes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-53-known-issue" class="j-doc-nav__link ">
    5.2.8.2. Known issue
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-release-notes-0-1-52" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2.9. OpenShift Compliance Operator 0.1.52
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2.9. OpenShift Compliance Operator 0.1.52"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2.9. OpenShift Compliance Operator 0.1.52"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-52-new-features-and-enhancements" class="j-doc-nav__link ">
    5.2.9.1. New features and enhancements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-52-bug-fixes" class="j-doc-nav__link ">
    5.2.9.2. Bug fixes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-52-known-issue" class="j-doc-nav__link ">
    5.2.9.3. Known issue
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-release-notes-0-1-49" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2.10. OpenShift Compliance Operator 0.1.49
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2.10. OpenShift Compliance Operator 0.1.49"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2.10. OpenShift Compliance Operator 0.1.49"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-49-new-features-and-enhancements" class="j-doc-nav__link ">
    5.2.10.1. New features and enhancements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-49-bug-fixes" class="j-doc-nav__link ">
    5.2.10.2. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-release-notes-0-1-48" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2.11. OpenShift Compliance Operator 0.1.48
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2.11. OpenShift Compliance Operator 0.1.48"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2.11. OpenShift Compliance Operator 0.1.48"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#openshift-compliance-operator-0-1-48-bug-fixes" class="j-doc-nav__link ">
    5.2.11.1. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-release-notes-0-1-47" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2.12. OpenShift Compliance Operator 0.1.47
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2.12. OpenShift Compliance Operator 0.1.47"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2.12. OpenShift Compliance Operator 0.1.47"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-47-new-features-and-enhancements" class="j-doc-nav__link ">
    5.2.12.1. New features and enhancements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#openshift-compliance-operator-0-1-47-bug-fixes" class="j-doc-nav__link ">
    5.2.12.2. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-release-notes-0-1-44" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2.13. OpenShift Compliance Operator 0.1.44
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2.13. OpenShift Compliance Operator 0.1.44"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2.13. OpenShift Compliance Operator 0.1.44"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-44-new-features-and-enhancements" class="j-doc-nav__link ">
    5.2.13.1. New features and enhancements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#openshift-compliance-operator-0-1-44-templating" class="j-doc-nav__link ">
    5.2.13.2. Templating and variable use
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#openshift-compliance-operator-0-1-44-bug-fixes" class="j-doc-nav__link ">
    5.2.13.3. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-release-notes-0-1-39" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2.14. Release Notes for Compliance Operator 0.1.39
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2.14. Release Notes for Compliance Operator 0.1.39"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2.14. Release Notes for Compliance Operator 0.1.39"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-0-1-39-new-features-and-enhancements" class="j-doc-nav__link ">
    5.2.14.1. New features and enhancements
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-release-notes_additional-resources" class="j-doc-nav__link ">
    5.2.15. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-concepts-2" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3. Compliance Operator concepts
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3. Compliance Operator concepts"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3. Compliance Operator concepts"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#understanding-compliance-operator" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.1. Understanding the Compliance Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.1. Understanding the Compliance Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.1. Understanding the Compliance Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance_profiles_understanding-compliance" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.1.1. Compliance Operator profiles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.1.1. Compliance Operator profiles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.1.1. Compliance Operator profiles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance_profile_types_understanding-compliance" class="j-doc-nav__link ">
    5.3.1.1.1. Compliance Operator profile types
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#additional-resources_compliance-operator-understanding" class="j-doc-nav__link ">
    5.3.1.2. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#custom-resource-definitions" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.2. Understanding the Custom Resource Definitions
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.2. Understanding the Custom Resource Definitions"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.2. Understanding the Custom Resource Definitions"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#custom-resource-definitions-workflow_compliance-crd" class="j-doc-nav__link ">
    5.3.2.1. CRDs workflow
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#defining-compliance-scan-requirements_compliance-crd" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.2.2. Defining the compliance scan requirements
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.2.2. Defining the compliance scan requirements"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.2.2. Defining the compliance scan requirements"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#profile-bundle-object_compliance-crd" class="j-doc-nav__link ">
    5.3.2.2.1. ProfileBundle object
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#profile-object_compliance-crd" class="j-doc-nav__link ">
    5.3.2.2.2. Profile object
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#rule-object_compliance-crd" class="j-doc-nav__link ">
    5.3.2.2.3. Rule object
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#tailored-profile-object_compliance-crd" class="j-doc-nav__link ">
    5.3.2.2.4. TailoredProfile object
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#configure-compliance-scan-settings_compliance-crd" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.2.3. Configuring the compliance scan settings
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.2.3. Configuring the compliance scan settings"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.2.3. Configuring the compliance scan settings"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#scan-setting-object_compliance-crd" class="j-doc-nav__link ">
    5.3.2.3.1. ScanSetting object
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#process-compliance-requirements-with-compliance-settings_compliance-crd" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.2.4. Processing the compliance scan requirements with compliance scans settings
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.2.4. Processing the compliance scan requirements with compliance scans settings"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.2.4. Processing the compliance scan requirements with compliance scans settings"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#scan-setting-binding-object_compliance-crd" class="j-doc-nav__link ">
    5.3.2.4.1. ScanSettingBinding object
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#track-compliance-scans_compliance-crd" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.2.5. Tracking the compliance scans
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.2.5. Tracking the compliance scans"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.2.5. Tracking the compliance scans"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-suite-object_compliance-crd" class="j-doc-nav__link ">
    5.3.2.5.1. ComplianceSuite object
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#advance-compliance-scan-object_compliance-crd" class="j-doc-nav__link ">
    5.3.2.5.2. Advanced ComplianceScan Object
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#view-compliance-results_compliance-crd" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.2.6. Viewing the compliance results
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.2.6. Viewing the compliance results"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.2.6. Viewing the compliance results"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-check-result_compliance-crd" class="j-doc-nav__link ">
    5.3.2.6.1. ComplianceCheckResult object
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-remediation-object_compliance-crd" class="j-doc-nav__link ">
    5.3.2.6.2. ComplianceRemediation object
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-management-2" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4. Compliance Operator management
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4. Compliance Operator management"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4. Compliance Operator management"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-installation" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.1. Installing the Compliance Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.1. Installing the Compliance Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.1. Installing the Compliance Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#installing-compliance-operator-web-console_compliance-operator-installation" class="j-doc-nav__link ">
    5.4.1.1. Installing the Compliance Operator through the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#installing-compliance-operator-cli_compliance-operator-installation" class="j-doc-nav__link ">
    5.4.1.2. Installing the Compliance Operator using the CLI
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#installing-compliance-operator-hcp_compliance-operator-installation" class="j-doc-nav__link ">
    5.4.1.3. Installing the Compliance Operator on Hosted control planes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#additional-resources-installing-the-compliance-operator" class="j-doc-nav__link ">
    5.4.1.4. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-updating" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.2. Updating the Compliance Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.2. Updating the Compliance Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.2. Updating the Compliance Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#olm-preparing-upgrade_compliance-operator-updating" class="j-doc-nav__link ">
    5.4.2.1. Preparing for an Operator update
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#olm-changing-update-channel_compliance-operator-updating" class="j-doc-nav__link ">
    5.4.2.2. Changing the update channel for an Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#olm-approving-pending-upgrade_compliance-operator-updating" class="j-doc-nav__link ">
    5.4.2.3. Manually approving a pending Operator update
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-understanding" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.3. Managing the Compliance Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.3. Managing the Compliance Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.3. Managing the Compliance Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-profilebundle_managing-compliance" class="j-doc-nav__link ">
    5.4.3.1. ProfileBundle CR example
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-update_managing-compliance" class="j-doc-nav__link ">
    5.4.3.2. Updating security content
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#additional-resources_managing-the-compliance-operator" class="j-doc-nav__link ">
    5.4.3.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-uninstallation" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.4. Uninstalling the Compliance Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.4. Uninstalling the Compliance Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.4. Uninstalling the Compliance Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-uninstall_compliance-operator-uninstallation" class="j-doc-nav__link ">
    5.4.4.1. Uninstalling the OpenShift Compliance Operator from OpenShift Container Platform using the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-uninstall-cli_compliance-operator-uninstallation" class="j-doc-nav__link ">
    5.4.4.2. Uninstalling the OpenShift Compliance Operator from OpenShift Container Platform using the CLI
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-scan-management-2" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5. Compliance Operator scan management
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5. Compliance Operator scan management"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5. Compliance Operator scan management"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-supported-profiles" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.1. Supported compliance profiles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.1. Supported compliance profiles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.1. Supported compliance profiles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-supported-profiles_compliance-operator-supported-profiles" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.1.1. Compliance profiles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.1.1. Compliance profiles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.1.1. Compliance profiles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-extended-profiles_compliance-operator-supported-profiles" class="j-doc-nav__link ">
    5.5.1.1.1. About extended compliance profiles
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#additional-resources-compliance-operator-" class="j-doc-nav__link ">
    5.5.1.2. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-scans" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.2. Compliance Operator scans
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.2. Compliance Operator scans"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.2. Compliance Operator scans"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#running-compliance-scans_compliance-operator-scans" class="j-doc-nav__link ">
    5.5.2.1. Running compliance scans
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#running-compliance-scans-worker-node_compliance-operator-scans" class="j-doc-nav__link ">
    5.5.2.2. Scheduling the result server pod on a worker node
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-scansetting-cr_compliance-operator-scans" class="j-doc-nav__link ">
    5.5.2.3. ScanSetting Custom Resource
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#co-hcp-mgmt-config_compliance-operator-scans" class="j-doc-nav__link ">
    5.5.2.4. Configuring the Hosted control planes management cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-applying-resource-requests-and-limits_compliance-operator-scans" class="j-doc-nav__link ">
    5.5.2.5. Applying resource requests and limits
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-scheduling-pods-with-resource-requests_compliance-operator-scans" class="j-doc-nav__link ">
    5.5.2.6. Scheduling Pods with container resource requests
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-tailor" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.3. Tailoring the Compliance Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.3. Tailoring the Compliance Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.3. Tailoring the Compliance Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-new-tailored-profiles_compliance-tailor" class="j-doc-nav__link ">
    5.5.3.1. Creating a new tailored profile
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-tailored-profiles_compliance-tailor" class="j-doc-nav__link ">
    5.5.3.2. Using tailored profiles to extend existing ProfileBundles
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-raw-results" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.4. Retrieving Compliance Operator raw results
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.4. Retrieving Compliance Operator raw results"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.4. Retrieving Compliance Operator raw results"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-results_compliance-raw-results" class="j-doc-nav__link ">
    5.5.4.1. Obtaining Compliance Operator raw results from a persistent volume
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-remediation" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.5. Managing Compliance Operator result and remediation
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.5. Managing Compliance Operator result and remediation"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.5. Managing Compliance Operator result and remediation"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#filtering-compliance-check-results_compliance-remediation" class="j-doc-nav__link ">
    5.5.5.1. Filters for compliance check results
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-review_compliance-remediation" class="j-doc-nav__link ">
    5.5.5.2. Reviewing a remediation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-apply-remediation-for-customized-mcp" class="j-doc-nav__link ">
    5.5.5.3. Applying remediation when using customized machine config pools
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-evaluate-kubeletconfig-rules_compliance-remediation" class="j-doc-nav__link ">
    5.5.5.4. Evaluating KubeletConfig rules against default configuration values
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-custom-node-pools_compliance-remediation" class="j-doc-nav__link ">
    5.5.5.5. Scanning custom node pools
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-kubeletconfig-sub-pool-remediation_compliance-remediation" class="j-doc-nav__link ">
    5.5.5.6. Remediating KubeletConfig sub pools
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-applying_compliance-remediation" class="j-doc-nav__link ">
    5.5.5.7. Applying a remediation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-manual_compliance-remediation" class="j-doc-nav__link ">
    5.5.5.8. Remediating a platform check manually
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-updating_compliance-remediation" class="j-doc-nav__link ">
    5.5.5.9. Updating remediations
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-unapplying_compliance-remediation" class="j-doc-nav__link ">
    5.5.5.10. Unapplying a remediation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-removing-kubeletconfig_compliance-remediation" class="j-doc-nav__link ">
    5.5.5.11. Removing a KubeletConfig remediation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-inconsistent_compliance-remediation" class="j-doc-nav__link ">
    5.5.5.12. Inconsistent ComplianceScan
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#additional-resources-9" class="j-doc-nav__link ">
    5.5.5.13. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-advanced" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.6. Performing advanced Compliance Operator tasks
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.6. Performing advanced Compliance Operator tasks"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.6. Performing advanced Compliance Operator tasks"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-objects_compliance-advanced" class="j-doc-nav__link ">
    5.5.6.1. Using the ComplianceSuite and ComplianceScan objects directly
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-priorityclass_compliance-advanced" class="j-doc-nav__link ">
    5.5.6.2. Setting PriorityClass for ScanSetting scans
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-raw-tailored_compliance-advanced" class="j-doc-nav__link ">
    5.5.6.3. Using raw tailored profiles
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-rescan_compliance-advanced" class="j-doc-nav__link ">
    5.5.6.4. Performing a rescan
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-custom-storage_compliance-advanced" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.6.5. Setting custom storage size for results
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.6.5. Setting custom storage size for results"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.6.5. Setting custom storage size for results"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#using-custom-result-storage-values_compliance-advanced" class="j-doc-nav__link ">
    5.5.6.5.1. Using custom result storage values
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#installing-compliance-operator-cli_compliance-advanced" class="j-doc-nav__link ">
    5.5.6.6. Applying remediations generated by suite scans
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#automatically-update-remediations_compliance-advanced" class="j-doc-nav__link ">
    5.5.6.7. Automatically update remediations
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-custom-scc_compliance-advanced" class="j-doc-nav__link ">
    5.5.6.8. Creating a custom SCC for the Compliance Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#additional-resources_compliance-operator-advanced" class="j-doc-nav__link ">
    5.5.6.9. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-troubleshooting" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.7. Troubleshooting the Compliance Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.7. Troubleshooting the Compliance Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.7. Troubleshooting the Compliance Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-anatomy_compliance-troubleshooting" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.7.1. Anatomy of a scan
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.7.1. Anatomy of a scan"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.7.1. Anatomy of a scan"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-anatomy-compliance-sources_compliance-troubleshooting" class="j-doc-nav__link ">
    5.5.7.1.1. Compliance sources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-anatomy-scan-setting-scan-binding-lifecycle_compliance-troubleshooting" class="j-doc-nav__link ">
    5.5.7.1.2. The ScanSetting and ScanSettingBinding objects lifecycle and debugging
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-suite-lifecycle-debugging_compliance-troubleshooting" class="j-doc-nav__link ">
    5.5.7.1.3. ComplianceSuite custom resource lifecycle and debugging
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-scan-lifecycle-debugging_compliance-troubleshooting" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.7.1.4. ComplianceScan custom resource lifecycle and debugging
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.7.1.4. ComplianceScan custom resource lifecycle and debugging"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.7.1.4. ComplianceScan custom resource lifecycle and debugging"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-scan-pending-phase_compliance-troubleshooting" class="j-doc-nav__link ">
    5.5.7.1.4.1. Pending phase
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-scan-launching-phase_compliance-troubleshooting" class="j-doc-nav__link ">
    5.5.7.1.4.2. Launching phase
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-scan-running-phase_compliance-troubleshooting" class="j-doc-nav__link ">
    5.5.7.1.4.3. Running phase
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-scan-aggregating-phase_compliance-troubleshooting" class="j-doc-nav__link ">
    5.5.7.1.4.4. Aggregating phase
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-scan-done-phase_compliance-troubleshooting" class="j-doc-nav__link ">
    5.5.7.1.4.5. Done phase
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-remediation-lifecycle-debugging_compliance-troubleshooting" class="j-doc-nav__link ">
    5.5.7.1.5. ComplianceRemediation controller lifecycle and debugging
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-operator-useful-labels_compliance-troubleshooting" class="j-doc-nav__link ">
    5.5.7.1.6. Useful labels
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-increasing-operator-limits_compliance-troubleshooting" class="j-doc-nav__link ">
    5.5.7.2. Increasing Compliance Operator resource limits
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#operator-resource-constraints_compliance-troubleshooting" class="j-doc-nav__link ">
    5.5.7.3. Configuring Operator resource constraints
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#compliance-timeout_compliance-troubleshooting" class="j-doc-nav__link ">
    5.5.7.4. Configuring ScanSetting timeout
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#support_compliance-troubleshooting" class="j-doc-nav__link ">
    5.5.7.5. Getting support
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#using-oc-compliance-plug-in" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.8. Using the oc-compliance plugin
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.8. Using the oc-compliance plugin"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.8. Using the oc-compliance plugin"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#installing-oc-compliance_oc-compliance-plug-in-understanding" class="j-doc-nav__link ">
    5.5.8.1. Installing the oc-compliance plugin
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#fetching-raw-results_oc-compliance-plug-in-understanding" class="j-doc-nav__link ">
    5.5.8.2. Fetching raw results
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#re-running-scans_oc-compliance-plug-in-understanding" class="j-doc-nav__link ">
    5.5.8.3. Re-running scans
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#using-scan-setting-bindings_oc-compliance-plug-in-understanding" class="j-doc-nav__link ">
    5.5.8.4. Using ScanSettingBinding custom resources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#printing-controls_oc-compliance-plug-in-understanding" class="j-doc-nav__link ">
    5.5.8.5. Printing controls
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#fetching-compliance-remediation-details_oc-compliance-plug-in-understanding" class="j-doc-nav__link ">
    5.5.8.6. Fetching compliance remediation details
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#viewing-compliance-remediation-details_oc-compliance-plug-in-understanding" class="j-doc-nav__link ">
    5.5.8.7. Viewing ComplianceCheckResult object details
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator" class="j-doc-nav__link j-doc-nav__link--has-children">
    6. File Integrity Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6. File Integrity Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6. File Integrity Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-release-notes" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.1. File Integrity Operator release notes
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.1. File Integrity Operator release notes"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.1. File Integrity Operator release notes"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-release-notes-1-3-2" class="j-doc-nav__link ">
    6.1.1. OpenShift File Integrity Operator 1.3.2
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-release-notes-1-3-1" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.1.2. OpenShift File Integrity Operator 1.3.1
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.1.2. OpenShift File Integrity Operator 1.3.1"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.1.2. OpenShift File Integrity Operator 1.3.1"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-1-3-1-new-features-and-enhancements" class="j-doc-nav__link ">
    6.1.2.1. New features and enhancements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-1-3-1-bug-fixes" class="j-doc-nav__link ">
    6.1.2.2. Bug fixes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-1-3-1-known-issues" class="j-doc-nav__link ">
    6.1.2.3. Known Issues
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-release-notes-1-2-1" class="j-doc-nav__link ">
    6.1.3. OpenShift File Integrity Operator 1.2.1
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-release-notes-1-2-0" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.1.4. OpenShift File Integrity Operator 1.2.0
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.1.4. OpenShift File Integrity Operator 1.2.0"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.1.4. OpenShift File Integrity Operator 1.2.0"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-1-2-0-new-features-and-enhancements" class="j-doc-nav__link ">
    6.1.4.1. New features and enhancements
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-release-notes-1-0-0" class="j-doc-nav__link ">
    6.1.5. OpenShift File Integrity Operator 1.0.0
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-release-notes-0-1-32" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.1.6. OpenShift File Integrity Operator 0.1.32
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.1.6. OpenShift File Integrity Operator 0.1.32"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.1.6. OpenShift File Integrity Operator 0.1.32"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-0-1-32-bug-fixes" class="j-doc-nav__link ">
    6.1.6.1. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-release-notes-0-1-30" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.1.7. OpenShift File Integrity Operator 0.1.30
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.1.7. OpenShift File Integrity Operator 0.1.30"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.1.7. OpenShift File Integrity Operator 0.1.30"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-0-1-30-new-features-and-enhancements" class="j-doc-nav__link ">
    6.1.7.1. New features and enhancements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-0-1-30-bug-fixes" class="j-doc-nav__link ">
    6.1.7.2. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-release-notes-0-1-24" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.1.8. OpenShift File Integrity Operator 0.1.24
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.1.8. OpenShift File Integrity Operator 0.1.24"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.1.8. OpenShift File Integrity Operator 0.1.24"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-0-1-24-new-features-and-enhancements" class="j-doc-nav__link ">
    6.1.8.1. New features and enhancements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#openshift-file-integrity-operator-0-1-24-bug-fixes" class="j-doc-nav__link ">
    6.1.8.2. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-release-notes-0-1-22" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.1.9. OpenShift File Integrity Operator 0.1.22
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.1.9. OpenShift File Integrity Operator 0.1.22"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.1.9. OpenShift File Integrity Operator 0.1.22"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#openshift-file-integrity-operator-0-1-22-bug-fixes" class="j-doc-nav__link ">
    6.1.9.1. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-release-notes-0-1-21" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.1.10. OpenShift File Integrity Operator 0.1.21
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.1.10. OpenShift File Integrity Operator 0.1.21"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.1.10. OpenShift File Integrity Operator 0.1.21"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-0-1-21-new-features-and-enhancements" class="j-doc-nav__link ">
    6.1.10.1. New features and enhancements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#openshift-file-integrity-operator-0-1-21-bug-fixes" class="j-doc-nav__link ">
    6.1.10.2. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-release-notes_additional-resources" class="j-doc-nav__link ">
    6.1.11. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#installing-file-integrity-operator" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.2. Installing the File Integrity Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.2. Installing the File Integrity Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.2. Installing the File Integrity Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#installing-file-integrity-operator-using-web-console_file-integrity-operator-installation" class="j-doc-nav__link ">
    6.2.1. Installing the File Integrity Operator using the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#installing-file-integrity-operator-using-cli_file-integrity-operator-installation" class="j-doc-nav__link ">
    6.2.2. Installing the File Integrity Operator using the CLI
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#additional-resources-installing-the-file-integrity-operator" class="j-doc-nav__link ">
    6.2.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-updating" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.3. Updating the File Integrity Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.3. Updating the File Integrity Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.3. Updating the File Integrity Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#olm-preparing-upgrade_file-integrity-operator-updating" class="j-doc-nav__link ">
    6.3.1. Preparing for an Operator update
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#olm-changing-update-channel_file-integrity-operator-updating" class="j-doc-nav__link ">
    6.3.2. Changing the update channel for an Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#olm-approving-pending-upgrade_file-integrity-operator-updating" class="j-doc-nav__link ">
    6.3.3. Manually approving a pending Operator update
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#understanding-file-integrity-operator" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.4. Understanding the File Integrity Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.4. Understanding the File Integrity Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.4. Understanding the File Integrity Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#understanding-file-integrity-custom-resource_file-integrity-operator" class="j-doc-nav__link ">
    6.4.1. Creating the FileIntegrity custom resource
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#checking-the-file-integrity-CR-status_file-integrity-operator" class="j-doc-nav__link ">
    6.4.2. Checking the FileIntegrity custom resource status
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-CR-phases_file-integrity-operator" class="j-doc-nav__link ">
    6.4.3. FileIntegrity custom resource phases
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#understanding-file-integrity-node-statuses-object_file-integrity-operator" class="j-doc-nav__link ">
    6.4.4. Understanding the FileIntegrityNodeStatuses object
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-node-status-types_file-integrity-operator" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.4.5. FileIntegrityNodeStatus CR status types
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.4.5. FileIntegrityNodeStatus CR status types"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.4.5. FileIntegrityNodeStatus CR status types"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-node-status-success_file-integrity-operator" class="j-doc-nav__link ">
    6.4.5.1. FileIntegrityNodeStatus CR success example
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-node-status-failure_file-integrity-operator" class="j-doc-nav__link ">
    6.4.5.2. FileIntegrityNodeStatus CR failure status example
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-events_file-integrity-operator" class="j-doc-nav__link ">
    6.4.6. Understanding events
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#configuring-file-integrity-operator" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.5. Configuring the Custom File Integrity Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.5. Configuring the Custom File Integrity Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.5. Configuring the Custom File Integrity Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#viewing-file-integrity-object-attributes_file-integrity-operator" class="j-doc-nav__link ">
    6.5.1. Viewing FileIntegrity object attributes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#important-file-integrity-object-attributes_file-integrity-operator" class="j-doc-nav__link ">
    6.5.2. Important attributes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-examine-default-config_file-integrity-operator" class="j-doc-nav__link ">
    6.5.3. Examine the default configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-understanding-default-config_file-integrity-operator" class="j-doc-nav__link ">
    6.5.4. Understanding the default File Integrity Operator configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-supplying-custom-aide-config_file-integrity-operator" class="j-doc-nav__link ">
    6.5.5. Supplying a custom AIDE configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-defining-custom-config_file-integrity-operator" class="j-doc-nav__link ">
    6.5.6. Defining a custom File Integrity Operator configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-changing-custom-config_file-integrity-operator" class="j-doc-nav__link ">
    6.5.7. Changing the custom File Integrity configuration
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-advanced-usage" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.6. Performing advanced Custom File Integrity Operator tasks
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.6. Performing advanced Custom File Integrity Operator tasks"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.6. Performing advanced Custom File Integrity Operator tasks"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-reinitializing-database_file-integrity-operator" class="j-doc-nav__link ">
    6.6.1. Reinitializing the database
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-machine-config-integration_file-integrity-operator" class="j-doc-nav__link ">
    6.6.2. Machine config integration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#file-integrity-operator-exploring-daemon-sets_file-integrity-operator" class="j-doc-nav__link ">
    6.6.3. Exploring the daemon sets
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#troubleshooting-file-integrity-operator" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.7. Troubleshooting the File Integrity Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.7. Troubleshooting the File Integrity Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.7. Troubleshooting the File Integrity Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#general-troubleshooting" class="j-doc-nav__link ">
    6.7.1. General troubleshooting
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#checking-the-aide-configuration" class="j-doc-nav__link ">
    6.7.2. Checking the AIDE configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#determining-the-fileintegrity-object-s-phase" class="j-doc-nav__link ">
    6.7.3. Determining the FileIntegrity object’s phase
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#determining-that-the-daemon-set-s-pods-are-running-on-the-expected-nodes" class="j-doc-nav__link ">
    6.7.4. Determining that the daemon set’s pods are running on the expected nodes
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-profiles-operator" class="j-doc-nav__link j-doc-nav__link--has-children">
    7. Security Profiles Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7. Security Profiles Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7. Security Profiles Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-overview" class="j-doc-nav__link ">
    7.1. Security Profiles Operator overview
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-release-notes" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.2. Security Profiles Operator release notes
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.2. Security Profiles Operator release notes"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.2. Security Profiles Operator release notes"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-release-notes-0-8-0" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.2.1. Security Profiles Operator 0.8.0
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.2.1. Security Profiles Operator 0.8.0"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.2.1. Security Profiles Operator 0.8.0"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-0-8-0-bug-fixes" class="j-doc-nav__link ">
    7.2.1.1. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-release-notes-0-7-1" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.2.2. Security Profiles Operator 0.7.1
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.2.2. Security Profiles Operator 0.7.1"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.2.2. Security Profiles Operator 0.7.1"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-0-7-1-new-features-and-enhancements" class="j-doc-nav__link ">
    7.2.2.1. New features and enhancements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-0-7-1-deprecations" class="j-doc-nav__link ">
    7.2.2.2. Deprecated and removed features
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-0-7-1-bug-fixes" class="j-doc-nav__link ">
    7.2.2.3. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-release-notes-0-5-2" class="j-doc-nav__link ">
    7.2.3. Security Profiles Operator 0.5.2
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-release-notes-0-5-0" class="j-doc-nav__link ">
    7.2.4. Security Profiles Operator 0.5.0
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-understanding" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.3. Understanding the Security Profiles Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.3. Understanding the Security Profiles Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.3. Understanding the Security Profiles Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-about_spo-understanding" class="j-doc-nav__link ">
    7.3.1. About Security Profiles
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-enabling" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.4. Enabling the Security Profiles Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.4. Enabling the Security Profiles Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.4. Enabling the Security Profiles Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-installing_spo-enabling" class="j-doc-nav__link ">
    7.4.1. Installing the Security Profiles Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-installing-cli_spo-enabling" class="j-doc-nav__link ">
    7.4.2. Installing the Security Profiles Operator using the CLI
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#logging-verbosity_spo-enabling" class="j-doc-nav__link ">
    7.4.3. Configuring logging verbosity
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-seccomp" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.5. Managing seccomp profiles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.5. Managing seccomp profiles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.5. Managing seccomp profiles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-creating-profiles_spo-seccomp" class="j-doc-nav__link ">
    7.5.1. Creating seccomp profiles
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-applying-profiles_spo-seccomp" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.5.2. Applying seccomp profiles to a pod
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.5.2. Applying seccomp profiles to a pod"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.5.2. Applying seccomp profiles to a pod"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-binding-workloads_spo-seccomp" class="j-doc-nav__link ">
    7.5.2.1. Binding workloads to profiles with ProfileBindings
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-recording-profiles_spo-seccomp" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.5.3. Recording profiles from workloads
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.5.3. Recording profiles from workloads"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.5.3. Recording profiles from workloads"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-container-profile-instances_spo-seccomp" class="j-doc-nav__link ">
    7.5.3.1. Merging per-container profile instances
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-selinux" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.6. Managing SELinux profiles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.6. Managing SELinux profiles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.6. Managing SELinux profiles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-creating-profiles_spo-selinux" class="j-doc-nav__link ">
    7.6.1. Creating SELinux profiles
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-applying-profiles_spo-selinux" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.6.2. Applying SELinux profiles to a pod
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.6.2. Applying SELinux profiles to a pod"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.6.2. Applying SELinux profiles to a pod"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-selinux-permissive_spo-selinux" class="j-doc-nav__link ">
    7.6.2.1. Applying SELinux log policies
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-binding-workloads_spo-selinux" class="j-doc-nav__link ">
    7.6.2.2. Binding workloads to profiles with ProfileBindings
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-replicating-controllers_spo-selinux" class="j-doc-nav__link ">
    7.6.2.3. Replicating controllers and SecurityContextConstraints
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-recording-profiles_spo-selinux" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.6.3. Recording profiles from workloads
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.6.3. Recording profiles from workloads"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.6.3. Recording profiles from workloads"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-container-profile-instances_spo-selinux" class="j-doc-nav__link ">
    7.6.3.1. Merging per-container profile instances
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-selinux-runasany_spo-selinux" class="j-doc-nav__link ">
    7.6.3.2. About seLinuxContext: RunAsAny
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-advanced" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.7. Advanced Security Profiles Operator tasks
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.7. Advanced Security Profiles Operator tasks"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.7. Advanced Security Profiles Operator tasks"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-restrict-syscalls_spo-advanced" class="j-doc-nav__link ">
    7.7.1. Restrict the allowed syscalls in seccomp profiles
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-base-syscalls_spo-advanced" class="j-doc-nav__link ">
    7.7.2. Base syscalls for a container runtime
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-memory-optimization_spo-advanced" class="j-doc-nav__link ">
    7.7.3. Enabling memory optimization in the spod daemon
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-daemon-requirements_spo-advanced" class="j-doc-nav__link ">
    7.7.4. Customizing daemon resource requirements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-custom-priority-class_spo-advanced" class="j-doc-nav__link ">
    7.7.5. Setting a custom priority class name for the spod daemon pod
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-using-metrics_spo-advanced" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.7.6. Using metrics
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.7.6. Using metrics"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.7.6. Using metrics"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-runtime-metrics_spo-advanced" class="j-doc-nav__link ">
    7.7.6.1. controller-runtime metrics
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-log-enricher_spo-advanced" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.7.7. Using the log enricher
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.7.7. Using the log enricher"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.7.7. Using the log enricher"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-log-enricher-app-trace_spo-advanced" class="j-doc-nav__link ">
    7.7.7.1. Using the log enricher to trace an application
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-configuring-webhooks_spo-advanced" class="j-doc-nav__link ">
    7.7.8. Configuring webhooks
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-troubleshooting" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.8. Troubleshooting the Security Profiles Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.8. Troubleshooting the Security Profiles Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.8. Troubleshooting the Security Profiles Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-inspecting-seccomp-profiles_spo-troubleshooting" class="j-doc-nav__link ">
    7.8.1. Inspecting seccomp profiles
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-uninstalling" class="j-doc-nav__link j-doc-nav__link--has-children">
    7.9. Uninstalling the Security Profiles Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7.9. Uninstalling the Security Profiles Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7.9. Uninstalling the Security Profiles Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#spo-uninstall-console_spo-uninstalling" class="j-doc-nav__link ">
    7.9.1. Uninstall the Security Profiles Operator using the web console
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-for-red-hat-openshift" class="j-doc-nav__link j-doc-nav__link--has-children">
    8. cert-manager Operator for Red Hat OpenShift
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8. cert-manager Operator for Red Hat OpenShift"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8. cert-manager Operator for Red Hat OpenShift"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-about" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.1. cert-manager Operator for Red Hat OpenShift overview
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.1. cert-manager Operator for Red Hat OpenShift overview"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.1. cert-manager Operator for Red Hat OpenShift overview"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-about_cert-manager-operator-about" class="j-doc-nav__link ">
    8.1.1. About the cert-manager Operator for Red Hat OpenShift
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-issuer-types_cert-manager-operator-about" class="j-doc-nav__link ">
    8.1.2. Supported issuer types
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-request-methods_cert-manager-operator-about" class="j-doc-nav__link ">
    8.1.3. Certificate request methods
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-about_additional-resources" class="j-doc-nav__link ">
    8.1.4. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-release-notes" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.2. cert-manager Operator for Red Hat OpenShift release notes
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.2. cert-manager Operator for Red Hat OpenShift release notes"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.2. cert-manager Operator for Red Hat OpenShift release notes"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-release-notes-1.12.0" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.2.1. Release notes for cert-manager Operator for Red Hat OpenShift 1.12.0
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.2.1. Release notes for cert-manager Operator for Red Hat OpenShift 1.12.0"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.2.1. Release notes for cert-manager Operator for Red Hat OpenShift 1.12.0"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-1.12.0-bug-fixes" class="j-doc-nav__link ">
    8.2.1.1. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-release-notes-1.11.4" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.2.2. Release notes for cert-manager Operator for Red Hat OpenShift 1.11.4
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.2.2. Release notes for cert-manager Operator for Red Hat OpenShift 1.11.4"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.2.2. Release notes for cert-manager Operator for Red Hat OpenShift 1.11.4"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-1.11.4-bug-fixes" class="j-doc-nav__link ">
    8.2.2.1. Bug fixes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-release-notes-1.11.1" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.2.3. Release notes for cert-manager Operator for Red Hat OpenShift 1.11.1
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.2.3. Release notes for cert-manager Operator for Red Hat OpenShift 1.11.1"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.2.3. Release notes for cert-manager Operator for Red Hat OpenShift 1.11.1"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-1.11.1-new-features-and-enhancements" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.2.3.1. New features and enhancements
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.2.3.1. New features and enhancements"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.2.3.1. New features and enhancements"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-log-level-1.11.1" class="j-doc-nav__link ">
    8.2.3.1.1. Setting log levels for cert-manager and the cert-manager Operator for Red Hat OpenShift
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-authentication-aws-1.11.1" class="j-doc-nav__link ">
    8.2.3.1.2. Authenticating the cert-manager Operator for Red Hat OpenShift with AWS
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-authentication-gcp-1.11.1" class="j-doc-nav__link ">
    8.2.3.1.3. Authenticating the cert-manager Operator for Red Hat OpenShift with GCP
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-1.11.1-bug-fixes" class="j-doc-nav__link ">
    8.2.3.2. Bug fixes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-1.11.1-known-issues" class="j-doc-nav__link ">
    8.2.3.3. Known issues
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-release-notes-1.10.3" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.2.4. Release notes for cert-manager Operator for Red Hat OpenShift 1.10.3
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.2.4. Release notes for cert-manager Operator for Red Hat OpenShift 1.10.3"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.2.4. Release notes for cert-manager Operator for Red Hat OpenShift 1.10.3"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-1.10.3-CVEs" class="j-doc-nav__link ">
    8.2.4.1. CVEs
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-release-notes-1.10.2" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.2.5. Release notes for cert-manager Operator for Red Hat OpenShift 1.10.2
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.2.5. Release notes for cert-manager Operator for Red Hat OpenShift 1.10.2"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.2.5. Release notes for cert-manager Operator for Red Hat OpenShift 1.10.2"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-1.10.2-new-features-and-enhancements" class="j-doc-nav__link ">
    8.2.5.1. New features and enhancements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-1.10.2-bug-fixes" class="j-doc-nav__link ">
    8.2.5.2. Bug fixes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-1.10.2-known-issues" class="j-doc-nav__link ">
    8.2.5.3. Known issues
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-install" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.3. Installing the cert-manager Operator for Red Hat OpenShift
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.3. Installing the cert-manager Operator for Red Hat OpenShift"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.3. Installing the cert-manager Operator for Red Hat OpenShift"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-install-console_cert-manager-operator-install" class="j-doc-nav__link ">
    8.3.1. Installing the cert-manager Operator for Red Hat OpenShift using the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-update-channels_cert-manager-operator-install" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.3.2. Understanding update channels of the cert-manager Operator for Red Hat OpenShift
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.3.2. Understanding update channels of the cert-manager Operator for Red Hat OpenShift"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.3.2. Understanding update channels of the cert-manager Operator for Red Hat OpenShift"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#stable-v1-channel_cert-manager-operator-install" class="j-doc-nav__link ">
    8.3.2.1. stable-v1 channel
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#stable-v1-y-channel_cert-manager-operator-install" class="j-doc-nav__link ">
    8.3.2.2. stable-v1.y channel
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-install_additional-resources" class="j-doc-nav__link ">
    8.3.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-issuer-acme" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.4. Managing certificates with an ACME issuer
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.4. Managing certificates with an ACME issuer"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.4. Managing certificates with an ACME issuer"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-acme-about_cert-manager-operator-issuer-acme" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.4.1. About ACME issuers
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.4.1. About ACME issuers"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.4.1. About ACME issuers"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-acme-challenges-types_cert-manager-operator-issuer-acme" class="j-doc-nav__link ">
    8.4.1.1. Supported ACME challenges types
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-acme-dns-providers_cert-manager-operator-issuer-acme" class="j-doc-nav__link ">
    8.4.1.2. Supported DNS-01 providers
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-acme-http01_cert-manager-operator-issuer-acme" class="j-doc-nav__link ">
    8.4.2. Configuring an ACME issuer to solve HTTP-01 challenges
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-acme-dns01-explicit-aws_cert-manager-operator-issuer-acme" class="j-doc-nav__link ">
    8.4.3. Configuring an ACME issuer by using explicit credentials for AWS Route53
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-acme-dns01-ambient-aws_cert-manager-operator-issuer-acme" class="j-doc-nav__link ">
    8.4.4. Configuring an ACME issuer by using ambient credentials on AWS
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-acme-dns01-explicit-gcp_cert-manager-operator-issuer-acme" class="j-doc-nav__link ">
    8.4.5. Configuring an ACME issuer by using explicit credentials for GCP Cloud DNS
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-acme-dns01-ambient-gcp_cert-manager-operator-issuer-acme" class="j-doc-nav__link ">
    8.4.6. Configuring an ACME issuer by using ambient credentials on GCP
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-acme-dns01-explicit-azure_cert-manager-operator-issuer-acme" class="j-doc-nav__link ">
    8.4.7. Configuring an ACME issuer by using explicit credentials for Microsoft Azure DNS
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#additional-resources_cert-manager-operator-issuer-acme" class="j-doc-nav__link ">
    8.4.8. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-monitoring" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.5. Enabling monitoring for the cert-manager Operator for Red Hat OpenShift
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.5. Enabling monitoring for the cert-manager Operator for Red Hat OpenShift"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.5. Enabling monitoring for the cert-manager Operator for Red Hat OpenShift"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-enable-metrics_cert-manager-monitoring" class="j-doc-nav__link ">
    8.5.1. Enabling monitoring by using a service monitor for the cert-manager Operator for Red Hat OpenShift
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-query-metrics_cert-manager-monitoring" class="j-doc-nav__link ">
    8.5.2. Querying metrics for the cert-manager Operator for Red Hat OpenShift
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-proxy" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.6. Configuring the egress proxy for the cert-manager Operator for Red Hat OpenShift
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.6. Configuring the egress proxy for the cert-manager Operator for Red Hat OpenShift"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.6. Configuring the egress proxy for the cert-manager Operator for Red Hat OpenShift"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-proxy-support_cert-manager-operator-proxy" class="j-doc-nav__link ">
    8.6.1. Injecting a custom CA certificate for the cert-manager Operator for Red Hat OpenShift
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-proxy_additional-resources" class="j-doc-nav__link ">
    8.6.2. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-customizing-api-fields" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.7. Customizing cert-manager Operator API fields
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.7. Customizing cert-manager Operator API fields"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.7. Customizing cert-manager Operator API fields"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-override-environment-variables_cert-manager-customizing-api-fields" class="j-doc-nav__link ">
    8.7.1. Customizing cert-manager by overriding environment variables from the cert-manager Operator API
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-override-arguments_cert-manager-customizing-api-fields" class="j-doc-nav__link ">
    8.7.2. Customizing cert-manager by overriding arguments from the cert-manager Operator API
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-override-flag-controller_cert-manager-customizing-api-fields" class="j-doc-nav__link ">
    8.7.3. Deleting a TLS secret automatically upon Certificate removal
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-configure-cpu-memory_cert-manager-customizing-api-fields" class="j-doc-nav__link ">
    8.7.4. Overriding CPU and memory limits for the cert-manager components
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-authenticate-aws" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.8. Authenticating the cert-manager Operator for Red Hat OpenShift with AWS Security Token Service
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.8. Authenticating the cert-manager Operator for Red Hat OpenShift with AWS Security Token Service"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.8. Authenticating the cert-manager Operator for Red Hat OpenShift with AWS Security Token Service"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-configure-cloud-credentials-aws-sts_cert-manager-authenticate-aws" class="j-doc-nav__link ">
    8.8.1. Configuring cloud credentials for the cert-manager Operator for Red Hat OpenShift for the AWS Security Token Service cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#additional-resources_cert-manager-authenticate-gcp" class="j-doc-nav__link ">
    8.8.2. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-log-levels" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.9. Configuring log levels for cert-manager and the cert-manager Operator for Red Hat OpenShift
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.9. Configuring log levels for cert-manager and the cert-manager Operator for Red Hat OpenShift"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.9. Configuring log levels for cert-manager and the cert-manager Operator for Red Hat OpenShift"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-enable-operand-log-level_cert-manager-log-levels" class="j-doc-nav__link ">
    8.9.1. Setting a log level for cert-manager
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-enable-operator-log-level_cert-manager-log-levels" class="j-doc-nav__link ">
    8.9.2. Setting a log level for the cert-manager Operator for Red Hat OpenShift
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-log-levels_additional-resources" class="j-doc-nav__link ">
    8.9.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-authenticate-gcp" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.10. Authenticating the cert-manager Operator for Red Hat OpenShift with GCP Workload Identity
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.10. Authenticating the cert-manager Operator for Red Hat OpenShift with GCP Workload Identity"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.10. Authenticating the cert-manager Operator for Red Hat OpenShift with GCP Workload Identity"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-configure-cloud-credentials-gcp-sts_cert-manager-authenticate-gcp" class="j-doc-nav__link ">
    8.10.1. Configuring cloud credentials for the cert-manager Operator for Red Hat OpenShift with GCP Workload Identity
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#additional-resources_cert-manager-authenticate-gcp-workload-identity" class="j-doc-nav__link ">
    8.10.2. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-authentication-non-sts" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.11. Authenticating the cert-manager Operator for Red Hat OpenShift on AWS
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.11. Authenticating the cert-manager Operator for Red Hat OpenShift on AWS"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.11. Authenticating the cert-manager Operator for Red Hat OpenShift on AWS"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-configure-cloud-credentials-aws-non-sts_cert-manager-authentication-non-sts" class="j-doc-nav__link ">
    8.11.1. Configuring cloud credentials for the cert-manager Operator for Red Hat OpenShift on AWS
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-authenticate-non-sts-gcp" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.12. Authenticating the cert-manager Operator for Red Hat OpenShift on GCP
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.12. Authenticating the cert-manager Operator for Red Hat OpenShift on GCP"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.12. Authenticating the cert-manager Operator for Red Hat OpenShift on GCP"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-configure-cloud-credentials-gcp-non-sts_cert-manager-authenticate-non-sts-gcp" class="j-doc-nav__link ">
    8.12.1. Configuring cloud credentials for the cert-manager Operator for Red Hat OpenShift on GCP
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-operator-uninstall" class="j-doc-nav__link j-doc-nav__link--has-children">
    8.13. Uninstalling the cert-manager Operator for Red Hat OpenShift
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8.13. Uninstalling the cert-manager Operator for Red Hat OpenShift"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8.13. Uninstalling the cert-manager Operator for Red Hat OpenShift"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-uninstall-console_cert-manager-operator-uninstall" class="j-doc-nav__link ">
    8.13.1. Uninstalling the cert-manager Operator for Red Hat OpenShift
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#cert-manager-remove-resources-console_cert-manager-operator-uninstall" class="j-doc-nav__link ">
    8.13.2. Removing cert-manager Operator for Red Hat OpenShift resources
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#audit-log-view" class="j-doc-nav__link j-doc-nav__link--has-children">
    9. Viewing audit logs
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "9. Viewing audit logs"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "9. Viewing audit logs"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nodes-pods-audit-log-basic_audit-log-view" class="j-doc-nav__link ">
    9.1. About the API audit log
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nodes-nodes-audit-log-basic-viewing_audit-log-view" class="j-doc-nav__link ">
    9.2. Viewing the audit logs
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-audit-log-basic-filtering_audit-log-view" class="j-doc-nav__link ">
    9.3. Filtering audit logs
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#gathering-data-audit-logs_audit-log-view" class="j-doc-nav__link ">
    9.4. Gathering audit logs
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#viewing-audit-logs-additional-resources" class="j-doc-nav__link ">
    9.5. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#audit-log-policy-config" class="j-doc-nav__link j-doc-nav__link--has-children">
    10. Configuring the audit log policy
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "10. Configuring the audit log policy"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "10. Configuring the audit log policy"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#about-audit-log-profiles_audit-log-policy-config" class="j-doc-nav__link ">
    10.1. About audit log policy profiles
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#configuring-audit-policy_audit-log-policy-config" class="j-doc-nav__link ">
    10.2. Configuring the audit log policy
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#configuring-audit-policy-custom_audit-log-policy-config" class="j-doc-nav__link ">
    10.3. Configuring the audit log policy with custom rules
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#configuring-audit-policy-disable_audit-log-policy-config" class="j-doc-nav__link ">
    10.4. Disabling audit logging
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#tls-security-profiles" class="j-doc-nav__link j-doc-nav__link--has-children">
    11. Configuring TLS security profiles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "11. Configuring TLS security profiles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "11. Configuring TLS security profiles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#tls-profiles-understanding_tls-security-profiles" class="j-doc-nav__link ">
    11.1. Understanding TLS security profiles
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#tls-profiles-view-details_tls-security-profiles" class="j-doc-nav__link ">
    11.2. Viewing TLS security profile details
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#tls-profiles-ingress-configuring_tls-security-profiles" class="j-doc-nav__link ">
    11.3. Configuring the TLS security profile for the Ingress Controller
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#tls-profiles-kubernetes-configuring_tls-security-profiles" class="j-doc-nav__link ">
    11.4. Configuring the TLS security profile for the control plane
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#tls-profiles-kubelet-configuring_tls-security-profiles" class="j-doc-nav__link ">
    11.5. Configuring the TLS security profile for the kubelet
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#seccomp-profiles" class="j-doc-nav__link j-doc-nav__link--has-children">
    12. Configuring seccomp profiles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "12. Configuring seccomp profiles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "12. Configuring seccomp profiles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#verifying-default-seccomp-profile_configuring-seccomp-profiles" class="j-doc-nav__link j-doc-nav__link--has-children">
    12.1. Verifying the default seccomp profile applied to a pod
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "12.1. Verifying the default seccomp profile applied to a pod"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "12.1. Verifying the default seccomp profile applied to a pod"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#upgraded_cluster_configuring-seccomp-profiles" class="j-doc-nav__link ">
    12.1.1. Upgraded cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#newly_installed_configuring-seccomp-profiles" class="j-doc-nav__link ">
    12.1.2. Newly installed cluster
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#custom-seccomp-profile" class="j-doc-nav__link j-doc-nav__link--has-children">
    12.2. Configuring a custom seccomp profile
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "12.2. Configuring a custom seccomp profile"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "12.2. Configuring a custom seccomp profile"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#creating-custom-seccomp-profile_configuring-seccomp-profiles" class="j-doc-nav__link ">
    12.2.1. Creating seccomp profiles
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#setting-custom-seccomp-profile_configuring-seccomp-profiles" class="j-doc-nav__link ">
    12.2.2. Setting up the custom seccomp profile
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#applying-custom-seccomp-profile_configuring-seccomp-profiles" class="j-doc-nav__link ">
    12.2.3. Applying the custom seccomp profile to the workload
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#additional-resources_configuring-seccomp-profiles" class="j-doc-nav__link ">
    12.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#allowing-javascript-based-access-api-server" class="j-doc-nav__link j-doc-nav__link--has-children">
    13. Allowing JavaScript-based access to the API server from additional hosts
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "13. Allowing JavaScript-based access to the API server from additional hosts"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "13. Allowing JavaScript-based access to the API server from additional hosts"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#auth-allowing-javascript-access-api-server_auth-allowed-origins" class="j-doc-nav__link ">
    13.1. Allowing JavaScript-based access to the API server from additional hosts
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#encrypting-etcd" class="j-doc-nav__link j-doc-nav__link--has-children">
    14. Encrypting etcd data
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "14. Encrypting etcd data"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "14. Encrypting etcd data"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#about-etcd_encrypting-etcd" class="j-doc-nav__link ">
    14.1. About etcd encryption
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#etcd-encryption-types_encrypting-etcd" class="j-doc-nav__link ">
    14.2. Supported encryption types
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#enabling-etcd-encryption_encrypting-etcd" class="j-doc-nav__link ">
    14.3. Enabling etcd encryption
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#disabling-etcd-encryption_encrypting-etcd" class="j-doc-nav__link ">
    14.4. Disabling etcd encryption
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#pod-vulnerability-scan" class="j-doc-nav__link j-doc-nav__link--has-children">
    15. Scanning pods for vulnerabilities
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15. Scanning pods for vulnerabilities"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15. Scanning pods for vulnerabilities"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-pod-scan-cso_pod-vulnerability-scan" class="j-doc-nav__link ">
    15.1. Installing the Red Hat Quay Container Security Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-pod-scan-cso-using_pod-vulnerability-scan" class="j-doc-nav__link ">
    15.2. Using the Red Hat Quay Container Security Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#security-pod-scan-query-cli_pod-vulnerability-scan" class="j-doc-nav__link ">
    15.3. Querying image vulnerabilities from the CLI
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#network-bound-disk-encryption-nbde" class="j-doc-nav__link j-doc-nav__link--has-children">
    16. Network-Bound Disk Encryption (NBDE)
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "16. Network-Bound Disk Encryption (NBDE)"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "16. Network-Bound Disk Encryption (NBDE)"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-about-disk-encryption-technology" class="j-doc-nav__link j-doc-nav__link--has-children">
    16.1. About disk encryption technology
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "16.1. About disk encryption technology"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "16.1. About disk encryption technology"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-disk-encryption-technology-comparison_nbde-implementation" class="j-doc-nav__link j-doc-nav__link--has-children">
    16.1.1. Disk encryption technology comparison
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "16.1.1. Disk encryption technology comparison"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "16.1.1. Disk encryption technology comparison"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-key-escrow_nbde-implementation" class="j-doc-nav__link ">
    16.1.1.1. Key escrow
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-tpm-encryption_nbde-implementation" class="j-doc-nav__link ">
    16.1.1.2. TPM encryption
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-network-bound-disk-encryption_nbde-implementation" class="j-doc-nav__link ">
    16.1.1.3. Network-Bound Disk Encryption (NBDE)
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-secret-sharing-encryption_nbde-implementation" class="j-doc-nav__link ">
    16.1.1.4. Secret sharing encryption
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-using-tang-servers-for-disk-encryption_nbde-implementation" class="j-doc-nav__link ">
    16.1.2. Tang server disk encryption
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-locating-the-tang-servers_nbde-implementation" class="j-doc-nav__link ">
    16.1.3. Tang server location planning
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-deciding-the-number-of-tang-servers-to-use_nbde-implementation" class="j-doc-nav__link ">
    16.1.4. Tang server sizing requirements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-logging-considerations_nbde-implementation" class="j-doc-nav__link ">
    16.1.5. Logging considerations
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-tang-server-installation-considerations" class="j-doc-nav__link j-doc-nav__link--has-children">
    16.2. Tang server installation considerations
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "16.2. Tang server installation considerations"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "16.2. Tang server installation considerations"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-installation-scenarios_nbde-implementation" class="j-doc-nav__link ">
    16.2.1. Installation scenarios
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-installing-a-tang-server_nbde-implementation" class="j-doc-nav__link j-doc-nav__link--has-children">
    16.2.2. Installing a Tang server
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "16.2.2. Installing a Tang server"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "16.2.2. Installing a Tang server"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-compute-requirements_nbde-implementation" class="j-doc-nav__link ">
    16.2.2.1. Compute requirements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-automatic-start-at-boot_nbde-implementation" class="j-doc-nav__link ">
    16.2.2.2. Automatic start at boot
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-http-versus-https_nbde-implementation" class="j-doc-nav__link ">
    16.2.2.3. HTTP versus HTTPS
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-openshift-installation-with-nbde_nbde-implementation" class="j-doc-nav__link ">
    16.2.3. Installation considerations with Network-Bound Disk Encryption
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-managing-encryption-keys" class="j-doc-nav__link j-doc-nav__link--has-children">
    16.3. Tang server encryption key management
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "16.3. Tang server encryption key management"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "16.3. Tang server encryption key management"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-backing-up-server-keys_nbde-implementation" class="j-doc-nav__link ">
    16.3.1. Backing up keys for a Tang server
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-recovering-server-keys_nbde-implementation" class="j-doc-nav__link ">
    16.3.2. Recovering keys for a Tang server
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-rekeying-tang-servers_nbde-implementation" class="j-doc-nav__link j-doc-nav__link--has-children">
    16.3.3. Rekeying Tang servers
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "16.3.3. Rekeying Tang servers"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "16.3.3. Rekeying Tang servers"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-generating-a-new-tang-server-key_nbde-implementation" class="j-doc-nav__link ">
    16.3.3.1. Generating a new Tang server key
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-rekeying-all-nbde-nodes_nbde-implementation" class="j-doc-nav__link ">
    16.3.3.2. Rekeying all NBDE nodes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-troubleshooting-temporary-error-conditions_nbde-implementation" class="j-doc-nav__link ">
    16.3.3.3. Troubleshooting temporary rekeying errors for Tang servers
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-troubleshooting-permanent-error-conditions_nbde-implementation" class="j-doc-nav__link ">
    16.3.3.4. Troubleshooting permanent rekeying errors for Tang servers
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-deleting-old-tang-server-keys_nbde-implementation" class="j-doc-nav__link ">
    16.3.4. Deleting old Tang server keys
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-disaster-recovery-considerations" class="j-doc-nav__link j-doc-nav__link--has-children">
    16.4. Disaster recovery considerations
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "16.4. Disaster recovery considerations"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "16.4. Disaster recovery considerations"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-loss-of-a-client-machine_nbde-implementation" class="j-doc-nav__link ">
    16.4.1. Loss of a client machine
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-loss-of-client-connectivity_nbde-implementation" class="j-doc-nav__link ">
    16.4.2. Planning for a loss of client network connectivity
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-unexpected-loss-of-network-connectivity_nbde-implementation" class="j-doc-nav__link ">
    16.4.3. Unexpected loss of network connectivity
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-recovering-network-connectivity-manually_nbde-implementation" class="j-doc-nav__link ">
    16.4.4. Recovering network connectivity manually
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-emergency-recovery-of-network-connectivity_nbde-implementation" class="j-doc-nav__link ">
    16.4.5. Emergency recovery of network connectivity
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-loss-of-a-network-segment_nbde-implementation" class="j-doc-nav__link ">
    16.4.6. Loss of a network segment
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-loss-of-a-tang-server_nbde-implementation" class="j-doc-nav__link ">
    16.4.7. Loss of a Tang server
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#nbde-compromise-of-key-material_nbde-implementation" class="j-doc-nav__link ">
    16.4.8. Rekeying compromised key material
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                    

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance#idm139961123667648" class="j-doc-nav__link ">
    Legal Notice
  </a>
  
          </li>
              </ol>
    
  </div>
</nav>


              </div>
            </div>
            <div class="j-options-container j-options-container--mobile">
              <button class="j-sidebar__menu-trigger j-sidebar__menu-trigger--options content-expander__trigger">
                <span class="j-sidebar__menu-trigger__open-headline">
                  Settings
                </span>
                <span class="j-sidebar__menu-trigger__close-text">Close</span>
              </button>
              

  <ul class="j-doc-options__list content-expander">
    <li class="j-doc-options__item">
          <label class="j-doc-option__label j-doc-option__label--language" for="j-doc-language">
        Language:
      </label>
      <select id="j-doc-language" class="j-doc-option__select">
                  <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance" selected=''>
            English
          </option>
                  <option value="/documentation/ko-kr/openshift_container_platform/4.13/html-single/security_and_compliance" >
            한국어
          </option>
                  <option value="/documentation/ja-jp/openshift_container_platform/4.13/html-single/security_and_compliance" >
            日本語
          </option>
                  <option value="/documentation/zh-cn/openshift_container_platform/4.13/html-single/security_and_compliance" >
            简体中文
          </option>
              </select>

            <noscript>
        <div class="j-doc-option__label j-doc-option__label--language" id="j-doc-option__label--language--nojs">
          Language:
        </div>
        <ul aria-labelledby="j-doc-option__label--language--nojs" class="j-doc-option__languages-list">
                      <li>
              <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance">English</a>
            </li>
                      <li>
              <a href="/documentation/ko-kr/openshift_container_platform/4.13/html-single/security_and_compliance">한국어</a>
            </li>
                      <li>
              <a href="/documentation/ja-jp/openshift_container_platform/4.13/html-single/security_and_compliance">日本語</a>
            </li>
                      <li>
              <a href="/documentation/zh-cn/openshift_container_platform/4.13/html-single/security_and_compliance">简体中文</a>
            </li>
                  </ul>
      </noscript>

      </li>

    <li class="j-doc-options__item">
    <label for="j-doc-mode" class="j-doc-option__label j-doc-option__label--format">
      Format:
    </label>
    <select id="j-doc-mode" class="j-doc-option__select">
              <option value="/documentation/en-us/openshift_container_platform/4.13/html/security_and_compliance"  class="j-doc-options__option j-doc-options__option--multi-page">
          Multi-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance" selected='' class="j-doc-options__option j-doc-options__option--single-page">
          Single-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/pdf/security_and_compliance/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US.pdf"  class="j-doc-options__option j-doc-options__option--pdf">
          PDF
        </option>
          </select>

        <noscript>
      <div class="j-doc-option__label j-doc-option__label--format" id="j-doc-option__label--format--nojs">
        Format:
      </div>
      <ul class="j-doc-option__format-list" aria-labelledby="j-doc-option__label--format--nojs">
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--multi-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html/security_and_compliance">Multi-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--single-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance">Single-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--pdf"><a href="/documentation/en-us/openshift_container_platform/4.13/pdf/security_and_compliance/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US.pdf">PDF</a></li>
              </ul>
    </noscript>
  </li>
</ul>


              </div>
          </div>
                <div class="pvof-doc__tertiary-sidebar j-doc__tertiary-sidebar">
          <div class="pvof-doc__tertiary-sidebar__inner j-doc__tertiary-sidebar__inner">
            <div class="j-doc__doc-options">
              <div class="j-options-container j-options-container--desktop">
                <button class="j-sidebar__menu-trigger j-sidebar__menu-trigger--tablet content-expander__trigger">
                  <span class="j-sidebar__menu-trigger-icon"></span>
                  <h2 class="visually-hidden">Language and Page Formatting Options</h2>
                </button>
                  

  <ul class="j-doc-options__list content-expander">
    <li class="j-doc-options__item">
          <label class="j-doc-option__label j-doc-option__label--language" for="j-doc-language--2">
        Language:
      </label>
      <select id="j-doc-language--2" class="j-doc-option__select">
                  <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance" selected=''>
            English
          </option>
                  <option value="/documentation/ko-kr/openshift_container_platform/4.13/html-single/security_and_compliance" >
            한국어
          </option>
                  <option value="/documentation/ja-jp/openshift_container_platform/4.13/html-single/security_and_compliance" >
            日本語
          </option>
                  <option value="/documentation/zh-cn/openshift_container_platform/4.13/html-single/security_and_compliance" >
            简体中文
          </option>
              </select>

            <noscript>
        <div class="j-doc-option__label j-doc-option__label--language" id="j-doc-option__label--language--nojs">
          Language:
        </div>
        <ul aria-labelledby="j-doc-option__label--language--nojs" class="j-doc-option__languages-list">
                      <li>
              <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance">English</a>
            </li>
                      <li>
              <a href="/documentation/ko-kr/openshift_container_platform/4.13/html-single/security_and_compliance">한국어</a>
            </li>
                      <li>
              <a href="/documentation/ja-jp/openshift_container_platform/4.13/html-single/security_and_compliance">日本語</a>
            </li>
                      <li>
              <a href="/documentation/zh-cn/openshift_container_platform/4.13/html-single/security_and_compliance">简体中文</a>
            </li>
                  </ul>
      </noscript>

      </li>

    <li class="j-doc-options__item">
    <label for="j-doc-mode--2" class="j-doc-option__label j-doc-option__label--format">
      Format:
    </label>
    <select id="j-doc-mode--2" class="j-doc-option__select">
              <option value="/documentation/en-us/openshift_container_platform/4.13/html/security_and_compliance"  class="j-doc-options__option j-doc-options__option--multi-page">
          Multi-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance" selected='' class="j-doc-options__option j-doc-options__option--single-page">
          Single-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/pdf/security_and_compliance/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US.pdf"  class="j-doc-options__option j-doc-options__option--pdf">
          PDF
        </option>
          </select>

        <noscript>
      <div class="j-doc-option__label j-doc-option__label--format" id="j-doc-option__label--format--nojs">
        Format:
      </div>
      <ul class="j-doc-option__format-list" aria-labelledby="j-doc-option__label--format--nojs">
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--multi-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html/security_and_compliance">Multi-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--single-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance">Single-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--pdf"><a href="/documentation/en-us/openshift_container_platform/4.13/pdf/security_and_compliance/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US.pdf">PDF</a></li>
              </ul>
    </noscript>
  </li>
</ul>


                </div>
              </div>
          </div>
        </div>

                  <div class="doc-wrapper pvof-doc__wrapper j-superdoc__content-wrapper" id="doc-wrapper">
            

  <div class="pane-page-title">
    <h1 class="title" itemprop="name">Security and compliance</h1>
  </div>


  <div xml:lang="en-US" class="book" id="idm139961146522256"><div class="titlepage"><div><div class="producttitle"><span class="productname">OpenShift Container Platform</span> <span class="productnumber">4.13</span></div><div><h2 class="subtitle">Learning about and managing security for OpenShift Container Platform</h2></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat OpenShift Documentation Team</span></div></div><div><a href="#idm139961123667648">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				This document discusses container security, configuring certificates, and enabling encryption to help secure the cluster.
			</div></div></div></div><hr/></div><section class="chapter" id="security-compliance-overview"><div class="titlepage"><div><div><h1 class="title">Chapter 1. OpenShift Container Platform security and compliance</h1></div></div></div><section class="section" id="security-overview"><div class="titlepage"><div><div><h2 class="title">1.1. Security overview</h2></div></div></div><p>
				It is important to understand how to properly secure various aspects of your OpenShift Container Platform cluster.
			</p><h4 id="container-security">Container security</h4><p>
				A good starting point to understanding OpenShift Container Platform security is to review the concepts in <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#security-understanding">Understanding container security</a>. This and subsequent sections provide a high-level walkthrough of the container security measures available in OpenShift Container Platform, including solutions for the host layer, the container and orchestration layer, and the build and application layer. These sections also include information on the following topics:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Why container security is important and how it compares with existing security standards.
					</li><li class="listitem">
						Which container security measures are provided by the host (RHCOS and RHEL) layer and which are provided by OpenShift Container Platform.
					</li><li class="listitem">
						How to evaluate your container content and sources for vulnerabilities.
					</li><li class="listitem">
						How to design your build and deployment process to proactively check container content.
					</li><li class="listitem">
						How to control access to containers through authentication and authorization.
					</li><li class="listitem">
						How networking and attached storage are secured in OpenShift Container Platform.
					</li><li class="listitem">
						Containerized solutions for API management and SSO.
					</li></ul></div><h4 id="auditing">Auditing</h4><p>
				OpenShift Container Platform auditing provides a security-relevant chronological set of records documenting the sequence of activities that have affected the system by individual users, administrators, or other components of the system. Administrators can <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#audit-log-policy-config">configure the audit log policy</a> and <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#audit-log-view">view audit logs</a>.
			</p><h4 id="certificates">Certificates</h4><p>
				Certificates are used by various components to validate access to the cluster. Administrators can <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#replacing-default-ingress">replace the default ingress certificate</a>, <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#api-server-certificates">add API server certificates</a>, or <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#add-service-serving">add a service certificate</a>.
			</p><p>
				You can also review more details about the types of certificates used by the cluster:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-types-user-provided-certificates-for-the-api-server">User-provided certificates for the API server</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-types-proxy-certificates">Proxy certificates</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-types-service-ca-certificates">Service CA certificates</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-types-node-certificates">Node certificates</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-types-bootstrap-certificates">Bootstrap certificates</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-types-etcd-certificates">etcd certificates</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-types-olm-certificates">OLM certificates</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-types-aggregated-api-client-certificates">Aggregated API client certificates</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-types-machine-config-operator-certificates">Machine Config Operator certificates</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-types-user-provided-certificates-for-default-ingress">User-provided certificates for default ingress</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-types-ingress-certificates">Ingress certificates</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-types-monitoring-and-cluster-logging-operator-component-certificates">Monitoring and cluster logging Operator component certificates</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-types-control-plane-certificates">Control plane certificates</a>
					</li></ul></div><h4 id="encrypting-data">Encrypting data</h4><p>
				You can <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#encrypting-etcd">enable etcd encryption</a> for your cluster to provide an additional layer of data security. For example, it can help protect the loss of sensitive data if an etcd backup is exposed to the incorrect parties.
			</p><h4 id="vulnerability-scanning">Vulnerability scanning</h4><p>
				Administrators can use the Red Hat Quay Container Security Operator to run <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#pod-vulnerability-scan">vulnerability scans</a> and review information about detected vulnerabilities.
			</p></section><section class="section" id="compliance-overview"><div class="titlepage"><div><div><h2 class="title">1.2. Compliance overview</h2></div></div></div><p>
				For many OpenShift Container Platform customers, regulatory readiness, or compliance, on some level is required before any systems can be put into production. That regulatory readiness can be imposed by national standards, industry standards, or the organization’s corporate governance framework.
			</p><h4 id="compliance-checking">Compliance checking</h4><p>
				Administrators can use the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#understanding-compliance-operator">Compliance Operator</a> to run compliance scans and recommend remediations for any issues found. The <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#using-oc-compliance-plug-in"><code class="literal">oc-compliance</code> plugin</a> is an OpenShift CLI (<code class="literal">oc</code>) plugin that provides a set of utilities to easily interact with the Compliance Operator.
			</p><h4 id="file-integrity-checking">File integrity checking</h4><p>
				Administrators can use the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#understanding-file-integrity-operator">File Integrity Operator</a> to continually run file integrity checks on cluster nodes and provide a log of files that have been modified.
			</p></section><section class="section _additional-resources" id="additional-resources_security-compliance-overview"><div class="titlepage"><div><div><h2 class="title">1.3. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#understanding-authentication">Understanding authentication</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#configuring-internal-oauth">Configuring the internal OAuth server</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#understanding-identity-provider">Understanding identity provider configuration</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#using-rbac">Using RBAC to define and apply permissions</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#managing-pod-security-policies">Managing security context constraints</a>
					</li></ul></div></section></section><section class="chapter" id="container-security-1"><div class="titlepage"><div><div><h1 class="title">Chapter 2. Container security</h1></div></div></div><section class="section" id="security-understanding"><div class="titlepage"><div><div><h2 class="title">2.1. Understanding container security</h2></div></div></div><p>
				Securing a containerized application relies on multiple levels of security:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Container security begins with a trusted base container image and continues through the container build process as it moves through your CI/CD pipeline.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Image streams by default do not automatically update. This default behavior might create a security issue because security updates to images referenced by an image stream do not automatically occur. For information about how to override this default behavior, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#images-imagestreams-import_image-streams-managing">Configuring periodic importing of imagestreamtags</a>.
						</p></div></div></li><li class="listitem">
						When a container is deployed, its security depends on it running on secure operating systems and networks, and establishing firm boundaries between the container itself and the users and hosts that interact with it.
					</li><li class="listitem">
						Continued security relies on being able to scan container images for vulnerabilities and having an efficient way to correct and replace vulnerable images.
					</li></ul></div><p>
				Beyond what a platform such as OpenShift Container Platform offers out of the box, your organization will likely have its own security demands. Some level of compliance verification might be needed before you can even bring OpenShift Container Platform into your data center.
			</p><p>
				Likewise, you may need to add your own agents, specialized hardware drivers, or encryption features to OpenShift Container Platform, before it can meet your organization’s security standards.
			</p><p>
				This guide provides a high-level walkthrough of the container security measures available in OpenShift Container Platform, including solutions for the host layer, the container and orchestration layer, and the build and application layer. It then points you to specific OpenShift Container Platform documentation to help you achieve those security measures.
			</p><p>
				This guide contains the following information:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Why container security is important and how it compares with existing security standards.
					</li><li class="listitem">
						Which container security measures are provided by the host (RHCOS and RHEL) layer and which are provided by OpenShift Container Platform.
					</li><li class="listitem">
						How to evaluate your container content and sources for vulnerabilities.
					</li><li class="listitem">
						How to design your build and deployment process to proactively check container content.
					</li><li class="listitem">
						How to control access to containers through authentication and authorization.
					</li><li class="listitem">
						How networking and attached storage are secured in OpenShift Container Platform.
					</li><li class="listitem">
						Containerized solutions for API management and SSO.
					</li></ul></div><p>
				The goal of this guide is to understand the incredible security benefits of using OpenShift Container Platform for your containerized workloads and how the entire Red Hat ecosystem plays a part in making and keeping containers secure. It will also help you understand how you can engage with the OpenShift Container Platform to achieve your organization’s security goals.
			</p><section class="section" id="security-understanding-containers_security-understanding"><div class="titlepage"><div><div><h3 class="title">2.1.1. What are containers?</h3></div></div></div><p>
					Containers package an application and all its dependencies into a single image that can be promoted from development, to test, to production, without change. A container might be part of a larger application that works closely with other containers.
				</p><p>
					Containers provide consistency across environments and multiple deployment targets: physical servers, virtual machines (VMs), and private or public cloud.
				</p><p>
					Some of the benefits of using containers include:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139961133126672" scope="col">Infrastructure</th><th align="left" valign="top" id="idm139961133125584" scope="col">Applications</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139961133126672"> <p>
									Sandboxed application processes on a shared Linux operating system kernel
								</p>
								 </td><td align="left" valign="top" headers="idm139961133125584"> <p>
									Package my application and all of its dependencies
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139961133126672"> <p>
									Simpler, lighter, and denser than virtual machines
								</p>
								 </td><td align="left" valign="top" headers="idm139961133125584"> <p>
									Deploy to any environment in seconds and enable CI/CD
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139961133126672"> <p>
									Portable across different environments
								</p>
								 </td><td align="left" valign="top" headers="idm139961133125584"> <p>
									Easily access and share containerized components
								</p>
								 </td></tr></tbody></table></div><p>
					See <a class="link" href="https://www.redhat.com/en/topics/containers">Understanding Linux containers</a> from the Red Hat Customer Portal to find out more about Linux containers. To learn about RHEL container tools, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/building_running_and_managing_containers/index">Building, running, and managing containers</a> in the RHEL product documentation.
				</p></section><section class="section" id="security-understanding-openshift_security-understanding"><div class="titlepage"><div><div><h3 class="title">2.1.2. What is OpenShift Container Platform?</h3></div></div></div><p>
					Automating how containerized applications are deployed, run, and managed is the job of a platform such as OpenShift Container Platform. At its core, OpenShift Container Platform relies on the Kubernetes project to provide the engine for orchestrating containers across many nodes in scalable data centers.
				</p><p>
					Kubernetes is a project, which can run using different operating systems and add-on components that offer no guarantees of supportability from the project. As a result, the security of different Kubernetes platforms can vary.
				</p><p>
					OpenShift Container Platform is designed to lock down Kubernetes security and integrate the platform with a variety of extended components. To do this, OpenShift Container Platform draws on the extensive Red Hat ecosystem of open source technologies that include the operating systems, authentication, storage, networking, development tools, base container images, and many other components.
				</p><p>
					OpenShift Container Platform can leverage Red Hat’s experience in uncovering and rapidly deploying fixes for vulnerabilities in the platform itself as well as the containerized applications running on the platform. Red Hat’s experience also extends to efficiently integrating new components with OpenShift Container Platform as they become available and adapting technologies to individual customer needs.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/architecture/#architecture">OpenShift Container Platform architecture</a>
						</li><li class="listitem">
							<a class="link" href="https://www.redhat.com/en/resources/openshift-security-guide-ebook">OpenShift Security Guide</a>
						</li></ul></div></section></section><section class="section" id="security-hosts-vms"><div class="titlepage"><div><div><h2 class="title">2.2. Understanding host and VM security</h2></div></div></div><p>
				Both containers and virtual machines provide ways of separating applications running on a host from the operating system itself. Understanding RHCOS, which is the operating system used by OpenShift Container Platform, will help you see how the host systems protect containers and hosts from each other.
			</p><section class="section" id="security-hosts-vms-rhcos_security-hosts-vms"><div class="titlepage"><div><div><h3 class="title">2.2.1. Securing containers on Red Hat Enterprise Linux CoreOS (RHCOS)</h3></div></div></div><p>
					Containers simplify the act of deploying many applications to run on the same host, using the same kernel and container runtime to spin up each container. The applications can be owned by many users and, because they are kept separate, can run different, and even incompatible, versions of those applications at the same time without issue.
				</p><p>
					In Linux, containers are just a special type of process, so securing containers is similar in many ways to securing any other running process. An environment for running containers starts with an operating system that can secure the host kernel from containers and other processes running on the host, as well as secure containers from each other.
				</p><p>
					Because OpenShift Container Platform 4.13 runs on RHCOS hosts, with the option of using Red Hat Enterprise Linux (RHEL) as worker nodes, the following concepts apply by default to any deployed OpenShift Container Platform cluster. These RHEL security features are at the core of what makes running containers in OpenShift Container Platform more secure:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="emphasis"><em>Linux namespaces</em></span> enable creating an abstraction of a particular global system resource to make it appear as a separate instance to processes within a namespace. Consequently, several containers can use the same computing resource simultaneously without creating a conflict. Container namespaces that are separate from the host by default include mount table, process table, network interface, user, control group, UTS, and IPC namespaces. Those containers that need direct access to host namespaces need to have elevated permissions to request that access. See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/building_running_and_managing_containers/index">Overview of Containers in Red Hat Systems</a> from the RHEL 8 container documentation for details on the types of namespaces.
						</li><li class="listitem">
							<span class="emphasis"><em>SELinux</em></span> provides an additional layer of security to keep containers isolated from each other and from the host. SELinux allows administrators to enforce mandatory access controls (MAC) for every user, application, process, and file.
						</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Disabling SELinux on RHCOS is not supported.
					</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="emphasis"><em>CGroups</em></span> (control groups) limit, account for, and isolate the resource usage (CPU, memory, disk I/O, network, etc.) of a collection of processes. CGroups are used to ensure that containers on the same host are not impacted by each other.
						</li><li class="listitem">
							<span class="emphasis"><em>Secure computing mode (seccomp)</em></span> profiles can be associated with a container to restrict available system calls. See page 94 of the <a class="link" href="https://access.redhat.com/articles/5059881">OpenShift Security Guide</a> for details about seccomp.
						</li><li class="listitem">
							Deploying containers using <span class="emphasis"><em>RHCOS</em></span> reduces the attack surface by minimizing the host environment and tuning it for containers. The <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/3.11/html-single/cri-o_runtime/index">CRI-O container engine</a> further reduces that attack surface by implementing only those features required by Kubernetes and OpenShift Container Platform to run and manage containers, as opposed to other container engines that implement desktop-oriented standalone features.
						</li></ul></div><p>
					RHCOS is a version of Red Hat Enterprise Linux (RHEL) that is specially configured to work as control plane (master) and worker nodes on OpenShift Container Platform clusters. So RHCOS is tuned to efficiently run container workloads, along with Kubernetes and OpenShift Container Platform services.
				</p><p>
					To further protect RHCOS systems in OpenShift Container Platform clusters, most containers, except those managing or monitoring the host system itself, should run as a non-root user. Dropping the privilege level or creating containers with the least amount of privileges possible is recommended best practice for protecting your own OpenShift Container Platform clusters.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#allocate-node-enforcement_nodes-nodes-resources-configuring">How nodes enforce resource constraints</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#managing-pod-security-policies">Managing security context constraints</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/architecture/#supported-platforms-for-openshift-clusters_architecture-installation">Supported platforms for OpenShift clusters</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installation-requirements-user-infra_installing-bare-metal">Requirements for a cluster with user-provisioned infrastructure</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/architecture/#rhcos-configured_architecture-rhcos">Choosing how to configure RHCOS</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/architecture/#rhcos-about-ignition_architecture-rhcos">Ignition</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installation-special-config-kargs_installing-customizing">Kernel arguments</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installation-special-config-kmod_installing-customizing">Kernel modules</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installation-special-config-encrypt-disk_installing-customizing">Disk encryption</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installation-special-config-chrony_installing-customizing">Chrony time service</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/updating_clusters/#update-service-about_understanding-openshift-updates">About the OpenShift Update Service</a>
						</li></ul></div></section><section class="section" id="security-hosts-vms-vs-containers_security-hosts-vms"><div class="titlepage"><div><div><h3 class="title">2.2.2. Comparing virtualization and containers</h3></div></div></div><p>
					Traditional virtualization provides another way to keep application environments separate on the same physical host. However, virtual machines work in a different way than containers. Virtualization relies on a hypervisor spinning up guest virtual machines (VMs), each of which has its own operating system (OS), represented by a running kernel, as well as the running application and its dependencies.
				</p><p>
					With VMs, the hypervisor isolates the guests from each other and from the host kernel. Fewer individuals and processes have access to the hypervisor, reducing the attack surface on the physical server. That said, security must still be monitored: one guest VM might be able to use hypervisor bugs to gain access to another VM or the host kernel. And, when the OS needs to be patched, it must be patched on all guest VMs using that OS.
				</p><p>
					Containers can be run inside guest VMs, and there might be use cases where this is desirable. For example, you might be deploying a traditional application in a container, perhaps to lift-and-shift an application to the cloud.
				</p><p>
					Container separation on a single host, however, provides a more lightweight, flexible, and easier-to-scale deployment solution. This deployment model is particularly appropriate for cloud-native applications. Containers are generally much smaller than VMs and consume less memory and CPU.
				</p><p>
					See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux_atomic_host/7/html/overview_of_containers_in_red_hat_systems/introduction_to_linux_containers#linux_containers_compared_to_kvm_virtualization">Linux Containers Compared to KVM Virtualization</a> in the RHEL 7 container documentation to learn about the differences between container and VMs.
				</p></section><section class="section" id="security-hosts-vms-openshift_security-hosts-vms"><div class="titlepage"><div><div><h3 class="title">2.2.3. Securing OpenShift Container Platform</h3></div></div></div><p>
					When you deploy OpenShift Container Platform, you have the choice of an installer-provisioned infrastructure (there are several available platforms) or your own user-provisioned infrastructure. Some low-level security-related configuration, such as adding kernel modules required at first boot, might benefit from a user-provisioned infrastructure. Likewise, user-provisioned infrastructure is appropriate for disconnected OpenShift Container Platform deployments.
				</p><p>
					Keep in mind that, when it comes to making security enhancements and other configuration changes to OpenShift Container Platform, the goals should include:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Keeping the underlying nodes as generic as possible. You want to be able to easily throw away and spin up similar nodes quickly and in prescriptive ways.
						</li><li class="listitem">
							Managing modifications to nodes through OpenShift Container Platform as much as possible, rather than making direct, one-off changes to the nodes.
						</li></ul></div><p>
					In pursuit of those goals, most node changes should be done during installation through Ignition or later using MachineConfigs that are applied to sets of nodes by the Machine Config Operator. Examples of security-related configuration changes you can do in this way include:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Adding kernel arguments
						</li><li class="listitem">
							Adding kernel modules
						</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Configuring disk encryption
						</li><li class="listitem">
							Configuring the chrony time service
						</li></ul></div><p>
					Besides the Machine Config Operator, there are several other Operators available to configure OpenShift Container Platform infrastructure that are managed by the Cluster Version Operator (CVO). The CVO is able to automate many aspects of OpenShift Container Platform cluster updates.
				</p></section></section><section class="section" id="security-hardening"><div class="titlepage"><div><div><h2 class="title">2.3. Hardening RHCOS</h2></div></div></div><p>
				RHCOS was created and tuned to be deployed in OpenShift Container Platform with few if any changes needed to RHCOS nodes. Every organization adopting OpenShift Container Platform has its own requirements for system hardening. As a RHEL system with OpenShift-specific modifications and features added (such as Ignition, ostree, and a read-only <code class="literal">/usr</code> to provide limited immutability), RHCOS can be hardened just as you would any RHEL system. Differences lie in the ways you manage the hardening.
			</p><p>
				A key feature of OpenShift Container Platform and its Kubernetes engine is to be able to quickly scale applications and infrastructure up and down as needed. Unless it is unavoidable, you do not want to make direct changes to RHCOS by logging into a host and adding software or changing settings. You want to have the OpenShift Container Platform installer and control plane manage changes to RHCOS so new nodes can be spun up without manual intervention.
			</p><p>
				So, if you are setting out to harden RHCOS nodes in OpenShift Container Platform to meet your security needs, you should consider both what to harden and how to go about doing that hardening.
			</p><section class="section" id="security-hardening-what_security-hardening"><div class="titlepage"><div><div><h3 class="title">2.3.1. Choosing what to harden in RHCOS</h3></div></div></div><p>
					The <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/security_hardening/index#scanning-container-and-container-images-for-vulnerabilities_scanning-the-system-for-security-compliance-and-vulnerabilities">RHEL 8 Security Hardening</a> guide describes how you should approach security for any RHEL system.
				</p><p>
					Use this guide to learn how to approach cryptography, evaluate vulnerabilities, and assess threats to various services. Likewise, you can learn how to scan for compliance standards, check file integrity, perform auditing, and encrypt storage devices.
				</p><p>
					With the knowledge of what features you want to harden, you can then decide how to harden them in RHCOS.
				</p></section><section class="section" id="security-hardening-how_security-hardening"><div class="titlepage"><div><div><h3 class="title">2.3.2. Choosing how to harden RHCOS</h3></div></div></div><p>
					Direct modification of RHCOS systems in OpenShift Container Platform is discouraged. Instead, you should think of modifying systems in pools of nodes, such as worker nodes and control plane nodes. When a new node is needed, in non-bare metal installs, you can request a new node of the type you want and it will be created from an RHCOS image plus the modifications you created earlier.
				</p><p>
					There are opportunities for modifying RHCOS before installation, during installation, and after the cluster is up and running.
				</p><section class="section" id="security-harden-before-installation_security-hardening"><div class="titlepage"><div><div><h4 class="title">2.3.2.1. Hardening before installation</h4></div></div></div><p>
						For bare metal installations, you can add hardening features to RHCOS before beginning the OpenShift Container Platform installation. For example, you can add kernel options when you boot the RHCOS installer to turn security features on or off, such as various SELinux booleans or low-level settings, such as symmetric multithreading.
					</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							Disabling SELinux on RHCOS nodes is not supported.
						</p></div></div><p>
						Although bare metal RHCOS installations are more difficult, they offer the opportunity of getting operating system changes in place before starting the OpenShift Container Platform installation. This can be important when you need to ensure that certain features, such as disk encryption or special networking settings, be set up at the earliest possible moment.
					</p></section><section class="section" id="security-harden-during-installation_security-hardening"><div class="titlepage"><div><div><h4 class="title">2.3.2.2. Hardening during installation</h4></div></div></div><p>
						You can interrupt the OpenShift Container Platform installation process and change Ignition configs. Through Ignition configs, you can add your own files and systemd services to the RHCOS nodes. You can also make some basic security-related changes to the <code class="literal">install-config.yaml</code> file used for installation. Contents added in this way are available at each node’s first boot.
					</p></section><section class="section" id="security-harden-after-installation_security-hardening"><div class="titlepage"><div><div><h4 class="title">2.3.2.3. Hardening after the cluster is running</h4></div></div></div><p>
						After the OpenShift Container Platform cluster is up and running, there are several ways to apply hardening features to RHCOS:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Daemon set: If you need a service to run on every node, you can add that service with a <a class="link" href="https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/">Kubernetes <code class="literal">DaemonSet</code> object</a>.
							</li><li class="listitem">
								Machine config: <code class="literal">MachineConfig</code> objects contain a subset of Ignition configs in the same format. By applying machine configs to all worker or control plane nodes, you can ensure that the next node of the same type that is added to the cluster has the same changes applied.
							</li></ul></div><p>
						All of the features noted here are described in the OpenShift Container Platform product documentation.
					</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/articles/5059881">OpenShift Security Guide</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/architecture/#rhcos-deployed_architecture-rhcos">Choosing how to configure RHCOS</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-nodes-managing">Modifying Nodes</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installation-initializing-manual_installing-bare-metal">Manually creating the installation configuration file</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installation-user-infra-generate-k8s-manifest-ignition_installing-bare-metal">Creating the Kubernetes manifest and Ignition config files</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installation-user-infra-machines-iso_installing-bare-metal">Installing RHCOS by using an ISO image</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-customizing">Customizing nodes</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-nodes-kernel-arguments_nodes-nodes-managing">Adding kernel arguments to Nodes</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installation-configuration-parameters_installing-aws-customizations">Installation configuration parameters</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/articles/3359851">RHEL core crypto components</a>
							</li></ul></div></section></section></section><section class="section" id="security-container-signature"><div class="titlepage"><div><div><h2 class="title">2.4. Container image signatures</h2></div></div></div><p>
				Red Hat delivers signatures for the images in the Red Hat Container Registries. Those signatures can be automatically verified when being pulled to OpenShift Container Platform 4 clusters by using the Machine Config Operator (MCO).
			</p><p>
				<a class="link" href="https://quay.io/">Quay.io</a> serves most of the images that make up OpenShift Container Platform, and only the release image is signed. Release images refer to the approved OpenShift Container Platform images, offering a degree of protection against supply chain attacks. However, some extensions to OpenShift Container Platform, such as logging, monitoring, and service mesh, are shipped as Operators from the Operator Lifecycle Manager (OLM). Those images ship from the <a class="link" href="https://catalog.redhat.com/software/containers/explore">Red Hat Ecosystem Catalog Container images</a> registry.
			</p><p>
				To verify the integrity of those images between Red Hat registries and your infrastructure, enable signature verification.
			</p><section class="section" id="containers-signature-verify-enable_security-container-signature"><div class="titlepage"><div><div><h3 class="title">2.4.1. Enabling signature verification for Red Hat Container Registries</h3></div></div></div><p>
					Enabling container signature validation for Red Hat Container Registries requires writing a signature verification policy file specifying the keys to verify images from these registries. For RHEL8 nodes, the registries are already defined in <code class="literal">/etc/containers/registries.d</code> by default.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a Butane config file, <code class="literal">51-worker-rh-registry-trust.bu</code>, containing the necessary configuration for the worker nodes.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								See "Creating machine configs with Butane" for information about Butane.
							</p></div></div><pre class="programlisting language-yaml">variant: openshift
version: 4.13.0
metadata:
  name: 51-worker-rh-registry-trust
  labels:
    machineconfiguration.openshift.io/role: worker
storage:
  files:
  - path: /etc/containers/policy.json
    mode: 0644
    overwrite: true
    contents:
      inline: |
        {
          "default": [
            {
              "type": "insecureAcceptAnything"
            }
          ],
          "transports": {
            "docker": {
              "registry.access.redhat.com": [
                {
                  "type": "signedBy",
                  "keyType": "GPGKeys",
                  "keyPath": "/etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release"
                }
              ],
              "registry.redhat.io": [
                {
                  "type": "signedBy",
                  "keyType": "GPGKeys",
                  "keyPath": "/etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release"
                }
              ]
            },
            "docker-daemon": {
              "": [
                {
                  "type": "insecureAcceptAnything"
                }
              ]
            }
          }
        }</pre></li><li class="listitem"><p class="simpara">
							Use Butane to generate a machine config YAML file, <code class="literal">51-worker-rh-registry-trust.yaml</code>, containing the file to be written to disk on the worker nodes:
						</p><pre class="programlisting language-terminal">$ butane 51-worker-rh-registry-trust.bu -o 51-worker-rh-registry-trust.yaml</pre></li><li class="listitem"><p class="simpara">
							Apply the created machine config:
						</p><pre class="programlisting language-terminal">$ oc apply -f 51-worker-rh-registry-trust.yaml</pre></li><li class="listitem"><p class="simpara">
							Check that the worker machine config pool has rolled out with the new machine config:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Check that the new machine config was created:
								</p><pre class="programlisting language-terminal">$ oc get mc</pre><div class="formalpara"><p class="title"><strong>Sample output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME                                               GENERATEDBYCONTROLLER                      IGNITIONVERSION   AGE
00-master                                          a2178ad522c49ee330b0033bb5cb5ea132060b0a   3.2.0             25m
00-worker                                          a2178ad522c49ee330b0033bb5cb5ea132060b0a   3.2.0             25m
01-master-container-runtime                        a2178ad522c49ee330b0033bb5cb5ea132060b0a   3.2.0             25m
01-master-kubelet                                  a2178ad522c49ee330b0033bb5cb5ea132060b0a   3.2.0             25m
01-worker-container-runtime                        a2178ad522c49ee330b0033bb5cb5ea132060b0a   3.2.0             25m
01-worker-kubelet                                  a2178ad522c49ee330b0033bb5cb5ea132060b0a   3.2.0             25m
51-master-rh-registry-trust                                                                   3.2.0             13s
51-worker-rh-registry-trust                                                                   3.2.0             53s <span id="CO1-1"><!--Empty--></span><span class="callout">1</span>
99-master-generated-crio-seccomp-use-default                                                  3.2.0             25m
99-master-generated-registries                     a2178ad522c49ee330b0033bb5cb5ea132060b0a   3.2.0             25m
99-master-ssh                                                                                 3.2.0             28m
99-worker-generated-crio-seccomp-use-default                                                  3.2.0             25m
99-worker-generated-registries                     a2178ad522c49ee330b0033bb5cb5ea132060b0a   3.2.0             25m
99-worker-ssh                                                                                 3.2.0             28m
rendered-master-af1e7ff78da0a9c851bab4be2777773b   a2178ad522c49ee330b0033bb5cb5ea132060b0a   3.2.0             8s
rendered-master-cd51fd0c47e91812bfef2765c52ec7e6   a2178ad522c49ee330b0033bb5cb5ea132060b0a   3.2.0             24m
rendered-worker-2b52f75684fbc711bd1652dd86fd0b82   a2178ad522c49ee330b0033bb5cb5ea132060b0a   3.2.0             24m
rendered-worker-be3b3bce4f4aa52a62902304bac9da3c   a2178ad522c49ee330b0033bb5cb5ea132060b0a   3.2.0             48s <span id="CO1-2"><!--Empty--></span><span class="callout">2</span></pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO1-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											New machine config
										</div></dd><dt><a href="#CO1-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											New rendered machine config
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Check that the worker machine config pool is updating with the new machine config:
								</p><pre class="programlisting language-terminal">$ oc get mcp</pre><div class="formalpara"><p class="title"><strong>Sample output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME     CONFIG                                             UPDATED   UPDATING   DEGRADED   MACHINECOUNT   READYMACHINECOUNT   UPDATEDMACHINECOUNT   DEGRADEDMACHINECOUNT   AGE
master   rendered-master-af1e7ff78da0a9c851bab4be2777773b   True      False      False      3              3                   3                     0                      30m
worker   rendered-worker-be3b3bce4f4aa52a62902304bac9da3c   False     True       False      3              0                   0                     0                      30m <span id="CO2-1"><!--Empty--></span><span class="callout">1</span></pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO2-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											When the <code class="literal">UPDATING</code> field is <code class="literal">True</code>, the machine config pool is updating with the new machine config. When the field becomes <code class="literal">False</code>, the worker machine config pool has rolled out to the new machine config.
										</div></dd></dl></div></li></ol></div></li><li class="listitem"><p class="simpara">
							If your cluster uses any RHEL7 worker nodes, when the worker machine config pool is updated, create YAML files on those nodes in the <code class="literal">/etc/containers/registries.d</code> directory, which specify the location of the detached signatures for a given registry server. The following example works only for images hosted in <code class="literal">registry.access.redhat.com</code> and <code class="literal">registry.redhat.io</code>.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Start a debug session to each RHEL7 worker node:
								</p><pre class="programlisting language-terminal">$ oc debug node/&lt;node_name&gt;</pre></li><li class="listitem"><p class="simpara">
									Change your root directory to <code class="literal">/host</code>:
								</p><pre class="programlisting language-terminal">sh-4.2# chroot /host</pre></li><li class="listitem"><p class="simpara">
									Create a <code class="literal">/etc/containers/registries.d/registry.redhat.io.yaml</code> file that contains the following:
								</p><pre class="programlisting language-terminal">docker:
     registry.redhat.io:
         sigstore: https://registry.redhat.io/containers/sigstore</pre></li><li class="listitem"><p class="simpara">
									Create a <code class="literal">/etc/containers/registries.d/registry.access.redhat.com.yaml</code> file that contains the following:
								</p><pre class="programlisting language-terminal">docker:
     registry.access.redhat.com:
         sigstore: https://access.redhat.com/webassets/docker/content/sigstore</pre></li><li class="listitem">
									Exit the debug session.
								</li></ol></div></li></ol></div></section><section class="section" id="containers-signature-verify-application_security-container-signature"><div class="titlepage"><div><div><h3 class="title">2.4.2. Verifying the signature verification configuration</h3></div></div></div><p>
					After you apply the machine configs to the cluster, the Machine Config Controller detects the new <code class="literal">MachineConfig</code> object and generates a new <code class="literal">rendered-worker-&lt;hash&gt;</code> version.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You enabled signature verification by using a machine config file.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							On the command line, run the following command to display information about a desired worker:
						</p><pre class="programlisting language-terminal">$ oc describe machineconfigpool/worker</pre><div class="formalpara"><p class="title"><strong>Example output of initial worker monitoring</strong></p><p>
								
<pre class="programlisting language-terminal">Name:         worker
Namespace:
Labels:       machineconfiguration.openshift.io/mco-built-in=
Annotations:  &lt;none&gt;
API Version:  machineconfiguration.openshift.io/v1
Kind:         MachineConfigPool
Metadata:
  Creation Timestamp:  2019-12-19T02:02:12Z
  Generation:          3
  Resource Version:    16229
  Self Link:           /apis/machineconfiguration.openshift.io/v1/machineconfigpools/worker
  UID:                 92697796-2203-11ea-b48c-fa163e3940e5
Spec:
  Configuration:
    Name:  rendered-worker-f6819366eb455a401c42f8d96ab25c02
    Source:
      API Version:  machineconfiguration.openshift.io/v1
      Kind:         MachineConfig
      Name:         00-worker
      API Version:  machineconfiguration.openshift.io/v1
      Kind:         MachineConfig
      Name:         01-worker-container-runtime
      API Version:  machineconfiguration.openshift.io/v1
      Kind:         MachineConfig
      Name:         01-worker-kubelet
      API Version:  machineconfiguration.openshift.io/v1
      Kind:         MachineConfig
      Name:         51-worker-rh-registry-trust
      API Version:  machineconfiguration.openshift.io/v1
      Kind:         MachineConfig
      Name:         99-worker-92697796-2203-11ea-b48c-fa163e3940e5-registries
      API Version:  machineconfiguration.openshift.io/v1
      Kind:         MachineConfig
      Name:         99-worker-ssh
  Machine Config Selector:
    Match Labels:
      machineconfiguration.openshift.io/role:  worker
  Node Selector:
    Match Labels:
      node-role.kubernetes.io/worker:
  Paused:                              false
Status:
  Conditions:
    Last Transition Time:  2019-12-19T02:03:27Z
    Message:
    Reason:
    Status:                False
    Type:                  RenderDegraded
    Last Transition Time:  2019-12-19T02:03:43Z
    Message:
    Reason:
    Status:                False
    Type:                  NodeDegraded
    Last Transition Time:  2019-12-19T02:03:43Z
    Message:
    Reason:
    Status:                False
    Type:                  Degraded
    Last Transition Time:  2019-12-19T02:28:23Z
    Message:
    Reason:
    Status:                False
    Type:                  Updated
    Last Transition Time:  2019-12-19T02:28:23Z
    Message:               All nodes are updating to rendered-worker-f6819366eb455a401c42f8d96ab25c02
    Reason:
    Status:                True
    Type:                  Updating
  Configuration:
    Name:  rendered-worker-d9b3f4ffcfd65c30dcf591a0e8cf9b2e
    Source:
      API Version:            machineconfiguration.openshift.io/v1
      Kind:                   MachineConfig
      Name:                   00-worker
      API Version:            machineconfiguration.openshift.io/v1
      Kind:                   MachineConfig
      Name:                   01-worker-container-runtime
      API Version:            machineconfiguration.openshift.io/v1
      Kind:                   MachineConfig
      Name:                   01-worker-kubelet
      API Version:            machineconfiguration.openshift.io/v1
      Kind:                   MachineConfig
      Name:                   99-worker-92697796-2203-11ea-b48c-fa163e3940e5-registries
      API Version:            machineconfiguration.openshift.io/v1
      Kind:                   MachineConfig
      Name:                   99-worker-ssh
  Degraded Machine Count:     0
  Machine Count:              1
  Observed Generation:        3
  Ready Machine Count:        0
  Unavailable Machine Count:  1
  Updated Machine Count:      0
Events:                       &lt;none&gt;</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Run the <code class="literal">oc describe</code> command again:
						</p><pre class="programlisting language-terminal">$ oc describe machineconfigpool/worker</pre><div class="formalpara"><p class="title"><strong>Example output after the worker is updated</strong></p><p>
								
<pre class="programlisting language-terminal">...
    Last Transition Time:  2019-12-19T04:53:09Z
    Message:               All nodes are updated with rendered-worker-f6819366eb455a401c42f8d96ab25c02
    Reason:
    Status:                True
    Type:                  Updated
    Last Transition Time:  2019-12-19T04:53:09Z
    Message:
    Reason:
    Status:                False
    Type:                  Updating
  Configuration:
    Name:  rendered-worker-f6819366eb455a401c42f8d96ab25c02
    Source:
      API Version:            machineconfiguration.openshift.io/v1
      Kind:                   MachineConfig
      Name:                   00-worker
      API Version:            machineconfiguration.openshift.io/v1
      Kind:                   MachineConfig
      Name:                   01-worker-container-runtime
      API Version:            machineconfiguration.openshift.io/v1
      Kind:                   MachineConfig
      Name:                   01-worker-kubelet
      API Version:            machineconfiguration.openshift.io/v1
      Kind:                   MachineConfig
      Name:                   51-worker-rh-registry-trust
      API Version:            machineconfiguration.openshift.io/v1
      Kind:                   MachineConfig
      Name:                   99-worker-92697796-2203-11ea-b48c-fa163e3940e5-registries
      API Version:            machineconfiguration.openshift.io/v1
      Kind:                   MachineConfig
      Name:                   99-worker-ssh
  Degraded Machine Count:     0
  Machine Count:              3
  Observed Generation:        4
  Ready Machine Count:        3
  Unavailable Machine Count:  0
  Updated Machine Count:      3
...</pre>

							</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The <code class="literal">Observed Generation</code> parameter shows an increased count based on the generation of the controller-produced configuration. This controller updates this value even if it fails to process the specification and generate a revision. The <code class="literal">Configuration Source</code> value points to the <code class="literal">51-worker-rh-registry-trust</code> configuration.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Confirm that the <code class="literal">policy.json</code> file exists with the following command:
						</p><pre class="programlisting language-terminal">$ oc debug node/&lt;node&gt; -- chroot /host cat /etc/containers/policy.json</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Starting pod/&lt;node&gt;-debug ...
To use host binaries, run `chroot /host`
{
  "default": [
    {
      "type": "insecureAcceptAnything"
    }
  ],
  "transports": {
    "docker": {
      "registry.access.redhat.com": [
        {
          "type": "signedBy",
          "keyType": "GPGKeys",
          "keyPath": "/etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release"
        }
      ],
      "registry.redhat.io": [
        {
          "type": "signedBy",
          "keyType": "GPGKeys",
          "keyPath": "/etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release"
        }
      ]
    },
    "docker-daemon": {
      "": [
        {
          "type": "insecureAcceptAnything"
        }
      ]
    }
  }
}</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Confirm that the <code class="literal">registry.redhat.io.yaml</code> file exists with the following command:
						</p><pre class="programlisting language-terminal">$ oc debug node/&lt;node&gt; -- chroot /host cat /etc/containers/registries.d/registry.redhat.io.yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Starting pod/&lt;node&gt;-debug ...
To use host binaries, run `chroot /host`
docker:
     registry.redhat.io:
         sigstore: https://registry.redhat.io/containers/sigstore</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Confirm that the <code class="literal">registry.access.redhat.com.yaml</code> file exists with the following command:
						</p><pre class="programlisting language-terminal">$ oc debug node/&lt;node&gt; -- chroot /host cat /etc/containers/registries.d/registry.access.redhat.com.yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Starting pod/&lt;node&gt;-debug ...
To use host binaries, run `chroot /host`
docker:
     registry.access.redhat.com:
         sigstore: https://access.redhat.com/webassets/docker/content/sigstore</pre>

							</p></div></li></ol></div></section><section class="section _additional-resources" id="additional-resources_security-container-signature"><div class="titlepage"><div><div><h3 class="title">2.4.3. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/post-installation_configuration/#machine-config-overview-post-install-machine-configuration-tasks">Machine Config Overview</a>
						</li></ul></div></section></section><section class="section" id="security-compliance"><div class="titlepage"><div><div><h2 class="title">2.5. Understanding compliance</h2></div></div></div><p>
				For many OpenShift Container Platform customers, regulatory readiness, or compliance, on some level is required before any systems can be put into production. That regulatory readiness can be imposed by national standards, industry standards or the organization’s corporate governance framework.
			</p><section class="section" id="security-compliance-nist_security-compliance"><div class="titlepage"><div><div><h3 class="title">2.5.1. Understanding compliance and risk management</h3></div></div></div><p>
					To understand Red Hat’s view of OpenShift Container Platform compliance frameworks, refer to the Risk Management and Regulatory Readiness chapter of the <a class="link" href="https://access.redhat.com/articles/5059881">OpenShift Security Guide Book</a>.
				</p></section></section><section class="section" id="security-container-content"><div class="titlepage"><div><div><h2 class="title">2.6. Securing container content</h2></div></div></div><p>
				To ensure the security of the content inside your containers you need to start with trusted base images, such as Red Hat Universal Base Images, and add trusted software. To check the ongoing security of your container images, there are both Red Hat and third-party tools for scanning images.
			</p><section class="section" id="security-container-content-inside_security-container-content"><div class="titlepage"><div><div><h3 class="title">2.6.1. Securing inside the container</h3></div></div></div><p>
					Applications and infrastructures are composed of readily available components, many of which are open source packages such as, the Linux operating system, JBoss Web Server, PostgreSQL, and Node.js.
				</p><p>
					Containerized versions of these packages are also available. However, you need to know where the packages originally came from, what versions are used, who built them, and whether there is any malicious code inside them.
				</p><p>
					Some questions to answer include:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Will what is inside the containers compromise your infrastructure?
						</li><li class="listitem">
							Are there known vulnerabilities in the application layer?
						</li><li class="listitem">
							Are the runtime and operating system layers current?
						</li></ul></div><p>
					By building your containers from Red Hat <a class="link" href="https://access.redhat.com/articles/4238681">Universal Base Images</a> (UBI) you are assured of a foundation for your container images that consists of the same RPM-packaged software that is included in Red Hat Enterprise Linux. No subscriptions are required to either use or redistribute UBI images.
				</p><p>
					To assure ongoing security of the containers themselves, security scanning features, used directly from RHEL or added to OpenShift Container Platform, can alert you when an image you are using has vulnerabilities. OpenSCAP image scanning is available in RHEL and the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_quay/3/html-single/manage_red_hat_quay/index#container-security-operator-setup">Red Hat Quay Container Security Operator</a> can be added to check container images used in OpenShift Container Platform.
				</p></section><section class="section" id="security-container-content-universal_security-container-content"><div class="titlepage"><div><div><h3 class="title">2.6.2. Creating redistributable images with UBI</h3></div></div></div><p>
					To create containerized applications, you typically start with a trusted base image that offers the components that are usually provided by the operating system. These include the libraries, utilities, and other features the application expects to see in the operating system’s file system.
				</p><p>
					Red Hat Universal Base Images (UBI) were created to encourage anyone building their own containers to start with one that is made entirely from Red Hat Enterprise Linux rpm packages and other content. These UBI images are updated regularly to keep up with security patches and free to use and redistribute with container images built to include your own software.
				</p><p>
					Search the <a class="link" href="https://catalog.redhat.com/software/containers/explore">Red Hat Ecosystem Catalog</a> to both find and check the health of different UBI images. As someone creating secure container images, you might be interested in these two general types of UBI images:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>UBI</strong></span>: There are standard UBI images for RHEL 7, 8, and 9 (<code class="literal">ubi7/ubi</code>, <code class="literal">ubi8/ubi</code>, and <code class="literal">ubi9/ubi</code>), as well as minimal images based on those systems (<code class="literal">ubi7/ubi-minimal</code>, <code class="literal">ubi8/ubi-mimimal</code>, and ubi9/ubi-minimal). All of these images are preconfigured to point to free repositories of RHEL software that you can add to the container images you build, using standard <code class="literal">yum</code> and <code class="literal">dnf</code> commands. Red Hat encourages people to use these images on other distributions, such as Fedora and Ubuntu.
						</li><li class="listitem">
							<span class="strong strong"><strong>Red Hat Software Collections</strong></span>: Search the Red Hat Ecosystem Catalog for <code class="literal">rhscl/</code> to find images created to use as base images for specific types of applications. For example, there are Apache httpd (<code class="literal">rhscl/httpd-*</code>), Python (<code class="literal">rhscl/python-*</code>), Ruby (<code class="literal">rhscl/ruby-*</code>), Node.js (<code class="literal">rhscl/nodejs-*</code>) and Perl (<code class="literal">rhscl/perl-*</code>) rhscl images.
						</li></ul></div><p>
					Keep in mind that while UBI images are freely available and redistributable, Red Hat support for these images is only available through Red Hat product subscriptions.
				</p><p>
					See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/building_running_and_managing_containers/index#using_red_hat_universal_base_images_standard_minimal_and_runtimes">Using Red Hat Universal Base Images</a> in the Red Hat Enterprise Linux documentation for information on how to use and build on standard, minimal and init UBI images.
				</p></section><section class="section" id="security-container-content-scanning_security-container-content"><div class="titlepage"><div><div><h3 class="title">2.6.3. Security scanning in RHEL</h3></div></div></div><p>
					For Red Hat Enterprise Linux (RHEL) systems, OpenSCAP scanning is available from the <code class="literal">openscap-utils</code> package. In RHEL, you can use the <code class="literal">openscap-podman</code> command to scan images for vulnerabilities. See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/security_hardening/index#scanning-the-system-for-configuration-compliance-and-vulnerabilities_security-hardening">Scanning containers and container images for vulnerabilities</a> in the Red Hat Enterprise Linux documentation.
				</p><p>
					OpenShift Container Platform enables you to leverage RHEL scanners with your CI/CD process. For example, you can integrate static code analysis tools that test for security flaws in your source code and software composition analysis tools that identify open source libraries to provide metadata on those libraries such as known vulnerabilities.
				</p><section class="section" id="quay-security-scan_security-container-content"><div class="titlepage"><div><div><h4 class="title">2.6.3.1. Scanning OpenShift images</h4></div></div></div><p>
						For the container images that are running in OpenShift Container Platform and are pulled from Red Hat Quay registries, you can use an Operator to list the vulnerabilities of those images. The <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_quay/3/html-single/manage_red_hat_quay/index#container-security-operator-setup">Red Hat Quay Container Security Operator</a> can be added to OpenShift Container Platform to provide vulnerability reporting for images added to selected namespaces.
					</p><p>
						Container image scanning for Red Hat Quay is performed by the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_quay/3/html-single/manage_red_hat_quay/index#quay-security-scanner">Clair security scanner</a>. In Red Hat Quay, Clair can search for and report vulnerabilities in images built from RHEL, CentOS, Oracle, Alpine, Debian, and Ubuntu operating system software.
					</p></section></section><section class="section" id="security-container-content-external-scanning_security-container-content"><div class="titlepage"><div><div><h3 class="title">2.6.4. Integrating external scanning</h3></div></div></div><p>
					OpenShift Container Platform makes use of <a class="link" href="https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/">object annotations</a> to extend functionality. External tools, such as vulnerability scanners, can annotate image objects with metadata to summarize results and control pod execution. This section describes the recognized format of this annotation so it can be reliably used in consoles to display useful data to users.
				</p><section class="section" id="security-image-metadata_security-container-content"><div class="titlepage"><div><div><h4 class="title">2.6.4.1. Image metadata</h4></div></div></div><p>
						There are different types of image quality data, including package vulnerabilities and open source software (OSS) license compliance. Additionally, there may be more than one provider of this metadata. To that end, the following annotation format has been reserved:
					</p><pre class="screen">quality.images.openshift.io/&lt;qualityType&gt;.&lt;providerId&gt;: {}</pre><div class="table" id="idm139961139215376"><p class="title"><strong>Table 2.1. Annotation key format</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139961135604144" scope="col">Component</th><th align="left" valign="top" id="idm139961135603056" scope="col">Description</th><th align="left" valign="top" id="idm139961135601968" scope="col">Acceptable values</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139961135604144"> <p>
										<code class="literal">qualityType</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139961135603056"> <p>
										Metadata type
									</p>
									 </td><td align="left" valign="top" headers="idm139961135601968"> <p>
										<code class="literal">vulnerability</code><br/><code class="literal">license</code><br/><code class="literal">operations</code><br/><code class="literal">policy</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961135604144"> <p>
										<code class="literal">providerId</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139961135603056"> <p>
										Provider ID string
									</p>
									 </td><td align="left" valign="top" headers="idm139961135601968"> <p>
										<code class="literal">openscap</code><br/><code class="literal">redhatcatalog</code><br/><code class="literal">redhatinsights</code><br/><code class="literal">blackduck</code><br/><code class="literal">jfrog</code>
									</p>
									 </td></tr></tbody></table></div></div><section class="section" id="security-example-annotation-keys_security-container-content"><div class="titlepage"><div><div><h5 class="title">2.6.4.1.1. Example annotation keys</h5></div></div></div><pre class="screen">quality.images.openshift.io/vulnerability.blackduck: {}
quality.images.openshift.io/vulnerability.jfrog: {}
quality.images.openshift.io/license.blackduck: {}
quality.images.openshift.io/vulnerability.openscap: {}</pre><p>
							The value of the image quality annotation is structured data that must adhere to the following format:
						</p><div class="table" id="idm139961128558832"><p class="title"><strong>Table 2.2. Annotation value format</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139961128404608" scope="col">Field</th><th align="left" valign="top" id="idm139961128403520" scope="col">Required?</th><th align="left" valign="top" id="idm139961128690624" scope="col">Description</th><th align="left" valign="top" id="idm139961128689536" scope="col">Type</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139961128404608"> <p>
											<code class="literal">name</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139961128403520"> <p>
											Yes
										</p>
										 </td><td align="left" valign="top" headers="idm139961128690624"> <p>
											Provider display name
										</p>
										 </td><td align="left" valign="top" headers="idm139961128689536"> <p>
											String
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139961128404608"> <p>
											<code class="literal">timestamp</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139961128403520"> <p>
											Yes
										</p>
										 </td><td align="left" valign="top" headers="idm139961128690624"> <p>
											Scan timestamp
										</p>
										 </td><td align="left" valign="top" headers="idm139961128689536"> <p>
											String
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139961128404608"> <p>
											<code class="literal">description</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139961128403520"> <p>
											No
										</p>
										 </td><td align="left" valign="top" headers="idm139961128690624"> <p>
											Short description
										</p>
										 </td><td align="left" valign="top" headers="idm139961128689536"> <p>
											String
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139961128404608"> <p>
											<code class="literal">reference</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139961128403520"> <p>
											Yes
										</p>
										 </td><td align="left" valign="top" headers="idm139961128690624"> <p>
											URL of information source or more details. Required so user may validate the data.
										</p>
										 </td><td align="left" valign="top" headers="idm139961128689536"> <p>
											String
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139961128404608"> <p>
											<code class="literal">scannerVersion</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139961128403520"> <p>
											No
										</p>
										 </td><td align="left" valign="top" headers="idm139961128690624"> <p>
											Scanner version
										</p>
										 </td><td align="left" valign="top" headers="idm139961128689536"> <p>
											String
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139961128404608"> <p>
											<code class="literal">compliant</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139961128403520"> <p>
											No
										</p>
										 </td><td align="left" valign="top" headers="idm139961128690624"> <p>
											Compliance pass or fail
										</p>
										 </td><td align="left" valign="top" headers="idm139961128689536"> <p>
											Boolean
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139961128404608"> <p>
											<code class="literal">summary</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139961128403520"> <p>
											No
										</p>
										 </td><td align="left" valign="top" headers="idm139961128690624"> <p>
											Summary of issues found
										</p>
										 </td><td align="left" valign="top" headers="idm139961128689536"> <p>
											List (see table below)
										</p>
										 </td></tr></tbody></table></div></div><p>
							The <code class="literal">summary</code> field must adhere to the following format:
						</p><div class="table" id="idm139961139258192"><p class="title"><strong>Table 2.3. Summary field value format</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139961139252464" scope="col">Field</th><th align="left" valign="top" id="idm139961124076352" scope="col">Description</th><th align="left" valign="top" id="idm139961124075264" scope="col">Type</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139961139252464"> <p>
											<code class="literal">label</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139961124076352"> <p>
											Display label for component (for example, "critical," "important," "moderate," "low," or "health")
										</p>
										 </td><td align="left" valign="top" headers="idm139961124075264"> <p>
											String
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139961139252464"> <p>
											<code class="literal">data</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139961124076352"> <p>
											Data for this component (for example, count of vulnerabilities found or score)
										</p>
										 </td><td align="left" valign="top" headers="idm139961124075264"> <p>
											String
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139961139252464"> <p>
											<code class="literal">severityIndex</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139961124076352"> <p>
											Component index allowing for ordering and assigning graphical representation. The value is range <code class="literal">0..3</code> where <code class="literal">0</code> = low.
										</p>
										 </td><td align="left" valign="top" headers="idm139961124075264"> <p>
											Integer
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139961139252464"> <p>
											<code class="literal">reference</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139961124076352"> <p>
											URL of information source or more details. Optional.
										</p>
										 </td><td align="left" valign="top" headers="idm139961124075264"> <p>
											String
										</p>
										 </td></tr></tbody></table></div></div></section><section class="section" id="security-example-annotation-values_security-container-content"><div class="titlepage"><div><div><h5 class="title">2.6.4.1.2. Example annotation values</h5></div></div></div><p>
							This example shows an OpenSCAP annotation for an image with vulnerability summary data and a compliance boolean:
						</p><div class="formalpara"><p class="title"><strong>OpenSCAP annotation</strong></p><p>
								
<pre class="programlisting language-json">{
  "name": "OpenSCAP",
  "description": "OpenSCAP vulnerability score",
  "timestamp": "2016-09-08T05:04:46Z",
  "reference": "https://www.open-scap.org/930492",
  "compliant": true,
  "scannerVersion": "1.2",
  "summary": [
    { "label": "critical", "data": "4", "severityIndex": 3, "reference": null },
    { "label": "important", "data": "12", "severityIndex": 2, "reference": null },
    { "label": "moderate", "data": "8", "severityIndex": 1, "reference": null },
    { "label": "low", "data": "26", "severityIndex": 0, "reference": null }
  ]
}</pre>

							</p></div><p>
							This example shows the <a class="link" href="https://catalog.redhat.com/software/containers/explore">Container images section of the Red Hat Ecosystem Catalog</a> annotation for an image with health index data with an external URL for additional details:
						</p><div class="formalpara"><p class="title"><strong>Red Hat Ecosystem Catalog annotation</strong></p><p>
								
<pre class="programlisting language-json">{
  "name": "Red Hat Ecosystem Catalog",
  "description": "Container health index",
  "timestamp": "2016-09-08T05:04:46Z",
  "reference": "https://access.redhat.com/errata/RHBA-2016:1566",
  "compliant": null,
  "scannerVersion": "1.2",
  "summary": [
    { "label": "Health index", "data": "B", "severityIndex": 1, "reference": null }
  ]
}</pre>

							</p></div></section></section><section class="section" id="security-annotating-image-objects_security-container-content"><div class="titlepage"><div><div><h4 class="title">2.6.4.2. Annotating image objects</h4></div></div></div><p>
						While image stream objects are what an end user of OpenShift Container Platform operates against, image objects are annotated with security metadata. Image objects are cluster-scoped, pointing to a single image that may be referenced by many image streams and tags.
					</p><section class="section" id="security-example-annotate-CLI_security-container-content"><div class="titlepage"><div><div><h5 class="title">2.6.4.2.1. Example annotate CLI command</h5></div></div></div><p>
							Replace <code class="literal">&lt;image&gt;</code> with an image digest, for example <code class="literal">sha256:401e359e0f45bfdcf004e258b72e253fd07fba8cc5c6f2ed4f4608fb119ecc2</code>:
						</p><pre class="programlisting language-terminal">$ oc annotate image &lt;image&gt; \
    quality.images.openshift.io/vulnerability.redhatcatalog='{ \
    "name": "Red Hat Ecosystem Catalog", \
    "description": "Container health index", \
    "timestamp": "2020-06-01T05:04:46Z", \
    "compliant": null, \
    "scannerVersion": "1.2", \
    "reference": "https://access.redhat.com/errata/RHBA-2020:2347", \
    "summary": "[ \
      { "label": "Health index", "data": "B", "severityIndex": 1, "reference": null } ]" }'</pre></section></section><section class="section" id="controlling-pod-execution_security-container-content"><div class="titlepage"><div><div><h4 class="title">2.6.4.3. Controlling pod execution</h4></div></div></div><p>
						Use the <code class="literal">images.openshift.io/deny-execution</code> image policy to programmatically control if an image can be run.
					</p><section class="section" id="security-controlling-pod-execution-example-annotation_security-container-content"><div class="titlepage"><div><div><h5 class="title">2.6.4.3.1. Example annotation</h5></div></div></div><pre class="programlisting language-yaml">annotations:
  images.openshift.io/deny-execution: true</pre></section></section><section class="section" id="security-integration-reference_security-container-content"><div class="titlepage"><div><div><h4 class="title">2.6.4.4. Integration reference</h4></div></div></div><p>
						In most cases, external tools such as vulnerability scanners develop a script or plugin that watches for image updates, performs scanning, and annotates the associated image object with the results. Typically this automation calls the OpenShift Container Platform 4.13 REST APIs to write the annotation. See OpenShift Container Platform REST APIs for general information on the REST APIs.
					</p><section class="section" id="security-integration-reference-example-api-call_security-container-content"><div class="titlepage"><div><div><h5 class="title">2.6.4.4.1. Example REST API call</h5></div></div></div><p>
							The following example call using <code class="literal">curl</code> overrides the value of the annotation. Be sure to replace the values for <code class="literal">&lt;token&gt;</code>, <code class="literal">&lt;openshift_server&gt;</code>, <code class="literal">&lt;image_id&gt;</code>, and <code class="literal">&lt;image_annotation&gt;</code>.
						</p><div class="formalpara"><p class="title"><strong>Patch API call</strong></p><p>
								
<pre class="programlisting language-terminal">$ curl -X PATCH \
  -H "Authorization: Bearer &lt;token&gt;" \
  -H "Content-Type: application/merge-patch+json" \
  https://&lt;openshift_server&gt;:6443/apis/image.openshift.io/v1/images/&lt;image_id&gt; \
  --data '{ &lt;image_annotation&gt; }'</pre>

							</p></div><p>
							The following is an example of <code class="literal">PATCH</code> payload data:
						</p><div class="formalpara"><p class="title"><strong>Patch call data</strong></p><p>
								
<pre class="programlisting language-terminal">{
"metadata": {
  "annotations": {
    "quality.images.openshift.io/vulnerability.redhatcatalog":
       "{ 'name': 'Red Hat Ecosystem Catalog', 'description': 'Container health index', 'timestamp': '2020-06-01T05:04:46Z', 'compliant': null, 'reference': 'https://access.redhat.com/errata/RHBA-2020:2347', 'summary': [{'label': 'Health index', 'data': '4', 'severityIndex': 1, 'reference': null}] }"
    }
  }
}</pre>

							</p></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#overview-of-images">Image stream objects</a>
								</li></ul></div></section></section></section></section><section class="section" id="security-registries"><div class="titlepage"><div><div><h2 class="title">2.7. Using container registries securely</h2></div></div></div><p>
				Container registries store container images to:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Make images accessible to others
					</li><li class="listitem">
						Organize images into repositories that can include multiple versions of an image
					</li><li class="listitem">
						Optionally limit access to images, based on different authentication methods, or make them publicly available
					</li></ul></div><p>
				There are public container registries, such as Quay.io and Docker Hub where many people and organizations share their images. The Red Hat Registry offers supported Red Hat and partner images, while the Red Hat Ecosystem Catalog offers detailed descriptions and health checks for those images. To manage your own registry, you could purchase a container registry such as <a class="link" href="https://access.redhat.com/products/red-hat-quay">Red Hat Quay</a>.
			</p><p>
				From a security standpoint, some registries provide special features to check and improve the health of your containers. For example, Red Hat Quay offers container vulnerability scanning with Clair security scanner, build triggers to automatically rebuild images when source code changes in GitHub and other locations, and the ability to use role-based access control (RBAC) to secure access to images.
			</p><section class="section" id="security-registries-where_security-registries"><div class="titlepage"><div><div><h3 class="title">2.7.1. Knowing where containers come from?</h3></div></div></div><p>
					There are tools you can use to scan and track the contents of your downloaded and deployed container images. However, there are many public sources of container images. When using public container registries, you can add a layer of protection by using trusted sources.
				</p></section><section class="section" id="security-registries-immutable_security-registries"><div class="titlepage"><div><div><h3 class="title">2.7.2. Immutable and certified containers</h3></div></div></div><p>
					Consuming security updates is particularly important when managing <span class="emphasis"><em>immutable containers</em></span>. Immutable containers are containers that will never be changed while running. When you deploy immutable containers, you do not step into the running container to replace one or more binaries. From an operational standpoint, you rebuild and redeploy an updated container image to replace a container instead of changing it.
				</p><p>
					Red Hat certified images are:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Free of known vulnerabilities in the platform components or layers
						</li><li class="listitem">
							Compatible across the RHEL platforms, from bare metal to cloud
						</li><li class="listitem">
							Supported by Red Hat
						</li></ul></div><p>
					The list of known vulnerabilities is constantly evolving, so you must track the contents of your deployed container images, as well as newly downloaded images, over time. You can use <a class="link" href="https://access.redhat.com/security/security-updates/#/security-advisories">Red Hat Security Advisories (RHSAs)</a> to alert you to any newly discovered issues in Red Hat certified container images, and direct you to the updated image. Alternatively, you can go to the Red Hat Ecosystem Catalog to look up that and other security-related issues for each Red Hat image.
				</p></section><section class="section" id="security-registries-ecosystem_security-registries"><div class="titlepage"><div><div><h3 class="title">2.7.3. Getting containers from Red Hat Registry and Ecosystem Catalog</h3></div></div></div><p>
					Red Hat lists certified container images for Red Hat products and partner offerings from the <a class="link" href="https://catalog.redhat.com/software/containers/explore">Container Images</a> section of the Red Hat Ecosystem Catalog. From that catalog, you can see details of each image, including CVE, software packages listings, and health scores.
				</p><p>
					Red Hat images are actually stored in what is referred to as the <span class="emphasis"><em>Red Hat Registry</em></span>, which is represented by a public container registry (<code class="literal">registry.access.redhat.com</code>) and an authenticated registry (<code class="literal">registry.redhat.io</code>). Both include basically the same set of container images, with <code class="literal">registry.redhat.io</code> including some additional images that require authentication with Red Hat subscription credentials.
				</p><p>
					Container content is monitored for vulnerabilities by Red Hat and updated regularly. When Red Hat releases security updates, such as fixes to <span class="emphasis"><em>glibc</em></span>, <a class="link" href="https://access.redhat.com/security/vulnerabilities/drown">DROWN</a>, or <a class="link" href="https://access.redhat.com/blogs/766093/posts/2757141">Dirty Cow</a>, any affected container images are also rebuilt and pushed to the Red Hat Registry.
				</p><p>
					Red Hat uses a <code class="literal">health index</code> to reflect the security risk for each container provided through the Red Hat Ecosystem Catalog. Because containers consume software provided by Red Hat and the errata process, old, stale containers are insecure whereas new, fresh containers are more secure.
				</p><p>
					To illustrate the age of containers, the Red Hat Ecosystem Catalog uses a grading system. A freshness grade is a measure of the oldest and most severe security errata available for an image. "A" is more up to date than "F". See <a class="link" href="https://access.redhat.com/articles/2803031">Container Health Index grades as used inside the Red Hat Ecosystem Catalog</a> for more details on this grading system.
				</p><p>
					See the <a class="link" href="https://access.redhat.com/security/">Red Hat Product Security Center</a> for details on security updates and vulnerabilities related to Red Hat software. Check out <a class="link" href="https://access.redhat.com/security/security-updates/#/security-advisories">Red Hat Security Advisories</a> to search for specific advisories and CVEs.
				</p></section><section class="section" id="security-registries-openshift_security-registries"><div class="titlepage"><div><div><h3 class="title">2.7.4. OpenShift Container Registry</h3></div></div></div><p>
					OpenShift Container Platform includes the <span class="emphasis"><em>OpenShift Container Registry</em></span>, a private registry running as an integrated component of the platform that you can use to manage your container images. The OpenShift Container Registry provides role-based access controls that allow you to manage who can pull and push which container images.
				</p><p>
					OpenShift Container Platform also supports integration with other private registries that you might already be using, such as Red Hat Quay.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/registry/#registry-overview">Integrated OpenShift image registry</a>
						</li></ul></div></section><section class="section" id="security-registries-quay_security-registries"><div class="titlepage"><div><div><h3 class="title">2.7.5. Storing containers using Red Hat Quay</h3></div></div></div><p>
					<a class="link" href="https://access.redhat.com/products/red-hat-quay">Red Hat Quay</a> is an enterprise-quality container registry product from Red Hat. Development for Red Hat Quay is done through the upstream <a class="link" href="https://docs.projectquay.io/welcome.html">Project Quay</a>. Red Hat Quay is available to deploy on-premise or through the hosted version of Red Hat Quay at <a class="link" href="https://quay.io">Quay.io</a>.
				</p><p>
					Security-related features of Red Hat Quay include:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Time machine</strong></span>: Allows images with older tags to expire after a set period of time or based on a user-selected expiration time.
						</li><li class="listitem">
							<span class="strong strong"><strong><a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_quay/3/html-single/manage_red_hat_quay/index#repo-mirroring-in-red-hat-quay">Repository mirroring</a></strong></span>: Lets you mirror other registries for security reasons, such hosting a public repository on Red Hat Quay behind a company firewall, or for performance reasons, to keep registries closer to where they are used.
						</li><li class="listitem">
							<span class="strong strong"><strong>Action log storage</strong></span>: Save Red Hat Quay logging output to <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_quay/3/html-single/manage_red_hat_quay/index#proc_manage-log-storage">Elasticsearch storage</a> to allow for later search and analysis.
						</li><li class="listitem">
							<span class="strong strong"><strong><a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_quay/3/html-single/manage_red_hat_quay/index#quay-security-scanner">Clair security scanning</a></strong></span>: Scan images against a variety of Linux vulnerability databases, based on the origins of each container image.
						</li><li class="listitem">
							<span class="strong strong"><strong>Internal authentication</strong></span>: Use the default local database to handle RBAC authentication to Red Hat Quay or choose from LDAP, Keystone (OpenStack), JWT Custom Authentication, or External Application Token authentication.
						</li><li class="listitem">
							<span class="strong strong"><strong>External authorization (OAuth)</strong></span>: Allow authorization to Red Hat Quay from GitHub, GitHub Enterprise, or Google Authentication.
						</li><li class="listitem">
							<span class="strong strong"><strong>Access settings</strong></span>: Generate tokens to allow access to Red Hat Quay from docker, rkt, anonymous access, user-created accounts, encrypted client passwords, or prefix username autocompletion.
						</li></ul></div><p>
					Ongoing integration of Red Hat Quay with OpenShift Container Platform continues, with several OpenShift Container Platform Operators of particular interest. The <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_quay/3/html-single/manage_red_hat_quay/index#quay-bridge-operator">Quay Bridge Operator</a> lets you replace the internal OpenShift image registry with Red Hat Quay. The <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_quay/3/html-single/manage_red_hat_quay/index#container-security-operator-setup">Red Hat Quay Container Security Operator</a> lets you check vulnerabilities of images running in OpenShift Container Platform that were pulled from Red Hat Quay registries.
				</p></section></section><section class="section" id="security-build"><div class="titlepage"><div><div><h2 class="title">2.8. Securing the build process</h2></div></div></div><p>
				In a container environment, the software build process is the stage in the life cycle where application code is integrated with the required runtime libraries. Managing this build process is key to securing the software stack.
			</p><section class="section" id="security-build-once_security-build"><div class="titlepage"><div><div><h3 class="title">2.8.1. Building once, deploying everywhere</h3></div></div></div><p>
					Using OpenShift Container Platform as the standard platform for container builds enables you to guarantee the security of the build environment. Adhering to a "build once, deploy everywhere" philosophy ensures that the product of the build process is exactly what is deployed in production.
				</p><p>
					It is also important to maintain the immutability of your containers. You should not patch running containers, but rebuild and redeploy them.
				</p><p>
					As your software moves through the stages of building, testing, and production, it is important that the tools making up your software supply chain be trusted. The following figure illustrates the process and tools that could be incorporated into a trusted software supply chain for containerized software:
				</p><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/fb24f4bab3af9ca7be8bfa0c17e69e1a/trustedsupplychain.png"/></div></div><p>
					OpenShift Container Platform can be integrated with trusted code repositories (such as GitHub) and development platforms (such as Che) for creating and managing secure code. Unit testing could rely on <a class="link" href="https://cucumber.io/">Cucumber</a> and <a class="link" href="https://junit.org/">JUnit</a>. You could inspect your containers for vulnerabilities and compliance issues with <a class="link" href="https://anchore.com">Anchore</a> or Twistlock, and use image scanning tools such as AtomicScan or Clair. Tools such as <a class="link" href="https://sysdig.com">Sysdig</a> could provide ongoing monitoring of your containerized applications.
				</p></section><section class="section" id="security-build-management_security-build"><div class="titlepage"><div><div><h3 class="title">2.8.2. Managing builds</h3></div></div></div><p>
					You can use Source-to-Image (S2I) to combine source code and base images. <span class="emphasis"><em>Builder images</em></span> make use of S2I to enable your development and operations teams to collaborate on a reproducible build environment. With Red Hat S2I images available as Universal Base Image (UBI) images, you can now freely redistribute your software with base images built from real RHEL RPM packages. Red Hat has removed subscription restrictions to allow this.
				</p><p>
					When developers commit code with Git for an application using build images, OpenShift Container Platform can perform the following functions:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Trigger, either by using webhooks on the code repository or other automated continuous integration (CI) process, to automatically assemble a new image from available artifacts, the S2I builder image, and the newly committed code.
						</li><li class="listitem">
							Automatically deploy the newly built image for testing.
						</li><li class="listitem">
							Promote the tested image to production where it can be automatically deployed using a CI process.
						</li></ul></div><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/e0638ed7f3db92b8ace1aaa85ef6acd8/build_process1.png" alt="Source-to-Image Builds"/></div></div><p>
					You can use the integrated OpenShift Container Registry to manage access to final images. Both S2I and native build images are automatically pushed to your OpenShift Container Registry.
				</p><p>
					In addition to the included Jenkins for CI, you can also integrate your own build and CI environment with OpenShift Container Platform using RESTful APIs, as well as use any API-compliant image registry.
				</p></section><section class="section" id="security-build-inputs_security-build"><div class="titlepage"><div><div><h3 class="title">2.8.3. Securing inputs during builds</h3></div></div></div><p>
					In some scenarios, build operations require credentials to access dependent resources, but it is undesirable for those credentials to be available in the final application image produced by the build. You can define input secrets for this purpose.
				</p><p>
					For example, when building a Node.js application, you can set up your private mirror for Node.js modules. To download modules from that private mirror, you must supply a custom <code class="literal">.npmrc</code> file for the build that contains a URL, user name, and password. For security reasons, you do not want to expose your credentials in the application image.
				</p><p>
					Using this example scenario, you can add an input secret to a new <code class="literal">BuildConfig</code> object:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create the secret, if it does not exist:
						</p><pre class="programlisting language-terminal">$ oc create secret generic secret-npmrc --from-file=.npmrc=~/.npmrc</pre><p class="simpara">
							This creates a new secret named <code class="literal">secret-npmrc</code>, which contains the base64 encoded content of the <code class="literal">~/.npmrc</code> file.
						</p></li><li class="listitem"><p class="simpara">
							Add the secret to the <code class="literal">source</code> section in the existing <code class="literal">BuildConfig</code> object:
						</p><pre class="programlisting language-yaml">source:
  git:
    uri: https://github.com/sclorg/nodejs-ex.git
  secrets:
  - destinationDir: .
    secret:
      name: secret-npmrc</pre></li><li class="listitem"><p class="simpara">
							To include the secret in a new <code class="literal">BuildConfig</code> object, run the following command:
						</p><pre class="programlisting language-terminal">$ oc new-build \
    openshift/nodejs-010-centos7~https://github.com/sclorg/nodejs-ex.git \
    --build-secret secret-npmrc</pre></li></ol></div></section><section class="section" id="security-build-designing_security-build"><div class="titlepage"><div><div><h3 class="title">2.8.4. Designing your build process</h3></div></div></div><p>
					You can design your container image management and build process to use container layers so that you can separate control.
				</p><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/02f7a10ce12e6eda9fdb2b08ff589754/build_process2.png" alt="Designing Your Build Process"/></div></div><p>
					For example, an operations team manages base images, while architects manage middleware, runtimes, databases, and other solutions. Developers can then focus on application layers and focus on writing code.
				</p><p>
					Because new vulnerabilities are identified daily, you need to proactively check container content over time. To do this, you should integrate automated security testing into your build or CI process. For example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							SAST / DAST – Static and Dynamic security testing tools.
						</li><li class="listitem">
							Scanners for real-time checking against known vulnerabilities. Tools like these catalog the open source packages in your container, notify you of any known vulnerabilities, and update you when new vulnerabilities are discovered in previously scanned packages.
						</li></ul></div><p>
					Your CI process should include policies that flag builds with issues discovered by security scans so that your team can take appropriate action to address those issues. You should sign your custom built containers to ensure that nothing is tampered with between build and deployment.
				</p><p>
					Using GitOps methodology, you can use the same CI/CD mechanisms to manage not only your application configurations, but also your OpenShift Container Platform infrastructure.
				</p></section><section class="section" id="security-build-knative_security-build"><div class="titlepage"><div><div><h3 class="title">2.8.5. Building Knative serverless applications</h3></div></div></div><p>
					Relying on Kubernetes and Kourier, you can build, deploy, and manage serverless applications by using OpenShift Serverless in OpenShift Container Platform.
				</p><p>
					As with other builds, you can use S2I images to build your containers, then serve them using Knative services. View Knative application builds through the <span class="strong strong"><strong>Topology</strong></span> view of the OpenShift Container Platform web console.
				</p></section><section class="section _additional-resources" id="additional-resources_security-build"><div class="titlepage"><div><div><h3 class="title">2.8.6. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#understanding-image-builds">Understanding image builds</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#triggering-builds-build-hooks">Triggering and modifying builds</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#creating-build-inputs">Creating build inputs</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#builds-input-secrets-configmaps_creating-build-inputs">Input secrets and config maps</a>
						</li><li class="listitem">
							<a class="link" href="https://docs.openshift.com/serverless/1.28/about/about-serverless.html">OpenShift Serverless overview</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/building_applications/#odc-viewing-application-composition-using-topology-view">Viewing application composition using the Topology view</a>
						</li></ul></div></section></section><section class="section" id="security-deploy"><div class="titlepage"><div><div><h2 class="title">2.9. Deploying containers</h2></div></div></div><p>
				You can use a variety of techniques to make sure that the containers you deploy hold the latest production-quality content and that they have not been tampered with. These techniques include setting up build triggers to incorporate the latest code and using signatures to ensure that the container comes from a trusted source and has not been modified.
			</p><section class="section" id="security-deploy-trigger_security-deploy"><div class="titlepage"><div><div><h3 class="title">2.9.1. Controlling container deployments with triggers</h3></div></div></div><p>
					If something happens during the build process, or if a vulnerability is discovered after an image has been deployed, you can use tooling for automated, policy-based deployment to remediate. You can use triggers to rebuild and replace images, ensuring the immutable containers process, instead of patching running containers, which is not recommended.
				</p><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/58398ce097ac705459624130e73c1082/secure_deployments.png" alt="Secure Deployments"/></div></div><p>
					For example, you build an application using three container image layers: core, middleware, and applications. An issue is discovered in the core image and that image is rebuilt. After the build is complete, the image is pushed to your OpenShift Container Registry. OpenShift Container Platform detects that the image has changed and automatically rebuilds and deploys the application image, based on the defined triggers. This change incorporates the fixed libraries and ensures that the production code is identical to the most current image.
				</p><p>
					You can use the <code class="literal">oc set triggers</code> command to set a deployment trigger. For example, to set a trigger for a deployment called deployment-example:
				</p><pre class="programlisting language-terminal">$ oc set triggers deploy/deployment-example \
    --from-image=example:latest \
    --containers=web</pre></section><section class="section" id="security-deploy-image-sources_security-deploy"><div class="titlepage"><div><div><h3 class="title">2.9.2. Controlling what image sources can be deployed</h3></div></div></div><p>
					It is important that the intended images are actually being deployed, that the images including the contained content are from trusted sources, and they have not been altered. Cryptographic signing provides this assurance. OpenShift Container Platform enables cluster administrators to apply security policy that is broad or narrow, reflecting deployment environment and security requirements. Two parameters define this policy:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							one or more registries, with optional project namespace
						</li><li class="listitem">
							trust type, such as accept, reject, or require public key(s)
						</li></ul></div><p>
					You can use these policy parameters to allow, deny, or require a trust relationship for entire registries, parts of registries, or individual images. Using trusted public keys, you can ensure that the source is cryptographically verified. The policy rules apply to nodes. Policy may be applied uniformly across all nodes or targeted for different node workloads (for example, build, zone, or environment).
				</p><div class="formalpara"><p class="title"><strong>Example image signature policy file</strong></p><p>
						
<pre class="programlisting language-json">{
    "default": [{"type": "reject"}],
    "transports": {
        "docker": {
            "access.redhat.com": [
                {
                    "type": "signedBy",
                    "keyType": "GPGKeys",
                    "keyPath": "/etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release"
                }
            ]
        },
        "atomic": {
            "172.30.1.1:5000/openshift": [
                {
                    "type": "signedBy",
                    "keyType": "GPGKeys",
                    "keyPath": "/etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release"
                }
            ],
            "172.30.1.1:5000/production": [
                {
                    "type": "signedBy",
                    "keyType": "GPGKeys",
                    "keyPath": "/etc/pki/example.com/pubkey"
                }
            ],
            "172.30.1.1:5000": [{"type": "reject"}]
        }
    }
}</pre>

					</p></div><p>
					The policy can be saved onto a node as <code class="literal">/etc/containers/policy.json</code>. Saving this file to a node is best accomplished using a new <code class="literal">MachineConfig</code> object. This example enforces the following rules:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Require images from the Red Hat Registry (<code class="literal">registry.access.redhat.com</code>) to be signed by the Red Hat public key.
						</li><li class="listitem">
							Require images from your OpenShift Container Registry in the <code class="literal">openshift</code> namespace to be signed by the Red Hat public key.
						</li><li class="listitem">
							Require images from your OpenShift Container Registry in the <code class="literal">production</code> namespace to be signed by the public key for <code class="literal">example.com</code>.
						</li><li class="listitem">
							Reject all other registries not specified by the global <code class="literal">default</code> definition.
						</li></ul></div></section><section class="section" id="security-deploy-signature_security-deploy"><div class="titlepage"><div><div><h3 class="title">2.9.3. Using signature transports</h3></div></div></div><p>
					A signature transport is a way to store and retrieve the binary signature blob. There are two types of signature transports.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">atomic</code>: Managed by the OpenShift Container Platform API.
						</li><li class="listitem">
							<code class="literal">docker</code>: Served as a local file or by a web server.
						</li></ul></div><p>
					The OpenShift Container Platform API manages signatures that use the <code class="literal">atomic</code> transport type. You must store the images that use this signature type in your OpenShift Container Registry. Because the docker/distribution <code class="literal">extensions</code> API auto-discovers the image signature endpoint, no additional configuration is required.
				</p><p>
					Signatures that use the <code class="literal">docker</code> transport type are served by local file or web server. These signatures are more flexible; you can serve images from any container image registry and use an independent server to deliver binary signatures.
				</p><p>
					However, the <code class="literal">docker</code> transport type requires additional configuration. You must configure the nodes with the URI of the signature server by placing arbitrarily-named YAML files into a directory on the host system, <code class="literal">/etc/containers/registries.d</code> by default. The YAML configuration files contain a registry URI and a signature server URI, or <span class="emphasis"><em>sigstore</em></span>:
				</p><div class="formalpara"><p class="title"><strong>Example registries.d file</strong></p><p>
						
<pre class="programlisting language-yaml">docker:
    access.redhat.com:
        sigstore: https://access.redhat.com/webassets/docker/content/sigstore</pre>

					</p></div><p>
					In this example, the Red Hat Registry, <code class="literal">access.redhat.com</code>, is the signature server that provides signatures for the <code class="literal">docker</code> transport type. Its URI is defined in the <code class="literal">sigstore</code> parameter. You might name this file <code class="literal">/etc/containers/registries.d/redhat.com.yaml</code> and use the Machine Config Operator to automatically place the file on each node in your cluster. No service restart is required since policy and <code class="literal">registries.d</code> files are dynamically loaded by the container runtime.
				</p></section><section class="section" id="security-deploy-secrets_security-deploy"><div class="titlepage"><div><div><h3 class="title">2.9.4. Creating secrets and config maps</h3></div></div></div><p>
					The <code class="literal">Secret</code> object type provides a mechanism to hold sensitive information such as passwords, OpenShift Container Platform client configuration files, <code class="literal">dockercfg</code> files, and private source repository credentials. Secrets decouple sensitive content from pods. You can mount secrets into containers using a volume plugin or the system can use secrets to perform actions on behalf of a pod.
				</p><p>
					For example, to add a secret to your deployment configuration so that it can access a private image repository, do the following:
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform web console.
						</li><li class="listitem">
							Create a new project.
						</li><li class="listitem">
							Navigate to <span class="strong strong"><strong>Resources</strong></span> → <span class="strong strong"><strong>Secrets</strong></span> and create a new secret. Set <code class="literal">Secret Type</code> to <code class="literal">Image Secret</code> and <code class="literal">Authentication Type</code> to <code class="literal">Image Registry Credentials</code> to enter credentials for accessing a private image repository.
						</li><li class="listitem">
							When creating a deployment configuration (for example, from the <span class="strong strong"><strong>Add to Project</strong></span> → <span class="strong strong"><strong>Deploy Image</strong></span> page), set the <code class="literal">Pull Secret</code> to your new secret.
						</li></ol></div><p>
					Config maps are similar to secrets, but are designed to support working with strings that do not contain sensitive information. The <code class="literal">ConfigMap</code> object holds key-value pairs of configuration data that can be consumed in pods or used to store configuration data for system components such as controllers.
				</p></section><section class="section" id="security-deploy-continuous_security-deploy"><div class="titlepage"><div><div><h3 class="title">2.9.5. Automating continuous deployment</h3></div></div></div><p>
					You can integrate your own continuous deployment (CD) tooling with OpenShift Container Platform.
				</p><p>
					By leveraging CI/CD and OpenShift Container Platform, you can automate the process of rebuilding the application to incorporate the latest fixes, testing, and ensuring that it is deployed everywhere within the environment.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#builds-input-secrets-configmaps_creating-build-inputs">Input secrets and config maps</a>
						</li></ul></div></section></section><section class="section" id="security-platform"><div class="titlepage"><div><div><h2 class="title">2.10. Securing the container platform</h2></div></div></div><p>
				OpenShift Container Platform and Kubernetes APIs are key to automating container management at scale. APIs are used to:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Validate and configure the data for pods, services, and replication controllers.
					</li><li class="listitem">
						Perform project validation on incoming requests and invoke triggers on other major system components.
					</li></ul></div><p>
				Security-related features in OpenShift Container Platform that are based on Kubernetes include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Multitenancy, which combines Role-Based Access Controls and network policies to isolate containers at multiple levels.
					</li><li class="listitem">
						Admission plugins, which form boundaries between an API and those making requests to the API.
					</li></ul></div><p>
				OpenShift Container Platform uses Operators to automate and simplify the management of Kubernetes-level security features.
			</p><section class="section" id="security-platform-multi-tenancy_security-platform"><div class="titlepage"><div><div><h3 class="title">2.10.1. Isolating containers with multitenancy</h3></div></div></div><p>
					Multitenancy allows applications on an OpenShift Container Platform cluster that are owned by multiple users, and run across multiple hosts and namespaces, to remain isolated from each other and from outside attacks. You obtain multitenancy by applying role-based access control (RBAC) to Kubernetes namespaces.
				</p><p>
					In Kubernetes, <span class="emphasis"><em>namespaces</em></span> are areas where applications can run in ways that are separate from other applications. OpenShift Container Platform uses and extends namespaces by adding extra annotations, including MCS labeling in SELinux, and identifying these extended namespaces as <span class="emphasis"><em>projects</em></span>. Within the scope of a project, users can maintain their own cluster resources, including service accounts, policies, constraints, and various other objects.
				</p><p>
					RBAC objects are assigned to projects to authorize selected users to have access to those projects. That authorization takes the form of rules, roles, and bindings:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Rules define what a user can create or access in a project.
						</li><li class="listitem">
							Roles are collections of rules that you can bind to selected users or groups.
						</li><li class="listitem">
							Bindings define the association between users or groups and roles.
						</li></ul></div><p>
					Local RBAC roles and bindings attach a user or group to a particular project. Cluster RBAC can attach cluster-wide roles and bindings to all projects in a cluster. There are default cluster roles that can be assigned to provide <code class="literal">admin</code>, <code class="literal">basic-user</code>, <code class="literal">cluster-admin</code>, and <code class="literal">cluster-status</code> access.
				</p></section><section class="section" id="security-platform-admission_security-platform"><div class="titlepage"><div><div><h3 class="title">2.10.2. Protecting control plane with admission plugins</h3></div></div></div><p>
					While RBAC controls access rules between users and groups and available projects, <span class="emphasis"><em>admission plugins</em></span> define access to the OpenShift Container Platform master API. Admission plugins form a chain of rules that consist of:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Default admissions plugins: These implement a default set of policies and resources limits that are applied to components of the OpenShift Container Platform control plane.
						</li><li class="listitem">
							Mutating admission plugins: These plugins dynamically extend the admission chain. They call out to a webhook server and can both authenticate a request and modify the selected resource.
						</li><li class="listitem">
							Validating admission plugins: These validate requests for a selected resource and can both validate the request and ensure that the resource does not change again.
						</li></ul></div><p>
					API requests go through admissions plugins in a chain, with any failure along the way causing the request to be rejected. Each admission plugin is associated with particular resources and only responds to requests for those resources.
				</p><section class="section" id="security-deployment-sccs_security-platform"><div class="titlepage"><div><div><h4 class="title">2.10.2.1. Security context constraints (SCCs)</h4></div></div></div><p>
						You can use <span class="emphasis"><em>security context constraints</em></span> (SCCs) to define a set of conditions that a pod must run with to be accepted into the system.
					</p><p>
						Some aspects that can be managed by SCCs include:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Running of privileged containers
							</li><li class="listitem">
								Capabilities a container can request to be added
							</li><li class="listitem">
								Use of host directories as volumes
							</li><li class="listitem">
								SELinux context of the container
							</li><li class="listitem">
								Container user ID
							</li></ul></div><p>
						If you have the required permissions, you can adjust the default SCC policies to be more permissive, if required.
					</p></section><section class="section" id="security-service-account_security-platform"><div class="titlepage"><div><div><h4 class="title">2.10.2.2. Granting roles to service accounts</h4></div></div></div><p>
						You can assign roles to service accounts, in the same way that users are assigned role-based access. There are three default service accounts created for each project. A service account:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								is limited in scope to a particular project
							</li><li class="listitem">
								derives its name from its project
							</li><li class="listitem">
								is automatically assigned an API token and credentials to access the OpenShift Container Registry
							</li></ul></div><p>
						Service accounts associated with platform components automatically have their keys rotated.
					</p></section></section><section class="section" id="security-platform-authentication_security-platform"><div class="titlepage"><div><div><h3 class="title">2.10.3. Authentication and authorization</h3></div></div></div><section class="section" id="security-platform-auth-controlling-access_security-platform"><div class="titlepage"><div><div><h4 class="title">2.10.3.1. Controlling access using OAuth</h4></div></div></div><p>
						You can use API access control via authentication and authorization for securing your container platform. The OpenShift Container Platform master includes a built-in OAuth server. Users can obtain OAuth access tokens to authenticate themselves to the API.
					</p><p>
						As an administrator, you can configure OAuth to authenticate using an <span class="emphasis"><em>identity provider</em></span>, such as LDAP, GitHub, or Google. The identity provider is used by default for new OpenShift Container Platform deployments, but you can configure this at initial installation time or post-installation.
					</p></section><section class="section" id="security-platform-api-access-control_security-platform"><div class="titlepage"><div><div><h4 class="title">2.10.3.2. API access control and management</h4></div></div></div><p>
						Applications can have multiple, independent API services which have different endpoints that require management. OpenShift Container Platform includes a containerized version of the 3scale API gateway so that you can manage your APIs and control access.
					</p><p>
						3scale gives you a variety of standard options for API authentication and security, which can be used alone or in combination to issue credentials and control access: standard API keys, application ID and key pair, and OAuth 2.0.
					</p><p>
						You can restrict access to specific endpoints, methods, and services and apply access policy for groups of users. Application plans allow you to set rate limits for API usage and control traffic flow for groups of developers.
					</p><p>
						For a tutorial on using APIcast v2, the containerized 3scale API Gateway, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_3scale_api_management/2.0/html/deployment_options/apicast-openshift">Running APIcast on Red Hat OpenShift</a> in the 3scale documentation.
					</p></section><section class="section" id="security-platform-red-hat-sso_security-platform"><div class="titlepage"><div><div><h4 class="title">2.10.3.3. Red Hat Single Sign-On</h4></div></div></div><p>
						The Red Hat Single Sign-On server enables you to secure your applications by providing web single sign-on capabilities based on standards, including SAML 2.0, OpenID Connect, and OAuth 2.0. The server can act as a SAML or OpenID Connect–based identity provider (IdP), mediating with your enterprise user directory or third-party identity provider for identity information and your applications using standards-based tokens. You can integrate Red Hat Single Sign-On with LDAP-based directory services including Microsoft Active Directory and Red Hat Enterprise Linux Identity Management.
					</p></section><section class="section" id="security-platform-auth-secure-self-service-web-console_security-platform"><div class="titlepage"><div><div><h4 class="title">2.10.3.4. Secure self-service web console</h4></div></div></div><p>
						OpenShift Container Platform provides a self-service web console to ensure that teams do not access other environments without authorization. OpenShift Container Platform ensures a secure multitenant master by providing the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Access to the master uses Transport Layer Security (TLS)
							</li><li class="listitem">
								Access to the API Server uses X.509 certificates or OAuth access tokens
							</li><li class="listitem">
								Project quota limits the damage that a rogue token could do
							</li><li class="listitem">
								The etcd service is not exposed directly to the cluster
							</li></ul></div></section></section><section class="section" id="security-platform-certificates_security-platform"><div class="titlepage"><div><div><h3 class="title">2.10.4. Managing certificates for the platform</h3></div></div></div><p>
					OpenShift Container Platform has multiple components within its framework that use REST-based HTTPS communication leveraging encryption via TLS certificates. OpenShift Container Platform’s installer configures these certificates during installation. There are some primary components that generate this traffic:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							masters (API server and controllers)
						</li><li class="listitem">
							etcd
						</li><li class="listitem">
							nodes
						</li><li class="listitem">
							registry
						</li><li class="listitem">
							router
						</li></ul></div><section class="section" id="security-platform-config-custom-certs_security-platform"><div class="titlepage"><div><div><h4 class="title">2.10.4.1. Configuring custom certificates</h4></div></div></div><p>
						You can configure custom serving certificates for the public hostnames of the API server and web console during initial installation or when redeploying certificates. You can also use a custom CA.
					</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/architecture/#architecture-platform-introduction_architecture">Introduction to OpenShift Container Platform</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#using-rbac">Using RBAC to define and apply permissions</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/architecture/#admission-plug-ins">About admission plugins</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#managing-pod-security-policies">Managing security context constraints</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#security-context-constraints-command-reference_configuring-internal-oauth">SCC reference commands</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#service-accounts-granting-roles_understanding-service-accounts">Examples of granting roles to service accounts</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#configuring-internal-oauth">Configuring the internal OAuth server</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#understanding-identity-provider">Understanding identity provider configuration</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-types-user-provided-certificates-for-the-api-server">Certificate types and descriptions</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-types-proxy-certificates">Proxy certificates</a>
							</li></ul></div></section></section></section><section class="section" id="security-network"><div class="titlepage"><div><div><h2 class="title">2.11. Securing networks</h2></div></div></div><p>
				Network security can be managed at several levels. At the pod level, network namespaces can prevent containers from seeing other pods or the host system by restricting network access. Network policies give you control over allowing and rejecting connections. You can manage ingress and egress traffic to and from your containerized applications.
			</p><section class="section" id="security-network-namespaces_security-network"><div class="titlepage"><div><div><h3 class="title">2.11.1. Using network namespaces</h3></div></div></div><p>
					OpenShift Container Platform uses software-defined networking (SDN) to provide a unified cluster network that enables communication between containers across the cluster.
				</p><p>
					Network policy mode, by default, makes all pods in a project accessible from other pods and network endpoints. To isolate one or more pods in a project, you can create <code class="literal">NetworkPolicy</code> objects in that project to indicate the allowed incoming connections. Using multitenant mode, you can provide project-level isolation for pods and services.
				</p></section><section class="section" id="security-network-policies_security-network"><div class="titlepage"><div><div><h3 class="title">2.11.2. Isolating pods with network policies</h3></div></div></div><p>
					Using <span class="emphasis"><em>network policies</em></span>, you can isolate pods from each other in the same project. Network policies can deny all network access to a pod, only allow connections for the Ingress Controller, reject connections from pods in other projects, or set similar rules for how networks behave.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#about-network-policy">About network policy</a>
						</li></ul></div></section><section class="section" id="security-network-multiple-pod_security-network"><div class="titlepage"><div><div><h3 class="title">2.11.3. Using multiple pod networks</h3></div></div></div><p>
					Each running container has only one network interface by default. The Multus CNI plugin lets you create multiple CNI networks, and then attach any of those networks to your pods. In that way, you can do things like separate private data onto a more restricted network and have multiple network interfaces on each node.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#understanding-multiple-networks">Using multiple networks</a>
						</li></ul></div></section><section class="section" id="security-network-isolating_security-network"><div class="titlepage"><div><div><h3 class="title">2.11.4. Isolating applications</h3></div></div></div><p>
					OpenShift Container Platform enables you to segment network traffic on a single cluster to make multitenant clusters that isolate users, teams, applications, and environments from non-global resources.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#configuring-multitenant-isolation">Configuring network isolation using OpenShiftSDN</a>
						</li></ul></div></section><section class="section" id="security-network-ingress_security-network"><div class="titlepage"><div><div><h3 class="title">2.11.5. Securing ingress traffic</h3></div></div></div><p>
					There are many security implications related to how you configure access to your Kubernetes services from outside of your OpenShift Container Platform cluster. Besides exposing HTTP and HTTPS routes, ingress routing allows you to set up NodePort or LoadBalancer ingress types. NodePort exposes an application’s service API object from each cluster worker. LoadBalancer lets you assign an external load balancer to an associated service API object in your OpenShift Container Platform cluster.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#configuring-ingress-cluster-traffic-ingress-controller">Configuring ingress cluster traffic</a>
						</li></ul></div></section><section class="section" id="security-network-egress_security-network"><div class="titlepage"><div><div><h3 class="title">2.11.6. Securing egress traffic</h3></div></div></div><p>
					OpenShift Container Platform provides the ability to control egress traffic using either a router or firewall method. For example, you can use IP whitelisting to control database access. A cluster administrator can assign one or more egress IP addresses to a project in an OpenShift Container Platform SDN network provider. Likewise, a cluster administrator can prevent egress traffic from going outside of an OpenShift Container Platform cluster using an egress firewall.
				</p><p>
					By assigning a fixed egress IP address, you can have all outgoing traffic assigned to that IP address for a particular project. With the egress firewall, you can prevent a pod from connecting to an external network, prevent a pod from connecting to an internal network, or limit a pod’s access to specific internal subnets.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#configuring-egress-firewall">Configuring an egress firewall to control access to external IP addresses</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#assigning-egress-ips">Configuring egress IPs for a project</a>
						</li></ul></div></section></section><section class="section" id="security-storage"><div class="titlepage"><div><div><h2 class="title">2.12. Securing attached storage</h2></div></div></div><p>
				OpenShift Container Platform supports multiple types of storage, both for on-premise and cloud providers. In particular, OpenShift Container Platform can use storage types that support the Container Storage Interface.
			</p><section class="section" id="security-network-storage-persistent_security-storage"><div class="titlepage"><div><div><h3 class="title">2.12.1. Persistent volume plugins</h3></div></div></div><p>
					Containers are useful for both stateless and stateful applications. Protecting attached storage is a key element of securing stateful services. Using the Container Storage Interface (CSI), OpenShift Container Platform can incorporate storage from any storage back end that supports the CSI interface.
				</p><p>
					OpenShift Container Platform provides plugins for multiple types of storage, including:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Red Hat OpenShift Data Foundation *
						</li><li class="listitem">
							AWS Elastic Block Stores (EBS) *
						</li><li class="listitem">
							AWS Elastic File System (EFS) *
						</li><li class="listitem">
							Azure Disk *
						</li><li class="listitem">
							Azure File *
						</li><li class="listitem">
							OpenStack Cinder *
						</li><li class="listitem">
							GCE Persistent Disks *
						</li><li class="listitem">
							VMware vSphere *
						</li><li class="listitem">
							Network File System (NFS)
						</li><li class="listitem">
							FlexVolume
						</li><li class="listitem">
							Fibre Channel
						</li><li class="listitem">
							iSCSI
						</li></ul></div><p>
					Plugins for those storage types with dynamic provisioning are marked with an asterisk (*). Data in transit is encrypted via HTTPS for all OpenShift Container Platform components communicating with each other.
				</p><p>
					You can mount a persistent volume (PV) on a host in any way supported by your storage type. Different types of storage have different capabilities and each PV’s access modes are set to the specific modes supported by that particular volume.
				</p><p>
					For example, NFS can support multiple read/write clients, but a specific NFS PV might be exported on the server as read-only. Each PV has its own set of access modes describing that specific PV’s capabilities, such as <code class="literal">ReadWriteOnce</code>, <code class="literal">ReadOnlyMany</code>, and <code class="literal">ReadWriteMany</code>.
				</p></section><section class="section" id="security-network-storage-shared_security-storage"><div class="titlepage"><div><div><h3 class="title">2.12.2. Shared storage</h3></div></div></div><p>
					For shared storage providers like NFS, the PV registers its group ID (GID) as an annotation on the PV resource. Then, when the PV is claimed by the pod, the annotated GID is added to the supplemental groups of the pod, giving that pod access to the contents of the shared storage.
				</p></section><section class="section" id="security-network-storage-block_security-storage"><div class="titlepage"><div><div><h3 class="title">2.12.3. Block storage</h3></div></div></div><p>
					For block storage providers like AWS Elastic Block Store (EBS), GCE Persistent Disks, and iSCSI, OpenShift Container Platform uses SELinux capabilities to secure the root of the mounted volume for non-privileged pods, making the mounted volume owned by and only visible to the container with which it is associated.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/storage/#understanding-persistent-storage">Understanding persistent storage</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/storage/#persistent-storage-using-csi">Configuring CSI volumes</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/storage/#dynamic-provisioning">Dynamic provisioning</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/storage/#persistent-storage-using-nfs">Persistent storage using NFS</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/storage/#persistent-storage-using-aws-ebs">Persistent storage using AWS Elastic Block Store</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/storage/#persistent-storage-using-gce">Persistent storage using GCE Persistent Disk</a>
						</li></ul></div></section></section><section class="section" id="security-monitoring"><div class="titlepage"><div><div><h2 class="title">2.13. Monitoring cluster events and logs</h2></div></div></div><p>
				The ability to monitor and audit an OpenShift Container Platform cluster is an important part of safeguarding the cluster and its users against inappropriate usage.
			</p><p>
				There are two main sources of cluster-level information that are useful for this purpose: events and logging.
			</p><section class="section" id="security-monitoring-events_security-monitoring"><div class="titlepage"><div><div><h3 class="title">2.13.1. Watching cluster events</h3></div></div></div><p>
					Cluster administrators are encouraged to familiarize themselves with the <code class="literal">Event</code> resource type and review the list of system events to determine which events are of interest. Events are associated with a namespace, either the namespace of the resource they are related to or, for cluster events, the <code class="literal">default</code> namespace. The default namespace holds relevant events for monitoring or auditing a cluster, such as node events and resource events related to infrastructure components.
				</p><p>
					The master API and <code class="literal">oc</code> command do not provide parameters to scope a listing of events to only those related to nodes. A simple approach would be to use <code class="literal">grep</code>:
				</p><pre class="programlisting language-terminal">$ oc get event -n default | grep Node</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">1h         20h         3         origin-node-1.example.local   Node      Normal    NodeHasDiskPressure   ...</pre>

					</p></div><p>
					A more flexible approach is to output the events in a form that other tools can process. For example, the following example uses the <code class="literal">jq</code> tool against JSON output to extract only <code class="literal">NodeHasDiskPressure</code> events:
				</p><pre class="programlisting language-terminal">$ oc get events -n default -o json \
  | jq '.items[] | select(.involvedObject.kind == "Node" and .reason == "NodeHasDiskPressure")'</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">{
  "apiVersion": "v1",
  "count": 3,
  "involvedObject": {
    "kind": "Node",
    "name": "origin-node-1.example.local",
    "uid": "origin-node-1.example.local"
  },
  "kind": "Event",
  "reason": "NodeHasDiskPressure",
  ...
}</pre>

					</p></div><p>
					Events related to resource creation, modification, or deletion can also be good candidates for detecting misuse of the cluster. The following query, for example, can be used to look for excessive pulling of images:
				</p><pre class="programlisting language-terminal">$ oc get events --all-namespaces -o json \
  | jq '[.items[] | select(.involvedObject.kind == "Pod" and .reason == "Pulling")] | length'</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">4</pre>

					</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						When a namespace is deleted, its events are deleted as well. Events can also expire and are deleted to prevent filling up etcd storage. Events are not stored as a permanent record and frequent polling is necessary to capture statistics over time.
					</p></div></div></section><section class="section" id="security-monitoring-cluster-logging_security-monitoring"><div class="titlepage"><div><div><h3 class="title">2.13.2. Logging</h3></div></div></div><p>
					Using the <code class="literal">oc log</code> command, you can view container logs, build configs and deployments in real time. Different can users have access different access to logs:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Users who have access to a project are able to see the logs for that project by default.
						</li><li class="listitem">
							Users with admin roles can access all container logs.
						</li></ul></div><p>
					To save your logs for further audit and analysis, you can enable the <code class="literal">cluster-logging</code> add-on feature to collect, manage, and view system, container, and audit logs. You can deploy, manage, and upgrade OpenShift Logging through the OpenShift Elasticsearch Operator and Red Hat OpenShift Logging Operator.
				</p></section><section class="section" id="security-monitoring-audit-logs_security-monitoring"><div class="titlepage"><div><div><h3 class="title">2.13.3. Audit logs</h3></div></div></div><p>
					With <span class="emphasis"><em>audit logs</em></span>, you can follow a sequence of activities associated with how a user, administrator, or other OpenShift Container Platform component is behaving. API audit logging is done on each server.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-containers-events">List of system events</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/logging/#cluster-logging">Understanding OpenShift Logging</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#audit-log-view">Viewing audit logs</a>
						</li></ul></div></section></section></section><section class="chapter" id="configuring-certificates"><div class="titlepage"><div><div><h1 class="title">Chapter 3. Configuring certificates</h1></div></div></div><section class="section" id="replacing-default-ingress"><div class="titlepage"><div><div><h2 class="title">3.1. Replacing the default ingress certificate</h2></div></div></div><section class="section" id="understanding-default-ingress_replacing-default-ingress"><div class="titlepage"><div><div><h3 class="title">3.1.1. Understanding the default ingress certificate</h3></div></div></div><p>
					By default, OpenShift Container Platform uses the Ingress Operator to create an internal CA and issue a wildcard certificate that is valid for applications under the <code class="literal">.apps</code> sub-domain. Both the web console and CLI use this certificate as well.
				</p><p>
					The internal infrastructure CA certificates are self-signed. While this process might be perceived as bad practice by some security or PKI teams, any risk here is minimal. The only clients that implicitly trust these certificates are other components within the cluster. Replacing the default wildcard certificate with one that is issued by a public CA already included in the CA bundle as provided by the container userspace allows external clients to connect securely to applications running under the <code class="literal">.apps</code> sub-domain.
				</p></section><section class="section" id="replacing-default-ingress_replacing-default-ingress"><div class="titlepage"><div><div><h3 class="title">3.1.2. Replacing the default ingress certificate</h3></div></div></div><p>
					You can replace the default ingress certificate for all applications under the <code class="literal">.apps</code> subdomain. After you replace the certificate, all applications, including the web console and CLI, will have encryption provided by specified certificate.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You must have a wildcard certificate for the fully qualified <code class="literal">.apps</code> subdomain and its corresponding private key. Each should be in a separate PEM format file.
						</li><li class="listitem">
							The private key must be unencrypted. If your key is encrypted, decrypt it before importing it into OpenShift Container Platform.
						</li><li class="listitem">
							The certificate must include the <code class="literal">subjectAltName</code> extension showing <code class="literal">*.apps.&lt;clustername&gt;.&lt;domain&gt;</code>.
						</li><li class="listitem">
							The certificate file can contain one or more certificates in a chain. The wildcard certificate must be the first certificate in the file. It can then be followed with any intermediate certificates, and the file should end with the root CA certificate.
						</li><li class="listitem">
							Copy the root CA certificate into an additional PEM format file.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a config map that includes only the root CA certificate used to sign the wildcard certificate:
						</p><pre class="programlisting language-terminal">$ oc create configmap custom-ca \
     --from-file=ca-bundle.crt=&lt;/path/to/example-ca.crt&gt; \<span id="CO3-1"><!--Empty--></span><span class="callout">1</span>
     -n openshift-config</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO3-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									<code class="literal">&lt;/path/to/example-ca.crt&gt;</code> is the path to the root CA certificate file on your local file system.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Update the cluster-wide proxy configuration with the newly created config map:
						</p><pre class="programlisting language-terminal">$ oc patch proxy/cluster \
     --type=merge \
     --patch='{"spec":{"trustedCA":{"name":"custom-ca"}}}'</pre></li><li class="listitem"><p class="simpara">
							Create a secret that contains the wildcard certificate chain and key:
						</p><pre class="programlisting language-terminal">$ oc create secret tls &lt;secret&gt; \<span id="CO4-1"><!--Empty--></span><span class="callout">1</span>
     --cert=&lt;/path/to/cert.crt&gt; \<span id="CO4-2"><!--Empty--></span><span class="callout">2</span>
     --key=&lt;/path/to/cert.key&gt; \<span id="CO4-3"><!--Empty--></span><span class="callout">3</span>
     -n openshift-ingress</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO4-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									<code class="literal">&lt;secret&gt;</code> is the name of the secret that will contain the certificate chain and private key.
								</div></dd><dt><a href="#CO4-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									<code class="literal">&lt;/path/to/cert.crt&gt;</code> is the path to the certificate chain on your local file system.
								</div></dd><dt><a href="#CO4-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									<code class="literal">&lt;/path/to/cert.key&gt;</code> is the path to the private key associated with this certificate.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Update the Ingress Controller configuration with the newly created secret:
						</p><pre class="programlisting language-terminal">$ oc patch ingresscontroller.operator default \
     --type=merge -p \
     '{"spec":{"defaultCertificate": {"name": "&lt;secret&gt;"}}}' \<span id="CO5-1"><!--Empty--></span><span class="callout">1</span>
     -n openshift-ingress-operator</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO5-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Replace <code class="literal">&lt;secret&gt;</code> with the name used for the secret in the previous step.
								</div></dd></dl></div></li></ol></div><h4 id="additional-resources">Additional resources</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#ca-bundle-understanding_updating-ca-bundle">Replacing the CA Bundle certificate</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#customization">Proxy certificate customization</a>
						</li></ul></div></section></section><section class="section" id="api-server-certificates"><div class="titlepage"><div><div><h2 class="title">3.2. Adding API server certificates</h2></div></div></div><p>
				The default API server certificate is issued by an internal OpenShift Container Platform cluster CA. Clients outside of the cluster will not be able to verify the API server’s certificate by default. This certificate can be replaced by one that is issued by a CA that clients trust.
			</p><section class="section" id="customize-certificates-api-add-named_api-server-certificates"><div class="titlepage"><div><div><h3 class="title">3.2.1. Add an API server named certificate</h3></div></div></div><p>
					The default API server certificate is issued by an internal OpenShift Container Platform cluster CA. You can add one or more alternative certificates that the API server will return based on the fully qualified domain name (FQDN) requested by the client, for example when a reverse proxy or load balancer is used.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You must have a certificate for the FQDN and its corresponding private key. Each should be in a separate PEM format file.
						</li><li class="listitem">
							The private key must be unencrypted. If your key is encrypted, decrypt it before importing it into OpenShift Container Platform.
						</li><li class="listitem">
							The certificate must include the <code class="literal">subjectAltName</code> extension showing the FQDN.
						</li><li class="listitem">
							The certificate file can contain one or more certificates in a chain. The certificate for the API server FQDN must be the first certificate in the file. It can then be followed with any intermediate certificates, and the file should end with the root CA certificate.
						</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Do not provide a named certificate for the internal load balancer (host name <code class="literal">api-int.&lt;cluster_name&gt;.&lt;base_domain&gt;</code>). Doing so will leave your cluster in a degraded state.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Login to the new API as the <code class="literal">kubeadmin</code> user.
						</p><pre class="programlisting language-terminal">$ oc login -u kubeadmin -p &lt;password&gt; https://FQDN:6443</pre></li><li class="listitem"><p class="simpara">
							Get the <code class="literal">kubeconfig</code> file.
						</p><pre class="programlisting language-terminal">$ oc config view --flatten &gt; kubeconfig-newapi</pre></li><li class="listitem"><p class="simpara">
							Create a secret that contains the certificate chain and private key in the <code class="literal">openshift-config</code> namespace.
						</p><pre class="programlisting language-terminal">$ oc create secret tls &lt;secret&gt; \<span id="CO6-1"><!--Empty--></span><span class="callout">1</span>
     --cert=&lt;/path/to/cert.crt&gt; \<span id="CO6-2"><!--Empty--></span><span class="callout">2</span>
     --key=&lt;/path/to/cert.key&gt; \<span id="CO6-3"><!--Empty--></span><span class="callout">3</span>
     -n openshift-config</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO6-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									<code class="literal">&lt;secret&gt;</code> is the name of the secret that will contain the certificate chain and private key.
								</div></dd><dt><a href="#CO6-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									<code class="literal">&lt;/path/to/cert.crt&gt;</code> is the path to the certificate chain on your local file system.
								</div></dd><dt><a href="#CO6-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									<code class="literal">&lt;/path/to/cert.key&gt;</code> is the path to the private key associated with this certificate.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Update the API server to reference the created secret.
						</p><pre class="programlisting language-terminal">$ oc patch apiserver cluster \
     --type=merge -p \
     '{"spec":{"servingCerts": {"namedCertificates":
     [{"names": ["&lt;FQDN&gt;"], <span id="CO7-1"><!--Empty--></span><span class="callout">1</span>
     "servingCertificate": {"name": "&lt;secret&gt;"}}]}}}' <span id="CO7-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO7-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Replace <code class="literal">&lt;FQDN&gt;</code> with the FQDN that the API server should provide the certificate for.
								</div></dd><dt><a href="#CO7-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Replace <code class="literal">&lt;secret&gt;</code> with the name used for the secret in the previous step.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Examine the <code class="literal">apiserver/cluster</code> object and confirm the secret is now referenced.
						</p><pre class="programlisting language-terminal">$ oc get apiserver cluster -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">...
spec:
  servingCerts:
    namedCertificates:
    - names:
      - &lt;FQDN&gt;
      servingCertificate:
        name: &lt;secret&gt;
...</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Check the <code class="literal">kube-apiserver</code> operator, and verify that a new revision of the Kubernetes API server rolls out. It may take a minute for the operator to detect the configuration change and trigger a new deployment. While the new revision is rolling out, <code class="literal">PROGRESSING</code> will report <code class="literal">True</code>.
						</p><pre class="programlisting language-terminal">$ oc get clusteroperators kube-apiserver</pre><p class="simpara">
							Do not continue to the next step until <code class="literal">PROGRESSING</code> is listed as <code class="literal">False</code>, as shown in the following output:
						</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME             VERSION   AVAILABLE   PROGRESSING   DEGRADED   SINCE
kube-apiserver   4.13.0     True        False         False      145m</pre>

							</p></div><p class="simpara">
							If <code class="literal">PROGRESSING</code> is showing <code class="literal">True</code>, wait a few minutes and try again.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								A new revision of the Kubernetes API server only rolls out if the API server named certificate is added for the first time. When the API server named certificate is renewed, a new revision of the Kubernetes API server does not roll out because the <code class="literal">kube-apiserver</code> pods dynamically reload the updated certificate.
							</p></div></div></li></ol></div></section></section><section class="section" id="add-service-serving"><div class="titlepage"><div><div><h2 class="title">3.3. Securing service traffic using service serving certificate secrets</h2></div></div></div><section class="section" id="understanding-service-serving_service-serving-certificate"><div class="titlepage"><div><div><h3 class="title">3.3.1. Understanding service serving certificates</h3></div></div></div><p>
					Service serving certificates are intended to support complex middleware applications that require encryption. These certificates are issued as TLS web server certificates.
				</p><p>
					The <code class="literal">service-ca</code> controller uses the <code class="literal">x509.SHA256WithRSA</code> signature algorithm to generate service certificates.
				</p><p>
					The generated certificate and key are in PEM format, stored in <code class="literal">tls.crt</code> and <code class="literal">tls.key</code> respectively, within a created secret. The certificate and key are automatically replaced when they get close to expiration.
				</p><p>
					The service CA certificate, which issues the service certificates, is valid for 26 months and is automatically rotated when there is less than 13 months validity left. After rotation, the previous service CA configuration is still trusted until its expiration. This allows a grace period for all affected services to refresh their key material before the expiration. If you do not upgrade your cluster during this grace period, which restarts services and refreshes their key material, you might need to manually restart services to avoid failures after the previous service CA expires.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						You can use the following command to manually restart all pods in the cluster. Be aware that running this command causes a service interruption, because it deletes every running pod in every namespace. These pods will automatically restart after they are deleted.
					</p><pre class="programlisting language-terminal">$ for I in $(oc get ns -o jsonpath='{range .items[*]} {.metadata.name}{"\n"} {end}'); \
      do oc delete pods --all -n $I; \
      sleep 1; \
      done</pre></div></div></section><section class="section" id="add-service-certificate_service-serving-certificate"><div class="titlepage"><div><div><h3 class="title">3.3.2. Add a service certificate</h3></div></div></div><p>
					To secure communication to your service, generate a signed serving certificate and key pair into a secret in the same namespace as the service.
				</p><p>
					The generated certificate is only valid for the internal service DNS name <code class="literal">&lt;service.name&gt;.&lt;service.namespace&gt;.svc</code>, and is only valid for internal communications. If your service is a headless service (no <code class="literal">clusterIP</code> value set), the generated certificate also contains a wildcard subject in the format of <code class="literal">*.&lt;service.name&gt;.&lt;service.namespace&gt;.svc</code>.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Because the generated certificates contain wildcard subjects for headless services, you must not use the service CA if your client must differentiate between individual pods. In this case:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Generate individual TLS certificates by using a different CA.
							</li><li class="listitem">
								Do not accept the service CA as a trusted CA for connections that are directed to individual pods and must not be impersonated by other pods. These connections must be configured to trust the CA that was used to generate the individual TLS certificates.
							</li></ul></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites:</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You must have a service defined.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Annotate the service with <code class="literal">service.beta.openshift.io/serving-cert-secret-name</code>:
						</p><pre class="programlisting language-terminal">$ oc annotate service &lt;service_name&gt; \<span id="CO8-1"><!--Empty--></span><span class="callout">1</span>
     service.beta.openshift.io/serving-cert-secret-name=&lt;secret_name&gt; <span id="CO8-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO8-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Replace <code class="literal">&lt;service_name&gt;</code> with the name of the service to secure.
								</div></dd><dt><a href="#CO8-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									<code class="literal">&lt;secret_name&gt;</code> will be the name of the generated secret containing the certificate and key pair. For convenience, it is recommended that this be the same as <code class="literal">&lt;service_name&gt;</code>.
								</div></dd></dl></div><p class="simpara">
							For example, use the following command to annotate the service <code class="literal">test1</code>:
						</p><pre class="programlisting language-terminal">$ oc annotate service test1 service.beta.openshift.io/serving-cert-secret-name=test1</pre></li><li class="listitem"><p class="simpara">
							Examine the service to confirm that the annotations are present:
						</p><pre class="programlisting language-terminal">$ oc describe service &lt;service_name&gt;</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">...
Annotations:              service.beta.openshift.io/serving-cert-secret-name: &lt;service_name&gt;
                          service.beta.openshift.io/serving-cert-signed-by: openshift-service-serving-signer@1556850837
...</pre>

							</p></div></li><li class="listitem">
							After the cluster generates a secret for your service, your <code class="literal">Pod</code> spec can mount it, and the pod will run after it becomes available.
						</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							You can use a service certificate to configure a secure route using reencrypt TLS termination. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#nw-ingress-creating-a-reencrypt-route-with-a-custom-certificate_secured-routes">Creating a re-encrypt route with a custom certificate</a>.
						</li></ul></div></section><section class="section" id="add-service-certificate-configmap_service-serving-certificate"><div class="titlepage"><div><div><h3 class="title">3.3.3. Add the service CA bundle to a config map</h3></div></div></div><p>
					A pod can access the service CA certificate by mounting a <code class="literal">ConfigMap</code> object that is annotated with <code class="literal">service.beta.openshift.io/inject-cabundle=true</code>. Once annotated, the cluster automatically injects the service CA certificate into the <code class="literal">service-ca.crt</code> key on the config map. Access to this CA certificate allows TLS clients to verify connections to services using service serving certificates.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						After adding this annotation to a config map all existing data in it is deleted. It is recommended to use a separate config map to contain the <code class="literal">service-ca.crt</code>, instead of using the same config map that stores your pod configuration.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Annotate the config map with <code class="literal">service.beta.openshift.io/inject-cabundle=true</code>:
						</p><pre class="programlisting language-terminal">$ oc annotate configmap &lt;config_map_name&gt; \<span id="CO9-1"><!--Empty--></span><span class="callout">1</span>
     service.beta.openshift.io/inject-cabundle=true</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO9-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Replace <code class="literal">&lt;config_map_name&gt;</code> with the name of the config map to annotate.
								</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Explicitly referencing the <code class="literal">service-ca.crt</code> key in a volume mount will prevent a pod from starting until the config map has been injected with the CA bundle. This behavior can be overridden by setting the <code class="literal">optional</code> field to <code class="literal">true</code> for the volume’s serving certificate configuration.
							</p></div></div><p class="simpara">
							For example, use the following command to annotate the config map <code class="literal">test1</code>:
						</p><pre class="programlisting language-terminal">$ oc annotate configmap test1 service.beta.openshift.io/inject-cabundle=true</pre></li><li class="listitem"><p class="simpara">
							View the config map to ensure that the service CA bundle has been injected:
						</p><pre class="programlisting language-terminal">$ oc get configmap &lt;config_map_name&gt; -o yaml</pre><p class="simpara">
							The CA bundle is displayed as the value of the <code class="literal">service-ca.crt</code> key in the YAML output:
						</p><pre class="programlisting language-terminal">apiVersion: v1
data:
  service-ca.crt: |
    -----BEGIN CERTIFICATE-----
...</pre></li></ol></div></section><section class="section" id="add-service-certificate-apiservice_service-serving-certificate"><div class="titlepage"><div><div><h3 class="title">3.3.4. Add the service CA bundle to an API service</h3></div></div></div><p>
					You can annotate an <code class="literal">APIService</code> object with <code class="literal">service.beta.openshift.io/inject-cabundle=true</code> to have its <code class="literal">spec.caBundle</code> field populated with the service CA bundle. This allows the Kubernetes API server to validate the service CA certificate used to secure the targeted endpoint.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Annotate the API service with <code class="literal">service.beta.openshift.io/inject-cabundle=true</code>:
						</p><pre class="programlisting language-terminal">$ oc annotate apiservice &lt;api_service_name&gt; \<span id="CO10-1"><!--Empty--></span><span class="callout">1</span>
     service.beta.openshift.io/inject-cabundle=true</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO10-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Replace <code class="literal">&lt;api_service_name&gt;</code> with the name of the API service to annotate.
								</div></dd></dl></div><p class="simpara">
							For example, use the following command to annotate the API service <code class="literal">test1</code>:
						</p><pre class="programlisting language-terminal">$ oc annotate apiservice test1 service.beta.openshift.io/inject-cabundle=true</pre></li><li class="listitem"><p class="simpara">
							View the API service to ensure that the service CA bundle has been injected:
						</p><pre class="programlisting language-terminal">$ oc get apiservice &lt;api_service_name&gt; -o yaml</pre><p class="simpara">
							The CA bundle is displayed in the <code class="literal">spec.caBundle</code> field in the YAML output:
						</p><pre class="programlisting language-terminal">apiVersion: apiregistration.k8s.io/v1
kind: APIService
metadata:
  annotations:
    service.beta.openshift.io/inject-cabundle: "true"
...
spec:
  caBundle: &lt;CA_BUNDLE&gt;
...</pre></li></ol></div></section><section class="section" id="add-service-certificate-crd_service-serving-certificate"><div class="titlepage"><div><div><h3 class="title">3.3.5. Add the service CA bundle to a custom resource definition</h3></div></div></div><p>
					You can annotate a <code class="literal">CustomResourceDefinition</code> (CRD) object with <code class="literal">service.beta.openshift.io/inject-cabundle=true</code> to have its <code class="literal">spec.conversion.webhook.clientConfig.caBundle</code> field populated with the service CA bundle. This allows the Kubernetes API server to validate the service CA certificate used to secure the targeted endpoint.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The service CA bundle will only be injected into the CRD if the CRD is configured to use a webhook for conversion. It is only useful to inject the service CA bundle if a CRD’s webhook is secured with a service CA certificate.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Annotate the CRD with <code class="literal">service.beta.openshift.io/inject-cabundle=true</code>:
						</p><pre class="programlisting language-terminal">$ oc annotate crd &lt;crd_name&gt; \<span id="CO11-1"><!--Empty--></span><span class="callout">1</span>
     service.beta.openshift.io/inject-cabundle=true</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO11-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Replace <code class="literal">&lt;crd_name&gt;</code> with the name of the CRD to annotate.
								</div></dd></dl></div><p class="simpara">
							For example, use the following command to annotate the CRD <code class="literal">test1</code>:
						</p><pre class="programlisting language-terminal">$ oc annotate crd test1 service.beta.openshift.io/inject-cabundle=true</pre></li><li class="listitem"><p class="simpara">
							View the CRD to ensure that the service CA bundle has been injected:
						</p><pre class="programlisting language-terminal">$ oc get crd &lt;crd_name&gt; -o yaml</pre><p class="simpara">
							The CA bundle is displayed in the <code class="literal">spec.conversion.webhook.clientConfig.caBundle</code> field in the YAML output:
						</p><pre class="programlisting language-terminal">apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    service.beta.openshift.io/inject-cabundle: "true"
...
spec:
  conversion:
    strategy: Webhook
    webhook:
      clientConfig:
        caBundle: &lt;CA_BUNDLE&gt;
...</pre></li></ol></div></section><section class="section" id="add-service-certificate-mutating-webhook_service-serving-certificate"><div class="titlepage"><div><div><h3 class="title">3.3.6. Add the service CA bundle to a mutating webhook configuration</h3></div></div></div><p>
					You can annotate a <code class="literal">MutatingWebhookConfiguration</code> object with <code class="literal">service.beta.openshift.io/inject-cabundle=true</code> to have the <code class="literal">clientConfig.caBundle</code> field of each webhook populated with the service CA bundle. This allows the Kubernetes API server to validate the service CA certificate used to secure the targeted endpoint.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Do not set this annotation for admission webhook configurations that need to specify different CA bundles for different webhooks. If you do, then the service CA bundle will be injected for all webhooks.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Annotate the mutating webhook configuration with <code class="literal">service.beta.openshift.io/inject-cabundle=true</code>:
						</p><pre class="programlisting language-terminal">$ oc annotate mutatingwebhookconfigurations &lt;mutating_webhook_name&gt; \<span id="CO12-1"><!--Empty--></span><span class="callout">1</span>
     service.beta.openshift.io/inject-cabundle=true</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO12-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Replace <code class="literal">&lt;mutating_webhook_name&gt;</code> with the name of the mutating webhook configuration to annotate.
								</div></dd></dl></div><p class="simpara">
							For example, use the following command to annotate the mutating webhook configuration <code class="literal">test1</code>:
						</p><pre class="programlisting language-terminal">$ oc annotate mutatingwebhookconfigurations test1 service.beta.openshift.io/inject-cabundle=true</pre></li><li class="listitem"><p class="simpara">
							View the mutating webhook configuration to ensure that the service CA bundle has been injected:
						</p><pre class="programlisting language-terminal">$ oc get mutatingwebhookconfigurations &lt;mutating_webhook_name&gt; -o yaml</pre><p class="simpara">
							The CA bundle is displayed in the <code class="literal">clientConfig.caBundle</code> field of all webhooks in the YAML output:
						</p><pre class="programlisting language-terminal">apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  annotations:
    service.beta.openshift.io/inject-cabundle: "true"
...
webhooks:
- myWebhook:
  - v1beta1
  clientConfig:
    caBundle: &lt;CA_BUNDLE&gt;
...</pre></li></ol></div></section><section class="section" id="add-service-certificate-validating-webhook_service-serving-certificate"><div class="titlepage"><div><div><h3 class="title">3.3.7. Add the service CA bundle to a validating webhook configuration</h3></div></div></div><p>
					You can annotate a <code class="literal">ValidatingWebhookConfiguration</code> object with <code class="literal">service.beta.openshift.io/inject-cabundle=true</code> to have the <code class="literal">clientConfig.caBundle</code> field of each webhook populated with the service CA bundle. This allows the Kubernetes API server to validate the service CA certificate used to secure the targeted endpoint.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Do not set this annotation for admission webhook configurations that need to specify different CA bundles for different webhooks. If you do, then the service CA bundle will be injected for all webhooks.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Annotate the validating webhook configuration with <code class="literal">service.beta.openshift.io/inject-cabundle=true</code>:
						</p><pre class="programlisting language-terminal">$ oc annotate validatingwebhookconfigurations &lt;validating_webhook_name&gt; \<span id="CO13-1"><!--Empty--></span><span class="callout">1</span>
     service.beta.openshift.io/inject-cabundle=true</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO13-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Replace <code class="literal">&lt;validating_webhook_name&gt;</code> with the name of the validating webhook configuration to annotate.
								</div></dd></dl></div><p class="simpara">
							For example, use the following command to annotate the validating webhook configuration <code class="literal">test1</code>:
						</p><pre class="programlisting language-terminal">$ oc annotate validatingwebhookconfigurations test1 service.beta.openshift.io/inject-cabundle=true</pre></li><li class="listitem"><p class="simpara">
							View the validating webhook configuration to ensure that the service CA bundle has been injected:
						</p><pre class="programlisting language-terminal">$ oc get validatingwebhookconfigurations &lt;validating_webhook_name&gt; -o yaml</pre><p class="simpara">
							The CA bundle is displayed in the <code class="literal">clientConfig.caBundle</code> field of all webhooks in the YAML output:
						</p><pre class="programlisting language-terminal">apiVersion: admissionregistration.k8s.io/v1
kind: ValidatingWebhookConfiguration
metadata:
  annotations:
    service.beta.openshift.io/inject-cabundle: "true"
...
webhooks:
- myWebhook:
  - v1beta1
  clientConfig:
    caBundle: &lt;CA_BUNDLE&gt;
...</pre></li></ol></div></section><section class="section" id="rotate-service-serving_service-serving-certificate"><div class="titlepage"><div><div><h3 class="title">3.3.8. Manually rotate the generated service certificate</h3></div></div></div><p>
					You can rotate the service certificate by deleting the associated secret. Deleting the secret results in a new one being automatically created, resulting in a new certificate.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							A secret containing the certificate and key pair must have been generated for the service.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Examine the service to determine the secret containing the certificate. This is found in the <code class="literal">serving-cert-secret-name</code> annotation, as seen below.
						</p><pre class="programlisting language-terminal">$ oc describe service &lt;service_name&gt;</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">...
service.beta.openshift.io/serving-cert-secret-name: &lt;secret&gt;
...</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Delete the generated secret for the service. This process will automatically recreate the secret.
						</p><pre class="programlisting language-terminal">$ oc delete secret &lt;secret&gt; <span id="CO14-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO14-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Replace <code class="literal">&lt;secret&gt;</code> with the name of the secret from the previous step.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Confirm that the certificate has been recreated by obtaining the new secret and examining the <code class="literal">AGE</code>.
						</p><pre class="programlisting language-terminal">$ oc get secret &lt;service_name&gt;</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME              TYPE                DATA   AGE
&lt;service.name&gt;    kubernetes.io/tls   2      1s</pre>

							</p></div></li></ol></div></section><section class="section" id="manually-rotate-service-ca_service-serving-certificate"><div class="titlepage"><div><div><h3 class="title">3.3.9. Manually rotate the service CA certificate</h3></div></div></div><p>
					The service CA is valid for 26 months and is automatically refreshed when there is less than 13 months validity left.
				</p><p>
					If necessary, you can manually refresh the service CA by using the following procedure.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						A manually-rotated service CA does not maintain trust with the previous service CA. You might experience a temporary service disruption until the pods in the cluster are restarted, which ensures that pods are using service serving certificates issued by the new service CA.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You must be logged in as a cluster admin.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							View the expiration date of the current service CA certificate by using the following command.
						</p><pre class="programlisting language-terminal">$ oc get secrets/signing-key -n openshift-service-ca \
     -o template='{{index .data "tls.crt"}}' \
     | base64 --decode \
     | openssl x509 -noout -enddate</pre></li><li class="listitem"><p class="simpara">
							Manually rotate the service CA. This process generates a new service CA which will be used to sign the new service certificates.
						</p><pre class="programlisting language-terminal">$ oc delete secret/signing-key -n openshift-service-ca</pre></li><li class="listitem"><p class="simpara">
							To apply the new certificates to all services, restart all the pods in your cluster. This command ensures that all services use the updated certificates.
						</p><pre class="programlisting language-terminal">$ for I in $(oc get ns -o jsonpath='{range .items[*]} {.metadata.name}{"\n"} {end}'); \
      do oc delete pods --all -n $I; \
      sleep 1; \
      done</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								This command will cause a service interruption, as it goes through and deletes every running pod in every namespace. These pods will automatically restart after they are deleted.
							</p></div></div></li></ol></div></section></section><section class="section" id="updating-ca-bundle"><div class="titlepage"><div><div><h2 class="title">3.4. Updating the CA bundle</h2></div></div></div><section class="section" id="ca-bundle-understanding_updating-ca-bundle"><div class="titlepage"><div><div><h3 class="title">3.4.1. Understanding the CA Bundle certificate</h3></div></div></div><p>
					Proxy certificates allow users to specify one or more custom certificate authority (CA) used by platform components when making egress connections.
				</p><p>
					The <code class="literal">trustedCA</code> field of the Proxy object is a reference to a config map that contains a user-provided trusted certificate authority (CA) bundle. This bundle is merged with the Red Hat Enterprise Linux CoreOS (RHCOS) trust bundle and injected into the trust store of platform components that make egress HTTPS calls. For example, <code class="literal">image-registry-operator</code> calls an external image registry to download images. If <code class="literal">trustedCA</code> is not specified, only the RHCOS trust bundle is used for proxied HTTPS connections. Provide custom CA certificates to the RHCOS trust bundle if you want to use your own certificate infrastructure.
				</p><p>
					The <code class="literal">trustedCA</code> field should only be consumed by a proxy validator. The validator is responsible for reading the certificate bundle from required key <code class="literal">ca-bundle.crt</code> and copying it to a config map named <code class="literal">trusted-ca-bundle</code> in the <code class="literal">openshift-config-managed</code> namespace. The namespace for the config map referenced by <code class="literal">trustedCA</code> is <code class="literal">openshift-config</code>:
				</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-ca-bundle
  namespace: openshift-config
data:
  ca-bundle.crt: |
    -----BEGIN CERTIFICATE-----
    Custom CA certificate bundle.
    -----END CERTIFICATE-----</pre></section><section class="section" id="ca-bundle-replacing_updating-ca-bundle"><div class="titlepage"><div><div><h3 class="title">3.4.2. Replacing the CA Bundle certificate</h3></div></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a config map that includes the root CA certificate used to sign the wildcard certificate:
						</p><pre class="programlisting language-terminal">$ oc create configmap custom-ca \
     --from-file=ca-bundle.crt=&lt;/path/to/example-ca.crt&gt; \<span id="CO15-1"><!--Empty--></span><span class="callout">1</span>
     -n openshift-config</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO15-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									<code class="literal">&lt;/path/to/example-ca.crt&gt;</code> is the path to the CA certificate bundle on your local file system.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Update the cluster-wide proxy configuration with the newly created config map:
						</p><pre class="programlisting language-terminal">$ oc patch proxy/cluster \
     --type=merge \
     --patch='{"spec":{"trustedCA":{"name":"custom-ca"}}}'</pre></li></ol></div><h4 id="additional-resources-2">Additional resources</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#replacing-default-ingress_replacing-default-ingress">Replacing the default ingress certificate</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#nw-proxy-configure-object_config-cluster-wide-proxy">Enabling the cluster-wide proxy</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#customization">Proxy certificate customization</a>
						</li></ul></div></section></section></section><section class="chapter" id="certificate-types-and-descriptions"><div class="titlepage"><div><div><h1 class="title">Chapter 4. Certificate types and descriptions</h1></div></div></div><section class="section" id="cert-types-user-provided-certificates-for-the-api-server"><div class="titlepage"><div><div><h2 class="title">4.1. User-provided certificates for the API server</h2></div></div></div><section class="section" id="purpose"><div class="titlepage"><div><div><h3 class="title">4.1.1. Purpose</h3></div></div></div><p>
					The API server is accessible by clients external to the cluster at <code class="literal">api.&lt;cluster_name&gt;.&lt;base_domain&gt;</code>. You might want clients to access the API server at a different hostname or without the need to distribute the cluster-managed certificate authority (CA) certificates to the clients. The administrator must set a custom default certificate to be used by the API server when serving content.
				</p></section><section class="section" id="location"><div class="titlepage"><div><div><h3 class="title">4.1.2. Location</h3></div></div></div><p>
					The user-provided certificates must be provided in a <code class="literal">kubernetes.io/tls</code> type <code class="literal">Secret</code> in the <code class="literal">openshift-config</code> namespace. Update the API server cluster configuration, the <code class="literal">apiserver/cluster</code> resource, to enable the use of the user-provided certificate.
				</p></section><section class="section" id="management"><div class="titlepage"><div><div><h3 class="title">4.1.3. Management</h3></div></div></div><p>
					User-provided certificates are managed by the user.
				</p></section><section class="section" id="expiration"><div class="titlepage"><div><div><h3 class="title">4.1.4. Expiration</h3></div></div></div><p>
					API server client certificate expiration is less than five minutes.
				</p><p>
					User-provided certificates are managed by the user.
				</p></section><section class="section" id="customization"><div class="titlepage"><div><div><h3 class="title">4.1.5. Customization</h3></div></div></div><p>
					Update the secret containing the user-managed certificate as needed.
				</p><h4 id="additional-resources-3">Additional resources</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#api-server-certificates">Adding API server certificates</a>
						</li></ul></div></section></section><section class="section" id="cert-types-proxy-certificates"><div class="titlepage"><div><div><h2 class="title">4.2. Proxy certificates</h2></div></div></div><section class="section" id="purpose-2"><div class="titlepage"><div><div><h3 class="title">4.2.1. Purpose</h3></div></div></div><p>
					Proxy certificates allow users to specify one or more custom certificate authority (CA) certificates used by platform components when making egress connections.
				</p><p>
					The <code class="literal">trustedCA</code> field of the Proxy object is a reference to a config map that contains a user-provided trusted certificate authority (CA) bundle. This bundle is merged with the Red Hat Enterprise Linux CoreOS (RHCOS) trust bundle and injected into the trust store of platform components that make egress HTTPS calls. For example, <code class="literal">image-registry-operator</code> calls an external image registry to download images. If <code class="literal">trustedCA</code> is not specified, only the RHCOS trust bundle is used for proxied HTTPS connections. Provide custom CA certificates to the RHCOS trust bundle if you want to use your own certificate infrastructure.
				</p><p>
					The <code class="literal">trustedCA</code> field should only be consumed by a proxy validator. The validator is responsible for reading the certificate bundle from required key <code class="literal">ca-bundle.crt</code> and copying it to a config map named <code class="literal">trusted-ca-bundle</code> in the <code class="literal">openshift-config-managed</code> namespace. The namespace for the config map referenced by <code class="literal">trustedCA</code> is <code class="literal">openshift-config</code>:
				</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: user-ca-bundle
  namespace: openshift-config
data:
  ca-bundle.crt: |
    -----BEGIN CERTIFICATE-----
    Custom CA certificate bundle.
    -----END CERTIFICATE-----</pre><h5 id="additional-resources-4">Additional resources</h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#enable-cluster-wide-proxy">Configuring the cluster-wide proxy</a>
						</li></ul></div></section><section class="section" id="managing-proxy-certificates-during-installation"><div class="titlepage"><div><div><h3 class="title">4.2.2. Managing proxy certificates during installation</h3></div></div></div><p>
					The <code class="literal">additionalTrustBundle</code> value of the installer configuration is used to specify any proxy-trusted CA certificates during installation. For example:
				</p><pre class="programlisting language-terminal">$ cat install-config.yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">...
proxy:
  httpProxy: http://&lt;https://username:password@proxy.example.com:123/&gt;
  httpsProxy: https://&lt;https://username:password@proxy.example.com:123/&gt;
	noProxy: &lt;123.example.com,10.88.0.0/16&gt;
additionalTrustBundle: |
    -----BEGIN CERTIFICATE-----
   &lt;MY_HTTPS_PROXY_TRUSTED_CA_CERT&gt;
    -----END CERTIFICATE-----
...</pre>

					</p></div></section><section class="section" id="location-2"><div class="titlepage"><div><div><h3 class="title">4.2.3. Location</h3></div></div></div><p>
					The user-provided trust bundle is represented as a config map. The config map is mounted into the file system of platform components that make egress HTTPS calls. Typically, Operators mount the config map to <code class="literal">/etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem</code>, but this is not required by the proxy. A proxy can modify or inspect the HTTPS connection. In either case, the proxy must generate and sign a new certificate for the connection.
				</p><p>
					Complete proxy support means connecting to the specified proxy and trusting any signatures it has generated. Therefore, it is necessary to let the user specify a trusted root, such that any certificate chain connected to that trusted root is also trusted.
				</p><p>
					If using the RHCOS trust bundle, place CA certificates in <code class="literal">/etc/pki/ca-trust/source/anchors</code>.
				</p><p>
					See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening/using-shared-system-certificates_security-hardening">Using shared system certificates</a> in the Red Hat Enterprise Linux documentation for more information.
				</p></section><section class="section" id="expiration-2"><div class="titlepage"><div><div><h3 class="title">4.2.4. Expiration</h3></div></div></div><p>
					The user sets the expiration term of the user-provided trust bundle.
				</p><p>
					The default expiration term is defined by the CA certificate itself. It is up to the CA administrator to configure this for the certificate before it can be used by OpenShift Container Platform or RHCOS.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Red Hat does not monitor for when CAs expire. However, due to the long life of CAs, this is generally not an issue. However, you might need to periodically update the trust bundle.
					</p></div></div></section><section class="section" id="services"><div class="titlepage"><div><div><h3 class="title">4.2.5. Services</h3></div></div></div><p>
					By default, all platform components that make egress HTTPS calls will use the RHCOS trust bundle. If <code class="literal">trustedCA</code> is defined, it will also be used.
				</p><p>
					Any service that is running on the RHCOS node is able to use the trust bundle of the node.
				</p></section><section class="section" id="management-2"><div class="titlepage"><div><div><h3 class="title">4.2.6. Management</h3></div></div></div><p>
					These certificates are managed by the system and not the user.
				</p></section><section class="section" id="customization-2"><div class="titlepage"><div><div><h3 class="title">4.2.7. Customization</h3></div></div></div><p>
					Updating the user-provided trust bundle consists of either:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							updating the PEM-encoded certificates in the config map referenced by <code class="literal">trustedCA,</code> or
						</li><li class="listitem">
							creating a config map in the namespace <code class="literal">openshift-config</code> that contains the new trust bundle and updating <code class="literal">trustedCA</code> to reference the name of the new config map.
						</li></ul></div><p>
					The mechanism for writing CA certificates to the RHCOS trust bundle is exactly the same as writing any other file to RHCOS, which is done through the use of machine configs. When the Machine Config Operator (MCO) applies the new machine config that contains the new CA certificates, the node is rebooted. During the next boot, the service <code class="literal">coreos-update-ca-trust.service</code> runs on the RHCOS nodes, which automatically update the trust bundle with the new CA certificates. For example:
				</p><pre class="programlisting language-yaml">apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: worker
  name: 50-examplecorp-ca-cert
spec:
  config:
    ignition:
      version: 3.1.0
    storage:
      files:
      - contents:
          source: data:text/plain;charset=utf-8;base64,LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUVORENDQXh5Z0F3SUJBZ0lKQU51bkkwRDY2MmNuTUEwR0NTcUdTSWIzRFFFQkN3VUFNSUdsTVFzd0NRWUQKV1FRR0V3SlZVekVYTUJVR0ExVUVDQXdPVG05eWRHZ2dRMkZ5YjJ4cGJtRXhFREFPQmdOVkJBY01CMUpoYkdWcApBMmd4RmpBVUJnTlZCQW9NRFZKbFpDQklZWFFzSUVsdVl5NHhFekFSQmdOVkJBc01DbEpsWkNCSVlYUWdTVlF4Ckh6QVpCZ05WQkFNTUVsSmxaQ0JJWVhRZ1NWUWdVbTl2ZENCRFFURWhNQjhHQ1NxR1NJYjNEUUVKQVJZU2FXNW0KWGpDQnBURUxNQWtHQTFVRUJoTUNWVk14RnpBVkJnTlZCQWdNRGs1dmNuUm9JRU5oY205c2FXNWhNUkF3RGdZRApXUVFIREFkU1lXeGxhV2RvTVJZd0ZBWURWUVFLREExU1pXUWdTR0YwTENCSmJtTXVNUk13RVFZRFZRUUxEQXBTCkFXUWdTR0YwSUVsVU1Sc3dHUVlEVlFRRERCSlNaV1FnU0dGMElFbFVJRkp2YjNRZ1EwRXhJVEFmQmdrcWhraUcKMHcwQkNRRVdFbWx1Wm05elpXTkFjbVZrYUdGMExtTnZiVENDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dFUApCRENDQVFvQ2dnRUJBTFF0OU9KUWg2R0M1TFQxZzgwcU5oMHU1MEJRNHNaL3laOGFFVHh0KzVsblBWWDZNSEt6CmQvaTdsRHFUZlRjZkxMMm55VUJkMmZRRGsxQjBmeHJza2hHSUlaM2lmUDFQczRsdFRrdjhoUlNvYjNWdE5xU28KSHhrS2Z2RDJQS2pUUHhEUFdZeXJ1eTlpckxaaW9NZmZpM2kvZ0N1dDBaV3RBeU8zTVZINXFXRi9lbkt3Z1BFUwpZOXBvK1RkQ3ZSQi9SVU9iQmFNNzYxRWNyTFNNMUdxSE51ZVNmcW5obzNBakxRNmRCblBXbG82MzhabTFWZWJLCkNFTHloa0xXTVNGa0t3RG1uZTBqUTAyWTRnMDc1dkNLdkNzQ0F3RUFBYU5qTUdFd0hRWURWUjBPQkJZRUZIN1IKNXlDK1VlaElJUGV1TDhacXczUHpiZ2NaTUI4R0ExVWRJd1FZTUJhQUZIN1I0eUMrVWVoSUlQZXVMOFpxdzNQegpjZ2NaTUE4R0ExVWRFd0VCL3dRRk1BTUJBZjh3RGdZRFZSMFBBUUgvQkFRREFnR0dNQTBHQ1NxR1NJYjNEUUVCCkR3VUFBNElCQVFCRE52RDJWbTlzQTVBOUFsT0pSOCtlbjVYejloWGN4SkI1cGh4Y1pROGpGb0cwNFZzaHZkMGUKTUVuVXJNY2ZGZ0laNG5qTUtUUUNNNFpGVVBBaWV5THg0ZjUySHVEb3BwM2U1SnlJTWZXK0tGY05JcEt3Q3NhawpwU29LdElVT3NVSks3cUJWWnhjckl5ZVFWMnFjWU9lWmh0UzV3QnFJd09BaEZ3bENFVDdaZTU4UUhtUzQ4c2xqCjVlVGtSaml2QWxFeHJGektjbGpDNGF4S1Fsbk92VkF6eitHbTMyVTB4UEJGNEJ5ZVBWeENKVUh3MVRzeVRtZWwKU3hORXA3eUhvWGN3bitmWG5hK3Q1SldoMWd4VVp0eTMKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
        mode: 0644
        overwrite: true
        path: /etc/pki/ca-trust/source/anchors/examplecorp-ca.crt</pre><p>
					The trust store of machines must also support updating the trust store of nodes.
				</p></section><section class="section" id="renewal"><div class="titlepage"><div><div><h3 class="title">4.2.8. Renewal</h3></div></div></div><p>
					There are no Operators that can auto-renew certificates on the RHCOS nodes.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Red Hat does not monitor for when CAs expire. However, due to the long life of CAs, this is generally not an issue. However, you might need to periodically update the trust bundle.
					</p></div></div></section></section><section class="section" id="cert-types-service-ca-certificates"><div class="titlepage"><div><div><h2 class="title">4.3. Service CA certificates</h2></div></div></div><section class="section" id="purpose-3"><div class="titlepage"><div><div><h3 class="title">4.3.1. Purpose</h3></div></div></div><p>
					<code class="literal">service-ca</code> is an Operator that creates a self-signed CA when an OpenShift Container Platform cluster is deployed.
				</p></section><section class="section" id="expiration-3"><div class="titlepage"><div><div><h3 class="title">4.3.2. Expiration</h3></div></div></div><p>
					A custom expiration term is not supported. The self-signed CA is stored in a secret with qualified name <code class="literal">service-ca/signing-key</code> in fields <code class="literal">tls.crt</code> (certificate(s)), <code class="literal">tls.key</code> (private key), and <code class="literal">ca-bundle.crt</code> (CA bundle).
				</p><p>
					Other services can request a service serving certificate by annotating a service resource with <code class="literal">service.beta.openshift.io/serving-cert-secret-name: &lt;secret name&gt;</code>. In response, the Operator generates a new certificate, as <code class="literal">tls.crt</code>, and private key, as <code class="literal">tls.key</code> to the named secret. The certificate is valid for two years.
				</p><p>
					Other services can request that the CA bundle for the service CA be injected into API service or config map resources by annotating with <code class="literal">service.beta.openshift.io/inject-cabundle: true</code> to support validating certificates generated from the service CA. In response, the Operator writes its current CA bundle to the <code class="literal">CABundle</code> field of an API service or as <code class="literal">service-ca.crt</code> to a config map.
				</p><p>
					As of OpenShift Container Platform 4.3.5, automated rotation is supported and is backported to some 4.2.z and 4.3.z releases. For any release supporting automated rotation, the service CA is valid for 26 months and is automatically refreshed when there is less than 13 months validity left. If necessary, you can manually refresh the service CA.
				</p><p>
					The service CA expiration of 26 months is longer than the expected upgrade interval for a supported OpenShift Container Platform cluster, such that non-control plane consumers of service CA certificates will be refreshed after CA rotation and prior to the expiration of the pre-rotation CA.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						A manually-rotated service CA does not maintain trust with the previous service CA. You might experience a temporary service disruption until the pods in the cluster are restarted, which ensures that pods are using service serving certificates issued by the new service CA.
					</p></div></div></section><section class="section" id="management-3"><div class="titlepage"><div><div><h3 class="title">4.3.3. Management</h3></div></div></div><p>
					These certificates are managed by the system and not the user.
				</p></section><section class="section" id="services-2"><div class="titlepage"><div><div><h3 class="title">4.3.4. Services</h3></div></div></div><p>
					Services that use service CA certificates include:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							cluster-autoscaler-operator
						</li><li class="listitem">
							cluster-monitoring-operator
						</li><li class="listitem">
							cluster-authentication-operator
						</li><li class="listitem">
							cluster-image-registry-operator
						</li><li class="listitem">
							cluster-ingress-operator
						</li><li class="listitem">
							cluster-kube-apiserver-operator
						</li><li class="listitem">
							cluster-kube-controller-manager-operator
						</li><li class="listitem">
							cluster-kube-scheduler-operator
						</li><li class="listitem">
							cluster-networking-operator
						</li><li class="listitem">
							cluster-openshift-apiserver-operator
						</li><li class="listitem">
							cluster-openshift-controller-manager-operator
						</li><li class="listitem">
							cluster-samples-operator
						</li><li class="listitem">
							machine-config-operator
						</li><li class="listitem">
							console-operator
						</li><li class="listitem">
							insights-operator
						</li><li class="listitem">
							machine-api-operator
						</li><li class="listitem">
							operator-lifecycle-manager
						</li></ul></div><p>
					This is not a comprehensive list.
				</p><h4 id="additional-resources-5">Additional resources</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#add-service-serving">Manually rotate service serving certificates</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#add-service-serving">Securing service traffic using service serving certificate secrets</a>
						</li></ul></div></section></section><section class="section" id="cert-types-node-certificates"><div class="titlepage"><div><div><h2 class="title">4.4. Node certificates</h2></div></div></div><section class="section" id="purpose-4"><div class="titlepage"><div><div><h3 class="title">4.4.1. Purpose</h3></div></div></div><p>
					Node certificates are signed by the cluster; they come from a certificate authority (CA) that is generated by the bootstrap process. After the cluster is installed, the node certificates are auto-rotated.
				</p></section><section class="section" id="management-4"><div class="titlepage"><div><div><h3 class="title">4.4.2. Management</h3></div></div></div><p>
					These certificates are managed by the system and not the user.
				</p><h4 id="additional-resources-6">Additional resources</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-nodes-working">Working with nodes</a>
						</li></ul></div></section></section><section class="section" id="cert-types-bootstrap-certificates"><div class="titlepage"><div><div><h2 class="title">4.5. Bootstrap certificates</h2></div></div></div><section class="section" id="purpose-5"><div class="titlepage"><div><div><h3 class="title">4.5.1. Purpose</h3></div></div></div><p>
					The kubelet, in OpenShift Container Platform 4 and later, uses the bootstrap certificate located in <code class="literal">/etc/kubernetes/kubeconfig</code> to initially bootstrap. This is followed by the <a class="link" href="https://kubernetes.io/docs/reference/access-authn-authz/kubelet-tls-bootstrapping/#bootstrap-initialization">bootstrap initialization process</a> and <a class="link" href="https://kubernetes.io/docs/reference/access-authn-authz/kubelet-tls-bootstrapping/#authorize-kubelet-to-create-csr">authorization of the kubelet to create a CSR</a>.
				</p><p>
					In that process, the kubelet generates a CSR while communicating over the bootstrap channel. The controller manager signs the CSR, resulting in a certificate that the kubelet manages.
				</p></section><section class="section" id="management-5"><div class="titlepage"><div><div><h3 class="title">4.5.2. Management</h3></div></div></div><p>
					These certificates are managed by the system and not the user.
				</p></section><section class="section" id="expiration-4"><div class="titlepage"><div><div><h3 class="title">4.5.3. Expiration</h3></div></div></div><p>
					This bootstrap certificate is valid for 10 years.
				</p><p>
					The kubelet-managed certificate is valid for one year and rotates automatically at around the 80 percent mark of that one year.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						OpenShift Lifecycle Manager (OLM) does not update the bootstrap certificate.
					</p></div></div></section><section class="section" id="customization-3"><div class="titlepage"><div><div><h3 class="title">4.5.4. Customization</h3></div></div></div><p>
					You cannot customize the bootstrap certificates.
				</p></section></section><section class="section" id="cert-types-etcd-certificates"><div class="titlepage"><div><div><h2 class="title">4.6. etcd certificates</h2></div></div></div><section class="section" id="purpose-6"><div class="titlepage"><div><div><h3 class="title">4.6.1. Purpose</h3></div></div></div><p>
					etcd certificates are signed by the etcd-signer; they come from a certificate authority (CA) that is generated by the bootstrap process.
				</p></section><section class="section" id="expiration-5"><div class="titlepage"><div><div><h3 class="title">4.6.2. Expiration</h3></div></div></div><p>
					The CA certificates are valid for 10 years. The peer, client, and server certificates are valid for three years.
				</p></section><section class="section" id="management-6"><div class="titlepage"><div><div><h3 class="title">4.6.3. Management</h3></div></div></div><p>
					These certificates are only managed by the system and are automatically rotated.
				</p></section><section class="section" id="services-3"><div class="titlepage"><div><div><h3 class="title">4.6.4. Services</h3></div></div></div><p>
					etcd certificates are used for encrypted communication between etcd member peers, as well as encrypted client traffic. The following certificates are generated and used by etcd and other processes that communicate with etcd:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Peer certificates: Used for communication between etcd members.
						</li><li class="listitem">
							Client certificates: Used for encrypted server-client communication. Client certificates are currently used by the API server only, and no other service should connect to etcd directly except for the proxy. Client secrets (<code class="literal">etcd-client</code>, <code class="literal">etcd-metric-client</code>, <code class="literal">etcd-metric-signer</code>, and <code class="literal">etcd-signer</code>) are added to the <code class="literal">openshift-config</code>, <code class="literal">openshift-monitoring</code>, and <code class="literal">openshift-kube-apiserver</code> namespaces.
						</li><li class="listitem">
							Server certificates: Used by the etcd server for authenticating client requests.
						</li><li class="listitem">
							Metric certificates: All metric consumers connect to proxy with metric-client certificates.
						</li></ul></div><h4 id="additional-resources-7">Additional resources</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/backup_and_restore/#dr-restoring-cluster-state">Restoring to a previous cluster state</a>
						</li></ul></div></section></section><section class="section" id="cert-types-olm-certificates"><div class="titlepage"><div><div><h2 class="title">4.7. OLM certificates</h2></div></div></div><section class="section" id="management-7"><div class="titlepage"><div><div><h3 class="title">4.7.1. Management</h3></div></div></div><p>
					All certificates for OpenShift Lifecycle Manager (OLM) components (<code class="literal">olm-operator</code>, <code class="literal">catalog-operator</code>, <code class="literal">packageserver</code>, and <code class="literal">marketplace-operator</code>) are managed by the system.
				</p><p>
					When installing Operators that include webhooks or API services in their <code class="literal">ClusterServiceVersion</code> (CSV) object, OLM creates and rotates the certificates for these resources. Certificates for resources in the <code class="literal">openshift-operator-lifecycle-manager</code> namespace are managed by OLM.
				</p><p>
					OLM will not update the certificates of Operators that it manages in proxy environments. These certificates must be managed by the user using the subscription config.
				</p></section></section><section class="section" id="cert-types-aggregated-api-client-certificates"><div class="titlepage"><div><div><h2 class="title">4.8. Aggregated API client certificates</h2></div></div></div><section class="section" id="purpose-7"><div class="titlepage"><div><div><h3 class="title">4.8.1. Purpose</h3></div></div></div><p>
					Aggregated API client certificates are used to authenticate the KubeAPIServer when connecting to the Aggregated API Servers.
				</p></section><section class="section" id="management-8"><div class="titlepage"><div><div><h3 class="title">4.8.2. Management</h3></div></div></div><p>
					These certificates are managed by the system and not the user.
				</p></section><section class="section" id="expiration-6"><div class="titlepage"><div><div><h3 class="title">4.8.3. Expiration</h3></div></div></div><p>
					This CA is valid for 30 days.
				</p><p>
					The managed client certificates are valid for 30 days.
				</p><p>
					CA and client certificates are rotated automatically through the use of controllers.
				</p></section><section class="section" id="customization-4"><div class="titlepage"><div><div><h3 class="title">4.8.4. Customization</h3></div></div></div><p>
					You cannot customize the aggregated API server certificates.
				</p></section></section><section class="section" id="cert-types-machine-config-operator-certificates"><div class="titlepage"><div><div><h2 class="title">4.9. Machine Config Operator certificates</h2></div></div></div><section class="section" id="purpose-8"><div class="titlepage"><div><div><h3 class="title">4.9.1. Purpose</h3></div></div></div><p>
					This certificate authority is used to secure connections from nodes to Machine Config Server (MCS) during initial provisioning.
				</p><p>
					There are two certificates: . A self-signed CA, the MCS CA . A derived certificate, the MCS cert
				</p><section class="section" id="provisioning-details"><div class="titlepage"><div><div><h4 class="title">4.9.1.1. Provisioning details</h4></div></div></div><p>
						OpenShift Container Platform installations that use Red Hat Enterprise Linux CoreOS (RHCOS) are installed by using Ignition. This process is split into two parts:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								An Ignition config is created that references a URL for the full configuration served by the MCS.
							</li><li class="listitem">
								For user-provisioned infrastucture installation methods, the Ignition config manifests as a <code class="literal">worker.ign</code> file created by the <code class="literal">openshift-install</code> command. For installer-provisioned infrastructure installation methods that use the Machine API Operator, this configuration appears as the <code class="literal">worker-user-data</code> secret.
							</li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Currently, there is no supported way to block or restrict the machine config server endpoint. The machine config server must be exposed to the network so that newly-provisioned machines, which have no existing configuration or state, are able to fetch their configuration. In this model, the root of trust is the certificate signing requests (CSR) endpoint, which is where the kubelet sends its certificate signing request for approval to join the cluster. Because of this, machine configs should not be used to distribute sensitive information, such as secrets and certificates.
						</p><p>
							To ensure that the machine config server endpoints, ports 22623 and 22624, are secured in bare metal scenarios, customers must configure proper network policies.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/post-installation_configuration/#understanding-the-machine-config-operator">Understanding the Machine Config Operator</a>.
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#about-openshift-sdn">About the OpenShift SDN network plugin</a>.
							</li></ul></div></section><section class="section" id="provisioning-chain-of-trust"><div class="titlepage"><div><div><h4 class="title">4.9.1.2. Provisioning chain of trust</h4></div></div></div><p>
						The MCS CA is injected into the Ignition configuration under the <code class="literal">security.tls.certificateAuthorities</code> configuration field. The MCS then provides the complete configuration using the MCS cert presented by the web server.
					</p><p>
						The client validates that the MCS cert presented by the server has a chain of trust to an authority it recognizes. In this case, the MCS CA is that authority, and it signs the MCS cert. This ensures that the client is accessing the correct server. The client in this case is Ignition running on a machine in the initramfs.
					</p></section><section class="section" id="key-material-inside-a-cluster"><div class="titlepage"><div><div><h4 class="title">4.9.1.3. Key material inside a cluster</h4></div></div></div><p>
						The MCS CA appears in the cluster as a config map in the <code class="literal">kube-system</code> namespace, <code class="literal">root-ca</code> object, with <code class="literal">ca.crt</code> key. The private key is not stored in the cluster and is discarded after the installation completes.
					</p><p>
						The MCS cert appears in the cluster as a secret in the <code class="literal">openshift-machine-config-operator</code> namespace and <code class="literal">machine-config-server-tls</code> object with the <code class="literal">tls.crt</code> and <code class="literal">tls.key</code> keys.
					</p></section></section><section class="section" id="management-9"><div class="titlepage"><div><div><h3 class="title">4.9.2. Management</h3></div></div></div><p>
					At this time, directly modifying either of these certificates is not supported.
				</p></section><section class="section" id="expiration-7"><div class="titlepage"><div><div><h3 class="title">4.9.3. Expiration</h3></div></div></div><p>
					The MCS CA is valid for 10 years.
				</p><p>
					The issued serving certificates are valid for 10 years.
				</p></section><section class="section" id="customization-5"><div class="titlepage"><div><div><h3 class="title">4.9.4. Customization</h3></div></div></div><p>
					You cannot customize the Machine Config Operator certificates.
				</p></section></section><section class="section" id="cert-types-user-provided-certificates-for-default-ingress"><div class="titlepage"><div><div><h2 class="title">4.10. User-provided certificates for default ingress</h2></div></div></div><section class="section" id="purpose-9"><div class="titlepage"><div><div><h3 class="title">4.10.1. Purpose</h3></div></div></div><p>
					Applications are usually exposed at <code class="literal">&lt;route_name&gt;.apps.&lt;cluster_name&gt;.&lt;base_domain&gt;</code>. The <code class="literal">&lt;cluster_name&gt;</code> and <code class="literal">&lt;base_domain&gt;</code> come from the installation config file. <code class="literal">&lt;route_name&gt;</code> is the host field of the route, if specified, or the route name. For example, <code class="literal">hello-openshift-default.apps.username.devcluster.openshift.com</code>. <code class="literal">hello-openshift</code> is the name of the route and the route is in the default namespace. You might want clients to access the applications without the need to distribute the cluster-managed CA certificates to the clients. The administrator must set a custom default certificate when serving application content.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						The Ingress Operator generates a default certificate for an Ingress Controller to serve as a placeholder until you configure a custom default certificate. Do not use operator-generated default certificates in production clusters.
					</p></div></div></section><section class="section" id="location-3"><div class="titlepage"><div><div><h3 class="title">4.10.2. Location</h3></div></div></div><p>
					The user-provided certificates must be provided in a <code class="literal">tls</code> type <code class="literal">Secret</code> resource in the <code class="literal">openshift-ingress</code> namespace. Update the <code class="literal">IngressController</code> CR in the <code class="literal">openshift-ingress-operator</code> namespace to enable the use of the user-provided certificate. For more information on this process, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#nw-ingress-setting-a-custom-default-certificate_configuring-ingress">Setting a custom default certificate</a>.
				</p></section><section class="section" id="management-10"><div class="titlepage"><div><div><h3 class="title">4.10.3. Management</h3></div></div></div><p>
					User-provided certificates are managed by the user.
				</p></section><section class="section" id="expiration-8"><div class="titlepage"><div><div><h3 class="title">4.10.4. Expiration</h3></div></div></div><p>
					User-provided certificates are managed by the user.
				</p></section><section class="section" id="services-4"><div class="titlepage"><div><div><h3 class="title">4.10.5. Services</h3></div></div></div><p>
					Applications deployed on the cluster use user-provided certificates for default ingress.
				</p></section><section class="section" id="customization-6"><div class="titlepage"><div><div><h3 class="title">4.10.6. Customization</h3></div></div></div><p>
					Update the secret containing the user-managed certificate as needed.
				</p><h4 id="additional-resources-8">Additional resources</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#replacing-default-ingress">Replacing the default ingress certificate</a>
						</li></ul></div></section></section><section class="section" id="cert-types-ingress-certificates"><div class="titlepage"><div><div><h2 class="title">4.11. Ingress certificates</h2></div></div></div><section class="section" id="purpose-10"><div class="titlepage"><div><div><h3 class="title">4.11.1. Purpose</h3></div></div></div><p>
					The Ingress Operator uses certificates for:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Securing access to metrics for Prometheus.
						</li><li class="listitem">
							Securing access to routes.
						</li></ul></div></section><section class="section" id="location-4"><div class="titlepage"><div><div><h3 class="title">4.11.2. Location</h3></div></div></div><p>
					To secure access to Ingress Operator and Ingress Controller metrics, the Ingress Operator uses service serving certificates. The Operator requests a certificate from the <code class="literal">service-ca</code> controller for its own metrics, and the <code class="literal">service-ca</code> controller puts the certificate in a secret named <code class="literal">metrics-tls</code> in the <code class="literal">openshift-ingress-operator</code> namespace. Additionally, the Ingress Operator requests a certificate for each Ingress Controller, and the <code class="literal">service-ca</code> controller puts the certificate in a secret named <code class="literal">router-metrics-certs-&lt;name&gt;</code>, where <code class="literal">&lt;name&gt;</code> is the name of the Ingress Controller, in the <code class="literal">openshift-ingress</code> namespace.
				</p><p>
					Each Ingress Controller has a default certificate that it uses for secured routes that do not specify their own certificates. Unless you specify a custom certificate, the Operator uses a self-signed certificate by default. The Operator uses its own self-signed signing certificate to sign any default certificate that it generates. The Operator generates this signing certificate and puts it in a secret named <code class="literal">router-ca</code> in the <code class="literal">openshift-ingress-operator</code> namespace. When the Operator generates a default certificate, it puts the default certificate in a secret named <code class="literal">router-certs-&lt;name&gt;</code> (where <code class="literal">&lt;name&gt;</code> is the name of the Ingress Controller) in the <code class="literal">openshift-ingress</code> namespace.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						The Ingress Operator generates a default certificate for an Ingress Controller to serve as a placeholder until you configure a custom default certificate. Do not use Operator-generated default certificates in production clusters.
					</p></div></div></section><section class="section" id="workflow"><div class="titlepage"><div><div><h3 class="title">4.11.3. Workflow</h3></div></div></div><div class="figure" id="idm139961137278224"><p class="title"><strong>Figure 4.1. Custom certificate workflow</strong></p><div class="figure-contents"><div class="mediaobject"><object type="image/svg+xml" class="svg-img" data="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/20d77cca32aaad01f90bc749238ebb64/custom_4.5.svg"><embed type="image/svg+xml" src="images/custom_4.5.svg"><!--Empty--></embed></object></div></div></div><div class="figure" id="idm139961128936992"><p class="title"><strong>Figure 4.2. Default certificate workflow</strong></p><div class="figure-contents"><div class="mediaobject"><object type="image/svg+xml" class="svg-img" data="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/53941a84bd198529b18674769d1c8fc7/default_4.5.svg"><embed type="image/svg+xml" src="images/default_4.5.svg"><!--Empty--></embed></object></div></div></div><p>
					<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/1f6a7d5c77035f587ab16d2072b67d80/darkcircle-0.png" width="20" alt="20"/></span>
					 An empty <code class="literal">defaultCertificate</code> field causes the Ingress Operator to use its self-signed CA to generate a serving certificate for the specified domain.
				</p><p>
					<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/066d390945eb233d66d1b10310fec9e7/darkcircle-1.png" width="20" alt="20"/></span>
					 The default CA certificate and key generated by the Ingress Operator. Used to sign Operator-generated default serving certificates.
				</p><p>
					<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/dffcf5a2ed44061a19f38d92a8a3d1bb/darkcircle-2.png" width="20" alt="20"/></span>
					 In the default workflow, the wildcard default serving certificate, created by the Ingress Operator and signed using the generated default CA certificate. In the custom workflow, this is the user-provided certificate.
				</p><p>
					<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/e4171dd0f615beb50be5dc701259f444/darkcircle-3.png" width="20" alt="20"/></span>
					 The router deployment. Uses the certificate in <code class="literal">secrets/router-certs-default</code> as its default front-end server certificate.
				</p><p>
					<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/dd170f3f40e17838a75352ca1962f9bb/darkcircle-4.png" width="20" alt="20"/></span>
					 In the default workflow, the contents of the wildcard default serving certificate (public and private parts) are copied here to enable OAuth integration. In the custom workflow, this is the user-provided certificate.
				</p><p>
					<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/b86066dfcdf40a6c7ce19b770a9d3868/darkcircle-5.png" width="20" alt="20"/></span>
					 The public (certificate) part of the default serving certificate. Replaces the <code class="literal">configmaps/router-ca</code> resource.
				</p><p>
					<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/3355b6bb1a911bd888724ef147bddf81/darkcircle-6.png" width="20" alt="20"/></span>
					 The user updates the cluster proxy configuration with the CA certificate that signed the <code class="literal">ingresscontroller</code> serving certificate. This enables components like <code class="literal">auth</code>, <code class="literal">console</code>, and the registry to trust the serving certificate.
				</p><p>
					<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/c375237f874aa152901afcfc636b49aa/darkcircle-7.png" width="20" alt="20"/></span>
					 The cluster-wide trusted CA bundle containing the combined Red Hat Enterprise Linux CoreOS (RHCOS) and user-provided CA bundles or an RHCOS-only bundle if a user bundle is not provided.
				</p><p>
					<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/a6d6413c1aa40b05d8373cb664db1913/darkcircle-8.png" width="20" alt="20"/></span>
					 The custom CA certificate bundle, which instructs other components (for example, <code class="literal">auth</code> and <code class="literal">console</code>) to trust an <code class="literal">ingresscontroller</code> configured with a custom certificate.
				</p><p>
					<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/03e302a74ada37da40eee80ede633c6e/darkcircle-9.png" width="20" alt="20"/></span>
					 The <code class="literal">trustedCA</code> field is used to reference the user-provided CA bundle.
				</p><p>
					<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/df532c957f233ffca7c47f1341e1e491/darkcircle-10.png" width="20" alt="20"/></span>
					 The Cluster Network Operator injects the trusted CA bundle into the <code class="literal">proxy-ca</code> config map.
				</p><p>
					<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/a31e8b5875a5bdeae5cad6dd5f4d261f/darkcircle-11.png" width="20" alt="20"/></span>
					 OpenShift Container Platform 4.13 and newer use <code class="literal">default-ingress-cert</code>.
				</p></section><section class="section" id="expiration-9"><div class="titlepage"><div><div><h3 class="title">4.11.4. Expiration</h3></div></div></div><p>
					The expiration terms for the Ingress Operator’s certificates are as follows:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The expiration date for metrics certificates that the <code class="literal">service-ca</code> controller creates is two years after the date of creation.
						</li><li class="listitem">
							The expiration date for the Operator’s signing certificate is two years after the date of creation.
						</li><li class="listitem">
							The expiration date for default certificates that the Operator generates is two years after the date of creation.
						</li></ul></div><p>
					You cannot specify custom expiration terms on certificates that the Ingress Operator or <code class="literal">service-ca</code> controller creates.
				</p><p>
					You cannot specify expiration terms when installing OpenShift Container Platform for certificates that the Ingress Operator or <code class="literal">service-ca</code> controller creates.
				</p></section><section class="section" id="services-5"><div class="titlepage"><div><div><h3 class="title">4.11.5. Services</h3></div></div></div><p>
					Prometheus uses the certificates that secure metrics.
				</p><p>
					The Ingress Operator uses its signing certificate to sign default certificates that it generates for Ingress Controllers for which you do not set custom default certificates.
				</p><p>
					Cluster components that use secured routes may use the default Ingress Controller’s default certificate.
				</p><p>
					Ingress to the cluster via a secured route uses the default certificate of the Ingress Controller by which the route is accessed unless the route specifies its own certificate.
				</p></section><section class="section" id="management-11"><div class="titlepage"><div><div><h3 class="title">4.11.6. Management</h3></div></div></div><p>
					Ingress certificates are managed by the user. See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#replacing-default-ingress">Replacing the default ingress certificate</a> for more information.
				</p></section><section class="section" id="renewal-2"><div class="titlepage"><div><div><h3 class="title">4.11.7. Renewal</h3></div></div></div><p>
					The <code class="literal">service-ca</code> controller automatically rotates the certificates that it issues. However, it is possible to use <code class="literal">oc delete secret &lt;secret&gt;</code> to manually rotate service serving certificates.
				</p><p>
					The Ingress Operator does not rotate its own signing certificate or the default certificates that it generates. Operator-generated default certificates are intended as placeholders for custom default certificates that you configure.
				</p></section></section><section class="section" id="cert-types-monitoring-and-cluster-logging-operator-component-certificates"><div class="titlepage"><div><div><h2 class="title">4.12. Monitoring and OpenShift Logging Operator component certificates</h2></div></div></div><section class="section" id="expiration-10"><div class="titlepage"><div><div><h3 class="title">4.12.1. Expiration</h3></div></div></div><p>
					Monitoring components secure their traffic with service CA certificates. These certificates are valid for 2 years and are replaced automatically on rotation of the service CA, which is every 13 months.
				</p><p>
					If the certificate lives in the <code class="literal">openshift-monitoring</code> or <code class="literal">openshift-logging</code> namespace, it is system managed and rotated automatically.
				</p></section><section class="section" id="management-12"><div class="titlepage"><div><div><h3 class="title">4.12.2. Management</h3></div></div></div><p>
					These certificates are managed by the system and not the user.
				</p></section></section><section class="section" id="cert-types-control-plane-certificates"><div class="titlepage"><div><div><h2 class="title">4.13. Control plane certificates</h2></div></div></div><section class="section" id="location-5"><div class="titlepage"><div><div><h3 class="title">4.13.1. Location</h3></div></div></div><p>
					Control plane certificates are included in these namespaces:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							openshift-config-managed
						</li><li class="listitem">
							openshift-kube-apiserver
						</li><li class="listitem">
							openshift-kube-apiserver-operator
						</li><li class="listitem">
							openshift-kube-controller-manager
						</li><li class="listitem">
							openshift-kube-controller-manager-operator
						</li><li class="listitem">
							openshift-kube-scheduler
						</li></ul></div></section><section class="section" id="management-13"><div class="titlepage"><div><div><h3 class="title">4.13.2. Management</h3></div></div></div><p>
					Control plane certificates are managed by the system and rotated automatically.
				</p><p>
					In the rare case that your control plane certificates have expired, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/backup_and_restore/#dr-recovering-expired-certs">Recovering from expired control plane certificates</a>.
				</p></section></section></section><section class="chapter" id="compliance-operator"><div class="titlepage"><div><div><h1 class="title">Chapter 5. Compliance Operator</h1></div></div></div><section class="section" id="co-overview"><div class="titlepage"><div><div><h2 class="title">5.1. Compliance Operator overview</h2></div></div></div><p>
				OpenShift Container Platform Compliance Operator (CO) runs compliance scans and provides remediations to assist users in meeting compliance standards. For the latest updates, see the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-operator-release-notes">Compliance Operator release notes</a>. If needed, you can engage <a class="link" href="https://access.redhat.com/support/">Red Hat support</a>.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The Compliance Operator does not automatically perform remediations. Ensuring compliance standards are met is required by the user.
				</p></div></div><h6 id="compliance-operator-concepts">Compliance Operator concepts</h6><p>
				<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-operator-understanding">Understanding the Compliance Operator</a>
			</p><p>
				<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#custom-resource-definitions">Understanding the Custom Resource Definitions</a>
			</p><h6 id="compliance-operator-management">Compliance Operator management</h6><p>
				<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-operator-installation">Installing the Compliance Operator</a>
			</p><p>
				<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-operator-updating">Updating the Compliance Operator</a>
			</p><p>
				<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-operator-understanding">Managing the Compliance Operator</a>
			</p><p>
				<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-operator-uninstallation">Uninstalling the Compliance Operator</a>
			</p><h6 id="compliance-operator-scan-management">Compliance Operator scan management</h6><p>
				<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-operator-supported-profiles">Supported compliance profiles</a>
			</p><p>
				<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-operator-scans">Compliance Operator scans</a>
			</p><p>
				<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-operator-tailor">Tailoring the Compliance Operator</a>
			</p><p>
				<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-operator-raw-results">Retrieving Compliance Operator raw results</a>
			</p><p>
				<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-operator-remediation">Managing Compliance Operator remediation</a>
			</p><p>
				<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-operator-advanced">Performing advanced Compliance Operator tasks</a>
			</p><p>
				<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-operator-troubleshooting">Troubleshooting the Compliance Operator</a>
			</p><p>
				<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#using-oc-compliance-plug-in">Using the oc-compliance plugin</a>
			</p></section><section class="section" id="compliance-operator-release-notes"><div class="titlepage"><div><div><h2 class="title">5.2. Compliance Operator release notes</h2></div></div></div><p>
				The Compliance Operator lets OpenShift Container Platform administrators describe the required compliance state of a cluster and provides them with an overview of gaps and ways to remediate them.
			</p><p>
				These release notes track the development of the Compliance Operator in the OpenShift Container Platform.
			</p><p>
				For an overview of the Compliance Operator, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#understanding-compliance-operator">Understanding the Compliance Operator</a>.
			</p><p>
				To access the latest release, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#olm-preparing-upgrade_compliance-operator-updating">Updating the Compliance Operator</a>.
			</p><section class="section" id="compliance-operator-release-notes-1-3-0"><div class="titlepage"><div><div><h3 class="title">5.2.1. OpenShift Compliance Operator 1.3.0</h3></div></div></div><p>
					The following advisory is available for the OpenShift Compliance Operator 1.3.0:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2023:5102">RHBA-2023:5102 - OpenShift Compliance Operator enhancement update</a>
						</li></ul></div><section class="section" id="compliance-operator-1-3-0-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">5.2.1.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The Defense Information Systems Agency Security Technical Implementation Guide (DISA-STIG) for OpenShift Container Platform is now available from Compliance Operator 1.3.0. See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-supported-profiles_compliance-operator-supported-profiles">Supported compliance profiles</a> for additional information.
							</li><li class="listitem">
								Compliance Operator 1.3.0 now supports IBM Power and IBM Z for NIST 800-53 Moderate-Impact Baseline for OpenShift Container Platform platform and node profiles.
							</li></ul></div></section></section><section class="section" id="compliance-operator-release-notes-1-2-0"><div class="titlepage"><div><div><h3 class="title">5.2.2. OpenShift Compliance Operator 1.2.0</h3></div></div></div><p>
					The following advisory is available for the OpenShift Compliance Operator 1.2.0:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2023:4245">RHBA-2023:4245 - OpenShift Compliance Operator enhancement update</a>
						</li></ul></div><section class="section" id="compliance-operator-1-2-0-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">5.2.2.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								The CIS OpenShift Container Platform 4 Benchmark v1.4.0 profile is now available for platform and node applications. To locate the CIS OpenShift Container Platform v4 Benchmark, go to <a class="link" href="https://www.cisecurity.org/benchmark/kubernetes">CIS Benchmarks</a> and click <span class="strong strong"><strong>Download Latest CIS Benchmark</strong></span>, where you can then register to download the benchmark.
							</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									Upgrading to Compliance Operator 1.2.0 will overwrite the CIS OpenShift Container Platform 4 Benchmark 1.1.0 profiles.
								</p><p>
									If your OpenShift Container Platform environment contains existing <code class="literal">cis</code> and <code class="literal">cis-node</code> remediations, there might be some differences in scan results after upgrading to Compliance Operator 1.2.0.
								</p></div></div></li><li class="listitem">
								Additional clarity for auditing security context constraints (SCCs) is now available for the <code class="literal">scc-limit-container-allowed-capabilities</code> rule.
							</li></ul></div></section></section><section class="section" id="compliance-operator-release-notes-1-1-0"><div class="titlepage"><div><div><h3 class="title">5.2.3. OpenShift Compliance Operator 1.1.0</h3></div></div></div><p>
					The following advisory is available for the OpenShift Compliance Operator 1.1.0:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2023:3630">RHBA-2023:3630 - OpenShift Compliance Operator bug fix and enhancement update</a>
						</li></ul></div><section class="section" id="compliance-operator-1-1-0-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">5.2.3.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A start and end timestamp is now available in the <code class="literal">ComplianceScan</code> custom resource definition (CRD) status.
							</li><li class="listitem">
								The Compliance Operator can now be deployed on Hosted Control Planes using the OperatorHub by creating a <code class="literal">Subscription</code> file. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#installing-compliance-operator-hcp_compliance-operator-installation">Installing the Compliance Operator on Hosted Control Planes</a>.
							</li></ul></div></section><section class="section" id="compliance-operator-1-1-0-bug-fixes"><div class="titlepage"><div><div><h4 class="title">5.2.3.2. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Before this update, some Compliance Operator rule instructions were not present. After this update, instructions are improved for the following rules:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">classification_banner</code>
									</li><li class="listitem">
										<code class="literal">oauth_login_template_set</code>
									</li><li class="listitem">
										<code class="literal">oauth_logout_url_set</code>
									</li><li class="listitem">
										<code class="literal">oauth_provider_selection_set</code>
									</li><li class="listitem">
										<code class="literal">ocp_allowed_registries</code>
									</li><li class="listitem"><p class="simpara">
										<code class="literal">ocp_allowed_registries_for_import</code>
									</p><p class="simpara">
										(<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-10473"><span class="strong strong"><strong>OCPBUGS-10473</strong></span></a>)
									</p></li></ul></div></li><li class="listitem"><p class="simpara">
								Before this update, check accuracy and rule instructions were unclear. After this update, the check accuracy and instructions are improved for the following <code class="literal">sysctl</code> rules:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">kubelet-enable-protect-kernel-sysctl</code>
									</li><li class="listitem">
										<code class="literal">kubelet-enable-protect-kernel-sysctl-kernel-keys-root-maxbytes</code>
									</li><li class="listitem">
										<code class="literal">kubelet-enable-protect-kernel-sysctl-kernel-keys-root-maxkeys</code>
									</li><li class="listitem">
										<code class="literal">kubelet-enable-protect-kernel-sysctl-kernel-panic</code>
									</li><li class="listitem">
										<code class="literal">kubelet-enable-protect-kernel-sysctl-kernel-panic-on-oops</code>
									</li><li class="listitem">
										<code class="literal">kubelet-enable-protect-kernel-sysctl-vm-overcommit-memory</code>
									</li><li class="listitem"><p class="simpara">
										<code class="literal">kubelet-enable-protect-kernel-sysctl-vm-panic-on-oom</code>
									</p><p class="simpara">
										(<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-11334"><span class="strong strong"><strong>OCPBUGS-11334</strong></span></a>)
									</p></li></ul></div></li><li class="listitem">
								Before this update, the <code class="literal">ocp4-alert-receiver-configured</code> rule did not include instructions. With this update, the <code class="literal">ocp4-alert-receiver-configured</code> rule now includes improved instructions. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-7307"><span class="strong strong"><strong>OCPBUGS-7307</strong></span></a>)
							</li><li class="listitem">
								Before this update, the <code class="literal">rhcos4-sshd-set-loglevel-info</code> rule would fail for the <code class="literal">rhcos4-e8</code> profile. With this update, the remediation for the <code class="literal">sshd-set-loglevel-info</code> rule was updated to apply the correct configuration changes, allowing subsequent scans to pass after the remediation is applied. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-7816"><span class="strong strong"><strong>OCPBUGS-7816</strong></span></a>)
							</li><li class="listitem">
								Before this update, a new installation of OpenShift Container Platform with the latest Compliance Operator install failed on the <code class="literal">scheduler-no-bind-address</code> rule. With this update, the <code class="literal">scheduler-no-bind-address</code> rule has been disabled on newer versions of OpenShift Container Platform since the parameter was removed. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-8347"><span class="strong strong"><strong>OCPBUGS-8347</strong></span></a>)
							</li></ul></div></section></section><section class="section" id="compliance-operator-release-notes-1-0-0"><div class="titlepage"><div><div><h3 class="title">5.2.4. OpenShift Compliance Operator 1.0.0</h3></div></div></div><p>
					The following advisory is available for the OpenShift Compliance Operator 1.0.0:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2023:1682">RHBA-2023:1682 - OpenShift Compliance Operator bug fix update</a>
						</li></ul></div><section class="section" id="compliance-operator-1-0-0-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">5.2.4.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The Compliance Operator is now stable and the release channel is upgraded to <code class="literal">stable</code>. Future releases will follow <a class="link" href="https://semver.org/">Semantic Versioning</a>. To access the latest release, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#olm-preparing-upgrade_compliance-operator-updating">Updating the Compliance Operator</a>.
							</li></ul></div></section><section class="section" id="compliance-operator-1-0-0-bug-fixes"><div class="titlepage"><div><div><h4 class="title">5.2.4.2. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Before this update, the compliance_operator_compliance_scan_error_total metric had an ERROR label with a different value for each error message. With this update, the compliance_operator_compliance_scan_error_total metric does not increase in values. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-1803"><span class="strong strong"><strong>OCPBUGS-1803</strong></span></a>)
							</li><li class="listitem">
								Before this update, the <code class="literal">ocp4-api-server-audit-log-maxsize</code> rule would result in a <code class="literal">FAIL</code> state. With this update, the error message has been removed from the metric, decreasing the cardinality of the metric in line with best practices. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-7520"><span class="strong strong"><strong>OCPBUGS-7520</strong></span></a>)
							</li><li class="listitem">
								Before this update, the <code class="literal">rhcos4-enable-fips-mode</code> rule description was misleading that FIPS could be enabled after installation. With this update, the <code class="literal">rhcos4-enable-fips-mode</code> rule description clarifies that FIPS must be enabled at install time. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-8358"><span class="strong strong"><strong>OCPBUGS-8358</strong></span></a>)
							</li></ul></div></section></section><section class="section" id="compliance-operator-release-notes-0-1-61"><div class="titlepage"><div><div><h3 class="title">5.2.5. OpenShift Compliance Operator 0.1.61</h3></div></div></div><p>
					The following advisory is available for the OpenShift Compliance Operator 0.1.61:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2023:0557">RHBA-2023:0557 - OpenShift Compliance Operator bug fix update</a>
						</li></ul></div><section class="section" id="compliance-operator-0-1-61-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">5.2.5.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The Compliance Operator now supports timeout configuration for Scanner Pods. The timeout is specified in the <code class="literal">ScanSetting</code> object. If the scan is not completed within the timeout, the scan retries until the maximum number of retries is reached. See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-timeout_compliance-troubleshooting">Configuring ScanSetting timeout</a> for more information.
							</li></ul></div></section><section class="section" id="compliance-operator-0-1-61-bug-fixes"><div class="titlepage"><div><div><h4 class="title">5.2.5.2. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Before this update, Compliance Operator remediations required variables as inputs. Remediations without variables set were applied cluster-wide and resulted in stuck nodes, even though it appeared the remediation applied correctly. With this update, the Compliance Operator validates if a variable needs to be supplied using a <code class="literal">TailoredProfile</code> for a remediation. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-3864"><span class="strong strong"><strong>OCPBUGS-3864</strong></span></a>)
							</li><li class="listitem">
								Before this update, the instructions for <code class="literal">ocp4-kubelet-configure-tls-cipher-suites</code> were incomplete, requiring users to refine the query manually. With this update, the query provided in <code class="literal">ocp4-kubelet-configure-tls-cipher-suites</code> returns the actual results to perform the audit steps. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-3017"><span class="strong strong"><strong>OCPBUGS-3017</strong></span></a>)
							</li><li class="listitem">
								Before this update,<code class="literal">ScanSettingBinding</code> objects created without a <code class="literal">settingRef</code> variable did not use an appropriate default value. With this update, the <code class="literal">ScanSettingBinding</code> objects without a <code class="literal">settingRef</code> variable use the <code class="literal">default</code> value. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-3420"><span class="strong strong"><strong>OCPBUGS-3420</strong></span></a>)
							</li><li class="listitem">
								Before this update, system reserved parameters were not generated in kubelet configuration files, causing the Compliance Operator to fail to unpause the machine config pool. With this update, the Compliance Operator omits system reserved parameters during machine configuration pool evaluation. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-4445"><span class="strong strong"><strong>OCPBUGS-4445</strong></span></a>)
							</li><li class="listitem">
								Before this update, <code class="literal">ComplianceCheckResult</code> objects did not have correct descriptions. With this update, the Compliance Operator sources the <code class="literal">ComplianceCheckResult</code> information from the rule description. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-4615"><span class="strong strong"><strong>OCPBUGS-4615</strong></span></a>)
							</li><li class="listitem">
								Before this update, the Compliance Operator did not check for empty kubelet configuration files when parsing machine configurations. As a result, the Compliance Operator would panic and crash. With this update, the Compliance Operator implements improved checking of the kubelet configuration data structure and only continues if it is fully rendered. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-4621"><span class="strong strong"><strong>OCPBUGS-4621</strong></span></a>)
							</li><li class="listitem">
								Before this update, the Compliance Operator generated remediations for kubelet evictions based on machine config pool name and a grace period, resulting in multiple remediations for a single eviction rule. With this update, the Compliance Operator applies all remediations for a single rule. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-4338"><span class="strong strong"><strong>OCPBUGS-4338</strong></span></a>)
							</li><li class="listitem">
								Before this update, re-running scans on remediations that previously <code class="literal">Applied</code> might have been marked as <code class="literal">Outdated</code> after rescans were performed, despite no changes in the remediation content. The comparison of scans did not account for remediation metadata correctly. With this update, remediations retain the previously generated <code class="literal">Applied</code> status. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-6710"><span class="strong strong"><strong>OCPBUGS-6710</strong></span></a>)
							</li><li class="listitem">
								Before this update, a regression occurred when attempting to create a <code class="literal">ScanSettingBinding</code> that was using a <code class="literal">TailoredProfile</code> with a non-default <code class="literal">MachineConfigPool</code> marked the <code class="literal">ScanSettingBinding</code> as <code class="literal">Failed</code>. With this update, functionality is restored and custom <code class="literal">ScanSettingBinding</code> using a <code class="literal">TailoredProfile</code> performs correctly. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-6827"><span class="strong strong"><strong>OCPBUGS-6827</strong></span></a>)
							</li><li class="listitem"><p class="simpara">
								Before this update, some kubelet configuration parameters did not have default values. With this update, the following parameters contain default values (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-6708"><span class="strong strong"><strong>OCPBUGS-6708</strong></span></a>):
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">ocp4-cis-kubelet-enable-streaming-connections</code>
									</li><li class="listitem">
										<code class="literal">ocp4-cis-kubelet-eviction-thresholds-set-hard-imagefs-available</code>
									</li><li class="listitem">
										<code class="literal">ocp4-cis-kubelet-eviction-thresholds-set-hard-imagefs-inodesfree</code>
									</li><li class="listitem">
										<code class="literal">ocp4-cis-kubelet-eviction-thresholds-set-hard-memory-available</code>
									</li><li class="listitem">
										<code class="literal">ocp4-cis-kubelet-eviction-thresholds-set-hard-nodefs-available</code>
									</li></ul></div></li><li class="listitem">
								Before this update, the <code class="literal">selinux_confinement_of_daemons</code> rule failed running on the kubelet because of the permissions necessary for the kubelet to run. With this update, the <code class="literal">selinux_confinement_of_daemons</code> rule is disabled. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-6968"><span class="strong strong"><strong>OCPBUGS-6968</strong></span></a>)
							</li></ul></div></section></section><section class="section" id="compliance-operator-release-notes-0-1-59"><div class="titlepage"><div><div><h3 class="title">5.2.6. OpenShift Compliance Operator 0.1.59</h3></div></div></div><p>
					The following advisory is available for the OpenShift Compliance Operator 0.1.59:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2022:8538">RHBA-2022:8538 - OpenShift Compliance Operator bug fix update</a>
						</li></ul></div><section class="section" id="compliance-operator-0-1-59-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">5.2.6.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The Compliance Operator now supports Payment Card Industry Data Security Standard (PCI-DSS) <code class="literal">ocp4-pci-dss</code> and <code class="literal">ocp4-pci-dss-node</code> profiles on the <code class="literal">ppc64le</code> architecture.
							</li></ul></div></section><section class="section" id="compliance-operator-0-1-59-bug-fixes"><div class="titlepage"><div><div><h4 class="title">5.2.6.2. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, the Compliance Operator did not support the Payment Card Industry Data Security Standard (PCI DSS) <code class="literal">ocp4-pci-dss</code> and <code class="literal">ocp4-pci-dss-node</code> profiles on different architectures such as <code class="literal">ppc64le</code>. Now, the Compliance Operator supports <code class="literal">ocp4-pci-dss</code> and <code class="literal">ocp4-pci-dss-node</code> profiles on the <code class="literal">ppc64le</code> architecture. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-3252"><span class="strong strong"><strong>OCPBUGS-3252</strong></span></a>)
							</li><li class="listitem">
								Previously, after the recent update to version 0.1.57, the <code class="literal">rerunner</code> service account (SA) was no longer owned by the cluster service version (CSV), which caused the SA to be removed during the Operator upgrade. Now, the CSV owns the <code class="literal">rerunner</code> SA in 0.1.59, and upgrades from any previous version will not result in a missing SA. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-3452"><span class="strong strong"><strong>OCPBUGS-3452</strong></span></a>)
							</li><li class="listitem">
								In 0.1.57, the Operator started the controller metrics endpoint listening on port <code class="literal">8080</code>. This resulted in <code class="literal">TargetDown</code> alerts since cluster monitoring expected port is <code class="literal">8383</code>. With 0.1.59, the Operator starts the endpoint listening on port <code class="literal">8383</code> as expected. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-3097"><span class="strong strong"><strong>OCPBUGS-3097</strong></span></a>)
							</li></ul></div></section></section><section class="section" id="compliance-operator-release-notes-0-1-57"><div class="titlepage"><div><div><h3 class="title">5.2.7. OpenShift Compliance Operator 0.1.57</h3></div></div></div><p>
					The following advisory is available for the OpenShift Compliance Operator 0.1.57:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2022:6657">RHBA-2022:6657 - OpenShift Compliance Operator bug fix update</a>
						</li></ul></div><section class="section" id="compliance-operator-0-1-57-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">5.2.7.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">KubeletConfig</code> checks changed from <code class="literal">Node</code> to <code class="literal">Platform</code> type. <code class="literal">KubeletConfig</code> checks the default configuration of the <code class="literal">KubeletConfig</code>. The configuration files are aggregated from all nodes into a single location per node pool. See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-evaluate-kubeletconfig-rules_compliance-remediation">Evaluating <code class="literal">KubeletConfig</code> rules against default configuration values</a>.
							</li><li class="listitem">
								The <code class="literal">ScanSetting</code> Custom Resource now allows users to override the default CPU and memory limits of scanner pods through the <code class="literal">scanLimits</code> attribute. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-increasing-operator-limits_compliance-troubleshooting">Increasing Compliance Operator resource limits</a>.
							</li><li class="listitem">
								A <code class="literal">PriorityClass</code> object can now be set through <code class="literal">ScanSetting</code>. This ensures the Compliance Operator is prioritized and minimizes the chance that the cluster falls out of compliance. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-priorityclass_compliance-advanced">Setting <code class="literal">PriorityClass</code> for <code class="literal">ScanSetting</code> scans</a>.
							</li></ul></div></section><section class="section" id="compliance-operator-0-1-57-bug-fixes"><div class="titlepage"><div><div><h4 class="title">5.2.7.2. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, the Compliance Operator hard-coded notifications to the default <code class="literal">openshift-compliance</code> namespace. If the Operator were installed in a non-default namespace, the notifications would not work as expected. Now, notifications work in non-default <code class="literal">openshift-compliance</code> namespaces. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2060726"><span class="strong strong"><strong>BZ#2060726</strong></span></a>)
							</li><li class="listitem">
								Previously, the Compliance Operator was unable to evaluate default configurations used by kubelet objects, resulting in inaccurate results and false positives. <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-evaluate-kubeletconfig-rules_compliance-remediation">This new feature</a> evaluates the kubelet configuration and now reports accurately. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2075041"><span class="strong strong"><strong>BZ#2075041</strong></span></a>)
							</li><li class="listitem">
								Previously, the Compliance Operator reported the <code class="literal">ocp4-kubelet-configure-event-creation</code> rule in a <code class="literal">FAIL</code> state after applying an automatic remediation because the <code class="literal">eventRecordQPS</code> value was set higher than the default value. Now, the <code class="literal">ocp4-kubelet-configure-event-creation</code> rule remediation sets the default value, and the rule applies correctly. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2082416"><span class="strong strong"><strong>BZ#2082416</strong></span></a>)
							</li><li class="listitem">
								The <code class="literal">ocp4-configure-network-policies</code> rule requires manual intervention to perform effectively. New descriptive instructions and rule updates increase applicability of the <code class="literal">ocp4-configure-network-policies</code> rule for clusters using Calico CNIs. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2091794"><span class="strong strong"><strong>BZ#2091794</strong></span></a>)
							</li><li class="listitem">
								Previously, the Compliance Operator would not clean up pods used to scan infrastructure when using the <code class="literal">debug=true</code> option in the scan settings. This caused pods to be left on the cluster even after deleting the <code class="literal">ScanSettingBinding</code>. Now, pods are always deleted when a <code class="literal">ScanSettingBinding</code> is deleted.(<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2092913"><span class="strong strong"><strong>BZ#2092913</strong></span></a>)
							</li><li class="listitem">
								Previously, the Compliance Operator used an older version of the <code class="literal">operator-sdk</code> command that caused alerts about deprecated functionality. Now, an updated version of the <code class="literal">operator-sdk</code> command is included and there are no more alerts for deprecated functionality. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2098581"><span class="strong strong"><strong>BZ#2098581</strong></span></a>)
							</li><li class="listitem">
								Previously, the Compliance Operator would fail to apply remediations if it could not determine the relationship between kubelet and machine configurations. Now, the Compliance Operator has improved handling of the machine configurations and is able to determine if a kubelet configuration is a subset of a machine configuration. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2102511"><span class="strong strong"><strong>BZ#2102511</strong></span></a>)
							</li><li class="listitem">
								Previously, the rule for <code class="literal">ocp4-cis-node-master-kubelet-enable-cert-rotation</code> did not properly describe success criteria. As a result, the requirements for <code class="literal">RotateKubeletClientCertificate</code> were unclear. Now, the rule for <code class="literal">ocp4-cis-node-master-kubelet-enable-cert-rotation</code> reports accurately regardless of the configuration present in the kubelet configuration file. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2105153"><span class="strong strong"><strong>BZ#2105153</strong></span></a>)
							</li><li class="listitem">
								Previously, the rule for checking idle streaming timeouts did not consider default values, resulting in inaccurate rule reporting. Now, more robust checks ensure increased accuracy in results based on default configuration values. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2105878"><span class="strong strong"><strong>BZ#2105878</strong></span></a>)
							</li><li class="listitem">
								Previously, the Compliance Operator would fail to fetch API resources when parsing machine configurations without Ignition specifications, which caused the <code class="literal">api-check-pods</code> processes to crash loop. Now, the Compliance Operator handles Machine Config Pools that do not have Ignition specifications correctly. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2117268"><span class="strong strong"><strong>BZ#2117268</strong></span></a>)
							</li><li class="listitem">
								Previously, rules evaluating the <code class="literal">modprobe</code> configuration would fail even after applying remediations due to a mismatch in values for the <code class="literal">modprobe</code> configuration. Now, the same values are used for the <code class="literal">modprobe</code> configuration in checks and remediations, ensuring consistent results. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2117747"><span class="strong strong"><strong>BZ#2117747</strong></span></a>)
							</li></ul></div></section><section class="section" id="compliance-operator-0-1-57-deprecations"><div class="titlepage"><div><div><h4 class="title">5.2.7.3. Deprecations</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Specifying <span class="strong strong"><strong>Install into all namespaces in the cluster</strong></span> or setting the <code class="literal">WATCH_NAMESPACES</code> environment variable to <code class="literal">""</code> no longer affects all namespaces. Any API resources installed in namespaces not specified at the time of Compliance Operator installation is no longer be operational. API resources might require creation in the selected namespace, or the <code class="literal">openshift-compliance</code> namespace by default. This change improves the Compliance Operator’s memory usage.
							</li></ul></div></section></section><section class="section" id="compliance-operator-release-notes-0-1-53"><div class="titlepage"><div><div><h3 class="title">5.2.8. OpenShift Compliance Operator 0.1.53</h3></div></div></div><p>
					The following advisory is available for the OpenShift Compliance Operator 0.1.53:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2022:5537">RHBA-2022:5537 - OpenShift Compliance Operator bug fix update</a>
						</li></ul></div><section class="section" id="compliance-operator-0-1-53-bug-fixes"><div class="titlepage"><div><div><h4 class="title">5.2.8.1. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, the <code class="literal">ocp4-kubelet-enable-streaming-connections</code> rule contained an incorrect variable comparison, resulting in false positive scan results. Now, the Compliance Operator provides accurate scan results when setting <code class="literal">streamingConnectionIdleTimeout</code>. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2069891"><span class="strong strong"><strong>BZ#2069891</strong></span></a>)
							</li><li class="listitem">
								Previously, group ownership for <code class="literal">/etc/openvswitch/conf.db</code> was incorrect on IBM Z architectures, resulting in <code class="literal">ocp4-cis-node-worker-file-groupowner-ovs-conf-db</code> check failures. Now, the check is marked <code class="literal">NOT-APPLICABLE</code> on IBM Z architecture systems. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2072597"><span class="strong strong"><strong>BZ#2072597</strong></span></a>)
							</li><li class="listitem">
								Previously, the <code class="literal">ocp4-cis-scc-limit-container-allowed-capabilities</code> rule reported in a <code class="literal">FAIL</code> state due to incomplete data regarding the security context constraints (SCC) rules in the deployment. Now, the result is <code class="literal">MANUAL</code>, which is consistent with other checks that require human intervention. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2077916"><span class="strong strong"><strong>BZ#2077916</strong></span></a>)
							</li><li class="listitem"><p class="simpara">
								Previously, the following rules failed to account for additional configuration paths for API servers and TLS certificates and keys, resulting in reported failures even if the certificates and keys were set properly:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">ocp4-cis-api-server-kubelet-client-cert</code>
									</li><li class="listitem">
										<code class="literal">ocp4-cis-api-server-kubelet-client-key</code>
									</li><li class="listitem">
										<code class="literal">ocp4-cis-kubelet-configure-tls-cert</code>
									</li><li class="listitem">
										<code class="literal">ocp4-cis-kubelet-configure-tls-key</code>
									</li></ul></div><p class="simpara">
								Now, the rules report accurately and observe legacy file paths specified in the kubelet configuration file. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2079813"><span class="strong strong"><strong>BZ#2079813</strong></span></a>)
							</p></li><li class="listitem">
								Previously, the <code class="literal">content_rule_oauth_or_oauthclient_inactivity_timeout</code> rule did not account for a configurable timeout set by the deployment when assessing compliance for timeouts. This resulted in the rule failing even if the timeout was valid. Now, the Compliance Operator uses the <code class="literal">var_oauth_inactivity_timeout</code> variable to set valid timeout length. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2081952"><span class="strong strong"><strong>BZ#2081952</strong></span></a>)
							</li><li class="listitem">
								Previously, the Compliance Operator used administrative permissions on namespaces not labeled appropriately for privileged use, resulting in warning messages regarding pod security-level violations. Now, the Compliance Operator has appropriate namespace labels and permission adjustments to access results without violating permissions. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2088202"><span class="strong strong"><strong>BZ#2088202</strong></span></a>)
							</li><li class="listitem">
								Previously, applying auto remediations for <code class="literal">rhcos4-high-master-sysctl-kernel-yama-ptrace-scope</code> and <code class="literal">rhcos4-sysctl-kernel-core-pattern</code> resulted in subsequent failures of those rules in scan results, even though they were remediated. Now, the rules report <code class="literal">PASS</code> accurately, even after remediations are applied.(<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2094382"><span class="strong strong"><strong>BZ#2094382</strong></span></a>)
							</li><li class="listitem">
								Previously, the Compliance Operator would fail in a <code class="literal">CrashLoopBackoff</code> state because of out-of-memory exceptions. Now, the Compliance Operator is improved to handle large machine configuration data sets in memory and function correctly. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2094854"><span class="strong strong"><strong>BZ#2094854</strong></span></a>)
							</li></ul></div></section><section class="section" id="compliance-operator-0-1-53-known-issue"><div class="titlepage"><div><div><h4 class="title">5.2.8.2. Known issue</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								When <code class="literal">"debug":true</code> is set within the <code class="literal">ScanSettingBinding</code> object, the pods generated by the <code class="literal">ScanSettingBinding</code> object are not removed when that binding is deleted. As a workaround, run the following command to delete the remaining pods:
							</p><pre class="programlisting language-terminal">$ oc delete pods -l compliance.openshift.io/scan-name=ocp4-cis</pre><p class="simpara">
								(<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2092913"><span class="strong strong"><strong>BZ#2092913</strong></span></a>)
							</p></li></ul></div></section></section><section class="section" id="compliance-operator-release-notes-0-1-52"><div class="titlepage"><div><div><h3 class="title">5.2.9. OpenShift Compliance Operator 0.1.52</h3></div></div></div><p>
					The following advisory is available for the OpenShift Compliance Operator 0.1.52:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2022:4657">RHBA-2022:4657 - OpenShift Compliance Operator bug fix update</a>
						</li></ul></div><section class="section" id="compliance-operator-0-1-52-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">5.2.9.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The FedRAMP high SCAP profile is now available for use in OpenShift Container Platform environments. For more information, See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-operator-supported-profiles">Supported compliance profiles</a>.
							</li></ul></div></section><section class="section" id="compliance-operator-0-1-52-bug-fixes"><div class="titlepage"><div><div><h4 class="title">5.2.9.2. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, the <code class="literal">OpenScap</code> container would crash due to a mount permission issue in a security environment where <code class="literal">DAC_OVERRIDE</code> capability is dropped. Now, executable mount permissions are applied to all users. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2082151"><span class="strong strong"><strong>BZ#2082151</strong></span></a>)
							</li><li class="listitem">
								Previously, the compliance rule <code class="literal">ocp4-configure-network-policies</code> could be configured as <code class="literal">MANUAL</code>. Now, compliance rule <code class="literal">ocp4-configure-network-policies</code> is set to <code class="literal">AUTOMATIC</code>. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2072431"><span class="strong strong"><strong>BZ#2072431</strong></span></a>)
							</li><li class="listitem">
								Previously, the Cluster Autoscaler would fail to scale down because the Compliance Operator scan pods were never removed after a scan. Now, the pods are removed from each node by default unless explicitly saved for debugging purposes. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2075029"><span class="strong strong"><strong>BZ#2075029</strong></span></a>)
							</li><li class="listitem">
								Previously, applying the Compliance Operator to the <code class="literal">KubeletConfig</code> would result in the node going into a <code class="literal">NotReady</code> state due to unpausing the Machine Config Pools too early. Now, the Machine Config Pools are unpaused appropriately and the node operates correctly. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2071854"><span class="strong strong"><strong>BZ#2071854</strong></span></a>)
							</li><li class="listitem">
								Previously, the Machine Config Operator used <code class="literal">base64</code> instead of <code class="literal">url-encoded</code> code in the latest release, causing Compliance Operator remediation to fail. Now, the Compliance Operator checks encoding to handle both <code class="literal">base64</code> and <code class="literal">url-encoded</code> Machine Config code and the remediation applies correctly. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2082431"><span class="strong strong"><strong>BZ#2082431</strong></span></a>)
							</li></ul></div></section><section class="section" id="compliance-operator-0-1-52-known-issue"><div class="titlepage"><div><div><h4 class="title">5.2.9.3. Known issue</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								When <code class="literal">"debug":true</code> is set within the <code class="literal">ScanSettingBinding</code> object, the pods generated by the <code class="literal">ScanSettingBinding</code> object are not removed when that binding is deleted. As a workaround, run the following command to delete the remaining pods:
							</p><pre class="programlisting language-terminal">$ oc delete pods -l compliance.openshift.io/scan-name=ocp4-cis</pre><p class="simpara">
								(<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2092913"><span class="strong strong"><strong>BZ#2092913</strong></span></a>)
							</p></li></ul></div></section></section><section class="section" id="compliance-operator-release-notes-0-1-49"><div class="titlepage"><div><div><h3 class="title">5.2.10. OpenShift Compliance Operator 0.1.49</h3></div></div></div><p>
					The following advisory is available for the OpenShift Compliance Operator 0.1.49:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2022:1148">RHBA-2022:1148 - OpenShift Compliance Operator bug fix and enhancement update</a>
						</li></ul></div><section class="section" id="compliance-operator-0-1-49-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">5.2.10.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								The Compliance Operator is now supported on the following architectures:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										IBM Power
									</li><li class="listitem">
										IBM Z
									</li><li class="listitem">
										IBM LinuxONE
									</li></ul></div></li></ul></div></section><section class="section" id="compliance-operator-0-1-49-bug-fixes"><div class="titlepage"><div><div><h4 class="title">5.2.10.2. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, the <code class="literal">openshift-compliance</code> content did not include platform-specific checks for network types. As a result, OVN- and SDN-specific checks would show as <code class="literal">failed</code> instead of <code class="literal">not-applicable</code> based on the network configuration. Now, new rules contain platform checks for networking rules, resulting in a more accurate assessment of network-specific checks. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=1994609"><span class="strong strong"><strong>BZ#1994609</strong></span></a>)
							</li><li class="listitem">
								Previously, the <code class="literal">ocp4-moderate-routes-protected-by-tls</code> rule incorrectly checked TLS settings that results in the rule failing the check, even if the connection secure SSL/TLS protocol. Now, the check properly evaluates TLS settings that are consistent with the networking guidance and profile recommendations. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2002695"><span class="strong strong"><strong>BZ#2002695</strong></span></a>)
							</li><li class="listitem">
								Previously, <code class="literal">ocp-cis-configure-network-policies-namespace</code> used pagination when requesting namespaces. This caused the rule to fail because the deployments truncated lists of more than 500 namespaces. Now, the entire namespace list is requested, and the rule for checking configured network policies works for deployments with more than 500 namespaces. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2038909"><span class="strong strong"><strong>BZ#2038909</strong></span></a>)
							</li><li class="listitem">
								Previously, remediations using the <code class="literal">sshd jinja</code> macros were hard-coded to specific sshd configurations. As a result, the configurations were inconsistent with the content the rules were checking for and the check would fail. Now, the sshd configuration is parameterized and the rules apply successfully. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2049141"><span class="strong strong"><strong>BZ#2049141</strong></span></a>)
							</li><li class="listitem">
								Previously, the <code class="literal">ocp4-cluster-version-operator-verify-integrity</code> always checked the first entry in the Cluter Version Operator (CVO) history. As a result, the upgrade would fail in situations where subsequent versions of {product-name} would be verified. Now, the compliance check result for <code class="literal">ocp4-cluster-version-operator-verify-integrity</code> is able to detect verified versions and is accurate with the CVO history. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2053602"><span class="strong strong"><strong>BZ#2053602</strong></span></a>)
							</li><li class="listitem">
								Previously, the <code class="literal">ocp4-api-server-no-adm-ctrl-plugins-disabled</code> rule did not check for a list of empty admission controller plugins. As a result, the rule would always fail, even if all admission plugins were enabled. Now, more robust checking of the <code class="literal">ocp4-api-server-no-adm-ctrl-plugins-disabled</code> rule accurately passes with all admission controller plugins enabled. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2058631"><span class="strong strong"><strong>BZ#2058631</strong></span></a>)
							</li><li class="listitem">
								Previously, scans did not contain platform checks for running against Linux worker nodes. As a result, running scans against worker nodes that were not Linux-based resulted in a never ending scan loop. Now, the scan schedules appropriately based on platform type and labels complete successfully. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2056911"><span class="strong strong"><strong>BZ#2056911</strong></span></a>)
							</li></ul></div></section></section><section class="section" id="compliance-operator-release-notes-0-1-48"><div class="titlepage"><div><div><h3 class="title">5.2.11. OpenShift Compliance Operator 0.1.48</h3></div></div></div><p>
					The following advisory is available for the OpenShift Compliance Operator 0.1.48:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2022:0416">RHBA-2022:0416 - OpenShift Compliance Operator bug fix and enhancement update</a>
						</li></ul></div><section class="section" id="openshift-compliance-operator-0-1-48-bug-fixes"><div class="titlepage"><div><div><h4 class="title">5.2.11.1. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, some rules associated with extended Open Vulnerability and Assessment Language (OVAL) definitions had a <code class="literal">checkType</code> of <code class="literal">None</code>. This was because the Compliance Operator was not processing extended OVAL definitions when parsing rules. With this update, content from extended OVAL definitions is parsed so that these rules now have a <code class="literal">checkType</code> of either <code class="literal">Node</code> or <code class="literal">Platform</code>. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2040282"><span class="strong strong"><strong>BZ#2040282</strong></span></a>)
							</li><li class="listitem">
								Previously, a manually created <code class="literal">MachineConfig</code> object for <code class="literal">KubeletConfig</code> prevented a <code class="literal">KubeletConfig</code> object from being generated for remediation, leaving the remediation in the <code class="literal">Pending</code> state. With this release, a <code class="literal">KubeletConfig</code> object is created by the remediation, regardless if there is a manually created <code class="literal">MachineConfig</code> object for <code class="literal">KubeletConfig</code>. As a result, <code class="literal">KubeletConfig</code> remediations now work as expected. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2040401"><span class="strong strong"><strong>BZ#2040401</strong></span></a>)
							</li></ul></div></section></section><section class="section" id="compliance-operator-release-notes-0-1-47"><div class="titlepage"><div><div><h3 class="title">5.2.12. OpenShift Compliance Operator 0.1.47</h3></div></div></div><p>
					The following advisory is available for the OpenShift Compliance Operator 0.1.47:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2022:0014">RHBA-2022:0014 - OpenShift Compliance Operator bug fix and enhancement update</a>
						</li></ul></div><section class="section" id="compliance-operator-0-1-47-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">5.2.12.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								The Compliance Operator now supports the following compliance benchmarks for the Payment Card Industry Data Security Standard (PCI DSS):
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										ocp4-pci-dss
									</li><li class="listitem">
										ocp4-pci-dss-node
									</li></ul></div></li><li class="listitem">
								Additional rules and remediations for FedRAMP moderate impact level are added to the OCP4-moderate, OCP4-moderate-node, and rhcos4-moderate profiles.
							</li><li class="listitem">
								Remediations for KubeletConfig are now available in node-level profiles.
							</li></ul></div></section><section class="section" id="openshift-compliance-operator-0-1-47-bug-fixes"><div class="titlepage"><div><div><h4 class="title">5.2.12.2. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Previously, if your cluster was running OpenShift Container Platform 4.6 or earlier, remediations for USBGuard-related rules would fail for the moderate profile. This is because the remediations created by the Compliance Operator were based on an older version of USBGuard that did not support drop-in directories. Now, invalid remediations for USBGuard-related rules are not created for clusters running OpenShift Container Platform 4.6. If your cluster is using OpenShift Container Platform 4.6, you must manually create remediations for USBGuard-related rules.
							</p><p class="simpara">
								Additionally, remediations are created only for rules that satisfy minimum version requirements. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=1965511"><span class="strong strong"><strong>BZ#1965511</strong></span></a>)
							</p></li><li class="listitem">
								Previously, when rendering remediations, the compliance operator would check that the remediation was well-formed by using a regular expression that was too strict. As a result, some remediations, such as those that render <code class="literal">sshd_config</code>, would not pass the regular expression check and therefore, were not created. The regular expression was found to be unnecessary and removed. Remediations now render correctly. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2033009"><span class="strong strong"><strong>BZ#2033009</strong></span></a>)
							</li></ul></div></section></section><section class="section" id="compliance-operator-release-notes-0-1-44"><div class="titlepage"><div><div><h3 class="title">5.2.13. OpenShift Compliance Operator 0.1.44</h3></div></div></div><p>
					The following advisory is available for the OpenShift Compliance Operator 0.1.44:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2021:4530">RHBA-2021:4530 - OpenShift Compliance Operator bug fix and enhancement update</a>
						</li></ul></div><section class="section" id="compliance-operator-0-1-44-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">5.2.13.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								In this release, the <code class="literal">strictNodeScan</code> option is now added to the <code class="literal">ComplianceScan</code>, <code class="literal">ComplianceSuite</code> and <code class="literal">ScanSetting</code> CRs. This option defaults to <code class="literal">true</code> which matches the previous behavior, where an error occurred if a scan was not able to be scheduled on a node. Setting the option to <code class="literal">false</code> allows the Compliance Operator to be more permissive about scheduling scans. Environments with ephemeral nodes can set the <code class="literal">strictNodeScan</code> value to false, which allows a compliance scan to proceed, even if some of the nodes in the cluster are not available for scheduling.
							</li><li class="listitem">
								You can now customize the node that is used to schedule the result server workload by configuring the <code class="literal">nodeSelector</code> and <code class="literal">tolerations</code> attributes of the <code class="literal">ScanSetting</code> object. These attributes are used to place the <code class="literal">ResultServer</code> pod, the pod that is used to mount a PV storage volume and store the raw Asset Reporting Format (ARF) results. Previously, the <code class="literal">nodeSelector</code> and the <code class="literal">tolerations</code> parameters defaulted to selecting one of the control plane nodes and tolerating the <code class="literal">node-role.kubernetes.io/master taint</code>. This did not work in environments where control plane nodes are not permitted to mount PVs. This feature provides a way for you to select the node and tolerate a different taint in those environments.
							</li><li class="listitem">
								The Compliance Operator can now remediate <code class="literal">KubeletConfig</code> objects.
							</li><li class="listitem">
								A comment containing an error message is now added to help content developers differentiate between objects that do not exist in the cluster compared to objects that cannot be fetched.
							</li><li class="listitem">
								Rule objects now contain two new attributes, <code class="literal">checkType</code> and <code class="literal">description</code>. These attributes allow you to determine if the rule pertains to a node check or platform check, and also allow you to review what the rule does.
							</li><li class="listitem">
								This enhancement removes the requirement that you have to extend an existing profile to create a tailored profile. This means the <code class="literal">extends</code> field in the <code class="literal">TailoredProfile</code> CRD is no longer mandatory. You can now select a list of rule objects to create a tailored profile. Note that you must select whether your profile applies to nodes or the platform by setting the <code class="literal">compliance.openshift.io/product-type:</code> annotation or by setting the <code class="literal">-node</code> suffix for the <code class="literal">TailoredProfile</code> CR.
							</li><li class="listitem">
								In this release, the Compliance Operator is now able to schedule scans on all nodes irrespective of their taints. Previously, the scan pods would only tolerated the <code class="literal">node-role.kubernetes.io/master taint</code>, meaning that they would either ran on nodes with no taints or only on nodes with the <code class="literal">node-role.kubernetes.io/master</code> taint. In deployments that use custom taints for their nodes, this resulted in the scans not being scheduled on those nodes. Now, the scan pods tolerate all node taints.
							</li><li class="listitem"><p class="simpara">
								In this release, the Compliance Operator supports the following North American Electric Reliability Corporation (NERC) security profiles:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										ocp4-nerc-cip
									</li><li class="listitem">
										ocp4-nerc-cip-node
									</li><li class="listitem">
										rhcos4-nerc-cip
									</li></ul></div></li><li class="listitem">
								In this release, the Compliance Operator supports the NIST 800-53 Moderate-Impact Baseline for the Red Hat OpenShift - Node level, ocp4-moderate-node, security profile.
							</li></ul></div></section><section class="section" id="openshift-compliance-operator-0-1-44-templating"><div class="titlepage"><div><div><h4 class="title">5.2.13.2. Templating and variable use</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								In this release, the remediation template now allows multi-value variables.
							</li><li class="listitem">
								With this update, the Compliance Operator can change remediations based on variables that are set in the compliance profile. This is useful for remediations that include deployment-specific values such as time outs, NTP server host names, or similar. Additionally, the <code class="literal">ComplianceCheckResult</code> objects now use the label <code class="literal">compliance.openshift.io/check-has-value</code> that lists the variables a check has used.
							</li></ul></div></section><section class="section" id="openshift-compliance-operator-0-1-44-bug-fixes"><div class="titlepage"><div><div><h4 class="title">5.2.13.3. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, while performing a scan, an unexpected termination occurred in one of the scanner containers of the pods. In this release, the Compliance Operator uses the latest OpenSCAP version 1.3.5 to avoid a crash.
							</li><li class="listitem">
								Previously, using <code class="literal">autoReplyRemediations</code> to apply remediations triggered an update of the cluster nodes. This was disruptive if some of the remediations did not include all of the required input variables. Now, if a remediation is missing one or more required input variables, it is assigned a state of <code class="literal">NeedsReview</code>. If one or more remediations are in a <code class="literal">NeedsReview</code> state, the machine config pool remains paused, and the remediations are not applied until all of the required variables are set. This helps minimize disruption to the nodes.
							</li><li class="listitem">
								The RBAC Role and Role Binding used for Prometheus metrics are changed to 'ClusterRole' and 'ClusterRoleBinding' to ensure that monitoring works without customization.
							</li><li class="listitem">
								Previously, if an error occurred while parsing a profile, rules or variables objects were removed and deleted from the profile. Now, if an error occurs during parsing, the <code class="literal">profileparser</code> annotates the object with a temporary annotation that prevents the object from being deleted until after parsing completes. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=1988259"><span class="strong strong"><strong>BZ#1988259</strong></span></a>)
							</li><li class="listitem">
								Previously, an error occurred if titles or descriptions were missing from a tailored profile. Because the XCCDF standard requires titles and descriptions for tailored profiles, titles and descriptions are now required to be set in <code class="literal">TailoredProfile</code> CRs.
							</li><li class="listitem">
								Previously, when using tailored profiles, <code class="literal">TailoredProfile</code> variable values were allowed to be set using only a specific selection set. This restriction is now removed, and <code class="literal">TailoredProfile</code> variables can be set to any value.
							</li></ul></div></section></section><section class="section" id="compliance-operator-release-notes-0-1-39"><div class="titlepage"><div><div><h3 class="title">5.2.14. Release Notes for Compliance Operator 0.1.39</h3></div></div></div><p>
					The following advisory is available for the OpenShift Compliance Operator 0.1.39:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2021:3214">RHBA-2021:3214 - OpenShift Compliance Operator bug fix and enhancement update</a>
						</li></ul></div><section class="section" id="compliance-operator-0-1-39-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">5.2.14.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, the Compliance Operator was unable to parse Payment Card Industry Data Security Standard (PCI DSS) references. Now, the Operator can parse compliance content that ships with PCI DSS profiles.
							</li><li class="listitem">
								Previously, the Compliance Operator was unable to execute rules for AU-5 control in the moderate profile. Now, permission is added to the Operator so that it can read <span class="strong strong"><strong>Prometheusrules.monitoring.coreos.com</strong></span> objects and run the rules that cover AU-5 control in the moderate profile.
							</li></ul></div></section></section><section class="section _additional-resources" id="compliance-operator-release-notes_additional-resources"><div class="titlepage"><div><div><h3 class="title">5.2.15. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#understanding-compliance-operator">Understanding the Compliance Operator</a>
						</li></ul></div></section></section><section class="section" id="compliance-operator-concepts-2"><div class="titlepage"><div><div><h2 class="title">5.3. Compliance Operator concepts</h2></div></div></div><section class="section" id="understanding-compliance-operator"><div class="titlepage"><div><div><h3 class="title">5.3.1. Understanding the Compliance Operator</h3></div></div></div><p>
					The Compliance Operator lets OpenShift Container Platform administrators describe the required compliance state of a cluster and provides them with an overview of gaps and ways to remediate them. The Compliance Operator assesses compliance of both the Kubernetes API resources of OpenShift Container Platform, as well as the nodes running the cluster. The Compliance Operator uses OpenSCAP, a NIST-certified tool, to scan and enforce security policies provided by the content.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The Compliance Operator is available for Red Hat Enterprise Linux CoreOS (RHCOS) deployments only.
					</p></div></div><section class="section" id="compliance_profiles_understanding-compliance"><div class="titlepage"><div><div><h4 class="title">5.3.1.1. Compliance Operator profiles</h4></div></div></div><p>
						There are several profiles available as part of the Compliance Operator installation. You can use the <code class="literal">oc get</code> command to view available profiles, profile details, and specific rules.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								View the available profiles:
							</p><pre class="programlisting language-terminal">$ oc get -n openshift-compliance profiles.compliance</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                 AGE
ocp4-cis             94m
ocp4-cis-node        94m
ocp4-e8              94m
ocp4-high            94m
ocp4-high-node       94m
ocp4-moderate        94m
ocp4-moderate-node   94m
ocp4-nerc-cip        94m
ocp4-nerc-cip-node   94m
ocp4-pci-dss         94m
ocp4-pci-dss-node    94m
rhcos4-e8            94m
rhcos4-high          94m
rhcos4-moderate      94m
rhcos4-nerc-cip      94m</pre>

								</p></div><p class="simpara">
								These profiles represent different compliance benchmarks. Each profile has the product name that it applies to added as a prefix to the profile’s name. <code class="literal">ocp4-e8</code> applies the Essential 8 benchmark to the OpenShift Container Platform product, while <code class="literal">rhcos4-e8</code> applies the Essential 8 benchmark to the Red Hat Enterprise Linux CoreOS (RHCOS) product.
							</p></li><li class="listitem"><p class="simpara">
								Run the following command to view the details of the <code class="literal">rhcos4-e8</code> profile:
							</p><pre class="programlisting language-terminal">$ oc get -n openshift-compliance -oyaml profiles.compliance rhcos4-e8</pre><div class="example" id="idm139961137843088"><p class="title"><strong>Example 5.1. Example output</strong></p><div class="example-contents"><pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
description: 'This profile contains configuration checks for Red Hat Enterprise Linux
  CoreOS that align to the Australian Cyber Security Centre (ACSC) Essential Eight.
  A copy of the Essential Eight in Linux Environments guide can be found at the ACSC
  website: https://www.cyber.gov.au/acsc/view-all-content/publications/hardening-linux-workstations-and-servers'
id: xccdf_org.ssgproject.content_profile_e8
kind: Profile
metadata:
  annotations:
    compliance.openshift.io/image-digest: pb-rhcos4hrdkm
    compliance.openshift.io/product: redhat_enterprise_linux_coreos_4
    compliance.openshift.io/product-type: Node
  creationTimestamp: "2022-10-19T12:06:49Z"
  generation: 1
  labels:
    compliance.openshift.io/profile-bundle: rhcos4
  name: rhcos4-e8
  namespace: openshift-compliance
  ownerReferences:
  - apiVersion: compliance.openshift.io/v1alpha1
    blockOwnerDeletion: true
    controller: true
    kind: ProfileBundle
    name: rhcos4
    uid: 22350850-af4a-4f5c-9a42-5e7b68b82d7d
  resourceVersion: "43699"
  uid: 86353f70-28f7-40b4-bf0e-6289ec33675b
rules:
- rhcos4-accounts-no-uid-except-zero
- rhcos4-audit-rules-dac-modification-chmod
- rhcos4-audit-rules-dac-modification-chown
- rhcos4-audit-rules-execution-chcon
- rhcos4-audit-rules-execution-restorecon
- rhcos4-audit-rules-execution-semanage
- rhcos4-audit-rules-execution-setfiles
- rhcos4-audit-rules-execution-setsebool
- rhcos4-audit-rules-execution-seunshare
- rhcos4-audit-rules-kernel-module-loading-delete
- rhcos4-audit-rules-kernel-module-loading-finit
- rhcos4-audit-rules-kernel-module-loading-init
- rhcos4-audit-rules-login-events
- rhcos4-audit-rules-login-events-faillock
- rhcos4-audit-rules-login-events-lastlog
- rhcos4-audit-rules-login-events-tallylog
- rhcos4-audit-rules-networkconfig-modification
- rhcos4-audit-rules-sysadmin-actions
- rhcos4-audit-rules-time-adjtimex
- rhcos4-audit-rules-time-clock-settime
- rhcos4-audit-rules-time-settimeofday
- rhcos4-audit-rules-time-stime
- rhcos4-audit-rules-time-watch-localtime
- rhcos4-audit-rules-usergroup-modification
- rhcos4-auditd-data-retention-flush
- rhcos4-auditd-freq
- rhcos4-auditd-local-events
- rhcos4-auditd-log-format
- rhcos4-auditd-name-format
- rhcos4-auditd-write-logs
- rhcos4-configure-crypto-policy
- rhcos4-configure-ssh-crypto-policy
- rhcos4-no-empty-passwords
- rhcos4-selinux-policytype
- rhcos4-selinux-state
- rhcos4-service-auditd-enabled
- rhcos4-sshd-disable-empty-passwords
- rhcos4-sshd-disable-gssapi-auth
- rhcos4-sshd-disable-rhosts
- rhcos4-sshd-disable-root-login
- rhcos4-sshd-disable-user-known-hosts
- rhcos4-sshd-do-not-permit-user-env
- rhcos4-sshd-enable-strictmodes
- rhcos4-sshd-print-last-log
- rhcos4-sshd-set-loglevel-info
- rhcos4-sysctl-kernel-dmesg-restrict
- rhcos4-sysctl-kernel-kptr-restrict
- rhcos4-sysctl-kernel-randomize-va-space
- rhcos4-sysctl-kernel-unprivileged-bpf-disabled
- rhcos4-sysctl-kernel-yama-ptrace-scope
- rhcos4-sysctl-net-core-bpf-jit-harden
title: Australian Cyber Security Centre (ACSC) Essential Eight</pre></div></div></li><li class="listitem"><p class="simpara">
								Run the following command to view the details of the <code class="literal">rhcos4-audit-rules-login-events</code> rule:
							</p><pre class="programlisting language-terminal">$ oc get -n openshift-compliance -oyaml rules rhcos4-audit-rules-login-events</pre><div class="example" id="idm139961137335184"><p class="title"><strong>Example 5.2. Example output</strong></p><div class="example-contents"><pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
checkType: Node
description: |-
  The audit system already collects login information for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d in order to watch for attempted manual edits of files involved in storing logon events:

  -w /var/log/tallylog -p wa -k logins
  -w /var/run/faillock -p wa -k logins
  -w /var/log/lastlog -p wa -k logins

  If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file in order to watch for unattempted manual edits of files involved in storing logon events:

  -w /var/log/tallylog -p wa -k logins
  -w /var/run/faillock -p wa -k logins
  -w /var/log/lastlog -p wa -k logins
id: xccdf_org.ssgproject.content_rule_audit_rules_login_events
kind: Rule
metadata:
  annotations:
    compliance.openshift.io/image-digest: pb-rhcos4hrdkm
    compliance.openshift.io/rule: audit-rules-login-events
    control.compliance.openshift.io/NIST-800-53: AU-2(d);AU-12(c);AC-6(9);CM-6(a)
    control.compliance.openshift.io/PCI-DSS: Req-10.2.3
    policies.open-cluster-management.io/controls: AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.3
    policies.open-cluster-management.io/standards: NIST-800-53,PCI-DSS
  creationTimestamp: "2022-10-19T12:07:08Z"
  generation: 1
  labels:
    compliance.openshift.io/profile-bundle: rhcos4
  name: rhcos4-audit-rules-login-events
  namespace: openshift-compliance
  ownerReferences:
  - apiVersion: compliance.openshift.io/v1alpha1
    blockOwnerDeletion: true
    controller: true
    kind: ProfileBundle
    name: rhcos4
    uid: 22350850-af4a-4f5c-9a42-5e7b68b82d7d
  resourceVersion: "44819"
  uid: 75872f1f-3c93-40ca-a69d-44e5438824a4
rationale: Manual editing of these files may indicate nefarious activity, such as
  an attacker attempting to remove evidence of an intrusion.
severity: medium
title: Record Attempts to Alter Logon and Logout Events
warning: Manual editing of these files may indicate nefarious activity, such as an
  attacker attempting to remove evidence of an intrusion.</pre></div></div></li></ul></div><section class="section" id="compliance_profile_types_understanding-compliance"><div class="titlepage"><div><div><h5 class="title">5.3.1.1.1. Compliance Operator profile types</h5></div></div></div><p>
							There are two types of compliance profiles available: Platform and Node.
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Platform</span></dt><dd>
										Platform scans target your OpenShift Container Platform cluster.
									</dd><dt><span class="term">Node</span></dt><dd>
										Node scans target the nodes of the cluster.
									</dd></dl></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								For compliance profiles that have Node and Platform applications, such as <code class="literal">pci-dss</code> compliance profiles, you must run both in your OpenShift Container Platform environment.
							</p></div></div></section></section><section class="section _additional-resources" id="additional-resources_compliance-operator-understanding"><div class="titlepage"><div><div><h4 class="title">5.3.1.2. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-operator-supported-profiles">Supported compliance profiles</a>
							</li></ul></div></section></section><section class="section" id="custom-resource-definitions"><div class="titlepage"><div><div><h3 class="title">5.3.2. Understanding the Custom Resource Definitions</h3></div></div></div><p>
					The Compliance Operator in the OpenShift Container Platform provides you with several Custom Resource Definitions (CRDs) to accomplish the compliance scans. To run a compliance scan, it leverages the predefined security policies, which are derived from the <a class="link" href="https://github.com/ComplianceAsCode/content">ComplianceAsCode</a> community project. The Compliance Operator converts these security policies into CRDs, which you can use to run compliance scans and get remediations for the issues found.
				</p><section class="section" id="custom-resource-definitions-workflow_compliance-crd"><div class="titlepage"><div><div><h4 class="title">5.3.2.1. CRDs workflow</h4></div></div></div><p>
						The CRD provides you the following workflow to complete the compliance scans:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Define your compliance scan requirements
							</li><li class="listitem">
								Configure the compliance scan settings
							</li><li class="listitem">
								Process compliance requirements with compliance scans settings
							</li><li class="listitem">
								Monitor the compliance scans
							</li><li class="listitem">
								Check the compliance scan results
							</li></ol></div></section><section class="section" id="defining-compliance-scan-requirements_compliance-crd"><div class="titlepage"><div><div><h4 class="title">5.3.2.2. Defining the compliance scan requirements</h4></div></div></div><p>
						By default, the Compliance Operator CRDs include <code class="literal">ProfileBundle</code> and <code class="literal">Profile</code> objects, in which you can define and set the rules for your compliance scan requirements. You can also customize the default profiles by using a <code class="literal">TailoredProfile</code> object.
					</p><section class="section" id="profile-bundle-object_compliance-crd"><div class="titlepage"><div><div><h5 class="title">5.3.2.2.1. ProfileBundle object</h5></div></div></div><p>
							When you install the Compliance Operator, it includes ready-to-run <code class="literal">ProfileBundle</code> objects. The Compliance Operator parses the <code class="literal">ProfileBundle</code> object and creates a <code class="literal">Profile</code> object for each profile in the bundle. It also parses <code class="literal">Rule</code> and <code class="literal">Variable</code> objects, which are used by the <code class="literal">Profile</code> object.
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">ProfileBundle</code> object</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ProfileBundle
  name: &lt;profile bundle name&gt;
  namespace: openshift-compliance
status:
  dataStreamStatus: VALID <span id="CO16-1"><!--Empty--></span><span class="callout">1</span></pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO16-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Indicates whether the Compliance Operator was able to parse the content files.
								</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								When the <code class="literal">contentFile</code> fails, an <code class="literal">errorMessage</code> attribute appears, which provides details of the error that occurred.
							</p></div></div><div class="formalpara"><p class="title"><strong>Troubleshooting</strong></p><p>
								When you roll back to a known content image from an invalid image, the <code class="literal">ProfileBundle</code> object stops responding and displays <code class="literal">PENDING</code> state. As a workaround, you can move to a different image than the previous one. Alternatively, you can delete and re-create the <code class="literal">ProfileBundle</code> object to return to the working state.
							</p></div></section><section class="section" id="profile-object_compliance-crd"><div class="titlepage"><div><div><h5 class="title">5.3.2.2.2. Profile object</h5></div></div></div><p>
							The <code class="literal">Profile</code> object defines the rules and variables that can be evaluated for a certain compliance standard. It contains parsed out details about an OpenSCAP profile, such as its XCCDF identifier and profile checks for a <code class="literal">Node</code> or <code class="literal">Platform</code> type. You can either directly use the <code class="literal">Profile</code> object or further customize it using a <code class="literal">TailorProfile</code> object.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								You cannot create or modify the <code class="literal">Profile</code> object manually because it is derived from a single <code class="literal">ProfileBundle</code> object. Typically, a single <code class="literal">ProfileBundle</code> object can include several <code class="literal">Profile</code> objects.
							</p></div></div><div class="formalpara"><p class="title"><strong>Example <code class="literal">Profile</code> object</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
description: &lt;description of the profile&gt;
id: xccdf_org.ssgproject.content_profile_moderate <span id="CO17-1"><!--Empty--></span><span class="callout">1</span>
kind: Profile
metadata:
  annotations:
    compliance.openshift.io/product: &lt;product name&gt;
    compliance.openshift.io/product-type: Node <span id="CO17-2"><!--Empty--></span><span class="callout">2</span>
  creationTimestamp: "YYYY-MM-DDTMM:HH:SSZ"
  generation: 1
  labels:
    compliance.openshift.io/profile-bundle: &lt;profile bundle name&gt;
  name: rhcos4-moderate
  namespace: openshift-compliance
  ownerReferences:
  - apiVersion: compliance.openshift.io/v1alpha1
    blockOwnerDeletion: true
    controller: true
    kind: ProfileBundle
    name: &lt;profile bundle name&gt;
    uid: &lt;uid string&gt;
  resourceVersion: "&lt;version number&gt;"
  selfLink: /apis/compliance.openshift.io/v1alpha1/namespaces/openshift-compliance/profiles/rhcos4-moderate
  uid: &lt;uid string&gt;
rules: <span id="CO17-3"><!--Empty--></span><span class="callout">3</span>
- rhcos4-account-disable-post-pw-expiration
- rhcos4-accounts-no-uid-except-zero
- rhcos4-audit-rules-dac-modification-chmod
- rhcos4-audit-rules-dac-modification-chown
title: &lt;title of the profile&gt;</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO17-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Specify the XCCDF name of the profile. Use this identifier when you define a <code class="literal">ComplianceScan</code> object as the value of the profile attribute of the scan.
								</div></dd><dt><a href="#CO17-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Specify either a <code class="literal">Node</code> or <code class="literal">Platform</code>. Node profiles scan the cluster nodes and platform profiles scan the Kubernetes platform.
								</div></dd><dt><a href="#CO17-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Specify the list of rules for the profile. Each rule corresponds to a single check.
								</div></dd></dl></div></section><section class="section" id="rule-object_compliance-crd"><div class="titlepage"><div><div><h5 class="title">5.3.2.2.3. Rule object</h5></div></div></div><p>
							The <code class="literal">Rule</code> object, which forms the profiles, are also exposed as objects. Use the <code class="literal">Rule</code> object to define your compliance check requirements and specify how it could be fixed.
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">Rule</code> object</strong></p><p>
								
<pre class="programlisting language-yaml">    apiVersion: compliance.openshift.io/v1alpha1
    checkType: Platform <span id="CO18-1"><!--Empty--></span><span class="callout">1</span>
    description: &lt;description of the rule&gt;
    id: xccdf_org.ssgproject.content_rule_configure_network_policies_namespaces <span id="CO18-2"><!--Empty--></span><span class="callout">2</span>
    instructions: &lt;manual instructions for the scan&gt;
    kind: Rule
    metadata:
      annotations:
        compliance.openshift.io/rule: configure-network-policies-namespaces
        control.compliance.openshift.io/CIS-OCP: 5.3.2
        control.compliance.openshift.io/NERC-CIP: CIP-003-3 R4;CIP-003-3 R4.2;CIP-003-3
          R5;CIP-003-3 R6;CIP-004-3 R2.2.4;CIP-004-3 R3;CIP-007-3 R2;CIP-007-3 R2.1;CIP-007-3
          R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R6.1
        control.compliance.openshift.io/NIST-800-53: AC-4;AC-4(21);CA-3(5);CM-6;CM-6(1);CM-7;CM-7(1);SC-7;SC-7(3);SC-7(5);SC-7(8);SC-7(12);SC-7(13);SC-7(18)
      labels:
        compliance.openshift.io/profile-bundle: ocp4
      name: ocp4-configure-network-policies-namespaces
      namespace: openshift-compliance
    rationale: &lt;description of why this rule is checked&gt;
    severity: high <span id="CO18-3"><!--Empty--></span><span class="callout">3</span>
    title: &lt;summary of the rule&gt;</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO18-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Specify the type of check this rule executes. <code class="literal">Node</code> profiles scan the cluster nodes and <code class="literal">Platform</code> profiles scan the Kubernetes platform. An empty value indicates there is no automated check.
								</div></dd><dt><a href="#CO18-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Specify the XCCDF name of the rule, which is parsed directly from the datastream.
								</div></dd><dt><a href="#CO18-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Specify the severity of the rule when it fails.
								</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The <code class="literal">Rule</code> object gets an appropriate label for an easy identification of the associated <code class="literal">ProfileBundle</code> object. The <code class="literal">ProfileBundle</code> also gets specified in the <code class="literal">OwnerReferences</code> of this object.
							</p></div></div></section><section class="section" id="tailored-profile-object_compliance-crd"><div class="titlepage"><div><div><h5 class="title">5.3.2.2.4. TailoredProfile object</h5></div></div></div><p>
							Use the <code class="literal">TailoredProfile</code> object to modify the default <code class="literal">Profile</code> object based on your organization requirements. You can enable or disable rules, set variable values, and provide justification for the customization. After validation, the <code class="literal">TailoredProfile</code> object creates a <code class="literal">ConfigMap</code>, which can be referenced by a <code class="literal">ComplianceScan</code> object.
						</p><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
							You can use the <code class="literal">TailoredProfile</code> object by referencing it in a <code class="literal">ScanSettingBinding</code> object. For more information about <code class="literal">ScanSettingBinding</code>, see ScanSettingBinding object.
						</p></div></div><div class="formalpara"><p class="title"><strong>Example <code class="literal">TailoredProfile</code> object</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: TailoredProfile
metadata:
  name: rhcos4-with-usb
spec:
  extends: rhcos4-moderate <span id="CO19-1"><!--Empty--></span><span class="callout">1</span>
  title: &lt;title of the tailored profile&gt;
  disableRules:
    - name: &lt;name of a rule object to be disabled&gt;
      rationale: &lt;description of why this rule is checked&gt;
status:
  id: xccdf_compliance.openshift.io_profile_rhcos4-with-usb <span id="CO19-2"><!--Empty--></span><span class="callout">2</span>
  outputRef:
    name: rhcos4-with-usb-tp <span id="CO19-3"><!--Empty--></span><span class="callout">3</span>
    namespace: openshift-compliance
  state: READY <span id="CO19-4"><!--Empty--></span><span class="callout">4</span></pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO19-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									This is optional. Name of the <code class="literal">Profile</code> object upon which the <code class="literal">TailoredProfile</code> is built. If no value is set, a new profile is created from the <code class="literal">enableRules</code> list.
								</div></dd><dt><a href="#CO19-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Specifies the XCCDF name of the tailored profile.
								</div></dd><dt><a href="#CO19-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Specifies the <code class="literal">ConfigMap</code> name, which can be used as the value of the <code class="literal">tailoringConfigMap.name</code> attribute of a <code class="literal">ComplianceScan</code>.
								</div></dd><dt><a href="#CO19-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									Shows the state of the object such as <code class="literal">READY</code>, <code class="literal">PENDING</code>, and <code class="literal">FAILURE</code>. If the state of the object is <code class="literal">ERROR</code>, then the attribute <code class="literal">status.errorMessage</code> provides the reason for the failure.
								</div></dd></dl></div><p>
							With the <code class="literal">TailoredProfile</code> object, it is possible to create a new <code class="literal">Profile</code> object using the <code class="literal">TailoredProfile</code> construct. To create a new <code class="literal">Profile</code>, set the following configuration parameters :
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									an appropriate title
								</li><li class="listitem">
									<code class="literal">extends</code> value must be empty
								</li><li class="listitem"><p class="simpara">
									scan type annotation on the <code class="literal">TailoredProfile</code> object:
								</p><pre class="programlisting language-yaml">compliance.openshift.io/product-type: Platform/Node</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										If you have not set the <code class="literal">product-type</code> annotation, the Compliance Operator defaults to <code class="literal">Platform</code> scan type. Adding the <code class="literal">-node</code> suffix to the name of the <code class="literal">TailoredProfile</code> object results in <code class="literal">node</code> scan type.
									</p></div></div></li></ul></div></section></section><section class="section" id="configure-compliance-scan-settings_compliance-crd"><div class="titlepage"><div><div><h4 class="title">5.3.2.3. Configuring the compliance scan settings</h4></div></div></div><p>
						After you have defined the requirements of the compliance scan, you can configure it by specifying the type of the scan, occurrence of the scan, and location of the scan. To do so, Compliance Operator provides you with a <code class="literal">ScanSetting</code> object.
					</p><section class="section" id="scan-setting-object_compliance-crd"><div class="titlepage"><div><div><h5 class="title">5.3.2.3.1. ScanSetting object</h5></div></div></div><p>
							Use the <code class="literal">ScanSetting</code> object to define and reuse the operational policies to run your scans. By default, the Compliance Operator creates the following <code class="literal">ScanSetting</code> objects:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>default</strong></span> - it runs a scan every day at 1 AM on both master and worker nodes using a 1Gi Persistent Volume (PV) and keeps the last three results. Remediation is neither applied nor updated automatically.
								</li><li class="listitem">
									<span class="strong strong"><strong>default-auto-apply</strong></span> - it runs a scan every day at 1AM on both control plane and worker nodes using a 1Gi Persistent Volume (PV) and keeps the last three results. Both <code class="literal">autoApplyRemediations</code> and <code class="literal">autoUpdateRemediations</code> are set to true.
								</li></ul></div><div class="formalpara"><p class="title"><strong>Example <code class="literal">ScanSetting</code> object</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
autoApplyRemediations: true <span id="CO20-1"><!--Empty--></span><span class="callout">1</span>
autoUpdateRemediations: true <span id="CO20-2"><!--Empty--></span><span class="callout">2</span>
kind: ScanSetting
maxRetryOnTimeout: 3
metadata:
  creationTimestamp: "2022-10-18T20:21:00Z"
  generation: 1
  name: default-auto-apply
  namespace: openshift-compliance
  resourceVersion: "38840"
  uid: 8cb0967d-05e0-4d7a-ac1c-08a7f7e89e84
rawResultStorage:
  nodeSelector:
    node-role.kubernetes.io/master: ""
  pvAccessModes:
  - ReadWriteOnce
  rotation: 3 <span id="CO20-3"><!--Empty--></span><span class="callout">3</span>
  size: 1Gi <span id="CO20-4"><!--Empty--></span><span class="callout">4</span>
  tolerations:
  - effect: NoSchedule
    key: node-role.kubernetes.io/master
    operator: Exists
  - effect: NoExecute
    key: node.kubernetes.io/not-ready
    operator: Exists
    tolerationSeconds: 300
  - effect: NoExecute
    key: node.kubernetes.io/unreachable
    operator: Exists
    tolerationSeconds: 300
  - effect: NoSchedule
    key: node.kubernetes.io/memory-pressure
    operator: Exists
roles: <span id="CO20-5"><!--Empty--></span><span class="callout">5</span>
- master
- worker
scanTolerations:
- operator: Exists
schedule: 0 1 * * * <span id="CO20-6"><!--Empty--></span><span class="callout">6</span>
showNotApplicable: false
strictNodeScan: true
timeout: 30m</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO20-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Set to <code class="literal">true</code> to enable auto remediations. Set to <code class="literal">false</code> to disable auto remediations.
								</div></dd><dt><a href="#CO20-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Set to <code class="literal">true</code> to enable auto remediations for content updates. Set to <code class="literal">false</code> to disable auto remediations for content updates.
								</div></dd><dt><a href="#CO20-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Specify the number of stored scans in the raw result format. The default value is <code class="literal">3</code>. As the older results get rotated, the administrator must store the results elsewhere before the rotation happens.
								</div></dd><dt><a href="#CO20-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									Specify the storage size that should be created for the scan to store the raw results. The default value is <code class="literal">1Gi</code>
								</div></dd><dt><a href="#CO20-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									Specify how often the scan should be run in cron format.
								</div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										To disable the rotation policy, set the value to <code class="literal">0</code>.
									</p></div></div></dd><dt><a href="#CO20-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									Specify the <code class="literal">node-role.kubernetes.io</code> label value to schedule the scan for <code class="literal">Node</code> type. This value has to match the name of a <code class="literal">MachineConfigPool</code>.
								</div></dd></dl></div></section></section><section class="section" id="process-compliance-requirements-with-compliance-settings_compliance-crd"><div class="titlepage"><div><div><h4 class="title">5.3.2.4. Processing the compliance scan requirements with compliance scans settings</h4></div></div></div><p>
						When you have defined the compliance scan requirements and configured the settings to run the scans, then the Compliance Operator processes it using the <code class="literal">ScanSettingBinding</code> object.
					</p><section class="section" id="scan-setting-binding-object_compliance-crd"><div class="titlepage"><div><div><h5 class="title">5.3.2.4.1. ScanSettingBinding object</h5></div></div></div><p>
							Use the <code class="literal">ScanSettingBinding</code> object to specify your compliance requirements with reference to the <code class="literal">Profile</code> or <code class="literal">TailoredProfile</code> object. It is then linked to a <code class="literal">ScanSetting</code> object, which provides the operational constraints for the scan. Then the Compliance Operator generates the <code class="literal">ComplianceSuite</code> object based on the <code class="literal">ScanSetting</code> and <code class="literal">ScanSettingBinding</code> objects.
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">ScanSettingBinding</code> object</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ScanSettingBinding
metadata:
  name: &lt;name of the scan&gt;
profiles: <span id="CO21-1"><!--Empty--></span><span class="callout">1</span>
  # Node checks
  - name: rhcos4-with-usb
    kind: TailoredProfile
    apiGroup: compliance.openshift.io/v1alpha1
  # Cluster checks
  - name: ocp4-moderate
    kind: Profile
    apiGroup: compliance.openshift.io/v1alpha1
settingsRef: <span id="CO21-2"><!--Empty--></span><span class="callout">2</span>
  name: my-companys-constraints
  kind: ScanSetting
  apiGroup: compliance.openshift.io/v1alpha1</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO21-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Specify the details of <code class="literal">Profile</code> or <code class="literal">TailoredProfile</code> object to scan your environment.
								</div></dd><dt><a href="#CO21-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Specify the operational constraints, such as schedule and storage size.
								</div></dd></dl></div><p>
							The creation of <code class="literal">ScanSetting</code> and <code class="literal">ScanSettingBinding</code> objects results in the compliance suite. To get the list of compliance suite, run the following command:
						</p><pre class="programlisting language-terminal">$ oc get compliancesuites</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								If you delete <code class="literal">ScanSettingBinding</code>, then compliance suite also is deleted.
							</p></div></div></section></section><section class="section" id="track-compliance-scans_compliance-crd"><div class="titlepage"><div><div><h4 class="title">5.3.2.5. Tracking the compliance scans</h4></div></div></div><p>
						After the creation of compliance suite, you can monitor the status of the deployed scans using the <code class="literal">ComplianceSuite</code> object.
					</p><section class="section" id="compliance-suite-object_compliance-crd"><div class="titlepage"><div><div><h5 class="title">5.3.2.5.1. ComplianceSuite object</h5></div></div></div><p>
							The <code class="literal">ComplianceSuite</code> object helps you keep track of the state of the scans. It contains the raw settings to create scans and the overall result.
						</p><p>
							For <code class="literal">Node</code> type scans, you should map the scan to the <code class="literal">MachineConfigPool</code>, since it contains the remediations for any issues. If you specify a label, ensure it directly applies to a pool.
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">ComplianceSuite</code> object</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ComplianceSuite
metadata:
  name: &lt;name of the scan&gt;
spec:
  autoApplyRemediations: false <span id="CO22-1"><!--Empty--></span><span class="callout">1</span>
  schedule: "0 1 * * *" <span id="CO22-2"><!--Empty--></span><span class="callout">2</span>
  scans: <span id="CO22-3"><!--Empty--></span><span class="callout">3</span>
    - name: workers-scan
      scanType: Node
      profile: xccdf_org.ssgproject.content_profile_moderate
      content: ssg-rhcos4-ds.xml
      contentImage: registry.redhat.io/compliance/openshift-compliance-content-rhel8@sha256:45dc...
      rule: "xccdf_org.ssgproject.content_rule_no_netrc_files"
      nodeSelector:
        node-role.kubernetes.io/worker: ""
status:
  Phase: DONE <span id="CO22-4"><!--Empty--></span><span class="callout">4</span>
  Result: NON-COMPLIANT <span id="CO22-5"><!--Empty--></span><span class="callout">5</span>
  scanStatuses:
  - name: workers-scan
    phase: DONE
    result: NON-COMPLIANT</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO22-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Set to <code class="literal">true</code> to enable auto remediations. Set to <code class="literal">false</code> to disable auto remediations.
								</div></dd><dt><a href="#CO22-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Specify how often the scan should be run in cron format.
								</div></dd><dt><a href="#CO22-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Specify a list of scan specifications to run in the cluster.
								</div></dd><dt><a href="#CO22-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									Indicates the progress of the scans.
								</div></dd><dt><a href="#CO22-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									Indicates the overall verdict of the suite.
								</div></dd></dl></div><p>
							The suite in the background creates the <code class="literal">ComplianceScan</code> object based on the <code class="literal">scans</code> parameter. You can programmatically fetch the <code class="literal">ComplianceSuites</code> events. To get the events for the suite, run the following command:
						</p><pre class="programlisting language-terminal">$ oc get events --field-selector involvedObject.kind=ComplianceSuite,involvedObject.name=&lt;name of the suite&gt;</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								You might create errors when you manually define the <code class="literal">ComplianceSuite</code>, since it contains the XCCDF attributes.
							</p></div></div></section><section class="section" id="advance-compliance-scan-object_compliance-crd"><div class="titlepage"><div><div><h5 class="title">5.3.2.5.2. Advanced ComplianceScan Object</h5></div></div></div><p>
							The Compliance Operator includes options for advanced users for debugging or integrating with existing tooling. While it is recommended that you not create a <code class="literal">ComplianceScan</code> object directly, you can instead manage it using a <code class="literal">ComplianceSuite</code> object.
						</p><div class="formalpara"><p class="title"><strong>Example Advanced <code class="literal">ComplianceScan</code> object</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ComplianceScan
metadata:
  name: &lt;name of the scan&gt;
spec:
  scanType: Node <span id="CO23-1"><!--Empty--></span><span class="callout">1</span>
  profile: xccdf_org.ssgproject.content_profile_moderate <span id="CO23-2"><!--Empty--></span><span class="callout">2</span>
  content: ssg-ocp4-ds.xml
  contentImage: registry.redhat.io/compliance/openshift-compliance-content-rhel8@sha256:45dc... <span id="CO23-3"><!--Empty--></span><span class="callout">3</span>
  rule: "xccdf_org.ssgproject.content_rule_no_netrc_files" <span id="CO23-4"><!--Empty--></span><span class="callout">4</span>
  nodeSelector: <span id="CO23-5"><!--Empty--></span><span class="callout">5</span>
    node-role.kubernetes.io/worker: ""
status:
  phase: DONE <span id="CO23-6"><!--Empty--></span><span class="callout">6</span>
  result: NON-COMPLIANT <span id="CO23-7"><!--Empty--></span><span class="callout">7</span></pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO23-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Specify either <code class="literal">Node</code> or <code class="literal">Platform</code>. Node profiles scan the cluster nodes and platform profiles scan the Kubernetes platform.
								</div></dd><dt><a href="#CO23-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Specify the XCCDF identifier of the profile that you want to run.
								</div></dd><dt><a href="#CO23-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Specify the container image that encapsulates the profile files.
								</div></dd><dt><a href="#CO23-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									It is optional. Specify the scan to run a single rule. This rule has to be identified with the XCCDF ID, and has to belong to the specified profile.
								</div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										If you skip the <code class="literal">rule</code> parameter, then scan runs for all the available rules of the specified profile.
									</p></div></div></dd><dt><a href="#CO23-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									If you are on the OpenShift Container Platform and wants to generate a remediation, then nodeSelector label has to match the <code class="literal">MachineConfigPool</code> label.
								</div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										If you do not specify <code class="literal">nodeSelector</code> parameter or match the <code class="literal">MachineConfig</code> label, scan will still run, but it will not create remediation.
									</p></div></div></dd><dt><a href="#CO23-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									Indicates the current phase of the scan.
								</div></dd><dt><a href="#CO23-7"><span class="callout">7</span></a> </dt><dd><div class="para">
									Indicates the verdict of the scan.
								</div></dd></dl></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								If you delete a <code class="literal">ComplianceSuite</code> object, then all the associated scans get deleted.
							</p></div></div><p>
							When the scan is complete, it generates the result as Custom Resources of the <code class="literal">ComplianceCheckResult</code> object. However, the raw results are available in ARF format. These results are stored in a Persistent Volume (PV), which has a Persistent Volume Claim (PVC) associated with the name of the scan. You can programmatically fetch the <code class="literal">ComplianceScans</code> events. To generate events for the suite, run the following command:
						</p><pre class="programlisting language-terminal">oc get events --field-selector involvedObject.kind=ComplianceScan,involvedObject.name=&lt;name of the suite&gt;</pre></section></section><section class="section" id="view-compliance-results_compliance-crd"><div class="titlepage"><div><div><h4 class="title">5.3.2.6. Viewing the compliance results</h4></div></div></div><p>
						When the compliance suite reaches the <code class="literal">DONE</code> phase, you can view the scan results and possible remediations.
					</p><section class="section" id="compliance-check-result_compliance-crd"><div class="titlepage"><div><div><h5 class="title">5.3.2.6.1. ComplianceCheckResult object</h5></div></div></div><p>
							When you run a scan with a specific profile, several rules in the profiles are verified. For each of these rules, a <code class="literal">ComplianceCheckResult</code> object is created, which provides the state of the cluster for a specific rule.
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">ComplianceCheckResult</code> object</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ComplianceCheckResult
metadata:
  labels:
    compliance.openshift.io/check-severity: medium
    compliance.openshift.io/check-status: FAIL
    compliance.openshift.io/suite: example-compliancesuite
    compliance.openshift.io/scan-name: workers-scan
  name: workers-scan-no-direct-root-logins
  namespace: openshift-compliance
  ownerReferences:
  - apiVersion: compliance.openshift.io/v1alpha1
    blockOwnerDeletion: true
    controller: true
    kind: ComplianceScan
    name: workers-scan
description: &lt;description of scan check&gt;
instructions: &lt;manual instructions for the scan&gt;
id: xccdf_org.ssgproject.content_rule_no_direct_root_logins
severity: medium <span id="CO24-1"><!--Empty--></span><span class="callout">1</span>
status: FAIL <span id="CO24-2"><!--Empty--></span><span class="callout">2</span></pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO24-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Describes the severity of the scan check.
								</div></dd><dt><a href="#CO24-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Describes the result of the check. The possible values are:
								</div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											PASS: check was successful.
										</li><li class="listitem">
											FAIL: check was unsuccessful.
										</li><li class="listitem">
											INFO: check was successful and found something not severe enough to be considered an error.
										</li><li class="listitem">
											MANUAL: check cannot automatically assess the status and manual check is required.
										</li><li class="listitem">
											INCONSISTENT: different nodes report different results.
										</li><li class="listitem">
											ERROR: check run successfully, but could not complete.
										</li><li class="listitem">
											NOTAPPLICABLE: check did not run as it is not applicable.
										</li></ul></div></dd></dl></div><p>
							To get all the check results from a suite, run the following command:
						</p><pre class="programlisting language-terminal">oc get compliancecheckresults \
-l compliance.openshift.io/suite=workers-compliancesuite</pre></section><section class="section" id="compliance-remediation-object_compliance-crd"><div class="titlepage"><div><div><h5 class="title">5.3.2.6.2. ComplianceRemediation object</h5></div></div></div><p>
							For a specific check you can have a datastream specified fix. However, if a Kubernetes fix is available, then the Compliance Operator creates a <code class="literal">ComplianceRemediation</code> object.
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">ComplianceRemediation</code> object</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ComplianceRemediation
metadata:
  labels:
    compliance.openshift.io/suite: example-compliancesuite
    compliance.openshift.io/scan-name: workers-scan
    machineconfiguration.openshift.io/role: worker
  name: workers-scan-disable-users-coredumps
  namespace: openshift-compliance
  ownerReferences:
  - apiVersion: compliance.openshift.io/v1alpha1
    blockOwnerDeletion: true
    controller: true
    kind: ComplianceCheckResult
    name: workers-scan-disable-users-coredumps
    uid: &lt;UID&gt;
spec:
  apply: false <span id="CO25-1"><!--Empty--></span><span class="callout">1</span>
  object:
    current: <span id="CO25-2"><!--Empty--></span><span class="callout">2</span>
       apiVersion: machineconfiguration.openshift.io/v1
       kind: MachineConfig
       spec:
         config:
           ignition:
             version: 2.2.0
           storage:
             files:
             - contents:
                 source: data:,%2A%20%20%20%20%20hard%20%20%20core%20%20%20%200
               filesystem: root
               mode: 420
               path: /etc/security/limits.d/75-disable_users_coredumps.conf
    outdated: {} <span id="CO25-3"><!--Empty--></span><span class="callout">3</span></pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO25-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									<code class="literal">true</code> indicates the remediation was applied. <code class="literal">false</code> indicates the remediation was not applied.
								</div></dd><dt><a href="#CO25-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Includes the definition of the remediation.
								</div></dd><dt><a href="#CO25-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Indicates remediation that was previously parsed from an earlier version of the content. The Compliance Operator still retains the outdated objects to give the administrator a chance to review the new remediations before applying them.
								</div></dd></dl></div><p>
							To get all the remediations from a suite, run the following command:
						</p><pre class="programlisting language-terminal">oc get complianceremediations \
-l compliance.openshift.io/suite=workers-compliancesuite</pre><p>
							To list all failing checks that can be remediated automatically, run the following command:
						</p><pre class="programlisting language-terminal">oc get compliancecheckresults \
-l 'compliance.openshift.io/check-status in (FAIL),compliance.openshift.io/automated-remediation'</pre><p>
							To list all failing checks that can be remediated manually, run the following command:
						</p><pre class="programlisting language-terminal">oc get compliancecheckresults \
-l 'compliance.openshift.io/check-status in (FAIL),!compliance.openshift.io/automated-remediation'</pre></section></section></section></section><section class="section" id="compliance-operator-management-2"><div class="titlepage"><div><div><h2 class="title">5.4. Compliance Operator management</h2></div></div></div><section class="section" id="compliance-operator-installation"><div class="titlepage"><div><div><h3 class="title">5.4.1. Installing the Compliance Operator</h3></div></div></div><p>
					Before you can use the Compliance Operator, you must ensure it is deployed in the cluster.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The Compliance Operator might report incorrect results on managed platforms, such as OpenShift Dedicated, Red Hat OpenShift Service on AWS, and Microsoft Azure Red Hat OpenShift. For more information, see the <a class="link" href="https://access.redhat.com/solutions/6983418">Red Hat Knowledgebase Solution #6983418</a>.
					</p></div></div><section class="section" id="installing-compliance-operator-web-console_compliance-operator-installation"><div class="titlepage"><div><div><h4 class="title">5.4.1.1. Installing the Compliance Operator through the web console</h4></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You must have <code class="literal">admin</code> privileges.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								In the OpenShift Container Platform web console, navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span>.
							</li><li class="listitem">
								Search for the Compliance Operator, then click <span class="strong strong"><strong>Install</strong></span>.
							</li><li class="listitem">
								Keep the default selection of <span class="strong strong"><strong>Installation mode</strong></span> and <span class="strong strong"><strong>namespace</strong></span> to ensure that the Operator will be installed to the <code class="literal">openshift-compliance</code> namespace.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Install</strong></span>.
							</li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
							To confirm that the installation is successful:
						</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Navigate to the <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> page.
							</li><li class="listitem">
								Check that the Compliance Operator is installed in the <code class="literal">openshift-compliance</code> namespace and its status is <code class="literal">Succeeded</code>.
							</li></ol></div><p>
						If the Operator is not installed successfully:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Navigate to the <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> page and inspect the <code class="literal">Status</code> column for any errors or failures.
							</li><li class="listitem">
								Navigate to the <span class="strong strong"><strong>Workloads</strong></span> → <span class="strong strong"><strong>Pods</strong></span> page and check the logs in any pods in the <code class="literal">openshift-compliance</code> project that are reporting issues.
							</li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							If the <code class="literal">restricted</code> Security Context Constraints (SCC) have been modified to contain the <code class="literal">system:authenticated</code> group or has added <code class="literal">requiredDropCapabilities</code>, the Compliance Operator may not function properly due to permissions issues.
						</p><p>
							You can create a custom SCC for the Compliance Operator scanner pod service account. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-custom-scc_compliance-advanced">Creating a custom SCC for the Compliance Operator</a>.
						</p></div></div></section><section class="section" id="installing-compliance-operator-cli_compliance-operator-installation"><div class="titlepage"><div><div><h4 class="title">5.4.1.2. Installing the Compliance Operator using the CLI</h4></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You must have <code class="literal">admin</code> privileges.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Define a <code class="literal">Namespace</code> object:
							</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">namespace-object.yaml</code></strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: v1
kind: Namespace
metadata:
  labels:
    openshift.io/cluster-monitoring: "true"
    pod-security.kubernetes.io/enforce: privileged <span id="CO26-1"><!--Empty--></span><span class="callout">1</span>
  name: openshift-compliance</pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO26-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										In OpenShift Container Platform 4.13, the pod security label must be set to <code class="literal">privileged</code> at the namespace level.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Create the <code class="literal">Namespace</code> object:
							</p><pre class="programlisting language-terminal">$ oc create -f namespace-object.yaml</pre></li><li class="listitem"><p class="simpara">
								Define an <code class="literal">OperatorGroup</code> object:
							</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">operator-group-object.yaml</code></strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: compliance-operator
  namespace: openshift-compliance
spec:
  targetNamespaces:
  - openshift-compliance</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Create the <code class="literal">OperatorGroup</code> object:
							</p><pre class="programlisting language-terminal">$ oc create -f operator-group-object.yaml</pre></li><li class="listitem"><p class="simpara">
								Define a <code class="literal">Subscription</code> object:
							</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">subscription-object.yaml</code></strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: compliance-operator-sub
  namespace: openshift-compliance
spec:
  channel: "stable"
  installPlanApproval: Automatic
  name: compliance-operator
  source: redhat-operators
  sourceNamespace: openshift-marketplace</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Create the <code class="literal">Subscription</code> object:
							</p><pre class="programlisting language-terminal">$ oc create -f subscription-object.yaml</pre></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If you are setting the global scheduler feature and enable <code class="literal">defaultNodeSelector</code>, you must create the namespace manually and update the annotations of the <code class="literal">openshift-compliance</code> namespace, or the namespace where the Compliance Operator was installed, with <code class="literal">openshift.io/node-selector: “”</code>. This removes the default node selector and prevents deployment failures.
						</p></div></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Verify the installation succeeded by inspecting the CSV file:
							</p><pre class="programlisting language-terminal">$ oc get csv -n openshift-compliance</pre></li><li class="listitem"><p class="simpara">
								Verify that the Compliance Operator is up and running:
							</p><pre class="programlisting language-terminal">$ oc get deploy -n openshift-compliance</pre></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							If the <code class="literal">restricted</code> Security Context Constraints (SCC) have been modified to contain the <code class="literal">system:authenticated</code> group or has added <code class="literal">requiredDropCapabilities</code>, the Compliance Operator may not function properly due to permissions issues.
						</p><p>
							You can create a custom SCC for the Compliance Operator scanner pod service account. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance-custom-scc_compliance-advanced">Creating a custom SCC for the Compliance Operator</a>.
						</p></div></div></section><section class="section" id="installing-compliance-operator-hcp_compliance-operator-installation"><div class="titlepage"><div><div><h4 class="title">5.4.1.3. Installing the Compliance Operator on Hosted control planes</h4></div></div></div><p>
						The Compliance Operator can be installed in Hosted control planes using the OperatorHub by creating a <code class="literal">Subscription</code> file.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Hosted control planes is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
						</p><p>
							For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You must have <code class="literal">admin</code> privileges.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Define a <code class="literal">Namespace</code> object similar to the following:
							</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">namespace-object.yaml</code></strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: v1
kind: Namespace
metadata:
  labels:
    openshift.io/cluster-monitoring: "true"
    pod-security.kubernetes.io/enforce: privileged <span id="CO27-1"><!--Empty--></span><span class="callout">1</span>
  name: openshift-compliance</pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO27-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										In OpenShift Container Platform 4.13, the pod security label must be set to <code class="literal">privileged</code> at the namespace level.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Create the <code class="literal">Namespace</code> object by running the following command:
							</p><pre class="programlisting language-terminal">$ oc create -f namespace-object.yaml</pre></li><li class="listitem"><p class="simpara">
								Define an <code class="literal">OperatorGroup</code> object:
							</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">operator-group-object.yaml</code></strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: compliance-operator
  namespace: openshift-compliance
spec:
  targetNamespaces:
  - openshift-compliance</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Create the <code class="literal">OperatorGroup</code> object by running the following command:
							</p><pre class="programlisting language-terminal">$ oc create -f operator-group-object.yaml</pre></li><li class="listitem"><p class="simpara">
								Define a <code class="literal">Subscription</code> object:
							</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">subscription-object.yaml</code></strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: compliance-operator-sub
  namespace: openshift-compliance
spec:
  channel: "stable"
  installPlanApproval: Automatic
  name: compliance-operator
  source: redhat-operators
  sourceNamespace: openshift-marketplace
  config:
    nodeSelector:
      node-role.kubernetes.io/worker: ""
    env:
    - name: PLATFORM
      value: "HyperShift"</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Create the <code class="literal">Subscription</code> object by running the following command:
							</p><pre class="programlisting language-terminal">$ oc create -f subscription-object.yaml</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Verify the installation succeeded by inspecting the CSV file by running the following command:
							</p><pre class="programlisting language-terminal">$ oc get csv -n openshift-compliance</pre></li><li class="listitem"><p class="simpara">
								Verify that the Compliance Operator is up and running by running the following command:
							</p><pre class="programlisting language-terminal">$ oc get deploy -n openshift-compliance</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/hosted_control_planes/#hcp-overview">Hosted control planes overview</a>
							</li></ul></div></section><section class="section _additional-resources" id="additional-resources-installing-the-compliance-operator"><div class="titlepage"><div><div><h4 class="title">5.4.1.4. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The Compliance Operator is supported in a restricted network environment. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-restricted-networks">Using Operator Lifecycle Manager on restricted networks</a>.
							</li></ul></div></section></section><section class="section" id="compliance-operator-updating"><div class="titlepage"><div><div><h3 class="title">5.4.2. Updating the Compliance Operator</h3></div></div></div><p>
					As a cluster administrator, you can update the Compliance Operator on your OpenShift Container Platform cluster.
				</p><section class="section" id="olm-preparing-upgrade_compliance-operator-updating"><div class="titlepage"><div><div><h4 class="title">5.4.2.1. Preparing for an Operator update</h4></div></div></div><p>
						The subscription of an installed Operator specifies an update channel that tracks and receives updates for the Operator. You can change the update channel to start tracking and receiving updates from a newer channel.
					</p><p>
						The names of update channels in a subscription can differ between Operators, but the naming scheme typically follows a common convention within a given Operator. For example, channel names might follow a minor release update stream for the application provided by the Operator (<code class="literal">1.2</code>, <code class="literal">1.3</code>) or a release frequency (<code class="literal">stable</code>, <code class="literal">fast</code>).
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You cannot change installed Operators to a channel that is older than the current channel.
						</p></div></div><p>
						Red Hat Customer Portal Labs include the following application that helps administrators prepare to update their Operators:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/labs/ocpouic/">Red Hat OpenShift Container Platform Operator Update Information Checker</a>
							</li></ul></div><p>
						You can use the application to search for Operator Lifecycle Manager-based Operators and verify the available Operator version per update channel across different versions of OpenShift Container Platform. Cluster Version Operator-based Operators are not included.
					</p></section><section class="section" id="olm-changing-update-channel_compliance-operator-updating"><div class="titlepage"><div><div><h4 class="title">5.4.2.2. Changing the update channel for an Operator</h4></div></div></div><p>
						You can change the update channel for an Operator by using the OpenShift Container Platform web console.
					</p><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
						If the approval strategy in the subscription is set to <span class="strong strong"><strong>Automatic</strong></span>, the update process initiates as soon as a new Operator version is available in the selected channel. If the approval strategy is set to <span class="strong strong"><strong>Manual</strong></span>, you must manually approve pending updates.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								An Operator previously installed using Operator Lifecycle Manager (OLM).
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								In the <span class="strong strong"><strong>Administrator</strong></span> perspective of the web console, navigate to <span class="strong strong"><strong>Operators → Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the name of the Operator you want to change the update channel for.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Subscription</strong></span> tab.
							</li><li class="listitem">
								Click the name of the update channel under <span class="strong strong"><strong>Update channel</strong></span>.
							</li><li class="listitem">
								Click the newer update channel that you want to change to, then click <span class="strong strong"><strong>Save</strong></span>.
							</li><li class="listitem"><p class="simpara">
								For subscriptions with an <span class="strong strong"><strong>Automatic</strong></span> approval strategy, the update begins automatically. Navigate back to the <span class="strong strong"><strong>Operators → Installed Operators</strong></span> page to monitor the progress of the update. When complete, the status changes to <span class="strong strong"><strong>Succeeded</strong></span> and <span class="strong strong"><strong>Up to date</strong></span>.
							</p><p class="simpara">
								For subscriptions with a <span class="strong strong"><strong>Manual</strong></span> approval strategy, you can manually approve the update from the <span class="strong strong"><strong>Subscription</strong></span> tab.
							</p></li></ol></div></section><section class="section" id="olm-approving-pending-upgrade_compliance-operator-updating"><div class="titlepage"><div><div><h4 class="title">5.4.2.3. Manually approving a pending Operator update</h4></div></div></div><p>
						If an installed Operator has the approval strategy in its subscription set to <span class="strong strong"><strong>Manual</strong></span>, when new updates are released in its current update channel, the update must be manually approved before installation can begin.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								An Operator previously installed using Operator Lifecycle Manager (OLM).
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								In the <span class="strong strong"><strong>Administrator</strong></span> perspective of the OpenShift Container Platform web console, navigate to <span class="strong strong"><strong>Operators → Installed Operators</strong></span>.
							</li><li class="listitem">
								Operators that have a pending update display a status with <span class="strong strong"><strong>Upgrade available</strong></span>. Click the name of the Operator you want to update.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Subscription</strong></span> tab. Any updates requiring approval are displayed next to <span class="strong strong"><strong>Upgrade status</strong></span>. For example, it might display <span class="strong strong"><strong>1 requires approval</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>1 requires approval</strong></span>, then click <span class="strong strong"><strong>Preview Install Plan</strong></span>.
							</li><li class="listitem">
								Review the resources that are listed as available for update. When satisfied, click <span class="strong strong"><strong>Approve</strong></span>.
							</li><li class="listitem">
								Navigate back to the <span class="strong strong"><strong>Operators → Installed Operators</strong></span> page to monitor the progress of the update. When complete, the status changes to <span class="strong strong"><strong>Succeeded</strong></span> and <span class="strong strong"><strong>Up to date</strong></span>.
							</li></ol></div></section></section><section class="section" id="compliance-operator-understanding"><div class="titlepage"><div><div><h3 class="title">5.4.3. Managing the Compliance Operator</h3></div></div></div><p>
					This section describes the lifecycle of security content, including how to use an updated version of compliance content and how to create a custom <code class="literal">ProfileBundle</code> object.
				</p><section class="section" id="compliance-profilebundle_managing-compliance"><div class="titlepage"><div><div><h4 class="title">5.4.3.1. ProfileBundle CR example</h4></div></div></div><p>
						The <code class="literal">ProfileBundle</code> object requires two pieces of information: the URL of a container image that contains the <code class="literal">contentImage</code> and the file that contains the compliance content. The <code class="literal">contentFile</code> parameter is relative to the root of the file system. You can define the built-in <code class="literal">rhcos4</code> <code class="literal">ProfileBundle</code> object as shown in the following example:
					</p><pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ProfileBundle
metadata:
  creationTimestamp: "2022-10-19T12:06:30Z"
  finalizers:
  - profilebundle.finalizers.compliance.openshift.io
  generation: 1
  name: rhcos4
  namespace: openshift-compliance
  resourceVersion: "46741"
  uid: 22350850-af4a-4f5c-9a42-5e7b68b82d7d
spec:
  contentFile: ssg-rhcos4-ds.xml <span id="CO28-1"><!--Empty--></span><span class="callout">1</span>
  contentImage: registry.redhat.io/compliance/openshift-compliance-content-rhel8@sha256:900e... <span id="CO28-2"><!--Empty--></span><span class="callout">2</span>
status:
  conditions:
  - lastTransitionTime: "2022-10-19T12:07:51Z"
    message: Profile bundle successfully parsed
    reason: Valid
    status: "True"
    type: Ready
  dataStreamStatus: VALID</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO28-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Location of the file containing the compliance content.
							</div></dd><dt><a href="#CO28-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Content image location.
							</div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									The base image used for the content images must include <code class="literal">coreutils</code>.
								</p></div></div></dd></dl></div></section><section class="section" id="compliance-update_managing-compliance"><div class="titlepage"><div><div><h4 class="title">5.4.3.2. Updating security content</h4></div></div></div><p>
						Security content is included as container images that the <code class="literal">ProfileBundle</code> objects refer to. To accurately track updates to <code class="literal">ProfileBundles</code> and the custom resources parsed from the bundles such as rules or profiles, identify the container image with the compliance content using a digest instead of a tag:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance get profilebundles rhcos4 -oyaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ProfileBundle
metadata:
  creationTimestamp: "2022-10-19T12:06:30Z"
  finalizers:
  - profilebundle.finalizers.compliance.openshift.io
  generation: 1
  name: rhcos4
  namespace: openshift-compliance
  resourceVersion: "46741"
  uid: 22350850-af4a-4f5c-9a42-5e7b68b82d7d
spec:
  contentFile: ssg-rhcos4-ds.xml
  contentImage: registry.redhat.io/compliance/openshift-compliance-content-rhel8@sha256:900e... <span id="CO29-1"><!--Empty--></span><span class="callout">1</span>
status:
  conditions:
  - lastTransitionTime: "2022-10-19T12:07:51Z"
    message: Profile bundle successfully parsed
    reason: Valid
    status: "True"
    type: Ready
  dataStreamStatus: VALID</pre>

						</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO29-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Security container image.
							</div></dd></dl></div><p>
						Each <code class="literal">ProfileBundle</code> is backed by a deployment. When the Compliance Operator detects that the container image digest has changed, the deployment is updated to reflect the change and parse the content again. Using the digest instead of a tag ensures that you use a stable and predictable set of profiles.
					</p></section><section class="section _additional-resources" id="additional-resources_managing-the-compliance-operator"><div class="titlepage"><div><div><h4 class="title">5.4.3.3. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The Compliance Operator is supported in a restricted network environment. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-restricted-networks">Using Operator Lifecycle Manager on restricted networks</a>.
							</li></ul></div></section></section><section class="section" id="compliance-operator-uninstallation"><div class="titlepage"><div><div><h3 class="title">5.4.4. Uninstalling the Compliance Operator</h3></div></div></div><p>
					You can remove the OpenShift Compliance Operator from your cluster by using the OpenShift Container Platform web console or the CLI.
				</p><section class="section" id="compliance-operator-uninstall_compliance-operator-uninstallation"><div class="titlepage"><div><div><h4 class="title">5.4.4.1. Uninstalling the OpenShift Compliance Operator from OpenShift Container Platform using the web console</h4></div></div></div><p>
						To remove the Compliance Operator, you must first delete the objects in the namespace. After the objects are removed, you can remove the Operator and its namespace by deleting the <span class="strong strong"><strong>openshift-compliance</strong></span> project.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Access to an OpenShift Container Platform cluster using an account with <code class="literal">cluster-admin</code> permissions.
							</li><li class="listitem">
								The OpenShift Compliance Operator must be installed.
							</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							To remove the Compliance Operator by using the OpenShift Container Platform web console:
						</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Go to the <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> → <span class="strong strong"><strong>Compliance Operator</strong></span> page.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Click <span class="strong strong"><strong>All instances</strong></span>.
									</li><li class="listitem">
										In <span class="strong strong"><strong>All namespaces</strong></span>, click the Options menu 
										<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
										 and delete all ScanSettingBinding, ComplainceSuite, ComplianceScan, and ProfileBundle objects.
									</li></ol></div></li><li class="listitem">
								Switch to the <span class="strong strong"><strong>Administration</strong></span> → <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> page.
							</li><li class="listitem">
								Click the Options menu 
								<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
								 on the <span class="strong strong"><strong>Compliance Operator</strong></span> entry and select <span class="strong strong"><strong>Uninstall Operator</strong></span>.
							</li><li class="listitem">
								Switch to the <span class="strong strong"><strong>Home</strong></span> → <span class="strong strong"><strong>Projects</strong></span> page.
							</li><li class="listitem">
								Search for 'compliance'.
							</li><li class="listitem"><p class="simpara">
								Click the Options menu 
								<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
								 next to the <span class="strong strong"><strong>openshift-compliance</strong></span> project, and select <span class="strong strong"><strong>Delete Project</strong></span>.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Confirm the deletion by typing <code class="literal">openshift-compliance</code> in the dialog box, and click <span class="strong strong"><strong>Delete</strong></span>.
									</li></ol></div></li></ol></div></section><section class="section" id="compliance-operator-uninstall-cli_compliance-operator-uninstallation"><div class="titlepage"><div><div><h4 class="title">5.4.4.2. Uninstalling the OpenShift Compliance Operator from OpenShift Container Platform using the CLI</h4></div></div></div><p>
						To remove the Compliance Operator, you must first delete the objects in the namespace. After the objects are removed, you can remove the Operator and its namespace by deleting the <span class="strong strong"><strong>openshift-compliance</strong></span> project.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Access to an OpenShift Container Platform cluster using an account with <code class="literal">cluster-admin</code> permissions.
							</li><li class="listitem">
								The OpenShift Compliance Operator must be installed.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Delete all objects in the namespace.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Delete the <code class="literal">ScanSettingBinding</code> objects:
									</p><pre class="programlisting language-terminal">$ oc delete ssb --all -n openshift-compliance</pre></li><li class="listitem"><p class="simpara">
										Delete the <code class="literal">ScanSetting</code> objects:
									</p><pre class="programlisting language-terminal">$ oc delete ss --all -n openshift-compliance</pre></li><li class="listitem"><p class="simpara">
										Delete the <code class="literal">ComplianceSuite</code> objects:
									</p><pre class="programlisting language-terminal">$ oc delete suite --all -n openshift-compliance</pre></li><li class="listitem"><p class="simpara">
										Delete the <code class="literal">ComplianceScan</code> objects:
									</p><pre class="programlisting language-terminal">$ oc delete scan --all -n openshift-compliance</pre></li><li class="listitem"><p class="simpara">
										Delete the <code class="literal">ProfileBundle</code> objects:
									</p><pre class="programlisting language-terminal">$ oc delete profilebundle.compliance --all -n openshift-compliance</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								Delete the Subscription object:
							</p><pre class="programlisting language-terminal">$ oc delete sub --all -n openshift-compliance</pre></li><li class="listitem"><p class="simpara">
								Delete the CSV object:
							</p><pre class="programlisting language-terminal">$ oc delete csv --all -n openshift-compliance</pre></li><li class="listitem"><p class="simpara">
								Delete the project:
							</p><pre class="programlisting language-terminal">$ oc delete project openshift-compliance</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">project.project.openshift.io "openshift-compliance" deleted</pre>

								</p></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Confirm the namespace is deleted:
							</p><pre class="programlisting language-terminal">$ oc get project/openshift-compliance</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">Error from server (NotFound): namespaces "openshift-compliance" not found</pre>

								</p></div></li></ol></div></section></section></section><section class="section" id="compliance-operator-scan-management-2"><div class="titlepage"><div><div><h2 class="title">5.5. Compliance Operator scan management</h2></div></div></div><section class="section" id="compliance-operator-supported-profiles"><div class="titlepage"><div><div><h3 class="title">5.5.1. Supported compliance profiles</h3></div></div></div><p>
					There are several profiles available as part of the Compliance Operator (CO) installation. While you can use the following profiles to assess gaps in a cluster, usage alone does not infer or guarantee compliance with a particular profile.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The Compliance Operator might report incorrect results on managed platforms, such as OpenShift Dedicated, Red Hat OpenShift Service on AWS, and Azure Red Hat OpenShift. For more information, see the <a class="link" href="https://access.redhat.com/solutions/6983418">Red Hat Knowledgebase Solution #6983418</a>.
					</p></div></div><section class="section" id="compliance-supported-profiles_compliance-operator-supported-profiles"><div class="titlepage"><div><div><h4 class="title">5.5.1.1. Compliance profiles</h4></div></div></div><p>
						The Compliance Operator provides the following compliance profiles:
					</p><div class="table" id="idm139961144478832"><p class="title"><strong>Table 5.1. Supported compliance profiles</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 8%; " class="col_1"><!--Empty--></col><col style="width: 34%; " class="col_2"><!--Empty--></col><col style="width: 8%; " class="col_3"><!--Empty--></col><col style="width: 8%; " class="col_4"><!--Empty--></col><col style="width: 34%; " class="col_5"><!--Empty--></col><col style="width: 8%; " class="col_6"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139961137264592" scope="col">Profile</th><th align="left" valign="top" id="idm139961137263504" scope="col">Profile title</th><th align="left" valign="top" id="idm139961137262416" scope="col">Application</th><th align="left" valign="top" id="idm139961137261328" scope="col">Compliance Operator version</th><th align="left" valign="top" id="idm139961134397984" scope="col">Industry compliance benchmark</th><th align="left" valign="top" id="idm139961134396880" scope="col">Supported architectures</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										rhcos4-stig
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) for Red Hat Openshift
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Node
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										1.3.0+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://public.cyber.mil/stigs/downloads/">DISA-STIG</a> <sup>[1]</sup>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										ocp4-stig-node
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) for Red Hat Openshift
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Node
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										1.3.0+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://public.cyber.mil/stigs/downloads/">DISA-STIG</a> <sup>[1]</sup>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										ocp4-stig
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) for Red Hat Openshift
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Platform
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										1.3.0+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://public.cyber.mil/stigs/downloads/">DISA-STIG</a> <sup>[1]</sup>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										ocp4-cis
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										CIS Red Hat OpenShift Container Platform 4 Benchmark v1.4.0
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Platform
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										1.2.0+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmarks ™</a> <sup>[1]</sup>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code> <code class="literal">ppc64le</code> <code class="literal">s390x</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										ocp4-cis-node
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										CIS Red Hat OpenShift Container Platform 4 Benchmark v1.4.0
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Node <sup>[2]</sup>
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										1.2.0+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmarks ™</a> <sup>[1]</sup>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code> <code class="literal">ppc64le</code> <code class="literal">s390x</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										ocp4-e8
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										Australian Cyber Security Centre (ACSC) Essential Eight
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Platform
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										0.1.39+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://www.cyber.gov.au/acsc/view-all-content/publications/hardening-linux-workstations-and-servers">ACSC Hardening Linux Workstations and Servers</a>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										ocp4-moderate
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										NIST 800-53 Moderate-Impact Baseline for Red Hat OpenShift - Platform level
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Platform
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										0.1.39+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://nvd.nist.gov/800-53/Rev4/impact/moderate">NIST SP-800-53 Release Search</a>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code> <code class="literal">ppc64le</code> <code class="literal">s390x</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										rhcos4-e8
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										Australian Cyber Security Centre (ACSC) Essential Eight
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Node
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										0.1.39+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://www.cyber.gov.au/acsc/view-all-content/publications/hardening-linux-workstations-and-servers">ACSC Hardening Linux Workstations and Servers</a>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										rhcos4-moderate
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										NIST 800-53 Moderate-Impact Baseline for Red Hat Enterprise Linux CoreOS
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Node
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										0.1.39+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://nvd.nist.gov/800-53/Rev4/impact/moderate">NIST SP-800-53 Release Search</a>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										ocp4-moderate-node
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										NIST 800-53 Moderate-Impact Baseline for Red Hat OpenShift - Node level
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Node <sup>[2]</sup>
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										0.1.44+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://nvd.nist.gov/800-53/Rev4/impact/moderate">NIST SP-800-53 Release Search</a>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code> <code class="literal">ppc64le</code> <code class="literal">s390x</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										ocp4-nerc-cip
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										North American Electric Reliability Corporation (NERC) Critical Infrastructure Protection (CIP) cybersecurity standards profile for the Red Hat OpenShift Container Platform - Platform level
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Platform
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										0.1.44+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://www.nerc.com/pa/Stand/Pages/CIPStandards.aspx">NERC CIP Standards</a>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										ocp4-nerc-cip-node
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										North American Electric Reliability Corporation (NERC) Critical Infrastructure Protection (CIP) cybersecurity standards profile for the Red Hat OpenShift Container Platform - Node level
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Node <sup>[2]</sup>
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										0.1.44+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://www.nerc.com/pa/Stand/Pages/CIPStandards.aspx">NERC CIP Standards</a>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										rhcos4-nerc-cip
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										North American Electric Reliability Corporation (NERC) Critical Infrastructure Protection (CIP) cybersecurity standards profile for Red Hat Enterprise Linux CoreOS
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Node
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										0.1.44+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://www.nerc.com/pa/Stand/Pages/CIPStandards.aspx">NERC CIP Standards</a>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										ocp4-pci-dss
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										PCI-DSS v3.2.1 Control Baseline for Red Hat OpenShift Container Platform 4
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Platform
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										0.1.47+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://www.pcisecuritystandards.org/document_library?document=pci_dss">PCI Security Standards ® Council Document Library</a>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code> <code class="literal">ppc64le</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										ocp4-pci-dss-node
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										PCI-DSS v3.2.1 Control Baseline for Red Hat OpenShift Container Platform 4
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Node <sup>[2]</sup>
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										0.1.47+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://www.pcisecuritystandards.org/document_library?document=pci_dss">PCI Security Standards ® Council Document Library</a>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code> <code class="literal">ppc64le</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										ocp4-high
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										NIST 800-53 High-Impact Baseline for Red Hat OpenShift - Platform level
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Platform
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										0.1.52+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://csrc.nist.gov/Projects/risk-management/sp800-53-controls/release-search#!/800-53">NIST SP-800-53 Release Search</a>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										ocp4-high-node
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										NIST 800-53 High-Impact Baseline for Red Hat OpenShift - Node level
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Node <sup>[2]</sup>
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										0.1.52+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://csrc.nist.gov/Projects/risk-management/sp800-53-controls/release-search#!/800-53">NIST SP-800-53 Release Search</a>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961137264592"> <p>
										rhcos4-high
									</p>
									 </td><td align="left" valign="top" headers="idm139961137263504"> <p>
										NIST 800-53 High-Impact Baseline for Red Hat Enterprise Linux CoreOS
									</p>
									 </td><td align="left" valign="top" headers="idm139961137262416"> <p>
										Node
									</p>
									 </td><td align="left" valign="top" headers="idm139961137261328"> <p>
										0.1.52+
									</p>
									 </td><td align="left" valign="top" headers="idm139961134397984"> <p>
										<a class="link" href="https://csrc.nist.gov/Projects/risk-management/sp800-53-controls/release-search#!/800-53">NIST SP-800-53 Release Search</a>
									</p>
									 </td><td align="left" valign="top" headers="idm139961134396880"> <p>
										<code class="literal">x86_64</code>
									</p>
									 </td></tr></tbody></table></div></div><div class="orderedlist small"><ol class="orderedlist small" type="1"><li class="listitem">
								To locate the CIS OpenShift Container Platform v4 Benchmark, go to <a class="link" href="https://www.cisecurity.org/benchmark/kubernetes">CIS Benchmarks</a> and click <span class="strong strong"><strong>Download Latest CIS Benchmark</strong></span>, where you can then register to download the benchmark.
							</li><li class="listitem">
								Node profiles must be used with the relevant Platform profile. For more information, see <span class="emphasis"><em>Compliance Operator profile types</em></span>.
							</li></ol></div><section class="section" id="compliance-extended-profiles_compliance-operator-supported-profiles"><div class="titlepage"><div><div><h5 class="title">5.5.1.1.1. About extended compliance profiles</h5></div></div></div><p>
							Some compliance profiles have controls that require following industry best practices, resulting in some profiles extending others. Combining the Center for Internet Security (CIS) best practices with National Institute of Standards and Technology (NIST) security frameworks establishes a path to a secure and compliant environment.
						</p><p>
							For example, the NIST High-Impact and Moderate-Impact profiles extend the CIS profile to achieve compliance. As a result, extended compliance profiles eliminate the need to run both profiles in a single cluster.
						</p><div class="table" id="idm139961124019520"><p class="title"><strong>Table 5.2. Profile extensions</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139961137236784" scope="col">Profile</th><th align="left" valign="top" id="idm139961137235696" scope="col">Extends</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139961137236784"> <p>
											ocp4-pci-dss
										</p>
										 </td><td align="left" valign="top" headers="idm139961137235696"> <p>
											ocp4-cis
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139961137236784"> <p>
											ocp4-pci-dss-node
										</p>
										 </td><td align="left" valign="top" headers="idm139961137235696"> <p>
											ocp4-cis-node
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139961137236784"> <p>
											ocp4-high
										</p>
										 </td><td align="left" valign="top" headers="idm139961137235696"> <p>
											ocp4-cis
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139961137236784"> <p>
											ocp4-high-node
										</p>
										 </td><td align="left" valign="top" headers="idm139961137235696"> <p>
											ocp4-cis-node
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139961137236784"> <p>
											ocp4-moderate
										</p>
										 </td><td align="left" valign="top" headers="idm139961137235696"> <p>
											ocp4-cis
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139961137236784"> <p>
											ocp4-moderate-node
										</p>
										 </td><td align="left" valign="top" headers="idm139961137235696"> <p>
											ocp4-cis-node
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139961137236784"> <p>
											ocp4-nerc-cip
										</p>
										 </td><td align="left" valign="top" headers="idm139961137235696"> <p>
											ocp4-moderate
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139961137236784"> <p>
											ocp4-nerc-cip-node
										</p>
										 </td><td align="left" valign="top" headers="idm139961137235696"> <p>
											ocp4-moderate-node
										</p>
										 </td></tr></tbody></table></div></div></section></section><section class="section _additional-resources" id="additional-resources-compliance-operator-"><div class="titlepage"><div><div><h4 class="title">5.5.1.2. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#compliance_profile_types_understanding-compliance">Compliance Operator profile types</a>
							</li></ul></div></section></section><section class="section" id="compliance-operator-scans"><div class="titlepage"><div><div><h3 class="title">5.5.2. Compliance Operator scans</h3></div></div></div><p>
					The <code class="literal">ScanSetting</code> and <code class="literal">ScanSettingBinding</code> APIs are recommended to run compliance scans with the Compliance Operator. For more information on these API objects, run:
				</p><pre class="programlisting language-terminal">$ oc explain scansettings</pre><p>
					or
				</p><pre class="programlisting language-terminal">$ oc explain scansettingbindings</pre><section class="section" id="running-compliance-scans_compliance-operator-scans"><div class="titlepage"><div><div><h4 class="title">5.5.2.1. Running compliance scans</h4></div></div></div><p>
						You can run a scan using the Center for Internet Security (CIS) profiles. For convenience, the Compliance Operator creates a <code class="literal">ScanSetting</code> object with reasonable defaults on startup. This <code class="literal">ScanSetting</code> object is named <code class="literal">default</code>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							For all-in-one control plane and worker nodes, the compliance scan runs twice on the worker and control plane nodes. The compliance scan might generate inconsistent scan results. You can avoid inconsistent results by defining only a single role in the <code class="literal">ScanSetting</code> object.
						</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Inspect the <code class="literal">ScanSetting</code> object by running:
							</p><pre class="programlisting language-terminal">$ oc describe scansettings default -n openshift-compliance</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-yaml">Name:         default
Namespace:    openshift-compliance
Labels:       &lt;none&gt;
Annotations:  &lt;none&gt;
API Version:  compliance.openshift.io/v1alpha1
Kind:         ScanSetting
Metadata:
  Creation Timestamp:  2022-10-10T14:07:29Z
  Generation:          1
  Managed Fields:
    API Version:  compliance.openshift.io/v1alpha1
    Fields Type:  FieldsV1
    fieldsV1:
      f:rawResultStorage:
        .:
        f:nodeSelector:
          .:
          f:node-role.kubernetes.io/master:
        f:pvAccessModes:
        f:rotation:
        f:size:
        f:tolerations:
      f:roles:
      f:scanTolerations:
      f:schedule:
      f:showNotApplicable:
      f:strictNodeScan:
    Manager:         compliance-operator
    Operation:       Update
    Time:            2022-10-10T14:07:29Z
  Resource Version:  56111
  UID:               c21d1d14-3472-47d7-a450-b924287aec90
Raw Result Storage:
  Node Selector:
    node-role.kubernetes.io/master:
  Pv Access Modes:
    ReadWriteOnce <span id="CO30-1"><!--Empty--></span><span class="callout">1</span>
  Rotation:  3 <span id="CO30-2"><!--Empty--></span><span class="callout">2</span>
  Size:      1Gi <span id="CO30-3"><!--Empty--></span><span class="callout">3</span>
  Tolerations:
    Effect:              NoSchedule
    Key:                 node-role.kubernetes.io/master
    Operator:            Exists
    Effect:              NoExecute
    Key:                 node.kubernetes.io/not-ready
    Operator:            Exists
    Toleration Seconds:  300
    Effect:              NoExecute
    Key:                 node.kubernetes.io/unreachable
    Operator:            Exists
    Toleration Seconds:  300
    Effect:              NoSchedule
    Key:                 node.kubernetes.io/memory-pressure
    Operator:            Exists
Roles:
  master <span id="CO30-4"><!--Empty--></span><span class="callout">4</span>
  worker <span id="CO30-5"><!--Empty--></span><span class="callout">5</span>
Scan Tolerations: <span id="CO30-6"><!--Empty--></span><span class="callout">6</span>
  Operator:           Exists
Schedule:             0 1 * * * <span id="CO30-7"><!--Empty--></span><span class="callout">7</span>
Show Not Applicable:  false
Strict Node Scan:     true
Events:               &lt;none&gt;</pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO30-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										The Compliance Operator creates a persistent volume (PV) that contains the results of the scans. By default, the PV will use access mode <code class="literal">ReadWriteOnce</code> because the Compliance Operator cannot make any assumptions about the storage classes configured on the cluster. Additionally, <code class="literal">ReadWriteOnce</code> access mode is available on most clusters. If you need to fetch the scan results, you can do so by using a helper pod, which also binds the volume. Volumes that use the <code class="literal">ReadWriteOnce</code> access mode can be mounted by only one pod at time, so it is important to remember to delete the helper pods. Otherwise, the Compliance Operator will not be able to reuse the volume for subsequent scans.
									</div></dd><dt><a href="#CO30-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										The Compliance Operator keeps results of three subsequent scans in the volume; older scans are rotated.
									</div></dd><dt><a href="#CO30-3"><span class="callout">3</span></a> </dt><dd><div class="para">
										The Compliance Operator will allocate one GB of storage for the scan results.
									</div></dd><dt><a href="#CO30-4"><span class="callout">4</span></a> <a href="#CO30-5"><span class="callout">5</span></a> </dt><dd><div class="para">
										If the scan setting uses any profiles that scan cluster nodes, scan these node roles.
									</div></dd><dt><a href="#CO30-6"><span class="callout">6</span></a> </dt><dd><div class="para">
										The default scan setting object scans all the nodes.
									</div></dd><dt><a href="#CO30-7"><span class="callout">7</span></a> </dt><dd><div class="para">
										The default scan setting object runs scans at 01:00 each day.
									</div></dd></dl></div><p class="simpara">
								As an alternative to the default scan setting, you can use <code class="literal">default-auto-apply</code>, which has the following settings:
							</p><pre class="programlisting language-yaml">Name:                      default-auto-apply
Namespace:                 openshift-compliance
Labels:                    &lt;none&gt;
Annotations:               &lt;none&gt;
API Version:               compliance.openshift.io/v1alpha1
Auto Apply Remediations:   true <span id="CO31-1"><!--Empty--></span><span class="callout">1</span>
Auto Update Remediations:  true <span id="CO31-2"><!--Empty--></span><span class="callout">2</span>
Kind:                      ScanSetting
Metadata:
  Creation Timestamp:  2022-10-18T20:21:00Z
  Generation:          1
  Managed Fields:
    API Version:  compliance.openshift.io/v1alpha1
    Fields Type:  FieldsV1
    fieldsV1:
      f:autoApplyRemediations:
      f:autoUpdateRemediations:
      f:rawResultStorage:
        .:
        f:nodeSelector:
          .:
          f:node-role.kubernetes.io/master:
        f:pvAccessModes:
        f:rotation:
        f:size:
        f:tolerations:
      f:roles:
      f:scanTolerations:
      f:schedule:
      f:showNotApplicable:
      f:strictNodeScan:
    Manager:         compliance-operator
    Operation:       Update
    Time:            2022-10-18T20:21:00Z
  Resource Version:  38840
  UID:               8cb0967d-05e0-4d7a-ac1c-08a7f7e89e84
Raw Result Storage:
  Node Selector:
    node-role.kubernetes.io/master:
  Pv Access Modes:
    ReadWriteOnce
  Rotation:  3
  Size:      1Gi
  Tolerations:
    Effect:              NoSchedule
    Key:                 node-role.kubernetes.io/master
    Operator:            Exists
    Effect:              NoExecute
    Key:                 node.kubernetes.io/not-ready
    Operator:            Exists
    Toleration Seconds:  300
    Effect:              NoExecute
    Key:                 node.kubernetes.io/unreachable
    Operator:            Exists
    Toleration Seconds:  300
    Effect:              NoSchedule
    Key:                 node.kubernetes.io/memory-pressure
    Operator:            Exists
Roles:
  master
  worker
Scan Tolerations:
  Operator:           Exists
Schedule:             0 1 * * *
Show Not Applicable:  false
Strict Node Scan:     true
Events:               &lt;none&gt;</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO31-1"><span class="callout">1</span></a> <a href="#CO31-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Setting <code class="literal">autoUpdateRemediations</code> and <code class="literal">autoApplyRemediations</code> flags to <code class="literal">true</code> allows you to easily create <code class="literal">ScanSetting</code> objects that auto-remediate without extra steps.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Create a <code class="literal">ScanSettingBinding</code> object that binds to the default <code class="literal">ScanSetting</code> object and scans the cluster using the <code class="literal">cis</code> and <code class="literal">cis-node</code> profiles. For example:
							</p><pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ScanSettingBinding
metadata:
  name: cis-compliance
  namespace: openshift-compliance
profiles:
  - name: ocp4-cis-node
    kind: Profile
    apiGroup: compliance.openshift.io/v1alpha1
  - name: ocp4-cis
    kind: Profile
    apiGroup: compliance.openshift.io/v1alpha1
settingsRef:
  name: default
  kind: ScanSetting
  apiGroup: compliance.openshift.io/v1alpha1</pre></li><li class="listitem"><p class="simpara">
								Create the <code class="literal">ScanSettingBinding</code> object by running:
							</p><pre class="programlisting language-terminal">$ oc create -f &lt;file-name&gt;.yaml -n openshift-compliance</pre><p class="simpara">
								At this point in the process, the <code class="literal">ScanSettingBinding</code> object is reconciled and based on the <code class="literal">Binding</code> and the <code class="literal">Bound</code> settings. The Compliance Operator creates a <code class="literal">ComplianceSuite</code> object and the associated <code class="literal">ComplianceScan</code> objects.
							</p></li><li class="listitem"><p class="simpara">
								Follow the compliance scan progress by running:
							</p><pre class="programlisting language-terminal">$ oc get compliancescan -w -n openshift-compliance</pre><p class="simpara">
								The scans progress through the scanning phases and eventually reach the <code class="literal">DONE</code> phase when complete. In most cases, the result of the scan is <code class="literal">NON-COMPLIANT</code>. You can review the scan results and start applying remediations to make the cluster compliant. See <span class="emphasis"><em>Managing Compliance Operator remediation</em></span> for more information.
							</p></li></ol></div></section><section class="section" id="running-compliance-scans-worker-node_compliance-operator-scans"><div class="titlepage"><div><div><h4 class="title">5.5.2.2. Scheduling the result server pod on a worker node</h4></div></div></div><p>
						The result server pod mounts the persistent volume (PV) that stores the raw Asset Reporting Format (ARF) scan results. The <code class="literal">nodeSelector</code> and <code class="literal">tolerations</code> attributes enable you to configure the location of the result server pod.
					</p><p>
						This is helpful for those environments where control plane nodes are not permitted to mount persistent volumes.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Create a <code class="literal">ScanSetting</code> custom resource (CR) for the Compliance Operator:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Define the <code class="literal">ScanSetting</code> CR, and save the YAML file, for example, <code class="literal">rs-workers.yaml</code>:
									</p><pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ScanSetting
metadata:
  name: rs-on-workers
  namespace: openshift-compliance
rawResultStorage:
  nodeSelector:
    node-role.kubernetes.io/worker: "" <span id="CO32-1"><!--Empty--></span><span class="callout">1</span>
  pvAccessModes:
  - ReadWriteOnce
  rotation: 3
  size: 1Gi
  tolerations:
  - operator: Exists <span id="CO32-2"><!--Empty--></span><span class="callout">2</span>
roles:
- worker
- master
scanTolerations:
  - operator: Exists
schedule: 0 1 * * *</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO32-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												The Compliance Operator uses this node to store scan results in ARF format.
											</div></dd><dt><a href="#CO32-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												The result server pod tolerates all taints.
											</div></dd></dl></div></li><li class="listitem"><p class="simpara">
										To create the <code class="literal">ScanSetting</code> CR, run the following command:
									</p><pre class="programlisting language-terminal">$ oc create -f rs-workers.yaml</pre></li></ol></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To verify that the <code class="literal">ScanSetting</code> object is created, run the following command:
							</p><pre class="programlisting language-terminal">$ oc get scansettings rs-on-workers -n openshift-compliance -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">apiVersion: compliance.openshift.io/v1alpha1
kind: ScanSetting
metadata:
  creationTimestamp: "2021-11-19T19:36:36Z"
  generation: 1
  name: rs-on-workers
  namespace: openshift-compliance
  resourceVersion: "48305"
  uid: 43fdfc5f-15a7-445a-8bbc-0e4a160cd46e
rawResultStorage:
  nodeSelector:
    node-role.kubernetes.io/worker: ""
  pvAccessModes:
  - ReadWriteOnce
  rotation: 3
  size: 1Gi
  tolerations:
  - operator: Exists
roles:
- worker
- master
scanTolerations:
- operator: Exists
schedule: 0 1 * * *
strictNodeScan: true</pre>

								</p></div></li></ul></div></section><section class="section" id="compliance-scansetting-cr_compliance-operator-scans"><div class="titlepage"><div><div><h4 class="title">5.5.2.3. <code class="literal">ScanSetting</code> Custom Resource</h4></div></div></div><p>
						The <code class="literal">ScanSetting</code> Custom Resource now allows you to override the default CPU and memory limits of scanner pods through the scan limits attribute. The Compliance Operator will use defaults of 500Mi memory, 100m CPU for the scanner container, and 200Mi memory with 100m CPU for the <code class="literal">api-resource-collector</code> container. To set the memory limits of the Operator, modify the <code class="literal">Subscription</code> object if installed through OLM or the Operator deployment itself.
					</p><p>
						To increase the default CPU and memory limits of the Compliance Operator, see <span class="emphasis"><em>Increasing Compliance Operator resource limits</em></span>.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Increasing the memory limit for the Compliance Operator or the scanner pods is needed if the default limits are not sufficient and the Operator or scanner pods are ended by the Out Of Memory (OOM) process.
						</p></div></div></section><section class="section" id="co-hcp-mgmt-config_compliance-operator-scans"><div class="titlepage"><div><div><h4 class="title">5.5.2.4. Configuring the Hosted control planes management cluster</h4></div></div></div><p>
						If you are hosting your own Hosted control plane or Hypershift environment and want to scan a Hosted Cluster from the management cluster, you will need to set the name and prefix namespace for the target Hosted Cluster. You can achieve this by creating a <code class="literal">TailoredProfile</code>.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							This procedure only applies to users managing their own Hosted control planes environment.
						</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Only <code class="literal">ocp4-cis</code> and <code class="literal">ocp4-pci-dss</code> profiles are supported in Hosted control planes management clusters.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The Compliance Operator is installed in the management cluster.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Obtain the <code class="literal">name</code> and <code class="literal">namespace</code> of the hosted cluster to be scanned by running the following command:
							</p><pre class="programlisting language-terminal">$ oc get hostedcluster -A</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAMESPACE       NAME                   VERSION   KUBECONFIG                              PROGRESS    AVAILABLE   PROGRESSING   MESSAGE
local-cluster   79136a1bdb84b3c13217   4.13.5    79136a1bdb84b3c13217-admin-kubeconfig   Completed   True        False         The hosted control plane is available</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								In the management cluster, create a <code class="literal">TailoredProfile</code> extending the scan Profile and define the name and namespace of the Hosted Cluster to be scanned:
							</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">management-tailoredprofile.yaml</code></strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: TailoredProfile
metadata:
  name: hypershift-cisk57aw88gry
  namespace: openshift-compliance
spec:
  description: This profile test required rules
  extends: ocp4-cis <span id="CO33-1"><!--Empty--></span><span class="callout">1</span>
  title: Management namespace profile
  setValues:
  - name: ocp4-hypershift-cluster
    rationale: This value is used for HyperShift version detection
    value: 79136a1bdb84b3c13217 <span id="CO33-2"><!--Empty--></span><span class="callout">2</span>
  - name: ocp4-hypershift-namespace-prefix
    rationale: This value is used for HyperShift control plane namespace detection
    value: local-cluster <span id="CO33-3"><!--Empty--></span><span class="callout">3</span></pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO33-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Variable. Only <code class="literal">ocp4-cis</code> and <code class="literal">ocp4-pci-dss</code> profiles are supported in Hosted control planes management clusters.
									</div></dd><dt><a href="#CO33-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										The <code class="literal">value</code> is the <code class="literal">NAME</code> from the output in the previous step.
									</div></dd><dt><a href="#CO33-3"><span class="callout">3</span></a> </dt><dd><div class="para">
										The <code class="literal">value</code> is the <code class="literal">NAMESPACE</code> from the output in the previous step.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Create the <code class="literal">TailoredProfile</code>:
							</p><pre class="programlisting language-terminal">$ oc create -n openshift-compliance -f mgmt-tp.yaml</pre></li></ol></div></section><section class="section" id="compliance-applying-resource-requests-and-limits_compliance-operator-scans"><div class="titlepage"><div><div><h4 class="title">5.5.2.5. Applying resource requests and limits</h4></div></div></div><p>
						When the kubelet starts a container as part of a Pod, the kubelet passes that container’s requests and limits for memory and CPU to the container runtime. In Linux, the container runtime configures the kernel cgroups that apply and enforce the limits you defined.
					</p><p>
						The CPU limit defines how much CPU time the container can use. During each scheduling interval, the Linux kernel checks to see if this limit is exceeded. If so, the kernel waits before allowing the cgroup to resume execution.
					</p><p>
						If several different containers (cgroups) want to run on a contended system, workloads with larger CPU requests are allocated more CPU time than workloads with small requests. The memory request is used during Pod scheduling. On a node that uses cgroups v2, the container runtime might use the memory request as a hint to set <code class="literal">memory.min</code> and <code class="literal">memory.low</code> values.
					</p><p>
						If a container attempts to allocate more memory than this limit, the Linux kernel out-of-memory subsystem activates and intervenes by stopping one of the processes in the container that tried to allocate memory. The memory limit for the Pod or container can also apply to pages in memory-backed volumes, such as an emptyDir.
					</p><p>
						The kubelet tracks <code class="literal">tmpfs</code> <code class="literal">emptyDir</code> volumes as container memory is used, rather than as local ephemeral storage. If a container exceeds its memory request and the node that it runs on becomes short of memory overall, the Pod’s container might be evicted.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							A container may not exceed its CPU limit for extended periods. Container run times do not stop Pods or containers for excessive CPU usage. To determine whether a container cannot be scheduled or is being killed due to resource limits, see <span class="emphasis"><em>Troubleshooting the Compliance Operator</em></span>.
						</p></div></div></section><section class="section" id="compliance-scheduling-pods-with-resource-requests_compliance-operator-scans"><div class="titlepage"><div><div><h4 class="title">5.5.2.6. Scheduling Pods with container resource requests</h4></div></div></div><p>
						When a Pod is created, the scheduler selects a Node for the Pod to run on. Each node has a maximum capacity for each resource type in the amount of CPU and memory it can provide for the Pods. The scheduler ensures that the sum of the resource requests of the scheduled containers is less than the capacity nodes for each resource type.
					</p><p>
						Although memory or CPU resource usage on nodes is very low, the scheduler might still refuse to place a Pod on a node if the capacity check fails to protect against a resource shortage on a node.
					</p><p>
						For each container, you can specify the following resource limits and request:
					</p><pre class="programlisting language-terminal">spec.containers[].resources.limits.cpu
spec.containers[].resources.limits.memory
spec.containers[].resources.limits.hugepages-&lt;size&gt;
spec.containers[].resources.requests.cpu
spec.containers[].resources.requests.memory
spec.containers[].resources.requests.hugepages-&lt;size&gt;</pre><p>
						Although you can specify requests and limits for only individual containers, it is also useful to consider the overall resource requests and limits for a pod. For a particular resource, a container resource request or limit is the sum of the resource requests or limits of that type for each container in the pod.
					</p><div class="formalpara"><p class="title"><strong>Example container resource requests and limits</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: v1
kind: Pod
metadata:
  name: frontend
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    resources:
      requests: <span id="CO34-1"><!--Empty--></span><span class="callout">1</span>
        memory: "64Mi"
        cpu: "250m"
      limits: <span id="CO34-2"><!--Empty--></span><span class="callout">2</span>
        memory: "128Mi"
        cpu: "500m"
  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    resources:
      requests:
        memory: "64Mi"
        cpu: "250m"
      limits:
        memory: "128Mi"
        cpu: "500m"</pre>

						</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO34-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								The container is requesting 64 Mi of memory and 250 m CPU.
							</div></dd><dt><a href="#CO34-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								The container’s limits are 128 Mi of memory and 500 m CPU.
							</div></dd></dl></div></section></section><section class="section" id="compliance-operator-tailor"><div class="titlepage"><div><div><h3 class="title">5.5.3. Tailoring the Compliance Operator</h3></div></div></div><p>
					While the Compliance Operator comes with ready-to-use profiles, they must be modified to fit the organizations’ needs and requirements. The process of modifying a profile is called <span class="emphasis"><em>tailoring</em></span>.
				</p><p>
					The Compliance Operator provides the <code class="literal">TailoredProfile</code> object to help tailor profiles.
				</p><section class="section" id="compliance-new-tailored-profiles_compliance-tailor"><div class="titlepage"><div><div><h4 class="title">5.5.3.1. Creating a new tailored profile</h4></div></div></div><p>
						You can write a tailored profile from scratch by using the <code class="literal">TailoredProfile</code> object. Set an appropriate <code class="literal">title</code> and <code class="literal">description</code> and leave the <code class="literal">extends</code> field empty. Indicate to the Compliance Operator what type of scan this custom profile will generate:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Node scan: Scans the Operating System.
							</li><li class="listitem">
								Platform scan: Scans the OpenShift Container Platform configuration.
							</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the following annotation on the <code class="literal">TailoredProfile</code> object:
							</li></ul></div><div class="formalpara"><p class="title"><strong>Example <code class="literal">new-profile.yaml</code></strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: TailoredProfile
metadata:
  name: new-profile
  annotations:
    compliance.openshift.io/product-type: Node <span id="CO35-1"><!--Empty--></span><span class="callout">1</span>
spec:
  extends: ocp4-cis-node <span id="CO35-2"><!--Empty--></span><span class="callout">2</span>
  description: My custom profile <span id="CO35-3"><!--Empty--></span><span class="callout">3</span>
  title: Custom profile <span id="CO35-4"><!--Empty--></span><span class="callout">4</span>
  enableRules:
    - name: ocp4-etcd-unique-ca
      rationale: We really need to enable this
  disableRules:
    - name: ocp4-file-groupowner-cni-conf
      rationale: This does not apply to the cluster</pre>

						</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO35-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Set <code class="literal">Node</code> or <code class="literal">Platform</code> accordingly.
							</div></dd><dt><a href="#CO35-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								The <code class="literal">extends</code> field is optional.
							</div></dd><dt><a href="#CO35-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								Use the <code class="literal">description</code> field to describe the function of the new <code class="literal">TailoredProfile</code> object.
							</div></dd><dt><a href="#CO35-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								Give your <code class="literal">TailoredProfile</code> object a title with the <code class="literal">title</code> field.
							</div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Adding the <code class="literal">-node</code> suffix to the <code class="literal">name</code> field of the <code class="literal">TailoredProfile</code> object is similar to adding the <code class="literal">Node</code> product type annotation and generates an Operating System scan.
								</p></div></div></dd></dl></div></section><section class="section" id="compliance-tailored-profiles_compliance-tailor"><div class="titlepage"><div><div><h4 class="title">5.5.3.2. Using tailored profiles to extend existing ProfileBundles</h4></div></div></div><p>
						While the <code class="literal">TailoredProfile</code> CR enables the most common tailoring operations, the XCCDF standard allows even more flexibility in tailoring OpenSCAP profiles. In addition, if your organization has been using OpenScap previously, you may have an existing XCCDF tailoring file and can reuse it.
					</p><p>
						The <code class="literal">ComplianceSuite</code> object contains an optional <code class="literal">TailoringConfigMap</code> attribute that you can point to a custom tailoring file. The value of the <code class="literal">TailoringConfigMap</code> attribute is a name of a config map, which must contain a key called <code class="literal">tailoring.xml</code> and the value of this key is the tailoring contents.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Browse the available rules for the Red Hat Enterprise Linux CoreOS (RHCOS) <code class="literal">ProfileBundle</code>:
							</p><pre class="programlisting language-terminal">$ oc get rules.compliance -n openshift-compliance -l compliance.openshift.io/profile-bundle=rhcos4</pre></li><li class="listitem"><p class="simpara">
								Browse the available variables in the same <code class="literal">ProfileBundle</code>:
							</p><pre class="programlisting language-terminal">$ oc get variables.compliance -n openshift-compliance -l compliance.openshift.io/profile-bundle=rhcos4</pre></li><li class="listitem"><p class="simpara">
								Create a tailored profile named <code class="literal">nist-moderate-modified</code>:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Choose which rules you want to add to the <code class="literal">nist-moderate-modified</code> tailored profile. This example extends the <code class="literal">rhcos4-moderate</code> profile by disabling two rules and changing one value. Use the <code class="literal">rationale</code> value to describe why these changes were made:
									</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">new-profile-node.yaml</code></strong></p><p>
											
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: TailoredProfile
metadata:
  name: nist-moderate-modified
spec:
  extends: rhcos4-moderate
  description: NIST moderate profile
  title: My modified NIST moderate profile
  disableRules:
  - name: rhcos4-file-permissions-var-log-messages
    rationale: The file contains logs of error messages in the system
  - name: rhcos4-account-disable-post-pw-expiration
    rationale: No need to check this as it comes from the IdP
  setValues:
  - name: rhcos4-var-selinux-state
    rationale: Organizational requirements
    value: permissive</pre>

										</p></div><div class="table" id="idm139961124068864"><p class="title"><strong>Table 5.3. Attributes for spec variables</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 67%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139961124064016" scope="col">Attribute</th><th align="left" valign="top" id="idm139961124062928" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139961124064016"> <p>
														<code class="literal">extends</code>
													</p>
													 </td><td align="left" valign="top" headers="idm139961124062928"> <p>
														Name of the <code class="literal">Profile</code> object upon which this <code class="literal">TailoredProfile</code> is built.
													</p>
													 </td></tr><tr><td align="left" valign="top" headers="idm139961124064016"> <p>
														<code class="literal">title</code>
													</p>
													 </td><td align="left" valign="top" headers="idm139961124062928"> <p>
														Human-readable title of the <code class="literal">TailoredProfile</code>.
													</p>
													 </td></tr><tr><td align="left" valign="top" headers="idm139961124064016"> <p>
														<code class="literal">disableRules</code>
													</p>
													 </td><td align="left" valign="top" headers="idm139961124062928"> <p>
														A list of name and rationale pairs. Each name refers to a name of a rule object that is to be disabled. The rationale value is human-readable text describing why the rule is disabled.
													</p>
													 </td></tr><tr><td align="left" valign="top" headers="idm139961124064016"> <p>
														<code class="literal">manualRules</code>
													</p>
													 </td><td align="left" valign="top" headers="idm139961124062928"> <p>
														A list of name and rationale pairs. When a manual rule is added, the check result status will always be <code class="literal">manual</code> and remediation will not be generated. This attribute is automatic and by default has no values when set as a manual rule.
													</p>
													 </td></tr><tr><td align="left" valign="top" headers="idm139961124064016"> <p>
														<code class="literal">enableRules</code>
													</p>
													 </td><td align="left" valign="top" headers="idm139961124062928"> <p>
														A list of name and rationale pairs. Each name refers to a name of a rule object that is to be enabled. The rationale value is human-readable text describing why the rule is enabled.
													</p>
													 </td></tr><tr><td align="left" valign="top" headers="idm139961124064016"> <p>
														<code class="literal">description</code>
													</p>
													 </td><td align="left" valign="top" headers="idm139961124062928"> <p>
														Human-readable text describing the <code class="literal">TailoredProfile</code>.
													</p>
													 </td></tr><tr><td align="left" valign="top" headers="idm139961124064016"> <p>
														<code class="literal">setValues</code>
													</p>
													 </td><td align="left" valign="top" headers="idm139961124062928"> <p>
														A list of name, rationale, and value groupings. Each name refers to a name of the value set. The rationale is human-readable text describing the set. The value is the actual setting.
													</p>
													 </td></tr></tbody></table></div></div></li><li class="listitem"><p class="simpara">
										Add the <code class="literal">tailoredProfile.spec.manualRules</code> attribute:
									</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">tailoredProfile.spec.manualRules.yaml</code></strong></p><p>
											
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: TailoredProfile
metadata:
  name: ocp4-manual-scc-check
spec:
  extends: ocp4-cis
  description: This profile extends ocp4-cis by forcing the SCC check to always return MANUAL
  title: OCP4 CIS profile with manual SCC check
  manualRules:
    - name: ocp4-scc-limit-container-allowed-capabilities
      rationale: We use third party software that installs its own SCC with extra privileges</pre>

										</p></div></li><li class="listitem"><p class="simpara">
										Create the <code class="literal">TailoredProfile</code> object:
									</p><pre class="programlisting language-terminal">$ oc create -n openshift-compliance -f new-profile-node.yaml <span id="CO36-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO36-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												The <code class="literal">TailoredProfile</code> object is created in the default <code class="literal">openshift-compliance</code> namespace.
											</div></dd></dl></div><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-terminal">tailoredprofile.compliance.openshift.io/nist-moderate-modified created</pre>

										</p></div></li></ol></div></li><li class="listitem"><p class="simpara">
								Define the <code class="literal">ScanSettingBinding</code> object to bind the new <code class="literal">nist-moderate-modified</code> tailored profile to the default <code class="literal">ScanSetting</code> object.
							</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">new-scansettingbinding.yaml</code></strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ScanSettingBinding
metadata:
  name: nist-moderate-modified
profiles:
  - apiGroup: compliance.openshift.io/v1alpha1
    kind: Profile
    name: ocp4-moderate
  - apiGroup: compliance.openshift.io/v1alpha1
    kind: TailoredProfile
    name: nist-moderate-modified
settingsRef:
  apiGroup: compliance.openshift.io/v1alpha1
  kind: ScanSetting
  name: default</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Create the <code class="literal">ScanSettingBinding</code> object:
							</p><pre class="programlisting language-terminal">$ oc create -n openshift-compliance -f new-scansettingbinding.yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">scansettingbinding.compliance.openshift.io/nist-moderate-modified created</pre>

								</p></div></li></ol></div></section></section><section class="section" id="compliance-operator-raw-results"><div class="titlepage"><div><div><h3 class="title">5.5.4. Retrieving Compliance Operator raw results</h3></div></div></div><p>
					When proving compliance for your OpenShift Container Platform cluster, you might need to provide the scan results for auditing purposes.
				</p><section class="section" id="compliance-results_compliance-raw-results"><div class="titlepage"><div><div><h4 class="title">5.5.4.1. Obtaining Compliance Operator raw results from a persistent volume</h4></div></div></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							The Compliance Operator generates and stores the raw results in a persistent volume. These results are in Asset Reporting Format (ARF).
						</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Explore the <code class="literal">ComplianceSuite</code> object:
							</p><pre class="programlisting language-terminal">$ oc get compliancesuites nist-moderate-modified \
-o json -n openshift-compliance | jq '.status.scanStatuses[].resultsStorage'</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-json">{
     "name": "ocp4-moderate",
     "namespace": "openshift-compliance"
}
{
     "name": "nist-moderate-modified-master",
     "namespace": "openshift-compliance"
}
{
     "name": "nist-moderate-modified-worker",
     "namespace": "openshift-compliance"
}</pre>

								</p></div><p class="simpara">
								This shows the persistent volume claims where the raw results are accessible.
							</p></li><li class="listitem"><p class="simpara">
								Verify the raw data location by using the name and namespace of one of the results:
							</p><pre class="programlisting language-terminal">$ oc get pvc -n openshift-compliance rhcos4-moderate-worker</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                 	STATUS   VOLUME                                 	CAPACITY   ACCESS MODES   STORAGECLASS   AGE
rhcos4-moderate-worker   Bound	pvc-548f6cfe-164b-42fe-ba13-a07cfbc77f3a   1Gi    	RWO        	gp2        	92m</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Fetch the raw results by spawning a pod that mounts the volume and copying the results:
							</p><pre class="programlisting language-terminal">$ oc create -n openshift-compliance -f pod.yaml</pre><div class="formalpara"><p class="title"><strong>Example pod.yaml</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: "v1"
kind: Pod
metadata:
  name: pv-extract
spec:
  containers:
    - name: pv-extract-pod
      image: registry.access.redhat.com/ubi9/ubi
      command: ["sleep", "3000"]
      volumeMounts:
      - mountPath: "/workers-scan-results"
        name: workers-scan-vol
  volumes:
    - name: workers-scan-vol
      persistentVolumeClaim:
        claimName: rhcos4-moderate-worker</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								After the pod is running, download the results:
							</p><pre class="programlisting language-terminal">$ oc cp pv-extract:/workers-scan-results -n openshift-compliance .</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									Spawning a pod that mounts the persistent volume will keep the claim as <code class="literal">Bound</code>. If the volume’s storage class in use has permissions set to <code class="literal">ReadWriteOnce</code>, the volume is only mountable by one pod at a time. You must delete the pod upon completion, or it will not be possible for the Operator to schedule a pod and continue storing results in this location.
								</p></div></div></li><li class="listitem"><p class="simpara">
								After the extraction is complete, the pod can be deleted:
							</p><pre class="programlisting language-terminal">$ oc delete pod pv-extract -n openshift-compliance</pre></li></ol></div></section></section><section class="section" id="compliance-operator-remediation"><div class="titlepage"><div><div><h3 class="title">5.5.5. Managing Compliance Operator result and remediation</h3></div></div></div><p>
					Each <code class="literal">ComplianceCheckResult</code> represents a result of one compliance rule check. If the rule can be remediated automatically, a <code class="literal">ComplianceRemediation</code> object with the same name, owned by the <code class="literal">ComplianceCheckResult</code> is created. Unless requested, the remediations are not applied automatically, which gives an OpenShift Container Platform administrator the opportunity to review what the remediation does and only apply a remediation once it has been verified.
				</p><section class="section" id="filtering-compliance-check-results_compliance-remediation"><div class="titlepage"><div><div><h4 class="title">5.5.5.1. Filters for compliance check results</h4></div></div></div><p>
						By default, the <code class="literal">ComplianceCheckResult</code> objects are labeled with several useful labels that allow you to query the checks and decide on the next steps after the results are generated.
					</p><p>
						List checks that belong to a specific suite:
					</p><pre class="programlisting language-terminal">$ oc get -n openshift-compliance compliancecheckresults \
  -l compliance.openshift.io/suite=workers-compliancesuite</pre><p>
						List checks that belong to a specific scan:
					</p><pre class="programlisting language-terminal">$ oc get -n openshift-compliance compliancecheckresults \
-l compliance.openshift.io/scan=workers-scan</pre><p>
						Not all <code class="literal">ComplianceCheckResult</code> objects create <code class="literal">ComplianceRemediation</code> objects. Only <code class="literal">ComplianceCheckResult</code> objects that can be remediated automatically do. A <code class="literal">ComplianceCheckResult</code> object has a related remediation if it is labeled with the <code class="literal">compliance.openshift.io/automated-remediation</code> label. The name of the remediation is the same as the name of the check.
					</p><p>
						List all failing checks that can be remediated automatically:
					</p><pre class="programlisting language-terminal">$ oc get -n openshift-compliance compliancecheckresults \
-l 'compliance.openshift.io/check-status=FAIL,compliance.openshift.io/automated-remediation'</pre><p>
						List all failing checks sorted by severity:
					</p><pre class="programlisting language-terminal">$ oc get compliancecheckresults -n openshift-compliance \
-l 'compliance.openshift.io/check-status=FAIL,compliance.openshift.io/check-severity=high'</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">NAME                                                           STATUS   SEVERITY
nist-moderate-modified-master-configure-crypto-policy          FAIL     high
nist-moderate-modified-master-coreos-pti-kernel-argument       FAIL     high
nist-moderate-modified-master-disable-ctrlaltdel-burstaction   FAIL     high
nist-moderate-modified-master-disable-ctrlaltdel-reboot        FAIL     high
nist-moderate-modified-master-no-empty-passwords               FAIL     high
nist-moderate-modified-master-selinux-state                    FAIL     high
nist-moderate-modified-worker-configure-crypto-policy          FAIL     high
nist-moderate-modified-worker-coreos-pti-kernel-argument       FAIL     high
nist-moderate-modified-worker-disable-ctrlaltdel-burstaction   FAIL     high
nist-moderate-modified-worker-disable-ctrlaltdel-reboot        FAIL     high
nist-moderate-modified-worker-no-empty-passwords               FAIL     high
nist-moderate-modified-worker-selinux-state                    FAIL     high
ocp4-moderate-configure-network-policies-namespaces            FAIL     high</pre>

						</p></div><p>
						List all failing checks that must be remediated manually:
					</p><pre class="programlisting language-terminal">$ oc get -n openshift-compliance compliancecheckresults \
-l 'compliance.openshift.io/check-status=FAIL,!compliance.openshift.io/automated-remediation'</pre><p>
						The manual remediation steps are typically stored in the <code class="literal">description</code> attribute in the <code class="literal">ComplianceCheckResult</code> object.
					</p><div class="table" id="idm139961167436752"><p class="title"><strong>Table 5.4. ComplianceCheckResult Status</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139961123854544" scope="col">ComplianceCheckResult Status</th><th align="left" valign="top" id="idm139961123853440" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139961123854544"> <p>
										PASS
									</p>
									 </td><td align="left" valign="top" headers="idm139961123853440"> <p>
										Compliance check ran to completion and passed.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961123854544"> <p>
										FAIL
									</p>
									 </td><td align="left" valign="top" headers="idm139961123853440"> <p>
										Compliance check ran to completion and failed.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961123854544"> <p>
										INFO
									</p>
									 </td><td align="left" valign="top" headers="idm139961123853440"> <p>
										Compliance check ran to completion and found something not severe enough to be considered an error.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961123854544"> <p>
										MANUAL
									</p>
									 </td><td align="left" valign="top" headers="idm139961123853440"> <p>
										Compliance check does not have a way to automatically assess the success or failure and must be checked manually.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961123854544"> <p>
										INCONSISTENT
									</p>
									 </td><td align="left" valign="top" headers="idm139961123853440"> <p>
										Compliance check reports different results from different sources, typically cluster nodes.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961123854544"> <p>
										ERROR
									</p>
									 </td><td align="left" valign="top" headers="idm139961123853440"> <p>
										Compliance check ran, but could not complete properly.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961123854544"> <p>
										NOT-APPLICABLE
									</p>
									 </td><td align="left" valign="top" headers="idm139961123853440"> <p>
										Compliance check did not run because it is not applicable or not selected.
									</p>
									 </td></tr></tbody></table></div></div></section><section class="section" id="compliance-review_compliance-remediation"><div class="titlepage"><div><div><h4 class="title">5.5.5.2. Reviewing a remediation</h4></div></div></div><p>
						Review both the <code class="literal">ComplianceRemediation</code> object and the <code class="literal">ComplianceCheckResult</code> object that owns the remediation. The <code class="literal">ComplianceCheckResult</code> object contains human-readable descriptions of what the check does and the hardening trying to prevent, as well as other <code class="literal">metadata</code> like the severity and the associated security controls. The <code class="literal">ComplianceRemediation</code> object represents a way to fix the problem described in the <code class="literal">ComplianceCheckResult</code>. After first scan, check for remediations with the state <code class="literal">MissingDependencies</code>.
					</p><p>
						Below is an example of a check and a remediation called <code class="literal">sysctl-net-ipv4-conf-all-accept-redirects</code>. This example is redacted to only show <code class="literal">spec</code> and <code class="literal">status</code> and omits <code class="literal">metadata</code>:
					</p><pre class="programlisting language-yaml">spec:
  apply: false
  current:
  object:
    apiVersion: machineconfiguration.openshift.io/v1
    kind: MachineConfig
    spec:
      config:
        ignition:
          version: 3.2.0
        storage:
          files:
            - path: /etc/sysctl.d/75-sysctl_net_ipv4_conf_all_accept_redirects.conf
              mode: 0644
              contents:
                source: data:,net.ipv4.conf.all.accept_redirects%3D0
  outdated: {}
status:
  applicationState: NotApplied</pre><p>
						The remediation payload is stored in the <code class="literal">spec.current</code> attribute. The payload can be any Kubernetes object, but because this remediation was produced by a node scan, the remediation payload in the above example is a <code class="literal">MachineConfig</code> object. For Platform scans, the remediation payload is often a different kind of an object (for example, a <code class="literal">ConfigMap</code> or <code class="literal">Secret</code> object), but typically applying that remediation is up to the administrator, because otherwise the Compliance Operator would have required a very broad set of permissions to manipulate any generic Kubernetes object. An example of remediating a Platform check is provided later in the text.
					</p><p>
						To see exactly what the remediation does when applied, the <code class="literal">MachineConfig</code> object contents use the Ignition objects for the configuration. See the <a class="link" href="https://coreos.github.io/ignition/specs/">Ignition specification</a> for further information about the format. In our example, <code class="literal">the spec.config.storage.files[0].path</code> attribute specifies the file that is being create by this remediation (<code class="literal">/etc/sysctl.d/75-sysctl_net_ipv4_conf_all_accept_redirects.conf</code>) and the <code class="literal">spec.config.storage.files[0].contents.source</code> attribute specifies the contents of that file.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The contents of the files are URL-encoded.
						</p></div></div><p>
						Use the following Python script to view the contents:
					</p><pre class="programlisting language-terminal">$ echo "net.ipv4.conf.all.accept_redirects%3D0" | python3 -c "import sys, urllib.parse; print(urllib.parse.unquote(''.join(sys.stdin.readlines())))"</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">net.ipv4.conf.all.accept_redirects=0</pre>

						</p></div></section><section class="section" id="compliance-operator-apply-remediation-for-customized-mcp"><div class="titlepage"><div><div><h4 class="title">5.5.5.3. Applying remediation when using customized machine config pools</h4></div></div></div><p>
						When you create a custom <code class="literal">MachineConfigPool</code>, add a label to the <code class="literal">MachineConfigPool</code> so that <code class="literal">machineConfigPoolSelector</code> present in the <code class="literal">KubeletConfig</code> can match the label with <code class="literal">MachineConfigPool</code>.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Do not set <code class="literal">protectKernelDefaults: false</code> in the <code class="literal">KubeletConfig</code> file, because the <code class="literal">MachineConfigPool</code> object might fail to unpause unexpectedly after the Compliance Operator finishes applying remediation.
						</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								List the nodes.
							</p><pre class="programlisting language-terminal">$ oc get nodes -n openshift-compliance</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                       STATUS  ROLES  AGE    VERSION
ip-10-0-128-92.us-east-2.compute.internal  Ready   master 5h21m  v1.26.0
ip-10-0-158-32.us-east-2.compute.internal  Ready   worker 5h17m  v1.26.0
ip-10-0-166-81.us-east-2.compute.internal  Ready   worker 5h17m  v1.26.0
ip-10-0-171-170.us-east-2.compute.internal Ready   master 5h21m  v1.26.0
ip-10-0-197-35.us-east-2.compute.internal  Ready   master 5h22m  v1.26.0</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Add a label to nodes.
							</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance \
label node ip-10-0-166-81.us-east-2.compute.internal \
node-role.kubernetes.io/&lt;machine_config_pool_name&gt;=</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">node/ip-10-0-166-81.us-east-2.compute.internal labeled</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Create custom <code class="literal">MachineConfigPool</code> CR.
							</p><pre class="programlisting language-yaml">apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfigPool
metadata:
  name: &lt;machine_config_pool_name&gt;
  labels:
    pools.operator.machineconfiguration.openshift.io/&lt;machine_config_pool_name&gt;: '' <span id="CO37-1"><!--Empty--></span><span class="callout">1</span>
spec:
  machineConfigSelector:
  matchExpressions:
  - {key: machineconfiguration.openshift.io/role, operator: In, values: [worker,&lt;machine_config_pool_name&gt;]}
  nodeSelector:
  matchLabels:
    node-role.kubernetes.io/&lt;machine_config_pool_name&gt;: ""</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO37-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										The <code class="literal">labels</code> field defines label name to add for Machine config pool(MCP).
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Verify MCP created successfully.
							</p><pre class="programlisting language-terminal">$ oc get mcp -w</pre></li></ol></div></section><section class="section" id="compliance-evaluate-kubeletconfig-rules_compliance-remediation"><div class="titlepage"><div><div><h4 class="title">5.5.5.4. Evaluating KubeletConfig rules against default configuration values</h4></div></div></div><p>
						OpenShift Container Platform infrastructure might contain incomplete configuration files at run time, and nodes assume default configuration values for missing configuration options. Some configuration options can be passed as command line arguments. As a result, the Compliance Operator cannot verify if the configuration file on the node is complete because it might be missing options used in the rule checks.
					</p><p>
						To prevent false negative results where the default configuration value passes a check, the Compliance Operator uses the Node/Proxy API to fetch the configuration for each node in a node pool, then all configuration options that are consistent across nodes in the node pool are stored in a file that represents the configuration for all nodes within that node pool. This increases the accuracy of the scan results.
					</p><p>
						No additional configuration changes are required to use this feature with default <code class="literal">master</code> and <code class="literal">worker</code> node pools configurations.
					</p></section><section class="section" id="compliance-custom-node-pools_compliance-remediation"><div class="titlepage"><div><div><h4 class="title">5.5.5.5. Scanning custom node pools</h4></div></div></div><p>
						The Compliance Operator does not maintain a copy of each node pool configuration. The Compliance Operator aggregates consistent configuration options for all nodes within a single node pool into one copy of the configuration file. The Compliance Operator then uses the configuration file for a particular node pool to evaluate rules against nodes within that pool.
					</p><p>
						If your cluster uses custom node pools outside the default <code class="literal">worker</code> and <code class="literal">master</code> node pools, you must supply additional variables to ensure the Compliance Operator aggregates a configuration file for that node pool.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To check the configuration against all pools in an example cluster containing <code class="literal">master</code>, <code class="literal">worker</code>, and custom <code class="literal">example</code> node pools, set the value of the <code class="literal">ocp-var-role-master</code> and <code class="literal">opc-var-role-worker</code> fields to <code class="literal">example</code> in the <code class="literal">TailoredProfile</code> object:
							</p><pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: TailoredProfile
metadata:
  name: cis-example-tp
spec:
  extends: ocp4-cis
  title: My modified NIST profile to scan example nodes
  setValues:
  - name: ocp4-var-role-master
    value: example
    rationale: test for example nodes
  - name: ocp4-var-role-worker
    value: example
    rationale: test for example nodes
  description: cis-example-scan</pre></li><li class="listitem"><p class="simpara">
								Add the <code class="literal">example</code> role to the <code class="literal">ScanSetting</code> object that will be stored in the <code class="literal">ScanSettingBinding</code> CR:
							</p><pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ScanSetting
metadata:
  name: default
  namespace: openshift-compliance
rawResultStorage:
  rotation: 3
  size: 1Gi
roles:
- worker
- master
- example
scanTolerations:
- effect: NoSchedule
  key: node-role.kubernetes.io/master
  operator: Exists
schedule: '0 1 * * *'</pre></li><li class="listitem"><p class="simpara">
								Create a scan that uses the <code class="literal">ScanSettingBinding</code> CR:
							</p><pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ScanSettingBinding
metadata:
  name: cis
  namespace: openshift-compliance
profiles:
- apiGroup: compliance.openshift.io/v1alpha1
  kind: Profile
  name: ocp4-cis
- apiGroup: compliance.openshift.io/v1alpha1
  kind: Profile
  name: ocp4-cis-node
- apiGroup: compliance.openshift.io/v1alpha1
  kind: TailoredProfile
  name: cis-example-tp
settingsRef:
  apiGroup: compliance.openshift.io/v1alpha1
  kind: ScanSetting
  name: default</pre></li></ol></div><p>
						The Compliance Operator checks the runtime <code class="literal">KubeletConfig</code> through the <code class="literal">Node/Proxy</code> API object and then uses variables such as <code class="literal">ocp-var-role-master</code> and <code class="literal">ocp-var-role-worker</code> to determine the nodes it performs the check against. In the <code class="literal">ComplianceCheckResult</code>, the <code class="literal">KubeletConfig</code> rules are shown as <code class="literal">ocp4-cis-kubelet-*</code>. The scan passes only if all selected nodes pass this check.
					</p><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								The Platform KubeletConfig rules are checked through the <code class="literal">Node/Proxy</code> object. You can find those rules by running the following command:
							</p><pre class="programlisting language-terminal">$ oc get rules -o json | jq '.items[] | select(.checkType == "Platform") | select(.metadata.name | contains("ocp4-kubelet-")) | .metadata.name'</pre></li></ul></div></section><section class="section" id="compliance-kubeletconfig-sub-pool-remediation_compliance-remediation"><div class="titlepage"><div><div><h4 class="title">5.5.5.6. Remediating <code class="literal">KubeletConfig</code> sub pools</h4></div></div></div><p>
						<code class="literal">KubeletConfig</code> remediation labels can be applied to <code class="literal">MachineConfigPool</code> sub-pools.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Add a label to the sub-pool <code class="literal">MachineConfigPool</code> CR:
							</p><pre class="programlisting language-terminal">$ oc label mcp &lt;sub-pool-name&gt; pools.operator.machineconfiguration.openshift.io/&lt;sub-pool-name&gt;=</pre></li></ul></div></section><section class="section" id="compliance-applying_compliance-remediation"><div class="titlepage"><div><div><h4 class="title">5.5.5.7. Applying a remediation</h4></div></div></div><p>
						The boolean attribute <code class="literal">spec.apply</code> controls whether the remediation should be applied by the Compliance Operator. You can apply the remediation by setting the attribute to <code class="literal">true</code>:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance \
patch complianceremediations/&lt;scan-name&gt;-sysctl-net-ipv4-conf-all-accept-redirects \
--patch '{"spec":{"apply":true}}' --type=merge</pre><p>
						After the Compliance Operator processes the applied remediation, the <code class="literal">status.ApplicationState</code> attribute would change to <span class="strong strong"><strong>Applied</strong></span> or to <span class="strong strong"><strong>Error</strong></span> if incorrect. When a machine config remediation is applied, that remediation along with all other applied remediations are rendered into a <code class="literal">MachineConfig</code> object named <code class="literal">75-$scan-name-$suite-name</code>. That <code class="literal">MachineConfig</code> object is subsequently rendered by the Machine Config Operator and finally applied to all the nodes in a machine config pool by an instance of the machine control daemon running on each node.
					</p><p>
						Note that when the Machine Config Operator applies a new <code class="literal">MachineConfig</code> object to nodes in a pool, all the nodes belonging to the pool are rebooted. This might be inconvenient when applying multiple remediations, each of which re-renders the composite <code class="literal">75-$scan-name-$suite-name</code> <code class="literal">MachineConfig</code> object. To prevent applying the remediation immediately, you can pause the machine config pool by setting the <code class="literal">.spec.paused</code> attribute of a <code class="literal">MachineConfigPool</code> object to <code class="literal">true</code>.
					</p><p>
						The Compliance Operator can apply remediations automatically. Set <code class="literal">autoApplyRemediations: true</code> in the <code class="literal">ScanSetting</code> top-level object.
					</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							Applying remediations automatically should only be done with careful consideration.
						</p></div></div></section><section class="section" id="compliance-manual_compliance-remediation"><div class="titlepage"><div><div><h4 class="title">5.5.5.8. Remediating a platform check manually</h4></div></div></div><p>
						Checks for Platform scans typically have to be remediated manually by the administrator for two reasons:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								It is not always possible to automatically determine the value that must be set. One of the checks requires that a list of allowed registries is provided, but the scanner has no way of knowing which registries the organization wants to allow.
							</li><li class="listitem">
								Different checks modify different API objects, requiring automated remediation to possess <code class="literal">root</code> or superuser access to modify objects in the cluster, which is not advised.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								The example below uses the <code class="literal">ocp4-ocp-allowed-registries-for-import</code> rule, which would fail on a default OpenShift Container Platform installation. Inspect the rule <code class="literal">oc get rule.compliance/ocp4-ocp-allowed-registries-for-import -oyaml</code>, the rule is to limit the registries the users are allowed to import images from by setting the <code class="literal">allowedRegistriesForImport</code> attribute, The <span class="emphasis"><em>warning</em></span> attribute of the rule also shows the API object checked, so it can be modified and remediate the issue:
							</p><pre class="programlisting language-terminal">$ oc edit image.config.openshift.io/cluster</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1
kind: Image
metadata:
  annotations:
    release.openshift.io/create-only: "true"
  creationTimestamp: "2020-09-10T10:12:54Z"
  generation: 2
  name: cluster
  resourceVersion: "363096"
  selfLink: /apis/config.openshift.io/v1/images/cluster
  uid: 2dcb614e-2f8a-4a23-ba9a-8e33cd0ff77e
spec:
  allowedRegistriesForImport:
  - domainName: registry.redhat.io
status:
  externalRegistryHostnames:
  - default-route-openshift-image-registry.apps.user-cluster-09-10-12-07.devcluster.openshift.com
  internalRegistryHostname: image-registry.openshift-image-registry.svc:5000</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Re-run the scan:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance \
annotate compliancescans/rhcos4-e8-worker compliance.openshift.io/rescan=</pre></li></ol></div></section><section class="section" id="compliance-updating_compliance-remediation"><div class="titlepage"><div><div><h4 class="title">5.5.5.9. Updating remediations</h4></div></div></div><p>
						When a new version of compliance content is used, it might deliver a new and different version of a remediation than the previous version. The Compliance Operator will keep the old version of the remediation applied. The OpenShift Container Platform administrator is also notified of the new version to review and apply. A ComplianceRemediation object that had been applied earlier, but was updated changes its status to <span class="strong strong"><strong>Outdated</strong></span>. The outdated objects are labeled so that they can be searched for easily.
					</p><p>
						The previously applied remediation contents would then be stored in the <code class="literal">spec.outdated</code> attribute of a <code class="literal">ComplianceRemediation</code> object and the new updated contents would be stored in the <code class="literal">spec.current</code> attribute. After updating the content to a newer version, the administrator then needs to review the remediation. As long as the <code class="literal">spec.outdated</code> attribute exists, it would be used to render the resulting <code class="literal">MachineConfig</code> object. After the <code class="literal">spec.outdated</code> attribute is removed, the Compliance Operator re-renders the resulting <code class="literal">MachineConfig</code> object, which causes the Operator to push the configuration to the nodes.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Search for any outdated remediations:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance get complianceremediations \
-l complianceoperator.openshift.io/outdated-remediation=</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                              STATE
workers-scan-no-empty-passwords   Outdated</pre>

								</p></div><p class="simpara">
								The currently applied remediation is stored in the <code class="literal">Outdated</code> attribute and the new, unapplied remediation is stored in the <code class="literal">Current</code> attribute. If you are satisfied with the new version, remove the <code class="literal">Outdated</code> field. If you want to keep the updated content, remove the <code class="literal">Current</code> and <code class="literal">Outdated</code> attributes.
							</p></li><li class="listitem"><p class="simpara">
								Apply the newer version of the remediation:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance patch complianceremediations workers-scan-no-empty-passwords \
--type json -p '[{"op":"remove", "path":/spec/outdated}]'</pre></li><li class="listitem"><p class="simpara">
								The remediation state will switch from <code class="literal">Outdated</code> to <code class="literal">Applied</code>:
							</p><pre class="programlisting language-terminal">$ oc get -n openshift-compliance complianceremediations workers-scan-no-empty-passwords</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                              STATE
workers-scan-no-empty-passwords   Applied</pre>

								</p></div></li><li class="listitem">
								The nodes will apply the newer remediation version and reboot.
							</li></ol></div></section><section class="section" id="compliance-unapplying_compliance-remediation"><div class="titlepage"><div><div><h4 class="title">5.5.5.10. Unapplying a remediation</h4></div></div></div><p>
						It might be required to unapply a remediation that was previously applied.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Set the <code class="literal">apply</code> flag to <code class="literal">false</code>:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance \
patch complianceremediations/rhcos4-moderate-worker-sysctl-net-ipv4-conf-all-accept-redirects \
--patch '{"spec":{"apply":false}}' --type=merge</pre></li><li class="listitem"><p class="simpara">
								The remediation status will change to <code class="literal">NotApplied</code> and the composite <code class="literal">MachineConfig</code> object would be re-rendered to not include the remediation.
							</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									All affected nodes with the remediation will be rebooted.
								</p></div></div></li></ol></div></section><section class="section" id="compliance-removing-kubeletconfig_compliance-remediation"><div class="titlepage"><div><div><h4 class="title">5.5.5.11. Removing a KubeletConfig remediation</h4></div></div></div><p>
						<code class="literal">KubeletConfig</code> remediations are included in node-level profiles. In order to remove a KubeletConfig remediation, you must manually remove it from the <code class="literal">KubeletConfig</code> objects. This example demonstrates how to remove the compliance check for the <code class="literal">one-rule-tp-node-master-kubelet-eviction-thresholds-set-hard-imagefs-available</code> remediation.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Locate the <code class="literal">scan-name</code> and compliance check for the <code class="literal">one-rule-tp-node-master-kubelet-eviction-thresholds-set-hard-imagefs-available</code> remediation:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance get remediation \ one-rule-tp-node-master-kubelet-eviction-thresholds-set-hard-imagefs-available -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ComplianceRemediation
metadata:
  annotations:
    compliance.openshift.io/xccdf-value-used: var-kubelet-evictionhard-imagefs-available
  creationTimestamp: "2022-01-05T19:52:27Z"
  generation: 1
  labels:
    compliance.openshift.io/scan-name: one-rule-tp-node-master <span id="CO38-1"><!--Empty--></span><span class="callout">1</span>
    compliance.openshift.io/suite: one-rule-ssb-node
  name: one-rule-tp-node-master-kubelet-eviction-thresholds-set-hard-imagefs-available
  namespace: openshift-compliance
  ownerReferences:
  - apiVersion: compliance.openshift.io/v1alpha1
    blockOwnerDeletion: true
    controller: true
    kind: ComplianceCheckResult
    name: one-rule-tp-node-master-kubelet-eviction-thresholds-set-hard-imagefs-available
    uid: fe8e1577-9060-4c59-95b2-3e2c51709adc
  resourceVersion: "84820"
  uid: 5339d21a-24d7-40cb-84d2-7a2ebb015355
spec:
  apply: true
  current:
    object:
      apiVersion: machineconfiguration.openshift.io/v1
      kind: KubeletConfig
      spec:
        kubeletConfig:
          evictionHard:
            imagefs.available: 10% <span id="CO38-2"><!--Empty--></span><span class="callout">2</span>
  outdated: {}
  type: Configuration
status:
  applicationState: Applied</pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO38-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										The scan name of the remediation.
									</div></dd><dt><a href="#CO38-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										The remediation that was added to the <code class="literal">KubeletConfig</code> objects.
									</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									If the remediation invokes an <code class="literal">evictionHard</code> kubelet configuration, you must specify all of the <code class="literal">evictionHard</code> parameters: <code class="literal">memory.available</code>, <code class="literal">nodefs.available</code>, <code class="literal">nodefs.inodesFree</code>, <code class="literal">imagefs.available</code>, and <code class="literal">imagefs.inodesFree</code>. If you do not specify all parameters, only the specified parameters are applied and the remediation will not function properly.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Remove the remediation:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Set <code class="literal">apply</code> to false for the remediation object:
									</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance patch \
complianceremediations/one-rule-tp-node-master-kubelet-eviction-thresholds-set-hard-imagefs-available \
-p '{"spec":{"apply":false}}' --type=merge</pre></li><li class="listitem"><p class="simpara">
										Using the <code class="literal">scan-name</code>, find the <code class="literal">KubeletConfig</code> object that the remediation was applied to:
									</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance get kubeletconfig \
--selector compliance.openshift.io/scan-name=one-rule-tp-node-master</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-terminal">NAME                                 AGE
compliance-operator-kubelet-master   2m34s</pre>

										</p></div></li><li class="listitem"><p class="simpara">
										Manually remove the remediation, <code class="literal">imagefs.available: 10%</code>, from the <code class="literal">KubeletConfig</code> object:
									</p><pre class="programlisting language-terminal">$ oc edit -n openshift-compliance KubeletConfig compliance-operator-kubelet-master</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
											All affected nodes with the remediation will be rebooted.
										</p></div></div></li></ol></div></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You must also exclude the rule from any scheduled scans in your tailored profiles that auto-applies the remediation, otherwise, the remediation will be re-applied during the next scheduled scan.
						</p></div></div></section><section class="section" id="compliance-inconsistent_compliance-remediation"><div class="titlepage"><div><div><h4 class="title">5.5.5.12. Inconsistent ComplianceScan</h4></div></div></div><p>
						The <code class="literal">ScanSetting</code> object lists the node roles that the compliance scans generated from the <code class="literal">ScanSetting</code> or <code class="literal">ScanSettingBinding</code> objects would scan. Each node role usually maps to a machine config pool.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							It is expected that all machines in a machine config pool are identical and all scan results from the nodes in a pool should be identical.
						</p></div></div><p>
						If some of the results are different from others, the Compliance Operator flags a <code class="literal">ComplianceCheckResult</code> object where some of the nodes will report as <code class="literal">INCONSISTENT</code>. All <code class="literal">ComplianceCheckResult</code> objects are also labeled with <code class="literal">compliance.openshift.io/inconsistent-check</code>.
					</p><p>
						Because the number of machines in a pool might be quite large, the Compliance Operator attempts to find the most common state and list the nodes that differ from the common state. The most common state is stored in the <code class="literal">compliance.openshift.io/most-common-status</code> annotation and the annotation <code class="literal">compliance.openshift.io/inconsistent-source</code> contains pairs of <code class="literal">hostname:status</code> of check statuses that differ from the most common status. If no common state can be found, all the <code class="literal">hostname:status</code> pairs are listed in the <code class="literal">compliance.openshift.io/inconsistent-source annotation</code>.
					</p><p>
						If possible, a remediation is still created so that the cluster can converge to a compliant status. However, this might not always be possible and correcting the difference between nodes must be done manually. The compliance scan must be re-run to get a consistent result by annotating the scan with the <code class="literal">compliance.openshift.io/rescan=</code> option:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance \
annotate compliancescans/rhcos4-e8-worker compliance.openshift.io/rescan=</pre></section><section class="section _additional-resources" id="additional-resources-9"><div class="titlepage"><div><div><h4 class="title">5.5.5.13. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-nodes-managing-about_nodes-nodes-managing">Modifying nodes</a>.
							</li></ul></div></section></section><section class="section" id="compliance-operator-advanced"><div class="titlepage"><div><div><h3 class="title">5.5.6. Performing advanced Compliance Operator tasks</h3></div></div></div><p>
					The Compliance Operator includes options for advanced users for the purpose of debugging or integration with existing tooling.
				</p><section class="section" id="compliance-objects_compliance-advanced"><div class="titlepage"><div><div><h4 class="title">5.5.6.1. Using the ComplianceSuite and ComplianceScan objects directly</h4></div></div></div><p>
						While it is recommended that users take advantage of the <code class="literal">ScanSetting</code> and <code class="literal">ScanSettingBinding</code> objects to define the suites and scans, there are valid use cases to define the <code class="literal">ComplianceSuite</code> objects directly:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Specifying only a single rule to scan. This can be useful for debugging together with the <code class="literal">debug: true</code> attribute which increases the OpenSCAP scanner verbosity, as the debug mode tends to get quite verbose otherwise. Limiting the test to one rule helps to lower the amount of debug information.
							</li><li class="listitem">
								Providing a custom nodeSelector. In order for a remediation to be applicable, the nodeSelector must match a pool.
							</li><li class="listitem">
								Pointing the Scan to a bespoke config map with a tailoring file.
							</li><li class="listitem">
								For testing or development when the overhead of parsing profiles from bundles is not required.
							</li></ul></div><p>
						The following example shows a <code class="literal">ComplianceSuite</code> that scans the worker machines with only a single rule:
					</p><pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ComplianceSuite
metadata:
  name: workers-compliancesuite
spec:
  scans:
    - name: workers-scan
      profile: xccdf_org.ssgproject.content_profile_moderate
      content: ssg-rhcos4-ds.xml
      contentImage: registry.redhat.io/compliance/openshift-compliance-content-rhel8@sha256:45dc...
      debug: true
      rule: xccdf_org.ssgproject.content_rule_no_direct_root_logins
      nodeSelector:
      node-role.kubernetes.io/worker: ""</pre><p>
						The <code class="literal">ComplianceSuite</code> object and the <code class="literal">ComplianceScan</code> objects referred to above specify several attributes in a format that OpenSCAP expects.
					</p><p>
						To find out the profile, content, or rule values, you can start by creating a similar Suite from <code class="literal">ScanSetting</code> and <code class="literal">ScanSettingBinding</code> or inspect the objects parsed from the <code class="literal">ProfileBundle</code> objects like rules or profiles. Those objects contain the <code class="literal">xccdf_org</code> identifiers you can use to refer to them from a <code class="literal">ComplianceSuite</code>.
					</p></section><section class="section" id="compliance-priorityclass_compliance-advanced"><div class="titlepage"><div><div><h4 class="title">5.5.6.2. Setting <code class="literal">PriorityClass</code> for <code class="literal">ScanSetting</code> scans</h4></div></div></div><p>
						In large scale environments, the default <code class="literal">PriorityClass</code> object can be too low to guarantee Pods execute scans on time. For clusters that must maintain compliance or guarantee automated scanning, it is recommended to set the <code class="literal">PriorityClass</code> variable to ensure the Compliance Operator is always given priority in resource constrained situations.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Set the <code class="literal">PriorityClass</code> variable:
							</p><pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
strictNodeScan: true
metadata:
  name: default
  namespace: openshift-compliance
priorityClass: compliance-high-priority <span id="CO39-1"><!--Empty--></span><span class="callout">1</span>
kind: ScanSetting
showNotApplicable: false
rawResultStorage:
  nodeSelector:
    node-role.kubernetes.io/master: ''
  pvAccessModes:
    - ReadWriteOnce
  rotation: 3
  size: 1Gi
  tolerations:
    - effect: NoSchedule
      key: node-role.kubernetes.io/master
      operator: Exists
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    - effect: NoSchedule
      key: node.kubernetes.io/memory-pressure
      operator: Exists
schedule: 0 1 * * *
roles:
  - master
  - worker
scanTolerations:
  - operator: Exists</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO39-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										If the <code class="literal">PriorityClass</code> referenced in the <code class="literal">ScanSetting</code> cannot be found, the Operator will leave the <code class="literal">PriorityClass</code> empty, issue a warning, and continue scheduling scans without a <code class="literal">PriorityClass</code>.
									</div></dd></dl></div></li></ul></div></section><section class="section" id="compliance-raw-tailored_compliance-advanced"><div class="titlepage"><div><div><h4 class="title">5.5.6.3. Using raw tailored profiles</h4></div></div></div><p>
						While the <code class="literal">TailoredProfile</code> CR enables the most common tailoring operations, the XCCDF standard allows even more flexibility in tailoring OpenSCAP profiles. In addition, if your organization has been using OpenScap previously, you may have an existing XCCDF tailoring file and can reuse it.
					</p><p>
						The <code class="literal">ComplianceSuite</code> object contains an optional <code class="literal">TailoringConfigMap</code> attribute that you can point to a custom tailoring file. The value of the <code class="literal">TailoringConfigMap</code> attribute is a name of a config map which must contain a key called <code class="literal">tailoring.xml</code> and the value of this key is the tailoring contents.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create the <code class="literal">ConfigMap</code> object from a file:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance \
create configmap nist-moderate-modified \
--from-file=tailoring.xml=/path/to/the/tailoringFile.xml</pre></li><li class="listitem"><p class="simpara">
								Reference the tailoring file in a scan that belongs to a suite:
							</p><pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ComplianceSuite
metadata:
  name: workers-compliancesuite
spec:
  debug: true
  scans:
    - name: workers-scan
      profile: xccdf_org.ssgproject.content_profile_moderate
      content: ssg-rhcos4-ds.xml
      contentImage: registry.redhat.io/compliance/openshift-compliance-content-rhel8@sha256:45dc...
      debug: true
  tailoringConfigMap:
      name: nist-moderate-modified
  nodeSelector:
    node-role.kubernetes.io/worker: ""</pre></li></ol></div></section><section class="section" id="compliance-rescan_compliance-advanced"><div class="titlepage"><div><div><h4 class="title">5.5.6.4. Performing a rescan</h4></div></div></div><p>
						Typically you will want to re-run a scan on a defined schedule, like every Monday or daily. It can also be useful to re-run a scan once after fixing a problem on a node. To perform a single scan, annotate the scan with the <code class="literal">compliance.openshift.io/rescan=</code> option:
					</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance \
annotate compliancescans/rhcos4-e8-worker compliance.openshift.io/rescan=</pre><p>
						A rescan generates four additional <code class="literal">mc</code> for <code class="literal">rhcos-moderate</code> profile:
					</p><pre class="programlisting language-terminal">$ oc get mc</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">75-worker-scan-chronyd-or-ntpd-specify-remote-server
75-worker-scan-configure-usbguard-auditbackend
75-worker-scan-service-usbguard-enabled
75-worker-scan-usbguard-allow-hid-and-hub</pre>

						</p></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							When the scan setting <code class="literal">default-auto-apply</code> label is applied, remediations are applied automatically and outdated remediations automatically update. If there are remediations that were not applied due to dependencies, or remediations that had been outdated, rescanning applies the remediations and might trigger a reboot. Only remediations that use <code class="literal">MachineConfig</code> objects trigger reboots. If there are no updates or dependencies to be applied, no reboot occurs.
						</p></div></div></section><section class="section" id="compliance-custom-storage_compliance-advanced"><div class="titlepage"><div><div><h4 class="title">5.5.6.5. Setting custom storage size for results</h4></div></div></div><p>
						While the custom resources such as <code class="literal">ComplianceCheckResult</code> represent an aggregated result of one check across all scanned nodes, it can be useful to review the raw results as produced by the scanner. The raw results are produced in the ARF format and can be large (tens of megabytes per node), it is impractical to store them in a Kubernetes resource backed by the <code class="literal">etcd</code> key-value store. Instead, every scan creates a persistent volume (PV) which defaults to 1GB size. Depending on your environment, you may want to increase the PV size accordingly. This is done using the <code class="literal">rawResultStorage.size</code> attribute that is exposed in both the <code class="literal">ScanSetting</code> and <code class="literal">ComplianceScan</code> resources.
					</p><p>
						A related parameter is <code class="literal">rawResultStorage.rotation</code> which controls how many scans are retained in the PV before the older scans are rotated. The default value is 3, setting the rotation policy to 0 disables the rotation. Given the default rotation policy and an estimate of 100MB per a raw ARF scan report, you can calculate the right PV size for your environment.
					</p><section class="section" id="using-custom-result-storage-values_compliance-advanced"><div class="titlepage"><div><div><h5 class="title">5.5.6.5.1. Using custom result storage values</h5></div></div></div><p>
							Because OpenShift Container Platform can be deployed in a variety of public clouds or bare metal, the Compliance Operator cannot determine available storage configurations. By default, the Compliance Operator will try to create the PV for storing results using the default storage class of the cluster, but a custom storage class can be configured using the <code class="literal">rawResultStorage.StorageClassName</code> attribute.
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								If your cluster does not specify a default storage class, this attribute must be set.
							</p></div></div><p>
							Configure the <code class="literal">ScanSetting</code> custom resource to use a standard storage class and create persistent volumes that are 10GB in size and keep the last 10 results:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">ScanSetting</code> CR</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ScanSetting
metadata:
  name: default
  namespace: openshift-compliance
rawResultStorage:
  storageClassName: standard
  rotation: 10
  size: 10Gi
roles:
- worker
- master
scanTolerations:
- effect: NoSchedule
  key: node-role.kubernetes.io/master
  operator: Exists
schedule: '0 1 * * *'</pre>

							</p></div></section></section><section class="section" id="installing-compliance-operator-cli_compliance-advanced"><div class="titlepage"><div><div><h4 class="title">5.5.6.6. Applying remediations generated by suite scans</h4></div></div></div><p>
						Although you can use the <code class="literal">autoApplyRemediations</code> boolean parameter in a <code class="literal">ComplianceSuite</code> object, you can alternatively annotate the object with <code class="literal">compliance.openshift.io/apply-remediations</code>. This allows the Operator to apply all of the created remediations.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Apply the <code class="literal">compliance.openshift.io/apply-remediations</code> annotation by running:
							</li></ul></div><pre class="programlisting language-terminal">$ oc -n openshift-compliance \
annotate compliancesuites/workers-compliancesuite compliance.openshift.io/apply-remediations=</pre></section><section class="section" id="automatically-update-remediations_compliance-advanced"><div class="titlepage"><div><div><h4 class="title">5.5.6.7. Automatically update remediations</h4></div></div></div><p>
						In some cases, a scan with newer content might mark remediations as <code class="literal">OUTDATED</code>. As an administrator, you can apply the <code class="literal">compliance.openshift.io/remove-outdated</code> annotation to apply new remediations and remove the outdated ones.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Apply the <code class="literal">compliance.openshift.io/remove-outdated</code> annotation:
							</li></ul></div><pre class="programlisting language-terminal">$ oc -n openshift-compliance \
annotate compliancesuites/workers-compliancesuite compliance.openshift.io/remove-outdated=</pre><p>
						Alternatively, set the <code class="literal">autoUpdateRemediations</code> flag in a <code class="literal">ScanSetting</code> or <code class="literal">ComplianceSuite</code> object to update the remediations automatically.
					</p></section><section class="section" id="compliance-custom-scc_compliance-advanced"><div class="titlepage"><div><div><h4 class="title">5.5.6.8. Creating a custom SCC for the Compliance Operator</h4></div></div></div><p>
						In some environments, you must create a custom Security Context Constraints (SCC) file to ensure the correct permissions are available to the Compliance Operator <code class="literal">api-resource-collector</code>.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You must have <code class="literal">admin</code> privileges.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Define the SCC in a YAML file named <code class="literal">restricted-adjusted-compliance.yaml</code>:
							</p><div class="formalpara"><p class="title"><strong><code class="literal">SecurityContextConstraints</code> object definition</strong></p><p>
									
<pre class="programlisting language-yaml">  allowHostDirVolumePlugin: false
  allowHostIPC: false
  allowHostNetwork: false
  allowHostPID: false
  allowHostPorts: false
  allowPrivilegeEscalation: true
  allowPrivilegedContainer: false
  allowedCapabilities: null
  apiVersion: security.openshift.io/v1
  defaultAddCapabilities: null
  fsGroup:
    type: MustRunAs
  kind: SecurityContextConstraints
  metadata:
    name: restricted-adjusted-compliance
  priority: 30 <span id="CO40-1"><!--Empty--></span><span class="callout">1</span>
  readOnlyRootFilesystem: false
  requiredDropCapabilities:
  - KILL
  - SETUID
  - SETGID
  - MKNOD
  runAsUser:
    type: MustRunAsRange
  seLinuxContext:
    type: MustRunAs
  supplementalGroups:
    type: RunAsAny
  users:
  - system:serviceaccount:openshift-compliance:api-resource-collector <span id="CO40-2"><!--Empty--></span><span class="callout">2</span>
  volumes:
  - configMap
  - downwardAPI
  - emptyDir
  - persistentVolumeClaim
  - projected
  - secret</pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO40-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										The priority of this SCC must be higher than any other SCC that applies to the <code class="literal">system:authenticated</code> group.
									</div></dd><dt><a href="#CO40-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Service Account used by Compliance Operator Scanner pod.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Create the SCC:
							</p><pre class="programlisting language-terminal">$ oc create -n openshift-compliance  -f restricted-adjusted-compliance.yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">securitycontextconstraints.security.openshift.io/restricted-adjusted-compliance created</pre>

								</p></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Verify the SCC was created:
							</p><pre class="programlisting language-terminal">$ oc get -n openshift-compliance scc restricted-adjusted-compliance</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                             PRIV    CAPS         SELINUX     RUNASUSER        FSGROUP     SUPGROUP   PRIORITY   READONLYROOTFS   VOLUMES
restricted-adjusted-compliance   false   &lt;no value&gt;   MustRunAs   MustRunAsRange   MustRunAs   RunAsAny   30         false            ["configMap","downwardAPI","emptyDir","persistentVolumeClaim","projected","secret"]</pre>

								</p></div></li></ol></div></section><section class="section _additional-resources" id="additional-resources_compliance-operator-advanced"><div class="titlepage"><div><div><h4 class="title">5.5.6.9. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#managing-security-context-constraints">Managing security context constraints</a>
							</li></ul></div></section></section><section class="section" id="compliance-operator-troubleshooting"><div class="titlepage"><div><div><h3 class="title">5.5.7. Troubleshooting the Compliance Operator</h3></div></div></div><p>
					This section describes how to troubleshoot the Compliance Operator. The information can be useful either to diagnose a problem or provide information in a bug report. Some general tips:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							The Compliance Operator emits Kubernetes events when something important happens. You can either view all events in the cluster using the command:
						</p><pre class="programlisting language-terminal"> $ oc get events -n openshift-compliance</pre><p class="simpara">
							Or view events for an object like a scan using the command:
						</p><pre class="programlisting language-terminal">$ oc describe -n openshift-compliance compliancescan/cis-compliance</pre></li><li class="listitem"><p class="simpara">
							The Compliance Operator consists of several controllers, approximately one per API object. It could be useful to filter only those controllers that correspond to the API object having issues. If a <code class="literal">ComplianceRemediation</code> cannot be applied, view the messages from the <code class="literal">remediationctrl</code> controller. You can filter the messages from a single controller by parsing with <code class="literal">jq</code>:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance logs compliance-operator-775d7bddbd-gj58f \
    | jq -c 'select(.logger == "profilebundlectrl")'</pre></li><li class="listitem"><p class="simpara">
							The timestamps are logged as seconds since UNIX epoch in UTC. To convert them to a human-readable date, use <code class="literal">date -d @timestamp --utc</code>, for example:
						</p><pre class="programlisting language-terminal">$ date -d @1596184628.955853 --utc</pre></li><li class="listitem">
							Many custom resources, most importantly <code class="literal">ComplianceSuite</code> and <code class="literal">ScanSetting</code>, allow the <code class="literal">debug</code> option to be set. Enabling this option increases verbosity of the OpenSCAP scanner pods, as well as some other helper pods.
						</li><li class="listitem">
							If a single rule is passing or failing unexpectedly, it could be helpful to run a single scan or a suite with only that rule to find the rule ID from the corresponding <code class="literal">ComplianceCheckResult</code> object and use it as the <code class="literal">rule</code> attribute value in a <code class="literal">Scan</code> CR. Then, together with the <code class="literal">debug</code> option enabled, the <code class="literal">scanner</code> container logs in the scanner pod would show the raw OpenSCAP logs.
						</li></ul></div><section class="section" id="compliance-anatomy_compliance-troubleshooting"><div class="titlepage"><div><div><h4 class="title">5.5.7.1. Anatomy of a scan</h4></div></div></div><p>
						The following sections outline the components and stages of Compliance Operator scans.
					</p><section class="section" id="compliance-anatomy-compliance-sources_compliance-troubleshooting"><div class="titlepage"><div><div><h5 class="title">5.5.7.1.1. Compliance sources</h5></div></div></div><p>
							The compliance content is stored in <code class="literal">Profile</code> objects that are generated from a <code class="literal">ProfileBundle</code> object. The Compliance Operator creates a <code class="literal">ProfileBundle</code> object for the cluster and another for the cluster nodes.
						</p><pre class="programlisting language-terminal">$ oc get -n openshift-compliance profilebundle.compliance</pre><pre class="programlisting language-terminal">$ oc get -n openshift-compliance profile.compliance</pre><p>
							The <code class="literal">ProfileBundle</code> objects are processed by deployments labeled with the <code class="literal">Bundle</code> name. To troubleshoot an issue with the <code class="literal">Bundle</code>, you can find the deployment and view logs of the pods in a deployment:
						</p><pre class="programlisting language-terminal">$ oc logs -n openshift-compliance -lprofile-bundle=ocp4 -c profileparser</pre><pre class="programlisting language-terminal">$ oc get -n openshift-compliance deployments,pods -lprofile-bundle=ocp4</pre><pre class="programlisting language-terminal">$ oc logs -n openshift-compliance pods/&lt;pod-name&gt;</pre><pre class="programlisting language-terminal">$ oc describe -n openshift-compliance pod/&lt;pod-name&gt; -c profileparser</pre></section><section class="section" id="compliance-anatomy-scan-setting-scan-binding-lifecycle_compliance-troubleshooting"><div class="titlepage"><div><div><h5 class="title">5.5.7.1.2. The ScanSetting and ScanSettingBinding objects lifecycle and debugging</h5></div></div></div><p>
							With valid compliance content sources, the high-level <code class="literal">ScanSetting</code> and <code class="literal">ScanSettingBinding</code> objects can be used to generate <code class="literal">ComplianceSuite</code> and <code class="literal">ComplianceScan</code> objects:
						</p><pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ScanSetting
metadata:
  name: my-companys-constraints
debug: true
# For each role, a separate scan will be created pointing
# to a node-role specified in roles
roles:
  - worker
---
apiVersion: compliance.openshift.io/v1alpha1
kind: ScanSettingBinding
metadata:
  name: my-companys-compliance-requirements
profiles:
  # Node checks
  - name: rhcos4-e8
    kind: Profile
    apiGroup: compliance.openshift.io/v1alpha1
  # Cluster checks
  - name: ocp4-e8
    kind: Profile
    apiGroup: compliance.openshift.io/v1alpha1
settingsRef:
  name: my-companys-constraints
  kind: ScanSetting
  apiGroup: compliance.openshift.io/v1alpha1</pre><p>
							Both <code class="literal">ScanSetting</code> and <code class="literal">ScanSettingBinding</code> objects are handled by the same controller tagged with <code class="literal">logger=scansettingbindingctrl</code>. These objects have no status. Any issues are communicated in form of events:
						</p><pre class="programlisting language-terminal">Events:
  Type     Reason        Age    From                    Message
  ----     ------        ----   ----                    -------
  Normal   SuiteCreated  9m52s  scansettingbindingctrl  ComplianceSuite openshift-compliance/my-companys-compliance-requirements created</pre><p>
							Now a <code class="literal">ComplianceSuite</code> object is created. The flow continues to reconcile the newly created <code class="literal">ComplianceSuite</code>.
						</p></section><section class="section" id="compliance-suite-lifecycle-debugging_compliance-troubleshooting"><div class="titlepage"><div><div><h5 class="title">5.5.7.1.3. ComplianceSuite custom resource lifecycle and debugging</h5></div></div></div><p>
							The <code class="literal">ComplianceSuite</code> CR is a wrapper around <code class="literal">ComplianceScan</code> CRs. The <code class="literal">ComplianceSuite</code> CR is handled by controller tagged with <code class="literal">logger=suitectrl</code>. This controller handles creating scans from a suite, reconciling and aggregating individual Scan statuses into a single Suite status. If a suite is set to execute periodically, the <code class="literal">suitectrl</code> also handles creating a <code class="literal">CronJob</code> CR that re-runs the scans in the suite after the initial run is done:
						</p><pre class="programlisting language-terminal">$ oc get cronjobs</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                                           SCHEDULE    SUSPEND   ACTIVE   LAST SCHEDULE   AGE
&lt;cron_name&gt;                                    0 1 * * *   False     0        &lt;none&gt;          151m</pre>

							</p></div><p>
							For the most important issues, events are emitted. View them with <code class="literal">oc describe compliancesuites/&lt;name&gt;</code>. The <code class="literal">Suite</code> objects also have a <code class="literal">Status</code> subresource that is updated when any of <code class="literal">Scan</code> objects that belong to this suite update their <code class="literal">Status</code> subresource. After all expected scans are created, control is passed to the scan controller.
						</p></section><section class="section" id="compliance-scan-lifecycle-debugging_compliance-troubleshooting"><div class="titlepage"><div><div><h5 class="title">5.5.7.1.4. ComplianceScan custom resource lifecycle and debugging</h5></div></div></div><p>
							The <code class="literal">ComplianceScan</code> CRs are handled by the <code class="literal">scanctrl</code> controller. This is also where the actual scans happen and the scan results are created. Each scan goes through several phases:
						</p><section class="section" id="compliance-scan-pending-phase_compliance-troubleshooting"><div class="titlepage"><div><div><h6 class="title">5.5.7.1.4.1. Pending phase</h6></div></div></div><p>
								The scan is validated for correctness in this phase. If some parameters like storage size are invalid, the scan transitions to DONE with ERROR result, otherwise proceeds to the Launching phase.
							</p></section><section class="section" id="compliance-scan-launching-phase_compliance-troubleshooting"><div class="titlepage"><div><div><h6 class="title">5.5.7.1.4.2. Launching phase</h6></div></div></div><p>
								In this phase, several config maps that contain either environment for the scanner pods or directly the script that the scanner pods will be evaluating. List the config maps:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance get cm \
-l compliance.openshift.io/scan-name=rhcos4-e8-worker,complianceoperator.openshift.io/scan-script=</pre><p>
								These config maps will be used by the scanner pods. If you ever needed to modify the scanner behavior, change the scanner debug level or print the raw results, modifying the config maps is the way to go. Afterwards, a persistent volume claim is created per scan to store the raw ARF results:
							</p><pre class="programlisting language-terminal">$ oc get pvc -n openshift-compliance -lcompliance.openshift.io/scan-name=rhcos4-e8-worker</pre><p>
								The PVCs are mounted by a per-scan <code class="literal">ResultServer</code> deployment. A <code class="literal">ResultServer</code> is a simple HTTP server where the individual scanner pods upload the full ARF results to. Each server can run on a different node. The full ARF results might be very large and you cannot presume that it would be possible to create a volume that could be mounted from multiple nodes at the same time. After the scan is finished, the <code class="literal">ResultServer</code> deployment is scaled down. The PVC with the raw results can be mounted from another custom pod and the results can be fetched or inspected. The traffic between the scanner pods and the <code class="literal">ResultServer</code> is protected by mutual TLS protocols.
							</p><p>
								Finally, the scanner pods are launched in this phase; one scanner pod for a <code class="literal">Platform</code> scan instance and one scanner pod per matching node for a <code class="literal">node</code> scan instance. The per-node pods are labeled with the node name. Each pod is always labeled with the <code class="literal">ComplianceScan</code> name:
							</p><pre class="programlisting language-terminal">$ oc get pods -lcompliance.openshift.io/scan-name=rhcos4-e8-worker,workload=scanner --show-labels</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                                              READY   STATUS      RESTARTS   AGE   LABELS
rhcos4-e8-worker-ip-10-0-169-90.eu-north-1.compute.internal-pod   0/2     Completed   0          39m   compliance.openshift.io/scan-name=rhcos4-e8-worker,targetNode=ip-10-0-169-90.eu-north-1.compute.internal,workload=scanner</pre>

								</p></div><p>
								+ The scan then proceeds to the Running phase.
							</p></section><section class="section" id="compliance-scan-running-phase_compliance-troubleshooting"><div class="titlepage"><div><div><h6 class="title">5.5.7.1.4.3. Running phase</h6></div></div></div><p>
								The running phase waits until the scanner pods finish. The following terms and processes are in use in the running phase:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="strong strong"><strong>init container</strong></span>: There is one init container called <code class="literal">content-container</code>. It runs the <span class="strong strong"><strong>contentImage</strong></span> container and executes a single command that copies the <span class="strong strong"><strong>contentFile</strong></span> to the <code class="literal">/content</code> directory shared with the other containers in this pod.
									</li><li class="listitem">
										<span class="strong strong"><strong>scanner</strong></span>: This container runs the scan. For node scans, the container mounts the node filesystem as <code class="literal">/host</code> and mounts the content delivered by the init container. The container also mounts the <code class="literal">entrypoint</code> <code class="literal">ConfigMap</code> created in the Launching phase and executes it. The default script in the entrypoint <code class="literal">ConfigMap</code> executes OpenSCAP and stores the result files in the <code class="literal">/results</code> directory shared between the pod’s containers. Logs from this pod can be viewed to determine what the OpenSCAP scanner checked. More verbose output can be viewed with the <code class="literal">debug</code> flag.
									</li><li class="listitem"><p class="simpara">
										<span class="strong strong"><strong>logcollector</strong></span>: The logcollector container waits until the scanner container finishes. Then, it uploads the full ARF results to the <code class="literal">ResultServer</code> and separately uploads the XCCDF results along with scan result and OpenSCAP result code as a <code class="literal">ConfigMap.</code> These result config maps are labeled with the scan name (<code class="literal">compliance.openshift.io/scan-name=rhcos4-e8-worker</code>):
									</p><pre class="programlisting language-terminal">$ oc describe cm/rhcos4-e8-worker-ip-10-0-169-90.eu-north-1.compute.internal-pod</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-terminal">      Name:         rhcos4-e8-worker-ip-10-0-169-90.eu-north-1.compute.internal-pod
      Namespace:    openshift-compliance
      Labels:       compliance.openshift.io/scan-name-scan=rhcos4-e8-worker
                    complianceoperator.openshift.io/scan-result=
      Annotations:  compliance-remediations/processed:
                    compliance.openshift.io/scan-error-msg:
                    compliance.openshift.io/scan-result: NON-COMPLIANT
                    OpenSCAP-scan-result/node: ip-10-0-169-90.eu-north-1.compute.internal

      Data
      ====
      exit-code:
      ----
      2
      results:
      ----
      &lt;?xml version="1.0" encoding="UTF-8"?&gt;
      ...</pre>

										</p></div></li></ul></div><p>
								Scanner pods for <code class="literal">Platform</code> scans are similar, except:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										There is one extra init container called <code class="literal">api-resource-collector</code> that reads the OpenSCAP content provided by the content-container init, container, figures out which API resources the content needs to examine and stores those API resources to a shared directory where the <code class="literal">scanner</code> container would read them from.
									</li><li class="listitem">
										The <code class="literal">scanner</code> container does not need to mount the host file system.
									</li></ul></div><p>
								When the scanner pods are done, the scans move on to the Aggregating phase.
							</p></section><section class="section" id="compliance-scan-aggregating-phase_compliance-troubleshooting"><div class="titlepage"><div><div><h6 class="title">5.5.7.1.4.4. Aggregating phase</h6></div></div></div><p>
								In the aggregating phase, the scan controller spawns yet another pod called the aggregator pod. Its purpose it to take the result <code class="literal">ConfigMap</code> objects, read the results and for each check result create the corresponding Kubernetes object. If the check failure can be automatically remediated, a <code class="literal">ComplianceRemediation</code> object is created. To provide human-readable metadata for the checks and remediations, the aggregator pod also mounts the OpenSCAP content using an init container.
							</p><p>
								When a config map is processed by an aggregator pod, it is labeled the <code class="literal">compliance-remediations/processed</code> label. The result of this phase are <code class="literal">ComplianceCheckResult</code> objects:
							</p><pre class="programlisting language-terminal">$ oc get compliancecheckresults -lcompliance.openshift.io/scan-name=rhcos4-e8-worker</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                                       STATUS   SEVERITY
rhcos4-e8-worker-accounts-no-uid-except-zero               PASS     high
rhcos4-e8-worker-audit-rules-dac-modification-chmod        FAIL     medium</pre>

								</p></div><p>
								and <code class="literal">ComplianceRemediation</code> objects:
							</p><pre class="programlisting language-terminal">$ oc get complianceremediations -lcompliance.openshift.io/scan-name=rhcos4-e8-worker</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                                       STATE
rhcos4-e8-worker-audit-rules-dac-modification-chmod        NotApplied
rhcos4-e8-worker-audit-rules-dac-modification-chown        NotApplied
rhcos4-e8-worker-audit-rules-execution-chcon               NotApplied
rhcos4-e8-worker-audit-rules-execution-restorecon          NotApplied
rhcos4-e8-worker-audit-rules-execution-semanage            NotApplied
rhcos4-e8-worker-audit-rules-execution-setfiles            NotApplied</pre>

								</p></div><p>
								After these CRs are created, the aggregator pod exits and the scan moves on to the Done phase.
							</p></section><section class="section" id="compliance-scan-done-phase_compliance-troubleshooting"><div class="titlepage"><div><div><h6 class="title">5.5.7.1.4.5. Done phase</h6></div></div></div><p>
								In the final scan phase, the scan resources are cleaned up if needed and the <code class="literal">ResultServer</code> deployment is either scaled down (if the scan was one-time) or deleted if the scan is continuous; the next scan instance would then recreate the deployment again.
							</p><p>
								It is also possible to trigger a re-run of a scan in the Done phase by annotating it:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance \
annotate compliancescans/rhcos4-e8-worker compliance.openshift.io/rescan=</pre><p>
								After the scan reaches the Done phase, nothing else happens on its own unless the remediations are set to be applied automatically with <code class="literal">autoApplyRemediations: true</code>. The OpenShift Container Platform administrator would now review the remediations and apply them as needed. If the remediations are set to be applied automatically, the <code class="literal">ComplianceSuite</code> controller takes over in the Done phase, pauses the machine config pool to which the scan maps to and applies all the remediations in one go. If a remediation is applied, the <code class="literal">ComplianceRemediation</code> controller takes over.
							</p></section></section><section class="section" id="compliance-remediation-lifecycle-debugging_compliance-troubleshooting"><div class="titlepage"><div><div><h5 class="title">5.5.7.1.5. ComplianceRemediation controller lifecycle and debugging</h5></div></div></div><p>
							The example scan has reported some findings. One of the remediations can be enabled by toggling its <code class="literal">apply</code> attribute to <code class="literal">true</code>:
						</p><pre class="programlisting language-terminal">$ oc patch complianceremediations/rhcos4-e8-worker-audit-rules-dac-modification-chmod --patch '{"spec":{"apply":true}}' --type=merge</pre><p>
							The <code class="literal">ComplianceRemediation</code> controller (<code class="literal">logger=remediationctrl</code>) reconciles the modified object. The result of the reconciliation is change of status of the remediation object that is reconciled, but also a change of the rendered per-suite <code class="literal">MachineConfig</code> object that contains all the applied remediations.
						</p><p>
							The <code class="literal">MachineConfig</code> object always begins with <code class="literal">75-</code> and is named after the scan and the suite:
						</p><pre class="programlisting language-terminal">$ oc get mc | grep 75-</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">75-rhcos4-e8-worker-my-companys-compliance-requirements                                                3.2.0             2m46s</pre>

							</p></div><p>
							The remediations the <code class="literal">mc</code> currently consists of are listed in the machine config’s annotations:
						</p><pre class="programlisting language-terminal">$ oc describe mc/75-rhcos4-e8-worker-my-companys-compliance-requirements</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Name:         75-rhcos4-e8-worker-my-companys-compliance-requirements
Labels:       machineconfiguration.openshift.io/role=worker
Annotations:  remediation/rhcos4-e8-worker-audit-rules-dac-modification-chmod:</pre>

							</p></div><p>
							The <code class="literal">ComplianceRemediation</code> controller’s algorithm works like this:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									All currently applied remediations are read into an initial remediation set.
								</li><li class="listitem">
									If the reconciled remediation is supposed to be applied, it is added to the set.
								</li><li class="listitem">
									A <code class="literal">MachineConfig</code> object is rendered from the set and annotated with names of remediations in the set. If the set is empty (the last remediation was unapplied), the rendered <code class="literal">MachineConfig</code> object is removed.
								</li><li class="listitem">
									If and only if the rendered machine config is different from the one already applied in the cluster, the applied MC is updated (or created, or deleted).
								</li><li class="listitem">
									Creating or modifying a <code class="literal">MachineConfig</code> object triggers a reboot of nodes that match the <code class="literal">machineconfiguration.openshift.io/role</code> label - see the Machine Config Operator documentation for more details.
								</li></ul></div><p>
							The remediation loop ends once the rendered machine config is updated, if needed, and the reconciled remediation object status is updated. In our case, applying the remediation would trigger a reboot. After the reboot, annotate the scan to re-run it:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance \
annotate compliancescans/rhcos4-e8-worker compliance.openshift.io/rescan=</pre><p>
							The scan will run and finish. Check for the remediation to pass:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-compliance \
get compliancecheckresults/rhcos4-e8-worker-audit-rules-dac-modification-chmod</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                                                  STATUS   SEVERITY
rhcos4-e8-worker-audit-rules-dac-modification-chmod   PASS     medium</pre>

							</p></div></section><section class="section" id="compliance-operator-useful-labels_compliance-troubleshooting"><div class="titlepage"><div><div><h5 class="title">5.5.7.1.6. Useful labels</h5></div></div></div><p>
							Each pod that is spawned by the Compliance Operator is labeled specifically with the scan it belongs to and the work it does. The scan identifier is labeled with the <code class="literal">compliance.openshift.io/scan-name</code> label. The workload identifier is labeled with the <code class="literal">workload</code> label.
						</p><p>
							The Compliance Operator schedules the following workloads:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>scanner</strong></span>: Performs the compliance scan.
								</li><li class="listitem">
									<span class="strong strong"><strong>resultserver</strong></span>: Stores the raw results for the compliance scan.
								</li><li class="listitem">
									<span class="strong strong"><strong>aggregator</strong></span>: Aggregates the results, detects inconsistencies and outputs result objects (checkresults and remediations).
								</li><li class="listitem">
									<span class="strong strong"><strong>suitererunner</strong></span>: Will tag a suite to be re-run (when a schedule is set).
								</li><li class="listitem">
									<span class="strong strong"><strong>profileparser</strong></span>: Parses a datastream and creates the appropriate profiles, rules and variables.
								</li></ul></div><p>
							When debugging and logs are required for a certain workload, run:
						</p><pre class="programlisting language-terminal">$ oc logs -l workload=&lt;workload_name&gt; -c &lt;container_name&gt;</pre></section></section><section class="section" id="compliance-increasing-operator-limits_compliance-troubleshooting"><div class="titlepage"><div><div><h4 class="title">5.5.7.2. Increasing Compliance Operator resource limits</h4></div></div></div><p>
						In some cases, the Compliance Operator might require more memory than the default limits allow. The best way to mitigate this issue is to set custom resource limits.
					</p><p>
						To increase the default memory and CPU limits of scanner pods, see <span class="emphasis"><em>`ScanSetting` Custom resource</em></span>.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To increase the Operator’s memory limits to 500 Mi, create the following patch file named <code class="literal">co-memlimit-patch.yaml</code>:
							</p><pre class="programlisting language-yaml">spec:
  config:
    resources:
      limits:
        memory: 500Mi</pre></li><li class="listitem"><p class="simpara">
								Apply the patch file:
							</p><pre class="programlisting language-terminal">$ oc patch sub compliance-operator -nopenshift-compliance --patch-file co-memlimit-patch.yaml --type=merge</pre></li></ol></div></section><section class="section" id="operator-resource-constraints_compliance-troubleshooting"><div class="titlepage"><div><div><h4 class="title">5.5.7.3. Configuring Operator resource constraints</h4></div></div></div><p>
						The <code class="literal">resources</code> field defines Resource Constraints for all the containers in the Pod created by the Operator Lifecycle Manager (OLM).
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Resource Constraints applied in this process overwrites the existing resource constraints.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Inject a request of 0.25 cpu and 64 Mi of memory, and a limit of 0.5 cpu and 128 Mi of memory in each container by editing the <code class="literal">Subscription</code> object:
							</p><pre class="programlisting language-yaml">kind: Subscription
metadata:
  name: custom-operator
spec:
  package: etcd
  channel: alpha
  config:
    resources:
      requests:
        memory: "64Mi"
        cpu: "250m"
      limits:
        memory: "128Mi"
        cpu: "500m"</pre></li></ul></div></section><section class="section" id="compliance-timeout_compliance-troubleshooting"><div class="titlepage"><div><div><h4 class="title">5.5.7.4. Configuring ScanSetting timeout</h4></div></div></div><p>
						The <code class="literal">ScanSetting</code> object has a timeout option that can be specified in the <code class="literal">ComplianceScanSetting</code> object as a duration string, such as <code class="literal">1h30m</code>. If the scan does not finish within the specified timeout, the scan reattempts until the <code class="literal">maxRetryOnTimeout</code> limit is reached.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To set a <code class="literal">timeout</code> and <code class="literal">maxRetryOnTimeout</code> in ScanSetting, modify an existing <code class="literal">ScanSetting</code> object:
							</p><pre class="programlisting language-yaml">apiVersion: compliance.openshift.io/v1alpha1
kind: ScanSetting
metadata:
  name: default
  namespace: openshift-compliance
rawResultStorage:
  rotation: 3
  size: 1Gi
roles:
- worker
- master
scanTolerations:
- effect: NoSchedule
  key: node-role.kubernetes.io/master
  operator: Exists
schedule: '0 1 * * *'
timeout: '10m0s' <span id="CO41-1"><!--Empty--></span><span class="callout">1</span>
maxRetryOnTimeout: 3 <span id="CO41-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO41-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										The <code class="literal">timeout</code> variable is defined as a duration string, such as <code class="literal">1h30m</code>. The default value is <code class="literal">30m</code>. To disable the timeout, set the value to <code class="literal">0s</code>.
									</div></dd><dt><a href="#CO41-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										The <code class="literal">maxRetryOnTimeout</code> variable defines how many times a retry is attempted. The default value is <code class="literal">3</code>.
									</div></dd></dl></div></li></ul></div></section><section class="section" id="support_compliance-troubleshooting"><div class="titlepage"><div><div><h4 class="title">5.5.7.5. Getting support</h4></div></div></div><p>
						If you experience difficulty with a procedure described in this documentation, or with OpenShift Container Platform in general, visit the <a class="link" href="http://access.redhat.com">Red Hat Customer Portal</a>. From the Customer Portal, you can:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Search or browse through the Red Hat Knowledgebase of articles and solutions relating to Red Hat products.
							</li><li class="listitem">
								Submit a support case to Red Hat Support.
							</li><li class="listitem">
								Access other product documentation.
							</li></ul></div><p>
						To identify issues with your cluster, you can use Insights in <a class="link" href="https://console.redhat.com/openshift">OpenShift Cluster Manager Hybrid Cloud Console</a>. Insights provides details about issues and, if available, information on how to solve a problem.
					</p><p>
						If you have a suggestion for improving this documentation or have found an error, submit a <a class="link" href="https://issues.redhat.com/secure/CreateIssueDetails!init.jspa?pid=12332330&amp;summary=Documentation_issue&amp;issuetype=1&amp;components=12367614&amp;priority=10200&amp;versions=12391126">Jira issue</a> for the most relevant documentation component. Please provide specific details, such as the section name and OpenShift Container Platform version.
					</p></section></section><section class="section" id="using-oc-compliance-plug-in"><div class="titlepage"><div><div><h3 class="title">5.5.8. Using the oc-compliance plugin</h3></div></div></div><p>
					Although the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#understanding-compliance-operator">Compliance Operator</a> automates many of the checks and remediations for the cluster, the full process of bringing a cluster into compliance often requires administrator interaction with the Compliance Operator API and other components. The <code class="literal">oc-compliance</code> plugin makes the process easier.
				</p><section class="section" id="installing-oc-compliance_oc-compliance-plug-in-understanding"><div class="titlepage"><div><div><h4 class="title">5.5.8.1. Installing the oc-compliance plugin</h4></div></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Extract the <code class="literal">oc-compliance</code> image to get the <code class="literal">oc-compliance</code> binary:
							</p><pre class="programlisting language-terminal">$ podman run --rm -v ~/.local/bin:/mnt/out:Z registry.redhat.io/compliance/oc-compliance-rhel8:stable /bin/cp /usr/bin/oc-compliance /mnt/out/</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">W0611 20:35:46.486903   11354 manifest.go:440] Chose linux/amd64 manifest from the manifest list.</pre>

								</p></div><p class="simpara">
								You can now run <code class="literal">oc-compliance</code>.
							</p></li></ol></div></section><section class="section" id="fetching-raw-results_oc-compliance-plug-in-understanding"><div class="titlepage"><div><div><h4 class="title">5.5.8.2. Fetching raw results</h4></div></div></div><p>
						When a compliance scan finishes, the results of the individual checks are listed in the resulting <code class="literal">ComplianceCheckResult</code> custom resource (CR). However, an administrator or auditor might require the complete details of the scan. The OpenSCAP tool creates an Advanced Recording Format (ARF) formatted file with the detailed results. This ARF file is too large to store in a config map or other standard Kubernetes resource, so a persistent volume (PV) is created to contain it.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Fetching the results from the PV with the Compliance Operator is a four-step process. However, with the <code class="literal">oc-compliance</code> plugin, you can use a single command:
							</p><pre class="programlisting language-terminal">$ oc compliance fetch-raw &lt;object-type&gt; &lt;object-name&gt; -o &lt;output-path&gt;</pre></li><li class="listitem">
								<code class="literal">&lt;object-type&gt;</code> can be either <code class="literal">scansettingbinding</code>, <code class="literal">compliancescan</code> or <code class="literal">compliancesuite</code>, depending on which of these objects the scans were launched with.
							</li><li class="listitem"><p class="simpara">
								<code class="literal">&lt;object-name&gt;</code> is the name of the binding, suite, or scan object to gather the ARF file for, and <code class="literal">&lt;output-path&gt;</code> is the local directory to place the results.
							</p><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc compliance fetch-raw scansettingbindings my-binding -o /tmp/</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">Fetching results for my-binding scans: ocp4-cis, ocp4-cis-node-worker, ocp4-cis-node-master
Fetching raw compliance results for scan 'ocp4-cis'.......
The raw compliance results are available in the following directory: /tmp/ocp4-cis
Fetching raw compliance results for scan 'ocp4-cis-node-worker'...........
The raw compliance results are available in the following directory: /tmp/ocp4-cis-node-worker
Fetching raw compliance results for scan 'ocp4-cis-node-master'......
The raw compliance results are available in the following directory: /tmp/ocp4-cis-node-master</pre>

								</p></div></li></ul></div><p>
						View the list of files in the directory:
					</p><pre class="programlisting language-terminal">$ ls /tmp/ocp4-cis-node-master/</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">ocp4-cis-node-master-ip-10-0-128-89.ec2.internal-pod.xml.bzip2  ocp4-cis-node-master-ip-10-0-150-5.ec2.internal-pod.xml.bzip2  ocp4-cis-node-master-ip-10-0-163-32.ec2.internal-pod.xml.bzip2</pre>

						</p></div><p>
						Extract the results:
					</p><pre class="programlisting language-terminal">$ bunzip2 -c resultsdir/worker-scan/worker-scan-stage-459-tqkg7-compute-0-pod.xml.bzip2 &gt; resultsdir/worker-scan/worker-scan-ip-10-0-170-231.us-east-2.compute.internal-pod.xml</pre><p>
						View the results:
					</p><pre class="programlisting language-terminal">$ ls resultsdir/worker-scan/</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">worker-scan-ip-10-0-170-231.us-east-2.compute.internal-pod.xml
worker-scan-stage-459-tqkg7-compute-0-pod.xml.bzip2
worker-scan-stage-459-tqkg7-compute-1-pod.xml.bzip2</pre>

						</p></div></section><section class="section" id="re-running-scans_oc-compliance-plug-in-understanding"><div class="titlepage"><div><div><h4 class="title">5.5.8.3. Re-running scans</h4></div></div></div><p>
						Although it is possible to run scans as scheduled jobs, you must often re-run a scan on demand, particularly after remediations are applied or when other changes to the cluster are made.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Rerunning a scan with the Compliance Operator requires use of an annotation on the scan object. However, with the <code class="literal">oc-compliance</code> plugin you can rerun a scan with a single command. Enter the following command to rerun the scans for the <code class="literal">ScanSettingBinding</code> object named <code class="literal">my-binding</code>:
							</p><pre class="programlisting language-terminal">$ oc compliance rerun-now scansettingbindings my-binding</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">Rerunning scans from 'my-binding': ocp4-cis
Re-running scan 'openshift-compliance/ocp4-cis'</pre>

								</p></div></li></ul></div></section><section class="section" id="using-scan-setting-bindings_oc-compliance-plug-in-understanding"><div class="titlepage"><div><div><h4 class="title">5.5.8.4. Using ScanSettingBinding custom resources</h4></div></div></div><p>
						When using the <code class="literal">ScanSetting</code> and <code class="literal">ScanSettingBinding</code> custom resources (CRs) that the Compliance Operator provides, it is possible to run scans for multiple profiles while using a common set of scan options, such as <code class="literal">schedule</code>, <code class="literal">machine roles</code>, <code class="literal">tolerations</code>, and so on. While that is easier than working with multiple <code class="literal">ComplianceSuite</code> or <code class="literal">ComplianceScan</code> objects, it can confuse new users.
					</p><p>
						The <code class="literal">oc compliance bind</code> subcommand helps you create a <code class="literal">ScanSettingBinding</code> CR.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Run:
							</p><pre class="programlisting language-terminal">$ oc compliance bind [--dry-run] -N &lt;binding name&gt; [-S &lt;scansetting name&gt;] &lt;objtype/objname&gt; [..&lt;objtype/objname&gt;]</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										If you omit the <code class="literal">-S</code> flag, the <code class="literal">default</code> scan setting provided by the Compliance Operator is used.
									</li><li class="listitem">
										The object type is the Kubernetes object type, which can be <code class="literal">profile</code> or <code class="literal">tailoredprofile</code>. More than one object can be provided.
									</li><li class="listitem">
										The object name is the name of the Kubernetes resource, such as <code class="literal">.metadata.name</code>.
									</li><li class="listitem"><p class="simpara">
										Add the <code class="literal">--dry-run</code> option to display the YAML file of the objects that are created.
									</p><p class="simpara">
										For example, given the following profiles and scan settings:
									</p><pre class="programlisting language-terminal">$ oc get profile.compliance -n openshift-compliance</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-terminal">NAME              AGE
ocp4-cis          9m54s
ocp4-cis-node     9m54s
ocp4-e8           9m54s
ocp4-moderate     9m54s
ocp4-ncp          9m54s
rhcos4-e8         9m54s
rhcos4-moderate   9m54s
rhcos4-ncp        9m54s
rhcos4-ospp       9m54s
rhcos4-stig       9m54s</pre>

										</p></div><pre class="programlisting language-terminal">$ oc get scansettings -n openshift-compliance</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-terminal">NAME                 AGE
default              10m
default-auto-apply   10m</pre>

										</p></div></li></ul></div></li><li class="listitem"><p class="simpara">
								To apply the <code class="literal">default</code> settings to the <code class="literal">ocp4-cis</code> and <code class="literal">ocp4-cis-node</code> profiles, run:
							</p><pre class="programlisting language-terminal">$ oc compliance bind -N my-binding profile/ocp4-cis profile/ocp4-cis-node</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">Creating ScanSettingBinding my-binding</pre>

								</p></div><p class="simpara">
								Once the <code class="literal">ScanSettingBinding</code> CR is created, the bound profile begins scanning for both profiles with the related settings. Overall, this is the fastest way to begin scanning with the Compliance Operator.
							</p></li></ol></div></section><section class="section" id="printing-controls_oc-compliance-plug-in-understanding"><div class="titlepage"><div><div><h4 class="title">5.5.8.5. Printing controls</h4></div></div></div><p>
						Compliance standards are generally organized into a hierarchy as follows:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A benchmark is the top-level definition of a set of controls for a particular standard. For example, FedRAMP Moderate or Center for Internet Security (CIS) v.1.6.0.
							</li><li class="listitem">
								A control describes a family of requirements that must be met in order to be in compliance with the benchmark. For example, FedRAMP AC-01 (access control policy and procedures).
							</li><li class="listitem">
								A rule is a single check that is specific for the system being brought into compliance, and one or more of these rules map to a control.
							</li><li class="listitem">
								The Compliance Operator handles the grouping of rules into a profile for a single benchmark. It can be difficult to determine which controls that the set of rules in a profile satisfy.
							</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								The <code class="literal">oc compliance</code> <code class="literal">controls</code> subcommand provides a report of the standards and controls that a given profile satisfies:
							</p><pre class="programlisting language-terminal">$ oc compliance controls profile ocp4-cis-node</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">+-----------+----------+
| FRAMEWORK | CONTROLS |
+-----------+----------+
| CIS-OCP   | 1.1.1    |
+           +----------+
|           | 1.1.10   |
+           +----------+
|           | 1.1.11   |
+           +----------+
...</pre>

								</p></div></li></ul></div></section><section class="section" id="fetching-compliance-remediation-details_oc-compliance-plug-in-understanding"><div class="titlepage"><div><div><h4 class="title">5.5.8.6. Fetching compliance remediation details</h4></div></div></div><p>
						The Compliance Operator provides remediation objects that are used to automate the changes required to make the cluster compliant. The <code class="literal">fetch-fixes</code> subcommand can help you understand exactly which configuration remediations are used. Use the <code class="literal">fetch-fixes</code> subcommand to extract the remediation objects from a profile, rule, or <code class="literal">ComplianceRemediation</code> object into a directory to inspect.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								View the remediations for a profile:
							</p><pre class="programlisting language-terminal">$ oc compliance fetch-fixes profile ocp4-cis -o /tmp</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">No fixes to persist for rule 'ocp4-api-server-api-priority-flowschema-catch-all' <span id="CO42-1"><!--Empty--></span><span class="callout">1</span>
No fixes to persist for rule 'ocp4-api-server-api-priority-gate-enabled'
No fixes to persist for rule 'ocp4-api-server-audit-log-maxbackup'
Persisted rule fix to /tmp/ocp4-api-server-audit-log-maxsize.yaml
No fixes to persist for rule 'ocp4-api-server-audit-log-path'
No fixes to persist for rule 'ocp4-api-server-auth-mode-no-aa'
No fixes to persist for rule 'ocp4-api-server-auth-mode-node'
No fixes to persist for rule 'ocp4-api-server-auth-mode-rbac'
No fixes to persist for rule 'ocp4-api-server-basic-auth'
No fixes to persist for rule 'ocp4-api-server-bind-address'
No fixes to persist for rule 'ocp4-api-server-client-ca'
Persisted rule fix to /tmp/ocp4-api-server-encryption-provider-cipher.yaml
Persisted rule fix to /tmp/ocp4-api-server-encryption-provider-config.yaml</pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO42-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										The <code class="literal">No fixes to persist</code> warning is expected whenever there are rules in a profile that do not have a corresponding remediation, because either the rule cannot be remediated automatically or a remediation was not provided.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								You can view a sample of the YAML file. The <code class="literal">head</code> command will show you the first 10 lines:
							</p><pre class="programlisting language-terminal">$ head /tmp/ocp4-api-server-audit-log-maxsize.yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">apiVersion: config.openshift.io/v1
kind: APIServer
metadata:
  name: cluster
spec:
  maximumFileSizeMegabytes: 100</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								View the remediation from a <code class="literal">ComplianceRemediation</code> object created after a scan:
							</p><pre class="programlisting language-terminal">$ oc get complianceremediations -n openshift-compliance</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                             STATE
ocp4-cis-api-server-encryption-provider-cipher   NotApplied
ocp4-cis-api-server-encryption-provider-config   NotApplied</pre>

								</p></div><pre class="programlisting language-terminal">$ oc compliance fetch-fixes complianceremediations ocp4-cis-api-server-encryption-provider-cipher -o /tmp</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">Persisted compliance remediation fix to /tmp/ocp4-cis-api-server-encryption-provider-cipher.yaml</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								You can view a sample of the YAML file. The <code class="literal">head</code> command will show you the first 10 lines:
							</p><pre class="programlisting language-terminal">$ head /tmp/ocp4-cis-api-server-encryption-provider-cipher.yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">apiVersion: config.openshift.io/v1
kind: APIServer
metadata:
  name: cluster
spec:
  encryption:
    type: aescbc</pre>

								</p></div></li></ol></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							Use caution before applying remediations directly. Some remediations might not be applicable in bulk, such as the usbguard rules in the moderate profile. In these cases, allow the Compliance Operator to apply the rules because it addresses the dependencies and ensures that the cluster remains in a good state.
						</p></div></div></section><section class="section" id="viewing-compliance-remediation-details_oc-compliance-plug-in-understanding"><div class="titlepage"><div><div><h4 class="title">5.5.8.7. Viewing ComplianceCheckResult object details</h4></div></div></div><p>
						When scans are finished running, <code class="literal">ComplianceCheckResult</code> objects are created for the individual scan rules. The <code class="literal">view-result</code> subcommand provides a human-readable output of the <code class="literal">ComplianceCheckResult</code> object details.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Run:
							</p><pre class="programlisting language-terminal">$ oc compliance view-result ocp4-cis-scheduler-no-bind-address</pre></li></ul></div></section></section></section></section><section class="chapter" id="file-integrity-operator"><div class="titlepage"><div><div><h1 class="title">Chapter 6. File Integrity Operator</h1></div></div></div><section class="section" id="file-integrity-operator-release-notes"><div class="titlepage"><div><div><h2 class="title">6.1. File Integrity Operator release notes</h2></div></div></div><p>
				The File Integrity Operator for OpenShift Container Platform continually runs file integrity checks on RHCOS nodes.
			</p><p>
				These release notes track the development of the File Integrity Operator in the OpenShift Container Platform.
			</p><p>
				For an overview of the File Integrity Operator, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#understanding-file-integrity-operator">Understanding the File Integrity Operator</a>.
			</p><p>
				To access the latest release, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#olm-preparing-upgrade_file-integrity-operator-updating">Updating the File Integrity Operator</a>.
			</p><section class="section" id="file-integrity-operator-release-notes-1-3-2"><div class="titlepage"><div><div><h3 class="title">6.1.1. OpenShift File Integrity Operator 1.3.2</h3></div></div></div><p>
					The following advisory is available for the OpenShift File Integrity Operator 1.3.2:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2023:5107">RHBA-2023:5107 OpenShift File Integrity Operator Bug Fix Update</a>
						</li></ul></div><p>
					This update addresses a CVE in an underlying dependency.
				</p></section><section class="section" id="file-integrity-operator-release-notes-1-3-1"><div class="titlepage"><div><div><h3 class="title">6.1.2. OpenShift File Integrity Operator 1.3.1</h3></div></div></div><p>
					The following advisory is available for the OpenShift File Integrity Operator 1.3.1:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2023:3600">RHBA-2023:3600 OpenShift File Integrity Operator Bug Fix Update</a>
						</li></ul></div><section class="section" id="file-integrity-operator-1-3-1-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">6.1.2.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								FIO now includes kubelet certificates as default files, excluding them from issuing warnings when they’re managed by OpenShift Container Platform. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-14348"><span class="strong strong"><strong>OCPBUGS-14348</strong></span></a>)
							</li><li class="listitem">
								FIO now correctly directs email to the address for Red Hat Technical Support. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-5023"><span class="strong strong"><strong>OCPBUGS-5023</strong></span></a>)
							</li></ul></div></section><section class="section" id="file-integrity-operator-1-3-1-bug-fixes"><div class="titlepage"><div><div><h4 class="title">6.1.2.2. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, FIO would not clean up <code class="literal">FileIntegrityNodeStatus</code> CRDs when nodes are removed from the cluster. FIO has been updated to correctly clean up node status CRDs on node removal. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-4321"><span class="strong strong"><strong>OCPBUGS-4321</strong></span></a>)
							</li><li class="listitem">
								Previously, FIO would also erroneously indicate that new nodes failed integrity checks. FIO has been updated to correctly show node status CRDs when adding new nodes to the cluster. This provides correct node status notifications. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-8502"><span class="strong strong"><strong>OCPBUGS-8502</strong></span></a>)
							</li><li class="listitem">
								Previously, when FIO was reconciling <code class="literal">FileIntegrity</code> CRDs, it would pause scanning until the reconciliation was done. This caused an overly aggressive re-initiatization process on nodes not impacted by the reconciliation. This problem also resulted in unnecessary daemonsets for machine config pools which are unrelated to the <code class="literal">FileIntegrity</code> being changed. FIO correctly handles these cases and only pauses AIDE scanning for nodes that are affected by file integrity changes. (<a class="link" href="https://issues.redhat.com/browse/CMP-1097"><span class="strong strong"><strong>CMP-1097</strong></span></a>)
							</li></ul></div></section><section class="section" id="file-integrity-operator-1-3-1-known-issues"><div class="titlepage"><div><div><h4 class="title">6.1.2.3. Known Issues</h4></div></div></div><p>
						In FIO 1.3.1, increasing nodes in IBM Z clusters might result in <code class="literal">Failed</code> File Integrity node status. For more information, see <a class="link" href="https://access.redhat.com/solutions/7028861">Adding nodes in IBM Power clusters can result in failed File Integrity node status</a>.
					</p></section></section><section class="section" id="file-integrity-operator-release-notes-1-2-1"><div class="titlepage"><div><div><h3 class="title">6.1.3. OpenShift File Integrity Operator 1.2.1</h3></div></div></div><p>
					The following advisory is available for the OpenShift File Integrity Operator 1.2.1:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2023:1684">RHBA-2023:1684 OpenShift File Integrity Operator Bug Fix Update</a>
						</li><li class="listitem">
							This release includes updated container dependencies.
						</li></ul></div></section><section class="section" id="file-integrity-operator-release-notes-1-2-0"><div class="titlepage"><div><div><h3 class="title">6.1.4. OpenShift File Integrity Operator 1.2.0</h3></div></div></div><p>
					The following advisory is available for the OpenShift File Integrity Operator 1.2.0:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2023:1273">RHBA-2023:1273 OpenShift File Integrity Operator Enhancement Update</a>
						</li></ul></div><section class="section" id="file-integrity-operator-1-2-0-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">6.1.4.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The File Integrity Operator Custom Resource (CR) now contains an <code class="literal">initialDelay</code> feature that specifies the number of seconds to wait before starting the first AIDE integrity check. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#understanding-file-integrity-custom-resource_file-integrity-operator">Creating the FileIntegrity custom resource</a>.
							</li><li class="listitem">
								The File Integrity Operator is now stable and the release channel is upgraded to <code class="literal">stable</code>. Future releases will follow <a class="link" href="https://semver.org/">Semantic Versioning</a>. To access the latest release, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#olm-preparing-upgrade_file-integrity-operator-updating">Updating the File Integrity Operator</a>.
							</li></ul></div></section></section><section class="section" id="file-integrity-operator-release-notes-1-0-0"><div class="titlepage"><div><div><h3 class="title">6.1.5. OpenShift File Integrity Operator 1.0.0</h3></div></div></div><p>
					The following advisory is available for the OpenShift File Integrity Operator 1.0.0:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2023:0037">RHBA-2023:0037 OpenShift File Integrity Operator Bug Fix Update</a>
						</li></ul></div></section><section class="section" id="file-integrity-operator-release-notes-0-1-32"><div class="titlepage"><div><div><h3 class="title">6.1.6. OpenShift File Integrity Operator 0.1.32</h3></div></div></div><p>
					The following advisory is available for the OpenShift File Integrity Operator 0.1.32:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2022:7095">RHBA-2022:7095 OpenShift File Integrity Operator Bug Fix Update</a>
						</li></ul></div><section class="section" id="file-integrity-operator-0-1-32-bug-fixes"><div class="titlepage"><div><div><h4 class="title">6.1.6.1. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, alerts issued by the File Integrity Operator did not set a namespace, making it difficult to understand from which namespace the alert originated. Now, the Operator sets the appropriate namespace, providing more information about the alert. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2112394"><span class="strong strong"><strong>BZ#2112394</strong></span></a>)
							</li><li class="listitem">
								Previously, The File Integrity Operator did not update the metrics service on Operator startup, causing the metrics targets to be unreachable. With this release, the File Integrity Operator now ensures the metrics service is updated on Operator startup. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2115821"><span class="strong strong"><strong>BZ#2115821</strong></span></a>)
							</li></ul></div></section></section><section class="section" id="file-integrity-operator-release-notes-0-1-30"><div class="titlepage"><div><div><h3 class="title">6.1.7. OpenShift File Integrity Operator 0.1.30</h3></div></div></div><p>
					The following advisory is available for the OpenShift File Integrity Operator 0.1.30:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2022:5538">RHBA-2022:5538 OpenShift File Integrity Operator Bug Fix and Enhancement Update</a>
						</li></ul></div><section class="section" id="file-integrity-operator-0-1-30-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">6.1.7.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								The File Integrity Operator is now supported on the following architectures:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										IBM Power
									</li><li class="listitem">
										IBM Z and LinuxONE
									</li></ul></div></li></ul></div></section><section class="section" id="file-integrity-operator-0-1-30-bug-fixes"><div class="titlepage"><div><div><h4 class="title">6.1.7.2. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, alerts issued by the File Integrity Operator did not set a namespace, making it difficult to understand where the alert originated. Now, the Operator sets the appropriate namespace, increasing understanding of the alert. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2101393"><span class="strong strong"><strong>BZ#2101393</strong></span></a>)
							</li></ul></div></section></section><section class="section" id="file-integrity-operator-release-notes-0-1-24"><div class="titlepage"><div><div><h3 class="title">6.1.8. OpenShift File Integrity Operator 0.1.24</h3></div></div></div><p>
					The following advisory is available for the OpenShift File Integrity Operator 0.1.24:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2022:1331">RHBA-2022:1331 OpenShift File Integrity Operator Bug Fix</a>
						</li></ul></div><section class="section" id="file-integrity-operator-0-1-24-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">6.1.8.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								You can now configure the maximum number of backups stored in the <code class="literal">FileIntegrity</code> Custom Resource (CR) with the <code class="literal">config.maxBackups</code> attribute. This attribute specifies the number of AIDE database and log backups left over from the <code class="literal">re-init</code> process to keep on the node. Older backups beyond the configured number are automatically pruned. The default is set to five backups.
							</li></ul></div></section><section class="section" id="openshift-file-integrity-operator-0-1-24-bug-fixes"><div class="titlepage"><div><div><h4 class="title">6.1.8.2. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, upgrading the Operator from versions older than 0.1.21 to 0.1.22 could cause the <code class="literal">re-init</code> feature to fail. This was a result of the Operator failing to update <code class="literal">configMap</code> resource labels. Now, upgrading to the latest version fixes the resource labels. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2049206"><span class="strong strong"><strong>BZ#2049206</strong></span></a>)
							</li><li class="listitem">
								Previously, when enforcing the default <code class="literal">configMap</code> script contents, the wrong data keys were compared. This resulted in the <code class="literal">aide-reinit</code> script not being updated properly after an Operator upgrade, and caused the <code class="literal">re-init</code> process to fail. Now,<code class="literal">daemonSets</code> run to completion and the AIDE database <code class="literal">re-init</code> process executes successfully. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2072058"><span class="strong strong"><strong>BZ#2072058</strong></span></a>)
							</li></ul></div></section></section><section class="section" id="file-integrity-operator-release-notes-0-1-22"><div class="titlepage"><div><div><h3 class="title">6.1.9. OpenShift File Integrity Operator 0.1.22</h3></div></div></div><p>
					The following advisory is available for the OpenShift File Integrity Operator 0.1.22:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2022:0142">RHBA-2022:0142 OpenShift File Integrity Operator Bug Fix</a>
						</li></ul></div><section class="section" id="openshift-file-integrity-operator-0-1-22-bug-fixes"><div class="titlepage"><div><div><h4 class="title">6.1.9.1. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, a system with a File Integrity Operator installed might interrupt the OpenShift Container Platform update, due to the <code class="literal">/etc/kubernetes/aide.reinit</code> file. This occurred if the <code class="literal">/etc/kubernetes/aide.reinit</code> file was present, but later removed prior to the <code class="literal">ostree</code> validation. With this update, <code class="literal">/etc/kubernetes/aide.reinit</code> is moved to the <code class="literal">/run</code> directory so that it does not conflict with the OpenShift Container Platform update. (<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2033311"><span class="strong strong"><strong>BZ#2033311</strong></span></a>)
							</li></ul></div></section></section><section class="section" id="file-integrity-operator-release-notes-0-1-21"><div class="titlepage"><div><div><h3 class="title">6.1.10. OpenShift File Integrity Operator 0.1.21</h3></div></div></div><p>
					The following advisory is available for the OpenShift File Integrity Operator 0.1.21:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2021:4631">RHBA-2021:4631 OpenShift File Integrity Operator Bug Fix and Enhancement Update</a>
						</li></ul></div><section class="section" id="file-integrity-operator-0-1-21-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">6.1.10.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The metrics related to <code class="literal">FileIntegrity</code> scan results and processing metrics are displayed on the monitoring dashboard on the web console. The results are labeled with the prefix of <code class="literal">file_integrity_operator_</code>.
							</li><li class="listitem">
								If a node has an integrity failure for more than 1 second, the default <code class="literal">PrometheusRule</code> provided in the operator namespace alerts with a warning.
							</li><li class="listitem"><p class="simpara">
								The following dynamic Machine Config Operator and Cluster Version Operator related filepaths are excluded from the default AIDE policy to help prevent false positives during node updates:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										/etc/machine-config-daemon/currentconfig
									</li><li class="listitem">
										/etc/pki/ca-trust/extracted/java/cacerts
									</li><li class="listitem">
										/etc/cvo/updatepayloads
									</li><li class="listitem">
										/root/.kube
									</li></ul></div></li><li class="listitem">
								The AIDE daemon process has stability improvements over v0.1.16, and is more resilient to errors that might occur when the AIDE database is initialized.
							</li></ul></div></section><section class="section" id="openshift-file-integrity-operator-0-1-21-bug-fixes"><div class="titlepage"><div><div><h4 class="title">6.1.10.2. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, when the Operator automatically upgraded, outdated daemon sets were not removed. With this release, outdated daemon sets are removed during the automatic upgrade.
							</li></ul></div></section></section><section class="section _additional-resources" id="file-integrity-operator-release-notes_additional-resources"><div class="titlepage"><div><div><h3 class="title">6.1.11. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#understanding-file-integrity-operator">Understanding the File Integrity Operator</a>
						</li></ul></div></section></section><section class="section" id="installing-file-integrity-operator"><div class="titlepage"><div><div><h2 class="title">6.2. Installing the File Integrity Operator</h2></div></div></div><section class="section" id="installing-file-integrity-operator-using-web-console_file-integrity-operator-installation"><div class="titlepage"><div><div><h3 class="title">6.2.1. Installing the File Integrity Operator using the web console</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You must have <code class="literal">admin</code> privileges.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the OpenShift Container Platform web console, navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span>.
						</li><li class="listitem">
							Search for the File Integrity Operator, then click <span class="strong strong"><strong>Install</strong></span>.
						</li><li class="listitem">
							Keep the default selection of <span class="strong strong"><strong>Installation mode</strong></span> and <span class="strong strong"><strong>namespace</strong></span> to ensure that the Operator will be installed to the <code class="literal">openshift-file-integrity</code> namespace.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Install</strong></span>.
						</li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
						To confirm that the installation is successful:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> page.
						</li><li class="listitem">
							Check that the Operator is installed in the <code class="literal">openshift-file-integrity</code> namespace and its status is <code class="literal">Succeeded</code>.
						</li></ol></div><p>
					If the Operator is not installed successfully:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> page and inspect the <code class="literal">Status</code> column for any errors or failures.
						</li><li class="listitem">
							Navigate to the <span class="strong strong"><strong>Workloads</strong></span> → <span class="strong strong"><strong>Pods</strong></span> page and check the logs in any pods in the <code class="literal">openshift-file-integrity</code> project that are reporting issues.
						</li></ol></div></section><section class="section" id="installing-file-integrity-operator-using-cli_file-integrity-operator-installation"><div class="titlepage"><div><div><h3 class="title">6.2.2. Installing the File Integrity Operator using the CLI</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You must have <code class="literal">admin</code> privileges.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a <code class="literal">Namespace</code> object YAML file by running:
						</p><pre class="programlisting language-terminal">$ oc create -f &lt;file-name&gt;.yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: v1
kind: Namespace
metadata:
  labels:
    openshift.io/cluster-monitoring: "true"
    pod-security.kubernetes.io/enforce: privileged <span id="CO43-1"><!--Empty--></span><span class="callout">1</span>
  name: openshift-file-integrity</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO43-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									In OpenShift Container Platform 4.13, the pod security label must be set to <code class="literal">privileged</code> at the namespace level.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">OperatorGroup</code> object YAML file:
						</p><pre class="programlisting language-terminal">$ oc create -f &lt;file-name&gt;.yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: file-integrity-operator
  namespace: openshift-file-integrity
spec:
  targetNamespaces:
  - openshift-file-integrity</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">Subscription</code> object YAML file:
						</p><pre class="programlisting language-terminal">$ oc create -f &lt;file-name&gt;.yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: file-integrity-operator
  namespace: openshift-file-integrity
spec:
  channel: "stable"
  installPlanApproval: Automatic
  name: file-integrity-operator
  source: redhat-operators
  sourceNamespace: openshift-marketplace</pre>

							</p></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Verify the installation succeeded by inspecting the CSV file:
						</p><pre class="programlisting language-terminal">$ oc get csv -n openshift-file-integrity</pre></li><li class="listitem"><p class="simpara">
							Verify that the File Integrity Operator is up and running:
						</p><pre class="programlisting language-terminal">$ oc get deploy -n openshift-file-integrity</pre></li></ol></div></section><section class="section _additional-resources" id="additional-resources-installing-the-file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.2.3. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The File Integrity Operator is supported in a restricted network environment. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-restricted-networks">Using Operator Lifecycle Manager on restricted networks</a>.
						</li></ul></div></section></section><section class="section" id="file-integrity-operator-updating"><div class="titlepage"><div><div><h2 class="title">6.3. Updating the File Integrity Operator</h2></div></div></div><p>
				As a cluster administrator, you can update the File Integrity Operator on your OpenShift Container Platform cluster.
			</p><section class="section" id="olm-preparing-upgrade_file-integrity-operator-updating"><div class="titlepage"><div><div><h3 class="title">6.3.1. Preparing for an Operator update</h3></div></div></div><p>
					The subscription of an installed Operator specifies an update channel that tracks and receives updates for the Operator. You can change the update channel to start tracking and receiving updates from a newer channel.
				</p><p>
					The names of update channels in a subscription can differ between Operators, but the naming scheme typically follows a common convention within a given Operator. For example, channel names might follow a minor release update stream for the application provided by the Operator (<code class="literal">1.2</code>, <code class="literal">1.3</code>) or a release frequency (<code class="literal">stable</code>, <code class="literal">fast</code>).
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						You cannot change installed Operators to a channel that is older than the current channel.
					</p></div></div><p>
					Red Hat Customer Portal Labs include the following application that helps administrators prepare to update their Operators:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/labs/ocpouic/">Red Hat OpenShift Container Platform Operator Update Information Checker</a>
						</li></ul></div><p>
					You can use the application to search for Operator Lifecycle Manager-based Operators and verify the available Operator version per update channel across different versions of OpenShift Container Platform. Cluster Version Operator-based Operators are not included.
				</p></section><section class="section" id="olm-changing-update-channel_file-integrity-operator-updating"><div class="titlepage"><div><div><h3 class="title">6.3.2. Changing the update channel for an Operator</h3></div></div></div><p>
					You can change the update channel for an Operator by using the OpenShift Container Platform web console.
				</p><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
					If the approval strategy in the subscription is set to <span class="strong strong"><strong>Automatic</strong></span>, the update process initiates as soon as a new Operator version is available in the selected channel. If the approval strategy is set to <span class="strong strong"><strong>Manual</strong></span>, you must manually approve pending updates.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							An Operator previously installed using Operator Lifecycle Manager (OLM).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the <span class="strong strong"><strong>Administrator</strong></span> perspective of the web console, navigate to <span class="strong strong"><strong>Operators → Installed Operators</strong></span>.
						</li><li class="listitem">
							Click the name of the Operator you want to change the update channel for.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Subscription</strong></span> tab.
						</li><li class="listitem">
							Click the name of the update channel under <span class="strong strong"><strong>Update channel</strong></span>.
						</li><li class="listitem">
							Click the newer update channel that you want to change to, then click <span class="strong strong"><strong>Save</strong></span>.
						</li><li class="listitem"><p class="simpara">
							For subscriptions with an <span class="strong strong"><strong>Automatic</strong></span> approval strategy, the update begins automatically. Navigate back to the <span class="strong strong"><strong>Operators → Installed Operators</strong></span> page to monitor the progress of the update. When complete, the status changes to <span class="strong strong"><strong>Succeeded</strong></span> and <span class="strong strong"><strong>Up to date</strong></span>.
						</p><p class="simpara">
							For subscriptions with a <span class="strong strong"><strong>Manual</strong></span> approval strategy, you can manually approve the update from the <span class="strong strong"><strong>Subscription</strong></span> tab.
						</p></li></ol></div></section><section class="section" id="olm-approving-pending-upgrade_file-integrity-operator-updating"><div class="titlepage"><div><div><h3 class="title">6.3.3. Manually approving a pending Operator update</h3></div></div></div><p>
					If an installed Operator has the approval strategy in its subscription set to <span class="strong strong"><strong>Manual</strong></span>, when new updates are released in its current update channel, the update must be manually approved before installation can begin.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							An Operator previously installed using Operator Lifecycle Manager (OLM).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the <span class="strong strong"><strong>Administrator</strong></span> perspective of the OpenShift Container Platform web console, navigate to <span class="strong strong"><strong>Operators → Installed Operators</strong></span>.
						</li><li class="listitem">
							Operators that have a pending update display a status with <span class="strong strong"><strong>Upgrade available</strong></span>. Click the name of the Operator you want to update.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Subscription</strong></span> tab. Any updates requiring approval are displayed next to <span class="strong strong"><strong>Upgrade status</strong></span>. For example, it might display <span class="strong strong"><strong>1 requires approval</strong></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>1 requires approval</strong></span>, then click <span class="strong strong"><strong>Preview Install Plan</strong></span>.
						</li><li class="listitem">
							Review the resources that are listed as available for update. When satisfied, click <span class="strong strong"><strong>Approve</strong></span>.
						</li><li class="listitem">
							Navigate back to the <span class="strong strong"><strong>Operators → Installed Operators</strong></span> page to monitor the progress of the update. When complete, the status changes to <span class="strong strong"><strong>Succeeded</strong></span> and <span class="strong strong"><strong>Up to date</strong></span>.
						</li></ol></div></section></section><section class="section" id="understanding-file-integrity-operator"><div class="titlepage"><div><div><h2 class="title">6.4. Understanding the File Integrity Operator</h2></div></div></div><p>
				The File Integrity Operator is an OpenShift Container Platform Operator that continually runs file integrity checks on the cluster nodes. It deploys a daemon set that initializes and runs privileged advanced intrusion detection environment (AIDE) containers on each node, providing a status object with a log of files that are modified during the initial run of the daemon set pods.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Currently, only Red Hat Enterprise Linux CoreOS (RHCOS) nodes are supported.
				</p></div></div><section class="section" id="understanding-file-integrity-custom-resource_file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.4.1. Creating the FileIntegrity custom resource</h3></div></div></div><p>
					An instance of a <code class="literal">FileIntegrity</code> custom resource (CR) represents a set of continuous file integrity scans for one or more nodes.
				</p><p>
					Each <code class="literal">FileIntegrity</code> CR is backed by a daemon set running AIDE on the nodes matching the <code class="literal">FileIntegrity</code> CR specification.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create the following example <code class="literal">FileIntegrity</code> CR named <code class="literal">worker-fileintegrity.yaml</code> to enable scans on worker nodes:
						</p><div class="formalpara"><p class="title"><strong>Example FileIntegrity CR</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: fileintegrity.openshift.io/v1alpha1
kind: FileIntegrity
metadata:
  name: worker-fileintegrity
  namespace: openshift-file-integrity
spec:
  nodeSelector: <span id="CO44-1"><!--Empty--></span><span class="callout">1</span>
      node-role.kubernetes.io/worker: ""
  tolerations: <span id="CO44-2"><!--Empty--></span><span class="callout">2</span>
  - key: "myNode"
    operator: "Exists"
    effect: "NoSchedule"
  config: <span id="CO44-3"><!--Empty--></span><span class="callout">3</span>
    name: "myconfig"
    namespace: "openshift-file-integrity"
    key: "config"
    gracePeriod: 20 <span id="CO44-4"><!--Empty--></span><span class="callout">4</span>
    maxBackups: 5 <span id="CO44-5"><!--Empty--></span><span class="callout">5</span>
    initialDelay: 60 <span id="CO44-6"><!--Empty--></span><span class="callout">6</span>
  debug: false
status:
  phase: Active <span id="CO44-7"><!--Empty--></span><span class="callout">7</span></pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO44-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Defines the selector for scheduling node scans.
								</div></dd><dt><a href="#CO44-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Specify <code class="literal">tolerations</code> to schedule on nodes with custom taints. When not specified, a default toleration allowing running on main and infra nodes is applied.
								</div></dd><dt><a href="#CO44-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Define a <code class="literal">ConfigMap</code> containing an AIDE configuration to use.
								</div></dd><dt><a href="#CO44-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									The number of seconds to pause in between AIDE integrity checks. Frequent AIDE checks on a node might be resource intensive, so it can be useful to specify a longer interval. Default is 900 seconds (15 minutes).
								</div></dd><dt><a href="#CO44-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									The maximum number of AIDE database and log backups (leftover from the re-init process) to keep on a node. Older backups beyond this number are automatically pruned by the daemon. Default is set to 5.
								</div></dd><dt><a href="#CO44-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									The number of seconds to wait before starting the first AIDE integrity check. Default is set to 0.
								</div></dd><dt><a href="#CO44-7"><span class="callout">7</span></a> </dt><dd><div class="para">
									The running status of the <code class="literal">FileIntegrity</code> instance. Statuses are <code class="literal">Initializing</code>, <code class="literal">Pending</code>, or <code class="literal">Active</code>.
								</div></dd></dl></div><div class="horizontal"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 15%; "><!--Empty--></col><col style="width: 85%; "><!--Empty--></col></colgroup><tbody valign="top"><tr><td valign="top"> <p>
											<code class="literal">Initializing</code>
										</p>
										 </td><td valign="top"> <p>
											The <code class="literal">FileIntegrity</code> object is currently initializing or re-initializing the AIDE database.
										</p>
										 </td></tr><tr><td valign="top"> <p>
											<code class="literal">Pending</code>
										</p>
										 </td><td valign="top"> <p>
											The <code class="literal">FileIntegrity</code> deployment is still being created.
										</p>
										 </td></tr><tr><td valign="top"> <p>
											<code class="literal">Active</code>
										</p>
										 </td><td valign="top"> <p>
											The scans are active and ongoing.
										</p>
										 </td></tr></tbody></table></div></li><li class="listitem"><p class="simpara">
							Apply the YAML file to the <code class="literal">openshift-file-integrity</code> namespace:
						</p><pre class="programlisting language-terminal">$ oc apply -f worker-fileintegrity.yaml -n openshift-file-integrity</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Confirm the <code class="literal">FileIntegrity</code> object was created successfully by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get fileintegrities -n openshift-file-integrity</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                   AGE
worker-fileintegrity   14s</pre>

							</p></div></li></ul></div></section><section class="section" id="checking-the-file-integrity-CR-status_file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.4.2. Checking the FileIntegrity custom resource status</h3></div></div></div><p>
					The <code class="literal">FileIntegrity</code> custom resource (CR) reports its status through the .<code class="literal">status.phase</code> subresource.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To query the <code class="literal">FileIntegrity</code> CR status, run:
						</p><pre class="programlisting language-terminal">$ oc get fileintegrities/worker-fileintegrity  -o jsonpath="{ .status.phase }"</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Active</pre>

							</p></div></li></ul></div></section><section class="section" id="file-integrity-CR-phases_file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.4.3. FileIntegrity custom resource phases</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">Pending</code> - The phase after the custom resource (CR) is created.
						</li><li class="listitem">
							<code class="literal">Active</code> - The phase when the backing daemon set is up and running.
						</li><li class="listitem">
							<code class="literal">Initializing</code> - The phase when the AIDE database is being reinitialized.
						</li></ul></div></section><section class="section" id="understanding-file-integrity-node-statuses-object_file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.4.4. Understanding the FileIntegrityNodeStatuses object</h3></div></div></div><p>
					The scan results of the <code class="literal">FileIntegrity</code> CR are reported in another object called <code class="literal">FileIntegrityNodeStatuses</code>.
				</p><pre class="programlisting language-terminal">$ oc get fileintegritynodestatuses</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">NAME                                                AGE
worker-fileintegrity-ip-10-0-130-192.ec2.internal   101s
worker-fileintegrity-ip-10-0-147-133.ec2.internal   109s
worker-fileintegrity-ip-10-0-165-160.ec2.internal   102s</pre>

					</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						It might take some time for the <code class="literal">FileIntegrityNodeStatus</code> object results to be available.
					</p></div></div><p>
					There is one result object per node. The <code class="literal">nodeName</code> attribute of each <code class="literal">FileIntegrityNodeStatus</code> object corresponds to the node being scanned. The status of the file integrity scan is represented in the <code class="literal">results</code> array, which holds scan conditions.
				</p><pre class="programlisting language-terminal">$ oc get fileintegritynodestatuses.fileintegrity.openshift.io -ojsonpath='{.items[*].results}' | jq</pre><p>
					The <code class="literal">fileintegritynodestatus</code> object reports the latest status of an AIDE run and exposes the status as <code class="literal">Failed</code>, <code class="literal">Succeeded</code>, or <code class="literal">Errored</code> in a <code class="literal">status</code> field.
				</p><pre class="programlisting language-terminal">$ oc get fileintegritynodestatuses -w</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">NAME                                                               NODE                                         STATUS
example-fileintegrity-ip-10-0-134-186.us-east-2.compute.internal   ip-10-0-134-186.us-east-2.compute.internal   Succeeded
example-fileintegrity-ip-10-0-150-230.us-east-2.compute.internal   ip-10-0-150-230.us-east-2.compute.internal   Succeeded
example-fileintegrity-ip-10-0-169-137.us-east-2.compute.internal   ip-10-0-169-137.us-east-2.compute.internal   Succeeded
example-fileintegrity-ip-10-0-180-200.us-east-2.compute.internal   ip-10-0-180-200.us-east-2.compute.internal   Succeeded
example-fileintegrity-ip-10-0-194-66.us-east-2.compute.internal    ip-10-0-194-66.us-east-2.compute.internal    Failed
example-fileintegrity-ip-10-0-222-188.us-east-2.compute.internal   ip-10-0-222-188.us-east-2.compute.internal   Succeeded
example-fileintegrity-ip-10-0-134-186.us-east-2.compute.internal   ip-10-0-134-186.us-east-2.compute.internal   Succeeded
example-fileintegrity-ip-10-0-222-188.us-east-2.compute.internal   ip-10-0-222-188.us-east-2.compute.internal   Succeeded
example-fileintegrity-ip-10-0-194-66.us-east-2.compute.internal    ip-10-0-194-66.us-east-2.compute.internal    Failed
example-fileintegrity-ip-10-0-150-230.us-east-2.compute.internal   ip-10-0-150-230.us-east-2.compute.internal   Succeeded
example-fileintegrity-ip-10-0-180-200.us-east-2.compute.internal   ip-10-0-180-200.us-east-2.compute.internal   Succeeded</pre>

					</p></div></section><section class="section" id="file-integrity-node-status-types_file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.4.5. FileIntegrityNodeStatus CR status types</h3></div></div></div><p>
					These conditions are reported in the results array of the corresponding <code class="literal">FileIntegrityNodeStatus</code> CR status:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">Succeeded</code> - The integrity check passed; the files and directories covered by the AIDE check have not been modified since the database was last initialized.
						</li><li class="listitem">
							<code class="literal">Failed</code> - The integrity check failed; some files or directories covered by the AIDE check have been modified since the database was last initialized.
						</li><li class="listitem">
							<code class="literal">Errored</code> - The AIDE scanner encountered an internal error.
						</li></ul></div><section class="section" id="file-integrity-node-status-success_file-integrity-operator"><div class="titlepage"><div><div><h4 class="title">6.4.5.1. FileIntegrityNodeStatus CR success example</h4></div></div></div><div class="formalpara"><p class="title"><strong>Example output of a condition with a success status</strong></p><p>
							
<pre class="programlisting language-terminal">[
  {
    "condition": "Succeeded",
    "lastProbeTime": "2020-09-15T12:45:57Z"
  }
]
[
  {
    "condition": "Succeeded",
    "lastProbeTime": "2020-09-15T12:46:03Z"
  }
]
[
  {
    "condition": "Succeeded",
    "lastProbeTime": "2020-09-15T12:45:48Z"
  }
]</pre>

						</p></div><p>
						In this case, all three scans succeeded and so far there are no other conditions.
					</p></section><section class="section" id="file-integrity-node-status-failure_file-integrity-operator"><div class="titlepage"><div><div><h4 class="title">6.4.5.2. FileIntegrityNodeStatus CR failure status example</h4></div></div></div><p>
						To simulate a failure condition, modify one of the files AIDE tracks. For example, modify <code class="literal">/etc/resolv.conf</code> on one of the worker nodes:
					</p><pre class="programlisting language-terminal">$ oc debug node/ip-10-0-130-192.ec2.internal</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">Creating debug namespace/openshift-debug-node-ldfbj ...
Starting pod/ip-10-0-130-192ec2internal-debug ...
To use host binaries, run `chroot /host`
Pod IP: 10.0.130.192
If you don't see a command prompt, try pressing enter.
sh-4.2# echo "# integrity test" &gt;&gt; /host/etc/resolv.conf
sh-4.2# exit

Removing debug pod ...
Removing debug namespace/openshift-debug-node-ldfbj ...</pre>

						</p></div><p>
						After some time, the <code class="literal">Failed</code> condition is reported in the results array of the corresponding <code class="literal">FileIntegrityNodeStatus</code> object. The previous <code class="literal">Succeeded</code> condition is retained, which allows you to pinpoint the time the check failed.
					</p><pre class="programlisting language-terminal">$ oc get fileintegritynodestatuses.fileintegrity.openshift.io/worker-fileintegrity-ip-10-0-130-192.ec2.internal -ojsonpath='{.results}' | jq -r</pre><p>
						Alternatively, if you are not mentioning the object name, run:
					</p><pre class="programlisting language-terminal">$ oc get fileintegritynodestatuses.fileintegrity.openshift.io -ojsonpath='{.items[*].results}' | jq</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">[
  {
    "condition": "Succeeded",
    "lastProbeTime": "2020-09-15T12:54:14Z"
  },
  {
    "condition": "Failed",
    "filesChanged": 1,
    "lastProbeTime": "2020-09-15T12:57:20Z",
    "resultConfigMapName": "aide-ds-worker-fileintegrity-ip-10-0-130-192.ec2.internal-failed",
    "resultConfigMapNamespace": "openshift-file-integrity"
  }
]</pre>

						</p></div><p>
						The <code class="literal">Failed</code> condition points to a config map that gives more details about what exactly failed and why:
					</p><pre class="programlisting language-terminal">$ oc describe cm aide-ds-worker-fileintegrity-ip-10-0-130-192.ec2.internal-failed</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">Name:         aide-ds-worker-fileintegrity-ip-10-0-130-192.ec2.internal-failed
Namespace:    openshift-file-integrity
Labels:       file-integrity.openshift.io/node=ip-10-0-130-192.ec2.internal
              file-integrity.openshift.io/owner=worker-fileintegrity
              file-integrity.openshift.io/result-log=
Annotations:  file-integrity.openshift.io/files-added: 0
              file-integrity.openshift.io/files-changed: 1
              file-integrity.openshift.io/files-removed: 0

Data

integritylog:
------
AIDE 0.15.1 found differences between database and filesystem!!
Start timestamp: 2020-09-15 12:58:15

Summary:
  Total number of files:  31553
  Added files:                0
  Removed files:            0
  Changed files:            1


---------------------------------------------------
Changed files:
---------------------------------------------------

changed: /hostroot/etc/resolv.conf

---------------------------------------------------
Detailed information about changes:
---------------------------------------------------


File: /hostroot/etc/resolv.conf
 SHA512   : sTQYpB/AL7FeoGtu/1g7opv6C+KT1CBJ , qAeM+a8yTgHPnIHMaRlS+so61EN8VOpg

Events:  &lt;none&gt;</pre>

						</p></div><p>
						Due to the config map data size limit, AIDE logs over 1 MB are added to the failure config map as a base64-encoded gzip archive. In this case, you want to pipe the output of the above command to <code class="literal">base64 --decode | gunzip</code>. Compressed logs are indicated by the presence of a <code class="literal">file-integrity.openshift.io/compressed</code> annotation key in the config map.
					</p></section></section><section class="section" id="file-integrity-events_file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.4.6. Understanding events</h3></div></div></div><p>
					Transitions in the status of the <code class="literal">FileIntegrity</code> and <code class="literal">FileIntegrityNodeStatus</code> objects are logged by <span class="emphasis"><em>events</em></span>. The creation time of the event reflects the latest transition, such as <code class="literal">Initializing</code> to <code class="literal">Active</code>, and not necessarily the latest scan result. However, the newest event always reflects the most recent status.
				</p><pre class="programlisting language-terminal">$ oc get events --field-selector reason=FileIntegrityStatus</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">LAST SEEN   TYPE     REASON                OBJECT                                MESSAGE
97s         Normal   FileIntegrityStatus   fileintegrity/example-fileintegrity   Pending
67s         Normal   FileIntegrityStatus   fileintegrity/example-fileintegrity   Initializing
37s         Normal   FileIntegrityStatus   fileintegrity/example-fileintegrity   Active</pre>

					</p></div><p>
					When a node scan fails, an event is created with the <code class="literal">add/changed/removed</code> and config map information.
				</p><pre class="programlisting language-terminal">$ oc get events --field-selector reason=NodeIntegrityStatus</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">LAST SEEN   TYPE      REASON                OBJECT                                MESSAGE
114m        Normal    NodeIntegrityStatus   fileintegrity/example-fileintegrity   no changes to node ip-10-0-134-173.ec2.internal
114m        Normal    NodeIntegrityStatus   fileintegrity/example-fileintegrity   no changes to node ip-10-0-168-238.ec2.internal
114m        Normal    NodeIntegrityStatus   fileintegrity/example-fileintegrity   no changes to node ip-10-0-169-175.ec2.internal
114m        Normal    NodeIntegrityStatus   fileintegrity/example-fileintegrity   no changes to node ip-10-0-152-92.ec2.internal
114m        Normal    NodeIntegrityStatus   fileintegrity/example-fileintegrity   no changes to node ip-10-0-158-144.ec2.internal
114m        Normal    NodeIntegrityStatus   fileintegrity/example-fileintegrity   no changes to node ip-10-0-131-30.ec2.internal
87m         Warning   NodeIntegrityStatus   fileintegrity/example-fileintegrity   node ip-10-0-152-92.ec2.internal has changed! a:1,c:1,r:0 \ log:openshift-file-integrity/aide-ds-example-fileintegrity-ip-10-0-152-92.ec2.internal-failed</pre>

					</p></div><p>
					Changes to the number of added, changed, or removed files results in a new event, even if the status of the node has not transitioned.
				</p><pre class="programlisting language-terminal">$ oc get events --field-selector reason=NodeIntegrityStatus</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">LAST SEEN   TYPE      REASON                OBJECT                                MESSAGE
114m        Normal    NodeIntegrityStatus   fileintegrity/example-fileintegrity   no changes to node ip-10-0-134-173.ec2.internal
114m        Normal    NodeIntegrityStatus   fileintegrity/example-fileintegrity   no changes to node ip-10-0-168-238.ec2.internal
114m        Normal    NodeIntegrityStatus   fileintegrity/example-fileintegrity   no changes to node ip-10-0-169-175.ec2.internal
114m        Normal    NodeIntegrityStatus   fileintegrity/example-fileintegrity   no changes to node ip-10-0-152-92.ec2.internal
114m        Normal    NodeIntegrityStatus   fileintegrity/example-fileintegrity   no changes to node ip-10-0-158-144.ec2.internal
114m        Normal    NodeIntegrityStatus   fileintegrity/example-fileintegrity   no changes to node ip-10-0-131-30.ec2.internal
87m         Warning   NodeIntegrityStatus   fileintegrity/example-fileintegrity   node ip-10-0-152-92.ec2.internal has changed! a:1,c:1,r:0 \ log:openshift-file-integrity/aide-ds-example-fileintegrity-ip-10-0-152-92.ec2.internal-failed
40m         Warning   NodeIntegrityStatus   fileintegrity/example-fileintegrity   node ip-10-0-152-92.ec2.internal has changed! a:3,c:1,r:0 \ log:openshift-file-integrity/aide-ds-example-fileintegrity-ip-10-0-152-92.ec2.internal-failed</pre>

					</p></div></section></section><section class="section" id="configuring-file-integrity-operator"><div class="titlepage"><div><div><h2 class="title">6.5. Configuring the Custom File Integrity Operator</h2></div></div></div><section class="section" id="viewing-file-integrity-object-attributes_file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.5.1. Viewing FileIntegrity object attributes</h3></div></div></div><p>
					As with any Kubernetes custom resources (CRs), you can run <code class="literal">oc explain fileintegrity</code>, and then look at the individual attributes using:
				</p><pre class="programlisting language-terminal">$ oc explain fileintegrity.spec</pre><pre class="programlisting language-terminal">$ oc explain fileintegrity.spec.config</pre></section><section class="section" id="important-file-integrity-object-attributes_file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.5.2. Important attributes</h3></div></div></div><div class="table" id="idm139961120201696"><p class="title"><strong>Table 6.1. Important <code class="literal">spec</code> and <code class="literal">spec.config</code> attributes</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139961120195904" scope="col">Attribute</th><th align="left" valign="top" id="idm139961120194816" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139961120195904"> <p>
									<code class="literal">spec.nodeSelector</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139961120194816"> <p>
									A map of key-values pairs that must match with node’s labels in order for the AIDE pods to be schedulable on that node. The typical use is to set only a single key-value pair where <code class="literal">node-role.kubernetes.io/worker: ""</code> schedules AIDE on all worker nodes, <code class="literal">node.openshift.io/os_id: "rhcos"</code> schedules on all Red Hat Enterprise Linux CoreOS (RHCOS) nodes.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139961120195904"> <p>
									<code class="literal">spec.debug</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139961120194816"> <p>
									A boolean attribute. If set to <code class="literal">true</code>, the daemon running in the AIDE deamon set’s pods would output extra information.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139961120195904"> <p>
									<code class="literal">spec.tolerations</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139961120194816"> <p>
									Specify tolerations to schedule on nodes with custom taints. When not specified, a default toleration is applied, which allows tolerations to run on control plane nodes.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139961120195904"> <p>
									<code class="literal">spec.config.gracePeriod</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139961120194816"> <p>
									The number of seconds to pause in between AIDE integrity checks. Frequent AIDE checks on a node can be resource intensive, so it can be useful to specify a longer interval. Defaults to <code class="literal">900</code>, or 15 minutes.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139961120195904"> <p>
									<code class="literal">maxBackups</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139961120194816"> <p>
									The maximum number of AIDE database and log backups leftover from the <code class="literal">re-init</code> process to keep on a node. Older backups beyond this number are automatically pruned by the daemon.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139961120195904"> <p>
									<code class="literal">spec.config.name</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139961120194816"> <p>
									Name of a configMap that contains custom AIDE configuration. If omitted, a default configuration is created.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139961120195904"> <p>
									<code class="literal">spec.config.namespace</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139961120194816"> <p>
									Namespace of a configMap that contains custom AIDE configuration. If unset, the FIO generates a default configuration suitable for RHCOS systems.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139961120195904"> <p>
									<code class="literal">spec.config.key</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139961120194816"> <p>
									Key that contains actual AIDE configuration in a config map specified by <code class="literal">name</code> and <code class="literal">namespace</code>. The default value is <code class="literal">aide.conf</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139961120195904"> <p>
									<code class="literal">spec.config.initialDelay</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139961120194816"> <p>
									The number of seconds to wait before starting the first AIDE integrity check. Default is set to 0. This attribute is optional.
								</p>
								 </td></tr></tbody></table></div></div></section><section class="section" id="file-integrity-examine-default-config_file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.5.3. Examine the default configuration</h3></div></div></div><p>
					The default File Integrity Operator configuration is stored in a config map with the same name as the <code class="literal">FileIntegrity</code> CR.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To examine the default config, run:
						</p><pre class="programlisting language-terminal">$ oc describe cm/worker-fileintegrity</pre></li></ul></div></section><section class="section" id="file-integrity-understanding-default-config_file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.5.4. Understanding the default File Integrity Operator configuration</h3></div></div></div><p>
					Below is an excerpt from the <code class="literal">aide.conf</code> key of the config map:
				</p><pre class="programlisting language-bash">@@define DBDIR /hostroot/etc/kubernetes
@@define LOGDIR /hostroot/etc/kubernetes
database=file:@@{DBDIR}/aide.db.gz
database_out=file:@@{DBDIR}/aide.db.gz
gzip_dbout=yes
verbose=5
report_url=file:@@{LOGDIR}/aide.log
report_url=stdout
PERMS = p+u+g+acl+selinux+xattrs
CONTENT_EX = sha512+ftype+p+u+g+n+acl+selinux+xattrs

/hostroot/boot/    	CONTENT_EX
/hostroot/root/\..* PERMS
/hostroot/root/   CONTENT_EX</pre><p>
					The default configuration for a <code class="literal">FileIntegrity</code> instance provides coverage for files under the following directories:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">/root</code>
						</li><li class="listitem">
							<code class="literal">/boot</code>
						</li><li class="listitem">
							<code class="literal">/usr</code>
						</li><li class="listitem">
							<code class="literal">/etc</code>
						</li></ul></div><p>
					The following directories are not covered:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">/var</code>
						</li><li class="listitem">
							<code class="literal">/opt</code>
						</li><li class="listitem">
							Some OpenShift Container Platform-specific excludes under <code class="literal">/etc/</code>
						</li></ul></div></section><section class="section" id="file-integrity-operator-supplying-custom-aide-config_file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.5.5. Supplying a custom AIDE configuration</h3></div></div></div><p>
					Any entries that configure AIDE internal behavior such as <code class="literal">DBDIR</code>, <code class="literal">LOGDIR</code>, <code class="literal">database</code>, and <code class="literal">database_out</code> are overwritten by the Operator. The Operator would add a prefix to <code class="literal">/hostroot/</code> before all paths to be watched for integrity changes. This makes reusing existing AIDE configs that might often not be tailored for a containerized environment and start from the root directory easier.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						<code class="literal">/hostroot</code> is the directory where the pods running AIDE mount the host’s file system. Changing the configuration triggers a reinitializing of the database.
					</p></div></div></section><section class="section" id="file-integrity-operator-defining-custom-config_file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.5.6. Defining a custom File Integrity Operator configuration</h3></div></div></div><p>
					This example focuses on defining a custom configuration for a scanner that runs on the control plane nodes based on the default configuration provided for the <code class="literal">worker-fileintegrity</code> CR. This workflow might be useful if you are planning to deploy a custom software running as a daemon set and storing its data under <code class="literal">/opt/mydaemon</code> on the control plane nodes.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Make a copy of the default configuration.
						</li><li class="listitem">
							Edit the default configuration with the files that must be watched or excluded.
						</li><li class="listitem">
							Store the edited contents in a new config map.
						</li><li class="listitem">
							Point the <code class="literal">FileIntegrity</code> object to the new config map through the attributes in <code class="literal">spec.config</code>.
						</li><li class="listitem"><p class="simpara">
							Extract the default configuration:
						</p><pre class="programlisting language-terminal">$ oc extract cm/worker-fileintegrity --keys=aide.conf</pre><p class="simpara">
							This creates a file named <code class="literal">aide.conf</code> that you can edit. To illustrate how the Operator post-processes the paths, this example adds an exclude directory without the prefix:
						</p><pre class="programlisting language-terminal">$ vim aide.conf</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">/hostroot/etc/kubernetes/static-pod-resources
!/hostroot/etc/kubernetes/aide.*
!/hostroot/etc/kubernetes/manifests
!/hostroot/etc/docker/certs.d
!/hostroot/etc/selinux/targeted
!/hostroot/etc/openvswitch/conf.db</pre>

							</p></div><p class="simpara">
							Exclude a path specific to control plane nodes:
						</p><pre class="programlisting language-terminal">!/opt/mydaemon/</pre><p class="simpara">
							Store the other content in <code class="literal">/etc</code>:
						</p><pre class="programlisting language-terminal">/hostroot/etc/	CONTENT_EX</pre></li><li class="listitem"><p class="simpara">
							Create a config map based on this file:
						</p><pre class="programlisting language-terminal">$ oc create cm master-aide-conf --from-file=aide.conf</pre></li><li class="listitem"><p class="simpara">
							Define a <code class="literal">FileIntegrity</code> CR manifest that references the config map:
						</p><pre class="programlisting language-yaml">apiVersion: fileintegrity.openshift.io/v1alpha1
kind: FileIntegrity
metadata:
  name: master-fileintegrity
  namespace: openshift-file-integrity
spec:
  nodeSelector:
      node-role.kubernetes.io/master: ""
  config:
      name: master-aide-conf
      namespace: openshift-file-integrity</pre><p class="simpara">
							The Operator processes the provided config map file and stores the result in a config map with the same name as the <code class="literal">FileIntegrity</code> object:
						</p><pre class="programlisting language-terminal">$ oc describe cm/master-fileintegrity | grep /opt/mydaemon</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">!/hostroot/opt/mydaemon</pre>

							</p></div></li></ol></div></section><section class="section" id="file-integrity-operator-changing-custom-config_file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.5.7. Changing the custom File Integrity configuration</h3></div></div></div><p>
					To change the File Integrity configuration, never change the generated config map. Instead, change the config map that is linked to the <code class="literal">FileIntegrity</code> object through the <code class="literal">spec.name</code>, <code class="literal">namespace</code>, and <code class="literal">key</code> attributes.
				</p></section></section><section class="section" id="file-integrity-operator-advanced-usage"><div class="titlepage"><div><div><h2 class="title">6.6. Performing advanced Custom File Integrity Operator tasks</h2></div></div></div><section class="section" id="file-integrity-operator-reinitializing-database_file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.6.1. Reinitializing the database</h3></div></div></div><p>
					If the File Integrity Operator detects a change that was planned, it might be required to reinitialize the database.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Annotate the <code class="literal">FileIntegrity</code> custom resource (CR) with <code class="literal">file-integrity.openshift.io/re-init</code>:
						</p><pre class="programlisting language-terminal">$ oc annotate fileintegrities/worker-fileintegrity file-integrity.openshift.io/re-init=</pre><p class="simpara">
							The old database and log files are backed up and a new database is initialized. The old database and logs are retained on the nodes under <code class="literal">/etc/kubernetes</code>, as seen in the following output from a pod spawned using <code class="literal">oc debug</code>:
						</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal"> ls -lR /host/etc/kubernetes/aide.*
-rw-------. 1 root root 1839782 Sep 17 15:08 /host/etc/kubernetes/aide.db.gz
-rw-------. 1 root root 1839783 Sep 17 14:30 /host/etc/kubernetes/aide.db.gz.backup-20200917T15_07_38
-rw-------. 1 root root   73728 Sep 17 15:07 /host/etc/kubernetes/aide.db.gz.backup-20200917T15_07_55
-rw-r--r--. 1 root root       0 Sep 17 15:08 /host/etc/kubernetes/aide.log
-rw-------. 1 root root     613 Sep 17 15:07 /host/etc/kubernetes/aide.log.backup-20200917T15_07_38
-rw-r--r--. 1 root root       0 Sep 17 15:07 /host/etc/kubernetes/aide.log.backup-20200917T15_07_55</pre>

							</p></div><p class="simpara">
							To provide some permanence of record, the resulting config maps are not owned by the <code class="literal">FileIntegrity</code> object, so manual cleanup is necessary. As a result, any previous integrity failures would still be visible in the <code class="literal">FileIntegrityNodeStatus</code> object.
						</p></li></ul></div></section><section class="section" id="file-integrity-operator-machine-config-integration_file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.6.2. Machine config integration</h3></div></div></div><p>
					In OpenShift Container Platform 4, the cluster node configuration is delivered through <code class="literal">MachineConfig</code> objects. You can assume that the changes to files that are caused by a <code class="literal">MachineConfig</code> object are expected and should not cause the file integrity scan to fail. To suppress changes to files caused by <code class="literal">MachineConfig</code> object updates, the File Integrity Operator watches the node objects; when a node is being updated, the AIDE scans are suspended for the duration of the update. When the update finishes, the database is reinitialized and the scans resume.
				</p><p>
					This pause and resume logic only applies to updates through the <code class="literal">MachineConfig</code> API, as they are reflected in the node object annotations.
				</p></section><section class="section" id="file-integrity-operator-exploring-daemon-sets_file-integrity-operator"><div class="titlepage"><div><div><h3 class="title">6.6.3. Exploring the daemon sets</h3></div></div></div><p>
					Each <code class="literal">FileIntegrity</code> object represents a scan on a number of nodes. The scan itself is performed by pods managed by a daemon set.
				</p><p>
					To find the daemon set that represents a <code class="literal">FileIntegrity</code> object, run:
				</p><pre class="programlisting language-terminal">$ oc -n openshift-file-integrity get ds/aide-worker-fileintegrity</pre><p>
					To list the pods in that daemon set, run:
				</p><pre class="programlisting language-terminal">$ oc -n openshift-file-integrity get pods -lapp=aide-worker-fileintegrity</pre><p>
					To view logs of a single AIDE pod, call <code class="literal">oc logs</code> on one of the pods.
				</p><pre class="programlisting language-terminal">$ oc -n openshift-file-integrity logs pod/aide-worker-fileintegrity-mr8x6</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">Starting the AIDE runner daemon
initializing AIDE db
initialization finished
running aide check
...</pre>

					</p></div><p>
					The config maps created by the AIDE daemon are not retained and are deleted after the File Integrity Operator processes them. However, on failure and error, the contents of these config maps are copied to the config map that the <code class="literal">FileIntegrityNodeStatus</code> object points to.
				</p></section></section><section class="section" id="troubleshooting-file-integrity-operator"><div class="titlepage"><div><div><h2 class="title">6.7. Troubleshooting the File Integrity Operator</h2></div></div></div><section class="section" id="general-troubleshooting"><div class="titlepage"><div><div><h3 class="title">6.7.1. General troubleshooting</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Issue</span></dt><dd>
								You want to generally troubleshoot issues with the File Integrity Operator.
							</dd><dt><span class="term">Resolution</span></dt><dd>
								Enable the debug flag in the <code class="literal">FileIntegrity</code> object. The <code class="literal">debug</code> flag increases the verbosity of the daemons that run in the <code class="literal">DaemonSet</code> pods and run the AIDE checks.
							</dd></dl></div></section><section class="section" id="checking-the-aide-configuration"><div class="titlepage"><div><div><h3 class="title">6.7.2. Checking the AIDE configuration</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Issue</span></dt><dd>
								You want to check the AIDE configuration.
							</dd><dt><span class="term">Resolution</span></dt><dd>
								The AIDE configuration is stored in a config map with the same name as the <code class="literal">FileIntegrity</code> object. All AIDE configuration config maps are labeled with <code class="literal">file-integrity.openshift.io/aide-conf</code>.
							</dd></dl></div></section><section class="section" id="determining-the-fileintegrity-object-s-phase"><div class="titlepage"><div><div><h3 class="title">6.7.3. Determining the FileIntegrity object’s phase</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Issue</span></dt><dd>
								You want to determine if the <code class="literal">FileIntegrity</code> object exists and see its current status.
							</dd><dt><span class="term">Resolution</span></dt><dd><p class="simpara">
								To see the <code class="literal">FileIntegrity</code> object’s current status, run:
							</p><pre class="programlisting language-terminal">$ oc get fileintegrities/worker-fileintegrity  -o jsonpath="{ .status }"</pre><p class="simpara">
								Once the <code class="literal">FileIntegrity</code> object and the backing daemon set are created, the status should switch to <code class="literal">Active</code>. If it does not, check the Operator pod logs.
							</p></dd></dl></div></section><section class="section" id="determining-that-the-daemon-set-s-pods-are-running-on-the-expected-nodes"><div class="titlepage"><div><div><h3 class="title">6.7.4. Determining that the daemon set’s pods are running on the expected nodes</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Issue</span></dt><dd>
								You want to confirm that the daemon set exists and that its pods are running on the nodes you expect them to run on.
							</dd><dt><span class="term">Resolution</span></dt><dd><p class="simpara">
								Run:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-file-integrity get pods -lapp=aide-worker-fileintegrity</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Adding <code class="literal">-owide</code> includes the IP address of the node that the pod is running on.
								</p></div></div><p class="simpara">
								To check the logs of the daemon pods, run <code class="literal">oc logs</code>.
							</p><p class="simpara">
								Check the return value of the AIDE command to see if the check passed or failed.
							</p></dd></dl></div></section></section></section><section class="chapter" id="security-profiles-operator"><div class="titlepage"><div><div><h1 class="title">Chapter 7. Security Profiles Operator</h1></div></div></div><section class="section" id="spo-overview"><div class="titlepage"><div><div><h2 class="title">7.1. Security Profiles Operator overview</h2></div></div></div><p>
				OpenShift Container Platform Security Profiles Operator (SPO) provides a way to define secure computing (<a class="link" href="https://kubernetes.io/docs/tutorials/security/seccomp/">seccomp</a>) profiles and SELinux profiles as custom resources, synchronizing profiles to every node in a given namespace. For the latest updates, see the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-release-notes">release notes</a>.
			</p><p>
				The SPO can distribute custom resources to each node while a reconciliation loop ensures that the profiles stay up-to-date. See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-understanding">Understanding the Security Profiles Operator</a>.
			</p><p>
				The SPO manages SELinux policies and seccomp profiles for namespaced workloads. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-enabling">Enabling the Security Profiles Operator</a>.
			</p><p>
				You can create <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-seccomp">seccomp</a> and <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-selinux">SELinux</a> profiles, bind policies to pods, record workloads, and synchronize all worker nodes in a namespace.
			</p><p>
				Use <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-advanced">Advanced Security Profile Operator tasks</a> to enable the log enricher, configure webhooks and metrics, or restrict profiles to a single namespace.
			</p><p>
				<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#">Troubleshoot the Security Profiles Operator</a> as needed, or engage <a class="link" href="https://access.redhat.com/support/">Red Hat support</a>.
			</p><p>
				You can <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-uninstalling">Uninstall the Security Profiles Operator</a> by removing the profiles before removing the Operator.
			</p></section><section class="section" id="spo-release-notes"><div class="titlepage"><div><div><h2 class="title">7.2. Security Profiles Operator release notes</h2></div></div></div><p>
				The Security Profiles Operator provides a way to define secure computing (<a class="link" href="https://kubernetes.io/docs/tutorials/security/seccomp/">seccomp</a>) and SELinux profiles as custom resources, synchronizing profiles to every node in a given namespace.
			</p><p>
				These release notes track the development of the Security Profiles Operator in OpenShift Container Platform.
			</p><p>
				For an overview of the Security Profiles Operator, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#">Security Profiles Operator Overview</a>.
			</p><section class="section" id="spo-release-notes-0-8-0"><div class="titlepage"><div><div><h3 class="title">7.2.1. Security Profiles Operator 0.8.0</h3></div></div></div><p>
					The following advisory is available for the Security Profiles Operator 0.8.0:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2023:4689">RHBA-2023:4689 - OpenShift Security Profiles Operator bug fix update</a>
						</li></ul></div><section class="section" id="spo-0-8-0-bug-fixes"><div class="titlepage"><div><div><h4 class="title">7.2.1.1. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, while trying to install Security Profiles Operator in a disconnected cluster, the secure hashes provided were incorrect due to a SHA relabeling issue. With this update, the SHAs provided work consistently with disconnected environments. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-14404"><span class="strong strong"><strong>OCPBUGS-14404</strong></span></a>)
							</li></ul></div></section></section><section class="section" id="spo-release-notes-0-7-1"><div class="titlepage"><div><div><h3 class="title">7.2.2. Security Profiles Operator 0.7.1</h3></div></div></div><p>
					The following advisory is available for the Security Profiles Operator 0.7.1:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHSA-2023:2029">RHSA-2023:2029 - OpenShift Security Profiles Operator bug fix update</a>
						</li></ul></div><section class="section" id="spo-0-7-1-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">7.2.2.1. New features and enhancements</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Security Profiles Operator (SPO) now automatically selects the appropriate <code class="literal">selinuxd</code> image for RHEL 8- and 9-based RHCOS systems.
							</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									Users that mirror images for disconnected environments must mirror both <code class="literal">selinuxd</code> images provided by the Security Profiles Operator.
								</p></div></div></li><li class="listitem"><p class="simpara">
								You can now enable memory optimization inside of an <code class="literal">spod</code> daemon. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-memory-optimization_spo-advanced">Enabling memory optimization in the spod daemon</a>.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									SPO memory optimization is not enabled by default.
								</p></div></div></li><li class="listitem">
								The daemon resource requirements are now configurable. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-daemon-requirements_spo-advanced">Customizing daemon resource requirements</a>.
							</li><li class="listitem">
								The priority class name is now configurable in the <code class="literal">spod</code> configuration. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-custom-priority-class_spo-advanced">Setting a custom priority class name for the spod daemon pod</a>.
							</li></ul></div></section><section class="section" id="spo-0-7-1-deprecations"><div class="titlepage"><div><div><h4 class="title">7.2.2.2. Deprecated and removed features</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The default <code class="literal">nginx-1.19.1</code> seccomp profile is now removed from the Security Profiles Operator deployment.
							</li></ul></div></section><section class="section" id="spo-0-7-1-bug-fixes"><div class="titlepage"><div><div><h4 class="title">7.2.2.3. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, a Security Profiles Operator (SPO) SELinux policy did not inherit low-level policy definitions from the container template. If you selected another template, such as net_container, the policy would not work because it required low-level policy definitions that only existed in the container template. This issue occurred when the SPO SELinux policy attempted to translate SELinux policies from the SPO custom format to the Common Intermediate Language (CIL) format. With this update, the container template appends to any SELinux policies that require translation from SPO to CIL. Additionally, the SPO SELinux policy can inherit low-level policy definitions from any supported policy template. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-12879"><span class="strong strong"><strong>OCPBUGS-12879</strong></span></a>)
							</li></ul></div><h5 id="spo-0-7-1-known-issue">Known issue</h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								When uninstalling the Security Profiles Operator, the <code class="literal">MutatingWebhookConfiguration</code> object is not deleted and must be manually removed. As a workaround, delete the <code class="literal">MutatingWebhookConfiguration</code> object after uninstalling the Security Profiles Operator. These steps are defined in <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-uninstalling">Uninstalling the Security Profiles Operator</a>. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-4687"><span class="strong strong"><strong>OCPBUGS-4687</strong></span></a>)
							</li></ul></div></section></section><section class="section" id="spo-release-notes-0-5-2"><div class="titlepage"><div><div><h3 class="title">7.2.3. Security Profiles Operator 0.5.2</h3></div></div></div><p>
					The following advisory is available for the Security Profiles Operator 0.5.2:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2023:0788">RHBA-2023:0788 - OpenShift Security Profiles Operator bug fix update</a>
						</li></ul></div><p>
					This update addresses a CVE in an underlying dependency.
				</p><h5 id="spo-0-5-2-known-issue">Known issue</h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							When uninstalling the Security Profiles Operator, the <code class="literal">MutatingWebhookConfiguration</code> object is not deleted and must be manually removed. As a workaround, delete the <code class="literal">MutatingWebhookConfiguration</code> object after uninstalling the Security Profiles Operator. These steps are defined in <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-uninstalling">Uninstalling the Security Profiles Operator</a>. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-4687"><span class="strong strong"><strong>OCPBUGS-4687</strong></span></a>)
						</li></ul></div></section><section class="section" id="spo-release-notes-0-5-0"><div class="titlepage"><div><div><h3 class="title">7.2.4. Security Profiles Operator 0.5.0</h3></div></div></div><p>
					The following advisory is available for the Security Profiles Operator 0.5.0:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2022:8762">RHBA-2022:8762 - OpenShift Security Profiles Operator bug fix update</a>
						</li></ul></div><h5 id="spo-0-5-0-known-issue">Known issue</h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							When uninstalling the Security Profiles Operator, the <code class="literal">MutatingWebhookConfiguration</code> object is not deleted and must be manually removed. As a workaround, delete the <code class="literal">MutatingWebhookConfiguration</code> object after uninstalling the Security Profiles Operator. These steps are defined in <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-uninstalling">Uninstalling the Security Profiles Operator</a>. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-4687"><span class="strong strong"><strong>OCPBUGS-4687</strong></span></a>)
						</li></ul></div></section></section><section class="section" id="spo-understanding"><div class="titlepage"><div><div><h2 class="title">7.3. Understanding the Security Profiles Operator</h2></div></div></div><p>
				OpenShift Container Platform administrators can use the Security Profiles Operator to define increased security measures in clusters.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The Security Profiles Operator supports only Red Hat Enterprise Linux CoreOS (RHCOS) worker nodes. Red Hat Enterprise Linux (RHEL) nodes are not supported.
				</p></div></div><section class="section" id="spo-about_spo-understanding"><div class="titlepage"><div><div><h3 class="title">7.3.1. About Security Profiles</h3></div></div></div><p>
					Security profiles can increase security at the container level in your cluster.
				</p><p>
					Seccomp security profiles list the syscalls a process can make. Permissions are broader than SELinux, enabling users to restrict operations system-wide, such as <code class="literal">write</code>.
				</p><p>
					SELinux security profiles provide a label-based system that restricts the access and usage of processes, applications, or files in a system. All files in an environment have labels that define permissions. SELinux profiles can define access within a given structure, such as directories.
				</p></section></section><section class="section" id="spo-enabling"><div class="titlepage"><div><div><h2 class="title">7.4. Enabling the Security Profiles Operator</h2></div></div></div><p>
				Before you can use the Security Profiles Operator, you must ensure the Operator is deployed in the cluster.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The Security Profiles Operator supports only Red Hat Enterprise Linux CoreOS (RHCOS) worker nodes. Red Hat Enterprise Linux (RHEL) nodes are not supported.
				</p></div></div><section class="section" id="spo-installing_spo-enabling"><div class="titlepage"><div><div><h3 class="title">7.4.1. Installing the Security Profiles Operator</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You must have <code class="literal">admin</code> privileges.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the OpenShift Container Platform web console, navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span>.
						</li><li class="listitem">
							Search for the Security Profiles Operator, then click <span class="strong strong"><strong>Install</strong></span>.
						</li><li class="listitem">
							Keep the default selection of <span class="strong strong"><strong>Installation mode</strong></span> and <span class="strong strong"><strong>namespace</strong></span> to ensure that the Operator will be installed to the <code class="literal">openshift-security-profiles</code> namespace.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Install</strong></span>.
						</li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
						To confirm that the installation is successful:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> page.
						</li><li class="listitem">
							Check that the Security Profiles Operator is installed in the <code class="literal">openshift-security-profiles</code> namespace and its status is <code class="literal">Succeeded</code>.
						</li></ol></div><p>
					If the Operator is not installed successfully:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> page and inspect the <code class="literal">Status</code> column for any errors or failures.
						</li><li class="listitem">
							Navigate to the <span class="strong strong"><strong>Workloads</strong></span> → <span class="strong strong"><strong>Pods</strong></span> page and check the logs in any pods in the <code class="literal">openshift-security-profiles</code> project that are reporting issues.
						</li></ol></div></section><section class="section" id="spo-installing-cli_spo-enabling"><div class="titlepage"><div><div><h3 class="title">7.4.2. Installing the Security Profiles Operator using the CLI</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You must have <code class="literal">admin</code> privileges.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Define a <code class="literal">Namespace</code> object:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">namespace-object.yaml</code></strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: v1
kind: Namespace
metadata:
    name: openshift-security-profiles
labels:
  openshift.io/cluster-monitoring: "true"</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">Namespace</code> object:
						</p><pre class="programlisting language-terminal">$ oc create -f namespace-object.yaml</pre></li><li class="listitem"><p class="simpara">
							Define an <code class="literal">OperatorGroup</code> object:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">operator-group-object.yaml</code></strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: security-profiles-operator
  namespace: openshift-security-profiles</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">OperatorGroup</code> object:
						</p><pre class="programlisting language-terminal">$ oc create -f operator-group-object.yaml</pre></li><li class="listitem"><p class="simpara">
							Define a <code class="literal">Subscription</code> object:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">subscription-object.yaml</code></strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: security-profiles-operator-sub
  namespace: openshift-security-profiles
spec:
  channel: release-alpha-rhel-8
  installPlanApproval: Automatic
  name: security-profiles-operator
  source: redhat-operators
  sourceNamespace: openshift-marketplace</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">Subscription</code> object:
						</p><pre class="programlisting language-terminal">$ oc create -f subscription-object.yaml</pre></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are setting the global scheduler feature and enable <code class="literal">defaultNodeSelector</code>, you must create the namespace manually and update the annotations of the <code class="literal">openshift-security-profiles</code> namespace, or the namespace where the Security Profiles Operator was installed, with <code class="literal">openshift.io/node-selector: “”</code>. This removes the default node selector and prevents deployment failures.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Verify the installation succeeded by inspecting the following CSV file:
						</p><pre class="programlisting language-terminal">$ oc get csv -n openshift-security-profiles</pre></li><li class="listitem"><p class="simpara">
							Verify that the Security Profiles Operator is operational by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get deploy -n openshift-security-profiles</pre></li></ol></div></section><section class="section" id="logging-verbosity_spo-enabling"><div class="titlepage"><div><div><h3 class="title">7.4.3. Configuring logging verbosity</h3></div></div></div><p>
					The Security Profiles Operator supports the default logging verbosity of <code class="literal">0</code> and an enhanced verbosity of <code class="literal">1</code>.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To enable enhanced logging verbosity, patch the <code class="literal">spod</code> configuration and adjust the value by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles patch spod \
    spod --type=merge -p '{"spec":{"verbosity":1}}'</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">securityprofilesoperatordaemon.security-profiles-operator.x-k8s.io/spod patched</pre>

							</p></div></li></ul></div></section></section><section class="section" id="spo-seccomp"><div class="titlepage"><div><div><h2 class="title">7.5. Managing seccomp profiles</h2></div></div></div><p>
				Create and manage seccomp profiles and bind them to workloads.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The Security Profiles Operator supports only Red Hat Enterprise Linux CoreOS (RHCOS) worker nodes. Red Hat Enterprise Linux (RHEL) nodes are not supported.
				</p></div></div><section class="section" id="spo-creating-profiles_spo-seccomp"><div class="titlepage"><div><div><h3 class="title">7.5.1. Creating seccomp profiles</h3></div></div></div><p>
					Use the <code class="literal">SeccompProfile</code> object to create profiles.
				</p><p>
					<code class="literal">SeccompProfile</code> objects can restrict syscalls within a container, limiting the access of your application.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Create the <code class="literal">SeccompProfile</code> object:
						</p><pre class="programlisting language-yaml">apiVersion: security-profiles-operator.x-k8s.io/v1beta1
kind: SeccompProfile
metadata:
  namespace: my-namespace
  name: profile1
spec:
  defaultAction: SCMP_ACT_LOG</pre></li></ul></div><p>
					The seccomp profile will be saved in <code class="literal">/var/lib/kubelet/seccomp/operator/&lt;namespace&gt;/&lt;name&gt;.json</code>.
				</p><p>
					An <code class="literal">init</code> container creates the root directory of the Security Profiles Operator to run the Operator without <code class="literal">root</code> group or user ID privileges. A symbolic link is created from the rootless profile storage <code class="literal">/var/lib/openshift-security-profiles</code> to the default <code class="literal">seccomp</code> root path inside of the kubelet root <code class="literal">/var/lib/kubelet/seccomp/operator</code>.
				</p></section><section class="section" id="spo-applying-profiles_spo-seccomp"><div class="titlepage"><div><div><h3 class="title">7.5.2. Applying seccomp profiles to a pod</h3></div></div></div><p>
					Create a pod to apply one of the created profiles.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a pod object that defines a <code class="literal">securityContext</code>:
						</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Pod
metadata:
  name: test-pod
spec:
  securityContext:
    seccompProfile:
      type: Localhost
      localhostProfile: operator/my-namespace/profile1.json
  containers:
    - name: test-container
      image: quay.io/security-profiles-operator/test-nginx-unprivileged:1.21</pre></li><li class="listitem"><p class="simpara">
							View the profile path of the <code class="literal">seccompProfile.localhostProfile</code> attribute by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n my-namespace get seccompprofile profile1 --output wide</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME       STATUS   AGE   SECCOMPPROFILE.LOCALHOSTPROFILE
profile1   Active   14s   operator/my-namespace/profile1.json</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							View the path to the localhost profile by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get sp profile1 --output=jsonpath='{.status.localhostProfile}'</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">operator/my-namespace/profile1.json</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Apply the <code class="literal">localhostProfile</code> output to the patch file:
						</p><pre class="programlisting language-yaml">spec:
  template:
    spec:
      securityContext:
        seccompProfile:
          type: Localhost
          localhostProfile: operator/my-namespace/profile1.json</pre></li><li class="listitem"><p class="simpara">
							Apply the profile to a <code class="literal">Deployment</code> object by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n my-namespace patch deployment myapp --patch-file patch.yaml --type=merge</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">deployment.apps/myapp patched</pre>

							</p></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Confirm the profile was applied correctly by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n my-namespace get deployment myapp --output=jsonpath='{.spec.template.spec.securityContext}' | jq .</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-json">{
  "seccompProfile": {
    "localhostProfile": "operator/my-namespace/profile1.json",
    "type": "localhost"
  }
}</pre>

							</p></div></li></ul></div><section class="section" id="spo-binding-workloads_spo-seccomp"><div class="titlepage"><div><div><h4 class="title">7.5.2.1. Binding workloads to profiles with ProfileBindings</h4></div></div></div><p>
						You can use the <code class="literal">ProfileBinding</code> resource to bind a security profile to the <code class="literal">SecurityContext</code> of a container.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To bind a pod that uses a <code class="literal">quay.io/security-profiles-operator/test-nginx-unprivileged:1.21</code> image to the example <code class="literal">SeccompProfile</code> profile, create a <code class="literal">ProfileBinding</code> object in the same namespace with the pod and the <code class="literal">SeccompProfile</code> objects:
							</p><pre class="programlisting language-yaml">apiVersion: security-profiles-operator.x-k8s.io/v1alpha1
kind: ProfileBinding
metadata:
  namespace: my-namespace
  name: nginx-binding
spec:
  profileRef:
    kind: SeccompProfile <span id="CO45-1"><!--Empty--></span><span class="callout">1</span>
    name: profile <span id="CO45-2"><!--Empty--></span><span class="callout">2</span>
  image: quay.io/security-profiles-operator/test-nginx-unprivileged:1.21</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO45-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										The <code class="literal">kind:</code> variable refers to the name of the profile.
									</div></dd><dt><a href="#CO45-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										The <code class="literal">name:</code> variable refers to the name of the profile.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Label the namespace with <code class="literal">enable-binding=true</code> by running the following command:
							</p><pre class="programlisting language-terminal">$ oc label ns my-namespace spo.x-k8s.io/enable-binding=true</pre></li><li class="listitem"><p class="simpara">
								Delete and re-create the pod to use the <code class="literal">ProfileBinding</code> object:
							</p><pre class="programlisting language-terminal">$ oc delete pods test-pod &amp;&amp; oc create -f pod01.yaml</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Confirm the pod inherits the <code class="literal">ProfileBinding</code> by running the following command:
							</p><pre class="programlisting language-terminal">$ oc get pod test-pod -o jsonpath='{.spec.containers[*].securityContext.seccompProfile}'</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">{"localhostProfile":"operator/my-namespace/profile.json","type":"Localhost"}</pre>

								</p></div></li></ul></div></section></section><section class="section" id="spo-recording-profiles_spo-seccomp"><div class="titlepage"><div><div><h3 class="title">7.5.3. Recording profiles from workloads</h3></div></div></div><p>
					The Security Profiles Operator can record system calls with <code class="literal">ProfileRecording</code> objects, making it easier to create baseline profiles for applications.
				</p><p>
					When using the log enricher for recording seccomp profiles, verify the log enricher feature is enabled. See <span class="emphasis"><em>Additional resources</em></span> for more information.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						A container with <code class="literal">privileged: true</code> security context restraints prevents log-based recording. Privileged containers are not subject to seccomp policies, and log-based recording makes use of a special seccomp profile to record events.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Label the namespace with <code class="literal">enable-recording=true</code> by running the following command:
						</p><pre class="programlisting language-terminal">$ oc label ns my-namespace spo.x-k8s.io/enable-recording=true</pre></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">ProfileRecording</code> object containing a <code class="literal">recorder: logs</code> variable:
						</p><pre class="programlisting language-yaml">apiVersion: security-profiles-operator.x-k8s.io/v1alpha1
kind: ProfileRecording
metadata:
  name: test-recording
spec:
  kind: SeccompProfile
  recorder: logs
  podSelector:
    matchLabels:
      app: my-app</pre></li><li class="listitem"><p class="simpara">
							Create a workload to record:
						</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Pod
metadata:
  name: my-pod
  labels:
    app: my-app
spec:
  containers:
    - name: nginx
      image: quay.io/security-profiles-operator/test-nginx-unprivileged:1.21
      ports:
        - containerPort: 8080
    - name: redis
      image: quay.io/security-profiles-operator/redis:6.2.1</pre></li><li class="listitem"><p class="simpara">
							Confirm the pod is in a <code class="literal">Running</code> state by entering the following command:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles get pods</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME     READY   STATUS    RESTARTS   AGE
my-pod   2/2     Running   0          18s</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Confirm the enricher indicates that it receives audit logs for those containers:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles logs --since=1m --selector name=spod -c log-enricher</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">I0517 13:55:36.383187  348295 enricher.go:376] log-enricher "msg"="audit" "container"="redis" "namespace"="my-namespace" "node"="ip-10-0-189-53.us-east-2.compute.internal" "perm"="name_bind" "pod"="my-pod" "profile"="test-recording_redis_6kmrb_1684331729" "scontext"="system_u:system_r:selinuxrecording.process:s0:c4,c27" "tclass"="tcp_socket" "tcontext"="system_u:object_r:redis_port_t:s0" "timestamp"="1684331735.105:273965" "type"="seccomp"</pre>

							</p></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Remove the pod:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles delete pod my-pod</pre></li><li class="listitem"><p class="simpara">
							Confirm the Security Profiles Operator reconciles the two seccomp profiles:
						</p><pre class="programlisting language-terminal">$ oc get seccompprofiles -n my-namespace</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                   USAGE                                       STATE
test-recording-nginx   test-recording-nginx_my-namespace.process   Installed
test-recording-redis   test-recording-redis_my-namespace.process   Installed</pre>

							</p></div></li></ol></div><section class="section" id="spo-container-profile-instances_spo-seccomp"><div class="titlepage"><div><div><h4 class="title">7.5.3.1. Merging per-container profile instances</h4></div></div></div><p>
						By default, each container instance records into a separate profile. The Security Profiles Operator can merge the per-container profiles into a single profile. Merging profiles is useful when deploying applications using <code class="literal">ReplicaSet</code> or <code class="literal">Deployment</code> objects.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Edit a <code class="literal">ProfileRecording</code> object to include a <code class="literal">mergeStrategy: containers</code> variable:
							</p><pre class="programlisting language-yaml">apiVersion: security-profiles-operator.x-k8s.io/v1alpha1
kind: ProfileRecording
metadata:
  # The name of the Recording is the same as the resulting SeccompProfile CRD
  # after reconciliation.
  name: test-recording
spec:
  kind: SeccompProfile
  recorder: logs
  mergeStrategy: containers
  podSelector:
    matchLabels:
      app: sp-record</pre></li><li class="listitem"><p class="simpara">
								Create the workload:
							</p><pre class="programlisting language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deploy
spec:
  replicas: 3
  selector:
    matchLabels:
      app: sp-record
  template:
    metadata:
      labels:
        app: sp-record
    spec:
      serviceAccountName: spo-record-sa
      containers:
      - name: nginx-record
        image: quay.io/security-profiles-operator/test-nginx-unprivileged:1.21
        ports:
        - containerPort: 8080</pre></li><li class="listitem"><p class="simpara">
								To record the individual profiles, delete the deployment by running the following command:
							</p><pre class="programlisting language-terminal">$ oc delete deployment nginx-deploy</pre></li><li class="listitem"><p class="simpara">
								To merge the profiles, delete the profile recording by running the following command:
							</p><pre class="programlisting language-terminal">$ oc delete profilerecording test-recording</pre></li><li class="listitem"><p class="simpara">
								To start the merge operation and generate the results profile, run the following command:
							</p><pre class="programlisting language-terminal">$ oc get seccompprofiles -lspo.x-k8s.io/recording-id=test-recording</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                          USAGE                                         STATE
test-recording-nginx-record   test-recording-nginx-record_mytest1.process   Installed</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								To view the permissions used by any of the containers, run the following command:
							</p><pre class="programlisting language-terminal">$ oc get seccompprofiles test-recording-nginx-record -o yaml</pre></li></ol></div><h4 id="additional-resources_spo-seccomp">Additional resources</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#managing-security-context-constraints">Managing security context constraints</a>
							</li><li class="listitem">
								<a class="link" href="https://cloud.redhat.com/blog/managing-sccs-in-openshift">Managing SCCs in OpenShift</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-log-enricher_spo-advanced">Using the log enricher</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-about_spo-understanding">About security profiles</a>
							</li></ul></div></section></section></section><section class="section" id="spo-selinux"><div class="titlepage"><div><div><h2 class="title">7.6. Managing SELinux profiles</h2></div></div></div><p>
				Create and manage SELinux profiles and bind them to workloads.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The Security Profiles Operator supports only Red Hat Enterprise Linux CoreOS (RHCOS) worker nodes. Red Hat Enterprise Linux (RHEL) nodes are not supported.
				</p></div></div><section class="section" id="spo-creating-profiles_spo-selinux"><div class="titlepage"><div><div><h3 class="title">7.6.1. Creating SELinux profiles</h3></div></div></div><p>
					Use the <code class="literal">SelinuxProfile</code> object to create profiles.
				</p><p>
					The <code class="literal">SelinuxProfile</code> object has several features that allow for better security hardening and readability:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Restricts the profiles to inherit from to the current namespace or a system-wide profile. Because there are typically many profiles installed on the system, but only a subset should be used by cluster workloads, the inheritable system profiles are listed in the <code class="literal">spod</code> instance in <code class="literal">spec.selinuxOptions.allowedSystemProfiles</code>.
						</li><li class="listitem">
							Performs basic validation of the permissions, classes and labels.
						</li><li class="listitem">
							Adds a new keyword <code class="literal">@self</code> that describes the process using the policy. This allows reusing a policy between workloads and namespaces easily, as the usage of the policy is based on the name and namespace.
						</li><li class="listitem">
							Adds features for better security hardening and readability compared to writing a profile directly in the SELinux CIL language.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a policy that can be used with a non-privileged workload by creating the following <code class="literal">SelinuxProfile</code> object:
						</p><pre class="programlisting language-yaml">apiVersion: security-profiles-operator.x-k8s.io/v1alpha2
kind: SelinuxProfile
metadata:
  name: nginx-secure
  namespace: nginx-deploy
spec:
  allow:
    '@self':
      tcp_socket:
      - listen
    http_cache_port_t:
      tcp_socket:
      - name_bind
    node_t:
      tcp_socket:
      - node_bind
  inherit:
  - kind: System
    name: container</pre></li><li class="listitem"><p class="simpara">
							Wait for <code class="literal">selinuxd</code> to install the policy by running the following command:
						</p><pre class="programlisting language-terminal">$ oc wait --for=condition=ready -n nginx-deploy selinuxprofile nginx-secure</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">selinuxprofile.security-profiles-operator.x-k8s.io/nginx-secure condition met</pre>

							</p></div><p class="simpara">
							The policies are placed into an <code class="literal">emptyDir</code> in the container owned by the Security Profiles Operator. The policies are saved in Common Intermediate Language (CIL) format in <code class="literal">/etc/selinux.d/&lt;name&gt;_&lt;namespace&gt;.cil</code>.
						</p></li><li class="listitem"><p class="simpara">
							Access the pod by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles rsh -c selinuxd ds/spod</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							View the file contents with <code class="literal">cat</code> by running the following command:
						</p><pre class="programlisting language-terminal">$ cat /etc/selinux.d/nginx-secure_nginx-deploy.cil</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">(block nginx-secure_nginx-deploy
(blockinherit container)
(allow process nginx-secure_nginx-deploy.process ( tcp_socket ( listen )))
(allow process http_cache_port_t ( tcp_socket ( name_bind )))
(allow process node_t ( tcp_socket ( node_bind )))
)</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Verify that a policy has been installed by running the following command:
						</p><pre class="programlisting language-terminal">$ semodule -l | grep nginx-secure</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">nginx-secure_nginx-deploy</pre>

							</p></div></li></ol></div></section><section class="section" id="spo-applying-profiles_spo-selinux"><div class="titlepage"><div><div><h3 class="title">7.6.2. Applying SELinux profiles to a pod</h3></div></div></div><p>
					Create a pod to apply one of the created profiles.
				</p><p>
					For SELinux profiles, the namespace must be labelled to allow <a class="link" href="https://kubernetes.io/docs/concepts/security/pod-security-standards/">privileged</a> workloads.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Apply the <code class="literal">scc.podSecurityLabelSync=false</code> label to the <code class="literal">nginx-deploy</code> namespace by running the following command:
						</p><pre class="programlisting language-terminal">$ oc label ns nginx-deploy security.openshift.io/scc.podSecurityLabelSync=false</pre></li><li class="listitem"><p class="simpara">
							Apply the <code class="literal">privileged</code> label to the <code class="literal">nginx-deploy</code> namespace by running the following command:
						</p><pre class="programlisting language-terminal">$ oc label ns nginx-deploy --overwrite=true pod-security.kubernetes.io/enforce=privileged</pre></li><li class="listitem"><p class="simpara">
							Obtain the SELinux profile usage string by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get selinuxprofile.security-profiles-operator.x-k8s.io/nginx-secure -n nginx-deploy -ojsonpath='{.status.usage}'</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">nginx-secure_nginx-deploy.process%</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Apply the output string in the workload manifest in the <code class="literal">.spec.containers[].securityContext.seLinuxOptions</code> attribute:
						</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Pod
metadata:
  name: nginx-secure
  namespace: nginx-deploy
spec:
  containers:
    - image: nginxinc/nginx-unprivileged:1.21
      name: nginx
      securityContext:
        seLinuxOptions:
          # NOTE: This uses an appropriate SELinux type
          type: nginx-secure_nginx-deploy.process</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								The SELinux <code class="literal">type</code> must exist before creating the workload.
							</p></div></div></li></ol></div><section class="section" id="spo-selinux-permissive_spo-selinux"><div class="titlepage"><div><div><h4 class="title">7.6.2.1. Applying SELinux log policies</h4></div></div></div><p>
						To log policy violations or AVC denials, set the <code class="literal">SElinuxProfile</code> profile to <code class="literal">permissive</code>.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							This procedure defines logging policies. It does not set enforcement policies.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Add <code class="literal">permissive: true</code> to an <code class="literal">SElinuxProfile</code>:
							</p><pre class="programlisting language-yaml">apiVersion: security-profiles-operator.x-k8s.io/v1alpha2
kind: SelinuxProfile
metadata:
  name: nginx-secure
  namespace: nginx-deploy
spec:
  permissive: true</pre></li></ul></div></section><section class="section" id="spo-binding-workloads_spo-selinux"><div class="titlepage"><div><div><h4 class="title">7.6.2.2. Binding workloads to profiles with ProfileBindings</h4></div></div></div><p>
						You can use the <code class="literal">ProfileBinding</code> resource to bind a security profile to the <code class="literal">SecurityContext</code> of a container.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To bind a pod that uses a <code class="literal">quay.io/security-profiles-operator/test-nginx-unprivileged:1.21</code> image to the example <code class="literal">SelinuxProfile</code> profile, create a <code class="literal">ProfileBinding</code> object in the same namespace with the pod and the <code class="literal">SelinuxProfile</code> objects:
							</p><pre class="programlisting language-yaml">apiVersion: security-profiles-operator.x-k8s.io/v1alpha1
kind: ProfileBinding
metadata:
  namespace: my-namespace
  name: nginx-binding
spec:
  profileRef:
    kind: SelinuxProfile <span id="CO46-1"><!--Empty--></span><span class="callout">1</span>
    name: profile <span id="CO46-2"><!--Empty--></span><span class="callout">2</span>
  image: quay.io/security-profiles-operator/test-nginx-unprivileged:1.21</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO46-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										The <code class="literal">kind:</code> variable refers to the name of the profile.
									</div></dd><dt><a href="#CO46-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										The <code class="literal">name:</code> variable refers to the name of the profile.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Label the namespace with <code class="literal">enable-binding=true</code> by running the following command:
							</p><pre class="programlisting language-terminal">$ oc label ns my-namespace spo.x-k8s.io/enable-binding=true</pre></li><li class="listitem"><p class="simpara">
								Delete and re-create the pod to use the <code class="literal">ProfileBinding</code> object:
							</p><pre class="programlisting language-terminal">$ oc delete pods test-pod &amp;&amp; oc create -f pod01.yaml</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Confirm the pod inherits the <code class="literal">ProfileBinding</code> by running the following command:
							</p><pre class="programlisting language-terminal">$ oc get pod test-pod -o jsonpath='{.spec.containers[*].securityContext.seLinuxOptions.type}'</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">profile_nginx-binding.process</pre>

								</p></div></li></ul></div></section><section class="section" id="spo-replicating-controllers_spo-selinux"><div class="titlepage"><div><div><h4 class="title">7.6.2.3. Replicating controllers and SecurityContextConstraints</h4></div></div></div><p>
						When deploying SELinux policies for replicating controllers, such as deployments or daemon sets, note that the <code class="literal">Pod</code> objects spawned by the controllers are not running with the identity of the user who creates the workload. Unless a <code class="literal">ServiceAccount</code> is selected, the pods might revert to using a restricted <code class="literal">SecurityContextConstraints</code> (SCC) which does not allow use of custom security policies.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create the following <code class="literal">RoleBinding</code> object to allow SELinux policies to be used in the <code class="literal">nginx-secure</code> namespace:
							</p><pre class="programlisting language-yaml">kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: spo-use-seccomp-scc
  namespace: nginx-secure
subjects:
- kind: ServiceAccount
  name: spo-deploy-test
roleRef:
  kind: Role
  name: spo-use-seccomp-scc
  apiGroup: rbac.authorization.k8s.io</pre></li><li class="listitem"><p class="simpara">
								Create the <code class="literal">Role</code> object:
							</p><pre class="programlisting language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  creationTimestamp: null
  name: spo-use-seccomp-scc
  namespace: nginx-secure
rules:
- apiGroups:
  - security.openshift.io
  resources:
  - securitycontextconstraints
  resourceNames:
  - privileged
  verbs:
  - use</pre></li><li class="listitem"><p class="simpara">
								Create the <code class="literal">ServiceAccount</code> object:
							</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ServiceAccount
metadata:
  creationTimestamp: null
  name: spo-deploy-test
  namespace: nginx-secure</pre></li><li class="listitem"><p class="simpara">
								Create the <code class="literal">Deployment</code> object:
							</p><pre class="programlisting language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: selinux-test
  namespace: nginx-secure
  metadata:
    labels:
      app: selinux-test
spec:
  replicas: 3
  selector:
    matchLabels:
      app: selinux-test
  template:
    metadata:
      labels:
        app: selinux-test
    spec:
      serviceAccountName: spo-deploy-test
      securityContext:
        seLinuxOptions:
          type: nginx-secure_nginx-secure.process <span id="CO47-1"><!--Empty--></span><span class="callout">1</span>
      containers:
      - name: nginx-unpriv
        image: quay.io/security-profiles-operator/test-nginx-unprivileged:1.21
        ports:
        - containerPort: 8080</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO47-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										The <code class="literal">.seLinuxOptions.type</code> must exist before the Deployment is created.
									</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The SELinux type is not specified in the workload and is handled by the SCC. When the pods are created by the deployment and the <code class="literal">ReplicaSet</code>, the pods will run with the appropriate profile.
								</p></div></div></li></ol></div><p>
						Ensure your SCC is only usable by the correct service account. Refer to <span class="emphasis"><em>Additional resources</em></span> for more information.
					</p></section></section><section class="section" id="spo-recording-profiles_spo-selinux"><div class="titlepage"><div><div><h3 class="title">7.6.3. Recording profiles from workloads</h3></div></div></div><p>
					The Security Profiles Operator can record system calls with <code class="literal">ProfileRecording</code> objects, making it easier to create baseline profiles for applications.
				</p><p>
					When using the log enricher for recording SELinux profiles, verify the log enricher feature is enabled. See <span class="emphasis"><em>Additional resources</em></span> for more information.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						A container with <code class="literal">privileged: true</code> security context restraints prevents log-based recording. Privileged containers are not subject to SELinux policies, and log-based recording makes use of a special SELinux profile to record events.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Label the namespace with <code class="literal">enable-recording=true</code> by running the following command:
						</p><pre class="programlisting language-terminal">$ oc label ns my-namespace spo.x-k8s.io/enable-recording=true</pre></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">ProfileRecording</code> object containing a <code class="literal">recorder: logs</code> variable:
						</p><pre class="programlisting language-yaml">apiVersion: security-profiles-operator.x-k8s.io/v1alpha1
kind: ProfileRecording
metadata:
  name: test-recording
spec:
  kind: SelinuxProfile
  recorder: logs
  podSelector:
    matchLabels:
      app: my-app</pre></li><li class="listitem"><p class="simpara">
							Create a workload to record:
						</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Pod
metadata:
  name: my-pod
  labels:
    app: my-app
spec:
  containers:
    - name: nginx
      image: quay.io/security-profiles-operator/test-nginx-unprivileged:1.21
      ports:
        - containerPort: 8080
    - name: redis
      image: quay.io/security-profiles-operator/redis:6.2.1</pre></li><li class="listitem"><p class="simpara">
							Confirm the pod is in a <code class="literal">Running</code> state by entering the following command:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles get pods</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME     READY   STATUS    RESTARTS   AGE
my-pod   2/2     Running   0          18s</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Confirm the enricher indicates that it receives audit logs for those containers:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles logs --since=1m --selector name=spod -c log-enricher</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">I0517 13:55:36.383187  348295 enricher.go:376] log-enricher "msg"="audit" "container"="redis" "namespace"="my-namespace" "node"="ip-10-0-189-53.us-east-2.compute.internal" "perm"="name_bind" "pod"="my-pod" "profile"="test-recording_redis_6kmrb_1684331729" "scontext"="system_u:system_r:selinuxrecording.process:s0:c4,c27" "tclass"="tcp_socket" "tcontext"="system_u:object_r:redis_port_t:s0" "timestamp"="1684331735.105:273965" "type"="SELinux"</pre>

							</p></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Remove the pod:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles delete pod my-pod</pre></li><li class="listitem"><p class="simpara">
							Confirm the Security Profiles Operator reconciles the two SELinux profiles:
						</p><pre class="programlisting language-terminal">$ oc get selinuxprofiles -n my-namespace</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                   USAGE                                       STATE
test-recording-nginx   test-recording-nginx_my-namespace.process   Installed
test-recording-redis   test-recording-redis_my-namespace.process   Installed</pre>

							</p></div></li></ol></div><section class="section" id="spo-container-profile-instances_spo-selinux"><div class="titlepage"><div><div><h4 class="title">7.6.3.1. Merging per-container profile instances</h4></div></div></div><p>
						By default, each container instance records into a separate profile. The Security Profiles Operator can merge the per-container profiles into a single profile. Merging profiles is useful when deploying applications using <code class="literal">ReplicaSet</code> or <code class="literal">Deployment</code> objects.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Edit a <code class="literal">ProfileRecording</code> object to include a <code class="literal">mergeStrategy: containers</code> variable:
							</p><pre class="programlisting language-yaml">apiVersion: security-profiles-operator.x-k8s.io/v1alpha1
kind: ProfileRecording
metadata:
  # The name of the Recording is the same as the resulting SelinuxProfile CRD
  # after reconciliation.
  name: test-recording
spec:
  kind: SelinuxProfile
  recorder: logs
  mergeStrategy: containers
  podSelector:
    matchLabels:
      app: sp-record</pre></li><li class="listitem"><p class="simpara">
								Create the workload:
							</p><pre class="programlisting language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deploy
spec:
  replicas: 3
  selector:
    matchLabels:
      app: sp-record
  template:
    metadata:
      labels:
        app: sp-record
    spec:
      serviceAccountName: spo-record-sa
      containers:
      - name: nginx-record
        image: quay.io/security-profiles-operator/test-nginx-unprivileged:1.21
        ports:
        - containerPort: 8080</pre></li><li class="listitem"><p class="simpara">
								To record the individual profiles, delete the deployment by running the following command:
							</p><pre class="programlisting language-terminal">$ oc delete deployment nginx-deploy</pre></li><li class="listitem"><p class="simpara">
								To merge the profiles, delete the profile recording by running the following command:
							</p><pre class="programlisting language-terminal">$ oc delete profilerecording test-recording</pre></li><li class="listitem"><p class="simpara">
								To start the merge operation and generate the results profile, run the following command:
							</p><pre class="programlisting language-terminal">$ oc get selinuxprofiles -lspo.x-k8s.io/recording-id=test-recording</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                          USAGE                                         STATE
test-recording-nginx-record   test-recording-nginx-record_mytest1.process   Installed</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								To view the permissions used by any of the containers, run the following command:
							</p><pre class="programlisting language-terminal">$ oc get selinuxprofiles test-recording-nginx-record -o yaml</pre></li></ol></div></section><section class="section" id="spo-selinux-runasany_spo-selinux"><div class="titlepage"><div><div><h4 class="title">7.6.3.2. About seLinuxContext: RunAsAny</h4></div></div></div><p>
						Recording of SELinux policies is implemented with a webhook that injects a special SELinux type to the pods being recorded. The SELinux type makes the pod run in <code class="literal">permissive</code> mode, logging all the AVC denials into <code class="literal">audit.log</code>. By default, a workload is not allowed to run with a custom SELinux policy, but uses an auto-generated type.
					</p><p>
						To record a workload, the workload must use a service account that has permissions to use an SCC that allows the webhook to inject the permissive SELinux type. The <code class="literal">privileged</code> SCC contains <code class="literal">seLinuxContext: RunAsAny</code>.
					</p><p>
						In addition, the namespace must be labeled with <code class="literal">pod-security.kubernetes.io/enforce: privileged</code> if your cluster enables the <a class="link" href="https://kubernetes.io/docs/concepts/security/pod-security-admission/">Pod Security Admission</a> because only the <code class="literal">privileged</code> <a class="link" href="https://kubernetes.io/docs/concepts/security/pod-security-standards/#privileged">Pod Security Standard</a> allows using a custom SELinux policy.
					</p><h4 id="additional-resources_spo-selinux">Additional resources</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#managing-security-context-constraints">Managing security context constraints</a>
							</li><li class="listitem">
								<a class="link" href="https://cloud.redhat.com/blog/managing-sccs-in-openshift">Managing SCCs in OpenShift</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-log-enricher_spo-advanced">Using the log enricher</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#spo-about_spo-understanding">About security profiles</a>
							</li></ul></div></section></section></section><section class="section" id="spo-advanced"><div class="titlepage"><div><div><h2 class="title">7.7. Advanced Security Profiles Operator tasks</h2></div></div></div><p>
				Use advanced tasks to enable metrics, configure webhooks, or restrict syscalls.
			</p><section class="section" id="spo-restrict-syscalls_spo-advanced"><div class="titlepage"><div><div><h3 class="title">7.7.1. Restrict the allowed syscalls in seccomp profiles</h3></div></div></div><p>
					The Security Profiles Operator does not restrict <code class="literal">syscalls</code> in <code class="literal">seccomp</code> profiles by default. You can define the list of allowed <code class="literal">syscalls</code> in the <code class="literal">spod</code> configuration.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To define the list of <code class="literal">allowedSyscalls</code>, adjust the <code class="literal">spec</code> parameter by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles patch spod spod --type merge \
    -p '{"spec":{"allowedSyscalls": ["exit", "exit_group", "futex", "nanosleep"]}}'</pre></li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The Operator will install only the <code class="literal">seccomp</code> profiles, which have a subset of <code class="literal">syscalls</code> defined into the allowed list. All profiles not complying with this ruleset are rejected.
					</p><p>
						When the list of allowed <code class="literal">syscalls</code> is modified in the <code class="literal">spod</code> configuration, the Operator will identify the already installed profiles which are non-compliant and remove them automatically.
					</p></div></div></section><section class="section" id="spo-base-syscalls_spo-advanced"><div class="titlepage"><div><div><h3 class="title">7.7.2. Base syscalls for a container runtime</h3></div></div></div><p>
					You can use the <code class="literal">baseProfileName</code> attribute to establish the minimum required <code class="literal">syscalls</code> for a given runtime to start a container.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">SeccompProfile</code> kind object and add <code class="literal">baseProfileName: runc-v1.0.0</code> to the <code class="literal">spec</code> field:
						</p><pre class="programlisting language-yaml">apiVersion: security-profiles-operator.x-k8s.io/v1beta1
kind: SeccompProfile
metadata:
  namespace: my-namespace
  name: example-name
spec:
  defaultAction: SCMP_ACT_ERRNO
  baseProfileName: runc-v1.0.0
  syscalls:
    - action: SCMP_ACT_ALLOW
      names:
        - exit_group</pre></li></ul></div></section><section class="section" id="spo-memory-optimization_spo-advanced"><div class="titlepage"><div><div><h3 class="title">7.7.3. Enabling memory optimization in the spod daemon</h3></div></div></div><p>
					The controller running inside of <code class="literal">spod</code> daemon process watches all pods available in the cluster when profile recording is enabled. This can lead to very high memory usage in large clusters, resulting in the <code class="literal">spod</code> daemon running out of memory or crashing.
				</p><p>
					To prevent crashes, the <code class="literal">spod</code> daemon can be configured to only load the pods labeled for profile recording into the cache memory.
				</p><p>
					+
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						SPO memory optimization is not enabled by default.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Enable memory optimization by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles patch spod spod --type=merge -p '{"spec":{"enableMemoryOptimization":true}}'</pre></li><li class="listitem"><p class="simpara">
							To record a security profile for a pod, the pod must be labeled with <code class="literal">spo.x-k8s.io/enable-recording: "true"</code>:
						</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Pod
metadata:
  name: my-recording-pod
  labels:
    spo.x-k8s.io/enable-recording: "true"</pre></li></ol></div></section><section class="section" id="spo-daemon-requirements_spo-advanced"><div class="titlepage"><div><div><h3 class="title">7.7.4. Customizing daemon resource requirements</h3></div></div></div><p>
					The default resource requirements of the daemon container can be adjusted by using the field <code class="literal">daemonResourceRequirements</code> from the <code class="literal">spod</code> configuration.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To specify the memory and cpu requests and limits of the daemon container, run the following command:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles patch spod spod --type merge -p \
    '{"spec":{"daemonResourceRequirements": { \
    "requests": {"memory": "256Mi", "cpu": "250m"}, \
    "limits": {"memory": "512Mi", "cpu": "500m"}}}}'</pre></li></ul></div></section><section class="section" id="spo-custom-priority-class_spo-advanced"><div class="titlepage"><div><div><h3 class="title">7.7.5. Setting a custom priority class name for the spod daemon pod</h3></div></div></div><p>
					The default priority class name of the <code class="literal">spod</code> daemon pod is set to <code class="literal">system-node-critical</code>. A custom priority class name can be configured in the <code class="literal">spod</code> configuration by setting a value in the <code class="literal">priorityClassName</code> field.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Configure the priority class name by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles patch spod spod --type=merge -p '{"spec":{"priorityClassName":"my-priority-class"}}'</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">securityprofilesoperatordaemon.openshift-security-profiles.x-k8s.io/spod patched</pre>

							</p></div></li></ul></div></section><section class="section" id="spo-using-metrics_spo-advanced"><div class="titlepage"><div><div><h3 class="title">7.7.6. Using metrics</h3></div></div></div><p>
					The <code class="literal">openshift-security-profiles</code> namespace provides metrics endpoints, which are secured by the <a class="link" href="https://github.com/brancz/kube-rbac-proxy">kube-rbac-proxy</a> container. All metrics are exposed by the <code class="literal">metrics</code> service within the <code class="literal">openshift-security-profiles</code> namespace.
				</p><p>
					The Security Profiles Operator includes a cluster role and corresponding binding <code class="literal">spo-metrics-client</code> to retrieve the metrics from within the cluster. There are two metrics paths available:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">metrics.openshift-security-profiles/metrics</code>: for controller runtime metrics
						</li><li class="listitem">
							<code class="literal">metrics.openshift-security-profiles/metrics-spod</code>: for the Operator daemon metrics
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To view the status of the metrics service, run the following command:
						</p><pre class="programlisting language-terminal">$ oc get svc/metrics -n openshift-security-profiles</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME      TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE
metrics   ClusterIP   10.0.0.228   &lt;none&gt;        443/TCP   43s</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							To retrieve the metrics, query the service endpoint using the default <code class="literal">ServiceAccount</code> token in the <code class="literal">openshift-security-profiles</code> namespace by running the following command:
						</p><pre class="programlisting language-terminal">$ oc run --rm -i --restart=Never --image=registry.fedoraproject.org/fedora-minimal:latest \
    -n openshift-security-profiles metrics-test -- bash -c \
    'curl -ks -H "Authorization: Bearer $(cat /var/run/secrets/kubernetes.io/serviceaccount/token)" https://metrics.openshift-security-profiles/metrics-spod'</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal"># HELP security_profiles_operator_seccomp_profile_total Counter about seccomp profile operations.
# TYPE security_profiles_operator_seccomp_profile_total counter
security_profiles_operator_seccomp_profile_total{operation="delete"} 1
security_profiles_operator_seccomp_profile_total{operation="update"} 2</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							To retrieve metrics from a different namespace, link the <code class="literal">ServiceAccount</code> to the <code class="literal">spo-metrics-client</code> <code class="literal">ClusterRoleBinding</code> by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get clusterrolebinding spo-metrics-client -o wide</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                 ROLE                             AGE   USERS   GROUPS   SERVICEACCOUNTS
spo-metrics-client   ClusterRole/spo-metrics-client   35m                    openshift-security-profiles/default</pre>

							</p></div></li></ol></div><section class="section" id="spo-runtime-metrics_spo-advanced"><div class="titlepage"><div><div><h4 class="title">7.7.6.1. controller-runtime metrics</h4></div></div></div><p>
						The controller-runtime <code class="literal">metrics</code> and the DaemonSet endpoint <code class="literal">metrics-spod</code> provide a set of default metrics. Additional metrics are provided by the daemon, which are always prefixed with <code class="literal">security_profiles_operator_</code>.
					</p><div class="table" id="idm139961120586000"><p class="title"><strong>Table 7.1. Available controller-runtime metrics</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139961123547728" scope="col">Metric key</th><th align="left" valign="top" id="idm139961123546640" scope="col">Possible labels</th><th align="left" valign="top" id="idm139961123545552" scope="col">Type</th><th align="left" valign="top" id="idm139961123544464" scope="col">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139961123547728"> <p>
										<code class="literal">seccomp_profile_total</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139961123546640"> <p>
										<code class="literal">operation={delete,update}</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139961123545552"> <p>
										Counter
									</p>
									 </td><td align="left" valign="top" headers="idm139961123544464"> <p>
										Amount of seccomp profile operations.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961123547728"> <p>
										<code class="literal">seccomp_profile_audit_total</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139961123546640"> <p>
										<code class="literal">node</code>, <code class="literal">namespace</code>, <code class="literal">pod</code>, <code class="literal">container</code>, <code class="literal">executable</code>, <code class="literal">syscall</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139961123545552"> <p>
										Counter
									</p>
									 </td><td align="left" valign="top" headers="idm139961123544464"> <p>
										Amount of seccomp profile audit operations. Requires the log enricher to be enabled.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961123547728"> <p>
										<code class="literal">seccomp_profile_bpf_total</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139961123546640"> <p>
										<code class="literal">node</code>, <code class="literal">mount_namespace</code>, <code class="literal">profile</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139961123545552"> <p>
										Counter
									</p>
									 </td><td align="left" valign="top" headers="idm139961123544464"> <p>
										Amount of seccomp profile bpf operations. Requires the bpf recorder to be enabled.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961123547728"> <p>
										<code class="literal">seccomp_profile_error_total</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139961123546640"> <p>
										<code class="literal">reason={</code><br/><code class="literal">SeccompNotSupportedOnNode,</code><br/><code class="literal">InvalidSeccompProfile,</code><br/><code class="literal">CannotSaveSeccompProfile,</code><br/><code class="literal">CannotRemoveSeccompProfile,</code><br/><code class="literal">CannotUpdateSeccompProfile,</code><br/><code class="literal">CannotUpdateNodeStatus</code><br/><code class="literal">}</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139961123545552"> <p>
										Counter
									</p>
									 </td><td align="left" valign="top" headers="idm139961123544464"> <p>
										Amount of seccomp profile errors.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961123547728"> <p>
										<code class="literal">selinux_profile_total</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139961123546640"> <p>
										<code class="literal">operation={delete,update}</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139961123545552"> <p>
										Counter
									</p>
									 </td><td align="left" valign="top" headers="idm139961123544464"> <p>
										Amount of SELinux profile operations.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961123547728"> <p>
										<code class="literal">selinux_profile_audit_total</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139961123546640"> <p>
										<code class="literal">node</code>, <code class="literal">namespace</code>, <code class="literal">pod</code>, <code class="literal">container</code>, <code class="literal">executable</code>, <code class="literal">scontext</code>,<code class="literal">tcontext</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139961123545552"> <p>
										Counter
									</p>
									 </td><td align="left" valign="top" headers="idm139961123544464"> <p>
										Amount of SELinux profile audit operations. Requires the log enricher to be enabled.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139961123547728"> <p>
										<code class="literal">selinux_profile_error_total</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139961123546640"> <p>
										<code class="literal">reason={</code><br/><code class="literal">CannotSaveSelinuxPolicy,</code><br/><code class="literal">CannotUpdatePolicyStatus,</code><br/><code class="literal">CannotRemoveSelinuxPolicy,</code><br/><code class="literal">CannotContactSelinuxd,</code><br/><code class="literal">CannotWritePolicyFile,</code><br/><code class="literal">CannotGetPolicyStatus</code><br/><code class="literal">}</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139961123545552"> <p>
										Counter
									</p>
									 </td><td align="left" valign="top" headers="idm139961123544464"> <p>
										Amount of SELinux profile errors.
									</p>
									 </td></tr></tbody></table></div></div></section></section><section class="section" id="spo-log-enricher_spo-advanced"><div class="titlepage"><div><div><h3 class="title">7.7.7. Using the log enricher</h3></div></div></div><p>
					The Security Profiles Operator contains a log enrichment feature, which is disabled by default. The log enricher container runs with <code class="literal">privileged</code> permissions to read the audit logs from the local node. The log enricher runs within the host PID namespace, <code class="literal">hostPID</code>.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The log enricher must have permissions to read the host processes.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Patch the <code class="literal">spod</code> configuration to enable the log enricher by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles patch spod spod \
    --type=merge -p '{"spec":{"enableLogEnricher":true}}'</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">securityprofilesoperatordaemon.security-profiles-operator.x-k8s.io/spod patched</pre>

							</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The Security Profiles Operator will re-deploy the <code class="literal">spod</code> daemon set automatically.
							</p></div></div></li><li class="listitem"><p class="simpara">
							View the audit logs by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles logs -f ds/spod log-enricher</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">I0623 12:51:04.257814 1854764 deleg.go:130] setup "msg"="starting component: log-enricher"  "buildDate"="1980-01-01T00:00:00Z" "compiler"="gc" "gitCommit"="unknown" "gitTreeState"="clean" "goVersion"="go1.16.2" "platform"="linux/amd64" "version"="0.4.0-dev"
I0623 12:51:04.257890 1854764 enricher.go:44] log-enricher "msg"="Starting log-enricher on node: 127.0.0.1"
I0623 12:51:04.257898 1854764 enricher.go:46] log-enricher "msg"="Connecting to local GRPC server"
I0623 12:51:04.258061 1854764 enricher.go:69] log-enricher "msg"="Reading from file /var/log/audit/audit.log"
2021/06/23 12:51:04 Seeked /var/log/audit/audit.log - &amp;{Offset:0 Whence:2}</pre>

							</p></div></li></ol></div><section class="section" id="spo-log-enricher-app-trace_spo-advanced"><div class="titlepage"><div><div><h4 class="title">7.7.7.1. Using the log enricher to trace an application</h4></div></div></div><p>
						You can use the Security Profiles Operator log enricher to trace an application.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To trace an application, create a <code class="literal">SeccompProfile</code> logging profile:
							</p><pre class="programlisting language-yaml">apiVersion: security-profiles-operator.x-k8s.io/v1beta1
kind: SeccompProfile
metadata:
  name: log
  namespace: default
spec:
  defaultAction: SCMP_ACT_LOG</pre></li><li class="listitem"><p class="simpara">
								Create a pod object to use the profile:
							</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Pod
metadata:
  name: log-pod
spec:
  securityContext:
    seccompProfile:
      type: Localhost
      localhostProfile: operator/default/log.json
  containers:
    - name: log-container
      image: quay.io/security-profiles-operator/test-nginx-unprivileged:1.21</pre></li><li class="listitem"><p class="simpara">
								Examine the log enricher output by running the following command:
							</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles logs -f ds/spod log-enricher</pre><div class="example" id="idm139961121160064"><p class="title"><strong>Example 7.1. Example output</strong></p><div class="example-contents"><pre class="programlisting language-terminal">…
I0623 12:59:11.479869 1854764 enricher.go:111] log-enricher "msg"="audit"  "container"="log-container" "executable"="/" "namespace"="default" "node"="127.0.0.1" "pid"=1905792 "pod"="log-pod" "syscallID"=3 "syscallName"="close" "timestamp"="1624453150.205:1061" "type"="seccomp"
I0623 12:59:11.487323 1854764 enricher.go:111] log-enricher "msg"="audit"  "container"="log-container" "executable"="/" "namespace"="default" "node"="127.0.0.1" "pid"=1905792 "pod"="log-pod" "syscallID"=157 "syscallName"="prctl" "timestamp"="1624453150.205:1062" "type"="seccomp"
I0623 12:59:11.492157 1854764 enricher.go:111] log-enricher "msg"="audit"  "container"="log-container" "executable"="/" "namespace"="default" "node"="127.0.0.1" "pid"=1905792 "pod"="log-pod" "syscallID"=157 "syscallName"="prctl" "timestamp"="1624453150.205:1063" "type"="seccomp"
…
I0623 12:59:20.258523 1854764 enricher.go:111] log-enricher "msg"="audit"  "container"="log-container" "executable"="/usr/sbin/nginx" "namespace"="default" "node"="127.0.0.1" "pid"=1905792 "pod"="log-pod" "syscallID"=12 "syscallName"="brk" "timestamp"="1624453150.235:2873" "type"="seccomp"
I0623 12:59:20.263349 1854764 enricher.go:111] log-enricher "msg"="audit"  "container"="log-container" "executable"="/usr/sbin/nginx" "namespace"="default" "node"="127.0.0.1" "pid"=1905792 "pod"="log-pod" "syscallID"=21 "syscallName"="access" "timestamp"="1624453150.235:2874" "type"="seccomp"
I0623 12:59:20.354091 1854764 enricher.go:111] log-enricher "msg"="audit"  "container"="log-container" "executable"="/usr/sbin/nginx" "namespace"="default" "node"="127.0.0.1" "pid"=1905792 "pod"="log-pod" "syscallID"=257 "syscallName"="openat" "timestamp"="1624453150.235:2875" "type"="seccomp"
I0623 12:59:20.358844 1854764 enricher.go:111] log-enricher "msg"="audit"  "container"="log-container" "executable"="/usr/sbin/nginx" "namespace"="default" "node"="127.0.0.1" "pid"=1905792 "pod"="log-pod" "syscallID"=5 "syscallName"="fstat" "timestamp"="1624453150.235:2876" "type"="seccomp"
I0623 12:59:20.363510 1854764 enricher.go:111] log-enricher "msg"="audit"  "container"="log-container" "executable"="/usr/sbin/nginx" "namespace"="default" "node"="127.0.0.1" "pid"=1905792 "pod"="log-pod" "syscallID"=9 "syscallName"="mmap" "timestamp"="1624453150.235:2877" "type"="seccomp"
I0623 12:59:20.454127 1854764 enricher.go:111] log-enricher "msg"="audit"  "container"="log-container" "executable"="/usr/sbin/nginx" "namespace"="default" "node"="127.0.0.1" "pid"=1905792 "pod"="log-pod" "syscallID"=3 "syscallName"="close" "timestamp"="1624453150.235:2878" "type"="seccomp"
I0623 12:59:20.458654 1854764 enricher.go:111] log-enricher "msg"="audit"  "container"="log-container" "executable"="/usr/sbin/nginx" "namespace"="default" "node"="127.0.0.1" "pid"=1905792 "pod"="log-pod" "syscallID"=257 "syscallName"="openat" "timestamp"="1624453150.235:2879" "type"="seccomp"
…</pre></div></div></li></ol></div></section></section><section class="section" id="spo-configuring-webhooks_spo-advanced"><div class="titlepage"><div><div><h3 class="title">7.7.8. Configuring webhooks</h3></div></div></div><p>
					Profile binding and profile recording objects can use webhooks. Profile binding and recording object configurations are <code class="literal">MutatingWebhookConfiguration</code> CRs, managed by the Security Profiles Operator.
				</p><p>
					To change the webhook configuration, the <code class="literal">spod</code> CR exposes a <code class="literal">webhookOptions</code> field that allows modification of the <code class="literal">failurePolicy</code>, <code class="literal">namespaceSelector</code>, and <code class="literal">objectSelector</code> variables. This allows you to set the webhooks to "soft-fail" or restrict them to a subset of a namespaces so that even if the webhooks failed, other namespaces or resources are not affected.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Set the <code class="literal">recording.spo.io</code> webhook configuration to record only pods labeled with <code class="literal">spo-record=true</code> by creating the following patch file:
						</p><pre class="programlisting language-yaml">spec:
  webhookOptions:
    - name: recording.spo.io
      objectSelector:
        matchExpressions:
          - key: spo-record
            operator: In
            values:
              - "true"</pre></li><li class="listitem"><p class="simpara">
							Patch the <code class="literal">spod/spod</code> instance by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles patch spod \
    spod -p $(cat /tmp/spod-wh.patch) --type=merge</pre></li><li class="listitem"><p class="simpara">
							To view the resulting <code class="literal">MutatingWebhookConfiguration</code> object, run the following command:
						</p><pre class="programlisting language-terminal">$ oc get MutatingWebhookConfiguration \
    spo-mutating-webhook-configuration -oyaml</pre></li></ol></div></section></section><section class="section" id="spo-troubleshooting"><div class="titlepage"><div><div><h2 class="title">7.8. Troubleshooting the Security Profiles Operator</h2></div></div></div><p>
				Troubleshoot the Security Profiles Operator to diagnose a problem or provide information in a bug report.
			</p><section class="section" id="spo-inspecting-seccomp-profiles_spo-troubleshooting"><div class="titlepage"><div><div><h3 class="title">7.8.1. Inspecting seccomp profiles</h3></div></div></div><p>
					Corrupted <code class="literal">seccomp</code> profiles can disrupt your workloads. Ensure that the user cannot abuse the system by not allowing other workloads to map any part of the path <code class="literal">/var/lib/kubelet/seccomp/operator</code>.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Confirm that the profile is reconciled by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-security-profiles logs openshift-security-profiles-&lt;id&gt;</pre><div class="example" id="idm139961124257728"><p class="title"><strong>Example 7.2. Example output</strong></p><div class="example-contents"><pre class="programlisting language-terminal">I1019 19:34:14.942464       1 main.go:90] setup "msg"="starting openshift-security-profiles"  "buildDate"="2020-10-19T19:31:24Z" "compiler"="gc" "gitCommit"="a3ef0e1ea6405092268c18f240b62015c247dd9d" "gitTreeState"="dirty" "goVersion"="go1.15.1" "platform"="linux/amd64" "version"="0.2.0-dev"
I1019 19:34:15.348389       1 listener.go:44] controller-runtime/metrics "msg"="metrics server is starting to listen"  "addr"=":8080"
I1019 19:34:15.349076       1 main.go:126] setup "msg"="starting manager"
I1019 19:34:15.349449       1 internal.go:391] controller-runtime/manager "msg"="starting metrics server"  "path"="/metrics"
I1019 19:34:15.350201       1 controller.go:142] controller "msg"="Starting EventSource" "controller"="profile" "reconcilerGroup"="security-profiles-operator.x-k8s.io" "reconcilerKind"="SeccompProfile" "source"={"Type":{"metadata":{"creationTimestamp":null},"spec":{"defaultAction":""}}}
I1019 19:34:15.450674       1 controller.go:149] controller "msg"="Starting Controller" "controller"="profile" "reconcilerGroup"="security-profiles-operator.x-k8s.io" "reconcilerKind"="SeccompProfile"
I1019 19:34:15.450757       1 controller.go:176] controller "msg"="Starting workers" "controller"="profile" "reconcilerGroup"="security-profiles-operator.x-k8s.io" "reconcilerKind"="SeccompProfile" "worker count"=1
I1019 19:34:15.453102       1 profile.go:148] profile "msg"="Reconciled profile from SeccompProfile" "namespace"="openshift-security-profiles" "profile"="nginx-1.19.1" "name"="nginx-1.19.1" "resource version"="728"
I1019 19:34:15.453618       1 profile.go:148] profile "msg"="Reconciled profile from SeccompProfile" "namespace"="openshift-security-profiles" "profile"="openshift-security-profiles" "name"="openshift-security-profiles" "resource version"="729"</pre></div></div></li><li class="listitem"><p class="simpara">
							Confirm that the <code class="literal">seccomp</code> profiles are saved into the correct path by running the following command:
						</p><pre class="programlisting language-terminal">$ oc exec -t -n openshift-security-profiles openshift-security-profiles-&lt;id&gt; \
    -- ls /var/lib/kubelet/seccomp/operator/my-namespace/my-workload</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">profile-block.json
profile-complain.json</pre>

							</p></div></li></ol></div></section></section><section class="section" id="spo-uninstalling"><div class="titlepage"><div><div><h2 class="title">7.9. Uninstalling the Security Profiles Operator</h2></div></div></div><p>
				You can remove the Security Profiles Operator from your cluster by using the OpenShift Container Platform web console.
			</p><section class="section" id="spo-uninstall-console_spo-uninstalling"><div class="titlepage"><div><div><h3 class="title">7.9.1. Uninstall the Security Profiles Operator using the web console</h3></div></div></div><p>
					To remove the Security Profiles Operator, you must first delete the <code class="literal">seccomp</code> and SELinux profiles. After the profiles are removed, you can then remove the Operator and its namespace by deleting the <span class="strong strong"><strong>openshift-security-profiles</strong></span> project.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Access to an OpenShift Container Platform cluster that uses an account with <code class="literal">cluster-admin</code> permissions.
						</li><li class="listitem">
							The Security Profiles Operator is installed.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						To remove the Security Profiles Operator by using the OpenShift Container Platform web console:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> page.
						</li><li class="listitem">
							Delete all <code class="literal">seccomp</code> profiles, SELinux profiles, and webhook configurations.
						</li><li class="listitem">
							Switch to the <span class="strong strong"><strong>Administration</strong></span> → <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> page.
						</li><li class="listitem">
							Click the Options menu 
							<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
							 on the <span class="strong strong"><strong>Security Profiles Operator</strong></span> entry and select <span class="strong strong"><strong>Uninstall Operator</strong></span>.
						</li><li class="listitem">
							Switch to the <span class="strong strong"><strong>Home</strong></span> → <span class="strong strong"><strong>Projects</strong></span> page.
						</li><li class="listitem">
							Search for <code class="literal">security profiles</code>.
						</li><li class="listitem"><p class="simpara">
							Click the Options menu 
							<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
							 next to the <span class="strong strong"><strong>openshift-security-profiles</strong></span> project, and select <span class="strong strong"><strong>Delete Project</strong></span>.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Confirm the deletion by typing <code class="literal">openshift-security-profiles</code> in the dialog box, and click <span class="strong strong"><strong>Delete</strong></span>.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Delete the <code class="literal">MutatingWebhookConfiguration</code> object by running the following command:
						</p><pre class="programlisting language-terminal">$ oc delete MutatingWebhookConfiguration spo-mutating-webhook-configuration</pre></li></ol></div></section></section></section><section class="chapter" id="cert-manager-operator-for-red-hat-openshift"><div class="titlepage"><div><div><h1 class="title">Chapter 8. cert-manager Operator for Red Hat OpenShift</h1></div></div></div><section class="section" id="cert-manager-operator-about"><div class="titlepage"><div><div><h2 class="title">8.1. cert-manager Operator for Red Hat OpenShift overview</h2></div></div></div><p>
				The cert-manager Operator for Red Hat OpenShift is a cluster-wide service that provides application certificate lifecycle management. The cert-manager Operator for Red Hat OpenShift allows you to integrate with external certificate authorities and provides certificate provisioning, renewal, and retirement.
			</p><section class="section" id="cert-manager-about_cert-manager-operator-about"><div class="titlepage"><div><div><h3 class="title">8.1.1. About the cert-manager Operator for Red Hat OpenShift</h3></div></div></div><p>
					The <a class="link" href="https://cert-manager.io/">cert-manager</a> project introduces certificate authorities and certificates as resource types in the Kubernetes API, which makes it possible to provide certificates on demand to developers working within your cluster. The cert-manager Operator for Red Hat OpenShift provides a supported way to integrate cert-manager into your OpenShift Container Platform cluster.
				</p><p>
					The cert-manager Operator for Red Hat OpenShift provides the following features:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Support for integrating with external certificate authorities
						</li><li class="listitem">
							Tools to manage certificates
						</li><li class="listitem">
							Ability for developers to self-serve certificates
						</li><li class="listitem">
							Automatic certificate renewal
						</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Do not attempt to use more than one cert-manager Operator in your cluster. If you have a community cert-manager Operator installed in your cluster, you must uninstall it before installing the cert-manager Operator for Red Hat OpenShift.
					</p></div></div></section><section class="section" id="cert-manager-issuer-types_cert-manager-operator-about"><div class="titlepage"><div><div><h3 class="title">8.1.2. Supported issuer types</h3></div></div></div><p>
					The cert-manager Operator for Red Hat OpenShift supports the following issuer types:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Automated Certificate Management Environment (ACME)
						</li><li class="listitem">
							Certificate authority (CA)
						</li><li class="listitem">
							Self-signed
						</li><li class="listitem">
							<a class="link" href="https://cert-manager.io/docs/configuration/vault/">Vault</a>
						</li><li class="listitem">
							<a class="link" href="https://cert-manager.io/docs/configuration/venafi/">Venafi</a>
						</li></ul></div></section><section class="section" id="cert-manager-request-methods_cert-manager-operator-about"><div class="titlepage"><div><div><h3 class="title">8.1.3. Certificate request methods</h3></div></div></div><p>
					There are two ways to request a certificate using the cert-manager Operator for Red Hat OpenShift:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Using the <code class="literal">cert-manager.io/CertificateRequest</code> object</span></dt><dd>
								With this method a service developer creates a <code class="literal">CertificateRequest</code> object with a valid <code class="literal">issuerRef</code> pointing to a configured issuer (configured by a service infrastructure administrator). A service infrastructure administrator then accepts or denies the certificate request. Only accepted certificate requests create a corresponding certificate.
							</dd><dt><span class="term">Using the <code class="literal">cert-manager.io/Certificate</code> object</span></dt><dd>
								With this method, a service developer creates a <code class="literal">Certificate</code> object with a valid <code class="literal">issuerRef</code> and obtains a certificate from a secret that they pointed to the <code class="literal">Certificate</code> object.
							</dd></dl></div></section><section class="section _additional-resources" id="cert-manager-operator-about_additional-resources"><div class="titlepage"><div><div><h3 class="title">8.1.4. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://cert-manager.io/docs/">cert-manager project documentation</a>
						</li></ul></div></section></section><section class="section" id="cert-manager-operator-release-notes"><div class="titlepage"><div><div><h2 class="title">8.2. cert-manager Operator for Red Hat OpenShift release notes</h2></div></div></div><p>
				The cert-manager Operator for Red Hat OpenShift is a cluster-wide service that provides application certificate lifecycle management.
			</p><p>
				These release notes track the development of cert-manager Operator for Red Hat OpenShift.
			</p><p>
				For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-operator-about">About the cert-manager Operator for Red Hat OpenShift</a>.
			</p><section class="section" id="cert-manager-operator-release-notes-1.12.0"><div class="titlepage"><div><div><h3 class="title">8.2.1. Release notes for cert-manager Operator for Red Hat OpenShift 1.12.0</h3></div></div></div><p>
					Issued: 2023-10-02
				</p><p>
					The following advisories are available for the cert-manager Operator for Red Hat OpenShift 1.12.0:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHEA-2023:5339">RHEA-2023:5339</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHBA-2023:5412">RHBA-2023:5412</a>
						</li></ul></div><p>
					Version <code class="literal">1.12.0</code> of the cert-manager Operator for Red Hat OpenShift is based on the upstream cert-manager version <code class="literal">v1.12.4</code>. For more information, see the <a class="link" href="https://cert-manager.io/docs/release-notes/release-notes-1.12/#v1124">cert-manager project release notes for v1.12.4</a>.
				</p><section class="section" id="cert-manager-operator-1.12.0-bug-fixes"><div class="titlepage"><div><div><h4 class="title">8.2.1.1. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, you could not configure the CPU and memory requests and limits for the cert-manager components such as cert-manager controller, CA injector, and Webhook. Now, you can configure the CPU and memory requests and limits for the cert-manager components by using the command-line interface (CLI). For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-configure-cpu-memory_cert-manager-customizing-api-fields">Overriding CPU and memory limits for the cert-manager components</a>. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-13830"><span class="strong strong"><strong>OCPBUGS-13830</strong></span></a>)
							</li><li class="listitem">
								Previously, if you updated the <code class="literal">ClusterIssuer</code> object, the cert-manager Operator for Red Hat OpenShift could not verify and update the change in the cluster issuer. Now, if you modify the <code class="literal">ClusterIssuer</code> object, the cert-manager Operator for Red Hat OpenShift verifies the ACME account registration and updates the change. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-8210"><span class="strong strong"><strong>OCPBUGS-8210</strong></span></a>)
							</li><li class="listitem">
								Previously, the cert-manager Operator for Red Hat OpenShift did not support enabling the <code class="literal">--enable-certificate-owner-ref</code> flag. Now, the cert-manager Operator for Red Hat OpenShift supports enabling the <code class="literal">--enable-certificate-owner-ref</code> flag by adding the <code class="literal">spec.controllerConfig.overrideArgs</code> field in the <code class="literal">cluster</code> object. After enabling the <code class="literal">--enable-certificate-owner-ref</code> flag, cert-manager can automatically delete the secret when the <code class="literal">Certificate</code> resource is removed from the cluster. For more information on enabling the <code class="literal">--enable-certificate-owner-ref</code> flag and deleting the TLS secret automatically, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-override-flag-controller_cert-manager-customizing-api-fields">Deleting a TLS secret automatically upon Certificate removal</a> (<a class="link" href="https://issues.redhat.com/browse/CM-98"><span class="strong strong"><strong>CM-98</strong></span></a>)
							</li><li class="listitem">
								Previously, the cert-manager Operator for Red Hat OpenShift could not pull the <code class="literal">jetstack-cert-manager-container-v1.12.4-1</code> image. The cert-manager controller, CA injector, and Webhook pods were stuck in the <code class="literal">ImagePullBackOff</code> state. Now, the cert-manager Operator for Red Hat OpenShift pulls the <code class="literal">jetstack-cert-manager-container-v1.12.4-1</code> image to run the cert-manager controller, CA injector, and Webhook pods successfully. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-19986"><span class="strong strong"><strong>OCPBUGS-19986</strong></span></a>)
							</li></ul></div></section></section><section class="section" id="cert-manager-operator-release-notes-1.11.4"><div class="titlepage"><div><div><h3 class="title">8.2.2. Release notes for cert-manager Operator for Red Hat OpenShift 1.11.4</h3></div></div></div><p>
					Issued: 2023-07-26
				</p><p>
					The following advisory is available for the cert-manager Operator for Red Hat OpenShift 1.11.4:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHEA-2023:4081">RHEA-2023:4081</a>
						</li></ul></div><p>
					The golang version is updated to the version <code class="literal">1.19.10</code> to fix Common Vulnerabilities and Exposures (CVEs). Version <code class="literal">1.11.4</code> of the cert-manager Operator for Red Hat OpenShift is based on the upstream cert-manager version <code class="literal">v1.11.4</code>. For more information, see the <a class="link" href="https://cert-manager.io/docs/release-notes/release-notes-1.11/#v1114">cert-manager project release notes for v1.11.4</a>.
				</p><section class="section" id="cert-manager-operator-1.11.4-bug-fixes"><div class="titlepage"><div><div><h4 class="title">8.2.2.1. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, the cert-manager Operator for Red Hat OpenShift did not allow you to install older versions of the cert-manager Operator for Red Hat OpenShift. Now, you can install older versions of the cert-manager Operator for Red Hat OpenShift using the web console or the command-line interface (CLI). For more information on how to use the web console to install older versions, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-operator-install">Installing the cert-manager Operator for Red Hat OpenShift</a>. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-16393"><span class="strong strong"><strong>OCPBUGS-16393</strong></span></a>)
							</li></ul></div></section></section><section class="section" id="cert-manager-operator-release-notes-1.11.1"><div class="titlepage"><div><div><h3 class="title">8.2.3. Release notes for cert-manager Operator for Red Hat OpenShift 1.11.1</h3></div></div></div><p>
					Issued: 2023-06-21
				</p><p>
					The following advisory is available for the cert-manager Operator for Red Hat OpenShift 1.11.1:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHEA-2023:3439">RHEA-2023:3439</a>
						</li></ul></div><p>
					Version <code class="literal">1.11.1</code> of the cert-manager Operator for Red Hat OpenShift is based on the upstream cert-manager version <code class="literal">v1.11.1</code>. For more information, see the <a class="link" href="https://cert-manager.io/docs/release-notes/release-notes-1.11/#v1111">cert-manager project release notes for v1.11.1</a>.
				</p><section class="section" id="cert-manager-operator-1.11.1-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">8.2.3.1. New features and enhancements</h4></div></div></div><p>
						This is the general availability (GA) release of the cert-manager Operator for Red Hat OpenShift.
					</p><section class="section" id="cert-manager-log-level-1.11.1"><div class="titlepage"><div><div><h5 class="title">8.2.3.1.1. Setting log levels for cert-manager and the cert-manager Operator for Red Hat OpenShift</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									To troubleshoot issues with cert-manager and the cert-manager Operator for Red Hat OpenShift, you can now configure the log level verbosity by setting a log level for cert-manager and the cert-manager Operator for Red Hat OpenShift. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-log-levels">Configuring log levels for cert-manager and the cert-manager Operator for Red Hat OpenShift</a>.
								</li></ul></div></section><section class="section" id="cert-manager-authentication-aws-1.11.1"><div class="titlepage"><div><div><h5 class="title">8.2.3.1.2. Authenticating the cert-manager Operator for Red Hat OpenShift with AWS</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									You can now configure cloud credentials for the cert-manager Operator for Red Hat OpenShift on AWS clusters with Security Token Service (STS) and without STS. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-authenticate-aws">Authenticating the cert-manager Operator for Red Hat OpenShift on AWS Security Token Service</a> and <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-authentication-non-sts">Authenticating the cert-manager Operator for Red Hat OpenShift on AWS</a>.
								</li></ul></div></section><section class="section" id="cert-manager-authentication-gcp-1.11.1"><div class="titlepage"><div><div><h5 class="title">8.2.3.1.3. Authenticating the cert-manager Operator for Red Hat OpenShift with GCP</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									You can now configure cloud credentials for the cert-manager Operator for Red Hat OpenShift on GCP clusters with Workload Identity and without Workload Identity. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-authenticate-gcp">Authenticating the cert-manager Operator for Red Hat OpenShift with GCP Workload Identity</a> and <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-authenticate-non-sts-gcp">Authenticating the cert-manager Operator for Red Hat OpenShift with GCP</a>
								</li></ul></div></section></section><section class="section" id="cert-manager-operator-1.11.1-bug-fixes"><div class="titlepage"><div><div><h4 class="title">8.2.3.2. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Previously, the <code class="literal">cm-acme-http-solver</code> pod did not use the latest published Red Hat image <code class="literal">registry.redhat.io/cert-manager/jetstack-cert-manager-acmesolver-rhel9</code>. With this release, the <code class="literal">cm-acme-http-solver</code> pod uses the latest published Red Hat image <code class="literal">registry.redhat.io/cert-manager/jetstack-cert-manager-acmesolver-rhel9</code>. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-10821"><span class="strong strong"><strong>OCPBUGS-10821</strong></span></a>)
							</li><li class="listitem">
								Previously, the cert-manager Operator for Red Hat OpenShift did not support changing labels for cert-manager pods such as controller, CA injector, and Webhook pods. With this release, you can add labels to cert-manager pods. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-8466"><span class="strong strong"><strong>OCPBUGS-8466</strong></span></a>)
							</li><li class="listitem">
								Previously, you could not update the log verbosity level in the cert-manager Operator for Red Hat OpenShift. You can now update the log verbosity level by using an environmental variable <code class="literal">OPERATOR_LOG_LEVEL</code> in its subscription resource. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-9994"><span class="strong strong"><strong>OCPBUGS-9994</strong></span></a>)
							</li><li class="listitem">
								Previously, when uninstalling the cert-manager Operator for Red Hat OpenShift, if you select the <span class="strong strong"><strong>Delete all operand instances for this operator</strong></span> checkbox in the OpenShift Container Platform web console, the Operator was not uninstalled properly. The cert-manager Operator for Red Hat OpenShift is now properly uninstalled. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-9960"><span class="strong strong"><strong>OCPBUGS-9960</strong></span></a>)
							</li><li class="listitem">
								Previously, the cert-manager Operator for Red Hat OpenShift did not support using Google workload identity federation. The cert-manager Operator for Red Hat OpenShift now supports using Google workload identity federation. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-9998"><span class="strong strong"><strong>OCPBUGS-9998</strong></span></a>)
							</li></ul></div></section><section class="section" id="cert-manager-operator-1.11.1-known-issues"><div class="titlepage"><div><div><h4 class="title">8.2.3.3. Known issues</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								After installing the cert-manager Operator for Red Hat OpenShift, if you navigate to <span class="strong strong"><strong>Operators → Installed Operators</strong></span> and select <span class="strong strong"><strong>Operator details</strong></span> in the OpenShift Container Platform web console, you cannot see the cert-manager resources that are created across all namespaces. As a workaround, you can navigate to <span class="strong strong"><strong>Home → API Explorer</strong></span> to see the cert-manager resources. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-11647"><span class="strong strong"><strong>OCPBUGS-11647</strong></span></a>)
							</li><li class="listitem">
								After uninstalling the cert-manager Operator for Red Hat OpenShift by using the web console, the cert-manager Operator for Red Hat OpenShift does not remove the cert-manager controller, CA injector, and Webhook pods automatically from the <code class="literal">cert-manager</code> namespace. As a workaround, you can manually delete the cert-manager controller, CA injector, and Webhook pod deployments present in the <code class="literal">cert-manager</code> namespace. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-13679"><span class="strong strong"><strong>OCPBUGS-13679</strong></span></a>)
							</li></ul></div></section></section><section class="section" id="cert-manager-operator-release-notes-1.10.3"><div class="titlepage"><div><div><h3 class="title">8.2.4. Release notes for cert-manager Operator for Red Hat OpenShift 1.10.3</h3></div></div></div><p>
					Issued: 2023-08-08
				</p><p>
					The following advisory is available for the cert-manager Operator for Red Hat OpenShift 1.10.3:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHSA-2023:4335">RHSA-2023:4335</a>
						</li></ul></div><p>
					The version <code class="literal">1.10.3</code> of the cert-manager Operator for Red Hat OpenShift is based on the <code class="literal">cert-manager</code> upstream version <code class="literal">v1.10.2</code>. With this release, the version of the cert-manager Operator for Red Hat OpenShift is <code class="literal">1.10.3</code> but the <code class="literal">cert-manager</code> operand version is <code class="literal">1.10.2</code>. For more information, see the <a class="link" href="https://cert-manager.io/docs/release-notes/release-notes-1.10/#v1102-changes-since-v1101">cert-manager project release notes for v1.10.2</a>.
				</p><section class="section" id="cert-manager-operator-1.10.3-CVEs"><div class="titlepage"><div><div><h4 class="title">8.2.4.1. CVEs</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/security/cve/CVE-2022-41725">CVE-2022-41725</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/security/cve/CVE-2022-41724">CVE-2022-41724</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/security/cve/CVE-2023-24536">CVE-2023-24536</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/security/cve/CVE-2023-24538">CVE-2023-24538</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/security/cve/CVE-2023-24537">CVE-2023-24537</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/security/cve/CVE-2023-24534">CVE-2023-24534</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/security/cve/CVE-2022-41723">CVE-2022-41723</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/security/cve/CVE-2023-29400">CVE-2023-29400</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/security/cve/CVE-2023-24540">CVE-2023-24540</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/security/cve/CVE-2023-24539">CVE-2023-24539</a>
							</li></ul></div></section></section><section class="section" id="cert-manager-operator-release-notes-1.10.2"><div class="titlepage"><div><div><h3 class="title">8.2.5. Release notes for cert-manager Operator for Red Hat OpenShift 1.10.2</h3></div></div></div><p>
					Issued: 2023-03-23
				</p><p>
					The following advisory is available for the cert-manager Operator for Red Hat OpenShift 1.10.2:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/errata/RHEA-2023:1238">RHEA-2023:1238</a>
						</li></ul></div><p>
					Version <code class="literal">1.10.2</code> of the cert-manager Operator for Red Hat OpenShift is based on the upstream cert-manager version <code class="literal">v1.10.2</code>. For more information, see the <a class="link" href="https://cert-manager.io/docs/release-notes/release-notes-1.10/#v1102-changes-since-v1101">cert-manager project release notes for v1.10.2</a>.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						If you used the Technology Preview version of the cert-manager Operator for Red Hat OpenShift, you must uninstall it and remove all related resources for the Technology Preview version before installing this version of the cert-manager Operator for Red Hat OpenShift.
					</p><p>
						For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-operator-uninstall">Uninstalling the cert-manager Operator for Red Hat OpenShift</a>.
					</p></div></div><section class="section" id="cert-manager-operator-1.10.2-new-features-and-enhancements"><div class="titlepage"><div><div><h4 class="title">8.2.5.1. New features and enhancements</h4></div></div></div><p>
						This is the general availability (GA) release of the cert-manager Operator for Red Hat OpenShift.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								The following issuer types are supported:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Automated Certificate Management Environment (ACME)
									</li><li class="listitem">
										Certificate authority (CA)
									</li><li class="listitem">
										Self-signed
									</li></ul></div></li><li class="listitem"><p class="simpara">
								The following ACME challenge types are supported:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										DNS-01
									</li><li class="listitem">
										HTTP-01
									</li></ul></div></li><li class="listitem"><p class="simpara">
								The following DNS-01 providers for ACME issuers are supported:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Amazon Route 53
									</li><li class="listitem">
										Azure DNS
									</li><li class="listitem">
										Google Cloud DNS
									</li></ul></div></li><li class="listitem">
								The cert-manager Operator for Red Hat OpenShift now supports injecting custom CA certificates and propagating cluster-wide egress proxy environment variables.
							</li><li class="listitem">
								You can customize the cert-manager Operator for Red Hat OpenShift API fields by overriding environment variables and arguments. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-customizing-api-fields">Customizing cert-manager Operator API fields</a>
							</li><li class="listitem">
								You can enable monitoring and metrics collection for the cert-manager Operator for Red Hat OpenShift by using a service monitor to perform the custom metrics scraping. After you have enabled monitoring for the cert-manager Operator for Red Hat OpenShift, you can query its metrics by using the OpenShift Container Platform web console. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-monitoring">Enabling monitoring for the cert-manager Operator for Red Hat OpenShift</a>
							</li></ul></div></section><section class="section" id="cert-manager-operator-1.10.2-bug-fixes"><div class="titlepage"><div><div><h4 class="title">8.2.5.2. Bug fixes</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Previously, the <code class="literal">unsupportedConfigOverrides</code> field replaced user-provided arguments instead of appending them. Now, the <code class="literal">unsupportedConfigOverrides</code> field properly appends user-provided arguments. (<a class="link" href="https://issues.redhat.com/browse/CM-23"><span class="strong strong"><strong>CM-23</strong></span></a>)
							</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
									Using the <code class="literal">unsupportedConfigOverrides</code> section to modify the configuration of an Operator is unsupported and might block cluster upgrades.
								</p></div></div></li><li class="listitem">
								Previously, the cert-manager Operator for Red Hat OpenShift was installed as a cluster Operator. With this release, the cert-manager Operator for Red Hat OpenShift is now properly installed as an OLM Operator. (<a class="link" href="https://issues.redhat.com/browse/CM-35"><span class="strong strong"><strong>CM-35</strong></span></a>)
							</li></ul></div></section><section class="section" id="cert-manager-operator-1.10.2-known-issues"><div class="titlepage"><div><div><h4 class="title">8.2.5.3. Known issues</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Using <code class="literal">Route</code> objects is not fully supported. Currently, to use cert-manager Operator for Red Hat OpenShift with <code class="literal">Routes</code>, users must create <code class="literal">Ingress</code> objects, which are translated to <code class="literal">Route</code> objects by the Ingress-to-Route Controller. (<a class="link" href="https://issues.redhat.com/browse/CM-16"><span class="strong strong"><strong>CM-16</strong></span></a>)
							</li><li class="listitem">
								The cert-manager Operator for Red Hat OpenShift does not support using Azure Active Directory (Azure AD) pod identities to assign a managed identity to a pod. As a workaround, you can use a service principal to assign a managed identity. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-8665"><span class="strong strong"><strong>OCPBUGS-8665</strong></span></a>)
							</li><li class="listitem">
								The cert-manager Operator for Red Hat OpenShift does not support using Google workload identity federation. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-9998"><span class="strong strong"><strong>OCPBUGS-9998</strong></span></a>)
							</li><li class="listitem">
								When uninstalling the cert-manager Operator for Red Hat OpenShift, if you select the <span class="strong strong"><strong>Delete all operand instances for this operator</strong></span> checkbox in the OpenShift Container Platform web console, the Operator is not uninstalled properly. As a workaround, do not select this checkbox when uninstalling the cert-manager Operator for Red Hat OpenShift. (<a class="link" href="https://issues.redhat.com/browse/OCPBUGS-9960"><span class="strong strong"><strong>OCPBUGS-9960</strong></span></a>)
							</li></ul></div></section></section></section><section class="section" id="cert-manager-operator-install"><div class="titlepage"><div><div><h2 class="title">8.3. Installing the cert-manager Operator for Red Hat OpenShift</h2></div></div></div><p>
				The cert-manager Operator for Red Hat OpenShift is not installed in OpenShift Container Platform by default. You can install the cert-manager Operator for Red Hat OpenShift by using the web console.
			</p><section class="section" id="cert-manager-install-console_cert-manager-operator-install"><div class="titlepage"><div><div><h3 class="title">8.3.1. Installing the cert-manager Operator for Red Hat OpenShift using the web console</h3></div></div></div><p>
					You can use the web console to install the cert-manager Operator for Red Hat OpenShift.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster with <code class="literal">cluster-admin</code> privileges.
						</li><li class="listitem">
							You have access to the OpenShift Container Platform web console.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform web console.
						</li><li class="listitem">
							Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span>.
						</li><li class="listitem">
							Enter <span class="strong strong"><strong>cert-manager Operator for Red Hat OpenShift</strong></span> into the filter box.
						</li><li class="listitem"><p class="simpara">
							Select the <span class="strong strong"><strong>cert-manager Operator for Red Hat OpenShift</strong></span> and click <span class="strong strong"><strong>Install</strong></span>.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								From the cert-manager Operator for Red Hat OpenShift <code class="literal">1.12.0</code> and later, the z-stream versions of the upstream cert-manager operands such as cert-manager controller, CA injector, Webhook, and cert-manager Operator for Red Hat OpenShift are decoupled. For example, for the cert-manager Operator for Red Hat OpenShift <code class="literal">1.12.0</code>, the cert-manager operand version is <code class="literal">v1.12.4</code>.
							</p></div></div></li><li class="listitem"><p class="simpara">
							On the <span class="strong strong"><strong>Install Operator</strong></span> page:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Update the <span class="strong strong"><strong>Update channel</strong></span>, if necessary. The channel defaults to <span class="strong strong"><strong>stable-v1</strong></span>, which installs the latest stable release of the cert-manager Operator for Red Hat OpenShift.
								</li><li class="listitem"><p class="simpara">
									Choose the <span class="strong strong"><strong>Installed Namespace</strong></span> for the Operator. The default Operator namespace is <code class="literal">cert-manager-operator</code>.
								</p><p class="simpara">
									If the <code class="literal">cert-manager-operator</code> namespace does not exist, it is created for you.
								</p></li><li class="listitem"><p class="simpara">
									Select an <span class="strong strong"><strong>Update approval</strong></span> strategy.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											The <span class="strong strong"><strong>Automatic</strong></span> strategy allows Operator Lifecycle Manager (OLM) to automatically update the Operator when a new version is available.
										</li><li class="listitem">
											The <span class="strong strong"><strong>Manual</strong></span> strategy requires a user with appropriate credentials to approve the Operator update.
										</li></ul></div></li><li class="listitem">
									Click <span class="strong strong"><strong>Install</strong></span>.
								</li></ol></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
						</li><li class="listitem">
							Verify that <span class="strong strong"><strong>cert-manager Operator for Red Hat OpenShift</strong></span> is listed with a <span class="strong strong"><strong>Status</strong></span> of <span class="strong strong"><strong>Succeeded</strong></span> in the <code class="literal">cert-manager-operator</code> namespace.
						</li><li class="listitem"><p class="simpara">
							Verify that cert-manager pods are up and running by entering the following command:
						</p><pre class="programlisting language-terminal">$ oc get pods -n cert-manager</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                                       READY   STATUS    RESTARTS   AGE
cert-manager-bd7fbb9fc-wvbbt               1/1     Running   0          3m39s
cert-manager-cainjector-56cc5f9868-7g9z7   1/1     Running   0          4m5s
cert-manager-webhook-d4f79d7f7-9dg9w       1/1     Running   0          4m9s</pre>

							</p></div><p class="simpara">
							You can use the cert-manager Operator for Red Hat OpenShift only after cert-manager pods are up and running.
						</p></li></ol></div></section><section class="section" id="cert-manager-operator-update-channels_cert-manager-operator-install"><div class="titlepage"><div><div><h3 class="title">8.3.2. Understanding update channels of the cert-manager Operator for Red Hat OpenShift</h3></div></div></div><p>
					Update channels are the mechanism by which you can declare the version of your cert-manager Operator for Red Hat OpenShift in your cluster. The cert-manager Operator for Red Hat OpenShift offers the following update channels:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">stable-v1</code>
						</li><li class="listitem">
							<code class="literal">stable-v1.y</code>
						</li></ul></div><section class="section" id="stable-v1-channel_cert-manager-operator-install"><div class="titlepage"><div><div><h4 class="title">8.3.2.1. stable-v1 channel</h4></div></div></div><p>
						The <code class="literal">stable-v1</code> channel is the default and suggested channel while installing the cert-manager Operator for Red Hat OpenShift. The <code class="literal">stable-v1</code> channel installs and updates the latest release version of the cert-manager Operator for Red Hat OpenShift. Select the <code class="literal">stable-v1</code> channel if you want to use the latest stable release of the cert-manager Operator for Red Hat OpenShift.
					</p><p>
						The <code class="literal">stable-v1</code> channel offers the following update approval strategies:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Automatic</span></dt><dd>
									If you choose automatic updates for an installed cert-manager Operator for Red Hat OpenShift, a new version of the cert-manager Operator for Red Hat OpenShift is available in the <code class="literal">stable-v1</code> channel. The Operator Lifecycle Manager (OLM) automatically upgrades the running instance of your Operator without human intervention.
								</dd><dt><span class="term">Manual</span></dt><dd>
									If you select manual updates, when a newer version of the cert-manager Operator for Red Hat OpenShift is available, OLM creates an update request. As a cluster administrator, you must then manually approve that update request to have the cert-manager Operator for Red Hat OpenShift updated to the new version.
								</dd></dl></div></section><section class="section" id="stable-v1-y-channel_cert-manager-operator-install"><div class="titlepage"><div><div><h4 class="title">8.3.2.2. stable-v1.y channel</h4></div></div></div><p>
						The y-stream version of the cert-manager Operator for Red Hat OpenShift installs updates from the <code class="literal">stable-v1.y</code> channels such as <code class="literal">stable-v1.10</code>, <code class="literal">stable-v1.11</code>, and <code class="literal">stable-v1.12</code>. Select the <code class="literal">stable-v1.y</code> channel if you want to use the y-stream version and stay updated to the z-stream version of the cert-manager Operator for Red Hat OpenShift.
					</p><p>
						The <code class="literal">stable-v1.y</code> channel offers the following update approval strategies:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Automatic</span></dt><dd>
									If you choose automatic updates for an installed cert-manager Operator for Red Hat OpenShift, a new z-stream version of the cert-manager Operator for Red Hat OpenShift is available in the <code class="literal">stable-v1.y</code> channel. OLM automatically upgrades the running instance of your Operator without human intervention.
								</dd><dt><span class="term">Manual</span></dt><dd>
									If you select manual updates, when a newer version of the cert-manager Operator for Red Hat OpenShift is available, OLM creates an update request. As a cluster administrator, you must then manually approve that update request to have the cert-manager Operator for Red Hat OpenShift updated to the new version of the z-stream releases.
								</dd></dl></div></section></section><section class="section _additional-resources" id="cert-manager-operator-install_additional-resources"><div class="titlepage"><div><div><h3 class="title">8.3.3. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-adding-operators-to-a-cluster">Adding Operators to a cluster</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-upgrading-operators">Updating installed Operators</a>
						</li></ul></div></section></section><section class="section" id="cert-manager-operator-issuer-acme"><div class="titlepage"><div><div><h2 class="title">8.4. Managing certificates with an ACME issuer</h2></div></div></div><p>
				The cert-manager Operator for Red Hat OpenShift supports using Automated Certificate Management Environment (ACME) CA servers, such as <span class="emphasis"><em>Let’s Encrypt</em></span>, to issue certificates. Explicit credentials are configured by specifying the secret details in the <code class="literal">Issuer</code> API object. Ambient credentials are extracted from the environment, metadata services, or local files which are not explicitly configured in the <code class="literal">Issuer</code> API object.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The <code class="literal">Issuer</code> object is namespace scoped. It can only issue certificates from the same namespace. You can also use the <code class="literal">ClusterIssuer</code> object to issue certificates across all namespaces in the cluster.
				</p><div class="formalpara"><p class="title"><strong>Example YAML file that defines the <code class="literal">ClusterIssuer</code> object</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: acme-cluster-issuer
spec:
  acme:
    ...</pre>

					</p></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					By default, you can use the <code class="literal">ClusterIssuer</code> object with ambient credentials. To use the <code class="literal">Issuer</code> object with ambient credentials, you must enable the <code class="literal">--issuer-ambient-credentials</code> setting for the cert-manager controller.
				</p></div></div><section class="section" id="cert-manager-acme-about_cert-manager-operator-issuer-acme"><div class="titlepage"><div><div><h3 class="title">8.4.1. About ACME issuers</h3></div></div></div><p>
					The ACME issuer type for the cert-manager Operator for Red Hat OpenShift represents an Automated Certificate Management Environment (ACME) certificate authority (CA) server. ACME CA servers rely on a <span class="emphasis"><em>challenge</em></span> to verify that a client owns the domain names that the certificate is being requested for. If the challenge is successful, the cert-manager Operator for Red Hat OpenShift can issue the certificate. If the challenge fails, the cert-manager Operator for Red Hat OpenShift does not issue the certificate.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Private DNS zones are not supported with <span class="emphasis"><em>Let’s Encrypt</em></span> and internet ACME servers.
					</p></div></div><section class="section" id="cert-manager-acme-challenges-types_cert-manager-operator-issuer-acme"><div class="titlepage"><div><div><h4 class="title">8.4.1.1. Supported ACME challenges types</h4></div></div></div><p>
						The cert-manager Operator for Red Hat OpenShift supports the following challenge types for ACME issuers:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">HTTP-01</span></dt><dd><p class="simpara">
									With the HTTP-01 challenge type, you provide a computed key at an HTTP URL endpoint in your domain. If the ACME CA server can get the key from the URL, it can validate you as the owner of the domain.
								</p><p class="simpara">
									For more information, see <a class="link" href="https://cert-manager.io/docs/configuration/acme/http01/">HTTP01</a> in the upstream cert-manager documentation.
								</p></dd><dt><span class="term">DNS-01</span></dt><dd><p class="simpara">
									With the DNS-01 challenge type, you provide a computed key at a DNS TXT record. If the ACME CA server can get the key by DNS lookup, it can validate you as the owner of the domain.
								</p><p class="simpara">
									For more information, see <a class="link" href="https://cert-manager.io/docs/configuration/acme/dns01/">DNS01</a> in the upstream cert-manager documentation.
								</p></dd></dl></div></section><section class="section" id="cert-manager-acme-dns-providers_cert-manager-operator-issuer-acme"><div class="titlepage"><div><div><h4 class="title">8.4.1.2. Supported DNS-01 providers</h4></div></div></div><p>
						The cert-manager Operator for Red Hat OpenShift supports the following DNS-01 providers for ACME issuers:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Amazon Route 53
							</li><li class="listitem"><p class="simpara">
								Azure DNS
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The cert-manager Operator for Red Hat OpenShift does not support using Azure Active Directory (Azure AD) pod identities to assign a managed identity to a pod.
								</p></div></div></li><li class="listitem">
								Google Cloud DNS
							</li></ul></div></section></section><section class="section" id="cert-manager-acme-http01_cert-manager-operator-issuer-acme"><div class="titlepage"><div><div><h3 class="title">8.4.2. Configuring an ACME issuer to solve HTTP-01 challenges</h3></div></div></div><p>
					You can use cert-manager Operator for Red Hat OpenShift to set up an ACME issuer to solve HTTP-01 challenges. This procedure uses <span class="emphasis"><em>Let’s Encrypt</em></span> as the ACME CA server.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li><li class="listitem">
							You have a service that you want to expose. In this procedure, the service is named <code class="literal">sample-workload</code>.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create an ACME cluster issuer.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create a YAML file that defines the <code class="literal">ClusterIssuer</code> object:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">acme-cluster-issuer.yaml</code> file</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-staging                                        <span id="CO48-1"><!--Empty--></span><span class="callout">1</span>
spec:
  acme:
    preferredChain: ""
    privateKeySecretRef:
      name: &lt;secret_for_private_key&gt;                               <span id="CO48-2"><!--Empty--></span><span class="callout">2</span>
    server: https://acme-staging-v02.api.letsencrypt.org/directory <span id="CO48-3"><!--Empty--></span><span class="callout">3</span>
    solvers:
    - http01:
        ingress:
          class: openshift-default                                 <span id="CO48-4"><!--Empty--></span><span class="callout">4</span></pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO48-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Provide a name for the cluster issuer.
										</div></dd><dt><a href="#CO48-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;secret_private_key&gt;</code> with the name of secret to store the ACME account private key in.
										</div></dd><dt><a href="#CO48-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Specify the URL to access the ACME server’s <code class="literal">directory</code> endpoint. This example uses the <span class="emphasis"><em>Let’s Encrypt</em></span> staging environment.
										</div></dd><dt><a href="#CO48-4"><span class="callout">4</span></a> </dt><dd><div class="para">
											Specify the Ingress class.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">ClusterIssuer</code> object by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f acme-cluster-issuer.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create an Ingress to expose the service of the user workload.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create a YAML file that defines a <code class="literal">Namespace</code> object:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">namespace.yaml</code> file</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: v1
kind: Namespace
metadata:
  name: my-ingress-namespace <span id="CO49-1"><!--Empty--></span><span class="callout">1</span></pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO49-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Specify the namespace for the Ingress.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">Namespace</code> object by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f namespace.yaml</pre></li><li class="listitem"><p class="simpara">
									Create a YAML file that defines the <code class="literal">Ingress</code> object:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">ingress.yaml</code> file</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: sample-ingress                                           <span id="CO50-1"><!--Empty--></span><span class="callout">1</span>
  namespace: my-ingress-namespace                                <span id="CO50-2"><!--Empty--></span><span class="callout">2</span>
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-staging          <span id="CO50-3"><!--Empty--></span><span class="callout">3</span>
    acme.cert-manager.io/http01-ingress-class: openshift-default <span id="CO50-4"><!--Empty--></span><span class="callout">4</span>
spec:
  ingressClassName: openshift-default                            <span id="CO50-5"><!--Empty--></span><span class="callout">5</span>
  tls:
  - hosts:
    - &lt;hostname&gt;                                                 <span id="CO50-6"><!--Empty--></span><span class="callout">6</span>
    secretName: sample-tls                                       <span id="CO50-7"><!--Empty--></span><span class="callout">7</span>
  rules:
  - host: &lt;hostname&gt;                                             <span id="CO50-8"><!--Empty--></span><span class="callout">8</span>
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: sample-workload                                <span id="CO50-9"><!--Empty--></span><span class="callout">9</span>
            port:
              number: 80</pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO50-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Specify the name of the Ingress.
										</div></dd><dt><a href="#CO50-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Specify the namespace that you created for the Ingress.
										</div></dd><dt><a href="#CO50-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Specify the cluster issuer that you created.
										</div></dd><dt><a href="#CO50-4"><span class="callout">4</span></a> </dt><dd><div class="para">
											Specify the Ingress class.
										</div></dd><dt><a href="#CO50-5"><span class="callout">5</span></a> </dt><dd><div class="para">
											Specify the Ingress class.
										</div></dd><dt><a href="#CO50-6"><span class="callout">6</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;hostname&gt;</code> with the Subject Alternative Name to be associated with the certificate. This name is used to add DNS names to the certificate.
										</div></dd><dt><a href="#CO50-7"><span class="callout">7</span></a> </dt><dd><div class="para">
											Specify the secret to store the created certificate in.
										</div></dd><dt><a href="#CO50-8"><span class="callout">8</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;hostname&gt;</code> with the hostname. You can use the <code class="literal">&lt;host_name&gt;.&lt;cluster_ingress_domain&gt;</code> syntax to take advantage of the <code class="literal">*.&lt;cluster_ingress_domain&gt;</code> wildcard DNS record and serving certificate for the cluster. For example, you might use <code class="literal">apps.&lt;cluster_base_domain&gt;</code>. Otherwise, you must ensure that a DNS record exists for the chosen hostname.
										</div></dd><dt><a href="#CO50-9"><span class="callout">9</span></a> </dt><dd><div class="para">
											Specify the name of the service to expose. This example uses a service named <code class="literal">sample-workload</code>.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">Ingress</code> object by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f ingress.yaml</pre></li></ol></div></li></ol></div></section><section class="section" id="cert-manager-acme-dns01-explicit-aws_cert-manager-operator-issuer-acme"><div class="titlepage"><div><div><h3 class="title">8.4.3. Configuring an ACME issuer by using explicit credentials for AWS Route53</h3></div></div></div><p>
					You can use cert-manager Operator for Red Hat OpenShift to set up an Automated Certificate Management Environment (ACME) issuer to solve DNS-01 challenges by using explicit credentials on AWS. This procedure uses <span class="emphasis"><em>Let’s Encrypt</em></span> as the ACME certificate authority (CA) server and shows how to solve DNS-01 challenges with Amazon Route 53.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							You must provide the explicit <code class="literal">accessKeyID</code> and <code class="literal">secretAccessKey</code> credentials. For more information, see <a class="link" href="https://cert-manager.io/docs/configuration/acme/dns01/route53/">Route53</a> in the upstream cert-manager documentation.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								You can use Amazon Route 53 with explicit credentials in an OpenShift Container Platform cluster that is not running on AWS.
							</p></div></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Optional: Override the nameserver settings for the DNS-01 self check.
						</p><p class="simpara">
							This step is required only when the target public-hosted zone overlaps with the cluster’s default private-hosted zone.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Edit the <code class="literal">CertManager</code> resource by running the following command:
								</p><pre class="programlisting language-terminal">$ oc edit certmanager cluster</pre></li><li class="listitem"><p class="simpara">
									Add a <code class="literal">spec.controllerConfig</code> section with the following override arguments:
								</p><pre class="programlisting language-yaml">apiVersion: operator.openshift.io/v1alpha1
kind: CertManager
metadata:
  name: cluster
  ...
spec:
  ...
  controllerConfig:                                <span id="CO51-1"><!--Empty--></span><span class="callout">1</span>
    overrideArgs:
      - '--dns01-recursive-nameservers-only'       <span id="CO51-2"><!--Empty--></span><span class="callout">2</span>
      - '--dns01-recursive-nameservers=1.1.1.1:53' <span id="CO51-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO51-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Add the <code class="literal">spec.controllerConfig</code> section.
										</div></dd><dt><a href="#CO51-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Specify to only use recursive nameservers instead of checking the authoritative nameservers associated with that domain.
										</div></dd><dt><a href="#CO51-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Provide a comma-separated list of <code class="literal">&lt;host&gt;:&lt;port&gt;</code> nameservers to query for the DNS-01 self check. You must use a <code class="literal">1.1.1.1:53</code> value to avoid the public and private zones overlapping.
										</div></dd></dl></div></li><li class="listitem">
									Save the file to apply the changes.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Optional: Create a namespace for the issuer:
						</p><pre class="programlisting language-terminal">$ oc new-project &lt;issuer_namespace&gt;</pre></li><li class="listitem"><p class="simpara">
							Create a secret to store your AWS credentials in by running the following command:
						</p><pre class="programlisting language-terminal">$ oc create secret generic aws-secret --from-literal=awsSecretAccessKey=&lt;aws_secret_access_key&gt; \ <span id="CO52-1"><!--Empty--></span><span class="callout">1</span>
    -n my-issuer-namespace</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO52-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Replace <code class="literal">&lt;aws_secret_access_key&gt;</code> with your AWS secret access key.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Create an issuer:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create a YAML file that defines the <code class="literal">Issuer</code> object:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">issuer.yaml</code> file</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: cert-manager.io/v1
kind: Issuer
metadata:
  name: &lt;letsencrypt_staging&gt;                                        <span id="CO53-1"><!--Empty--></span><span class="callout">1</span>
  namespace: &lt;issuer_namespace&gt;                                   <span id="CO53-2"><!--Empty--></span><span class="callout">2</span>
spec:
  acme:
    server: https://acme-staging-v02.api.letsencrypt.org/directory <span id="CO53-3"><!--Empty--></span><span class="callout">3</span>
    email: "&lt;email_address&gt;"                                       <span id="CO53-4"><!--Empty--></span><span class="callout">4</span>
    privateKeySecretRef:
      name: &lt;secret_private_key&gt;                                   <span id="CO53-5"><!--Empty--></span><span class="callout">5</span>
    solvers:
    - dns01:
        route53:
          accessKeyID: &lt;aws_key_id&gt;                                <span id="CO53-6"><!--Empty--></span><span class="callout">6</span>
          hostedZoneID: &lt;hosted_zone_id&gt;                           <span id="CO53-7"><!--Empty--></span><span class="callout">7</span>
          region: &lt;region_name&gt;                                    <span id="CO53-8"><!--Empty--></span><span class="callout">8</span>
          secretAccessKeySecretRef:
            name: "aws-secret"                                     <span id="CO53-9"><!--Empty--></span><span class="callout">9</span>
            key: "awsSecretAccessKey"                              <span id="CO53-10"><!--Empty--></span><span class="callout">10</span></pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO53-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Provide a name for the issuer.
										</div></dd><dt><a href="#CO53-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Specify the namespace that you created for the issuer.
										</div></dd><dt><a href="#CO53-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Specify the URL to access the ACME server’s <code class="literal">directory</code> endpoint. This example uses the <span class="emphasis"><em>Let’s Encrypt</em></span> staging environment.
										</div></dd><dt><a href="#CO53-4"><span class="callout">4</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;email_address&gt;</code> with your email address.
										</div></dd><dt><a href="#CO53-5"><span class="callout">5</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;secret_private_key&gt;</code> with the name of the secret to store the ACME account private key in.
										</div></dd><dt><a href="#CO53-6"><span class="callout">6</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;aws_key_id&gt;</code> with your AWS key ID.
										</div></dd><dt><a href="#CO53-7"><span class="callout">7</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;hosted_zone_id&gt;</code> with your hosted zone ID.
										</div></dd><dt><a href="#CO53-8"><span class="callout">8</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;region_name&gt;</code> with the AWS region name. For example, <code class="literal">us-east-1</code>.
										</div></dd><dt><a href="#CO53-9"><span class="callout">9</span></a> </dt><dd><div class="para">
											Specify the name of the secret you created.
										</div></dd><dt><a href="#CO53-10"><span class="callout">10</span></a> </dt><dd><div class="para">
											Specify the key in the secret you created that stores your AWS secret access key.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">Issuer</code> object by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f issuer.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create a certificate:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create a YAML file that defines the <code class="literal">Certificate</code> object:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">certificate.yaml</code> file</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: &lt;tls_cert&gt;             <span id="CO54-1"><!--Empty--></span><span class="callout">1</span>
  namespace: &lt;issuer_namespace&gt; <span id="CO54-2"><!--Empty--></span><span class="callout">2</span>
spec:
  isCA: false
  commonName: '&lt;common_name&gt;'    <span id="CO54-3"><!--Empty--></span><span class="callout">3</span>
  secretName: &lt;tls_cert&gt;        <span id="CO54-4"><!--Empty--></span><span class="callout">4</span>
  dnsNames:
  - '&lt;domain_name&gt;'              <span id="CO54-5"><!--Empty--></span><span class="callout">5</span>
  issuerRef:
    name: &lt;letsencrypt_staging&gt;    <span id="CO54-6"><!--Empty--></span><span class="callout">6</span>
    kind: Issuer</pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO54-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Provide a name for the certificate.
										</div></dd><dt><a href="#CO54-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Specify the namespace that you created for the issuer.
										</div></dd><dt><a href="#CO54-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;common_name&gt;</code> with your common name (CN).
										</div></dd><dt><a href="#CO54-4"><span class="callout">4</span></a> </dt><dd><div class="para">
											Specify the name of the secret to create that will contain the certificate.
										</div></dd><dt><a href="#CO54-5"><span class="callout">5</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;domain_name&gt;</code> with your domain name.
										</div></dd><dt><a href="#CO54-6"><span class="callout">6</span></a> </dt><dd><div class="para">
											Specify the name of the issuer that you created.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">Certificate</code> object by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f certificate.yaml</pre></li></ol></div></li></ol></div></section><section class="section" id="cert-manager-acme-dns01-ambient-aws_cert-manager-operator-issuer-acme"><div class="titlepage"><div><div><h3 class="title">8.4.4. Configuring an ACME issuer by using ambient credentials on AWS</h3></div></div></div><p>
					You can use cert-manager Operator for Red Hat OpenShift to set up an ACME issuer to solve DNS-01 challenges by using ambient credentials on AWS. This procedure uses <span class="emphasis"><em>Let’s Encrypt</em></span> as the ACME CA server and shows how to solve DNS-01 challenges with Amazon Route 53.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							If your cluster is configured to use the AWS Security Token Service (STS), you followed the instructions from the <span class="emphasis"><em>Configuring cloud credentials for the cert-manager Operator for Red Hat OpenShift for the AWS Security Token Service cluster</em></span> section.
						</li><li class="listitem">
							If your cluster does not use the AWS STS, you followed the instructions from the <span class="emphasis"><em>Configuring cloud credentials for the cert-manager Operator for Red Hat OpenShift on AWS</em></span> section.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Optional: Override the nameserver settings for the DNS-01 self check.
						</p><p class="simpara">
							This step is required only when the target public-hosted zone overlaps with the cluster’s default private-hosted zone.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Edit the <code class="literal">CertManager</code> resource by running the following command:
								</p><pre class="programlisting language-terminal">$ oc edit certmanager cluster</pre></li><li class="listitem"><p class="simpara">
									Add a <code class="literal">spec.controllerConfig</code> section with the following override arguments:
								</p><pre class="programlisting language-yaml">apiVersion: operator.openshift.io/v1alpha1
kind: CertManager
metadata:
  name: cluster
  ...
spec:
  ...
  controllerConfig:                                <span id="CO55-1"><!--Empty--></span><span class="callout">1</span>
    overrideArgs:
      - '--dns01-recursive-nameservers-only'       <span id="CO55-2"><!--Empty--></span><span class="callout">2</span>
      - '--dns01-recursive-nameservers=1.1.1.1:53' <span id="CO55-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO55-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Add the <code class="literal">spec.controllerConfig</code> section.
										</div></dd><dt><a href="#CO55-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Specify to only use recursive nameservers instead of checking the authoritative nameservers associated with that domain.
										</div></dd><dt><a href="#CO55-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Provide a comma-separated list of <code class="literal">&lt;host&gt;:&lt;port&gt;</code> nameservers to query for the DNS-01 self check. You must use a <code class="literal">1.1.1.1:53</code> value to avoid the public and private zones overlapping.
										</div></dd></dl></div></li><li class="listitem">
									Save the file to apply the changes.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Optional: Create a namespace for the issuer:
						</p><pre class="programlisting language-terminal">$ oc new-project &lt;issuer_namespace&gt;</pre></li><li class="listitem"><p class="simpara">
							Modify the <code class="literal">CertManager</code> resource to add the <code class="literal">--issuer-ambient-credentials</code> argument:
						</p><pre class="programlisting language-terminal">$ oc patch certmanager/cluster \
  --type=merge \
  -p='{"spec":{"controllerConfig":{"overrideArgs":["--issuer-ambient-credentials"]}}}'</pre></li><li class="listitem"><p class="simpara">
							Create an issuer:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create a YAML file that defines the <code class="literal">Issuer</code> object:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">issuer.yaml</code> file</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: cert-manager.io/v1
kind: Issuer
metadata:
  name: &lt;letsencrypt_staging&gt;                                        <span id="CO56-1"><!--Empty--></span><span class="callout">1</span>
  namespace: &lt;issuer_namespace&gt;                                   <span id="CO56-2"><!--Empty--></span><span class="callout">2</span>
spec:
  acme:
    server: https://acme-staging-v02.api.letsencrypt.org/directory <span id="CO56-3"><!--Empty--></span><span class="callout">3</span>
    email: "&lt;email_address&gt;"                                       <span id="CO56-4"><!--Empty--></span><span class="callout">4</span>
    privateKeySecretRef:
      name: &lt;secret_private_key&gt;                                   <span id="CO56-5"><!--Empty--></span><span class="callout">5</span>
    solvers:
    - dns01:
        route53:
          hostedZoneID: &lt;hosted_zone_id&gt;                           <span id="CO56-6"><!--Empty--></span><span class="callout">6</span>
          region: us-east-1</pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO56-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Provide a name for the issuer.
										</div></dd><dt><a href="#CO56-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Specify the namespace that you created for the issuer.
										</div></dd><dt><a href="#CO56-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Specify the URL to access the ACME server’s <code class="literal">directory</code> endpoint. This example uses the <span class="emphasis"><em>Let’s Encrypt</em></span> staging environment.
										</div></dd><dt><a href="#CO56-4"><span class="callout">4</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;email_address&gt;</code> with your email address.
										</div></dd><dt><a href="#CO56-5"><span class="callout">5</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;secret_private_key&gt;</code> with the name of the secret to store the ACME account private key in.
										</div></dd><dt><a href="#CO56-6"><span class="callout">6</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;hosted_zone_id&gt;</code> with your hosted zone ID.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">Issuer</code> object by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f issuer.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create a certificate:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create a YAML file that defines the <code class="literal">Certificate</code> object:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">certificate.yaml</code> file</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: &lt;tls_cert&gt;              <span id="CO57-1"><!--Empty--></span><span class="callout">1</span>
  namespace: &lt;issuer_namespace&gt; <span id="CO57-2"><!--Empty--></span><span class="callout">2</span>
spec:
  isCA: false
  commonName: '&lt;common_name&gt;'    <span id="CO57-3"><!--Empty--></span><span class="callout">3</span>
  secretName: &lt;tls-cert&gt;        <span id="CO57-4"><!--Empty--></span><span class="callout">4</span>
  dnsNames:
  - '&lt;domain_name&gt;'              <span id="CO57-5"><!--Empty--></span><span class="callout">5</span>
  issuerRef:
    name: &lt;letsencrypt_staging&gt;    <span id="CO57-6"><!--Empty--></span><span class="callout">6</span>
    kind: Issuer</pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO57-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Provide a name for the certificate.
										</div></dd><dt><a href="#CO57-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Specify the namespace that you created for the issuer.
										</div></dd><dt><a href="#CO57-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;common_name&gt;</code> with your common name (CN).
										</div></dd><dt><a href="#CO57-4"><span class="callout">4</span></a> </dt><dd><div class="para">
											Specify the name of the secret to create that will contain the certificate.
										</div></dd><dt><a href="#CO57-5"><span class="callout">5</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;domain_name&gt;</code> with your domain name.
										</div></dd><dt><a href="#CO57-6"><span class="callout">6</span></a> </dt><dd><div class="para">
											Specify the name of the issuer that you created.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">Certificate</code> object by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f certificate.yaml</pre></li></ol></div></li></ol></div></section><section class="section" id="cert-manager-acme-dns01-explicit-gcp_cert-manager-operator-issuer-acme"><div class="titlepage"><div><div><h3 class="title">8.4.5. Configuring an ACME issuer by using explicit credentials for GCP Cloud DNS</h3></div></div></div><p>
					You can use the cert-manager Operator for Red Hat OpenShift to set up an ACME issuer to solve DNS-01 challenges by using explicit credentials on GCP. This procedure uses <span class="emphasis"><em>Let’s Encrypt</em></span> as the ACME CA server and shows how to solve DNS-01 challenges with Google CloudDNS.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							You have set up Google Cloud service account with a desired role for Google CloudDNS. For more information, see <a class="link" href="https://cert-manager.io/docs/configuration/acme/dns01/google/">Google CloudDNS</a> in the upstream cert-manager documentation.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								You can use Google CloudDNS with explicit credentials in an OpenShift Container Platform cluster that is not running on GCP.
							</p></div></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Optional: Override the nameserver settings for the DNS-01 self check.
						</p><p class="simpara">
							This step is required only when the target public-hosted zone overlaps with the cluster’s default private-hosted zone.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Edit the <code class="literal">CertManager</code> resource by running the following command:
								</p><pre class="programlisting language-terminal">$ oc edit certmanager cluster</pre></li><li class="listitem"><p class="simpara">
									Add a <code class="literal">spec.controllerConfig</code> section with the following override arguments:
								</p><pre class="programlisting language-yaml">apiVersion: operator.openshift.io/v1alpha1
kind: CertManager
metadata:
  name: cluster
  ...
spec:
  ...
  controllerConfig:                                <span id="CO58-1"><!--Empty--></span><span class="callout">1</span>
    overrideArgs:
      - '--dns01-recursive-nameservers-only'       <span id="CO58-2"><!--Empty--></span><span class="callout">2</span>
      - '--dns01-recursive-nameservers=1.1.1.1:53' <span id="CO58-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO58-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Add the <code class="literal">spec.controllerConfig</code> section.
										</div></dd><dt><a href="#CO58-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Specify to only use recursive nameservers instead of checking the authoritative nameservers associated with that domain.
										</div></dd><dt><a href="#CO58-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Provide a comma-separated list of <code class="literal">&lt;host&gt;:&lt;port&gt;</code> nameservers to query for the DNS-01 self check. You must use a <code class="literal">1.1.1.1:53</code> value to avoid the public and private zones overlapping.
										</div></dd></dl></div></li><li class="listitem">
									Save the file to apply the changes.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Optional: Create a namespace for the issuer:
						</p><pre class="programlisting language-terminal">$ oc new-project my-issuer-namespace</pre></li><li class="listitem"><p class="simpara">
							Create a secret to store your GCP credentials by running the following command:
						</p><pre class="programlisting language-terminal">$ oc create secret generic clouddns-dns01-solver-svc-acct --from-file=service_account.json=&lt;path/to/gcp_service_account.json&gt; -n my-issuer-namespace</pre></li><li class="listitem"><p class="simpara">
							Create an issuer:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create a YAML file that defines the <code class="literal">Issuer</code> object:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">issuer.yaml</code> file</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: cert-manager.io/v1
kind: Issuer
metadata:
  name: &lt;acme_dns01_clouddns_issuer&gt; <span id="CO59-1"><!--Empty--></span><span class="callout">1</span>
  namespace: &lt;issuer_namespace&gt; <span id="CO59-2"><!--Empty--></span><span class="callout">2</span>
spec:
  acme:
    preferredChain: ""
    privateKeySecretRef:
      name: &lt;secret_private_key&gt; <span id="CO59-3"><!--Empty--></span><span class="callout">3</span>
    server: https://acme-staging-v02.api.letsencrypt.org/directory <span id="CO59-4"><!--Empty--></span><span class="callout">4</span>
    solvers:
    - dns01:
        cloudDNS:
          project: &lt;project_id&gt; <span id="CO59-5"><!--Empty--></span><span class="callout">5</span>
          serviceAccountSecretRef:
            name: clouddns-dns01-solver-svc-acct <span id="CO59-6"><!--Empty--></span><span class="callout">6</span>
            key: service_account.json <span id="CO59-7"><!--Empty--></span><span class="callout">7</span></pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO59-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Provide a name for the issuer.
										</div></dd><dt><a href="#CO59-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;issuer_namespace&gt;</code> with your issuer namespace.
										</div></dd><dt><a href="#CO59-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;secret_private_key&gt;</code> with the name of the secret to store the ACME account private key in.
										</div></dd><dt><a href="#CO59-4"><span class="callout">4</span></a> </dt><dd><div class="para">
											Specify the URL to access the ACME server’s <code class="literal">directory</code> endpoint. This example uses the <span class="emphasis"><em>Let’s Encrypt</em></span> staging environment.
										</div></dd><dt><a href="#CO59-5"><span class="callout">5</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;project_id&gt;</code> with the name of the GCP project that contains the Cloud DNS zone.
										</div></dd><dt><a href="#CO59-6"><span class="callout">6</span></a> </dt><dd><div class="para">
											Specify the name of the secret you created.
										</div></dd><dt><a href="#CO59-7"><span class="callout">7</span></a> </dt><dd><div class="para">
											Specify the key in the secret you created that stores your GCP secret access key.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">Issuer</code> object by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f issuer.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create a certificate:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create a YAML file that defines the <code class="literal">Certificate</code> object:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">certificate.yaml</code> file</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: &lt;tls_cert&gt; <span id="CO60-1"><!--Empty--></span><span class="callout">1</span>
  namespace: &lt;issuer-namespace&gt; <span id="CO60-2"><!--Empty--></span><span class="callout">2</span>
spec:
  secretName: &lt;tls_cert&gt; <span id="CO60-3"><!--Empty--></span><span class="callout">3</span>
  issuerRef:
    name: issuer-acme-dns01-clouddns <span id="CO60-4"><!--Empty--></span><span class="callout">4</span>
  dnsNames:
  - '&lt;domain_name&gt;' <span id="CO60-5"><!--Empty--></span><span class="callout">5</span></pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO60-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Provide a name for the certificate.
										</div></dd><dt><a href="#CO60-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;issuer_namespace&gt;</code> with your issuer namespace.
										</div></dd><dt><a href="#CO60-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Specify the name of the secret to create that will contain the certificate.
										</div></dd><dt><a href="#CO60-4"><span class="callout">4</span></a> </dt><dd><div class="para">
											Specify the name of the issuer that you created.
										</div></dd><dt><a href="#CO60-5"><span class="callout">5</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;domain_name&gt;</code> with your domain name.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">Certificate</code> object by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f certificate.yaml</pre></li></ol></div></li></ol></div></section><section class="section" id="cert-manager-acme-dns01-ambient-gcp_cert-manager-operator-issuer-acme"><div class="titlepage"><div><div><h3 class="title">8.4.6. Configuring an ACME issuer by using ambient credentials on GCP</h3></div></div></div><p>
					You can use the cert-manager Operator for Red Hat OpenShift to set up an ACME issuer to solve DNS-01 challenges by using ambient credentials on GCP. This procedure uses <span class="emphasis"><em>Let’s Encrypt</em></span> as the ACME CA server and shows how to solve DNS-01 challenges with Google CloudDNS.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							If your cluster is configured to use GCP Workload Identity, you followed the instructions from the <span class="emphasis"><em>Configuring cloud credentials for the cert-manager Operator for Red Hat OpenShift with GCP Workload Identity</em></span> section.
						</li><li class="listitem">
							If your cluster does not use GCP Workload Identity, you followed the instructions from the <span class="emphasis"><em>Configuring cloud credentials for the cert-manager Operator for Red Hat OpenShift on GCP</em></span> section.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Optional: Override the nameserver settings for the DNS-01 self check.
						</p><p class="simpara">
							This step is required only when the target public-hosted zone overlaps with the cluster’s default private-hosted zone.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Edit the <code class="literal">CertManager</code> resource by running the following command:
								</p><pre class="programlisting language-terminal">$ oc edit certmanager cluster</pre></li><li class="listitem"><p class="simpara">
									Add a <code class="literal">spec.controllerConfig</code> section with the following override arguments:
								</p><pre class="programlisting language-yaml">apiVersion: operator.openshift.io/v1alpha1
kind: CertManager
metadata:
  name: cluster
  ...
spec:
  ...
  controllerConfig:                                <span id="CO61-1"><!--Empty--></span><span class="callout">1</span>
    overrideArgs:
      - '--dns01-recursive-nameservers-only'       <span id="CO61-2"><!--Empty--></span><span class="callout">2</span>
      - '--dns01-recursive-nameservers=1.1.1.1:53' <span id="CO61-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO61-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Add the <code class="literal">spec.controllerConfig</code> section.
										</div></dd><dt><a href="#CO61-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Specify to only use recursive nameservers instead of checking the authoritative nameservers associated with that domain.
										</div></dd><dt><a href="#CO61-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Provide a comma-separated list of <code class="literal">&lt;host&gt;:&lt;port&gt;</code> nameservers to query for the DNS-01 self check. You must use a <code class="literal">1.1.1.1:53</code> value to avoid the public and private zones overlapping.
										</div></dd></dl></div></li><li class="listitem">
									Save the file to apply the changes.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Optional: Create a namespace for the issuer:
						</p><pre class="programlisting language-terminal">$ oc new-project &lt;issuer_namespace&gt;</pre></li><li class="listitem"><p class="simpara">
							Modify the <code class="literal">CertManager</code> resource to add the <code class="literal">--issuer-ambient-credentials</code> argument:
						</p><pre class="programlisting language-terminal">$ oc patch certmanager/cluster \
  --type=merge \
  -p='{"spec":{"controllerConfig":{"overrideArgs":["--issuer-ambient-credentials"]}}}'</pre></li><li class="listitem"><p class="simpara">
							Create an issuer:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create a YAML file that defines the <code class="literal">Issuer</code> object:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">issuer.yaml</code> file</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: cert-manager.io/v1
kind: Issuer
metadata:
  name: &lt;acme_dns01_clouddns_issuer&gt; <span id="CO62-1"><!--Empty--></span><span class="callout">1</span>
  namespace: &lt;issuer_namespace&gt;
spec:
  acme:
    preferredChain: ""
    privateKeySecretRef:
      name: &lt;secret_private_key&gt; <span id="CO62-2"><!--Empty--></span><span class="callout">2</span>
    server: https://acme-staging-v02.api.letsencrypt.org/directory <span id="CO62-3"><!--Empty--></span><span class="callout">3</span>
    solvers:
    - dns01:
        cloudDNS:
          project: &lt;gcp_project_id&gt; <span id="CO62-4"><!--Empty--></span><span class="callout">4</span></pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO62-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Provide a name for the issuer.
										</div></dd><dt><a href="#CO62-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;secret_private_key&gt;</code> with the name of the secret to store the ACME account private key in.
										</div></dd><dt><a href="#CO62-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Specify the URL to access the ACME server’s <code class="literal">directory</code> endpoint. This example uses the <span class="emphasis"><em>Let’s Encrypt</em></span> staging environment.
										</div></dd><dt><a href="#CO62-4"><span class="callout">4</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;gcp_project_id&gt;</code> with the name of the GCP project that contains the Cloud DNS zone.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">Issuer</code> object by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f issuer.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create a certificate:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create a YAML file that defines the <code class="literal">Certificate</code> object:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">certificate.yaml</code> file</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: &lt;tls_cert&gt; <span id="CO63-1"><!--Empty--></span><span class="callout">1</span>
  namespace: &lt;issuer_namespace&gt;
spec:
  secretName: &lt;tls_cert&gt; <span id="CO63-2"><!--Empty--></span><span class="callout">2</span>
  issuerRef:
    name: &lt;acme-dns01-clouddns_issuer&gt; <span id="CO63-3"><!--Empty--></span><span class="callout">3</span>
  dnsNames:
  - '&lt;domain_name&gt;' <span id="CO63-4"><!--Empty--></span><span class="callout">4</span></pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO63-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Provide a name for the certificate.
										</div></dd><dt><a href="#CO63-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Specify the name of the secret to create that will contain the certificate.
										</div></dd><dt><a href="#CO63-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Specify the name of the issuer that you created.
										</div></dd><dt><a href="#CO63-4"><span class="callout">4</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;domain_name&gt;</code> with your domain name.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">Certificate</code> object by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f certificate.yaml</pre></li></ol></div></li></ol></div></section><section class="section" id="cert-manager-acme-dns01-explicit-azure_cert-manager-operator-issuer-acme"><div class="titlepage"><div><div><h3 class="title">8.4.7. Configuring an ACME issuer by using explicit credentials for Microsoft Azure DNS</h3></div></div></div><p>
					You can use cert-manager Operator for Red Hat OpenShift to set up an ACME issuer to solve DNS-01 challenges by using explicit credentials on Microsoft Azure. This procedure uses <span class="emphasis"><em>Let’s Encrypt</em></span> as the ACME CA server and shows how to solve DNS-01 challenges with Azure DNS.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							You have set up a service principal with desired role for Azure DNS. For more information, see <a class="link" href="https://cert-manager.io/docs/configuration/acme/dns01/azuredns/">Azure DNS</a> in the upstream cert-manager documentation.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								You can follow this procedure for an OpenShift Container Platform cluster that is not running on Microsoft Azure.
							</p></div></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Optional: Override the nameserver settings for the DNS-01 self check.
						</p><p class="simpara">
							This step is required only when the target public-hosted zone overlaps with the cluster’s default private-hosted zone.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Edit the <code class="literal">CertManager</code> resource by running the following command:
								</p><pre class="programlisting language-terminal">$ oc edit certmanager cluster</pre></li><li class="listitem"><p class="simpara">
									Add a <code class="literal">spec.controllerConfig</code> section with the following override arguments:
								</p><pre class="programlisting language-yaml">apiVersion: operator.openshift.io/v1alpha1
kind: CertManager
metadata:
  name: cluster
  ...
spec:
  ...
  controllerConfig:                                <span id="CO64-1"><!--Empty--></span><span class="callout">1</span>
    overrideArgs:
      - '--dns01-recursive-nameservers-only'       <span id="CO64-2"><!--Empty--></span><span class="callout">2</span>
      - '--dns01-recursive-nameservers=1.1.1.1:53' <span id="CO64-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO64-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Add the <code class="literal">spec.controllerConfig</code> section.
										</div></dd><dt><a href="#CO64-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Specify to only use recursive nameservers instead of checking the authoritative nameservers associated with that domain.
										</div></dd><dt><a href="#CO64-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Provide a comma-separated list of <code class="literal">&lt;host&gt;:&lt;port&gt;</code> nameservers to query for the DNS-01 self check. You must use a <code class="literal">1.1.1.1:53</code> value to avoid the public and private zones overlapping.
										</div></dd></dl></div></li><li class="listitem">
									Save the file to apply the changes.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Optional: Create a namespace for the issuer:
						</p><pre class="programlisting language-terminal">$ oc new-project my-issuer-namespace</pre></li><li class="listitem"><p class="simpara">
							Create a secret to store your Azure credentials in by running the following command:
						</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;secret_name&gt; --from-literal=&lt;azure_secret_access_key_name&gt;=&lt;azure_secret_access_key_value&gt; \ <span id="CO65-1"><!--Empty--></span><span class="callout">1</span> <span id="CO65-2"><!--Empty--></span><span class="callout">2</span> <span id="CO65-3"><!--Empty--></span><span class="callout">3</span>
    -n my-issuer-namespace</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO65-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Replace <code class="literal">&lt;secret_name&gt;</code> with your secret name.
								</div></dd><dt><a href="#CO65-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Replace <code class="literal">&lt;azure_secret_access_key_name&gt;</code> with your Azure secret access key name.
								</div></dd><dt><a href="#CO65-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Replace <code class="literal">&lt;azure_secret_access_key_value&gt;</code> with your Azure secret key.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Create an issuer:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create a YAML file that defines the <code class="literal">Issuer</code> object:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">issuer.yaml</code> file</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: cert-manager.io/v1
kind: Issuer
metadata:
  name: &lt;acme-dns01-azuredns-issuer&gt;   <span id="CO66-1"><!--Empty--></span><span class="callout">1</span>
  namespace: &lt;issuer_namespace&gt;   <span id="CO66-2"><!--Empty--></span><span class="callout">2</span>
spec:
  acme:
    preferredChain: ""
    privateKeySecretRef:
      name: &lt;secret_private_key&gt; <span id="CO66-3"><!--Empty--></span><span class="callout">3</span>
    server: https://acme-staging-v02.api.letsencrypt.org/directory <span id="CO66-4"><!--Empty--></span><span class="callout">4</span>
    solvers:
    - dns01:
        azureDNS:
          clientID: &lt;azure_client_id&gt; <span id="CO66-5"><!--Empty--></span><span class="callout">5</span>
          clientSecretSecretRef:
            name: &lt;secret_name&gt; <span id="CO66-6"><!--Empty--></span><span class="callout">6</span>
            key: &lt;azure_secret_access_key_name&gt; <span id="CO66-7"><!--Empty--></span><span class="callout">7</span>
          subscriptionID: &lt;azure_subscription_id&gt; <span id="CO66-8"><!--Empty--></span><span class="callout">8</span>
          tenantID: &lt;azure_tenant_id&gt; <span id="CO66-9"><!--Empty--></span><span class="callout">9</span>
          resourceGroupName: &lt;azure_dns_zone_resource_group&gt; <span id="CO66-10"><!--Empty--></span><span class="callout">10</span>
          hostedZoneName: &lt;azure_dns_zone&gt; <span id="CO66-11"><!--Empty--></span><span class="callout">11</span>
          environment: AzurePublicCloud</pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO66-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Provide a name for the issuer.
										</div></dd><dt><a href="#CO66-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;issuer_namespace&gt;</code> with your issuer namespace.
										</div></dd><dt><a href="#CO66-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;secret_private_key&gt;</code> with the name of the secret to store the ACME account private key in.
										</div></dd><dt><a href="#CO66-4"><span class="callout">4</span></a> </dt><dd><div class="para">
											Specify the URL to access the ACME server’s <code class="literal">directory</code> endpoint. This example uses the <span class="emphasis"><em>Let’s Encrypt</em></span> staging environment.
										</div></dd><dt><a href="#CO66-5"><span class="callout">5</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;azure_client_id&gt;</code> with your Azure client ID.
										</div></dd><dt><a href="#CO66-6"><span class="callout">6</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;secret_name&gt;</code> with a name of the client secret.
										</div></dd><dt><a href="#CO66-7"><span class="callout">7</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;azure_secret_access_key_name&gt;</code> with the client secret key name.
										</div></dd><dt><a href="#CO66-8"><span class="callout">8</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;azure_subscription_id&gt;</code> with your Azure subscription ID.
										</div></dd><dt><a href="#CO66-9"><span class="callout">9</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;azure_tenant_id&gt;</code> with your Azure tenant ID.
										</div></dd><dt><a href="#CO66-10"><span class="callout">10</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;azure_dns_zone_resource_group&gt;</code> with the name of the Azure DNS zone resource group.
										</div></dd><dt><a href="#CO66-11"><span class="callout">11</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;azure_dns_zone&gt;</code> with the name of Azure DNS zone.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">Issuer</code> object by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f issuer.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create a certificate:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create a YAML file that defines the <code class="literal">Certificate</code> object:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">certificate.yaml</code> file</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: &lt;tls_cert&gt; <span id="CO67-1"><!--Empty--></span><span class="callout">1</span>
  namespace: &lt;issuer-namespace&gt; <span id="CO67-2"><!--Empty--></span><span class="callout">2</span>
spec:
  secretName: &lt;tls_cert&gt; <span id="CO67-3"><!--Empty--></span><span class="callout">3</span>
  issuerRef:
    name: &lt;acme-dns01-azuredns-issuer&gt; <span id="CO67-4"><!--Empty--></span><span class="callout">4</span>
  dnsNames:
  - '&lt;domain_name&gt;' <span id="CO67-5"><!--Empty--></span><span class="callout">5</span></pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO67-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Provide a name for the certificate.
										</div></dd><dt><a href="#CO67-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;issuer_namespace&gt;</code> with your issuer namespace.
										</div></dd><dt><a href="#CO67-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Specify the name of the secret to create that will contain the certificate.
										</div></dd><dt><a href="#CO67-4"><span class="callout">4</span></a> </dt><dd><div class="para">
											Specify the name of the issuer that you created.
										</div></dd><dt><a href="#CO67-5"><span class="callout">5</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;domain_name&gt;</code> with your domain name.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">Certificate</code> object by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f certificate.yaml</pre></li></ol></div></li></ol></div></section><section class="section _additional-resources" id="additional-resources_cert-manager-operator-issuer-acme"><div class="titlepage"><div><div><h3 class="title">8.4.8. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-configure-cloud-credentials-aws-sts_cert-manager-authenticate-aws">Configuring cloud credentials for the cert-manager Operator for Red Hat OpenShift for the AWS Security Token Service cluster</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-configure-cloud-credentials-aws-non-sts_cert-manager-authentication-non-sts">Configuring cloud credentials for the cert-manager Operator for Red Hat OpenShift on AWS</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-configure-cloud-credentials-gcp-sts_cert-manager-authenticate-gcp">Configuring cloud credentials for the cert-manager Operator for Red Hat OpenShift with GCP Workload Identity</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-configure-cloud-credentials-gcp-non-sts_cert-manager-authenticate-non-sts-gcp">Configuring cloud credentials for the cert-manager Operator for Red Hat OpenShift on GCP</a>
						</li></ul></div></section></section><section class="section" id="cert-manager-monitoring"><div class="titlepage"><div><div><h2 class="title">8.5. Enabling monitoring for the cert-manager Operator for Red Hat OpenShift</h2></div></div></div><p>
				You can expose controller metrics for the cert-manager Operator for Red Hat OpenShift in the format provided by the Prometheus Operator.
			</p><section class="section" id="cert-manager-enable-metrics_cert-manager-monitoring"><div class="titlepage"><div><div><h3 class="title">8.5.1. Enabling monitoring by using a service monitor for the cert-manager Operator for Red Hat OpenShift</h3></div></div></div><p>
					You can enable monitoring and metrics collection for the cert-manager Operator for Red Hat OpenShift by using a service monitor to perform the custom metrics scraping.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster with <code class="literal">cluster-admin</code> privileges.
						</li><li class="listitem">
							The cert-manager Operator for Red Hat OpenShift is installed.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Add the label to enable cluster monitoring by running the following command:
						</p><pre class="programlisting language-terminal">$ oc label namespace cert-manager openshift.io/cluster-monitoring=true</pre></li><li class="listitem">
							Enable monitoring for user-defined projects. See <span class="emphasis"><em>Enabling monitoring for user-defined projects</em></span> for instructions.
						</li><li class="listitem"><p class="simpara">
							Create a service monitor:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create a YAML file that defines the <code class="literal">ServiceMonitor</code> object:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">service-monitor.yaml</code> file</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  labels:
    app: cert-manager
    app.kubernetes.io/component: controller
    app.kubernetes.io/instance: cert-manager
    app.kubernetes.io/name: cert-manager
  name: cert-manager
  namespace: cert-manager
spec:
  endpoints:
  - interval: 30s
    port: tcp-prometheus-servicemonitor
    scheme: http
  selector:
    matchLabels:
      app.kubernetes.io/component: controller
      app.kubernetes.io/instance: cert-manager
      app.kubernetes.io/name: cert-manager</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">ServiceMonitor</code> object by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f service-monitor.yaml</pre></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#enabling-monitoring-for-user-defined-projects_enabling-monitoring-for-user-defined-projects">Enabling monitoring for user-defined projects</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#setting-up-metrics-collection-for-user-defined-projects_managing-metrics">Setting up metrics collection for user-defined projects</a>
						</li></ul></div></section><section class="section" id="cert-manager-query-metrics_cert-manager-monitoring"><div class="titlepage"><div><div><h3 class="title">8.5.2. Querying metrics for the cert-manager Operator for Red Hat OpenShift</h3></div></div></div><p>
					After you have enabled monitoring for the cert-manager Operator for Red Hat OpenShift, you can query its metrics by using the OpenShift Container Platform web console.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li><li class="listitem">
							You have installed the cert-manager Operator for Red Hat OpenShift.
						</li><li class="listitem">
							You have enabled monitoring and metrics collection for the cert-manager Operator for Red Hat OpenShift.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							From the OpenShift Container Platform web console, navigate to <span class="strong strong"><strong>Observe</strong></span> → <span class="strong strong"><strong>Metrics</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Add a query by using one of the following formats:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Specify the endpoints:
								</p><pre class="programlisting language-promql">{instance="&lt;endpoint&gt;"} <span id="CO68-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO68-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Replace <code class="literal">&lt;endpoint&gt;</code> with the value of the endpoint for the <code class="literal">cert-manager</code> service. You can find the endpoint value by running the following command: <code class="literal">oc describe service cert-manager -n cert-manager</code>.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Specify the <code class="literal">tcp-prometheus-servicemonitor</code> port:
								</p><pre class="programlisting language-promql">{endpoint="tcp-prometheus-servicemonitor"}</pre></li></ul></div></li></ol></div></section></section><section class="section" id="cert-manager-operator-proxy"><div class="titlepage"><div><div><h2 class="title">8.6. Configuring the egress proxy for the cert-manager Operator for Red Hat OpenShift</h2></div></div></div><p>
				If a cluster-wide egress proxy is configured in OpenShift Container Platform, Operator Lifecycle Manager (OLM) automatically configures Operators that it manages with the cluster-wide proxy. OLM automatically updates all of the Operator’s deployments with the <code class="literal">HTTP_PROXY</code>, <code class="literal">HTTPS_PROXY</code>, <code class="literal">NO_PROXY</code> environment variables.
			</p><p>
				You can inject any CA certificates that are required for proxying HTTPS connections into the cert-manager Operator for Red Hat OpenShift.
			</p><section class="section" id="cert-manager-proxy-support_cert-manager-operator-proxy"><div class="titlepage"><div><div><h3 class="title">8.6.1. Injecting a custom CA certificate for the cert-manager Operator for Red Hat OpenShift</h3></div></div></div><p>
					If your OpenShift Container Platform cluster has the cluster-wide proxy enabled, you can inject any CA certificates that are required for proxying HTTPS connections into the cert-manager Operator for Red Hat OpenShift.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li><li class="listitem">
							You have enabled the cluster-wide proxy for OpenShift Container Platform.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a config map in the <code class="literal">cert-manager</code> namespace by running the following command:
						</p><pre class="programlisting language-terminal">$ oc create configmap trusted-ca -n cert-manager</pre></li><li class="listitem"><p class="simpara">
							Inject the CA bundle that is trusted by OpenShift Container Platform into the config map by running the following command:
						</p><pre class="programlisting language-terminal">$ oc label cm trusted-ca config.openshift.io/inject-trusted-cabundle=true -n cert-manager</pre></li><li class="listitem"><p class="simpara">
							Update the deployment for the cert-manager Operator for Red Hat OpenShift to use the config map by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n cert-manager-operator patch subscription openshift-cert-manager-operator --type='merge' -p '{"spec":{"config":{"env":[{"name":"TRUSTED_CA_CONFIGMAP_NAME","value":"trusted-ca"}]}}}'</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Verify that the deployments have finished rolling out by running the following command:
						</p><pre class="programlisting language-terminal">$ oc rollout status deployment/cert-manager-operator-controller-manager -n cert-manager-operator &amp;&amp; \
oc rollout status deployment/cert-manager -n cert-manager &amp;&amp; \
oc rollout status deployment/cert-manager-webhook -n cert-manager &amp;&amp; \
oc rollout status deployment/cert-manager-cainjector -n cert-manager</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">deployment "cert-manager-operator-controller-manager" successfully rolled out
deployment "cert-manager" successfully rolled out
deployment "cert-manager-webhook" successfully rolled out
deployment "cert-manager-cainjector" successfully rolled out</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Verify that the CA bundle was mounted as a volume by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get deployment cert-manager -n cert-manager -o=jsonpath={.spec.template.spec.'containers[0].volumeMounts'}</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">[{"mountPath":"/etc/pki/tls/certs/cert-manager-tls-ca-bundle.crt","name":"trusted-ca","subPath":"ca-bundle.crt"}]</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Verify that the source of the CA bundle is the <code class="literal">trusted-ca</code> config map by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get deployment cert-manager -n cert-manager -o=jsonpath={.spec.template.spec.volumes}</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">[{"configMap":{"defaultMode":420,"name":"trusted-ca"},"name":"trusted-ca"}]</pre>

							</p></div></li></ol></div></section><section class="section _additional-resources" id="cert-manager-operator-proxy_additional-resources"><div class="titlepage"><div><div><h3 class="title">8.6.2. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-configuring-proxy-support">Configuring proxy support in Operator Lifecycle Manager</a>
						</li></ul></div></section></section><section class="section" id="cert-manager-customizing-api-fields"><div class="titlepage"><div><div><h2 class="title">8.7. Customizing cert-manager Operator API fields</h2></div></div></div><p>
				You can customize the cert-manager Operator for Red Hat OpenShift API fields by overriding environment variables and arguments.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					To override unsupported arguments, you can add <code class="literal">spec.unsupportedConfigOverrides</code> section in the <code class="literal">CertManager</code> resource, but using <code class="literal">spec.unsupportedConfigOverrides</code> is unsupported.
				</p></div></div><section class="section" id="cert-manager-override-environment-variables_cert-manager-customizing-api-fields"><div class="titlepage"><div><div><h3 class="title">8.7.1. Customizing cert-manager by overriding environment variables from the cert-manager Operator API</h3></div></div></div><p>
					You can override the supported environment variables for the cert-manager Operator for Red Hat OpenShift by adding a <code class="literal">spec.controllerConfig</code> section in the <code class="literal">CertManager</code> resource.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the OpenShift Container Platform cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">CertManager</code> resource by running the following command:
						</p><pre class="programlisting language-terminal">$ oc edit certmanager cluster</pre></li><li class="listitem"><p class="simpara">
							Add a <code class="literal">spec.controllerConfig</code> section with the following override arguments:
						</p><pre class="programlisting language-yaml">apiVersion: operator.openshift.io/v1alpha1
kind: CertManager
metadata:
  name: cluster
  ...
spec:
  ...
  controllerConfig:
    overrideEnv:
      - name: HTTP_PROXY
        value: http://&lt;proxy_url&gt; <span id="CO69-1"><!--Empty--></span><span class="callout">1</span>
      - name: HTTPS_PROXY
        value: https://&lt;proxy_url&gt; <span id="CO69-2"><!--Empty--></span><span class="callout">2</span>
      - name: NO_PROXY
        value: &lt;ignore_proxy_domains&gt; <span id="CO69-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO69-1"><span class="callout">1</span></a> <a href="#CO69-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Replace <code class="literal">&lt;proxy_url&gt;</code> with the proxy server URL.
								</div></dd><dt><a href="#CO69-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Replace <code class="literal">&lt;ignore_proxy_domains&gt;</code> with a comma separated list of domains. These domains are ignored by the proxy server.
								</div></dd></dl></div></li><li class="listitem">
							Save your changes and quit the text editor to apply your changes.
						</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Verify that the cert-manager controller pod is redeployed by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get pods -l app.kubernetes.io/name=cert-manager -n cert-manager</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                          READY   STATUS    RESTARTS   AGE
cert-manager-bd7fbb9fc-wvbbt  1/1     Running   0          39s</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Verify that environment variables are updated for the cert-manager pod by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get pod &lt;redeployed_cert-manager_controller_pod&gt; -n cert-manager -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-yaml">    env:
    ...
    - name: HTTP_PROXY
      value: http://&lt;PROXY_URL&gt;
    - name: HTTPS_PROXY
      value: https://&lt;PROXY_URL&gt;
    - name: NO_PROXY
      value: &lt;IGNORE_PROXY_DOMAINS&gt;</pre>

							</p></div></li></ol></div></section><section class="section" id="cert-manager-override-arguments_cert-manager-customizing-api-fields"><div class="titlepage"><div><div><h3 class="title">8.7.2. Customizing cert-manager by overriding arguments from the cert-manager Operator API</h3></div></div></div><p>
					You can override the supported arguments for the cert-manager Operator for Red Hat OpenShift by adding a <code class="literal">spec.controllerConfig</code> section in the <code class="literal">CertManager</code> resource.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the OpenShift Container Platform cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">CertManager</code> resource by running the following command:
						</p><pre class="programlisting language-terminal">$ oc edit certmanager cluster</pre></li><li class="listitem"><p class="simpara">
							Add a <code class="literal">spec.controllerConfig</code> section with the following override arguments:
						</p><pre class="programlisting language-yaml">apiVersion: operator.openshift.io/v1alpha1
kind: CertManager
metadata:
  name: cluster
  ...
spec:
  ...
  controllerConfig:
    overrideArgs:
      - '--dns01-recursive-nameservers=&lt;host&gt;:&lt;port&gt;' <span id="CO70-1"><!--Empty--></span><span class="callout">1</span>
      - '--dns01-recursive-nameservers-only' <span id="CO70-2"><!--Empty--></span><span class="callout">2</span>
      - '--acme-http01-solver-nameservers=&lt;host&gt;:&lt;port&gt;' <span id="CO70-3"><!--Empty--></span><span class="callout">3</span>
      - '--v=&lt;verbosity_level&gt;' <span id="CO70-4"><!--Empty--></span><span class="callout">4</span>
      - '--metrics-listen-address=&lt;host&gt;:&lt;port&gt;' <span id="CO70-5"><!--Empty--></span><span class="callout">5</span>
      - '--issuer-ambient-credentials' <span id="CO70-6"><!--Empty--></span><span class="callout">6</span>
  webhookConfig:
    overrideArgs:
      - '--v=4' <span id="CO70-7"><!--Empty--></span><span class="callout">7</span>
  cainjectorConfig:
    overrideArgs:
      - '--v=2' <span id="CO70-8"><!--Empty--></span><span class="callout">8</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO70-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Provide a comma-separated list of <code class="literal">&lt;host&gt;:&lt;port&gt;</code> nameservers to query for the DNS-01 self check. For example, <code class="literal">--dns01-recursive-nameservers=1.1.1.1:53</code>.
								</div></dd><dt><a href="#CO70-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Specify to only use recursive nameservers instead of checking the authoritative nameservers associated with that domain.
								</div></dd><dt><a href="#CO70-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Provide a comma-separated list of <code class="literal">&lt;host&gt;:&lt;port&gt;</code> nameservers to query for the Automated Certificate Management Environment (ACME) HTTP01 self check. For example, <code class="literal">--acme-http01-solver-nameservers=1.1.1.1:53</code>.
								</div></dd><dt><a href="#CO70-4"><span class="callout">4</span></a> <a href="#CO70-7"><span class="callout">7</span></a> <a href="#CO70-8"><span class="callout">8</span></a> </dt><dd><div class="para">
									Specify to set the log level verbosity to determine the verbosity of log messages.
								</div></dd><dt><a href="#CO70-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									Specify the host and port for the metrics endpoint. The default value is <code class="literal">--metrics-listen-address=0.0.0.0:9402</code>.
								</div></dd><dt><a href="#CO70-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									You must use the <code class="literal">--issuer-ambient-credentials</code> argument when configuring an ACME Issuer to solve DNS-01 challenges by using ambient credentials.
								</div></dd></dl></div></li><li class="listitem">
							Save your changes and quit the text editor to apply your changes.
						</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Verify that arguments are updated for cert-manager pods by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get pods -n cert-manager -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-yaml">...
  metadata:
    name: cert-manager-6d4b5d4c97-kldwl
    namespace: cert-manager
...
  spec:
    containers:
    - args:
      - --acme-http01-solver-nameservers=1.1.1.1:53
      - --cluster-resource-namespace=$(POD_NAMESPACE)
      - --dns01-recursive-nameservers=1.1.1.1:53
      - --dns01-recursive-nameservers-only
      - --leader-election-namespace=kube-system
      - --max-concurrent-challenges=60
      - --metrics-listen-address=0.0.0.0:9042
      - --v=6
...
  metadata:
    name: cert-manager-cainjector-866c4fd758-ltxxj
    namespace: cert-manager
...
  spec:
    containers:
    - args:
      - --leader-election-namespace=kube-system
      - --v=2
...
  metadata:
    name: cert-manager-webhook-6d48f88495-c88gd
    namespace: cert-manager
...
  spec:
    containers:
    - args:
      ...
      - --v=4</pre>

							</p></div></li></ul></div></section><section class="section" id="cert-manager-override-flag-controller_cert-manager-customizing-api-fields"><div class="titlepage"><div><div><h3 class="title">8.7.3. Deleting a TLS secret automatically upon Certificate removal</h3></div></div></div><p>
					You can enable the <code class="literal">--enable-certificate-owner-ref</code> flag for the cert-manager Operator for Red Hat OpenShift by adding a <code class="literal">spec.controllerConfig</code> section in the <code class="literal">CertManager</code> resource. The <code class="literal">--enable-certificate-owner-ref</code> flag sets the certificate resource as an owner of the secret where the TLS certificate is stored.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						If you uninstall the cert-manager Operator for Red Hat OpenShift or delete certificate resources from the cluster, the secret is deleted automatically. This might cause network connectivity issues depending upon where the certificate TLS secret is being used.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the OpenShift Container Platform cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li><li class="listitem">
							You have installed the cert-manager Operator for Red Hat OpenShift 1.12.0 or later.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Check that the <code class="literal">Certificate</code> object and its secret are available by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get certificate</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                                             READY   SECRET                                           AGE
certificate-from-clusterissuer-route53-ambient   True    certificate-from-clusterissuer-route53-ambient   8h</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Edit the <code class="literal">CertManager</code> resource by running the following command:
						</p><pre class="programlisting language-terminal">$ oc edit certmanager cluster</pre></li><li class="listitem"><p class="simpara">
							Add a <code class="literal">spec.controllerConfig</code> section with the following override arguments:
						</p><pre class="programlisting language-yaml">apiVersion: operator.openshift.io/v1alpha1
kind: CertManager
metadata:
  name: cluster
# ...
spec:
# ...
  controllerConfig:
    overrideArgs:
      - '--enable-certificate-owner-ref'</pre></li><li class="listitem">
							Save your changes and quit the text editor to apply your changes.
						</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Verify that the <code class="literal">--enable-certificate-owner-ref</code> flag is updated for cert-manager controller pod by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get pods -l app.kubernetes.io/name=cert-manager -n cert-manager -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-yaml"># ...
  metadata:
    name: cert-manager-6e4b4d7d97-zmdnb
    namespace: cert-manager
# ...
  spec:
    containers:
    - args:
      - --enable-certificate-owner-ref</pre>

							</p></div></li></ul></div></section><section class="section" id="cert-manager-configure-cpu-memory_cert-manager-customizing-api-fields"><div class="titlepage"><div><div><h3 class="title">8.7.4. Overriding CPU and memory limits for the cert-manager components</h3></div></div></div><p>
					After installing the cert-manager Operator for Red Hat OpenShift, you can configure the CPU and memory limits from the cert-manager Operator for Red Hat OpenShift API for the cert-manager components such as cert-manager controller, CA injector, and Webhook.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the OpenShift Container Platform cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li><li class="listitem">
							You have installed the cert-manager Operator for Red Hat OpenShift 1.12.0 or later.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Check that the deployments of the cert-manager controller, CA injector, and Webhook are available by entering the following command:
						</p><pre class="programlisting language-terminal">$ oc get deployment -n cert-manager</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                      READY   UP-TO-DATE   AVAILABLE   AGE
cert-manager              1/1     1            1           53m
cert-manager-cainjector   1/1     1            1           53m
cert-manager-webhook      1/1     1            1           53m</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Before setting the CPU and memory limit, check the existing configuration for the cert-manager controller, CA injector, and Webhook by entering the following command:
						</p><pre class="programlisting language-terminal">$ oc get deployment -n cert-manager -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal"># ...
  metadata:
    name: cert-manager
    namespace: cert-manager
# ...
  spec:
    template:
      spec:
        containers:
        - name: cert-manager-controller
          resources: {} <span id="CO71-1"><!--Empty--></span><span class="callout">1</span>
# ...
  metadata:
    name: cert-manager-cainjector
    namespace: cert-manager
# ...
  spec:
    template:
      spec:
        containers:
        - name: cert-manager-cainjector
          resources: {} <span id="CO71-2"><!--Empty--></span><span class="callout">2</span>
# ...
  metadata:
    name: cert-manager-webhook
    namespace: cert-manager
# ...
  spec:
    template:
      spec:
        containers:
        - name: cert-manager-webhook
          resources: {} <span id="CO71-3"><!--Empty--></span><span class="callout">3</span>
# ...</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO71-1"><span class="callout">1</span></a> <a href="#CO71-2"><span class="callout">2</span></a> <a href="#CO71-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									The <code class="literal">spec.resources</code> field is empty by default. The cert-manager components do not have CPU and memory limits.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							To configure the CPU and memory limits for the cert-manager controller, CA injector, and Webhook, enter the following command:
						</p><pre class="programlisting language-terminal">$ oc patch certmanager.operator cluster --type=merge -p="
spec:
  controllerConfig:
    overrideResources:
      limits: <span id="CO72-1"><!--Empty--></span><span class="callout">1</span>
        cpu: 200m <span id="CO72-2"><!--Empty--></span><span class="callout">2</span>
        memory: 64Mi <span id="CO72-3"><!--Empty--></span><span class="callout">3</span>
      requests: <span id="CO72-4"><!--Empty--></span><span class="callout">4</span>
        cpu: 200m <span id="CO72-5"><!--Empty--></span><span class="callout">5</span>
        memory: 64Mi <span id="CO72-6"><!--Empty--></span><span class="callout">6</span>
  webhookConfig:
    overrideResources:
      limits: <span id="CO72-7"><!--Empty--></span><span class="callout">7</span>
        cpu: 200m <span id="CO72-8"><!--Empty--></span><span class="callout">8</span>
        memory: 64Mi <span id="CO72-9"><!--Empty--></span><span class="callout">9</span>
      requests: <span id="CO72-10"><!--Empty--></span><span class="callout">10</span>
        cpu: 200m <span id="CO72-11"><!--Empty--></span><span class="callout">11</span>
        memory: 64Mi <span id="CO72-12"><!--Empty--></span><span class="callout">12</span>
  cainjectorConfig:
    overrideResources:
      limits: <span id="CO72-13"><!--Empty--></span><span class="callout">13</span>
        cpu: 200m <span id="CO72-14"><!--Empty--></span><span class="callout">14</span>
        memory: 64Mi <span id="CO72-15"><!--Empty--></span><span class="callout">15</span>
      requests: <span id="CO72-16"><!--Empty--></span><span class="callout">16</span>
        cpu: 200m <span id="CO72-17"><!--Empty--></span><span class="callout">17</span>
        memory: 64Mi <span id="CO72-18"><!--Empty--></span><span class="callout">18</span>
"</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO72-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Defines the maximum amount of CPU and memory that a single container in a cert-manager controller pod can request.
								</div></dd><dt><a href="#CO72-2"><span class="callout">2</span></a> <a href="#CO72-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									You can specify the CPU limit that a cert-manager controller pod can request. The default value is <code class="literal">10m</code>.
								</div></dd><dt><a href="#CO72-3"><span class="callout">3</span></a> <a href="#CO72-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									You can specify the memory limit that a cert-manager controller pod can request. The default value is <code class="literal">32Mi</code>.
								</div></dd><dt><a href="#CO72-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									Defines the amount of CPU and memory set by scheduler for the cert-manager controller pod.
								</div></dd><dt><a href="#CO72-7"><span class="callout">7</span></a> </dt><dd><div class="para">
									Defines the maximum amount of CPU and memory that a single container in a CA injector pod can request.
								</div></dd><dt><a href="#CO72-8"><span class="callout">8</span></a> <a href="#CO72-11"><span class="callout">11</span></a> </dt><dd><div class="para">
									You can specify the CPU limit that a CA injector pod can request. The default value is <code class="literal">10m</code>.
								</div></dd><dt><a href="#CO72-9"><span class="callout">9</span></a> <a href="#CO72-12"><span class="callout">12</span></a> </dt><dd><div class="para">
									You can specify the memory limit that a CA injector pod can request. The default value is <code class="literal">32Mi</code>.
								</div></dd><dt><a href="#CO72-10"><span class="callout">10</span></a> </dt><dd><div class="para">
									Defines the amount of CPU and memory set by scheduler for the CA injector pod.
								</div></dd><dt><a href="#CO72-13"><span class="callout">13</span></a> </dt><dd><div class="para">
									Defines the maximum amount of CPU and memory Defines the maximum amount of CPU and memory that a single container in a Webhook pod can request.
								</div></dd><dt><a href="#CO72-14"><span class="callout">14</span></a> <a href="#CO72-17"><span class="callout">17</span></a> </dt><dd><div class="para">
									You can specify the CPU limit that a Webhook pod can request. The default value is <code class="literal">10m</code>.
								</div></dd><dt><a href="#CO72-15"><span class="callout">15</span></a> <a href="#CO72-18"><span class="callout">18</span></a> </dt><dd><div class="para">
									You can specify the memory limit that a Webhook pod can request. The default value is <code class="literal">32Mi</code>.
								</div></dd><dt><a href="#CO72-16"><span class="callout">16</span></a> </dt><dd><div class="para">
									Defines the amount of CPU and memory set by scheduler for the Webhook pod.
								</div></dd></dl></div><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-termnal">certmanager.operator.openshift.io/cluster patched</pre>

							</p></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Verify that the CPU and memory limits are updated for the cert-manager components:
						</p><pre class="programlisting language-terminal">$ oc get deployment -n cert-manager -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal"># ...
  metadata:
    name: cert-manager
    namespace: cert-manager
# ...
  spec:
    template:
      spec:
        containers:
        - name: cert-manager-controller
          resources:
            limits:
              cpu: 200m
              memory: 64Mi
            requests:
              cpu: 10m
              memory: 16Mi
# ...
  metadata:
    name: cert-manager-cainjector
    namespace: cert-manager
# ...
  spec:
    template:
      spec:
        containers:
        - name: cert-manager-cainjector
          resources:
            limits:
              cpu: 200m
              memory: 64Mi
            requests:
              cpu: 10m
              memory: 16Mi
# ...
  metadata:
    name: cert-manager-webhook
    namespace: cert-manager
# ...
  spec:
    template:
      spec:
        containers:
        - name: cert-manager-webhook
          resources:
            limits:
              cpu: 200m
              memory: 64Mi
            requests:
              cpu: 10m
              memory: 16Mi
# ...</pre>

							</p></div></li></ol></div></section></section><section class="section" id="cert-manager-authenticate-aws"><div class="titlepage"><div><div><h2 class="title">8.8. Authenticating the cert-manager Operator for Red Hat OpenShift with AWS Security Token Service</h2></div></div></div><p>
				You can authenticate the cert-manager Operator for Red Hat OpenShift on the AWS Security Token Service (STS) cluster. You can configure cloud credentials for the cert-manager Operator for Red Hat OpenShift by using the <code class="literal">ccoctl</code> binary.
			</p><section class="section" id="cert-manager-configure-cloud-credentials-aws-sts_cert-manager-authenticate-aws"><div class="titlepage"><div><div><h3 class="title">8.8.1. Configuring cloud credentials for the cert-manager Operator for Red Hat OpenShift for the AWS Security Token Service cluster</h3></div></div></div><p>
					To configure the cloud credentials for the cert-manager Operator for Red Hat OpenShift on the AWS Security Token Service (STS) cluster with the cloud credentials. You must generate the cloud credentials manually, and apply it on the cluster by using the <code class="literal">ccoctl</code> binary.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have extracted and prepared the <code class="literal">ccoctl</code> binary.
						</li><li class="listitem">
							You have configured an OpenShift Container Platform cluster with AWS STS by using the Cloud Credential Operator in manual mode.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a directory to store a <code class="literal">CredentialsRequest</code> resource YAML file by running the following command:
						</p><pre class="programlisting language-terminal">$ mkdir credentials-request</pre></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">CredentialsRequest</code> resource YAML file under the <code class="literal">credentials-request</code> directory, such as, <code class="literal">sample-credential-request.yaml</code>, by applying the following yaml:
						</p><pre class="programlisting language-yaml">apiVersion: cloudcredential.openshift.io/v1
kind: CredentialsRequest
metadata:
  name: cert-manager
  namespace: openshift-cloud-credential-operator
spec:
  providerSpec:
    apiVersion: cloudcredential.openshift.io/v1
    kind: AWSProviderSpec
    statementEntries:
    - action:
      - "route53:GetChange"
      effect: Allow
      resource: "arn:aws:route53:::change/*"
    - action:
      - "route53:ChangeResourceRecordSets"
      - "route53:ListResourceRecordSets"
      effect: Allow
      resource: "arn:aws:route53:::hostedzone/*"
    - action:
      - "route53:ListHostedZonesByName"
      effect: Allow
      resource: "*"
  secretRef:
    name: aws-creds
    namespace: cert-manager
  serviceAccountNames:
  - cert-manager</pre></li><li class="listitem"><p class="simpara">
							Use the <code class="literal">ccoctl</code> tool to process <code class="literal">CredentialsRequest</code> objects by running the following command:
						</p><pre class="programlisting language-terminal">$ ccoctl aws create-iam-roles \
    --name &lt;user_defined_name&gt; --region=&lt;aws_region&gt; \
    --credentials-requests-dir=&lt;path_to_credrequests_dir&gt; \
    --identity-provider-arn &lt;oidc_provider_arn&gt; --output-dir=&lt;path_to_output_dir&gt;</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">2023/05/15 18:10:34 Role arn:aws:iam::XXXXXXXXXXXX:role/&lt;user_defined_name&gt;-cert-manager-aws-creds created
2023/05/15 18:10:34 Saved credentials configuration to: &lt;path_to_output_dir&gt;/manifests/cert-manager-aws-creds-credentials.yaml
2023/05/15 18:10:35 Updated Role policy for Role &lt;user_defined_name&gt;-cert-manager-aws-creds</pre>

							</p></div><p class="simpara">
							Copy the <code class="literal">&lt;aws_role_arn&gt;</code> from the output to use in the next step. For example, <code class="literal">"arn:aws:iam::XXXXXXXXXXXX:role/&lt;user_defined_name&gt;-cert-manager-aws-creds"</code>
						</p></li><li class="listitem"><p class="simpara">
							Add the <code class="literal">eks.amazonaws.com/role-arn="&lt;aws_role_arn&gt;"</code> annotation to the service account by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n cert-manager annotate serviceaccount cert-manager eks.amazonaws.com/role-arn="&lt;aws_role_arn&gt;"</pre></li><li class="listitem"><p class="simpara">
							To create a new pod, delete the existing cert-manager controller pod by running the following command:
						</p><pre class="programlisting language-terminal">$ oc delete pods -l app.kubernetes.io/name=cert-manager -n cert-manager</pre><p class="simpara">
							The AWS credentials are applied to a new cert-manager controller pod within a minute.
						</p></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Get the name of the updated cert-manager controller pod by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get pods -l app.kubernetes.io/name=cert-manager -n cert-manager</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                          READY   STATUS    RESTARTS   AGE
cert-manager-bd7fbb9fc-wvbbt  1/1     Running   0          39s</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Verify that AWS credentials are updated by running the following command:
						</p><pre class="programlisting language-terminal">$ oc set env -n cert-manager po/&lt;cert_manager_controller_pod_name&gt; --list</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal"># pods/cert-manager-57f9555c54-vbcpg, container cert-manager-controller
# POD_NAMESPACE from field path metadata.namespace
AWS_ROLE_ARN=XXXXXXXXXXXX
AWS_WEB_IDENTITY_TOKEN_FILE=/var/run/secrets/eks.amazonaws.com/serviceaccount/token</pre>

							</p></div></li></ol></div></section><section class="section _additional-resources" id="additional-resources_cert-manager-authenticate-gcp"><div class="titlepage"><div><div><h3 class="title">8.8.2. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#cco-ccoctl-configuring_cco-mode-sts">Configuring the Cloud Credential Operator utility</a>
						</li></ul></div></section></section><section class="section" id="cert-manager-log-levels"><div class="titlepage"><div><div><h2 class="title">8.9. Configuring log levels for cert-manager and the cert-manager Operator for Red Hat OpenShift</h2></div></div></div><p>
				To troubleshoot issues with the cert-manager components and the cert-manager Operator for Red Hat OpenShift, you can configure the log level verbosity.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					To use different log levels for different cert-manager components, see <span class="emphasis"><em>Customizing cert-manager Operator API fields</em></span>.
				</p></div></div><section class="section" id="cert-manager-enable-operand-log-level_cert-manager-log-levels"><div class="titlepage"><div><div><h3 class="title">8.9.1. Setting a log level for cert-manager</h3></div></div></div><p>
					You can set a log level for cert-manager to determine the verbosity of log messages.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster with <code class="literal">cluster-admin</code> privileges.
						</li><li class="listitem">
							You have installed the cert-manager Operator for Red Hat OpenShift 1.11.1 or later.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">CertManager</code> resource by running the following command:
						</p><pre class="programlisting language-terminal">$ oc edit certmanager.operator cluster</pre></li><li class="listitem"><p class="simpara">
							Set the log level value by editing the <code class="literal">spec.logLevel</code> section:
						</p><pre class="programlisting language-yaml">apiVersion: operator.openshift.io/v1alpha1
kind: CertManager
...
spec:
  logLevel: Normal <span id="CO73-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO73-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									The default <code class="literal">logLevel</code> is <code class="literal">Normal</code>. Replace <code class="literal">Normal</code> with the desired log level value. The valid log level values for the <code class="literal">CertManager</code> resource are <code class="literal">Normal</code>, <code class="literal">Debug</code>, <code class="literal">Trace</code>, and <code class="literal">TraceAll</code>. To audit logs and perform common operations when everything is fine, set <code class="literal">logLevel</code> to <code class="literal">Normal</code> . To troubleshoot a minor issue by viewing verbose logs, set <code class="literal">logLevel</code> to <code class="literal">Debug</code> . To troubleshoot a major issue by viewing more verbose logs, you can set <code class="literal">logLevel</code> to <code class="literal">Trace</code>. To troubleshoot serious issues, set <code class="literal">logLevel</code> to <code class="literal">TraceAll</code>.
								</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								<code class="literal">TraceAll</code> generates huge amount of logs. After setting <code class="literal">logLevel</code> to <code class="literal">TraceAll</code>, you might experience performance issues.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Save your changes and quit the text editor to apply your changes.
						</p><p class="simpara">
							After applying the changes, the verbosity level for the cert-manager components controller, CA injector, and webhook is updated.
						</p></li></ol></div></section><section class="section" id="cert-manager-enable-operator-log-level_cert-manager-log-levels"><div class="titlepage"><div><div><h3 class="title">8.9.2. Setting a log level for the cert-manager Operator for Red Hat OpenShift</h3></div></div></div><p>
					You can set a log level for the cert-manager Operator for Red Hat OpenShift to determine the verbosity of the operator log messages.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster with <code class="literal">cluster-admin</code> privileges.
						</li><li class="listitem">
							You have installed the cert-manager Operator for Red Hat OpenShift 1.11.1 or later.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Update the subscription object for cert-manager Operator for Red Hat OpenShift to provide the verbosity level for the operator logs by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n cert-manager-operator patch subscription openshift-cert-manager-operator --type='merge' -p '{"spec":{"config":{"env":[{"name":"OPERATOR_LOG_LEVEL","value":"v"}]}}}' <span id="CO74-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO74-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Replace <code class="literal">v</code> with the desired log level number. The valid values for <code class="literal">v</code> can range from <code class="literal">1`to `10</code>. The default value is <code class="literal">2</code>.
								</div></dd></dl></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							The cert-manager Operator pod is redeployed. Verify that the log level of the cert-manager Operator for Red Hat OpenShift is updated by running the following command:
						</p><pre class="programlisting language-terminal">$ oc set env deploy/cert-manager-operator-controller-manager -n cert-manager-operator --list | grep -e OPERATOR_LOG_LEVEL -e container</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal"># deployments/cert-manager-operator-controller-manager, container kube-rbac-proxy
OPERATOR_LOG_LEVEL=9
# deployments/cert-manager-operator-controller-manager, container cert-manager-operator
OPERATOR_LOG_LEVEL=9</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Verify that the log level of the cert-manager Operator for Red Hat OpenShift is updated by running the <code class="literal">oc logs</code> command:
						</p><pre class="programlisting language-terminal">$ oc logs deploy/cert-manager-operator-controller-manager -n cert-manager-operator</pre></li></ol></div></section><section class="section _additional-resources" id="cert-manager-log-levels_additional-resources"><div class="titlepage"><div><div><h3 class="title">8.9.3. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#cert-manager-customizing-api-fields">Customizing cert-manager Operator API fields</a>
						</li></ul></div></section></section><section class="section" id="cert-manager-authenticate-gcp"><div class="titlepage"><div><div><h2 class="title">8.10. Authenticating the cert-manager Operator for Red Hat OpenShift with GCP Workload Identity</h2></div></div></div><p>
				You can authenticate the cert-manager Operator for Red Hat OpenShift on the GCP Workload Identity cluster by using the cloud credentials. You can configure the cloud credentials by using the <code class="literal">ccoctl</code> binary.
			</p><section class="section" id="cert-manager-configure-cloud-credentials-gcp-sts_cert-manager-authenticate-gcp"><div class="titlepage"><div><div><h3 class="title">8.10.1. Configuring cloud credentials for the cert-manager Operator for Red Hat OpenShift with GCP Workload Identity</h3></div></div></div><p>
					Generate the cloud credentials for the cert-manager Operator for Red Hat OpenShift by using the <code class="literal">ccoctl</code> binary. Then, apply them to the GCP Workload Identity cluster.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You extracted and prepared the <code class="literal">ccoctl</code> binary.
						</li><li class="listitem">
							The cert-manager Operator for Red Hat OpenShift 1.11.1 or later is installed.
						</li><li class="listitem">
							You have configured an OpenShift Container Platform cluster with GCP Workload Identity by using the Cloud Credential Operator in a manual mode.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a directory to store a <code class="literal">CredentialsRequest</code> resource YAML file by running the following command:
						</p><pre class="programlisting language-terminal">$ mkdir credentials-request</pre></li><li class="listitem"><p class="simpara">
							In the <code class="literal">credentials-request</code> directory, create a YAML file that contains the following <code class="literal">CredentialsRequest</code> manifest:
						</p><pre class="programlisting language-yaml">apiVersion: cloudcredential.openshift.io/v1
kind: CredentialsRequest
metadata:
  name: cert-manager
  namespace: openshift-cloud-credential-operator
spec:
  providerSpec:
    apiVersion: cloudcredential.openshift.io/v1
    kind: GCPProviderSpec
    predefinedRoles:
    - roles/dns.admin
  secretRef:
    name: gcp-credentials
    namespace: cert-manager
  serviceAccountNames:
  - cert-manager</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The <code class="literal">dns.admin</code> role provides admin privileges to the service account for managing Google Cloud DNS resources. To ensure that the cert-manager runs with the service account that has the least privilege, you can create a custom role with the following permissions:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">dns.resourceRecordSets.*</code>
									</li><li class="listitem">
										<code class="literal">dns.changes.*</code>
									</li><li class="listitem">
										<code class="literal">dns.managedZones.list</code>
									</li></ul></div></div></div></li><li class="listitem"><p class="simpara">
							Use the <code class="literal">ccoctl</code> tool to process <code class="literal">CredentialsRequest</code> objects by running the following command:
						</p><pre class="programlisting language-terminal">$ ccoctl gcp create-service-accounts \
    --name &lt;user_defined_name&gt; --output-dir=&lt;path_to_output_dir&gt; \
    --credentials-requests-dir=&lt;path_to_credrequests_dir&gt; \
    --workload-identity-pool &lt;workload_identity_pool&gt; \
    --workload-identity-provider &lt;workload_identity_provider&gt; \
    --project &lt;gcp_project_id&gt;</pre><div class="formalpara"><p class="title"><strong>Example command</strong></p><p>
								
<pre class="programlisting language-terminal">$ ccoctl gcp create-service-accounts \
    --name abcde-20230525-4bac2781 --output-dir=/home/outputdir \
    --credentials-requests-dir=/home/credentials-requests \
    --workload-identity-pool abcde-20230525-4bac2781 \
    --workload-identity-provider abcde-20230525-4bac2781 \
    --project openshift-gcp-devel</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Apply the secrets generated in the manifests directory of your cluster by running the following command:
						</p><pre class="programlisting language-terminal">$ ls &lt;path_to_output_dir&gt;/manifests/*-credentials.yaml | xargs -I{} oc apply -f {}</pre></li><li class="listitem"><p class="simpara">
							Update the subscription object for cert-manager Operator for Red Hat OpenShift by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n cert-manager-operator patch subscription openshift-cert-manager-operator --type=merge -p '{"spec":{"config":{"env":[{"name":"CLOUD_CREDENTIALS_SECRET_NAME","value":"gcp-credentials"}]}}}'</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Get the name of the redeployed cert-manager controller pod by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get pods -l app.kubernetes.io/name=cert-manager -n cert-manager</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                          READY   STATUS    RESTARTS   AGE
cert-manager-bd7fbb9fc-wvbbt  1/1     Running   0          15m39s</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Verify that the cert-manager controller pod is updated with GCP workload identity credential volumes that are mounted under the path specified in <code class="literal">mountPath</code> by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get -n cert-manager pod/&lt;cert-manager_controller_pod_name&gt; -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">spec:
  containers:
  - args:
    ...
    volumeMounts:
    - mountPath: /var/run/secrets/openshift/serviceaccount
      name: bound-sa-token
      ...
    - mountPath: /.config/gcloud
      name: cloud-credentials
  ...
  volumes:
  - name: bound-sa-token
    projected:
      ...
      sources:
      - serviceAccountToken:
          audience: openshift
          ...
          path: token
  - name: cloud-credentials
    secret:
      ...
      items:
      - key: service_account.json
        path: application_default_credentials.json
      secretName: gcp-credentials</pre>

							</p></div></li></ol></div></section><section class="section _additional-resources" id="additional-resources_cert-manager-authenticate-gcp-workload-identity"><div class="titlepage"><div><div><h3 class="title">8.10.2. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#cco-ccoctl-configuring_cco-mode-sts">Configuring the Cloud Credential Operator utility</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#gcp-workload-identity-mode-installing">Configuring an OpenShift Container Platform cluster by using the manual mode with GCP Workload Identity</a>
						</li></ul></div></section></section><section class="section" id="cert-manager-authentication-non-sts"><div class="titlepage"><div><div><h2 class="title">8.11. Authenticating the cert-manager Operator for Red Hat OpenShift on AWS</h2></div></div></div><p>
				You can configure the cloud credentials for the cert-manager Operator for Red Hat OpenShift on the AWS cluster. The cloud credentials are generated by the Cloud Credential Operator.
			</p><section class="section" id="cert-manager-configure-cloud-credentials-aws-non-sts_cert-manager-authentication-non-sts"><div class="titlepage"><div><div><h3 class="title">8.11.1. Configuring cloud credentials for the cert-manager Operator for Red Hat OpenShift on AWS</h3></div></div></div><p>
					To configure the cloud credentials for the cert-manager Operator for Red Hat OpenShift on the AWS cluster you must generate the cloud credentials secret by creating a <code class="literal">CredentialsRequest</code> object, and allowing the Cloud Credential Operator.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have installed the cert-manager Operator for Red Hat OpenShift 1.11.1 or later.
						</li><li class="listitem">
							You have configured the Cloud Credential Operator to operate in <span class="emphasis"><em>mint</em></span> or <span class="emphasis"><em>passthrough</em></span> mode.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a <code class="literal">CredentialsRequest</code> resource YAML file, for example, <code class="literal">sample-credential-request.yaml</code>, as follows:
						</p><pre class="programlisting language-yaml">apiVersion: cloudcredential.openshift.io/v1
kind: CredentialsRequest
metadata:
  name: cert-manager
  namespace: openshift-cloud-credential-operator
spec:
  providerSpec:
    apiVersion: cloudcredential.openshift.io/v1
    kind: AWSProviderSpec
    statementEntries:
    - action:
      - "route53:GetChange"
      effect: Allow
      resource: "arn:aws:route53:::change/*"
    - action:
      - "route53:ChangeResourceRecordSets"
      - "route53:ListResourceRecordSets"
      effect: Allow
      resource: "arn:aws:route53:::hostedzone/*"
    - action:
      - "route53:ListHostedZonesByName"
      effect: Allow
      resource: "*"
  secretRef:
    name: aws-creds
    namespace: cert-manager
  serviceAccountNames:
  - cert-manager</pre></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">CredentialsRequest</code> resource by running the following command:
						</p><pre class="programlisting language-terminal">$ oc create -f sample-credential-request.yaml</pre></li><li class="listitem"><p class="simpara">
							Update the subscription object for cert-manager Operator for Red Hat OpenShift by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n cert-manager-operator patch subscription openshift-cert-manager-operator --type=merge -p '{"spec":{"config":{"env":[{"name":"CLOUD_CREDENTIALS_SECRET_NAME","value":"aws-creds"}]}}}'</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Get the name of the redeployed cert-manager controller pod by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get pods -l app.kubernetes.io/name=cert-manager -n cert-manager</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                          READY   STATUS    RESTARTS   AGE
cert-manager-bd7fbb9fc-wvbbt  1/1     Running   0          15m39s</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Verify that the cert-manager controller pod is updated with AWS credential volumes that are mounted under the path specified in <code class="literal">mountPath</code> by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get -n cert-manager pod/&lt;cert-manager_controller_pod_name&gt; -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">...
spec:
  containers:
  - args:
    ...
    - mountPath: /.aws
      name: cloud-credentials
  ...
  volumes:
  ...
  - name: cloud-credentials
    secret:
      ...
      secretName: aws-creds</pre>

							</p></div></li></ol></div></section></section><section class="section" id="cert-manager-authenticate-non-sts-gcp"><div class="titlepage"><div><div><h2 class="title">8.12. Authenticating the cert-manager Operator for Red Hat OpenShift on GCP</h2></div></div></div><p>
				You can configure cloud credentials for the cert-manager Operator for Red Hat OpenShift on a GCP cluster. The cloud credentials are generated by the Cloud Credential Operator.
			</p><section class="section" id="cert-manager-configure-cloud-credentials-gcp-non-sts_cert-manager-authenticate-non-sts-gcp"><div class="titlepage"><div><div><h3 class="title">8.12.1. Configuring cloud credentials for the cert-manager Operator for Red Hat OpenShift on GCP</h3></div></div></div><p>
					To configure the cloud credentials for the cert-manager Operator for Red Hat OpenShift on a GCP cluster you must create a <code class="literal">CredentialsRequest</code> object, and allow the Cloud Credential Operator to generate the cloud credentials secret.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have installed the cert-manager Operator for Red Hat OpenShift 1.11.1 or later.
						</li><li class="listitem">
							You have configured the Cloud Credential Operator to operate in <span class="emphasis"><em>mint</em></span> or <span class="emphasis"><em>passthrough</em></span> mode.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a <code class="literal">CredentialsRequest</code> resource YAML file, such as, <code class="literal">sample-credential-request.yaml</code> by applying the following yaml:
						</p><pre class="programlisting language-yaml">apiVersion: cloudcredential.openshift.io/v1
kind: CredentialsRequest
metadata:
  name: cert-manager
  namespace: openshift-cloud-credential-operator
spec:
  providerSpec:
    apiVersion: cloudcredential.openshift.io/v1
    kind: GCPProviderSpec
    predefinedRoles:
    - roles/dns.admin
  secretRef:
    name: gcp-credentials
    namespace: cert-manager
  serviceAccountNames:
  - cert-manager</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The <code class="literal">dns.admin</code> role provides admin privileges to the service account for managing Google Cloud DNS resources. To ensure that the cert-manager runs with the service account that has the least privilege, you can create a custom role with the following permissions:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">dns.resourceRecordSets.*</code>
									</li><li class="listitem">
										<code class="literal">dns.changes.*</code>
									</li><li class="listitem">
										<code class="literal">dns.managedZones.list</code>
									</li></ul></div></div></div></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">CredentialsRequest</code> resource by running the following command:
						</p><pre class="programlisting language-terminal">$ oc create -f sample-credential-request.yaml</pre></li><li class="listitem"><p class="simpara">
							Update the subscription object for cert-manager Operator for Red Hat OpenShift by running the following command:
						</p><pre class="programlisting language-terminal">$ oc -n cert-manager-operator patch subscription openshift-cert-manager-operator --type=merge -p '{"spec":{"config":{"env":[{"name":"CLOUD_CREDENTIALS_SECRET_NAME","value":"gcp-credentials"}]}}}'</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Get the name of the redeployed cert-manager controller pod by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get pods -l app.kubernetes.io/name=cert-manager -n cert-manager</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                                       READY   STATUS    RESTARTS   AGE
cert-manager-bd7fbb9fc-wvbbt               1/1     Running   0          15m39s</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Verify that the cert-manager controller pod is updated with GCP credential volumes that are mounted under the path specified in <code class="literal">mountPath</code> by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get -n cert-manager pod/&lt;cert-manager_controller_pod_name&gt; -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">spec:
  containers:
  - args:
    ...
    volumeMounts:
    ...
    - mountPath: /.config/gcloud
      name: cloud-credentials
    ....
  volumes:
  ...
  - name: cloud-credentials
    secret:
      ...
      items:
      - key: service_account.json
        path: application_default_credentials.json
      secretName: gcp-credentials</pre>

							</p></div></li></ol></div></section></section><section class="section" id="cert-manager-operator-uninstall"><div class="titlepage"><div><div><h2 class="title">8.13. Uninstalling the cert-manager Operator for Red Hat OpenShift</h2></div></div></div><p>
				You can remove the cert-manager Operator for Red Hat OpenShift from OpenShift Container Platform by uninstalling the Operator and removing its related resources.
			</p><section class="section" id="cert-manager-uninstall-console_cert-manager-operator-uninstall"><div class="titlepage"><div><div><h3 class="title">8.13.1. Uninstalling the cert-manager Operator for Red Hat OpenShift</h3></div></div></div><p>
					You can uninstall the cert-manager Operator for Red Hat OpenShift by using the web console.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster with <code class="literal">cluster-admin</code> privileges.
						</li><li class="listitem">
							You have access to the OpenShift Container Platform web console.
						</li><li class="listitem">
							The cert-manager Operator for Red Hat OpenShift is installed.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform web console.
						</li><li class="listitem"><p class="simpara">
							Uninstall the cert-manager Operator for Red Hat OpenShift Operator.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
								</li><li class="listitem">
									Click the Options menu 
									<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
									 next to the <span class="strong strong"><strong>cert-manager Operator for Red Hat OpenShift</strong></span> entry and click <span class="strong strong"><strong>Uninstall Operator</strong></span>.
								</li><li class="listitem">
									In the confirmation dialog, click <span class="strong strong"><strong>Uninstall</strong></span>.
								</li></ol></div></li></ol></div></section><section class="section" id="cert-manager-remove-resources-console_cert-manager-operator-uninstall"><div class="titlepage"><div><div><h3 class="title">8.13.2. Removing cert-manager Operator for Red Hat OpenShift resources</h3></div></div></div><p>
					Once you have uninstalled the cert-manager Operator for Red Hat OpenShift, you have the option to eliminate its associated resources from your cluster.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster with <code class="literal">cluster-admin</code> privileges.
						</li><li class="listitem">
							You have access to the OpenShift Container Platform web console.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform web console.
						</li><li class="listitem"><p class="simpara">
							Remove the deployments of the cert-manager components, such as <code class="literal">cert-manager</code>, <code class="literal">cainjector</code>, and <code class="literal">webhook</code>, present in the <code class="literal">cert-manager</code> namespace.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Click the <span class="strong strong"><strong>Project</strong></span> drop-down menu to see a list of all available projects, and select the <span class="strong strong"><strong>cert-manager</strong></span> project.
								</li><li class="listitem">
									Navigate to <span class="strong strong"><strong>Workloads</strong></span> → <span class="strong strong"><strong>Deployments</strong></span>.
								</li><li class="listitem">
									Select the deployment that you want to delete.
								</li><li class="listitem">
									Click the <span class="strong strong"><strong>Actions</strong></span> drop-down menu, and select <span class="strong strong"><strong>Delete Deployment</strong></span> to see a confirmation dialog box.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Delete</strong></span> to delete the deployment.
								</li><li class="listitem"><p class="simpara">
									Alternatively, delete deployments of the cert-manager components such as <code class="literal">cert-manager</code>, <code class="literal">cainjector</code> and <code class="literal">webhook</code> present in the <code class="literal">cert-manager</code> namespace by using the command-line interface (CLI).
								</p><pre class="programlisting language-terminal">$ oc delete deployment -n cert-manager -l app.kubernetes.io/instance=cert-manager</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Optional: Remove the custom resource definitions (CRDs) that were installed by the cert-manager Operator for Red Hat OpenShift:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Navigate to <span class="strong strong"><strong>Administration</strong></span> → <span class="strong strong"><strong>CustomResourceDefinitions</strong></span>.
								</li><li class="listitem">
									Enter <code class="literal">certmanager</code> in the <span class="strong strong"><strong>Name</strong></span> field to filter the CRDs.
								</li><li class="listitem"><p class="simpara">
									Click the Options menu 
									<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
									 next to each of the following CRDs, and select <span class="strong strong"><strong>Delete Custom Resource Definition</strong></span>:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<code class="literal">Certificate</code>
										</li><li class="listitem">
											<code class="literal">CertificateRequest</code>
										</li><li class="listitem">
											<code class="literal">CertManager</code> (<code class="literal">operator.openshift.io</code>)
										</li><li class="listitem">
											<code class="literal">Challenge</code>
										</li><li class="listitem">
											<code class="literal">ClusterIssuer</code>
										</li><li class="listitem">
											<code class="literal">Issuer</code>
										</li><li class="listitem">
											<code class="literal">Order</code>
										</li></ul></div></li></ol></div></li><li class="listitem"><p class="simpara">
							Optional: Remove the <code class="literal">cert-manager-operator</code> namespace.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Navigate to <span class="strong strong"><strong>Administration</strong></span> → <span class="strong strong"><strong>Namespaces</strong></span>.
								</li><li class="listitem">
									Click the Options menu 
									<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
									 next to the <span class="strong strong"><strong>cert-manager-operator</strong></span> and select <span class="strong strong"><strong>Delete Namespace</strong></span>.
								</li><li class="listitem">
									In the confirmation dialog, enter <code class="literal">cert-manager-operator</code> in the field and click <span class="strong strong"><strong>Delete</strong></span>.
								</li></ol></div></li></ol></div></section></section></section><section class="chapter" id="audit-log-view"><div class="titlepage"><div><div><h1 class="title">Chapter 9. Viewing audit logs</h1></div></div></div><p>
			OpenShift Container Platform auditing provides a security-relevant chronological set of records documenting the sequence of activities that have affected the system by individual users, administrators, or other components of the system.
		</p><section class="section" id="nodes-pods-audit-log-basic_audit-log-view"><div class="titlepage"><div><div><h2 class="title">9.1. About the API audit log</h2></div></div></div><p>
				Audit works at the API server level, logging all requests coming to the server. Each audit log contains the following information:
			</p><div class="table" id="idm139961120878400"><p class="title"><strong>Table 9.1. Audit log fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 67%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139961120873568" scope="col">Field</th><th align="left" valign="top" id="idm139961120872480" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139961120873568"> <p>
								<code class="literal">level</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961120872480"> <p>
								The audit level at which the event was generated.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961120873568"> <p>
								<code class="literal">auditID</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961120872480"> <p>
								A unique audit ID, generated for each request.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961120873568"> <p>
								<code class="literal">stage</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961120872480"> <p>
								The stage of the request handling when this event instance was generated.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961120873568"> <p>
								<code class="literal">requestURI</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961120872480"> <p>
								The request URI as sent by the client to a server.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961120873568"> <p>
								<code class="literal">verb</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961120872480"> <p>
								The Kubernetes verb associated with the request. For non-resource requests, this is the lowercase HTTP method.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961120873568"> <p>
								<code class="literal">user</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961120872480"> <p>
								The authenticated user information.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961120873568"> <p>
								<code class="literal">impersonatedUser</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961120872480"> <p>
								Optional. The impersonated user information, if the request is impersonating another user.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961120873568"> <p>
								<code class="literal">sourceIPs</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961120872480"> <p>
								Optional. The source IPs, from where the request originated and any intermediate proxies.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961120873568"> <p>
								<code class="literal">userAgent</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961120872480"> <p>
								Optional. The user agent string reported by the client. Note that the user agent is provided by the client, and must not be trusted.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961120873568"> <p>
								<code class="literal">objectRef</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961120872480"> <p>
								Optional. The object reference this request is targeted at. This does not apply for <code class="literal">List</code>-type requests, or non-resource requests.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961120873568"> <p>
								<code class="literal">responseStatus</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961120872480"> <p>
								Optional. The response status, populated even when the <code class="literal">ResponseObject</code> is not a <code class="literal">Status</code> type. For successful responses, this will only include the code. For non-status type error responses, this will be auto-populated with the error message.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961120873568"> <p>
								<code class="literal">requestObject</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961120872480"> <p>
								Optional. The API object from the request, in JSON format. The <code class="literal">RequestObject</code> is recorded as is in the request (possibly re-encoded as JSON), prior to version conversion, defaulting, admission or merging. It is an external versioned object type, and might not be a valid object on its own. This is omitted for non-resource requests and is only logged at request level and higher.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961120873568"> <p>
								<code class="literal">responseObject</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961120872480"> <p>
								Optional. The API object returned in the response, in JSON format. The <code class="literal">ResponseObject</code> is recorded after conversion to the external type, and serialized as JSON. This is omitted for non-resource requests and is only logged at response level.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961120873568"> <p>
								<code class="literal">requestReceivedTimestamp</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961120872480"> <p>
								The time that the request reached the API server.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961120873568"> <p>
								<code class="literal">stageTimestamp</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961120872480"> <p>
								The time that the request reached the current audit stage.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961120873568"> <p>
								<code class="literal">annotations</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961120872480"> <p>
								Optional. An unstructured key value map stored with an audit event that may be set by plugins invoked in the request serving chain, including authentication, authorization and admission plugins. Note that these annotations are for the audit event, and do not correspond to the <code class="literal">metadata.annotations</code> of the submitted object. Keys should uniquely identify the informing component to avoid name collisions, for example <code class="literal">podsecuritypolicy.admission.k8s.io/policy</code>. Values should be short. Annotations are included in the metadata level.
							</p>
							 </td></tr></tbody></table></div></div><p>
				Example output for the Kubernetes API server:
			</p><pre class="programlisting language-json">{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"Metadata","auditID":"ad209ce1-fec7-4130-8192-c4cc63f1d8cd","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/openshift-kube-controller-manager/configmaps/cert-recovery-controller-lock?timeout=35s","verb":"update","user":{"username":"system:serviceaccount:openshift-kube-controller-manager:localhost-recovery-client","uid":"dd4997e3-d565-4e37-80f8-7fc122ccd785","groups":["system:serviceaccounts","system:serviceaccounts:openshift-kube-controller-manager","system:authenticated"]},"sourceIPs":["::1"],"userAgent":"cluster-kube-controller-manager-operator/v0.0.0 (linux/amd64) kubernetes/$Format","objectRef":{"resource":"configmaps","namespace":"openshift-kube-controller-manager","name":"cert-recovery-controller-lock","uid":"5c57190b-6993-425d-8101-8337e48c7548","apiVersion":"v1","resourceVersion":"574307"},"responseStatus":{"metadata":{},"code":200},"requestReceivedTimestamp":"2020-04-02T08:27:20.200962Z","stageTimestamp":"2020-04-02T08:27:20.206710Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"system:openshift:operator:kube-controller-manager-recovery\" of ClusterRole \"cluster-admin\" to ServiceAccount \"localhost-recovery-client/openshift-kube-controller-manager\""}}</pre></section><section class="section" id="nodes-nodes-audit-log-basic-viewing_audit-log-view"><div class="titlepage"><div><div><h2 class="title">9.2. Viewing the audit logs</h2></div></div></div><p>
				You can view the logs for the OpenShift API server, Kubernetes API server, OpenShift OAuth API server, and OpenShift OAuth server for each control plane node.
			</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					To view the audit logs:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						View the OpenShift API server audit logs:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								List the OpenShift API server audit logs that are available for each control plane node:
							</p><pre class="programlisting language-terminal">$ oc adm node-logs --role=master --path=openshift-apiserver/</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">ci-ln-m0wpfjb-f76d1-vnb5x-master-0 audit-2021-03-09T00-12-19.834.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-0 audit.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-1 audit-2021-03-09T00-11-49.835.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-1 audit.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-2 audit-2021-03-09T00-13-00.128.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-2 audit.log</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								View a specific OpenShift API server audit log by providing the node name and the log name:
							</p><pre class="programlisting language-terminal">$ oc adm node-logs &lt;node_name&gt; --path=openshift-apiserver/&lt;log_name&gt;</pre><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc adm node-logs ci-ln-m0wpfjb-f76d1-vnb5x-master-0 --path=openshift-apiserver/audit-2021-03-09T00-12-19.834.log</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"Metadata","auditID":"381acf6d-5f30-4c7d-8175-c9c317ae5893","stage":"ResponseComplete","requestURI":"/metrics","verb":"get","user":{"username":"system:serviceaccount:openshift-monitoring:prometheus-k8s","uid":"825b60a0-3976-4861-a342-3b2b561e8f82","groups":["system:serviceaccounts","system:serviceaccounts:openshift-monitoring","system:authenticated"]},"sourceIPs":["10.129.2.6"],"userAgent":"Prometheus/2.23.0","responseStatus":{"metadata":{},"code":200},"requestReceivedTimestamp":"2021-03-08T18:02:04.086545Z","stageTimestamp":"2021-03-08T18:02:04.107102Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"prometheus-k8s\" of ClusterRole \"prometheus-k8s\" to ServiceAccount \"prometheus-k8s/openshift-monitoring\""}}</pre>

								</p></div></li></ol></div></li><li class="listitem"><p class="simpara">
						View the Kubernetes API server audit logs:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								List the Kubernetes API server audit logs that are available for each control plane node:
							</p><pre class="programlisting language-terminal">$ oc adm node-logs --role=master --path=kube-apiserver/</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">ci-ln-m0wpfjb-f76d1-vnb5x-master-0 audit-2021-03-09T14-07-27.129.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-0 audit.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-1 audit-2021-03-09T19-24-22.620.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-1 audit.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-2 audit-2021-03-09T18-37-07.511.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-2 audit.log</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								View a specific Kubernetes API server audit log by providing the node name and the log name:
							</p><pre class="programlisting language-terminal">$ oc adm node-logs &lt;node_name&gt; --path=kube-apiserver/&lt;log_name&gt;</pre><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc adm node-logs ci-ln-m0wpfjb-f76d1-vnb5x-master-0 --path=kube-apiserver/audit-2021-03-09T14-07-27.129.log</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"Metadata","auditID":"cfce8a0b-b5f5-4365-8c9f-79c1227d10f9","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/openshift-kube-scheduler/serviceaccounts/openshift-kube-scheduler-sa","verb":"get","user":{"username":"system:serviceaccount:openshift-kube-scheduler-operator:openshift-kube-scheduler-operator","uid":"2574b041-f3c8-44e6-a057-baef7aa81516","groups":["system:serviceaccounts","system:serviceaccounts:openshift-kube-scheduler-operator","system:authenticated"]},"sourceIPs":["10.128.0.8"],"userAgent":"cluster-kube-scheduler-operator/v0.0.0 (linux/amd64) kubernetes/$Format","objectRef":{"resource":"serviceaccounts","namespace":"openshift-kube-scheduler","name":"openshift-kube-scheduler-sa","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":200},"requestReceivedTimestamp":"2021-03-08T18:06:42.512619Z","stageTimestamp":"2021-03-08T18:06:42.516145Z","annotations":{"authentication.k8s.io/legacy-token":"system:serviceaccount:openshift-kube-scheduler-operator:openshift-kube-scheduler-operator","authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"system:openshift:operator:cluster-kube-scheduler-operator\" of ClusterRole \"cluster-admin\" to ServiceAccount \"openshift-kube-scheduler-operator/openshift-kube-scheduler-operator\""}}</pre>

								</p></div></li></ol></div></li><li class="listitem"><p class="simpara">
						View the OpenShift OAuth API server audit logs:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								List the OpenShift OAuth API server audit logs that are available for each control plane node:
							</p><pre class="programlisting language-terminal">$ oc adm node-logs --role=master --path=oauth-apiserver/</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">ci-ln-m0wpfjb-f76d1-vnb5x-master-0 audit-2021-03-09T13-06-26.128.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-0 audit.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-1 audit-2021-03-09T18-23-21.619.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-1 audit.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-2 audit-2021-03-09T17-36-06.510.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-2 audit.log</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								View a specific OpenShift OAuth API server audit log by providing the node name and the log name:
							</p><pre class="programlisting language-terminal">$ oc adm node-logs &lt;node_name&gt; --path=oauth-apiserver/&lt;log_name&gt;</pre><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc adm node-logs ci-ln-m0wpfjb-f76d1-vnb5x-master-0 --path=oauth-apiserver/audit-2021-03-09T13-06-26.128.log</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"Metadata","auditID":"dd4c44e2-3ea1-4830-9ab7-c91a5f1388d6","stage":"ResponseComplete","requestURI":"/apis/user.openshift.io/v1/users/~","verb":"get","user":{"username":"system:serviceaccount:openshift-monitoring:prometheus-k8s","groups":["system:serviceaccounts","system:serviceaccounts:openshift-monitoring","system:authenticated"]},"sourceIPs":["10.0.32.4","10.128.0.1"],"userAgent":"dockerregistry/v0.0.0 (linux/amd64) kubernetes/$Format","objectRef":{"resource":"users","name":"~","apiGroup":"user.openshift.io","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":200},"requestReceivedTimestamp":"2021-03-08T17:47:43.653187Z","stageTimestamp":"2021-03-08T17:47:43.660187Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"basic-users\" of ClusterRole \"basic-user\" to Group \"system:authenticated\""}}</pre>

								</p></div></li></ol></div></li><li class="listitem"><p class="simpara">
						View the OpenShift OAuth server audit logs:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								List the OpenShift OAuth server audit logs that are available for each control plane node:
							</p><pre class="programlisting language-terminal">$ oc adm node-logs --role=master --path=oauth-server/</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">ci-ln-m0wpfjb-f76d1-vnb5x-master-0 audit-2022-05-11T18-57-32.395.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-0 audit.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-1 audit-2022-05-11T19-07-07.021.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-1 audit.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-2 audit-2022-05-11T19-06-51.844.log
ci-ln-m0wpfjb-f76d1-vnb5x-master-2 audit.log</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								View a specific OpenShift OAuth server audit log by providing the node name and the log name:
							</p><pre class="programlisting language-terminal">$ oc adm node-logs &lt;node_name&gt; --path=oauth-server/&lt;log_name&gt;</pre><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc adm node-logs ci-ln-m0wpfjb-f76d1-vnb5x-master-0 --path=oauth-server/audit-2022-05-11T18-57-32.395.log</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"Metadata","auditID":"13c20345-f33b-4b7d-b3b6-e7793f805621","stage":"ResponseComplete","requestURI":"/login","verb":"post","user":{"username":"system:anonymous","groups":["system:unauthenticated"]},"sourceIPs":["10.128.2.6"],"userAgent":"Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0","responseStatus":{"metadata":{},"code":302},"requestReceivedTimestamp":"2022-05-11T17:31:16.280155Z","stageTimestamp":"2022-05-11T17:31:16.297083Z","annotations":{"authentication.openshift.io/decision":"error","authentication.openshift.io/username":"kubeadmin","authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":""}}</pre>

								</p></div><p class="simpara">
								The possible values for the <code class="literal">authentication.openshift.io/decision</code> annotation are <code class="literal">allow</code>, <code class="literal">deny</code>, or <code class="literal">error</code>.
							</p></li></ol></div></li></ul></div></section><section class="section" id="security-audit-log-basic-filtering_audit-log-view"><div class="titlepage"><div><div><h2 class="title">9.3. Filtering audit logs</h2></div></div></div><p>
				You can use <code class="literal">jq</code> or another JSON parsing tool to filter the API server audit logs.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The amount of information logged to the API server audit logs is controlled by the audit log policy that is set.
				</p></div></div><p>
				The following procedure provides examples of using <code class="literal">jq</code> to filter audit logs on control plane node <code class="literal">node-1.example.com</code>. See the <a class="link" href="https://stedolan.github.io/jq/manual/">jq Manual</a> for detailed information on using <code class="literal">jq</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
					</li><li class="listitem">
						You have installed <code class="literal">jq</code>.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Filter OpenShift API server audit logs by user:
					</p><pre class="programlisting language-terminal">$ oc adm node-logs node-1.example.com  \
  --path=openshift-apiserver/audit.log \
  | jq 'select(.user.username == "myusername")'</pre></li><li class="listitem"><p class="simpara">
						Filter OpenShift API server audit logs by user agent:
					</p><pre class="programlisting language-terminal">$ oc adm node-logs node-1.example.com  \
  --path=openshift-apiserver/audit.log \
  | jq 'select(.userAgent == "cluster-version-operator/v0.0.0 (linux/amd64) kubernetes/$Format")'</pre></li><li class="listitem"><p class="simpara">
						Filter Kubernetes API server audit logs by a certain API version and only output the user agent:
					</p><pre class="programlisting language-terminal">$ oc adm node-logs node-1.example.com  \
  --path=kube-apiserver/audit.log \
  | jq 'select(.requestURI | startswith("/apis/apiextensions.k8s.io/v1beta1")) | .userAgent'</pre></li><li class="listitem"><p class="simpara">
						Filter OpenShift OAuth API server audit logs by excluding a verb:
					</p><pre class="programlisting language-terminal">$ oc adm node-logs node-1.example.com  \
  --path=oauth-apiserver/audit.log \
  | jq 'select(.verb != "get")'</pre></li><li class="listitem"><p class="simpara">
						Filter OpenShift OAuth server audit logs by events that identified a username and failed with an error:
					</p><pre class="programlisting language-terminal">$ oc adm node-logs node-1.example.com  \
  --path=oauth-server/audit.log \
  | jq 'select(.annotations["authentication.openshift.io/username"] != null and .annotations["authentication.openshift.io/decision"] == "error")'</pre></li></ul></div></section><section class="section" id="gathering-data-audit-logs_audit-log-view"><div class="titlepage"><div><div><h2 class="title">9.4. Gathering audit logs</h2></div></div></div><p>
				You can use the must-gather tool to collect the audit logs for debugging your cluster, which you can review or send to Red Hat Support.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Run the <code class="literal">oc adm must-gather</code> command with <code class="literal">-- /usr/bin/gather_audit_logs</code>:
					</p><pre class="programlisting language-terminal">$ oc adm must-gather -- /usr/bin/gather_audit_logs</pre></li><li class="listitem"><p class="simpara">
						Create a compressed file from the <code class="literal">must-gather</code> directory that was just created in your working directory. For example, on a computer that uses a Linux operating system, run the following command:
					</p><pre class="programlisting language-terminal">$ tar cvaf must-gather.tar.gz must-gather.local.472290403699006248 <span id="CO75-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO75-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Replace <code class="literal">must-gather-local.472290403699006248</code> with the actual directory name.
							</div></dd></dl></div></li><li class="listitem">
						Attach the compressed file to your support case on the <a class="link" href="https://access.redhat.com">Red Hat Customer Portal</a>.
					</li></ol></div></section><section class="section _additional-resources" id="viewing-audit-logs-additional-resources"><div class="titlepage"><div><div><h2 class="title">9.5. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/support/#about-must-gather_gathering-cluster-data">Must-gather tool</a>
					</li><li class="listitem">
						<a class="link" href="https://github.com/kubernetes/apiserver/blob/master/pkg/apis/audit/v1/types.go#L72">API audit log event structure</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#audit-log-policy-config">Configuring the audit log policy</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/logging/#log-forwarding">About log forwarding</a>
					</li></ul></div></section></section><section class="chapter" id="audit-log-policy-config"><div class="titlepage"><div><div><h1 class="title">Chapter 10. Configuring the audit log policy</h1></div></div></div><p>
			You can control the amount of information that is logged to the API server audit logs by choosing the audit log policy profile to use.
		</p><section class="section" id="about-audit-log-profiles_audit-log-policy-config"><div class="titlepage"><div><div><h2 class="title">10.1. About audit log policy profiles</h2></div></div></div><p>
				Audit log profiles define how to log requests that come to the OpenShift API server, Kubernetes API server, OpenShift OAuth API server, and OpenShift OAuth server.
			</p><p>
				OpenShift Container Platform provides the following predefined audit policy profiles:
			</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 67%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139961122890976" scope="col">Profile</th><th align="left" valign="top" id="idm139961122889888" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139961122890976"> <p>
								<code class="literal">Default</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961122889888"> <p>
								Logs only metadata for read and write requests; does not log request bodies except for OAuth access token requests. This is the default policy.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961122890976"> <p>
								<code class="literal">WriteRequestBodies</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961122889888"> <p>
								In addition to logging metadata for all requests, logs request bodies for every write request to the API servers (<code class="literal">create</code>, <code class="literal">update</code>, <code class="literal">patch</code>, <code class="literal">delete</code>, <code class="literal">deletecollection</code>). This profile has more resource overhead than the <code class="literal">Default</code> profile. <sup>[1]</sup>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961122890976"> <p>
								<code class="literal">AllRequestBodies</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961122889888"> <p>
								In addition to logging metadata for all requests, logs request bodies for every read and write request to the API servers (<code class="literal">get</code>, <code class="literal">list</code>, <code class="literal">create</code>, <code class="literal">update</code>, <code class="literal">patch</code>). This profile has the most resource overhead. <sup>[1]</sup>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961122890976"> <p>
								<code class="literal">None</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961122889888"> <p>
								No requests are logged; even OAuth access token requests and OAuth authorize token requests are not logged. Custom rules are ignored when this profile is set.
							</p>
							 <div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
									It is not recommended to disable audit logging by using the <code class="literal">None</code> profile unless you are fully aware of the risks of not logging data that can be beneficial when troubleshooting issues. If you disable audit logging and a support situation arises, you might need to enable audit logging and reproduce the issue in order to troubleshoot properly.
								</p></div></div>
							 </td></tr></tbody></table></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Sensitive resources, such as <code class="literal">Secret</code>, <code class="literal">Route</code>, and <code class="literal">OAuthClient</code> objects, are only ever logged at the metadata level. OpenShift OAuth server events are only ever logged at the metadata level.
					</li></ol></div><p>
				By default, OpenShift Container Platform uses the <code class="literal">Default</code> audit log profile. You can use another audit policy profile that also logs request bodies, but be aware of the increased resource usage (CPU, memory, and I/O).
			</p></section><section class="section" id="configuring-audit-policy_audit-log-policy-config"><div class="titlepage"><div><div><h2 class="title">10.2. Configuring the audit log policy</h2></div></div></div><p>
				You can configure the audit log policy to use when logging requests that come to the API servers.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">APIServer</code> resource:
					</p><pre class="programlisting language-terminal">$ oc edit apiserver cluster</pre></li><li class="listitem"><p class="simpara">
						Update the <code class="literal">spec.audit.profile</code> field:
					</p><pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1
kind: APIServer
metadata:
...
spec:
  audit:
    profile: WriteRequestBodies    <span id="CO76-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO76-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Set to <code class="literal">Default</code>, <code class="literal">WriteRequestBodies</code>, <code class="literal">AllRequestBodies</code>, or <code class="literal">None</code>. The default profile is <code class="literal">Default</code>.
							</div></dd></dl></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							It is not recommended to disable audit logging by using the <code class="literal">None</code> profile unless you are fully aware of the risks of not logging data that can be beneficial when troubleshooting issues. If you disable audit logging and a support situation arises, you might need to enable audit logging and reproduce the issue in order to troubleshoot properly.
						</p></div></div></li><li class="listitem">
						Save the file to apply the changes.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that a new revision of the Kubernetes API server pods is rolled out. It can take several minutes for all nodes to update to the new revision.
					</p><pre class="programlisting language-terminal">$ oc get kubeapiserver -o=jsonpath='{range .items[0].status.conditions[?(@.type=="NodeInstallerProgressing")]}{.reason}{"\n"}{.message}{"\n"}'</pre><p class="simpara">
						Review the <code class="literal">NodeInstallerProgressing</code> status condition for the Kubernetes API server to verify that all nodes are at the latest revision. The output shows <code class="literal">AllNodesAtLatestRevision</code> upon successful update:
					</p><pre class="programlisting language-terminal">AllNodesAtLatestRevision
3 nodes are at revision 12 <span id="CO77-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO77-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								In this example, the latest revision number is <code class="literal">12</code>.
							</div></dd></dl></div><p class="simpara">
						If the output shows a message similar to one of the following messages, the update is still in progress. Wait a few minutes and try again.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">3 nodes are at revision 11; 0 nodes have achieved new revision 12</code>
							</li><li class="listitem">
								<code class="literal">2 nodes are at revision 11; 1 nodes are at revision 12</code>
							</li></ul></div></li></ul></div></section><section class="section" id="configuring-audit-policy-custom_audit-log-policy-config"><div class="titlepage"><div><div><h2 class="title">10.3. Configuring the audit log policy with custom rules</h2></div></div></div><p>
				You can configure an audit log policy that defines custom rules. You can specify multiple groups and define which profile to use for that group.
			</p><p>
				These custom rules take precedence over the top-level profile field. The custom rules are evaluated from top to bottom, and the first that matches is applied.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Custom rules are ignored if the top-level profile field is set to <code class="literal">None</code>.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">APIServer</code> resource:
					</p><pre class="programlisting language-terminal">$ oc edit apiserver cluster</pre></li><li class="listitem"><p class="simpara">
						Add the <code class="literal">spec.audit.customRules</code> field:
					</p><pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1
kind: APIServer
metadata:
...
spec:
  audit:
    customRules:                        <span id="CO78-1"><!--Empty--></span><span class="callout">1</span>
    - group: system:authenticated:oauth
      profile: WriteRequestBodies
    - group: system:authenticated
      profile: AllRequestBodies
    profile: Default                    <span id="CO78-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO78-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Add one or more groups and specify the profile to use for that group. These custom rules take precedence over the top-level profile field. The custom rules are evaluated from top to bottom, and the first that matches is applied.
							</div></dd><dt><a href="#CO78-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Set to <code class="literal">Default</code>, <code class="literal">WriteRequestBodies</code>, or <code class="literal">AllRequestBodies</code>. If you do not set this top-level profile field, it defaults to the <code class="literal">Default</code> profile.
							</div></dd></dl></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							Do not set the top-level profile field to <code class="literal">None</code> if you want to use custom rules. Custom rules are ignored if the top-level profile field is set to <code class="literal">None</code>.
						</p></div></div></li><li class="listitem">
						Save the file to apply the changes.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that a new revision of the Kubernetes API server pods is rolled out. It can take several minutes for all nodes to update to the new revision.
					</p><pre class="programlisting language-terminal">$ oc get kubeapiserver -o=jsonpath='{range .items[0].status.conditions[?(@.type=="NodeInstallerProgressing")]}{.reason}{"\n"}{.message}{"\n"}'</pre><p class="simpara">
						Review the <code class="literal">NodeInstallerProgressing</code> status condition for the Kubernetes API server to verify that all nodes are at the latest revision. The output shows <code class="literal">AllNodesAtLatestRevision</code> upon successful update:
					</p><pre class="programlisting language-terminal">AllNodesAtLatestRevision
3 nodes are at revision 12 <span id="CO79-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO79-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								In this example, the latest revision number is <code class="literal">12</code>.
							</div></dd></dl></div><p class="simpara">
						If the output shows a message similar to one of the following messages, the update is still in progress. Wait a few minutes and try again.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">3 nodes are at revision 11; 0 nodes have achieved new revision 12</code>
							</li><li class="listitem">
								<code class="literal">2 nodes are at revision 11; 1 nodes are at revision 12</code>
							</li></ul></div></li></ul></div></section><section class="section" id="configuring-audit-policy-disable_audit-log-policy-config"><div class="titlepage"><div><div><h2 class="title">10.4. Disabling audit logging</h2></div></div></div><p>
				You can disable audit logging for OpenShift Container Platform. When you disable audit logging, even OAuth access token requests and OAuth authorize token requests are not logged.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					It is not recommended to disable audit logging by using the <code class="literal">None</code> profile unless you are fully aware of the risks of not logging data that can be beneficial when troubleshooting issues. If you disable audit logging and a support situation arises, you might need to enable audit logging and reproduce the issue in order to troubleshoot properly.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">APIServer</code> resource:
					</p><pre class="programlisting language-terminal">$ oc edit apiserver cluster</pre></li><li class="listitem"><p class="simpara">
						Set the <code class="literal">spec.audit.profile</code> field to <code class="literal">None</code>:
					</p><pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1
kind: APIServer
metadata:
...
spec:
  audit:
    profile: None</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You can also disable audit logging only for specific groups by specifying custom rules in the <code class="literal">spec.audit.customRules</code> field.
						</p></div></div></li><li class="listitem">
						Save the file to apply the changes.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that a new revision of the Kubernetes API server pods is rolled out. It can take several minutes for all nodes to update to the new revision.
					</p><pre class="programlisting language-terminal">$ oc get kubeapiserver -o=jsonpath='{range .items[0].status.conditions[?(@.type=="NodeInstallerProgressing")]}{.reason}{"\n"}{.message}{"\n"}'</pre><p class="simpara">
						Review the <code class="literal">NodeInstallerProgressing</code> status condition for the Kubernetes API server to verify that all nodes are at the latest revision. The output shows <code class="literal">AllNodesAtLatestRevision</code> upon successful update:
					</p><pre class="programlisting language-terminal">AllNodesAtLatestRevision
3 nodes are at revision 12 <span id="CO80-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO80-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								In this example, the latest revision number is <code class="literal">12</code>.
							</div></dd></dl></div><p class="simpara">
						If the output shows a message similar to one of the following messages, the update is still in progress. Wait a few minutes and try again.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">3 nodes are at revision 11; 0 nodes have achieved new revision 12</code>
							</li><li class="listitem">
								<code class="literal">2 nodes are at revision 11; 1 nodes are at revision 12</code>
							</li></ul></div></li></ul></div></section></section><section class="chapter" id="tls-security-profiles"><div class="titlepage"><div><div><h1 class="title">Chapter 11. Configuring TLS security profiles</h1></div></div></div><p>
			TLS security profiles provide a way for servers to regulate which ciphers a client can use when connecting to the server. This ensures that OpenShift Container Platform components use cryptographic libraries that do not allow known insecure protocols, ciphers, or algorithms.
		</p><p>
			Cluster administrators can choose which TLS security profile to use for each of the following components:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					the Ingress Controller
				</li><li class="listitem"><p class="simpara">
					the control plane
				</p><p class="simpara">
					This includes the Kubernetes API server, Kubernetes controller manager, Kubernetes scheduler, OpenShift API server, OpenShift OAuth API server, OpenShift OAuth server, and etcd.
				</p></li><li class="listitem">
					the kubelet, when it acts as an HTTP server for the Kubernetes API server
				</li></ul></div><section class="section" id="tls-profiles-understanding_tls-security-profiles"><div class="titlepage"><div><div><h2 class="title">11.1. Understanding TLS security profiles</h2></div></div></div><p>
				You can use a TLS (Transport Layer Security) security profile to define which TLS ciphers are required by various OpenShift Container Platform components. The OpenShift Container Platform TLS security profiles are based on <a class="link" href="https://wiki.mozilla.org/Security/Server_Side_TLS">Mozilla recommended configurations</a>.
			</p><p>
				You can specify one of the following TLS security profiles for each component:
			</p><div class="table" id="idm139961121804000"><p class="title"><strong>Table 11.1. TLS security profiles</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 67%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139961121799168" scope="col">Profile</th><th align="left" valign="top" id="idm139961121798080" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139961121799168"> <p>
								<code class="literal">Old</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961121798080"> <p>
								This profile is intended for use with legacy clients or libraries. The profile is based on the <a class="link" href="https://wiki.mozilla.org/Security/Server_Side_TLS#Old_backward_compatibility">Old backward compatibility</a> recommended configuration.
							</p>
							 <p>
								The <code class="literal">Old</code> profile requires a minimum TLS version of 1.0.
							</p>
							 <div class="admonition note"><div class="admonition_header">Note</div><div><p>
									For the Ingress Controller, the minimum TLS version is converted from 1.0 to 1.1.
								</p></div></div>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961121799168"> <p>
								<code class="literal">Intermediate</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961121798080"> <p>
								This profile is the recommended configuration for the majority of clients. It is the default TLS security profile for the Ingress Controller, kubelet, and control plane. The profile is based on the <a class="link" href="https://wiki.mozilla.org/Security/Server_Side_TLS#Intermediate_compatibility_.28recommended.29">Intermediate compatibility</a> recommended configuration.
							</p>
							 <p>
								The <code class="literal">Intermediate</code> profile requires a minimum TLS version of 1.2.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961121799168"> <p>
								<code class="literal">Modern</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961121798080"> <p>
								This profile is intended for use with modern clients that have no need for backwards compatibility. This profile is based on the <a class="link" href="https://wiki.mozilla.org/Security/Server_Side_TLS#Modern_compatibility">Modern compatibility</a> recommended configuration.
							</p>
							 <p>
								The <code class="literal">Modern</code> profile requires a minimum TLS version of 1.3.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139961121799168"> <p>
								<code class="literal">Custom</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139961121798080"> <p>
								This profile allows you to define the TLS version and ciphers to use.
							</p>
							 <div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
									Use caution when using a <code class="literal">Custom</code> profile, because invalid configurations can cause problems.
								</p></div></div>
							 </td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					When using one of the predefined profile types, the effective profile configuration is subject to change between releases. For example, given a specification to use the Intermediate profile deployed on release X.Y.Z, an upgrade to release X.Y.Z+1 might cause a new profile configuration to be applied, resulting in a rollout.
				</p></div></div></section><section class="section" id="tls-profiles-view-details_tls-security-profiles"><div class="titlepage"><div><div><h2 class="title">11.2. Viewing TLS security profile details</h2></div></div></div><p>
				You can view the minimum TLS version and ciphers for the predefined TLS security profiles for each of the following components: Ingress Controller, control plane, and kubelet.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The effective configuration of minimum TLS version and list of ciphers for a profile might differ between components.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						View details for a specific TLS security profile:
					</p><pre class="programlisting language-terminal">$ oc explain &lt;component&gt;.spec.tlsSecurityProfile.&lt;profile&gt; <span id="CO81-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO81-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								For <code class="literal">&lt;component&gt;</code>, specify <code class="literal">ingresscontroller</code>, <code class="literal">apiserver</code>, or <code class="literal">kubeletconfig</code>. For <code class="literal">&lt;profile&gt;</code>, specify <code class="literal">old</code>, <code class="literal">intermediate</code>, or <code class="literal">custom</code>.
							</div></dd></dl></div><p class="simpara">
						For example, to check the ciphers included for the <code class="literal">intermediate</code> profile for the control plane:
					</p><pre class="programlisting language-terminal">$ oc explain apiserver.spec.tlsSecurityProfile.intermediate</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">KIND:     APIServer
VERSION:  config.openshift.io/v1

DESCRIPTION:
    intermediate is a TLS security profile based on:
    https://wiki.mozilla.org/Security/Server_Side_TLS#Intermediate_compatibility_.28recommended.29
    and looks like this (yaml):
    ciphers: - TLS_AES_128_GCM_SHA256 - TLS_AES_256_GCM_SHA384 -
    TLS_CHACHA20_POLY1305_SHA256 - ECDHE-ECDSA-AES128-GCM-SHA256 -
    ECDHE-RSA-AES128-GCM-SHA256 - ECDHE-ECDSA-AES256-GCM-SHA384 -
    ECDHE-RSA-AES256-GCM-SHA384 - ECDHE-ECDSA-CHACHA20-POLY1305 -
    ECDHE-RSA-CHACHA20-POLY1305 - DHE-RSA-AES128-GCM-SHA256 -
    DHE-RSA-AES256-GCM-SHA384 minTLSVersion: TLSv1.2</pre>

						</p></div></li><li class="listitem"><p class="simpara">
						View all details for the <code class="literal">tlsSecurityProfile</code> field of a component:
					</p><pre class="programlisting language-terminal">$ oc explain &lt;component&gt;.spec.tlsSecurityProfile <span id="CO82-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO82-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								For <code class="literal">&lt;component&gt;</code>, specify <code class="literal">ingresscontroller</code>, <code class="literal">apiserver</code>, or <code class="literal">kubeletconfig</code>.
							</div></dd></dl></div><p class="simpara">
						For example, to check all details for the <code class="literal">tlsSecurityProfile</code> field for the Ingress Controller:
					</p><pre class="programlisting language-terminal">$ oc explain ingresscontroller.spec.tlsSecurityProfile</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">KIND:     IngressController
VERSION:  operator.openshift.io/v1

RESOURCE: tlsSecurityProfile &lt;Object&gt;

DESCRIPTION:
     ...

FIELDS:
   custom	&lt;&gt;
     custom is a user-defined TLS security profile. Be extremely careful using a
     custom profile as invalid configurations can be catastrophic. An example
     custom profile looks like this:
     ciphers: - ECDHE-ECDSA-CHACHA20-POLY1305 - ECDHE-RSA-CHACHA20-POLY1305 -
     ECDHE-RSA-AES128-GCM-SHA256 - ECDHE-ECDSA-AES128-GCM-SHA256 minTLSVersion:
     TLSv1.1

   intermediate	&lt;&gt;
     intermediate is a TLS security profile based on:
     https://wiki.mozilla.org/Security/Server_Side_TLS#Intermediate_compatibility_.28recommended.29
     and looks like this (yaml):
     ... <span id="CO83-1"><!--Empty--></span><span class="callout">1</span>

   modern	&lt;&gt;
     modern is a TLS security profile based on:
     https://wiki.mozilla.org/Security/Server_Side_TLS#Modern_compatibility and
     looks like this (yaml):
     ... <span id="CO83-2"><!--Empty--></span><span class="callout">2</span>
     NOTE: Currently unsupported.

   old	&lt;&gt;
     old is a TLS security profile based on:
     https://wiki.mozilla.org/Security/Server_Side_TLS#Old_backward_compatibility
     and looks like this (yaml):
     ... <span id="CO83-3"><!--Empty--></span><span class="callout">3</span>

   type	&lt;string&gt;
     ...</pre>

						</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO83-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Lists ciphers and minimum version for the <code class="literal">intermediate</code> profile here.
							</div></dd><dt><a href="#CO83-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Lists ciphers and minimum version for the <code class="literal">modern</code> profile here.
							</div></dd><dt><a href="#CO83-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								Lists ciphers and minimum version for the <code class="literal">old</code> profile here.
							</div></dd></dl></div></li></ul></div></section><section class="section" id="tls-profiles-ingress-configuring_tls-security-profiles"><div class="titlepage"><div><div><h2 class="title">11.3. Configuring the TLS security profile for the Ingress Controller</h2></div></div></div><p>
				To configure a TLS security profile for an Ingress Controller, edit the <code class="literal">IngressController</code> custom resource (CR) to specify a predefined or custom TLS security profile. If a TLS security profile is not configured, the default value is based on the TLS security profile set for the API server.
			</p><div class="formalpara"><p class="title"><strong>Sample <code class="literal">IngressController</code> CR that configures the <code class="literal">Old</code> TLS security profile</strong></p><p>
					
<pre class="programlisting language-yaml">apiVersion: operator.openshift.io/v1
kind: IngressController
 ...
spec:
  tlsSecurityProfile:
    old: {}
    type: Old
 ...</pre>

				</p></div><p>
				The TLS security profile defines the minimum TLS version and the TLS ciphers for TLS connections for Ingress Controllers.
			</p><p>
				You can see the ciphers and the minimum TLS version of the configured TLS security profile in the <code class="literal">IngressController</code> custom resource (CR) under <code class="literal">Status.Tls Profile</code> and the configured TLS security profile under <code class="literal">Spec.Tls Security Profile</code>. For the <code class="literal">Custom</code> TLS security profile, the specific ciphers and minimum TLS version are listed under both parameters.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The HAProxy Ingress Controller image supports TLS <code class="literal">1.3</code> and the <code class="literal">Modern</code> profile.
				</p><p>
					The Ingress Operator also converts the TLS <code class="literal">1.0</code> of an <code class="literal">Old</code> or <code class="literal">Custom</code> profile to <code class="literal">1.1</code>.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">IngressController</code> CR in the <code class="literal">openshift-ingress-operator</code> project to configure the TLS security profile:
					</p><pre class="programlisting language-terminal">$ oc edit IngressController default -n openshift-ingress-operator</pre></li><li class="listitem"><p class="simpara">
						Add the <code class="literal">spec.tlsSecurityProfile</code> field:
					</p><div class="formalpara"><p class="title"><strong>Sample <code class="literal">IngressController</code> CR for a <code class="literal">Custom</code> profile</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: operator.openshift.io/v1
kind: IngressController
 ...
spec:
  tlsSecurityProfile:
    type: Custom <span id="CO84-1"><!--Empty--></span><span class="callout">1</span>
    custom: <span id="CO84-2"><!--Empty--></span><span class="callout">2</span>
      ciphers: <span id="CO84-3"><!--Empty--></span><span class="callout">3</span>
      - ECDHE-ECDSA-CHACHA20-POLY1305
      - ECDHE-RSA-CHACHA20-POLY1305
      - ECDHE-RSA-AES128-GCM-SHA256
      - ECDHE-ECDSA-AES128-GCM-SHA256
      minTLSVersion: VersionTLS11
 ...</pre>

						</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO84-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Specify the TLS security profile type (<code class="literal">Old</code>, <code class="literal">Intermediate</code>, or <code class="literal">Custom</code>). The default is <code class="literal">Intermediate</code>.
							</div></dd><dt><a href="#CO84-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Specify the appropriate field for the selected type:
							</div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">old: {}</code>
									</li><li class="listitem">
										<code class="literal">intermediate: {}</code>
									</li><li class="listitem">
										<code class="literal">custom:</code>
									</li></ul></div></dd><dt><a href="#CO84-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								For the <code class="literal">custom</code> type, specify a list of TLS ciphers and minimum accepted TLS version.
							</div></dd></dl></div></li><li class="listitem">
						Save the file to apply the changes.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that the profile is set in the <code class="literal">IngressController</code> CR:
					</p><pre class="programlisting language-terminal">$ oc describe IngressController default -n openshift-ingress-operator</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">Name:         default
Namespace:    openshift-ingress-operator
Labels:       &lt;none&gt;
Annotations:  &lt;none&gt;
API Version:  operator.openshift.io/v1
Kind:         IngressController
 ...
Spec:
 ...
  Tls Security Profile:
    Custom:
      Ciphers:
        ECDHE-ECDSA-CHACHA20-POLY1305
        ECDHE-RSA-CHACHA20-POLY1305
        ECDHE-RSA-AES128-GCM-SHA256
        ECDHE-ECDSA-AES128-GCM-SHA256
      Min TLS Version:  VersionTLS11
    Type:               Custom
 ...</pre>

						</p></div></li></ul></div></section><section class="section" id="tls-profiles-kubernetes-configuring_tls-security-profiles"><div class="titlepage"><div><div><h2 class="title">11.4. Configuring the TLS security profile for the control plane</h2></div></div></div><p>
				To configure a TLS security profile for the control plane, edit the <code class="literal">APIServer</code> custom resource (CR) to specify a predefined or custom TLS security profile. Setting the TLS security profile in the <code class="literal">APIServer</code> CR propagates the setting to the following control plane components:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Kubernetes API server
					</li><li class="listitem">
						Kubernetes controller manager
					</li><li class="listitem">
						Kubernetes scheduler
					</li><li class="listitem">
						OpenShift API server
					</li><li class="listitem">
						OpenShift OAuth API server
					</li><li class="listitem">
						OpenShift OAuth server
					</li><li class="listitem">
						etcd
					</li></ul></div><p>
				If a TLS security profile is not configured, the default TLS security profile is <code class="literal">Intermediate</code>.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The default TLS security profile for the Ingress Controller is based on the TLS security profile set for the API server.
				</p></div></div><div class="formalpara"><p class="title"><strong>Sample <code class="literal">APIServer</code> CR that configures the <code class="literal">Old</code> TLS security profile</strong></p><p>
					
<pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1
kind: APIServer
 ...
spec:
  tlsSecurityProfile:
    old: {}
    type: Old
 ...</pre>

				</p></div><p>
				The TLS security profile defines the minimum TLS version and the TLS ciphers required to communicate with the control plane components.
			</p><p>
				You can see the configured TLS security profile in the <code class="literal">APIServer</code> custom resource (CR) under <code class="literal">Spec.Tls Security Profile</code>. For the <code class="literal">Custom</code> TLS security profile, the specific ciphers and minimum TLS version are listed.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The control plane does not support TLS <code class="literal">1.3</code> as the minimum TLS version; the <code class="literal">Modern</code> profile is not supported because it requires TLS <code class="literal">1.3</code>.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the default <code class="literal">APIServer</code> CR to configure the TLS security profile:
					</p><pre class="programlisting language-terminal">$ oc edit APIServer cluster</pre></li><li class="listitem"><p class="simpara">
						Add the <code class="literal">spec.tlsSecurityProfile</code> field:
					</p><div class="formalpara"><p class="title"><strong>Sample <code class="literal">APIServer</code> CR for a <code class="literal">Custom</code> profile</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1
kind: APIServer
metadata:
  name: cluster
spec:
  tlsSecurityProfile:
    type: Custom <span id="CO85-1"><!--Empty--></span><span class="callout">1</span>
    custom: <span id="CO85-2"><!--Empty--></span><span class="callout">2</span>
      ciphers: <span id="CO85-3"><!--Empty--></span><span class="callout">3</span>
      - ECDHE-ECDSA-CHACHA20-POLY1305
      - ECDHE-RSA-CHACHA20-POLY1305
      - ECDHE-RSA-AES128-GCM-SHA256
      - ECDHE-ECDSA-AES128-GCM-SHA256
      minTLSVersion: VersionTLS11</pre>

						</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO85-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Specify the TLS security profile type (<code class="literal">Old</code>, <code class="literal">Intermediate</code>, or <code class="literal">Custom</code>). The default is <code class="literal">Intermediate</code>.
							</div></dd><dt><a href="#CO85-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Specify the appropriate field for the selected type:
							</div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">old: {}</code>
									</li><li class="listitem">
										<code class="literal">intermediate: {}</code>
									</li><li class="listitem">
										<code class="literal">custom:</code>
									</li></ul></div></dd><dt><a href="#CO85-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								For the <code class="literal">custom</code> type, specify a list of TLS ciphers and minimum accepted TLS version.
							</div></dd></dl></div></li><li class="listitem">
						Save the file to apply the changes.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that the TLS security profile is set in the <code class="literal">APIServer</code> CR:
					</p><pre class="programlisting language-terminal">$ oc describe apiserver cluster</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">Name:         cluster
Namespace:
 ...
API Version:  config.openshift.io/v1
Kind:         APIServer
 ...
Spec:
  Audit:
    Profile:  Default
  Tls Security Profile:
    Custom:
      Ciphers:
        ECDHE-ECDSA-CHACHA20-POLY1305
        ECDHE-RSA-CHACHA20-POLY1305
        ECDHE-RSA-AES128-GCM-SHA256
        ECDHE-ECDSA-AES128-GCM-SHA256
      Min TLS Version:  VersionTLS11
    Type:               Custom
 ...</pre>

						</p></div></li><li class="listitem"><p class="simpara">
						Verify that the TLS security profile is set in the <code class="literal">etcd</code> CR:
					</p><pre class="programlisting language-terminal">$ oc describe etcd cluster</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">Name:         cluster
Namespace:
 ...
API Version:  operator.openshift.io/v1
Kind:         Etcd
 ...
Spec:
  Log Level:         Normal
  Management State:  Managed
  Observed Config:
    Serving Info:
      Cipher Suites:
        TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
        TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
        TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
        TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
        TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256
        TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256
      Min TLS Version:           VersionTLS12
 ...</pre>

						</p></div></li></ul></div></section><section class="section" id="tls-profiles-kubelet-configuring_tls-security-profiles"><div class="titlepage"><div><div><h2 class="title">11.5. Configuring the TLS security profile for the kubelet</h2></div></div></div><p>
				To configure a TLS security profile for the kubelet when it is acting as an HTTP server, create a <code class="literal">KubeletConfig</code> custom resource (CR) to specify a predefined or custom TLS security profile for specific nodes. If a TLS security profile is not configured, the default TLS security profile is <code class="literal">Intermediate</code>.
			</p><p>
				The kubelet uses its HTTP/GRPC server to communicate with the Kubernetes API server, which sends commands to pods, gathers logs, and run exec commands on pods through the kubelet.
			</p><div class="formalpara"><p class="title"><strong>Sample <code class="literal">KubeletConfig</code> CR that configures the <code class="literal">Old</code> TLS security profile on worker nodes</strong></p><p>
					
<pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1
kind: KubeletConfig
 ...
spec:
  tlsSecurityProfile:
    old: {}
    type: Old
  machineConfigPoolSelector:
    matchLabels:
      pools.operator.machineconfiguration.openshift.io/worker: ""
#...</pre>

				</p></div><p>
				You can see the ciphers and the minimum TLS version of the configured TLS security profile in the <code class="literal">kubelet.conf</code> file on a configured node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a <code class="literal">KubeletConfig</code> CR to configure the TLS security profile:
					</p><div class="formalpara"><p class="title"><strong>Sample <code class="literal">KubeletConfig</code> CR for a <code class="literal">Custom</code> profile</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: machineconfiguration.openshift.io/v1
kind: KubeletConfig
metadata:
  name: set-kubelet-tls-security-profile
spec:
  tlsSecurityProfile:
    type: Custom <span id="CO86-1"><!--Empty--></span><span class="callout">1</span>
    custom: <span id="CO86-2"><!--Empty--></span><span class="callout">2</span>
      ciphers: <span id="CO86-3"><!--Empty--></span><span class="callout">3</span>
      - ECDHE-ECDSA-CHACHA20-POLY1305
      - ECDHE-RSA-CHACHA20-POLY1305
      - ECDHE-RSA-AES128-GCM-SHA256
      - ECDHE-ECDSA-AES128-GCM-SHA256
      minTLSVersion: VersionTLS11
  machineConfigPoolSelector:
    matchLabels:
      pools.operator.machineconfiguration.openshift.io/worker: "" <span id="CO86-4"><!--Empty--></span><span class="callout">4</span>
#...</pre>

						</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO86-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Specify the TLS security profile type (<code class="literal">Old</code>, <code class="literal">Intermediate</code>, or <code class="literal">Custom</code>). The default is <code class="literal">Intermediate</code>.
							</div></dd><dt><a href="#CO86-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Specify the appropriate field for the selected type:
							</div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">old: {}</code>
									</li><li class="listitem">
										<code class="literal">intermediate: {}</code>
									</li><li class="listitem">
										<code class="literal">custom:</code>
									</li></ul></div></dd><dt><a href="#CO86-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								For the <code class="literal">custom</code> type, specify a list of TLS ciphers and minimum accepted TLS version.
							</div></dd><dt><a href="#CO86-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								Optional: Specify the machine config pool label for the nodes you want to apply the TLS security profile.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Create the <code class="literal">KubeletConfig</code> object:
					</p><pre class="programlisting language-terminal">$ oc create -f &lt;filename&gt;</pre><p class="simpara">
						Depending on the number of worker nodes in the cluster, wait for the configured nodes to be rebooted one by one.
					</p></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
					To verify that the profile is set, perform the following steps after the nodes are in the <code class="literal">Ready</code> state:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Start a debug session for a configured node:
					</p><pre class="programlisting language-terminal">$ oc debug node/&lt;node_name&gt;</pre></li><li class="listitem"><p class="simpara">
						Set <code class="literal">/host</code> as the root directory within the debug shell:
					</p><pre class="programlisting language-terminal">sh-4.4# chroot /host</pre></li><li class="listitem"><p class="simpara">
						View the <code class="literal">kubelet.conf</code> file:
					</p><pre class="programlisting language-terminal">sh-4.4# cat /etc/kubernetes/kubelet.conf</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">  "kind": "KubeletConfiguration",
  "apiVersion": "kubelet.config.k8s.io/v1beta1",
#...
  "tlsCipherSuites": [
    "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256",
    "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",
    "TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384",
    "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384",
    "TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256",
    "TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"
  ],
  "tlsMinVersion": "VersionTLS12",
#...</pre>

						</p></div></li></ol></div></section></section><section class="chapter" id="seccomp-profiles"><div class="titlepage"><div><div><h1 class="title">Chapter 12. Configuring seccomp profiles</h1></div></div></div><p>
			An OpenShift Container Platform container or a pod runs a single application that performs one or more well-defined tasks. The application usually requires only a small subset of the underlying operating system kernel APIs. Secure computing mode, seccomp, is a Linux kernel feature that can be used to limit the process running in a container to only using a subset of the available system calls.
		</p><p>
			The <code class="literal">restricted-v2</code> SCC applies to all newly created pods in 4.13. The default seccomp profile <code class="literal">runtime/default</code> is applied to these pods.
		</p><p>
			Seccomp profiles are stored as JSON files on the disk.
		</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
				Seccomp profiles cannot be applied to privileged containers.
			</p></div></div><section class="section" id="verifying-default-seccomp-profile_configuring-seccomp-profiles"><div class="titlepage"><div><div><h2 class="title">12.1. Verifying the default seccomp profile applied to a pod</h2></div></div></div><p>
				OpenShift Container Platform ships with a default seccomp profile that is referenced as <code class="literal">runtime/default</code>. In 4.13, newly created pods have the Security Context Constraint (SCC) set to <code class="literal">restricted-v2</code> and the default seccomp profile applies to the pod.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						You can verify the Security Context Constraint (SCC) and the default seccomp profile set on a pod by running the following commands:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Verify what pods are running in the namespace:
							</p><pre class="programlisting language-terminal">$ oc get pods -n &lt;namespace&gt;</pre><p class="simpara">
								For example, to verify what pods are running in the <code class="literal">workshop</code> namespace run the following:
							</p><pre class="programlisting language-terminal">$ oc get pods -n workshop</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                READY   STATUS      RESTARTS   AGE
parksmap-1-4xkwf    1/1     Running     0          2m17s
parksmap-1-deploy   0/1     Completed   0          2m22s</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Inspect the pods:
							</p><pre class="programlisting language-terminal">$ oc get pod parksmap-1-4xkwf -n workshop -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">apiVersion: v1
kind: Pod
metadata:
  annotations:
    k8s.v1.cni.cncf.io/network-status: |-
      [{
          "name": "openshift-sdn",
          "interface": "eth0",
          "ips": [
              "10.131.0.18"
          ],
          "default": true,
          "dns": {}
      }]
    k8s.v1.cni.cncf.io/network-status: |-
      [{
          "name": "openshift-sdn",
          "interface": "eth0",
          "ips": [
              "10.131.0.18"
          ],
          "default": true,
          "dns": {}
      }]
    openshift.io/deployment-config.latest-version: "1"
    openshift.io/deployment-config.name: parksmap
    openshift.io/deployment.name: parksmap-1
    openshift.io/generated-by: OpenShiftWebConsole
    openshift.io/scc: restricted-v2 <span id="CO87-1"><!--Empty--></span><span class="callout">1</span>
    seccomp.security.alpha.kubernetes.io/pod: runtime/default <span id="CO87-2"><!--Empty--></span><span class="callout">2</span></pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO87-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										The <code class="literal">restricted-v2</code> SCC is added by default if your workload does not have access to a different SCC.
									</div></dd><dt><a href="#CO87-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Newly created pods in 4.13 will have the seccomp profile configured to <code class="literal">runtime/default</code> as mandated by the SCC.
									</div></dd></dl></div></li></ol></div></li></ol></div><section class="section" id="upgraded_cluster_configuring-seccomp-profiles"><div class="titlepage"><div><div><h3 class="title">12.1.1. Upgraded cluster</h3></div></div></div><p>
					In clusters upgraded to 4.13 all authenticated users have access to the <code class="literal">restricted</code> and <code class="literal">restricted-v2</code> SCC.
				</p><p>
					A workload admitted by the SCC <code class="literal">restricted</code> for example, on a OpenShift Container Platform v4.10 cluster when upgraded may get admitted by <code class="literal">restricted-v2</code>. This is because <code class="literal">restricted-v2</code> is the more restrictive SCC between <code class="literal">restricted</code> and <code class="literal">restricted-v2</code>.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The workload must be able to run with <code class="literal">retricted-v2</code>.
					</p></div></div><p>
					Conversely with a workload that requires <code class="literal">privilegeEscalation: true</code> this workload will continue to have the <code class="literal">restricted</code> SCC available for any authenticated user. This is because <code class="literal">restricted-v2</code> does not allow <code class="literal">privilegeEscalation</code>.
				</p></section><section class="section" id="newly_installed_configuring-seccomp-profiles"><div class="titlepage"><div><div><h3 class="title">12.1.2. Newly installed cluster</h3></div></div></div><p>
					For newly installed OpenShift Container Platform 4.11 or later clusters, the <code class="literal">restricted-v2</code> replaces the <code class="literal">restricted</code> SCC as an SCC that is available to be used by any authenticated user. A workload with <code class="literal">privilegeEscalation: true</code>, is not admitted into the cluster since <code class="literal">restricted-v2</code> is the only SCC available for authenticated users by default.
				</p><p>
					The feature <code class="literal">privilegeEscalation</code> is allowed by <code class="literal">restricted</code> but not by <code class="literal">restricted-v2</code>. More features are denied by <code class="literal">restricted-v2</code> than were allowed by <code class="literal">restricted</code> SCC.
				</p><p>
					A workload with <code class="literal">privilegeEscalation: true</code> may be admitted into a newly installed OpenShift Container Platform 4.11 or later cluster. To give access to the <code class="literal">restricted</code> SCC to the ServiceAccount running the workload (or any other SCC that can admit this workload) using a RoleBinding run the following command:
				</p><pre class="programlisting language-terminal">$ oc -n &lt;workload-namespace&gt; adm policy add-scc-to-user &lt;scc-name&gt; -z &lt;serviceaccount_name&gt;</pre><p>
					In OpenShift Container Platform 4.13 the ability to add the pod annotations <code class="literal">seccomp.security.alpha.kubernetes.io/pod: runtime/default</code> and <code class="literal">container.seccomp.security.alpha.kubernetes.io/&lt;container_name&gt;: runtime/default</code> is deprecated.
				</p></section></section><section class="section" id="custom-seccomp-profile"><div class="titlepage"><div><div><h2 class="title">12.2. Configuring a custom seccomp profile</h2></div></div></div><p>
				You can configure a custom seccomp profile, which allows you to update the filters based on the application requirements. This allows cluster administrators to have greater control over the security of workloads running in OpenShift Container Platform.
			</p><p>
				Seccomp security profiles list the system calls (syscalls) a process can make. Permissions are broader than SELinux, which restrict operations, such as <code class="literal">write</code>, system-wide.
			</p><section class="section" id="creating-custom-seccomp-profile_configuring-seccomp-profiles"><div class="titlepage"><div><div><h3 class="title">12.2.1. Creating seccomp profiles</h3></div></div></div><p>
					You can use the <code class="literal">MachineConfig</code> object to create profiles.
				</p><p>
					Seccomp can restrict system calls (syscalls) within a container, limiting the access of your application.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have cluster admin permissions.
						</li><li class="listitem">
							You have created a custom security context constraints (SCC). For more information, see <span class="emphasis"><em>Additional resources</em></span>.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Create the <code class="literal">MachineConfig</code> object:
						</p><pre class="programlisting language-yaml">apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: worker
  name: custom-seccomp
spec:
  config:
    ignition:
      version: 3.2.0
    storage:
      files:
      - contents:
          source: data:text/plain;charset=utf-8;base64,&lt;hash&gt;
        filesystem: root
        mode: 0644
        path: /var/lib/kubelet/seccomp/seccomp-nostat.json</pre></li></ul></div></section><section class="section" id="setting-custom-seccomp-profile_configuring-seccomp-profiles"><div class="titlepage"><div><div><h3 class="title">12.2.2. Setting up the custom seccomp profile</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisite</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have cluster administrator permissions.
						</li><li class="listitem">
							You have created a custom security context constraints (SCC). For more information, see "Additional resources".
						</li><li class="listitem">
							You have created a custom seccomp profile.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Upload your custom seccomp profile to <code class="literal">/var/lib/kubelet/seccomp/&lt;custom-name&gt;.json</code> by using the Machine Config. See "Additional resources" for detailed steps.
						</li><li class="listitem"><p class="simpara">
							Update the custom SCC by providing reference to the created custom seccomp profile:
						</p><pre class="programlisting language-yaml">seccompProfiles:
- localhost/&lt;custom-name&gt;.json <span id="CO88-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO88-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Provide the name of your custom seccomp profile.
								</div></dd></dl></div></li></ol></div></section><section class="section" id="applying-custom-seccomp-profile_configuring-seccomp-profiles"><div class="titlepage"><div><div><h3 class="title">12.2.3. Applying the custom seccomp profile to the workload</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisite</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The cluster administrator has set up the custom seccomp profile. For more details, see "Setting up the custom seccomp profile".
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Apply the seccomp profile to the workload by setting the <code class="literal">securityContext.seccompProfile.type</code> field as following:
						</p><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
								
<pre class="programlisting language-yaml">spec:
  securityContext:
    seccompProfile:
      type: Localhost
      localhostProfile: &lt;custom-name&gt;.json <span id="CO89-1"><!--Empty--></span><span class="callout">1</span></pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO89-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Provide the name of your custom seccomp profile.
								</div></dd></dl></div><p class="simpara">
							Alternatively, you can use the pod annotations <code class="literal">seccomp.security.alpha.kubernetes.io/pod: localhost/&lt;custom-name&gt;.json</code>. However, this method is deprecated in OpenShift Container Platform 4.13.
						</p></li></ul></div><p>
					During deployment, the admission controller validates the following:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The annotations against the current SCCs allowed by the user role.
						</li><li class="listitem">
							The SCC, which includes the seccomp profile, is allowed for the pod.
						</li></ul></div><p>
					If the SCC is allowed for the pod, the kubelet runs the pod with the specified seccomp profile.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Ensure that the seccomp profile is deployed to all worker nodes.
					</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The custom SCC must have the appropriate priority to be automatically assigned to the pod or meet other conditions required by the pod, such as allowing CAP_NET_ADMIN.
					</p></div></div></section></section><section class="section _additional-resources" id="additional-resources_configuring-seccomp-profiles"><div class="titlepage"><div><div><h2 class="title">12.3. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#managing-security-context-constraints">Managing security context constraints</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/post-installation_configuration/#machine-configuration-tasks">Post-installation machine configuration tasks</a>
					</li></ul></div></section></section><section class="chapter" id="allowing-javascript-based-access-api-server"><div class="titlepage"><div><div><h1 class="title">Chapter 13. Allowing JavaScript-based access to the API server from additional hosts</h1></div></div></div><section class="section" id="auth-allowing-javascript-access-api-server_auth-allowed-origins"><div class="titlepage"><div><div><h2 class="title">13.1. Allowing JavaScript-based access to the API server from additional hosts</h2></div></div></div><p>
				The default OpenShift Container Platform configuration only allows the web console to send requests to the API server.
			</p><p>
				If you need to access the API server or OAuth server from a JavaScript application using a different hostname, you can configure additional hostnames to allow.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">APIServer</code> resource:
					</p><pre class="programlisting language-terminal">$ oc edit apiserver.config.openshift.io cluster</pre></li><li class="listitem"><p class="simpara">
						Add the <code class="literal">additionalCORSAllowedOrigins</code> field under the <code class="literal">spec</code> section and specify one or more additional hostnames:
					</p><pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1
kind: APIServer
metadata:
  annotations:
    release.openshift.io/create-only: "true"
  creationTimestamp: "2019-07-11T17:35:37Z"
  generation: 1
  name: cluster
  resourceVersion: "907"
  selfLink: /apis/config.openshift.io/v1/apiservers/cluster
  uid: 4b45a8dd-a402-11e9-91ec-0219944e0696
spec:
  additionalCORSAllowedOrigins:
  - (?i)//my\.subdomain\.domain\.com(:|\z) <span id="CO90-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO90-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								The hostname is specified as a <a class="link" href="https://github.com/google/re2/wiki/Syntax">Golang regular expression</a> that matches against CORS headers from HTTP requests against the API server and OAuth server.
							</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							This example uses the following syntax:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The <code class="literal">(?i)</code> makes it case-insensitive.
								</li><li class="listitem">
									The <code class="literal">//</code> pins to the beginning of the domain and matches the double slash following <code class="literal">http:</code> or <code class="literal">https:</code>.
								</li><li class="listitem">
									The <code class="literal">\.</code> escapes dots in the domain name.
								</li><li class="listitem">
									The <code class="literal">(:|\z)</code> matches the end of the domain name <code class="literal">(\z)</code> or a port separator <code class="literal">(:)</code>.
								</li></ul></div></div></div></li><li class="listitem">
						Save the file to apply the changes.
					</li></ol></div></section></section><section class="chapter" id="encrypting-etcd"><div class="titlepage"><div><div><h1 class="title">Chapter 14. Encrypting etcd data</h1></div></div></div><section class="section" id="about-etcd_encrypting-etcd"><div class="titlepage"><div><div><h2 class="title">14.1. About etcd encryption</h2></div></div></div><p>
				By default, etcd data is not encrypted in OpenShift Container Platform. You can enable etcd encryption for your cluster to provide an additional layer of data security. For example, it can help protect the loss of sensitive data if an etcd backup is exposed to the incorrect parties.
			</p><p>
				When you enable etcd encryption, the following OpenShift API server and Kubernetes API server resources are encrypted:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Secrets
					</li><li class="listitem">
						Config maps
					</li><li class="listitem">
						Routes
					</li><li class="listitem">
						OAuth access tokens
					</li><li class="listitem">
						OAuth authorize tokens
					</li></ul></div><p>
				When you enable etcd encryption, encryption keys are created. You must have these keys to restore from an etcd backup.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Etcd encryption only encrypts values, not keys. Resource types, namespaces, and object names are unencrypted.
				</p><p>
					If etcd encryption is enabled during a backup, the <code class="literal"><span class="emphasis"><em>static_kuberesources_&lt;datetimestamp&gt;.tar.gz</em></span></code> file contains the encryption keys for the etcd snapshot. For security reasons, store this file separately from the etcd snapshot. However, this file is required to restore a previous state of etcd from the respective etcd snapshot.
				</p></div></div></section><section class="section" id="etcd-encryption-types_encrypting-etcd"><div class="titlepage"><div><div><h2 class="title">14.2. Supported encryption types</h2></div></div></div><p>
				The following encryption types are supported for encrypting etcd data in OpenShift Container Platform:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">AES-CBC</span></dt><dd>
							Uses AES-CBC with PKCS#7 padding and a 32 byte key to perform the encryption. The encryption keys are rotated weekly.
						</dd><dt><span class="term">AES-GCM</span></dt><dd>
							Uses AES-GCM with a random nonce and a 32 byte key to perform the encryption. The encryption keys are rotated weekly.
						</dd></dl></div></section><section class="section" id="enabling-etcd-encryption_encrypting-etcd"><div class="titlepage"><div><div><h2 class="title">14.3. Enabling etcd encryption</h2></div></div></div><p>
				You can enable etcd encryption to encrypt sensitive resources in your cluster.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Do not back up etcd resources until the initial encryption process is completed. If the encryption process is not completed, the backup might be only partially encrypted.
				</p><p>
					After you enable etcd encryption, several changes can occur:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The etcd encryption might affect the memory consumption of a few resources.
						</li><li class="listitem">
							You might notice a transient affect on backup performance because the leader must serve the backup.
						</li><li class="listitem">
							A disk I/O can affect the node that receives the backup state.
						</li></ul></div></div></div><p>
				You can encrypt the etcd database in either AES-GCM or AES-CBC encryption.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					To migrate your etcd database from one encryption type to the other, you can modify the API server’s <code class="literal">spec.encryption.type</code> field. Migration of the etcd data to the new encryption type occurs automatically.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Modify the <code class="literal">APIServer</code> object:
					</p><pre class="programlisting language-terminal">$ oc edit apiserver</pre></li><li class="listitem"><p class="simpara">
						Set the <code class="literal">spec.encryption.type</code> field to <code class="literal">aesgcm</code> or <code class="literal">aescbc</code>:
					</p><pre class="programlisting language-yaml">spec:
  encryption:
    type: aesgcm <span id="CO91-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO91-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Set to <code class="literal">aesgcm</code> for AES-GCM encryption or <code class="literal">aescbc</code> for AES-CBC encryption.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Save the file to apply the changes.
					</p><p class="simpara">
						The encryption process starts. It can take 20 minutes or longer for this process to complete, depending on the size of the etcd database.
					</p></li><li class="listitem"><p class="simpara">
						Verify that etcd encryption was successful.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Review the <code class="literal">Encrypted</code> status condition for the OpenShift API server to verify that its resources were successfully encrypted:
							</p><pre class="programlisting language-terminal">$ oc get openshiftapiserver -o=jsonpath='{range .items[0].status.conditions[?(@.type=="Encrypted")]}{.reason}{"\n"}{.message}{"\n"}'</pre><p class="simpara">
								The output shows <code class="literal">EncryptionCompleted</code> upon successful encryption:
							</p><pre class="programlisting language-terminal">EncryptionCompleted
All resources encrypted: routes.route.openshift.io</pre><p class="simpara">
								If the output shows <code class="literal">EncryptionInProgress</code>, encryption is still in progress. Wait a few minutes and try again.
							</p></li><li class="listitem"><p class="simpara">
								Review the <code class="literal">Encrypted</code> status condition for the Kubernetes API server to verify that its resources were successfully encrypted:
							</p><pre class="programlisting language-terminal">$ oc get kubeapiserver -o=jsonpath='{range .items[0].status.conditions[?(@.type=="Encrypted")]}{.reason}{"\n"}{.message}{"\n"}'</pre><p class="simpara">
								The output shows <code class="literal">EncryptionCompleted</code> upon successful encryption:
							</p><pre class="programlisting language-terminal">EncryptionCompleted
All resources encrypted: secrets, configmaps</pre><p class="simpara">
								If the output shows <code class="literal">EncryptionInProgress</code>, encryption is still in progress. Wait a few minutes and try again.
							</p></li><li class="listitem"><p class="simpara">
								Review the <code class="literal">Encrypted</code> status condition for the OpenShift OAuth API server to verify that its resources were successfully encrypted:
							</p><pre class="programlisting language-terminal">$ oc get authentication.operator.openshift.io -o=jsonpath='{range .items[0].status.conditions[?(@.type=="Encrypted")]}{.reason}{"\n"}{.message}{"\n"}'</pre><p class="simpara">
								The output shows <code class="literal">EncryptionCompleted</code> upon successful encryption:
							</p><pre class="programlisting language-terminal">EncryptionCompleted
All resources encrypted: oauthaccesstokens.oauth.openshift.io, oauthauthorizetokens.oauth.openshift.io</pre><p class="simpara">
								If the output shows <code class="literal">EncryptionInProgress</code>, encryption is still in progress. Wait a few minutes and try again.
							</p></li></ol></div></li></ol></div></section><section class="section" id="disabling-etcd-encryption_encrypting-etcd"><div class="titlepage"><div><div><h2 class="title">14.4. Disabling etcd encryption</h2></div></div></div><p>
				You can disable encryption of etcd data in your cluster.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Modify the <code class="literal">APIServer</code> object:
					</p><pre class="programlisting language-terminal">$ oc edit apiserver</pre></li><li class="listitem"><p class="simpara">
						Set the <code class="literal">encryption</code> field type to <code class="literal">identity</code>:
					</p><pre class="programlisting language-yaml">spec:
  encryption:
    type: identity <span id="CO92-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO92-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								The <code class="literal">identity</code> type is the default value and means that no encryption is performed.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Save the file to apply the changes.
					</p><p class="simpara">
						The decryption process starts. It can take 20 minutes or longer for this process to complete, depending on the size of your cluster.
					</p></li><li class="listitem"><p class="simpara">
						Verify that etcd decryption was successful.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Review the <code class="literal">Encrypted</code> status condition for the OpenShift API server to verify that its resources were successfully decrypted:
							</p><pre class="programlisting language-terminal">$ oc get openshiftapiserver -o=jsonpath='{range .items[0].status.conditions[?(@.type=="Encrypted")]}{.reason}{"\n"}{.message}{"\n"}'</pre><p class="simpara">
								The output shows <code class="literal">DecryptionCompleted</code> upon successful decryption:
							</p><pre class="programlisting language-terminal">DecryptionCompleted
Encryption mode set to identity and everything is decrypted</pre><p class="simpara">
								If the output shows <code class="literal">DecryptionInProgress</code>, decryption is still in progress. Wait a few minutes and try again.
							</p></li><li class="listitem"><p class="simpara">
								Review the <code class="literal">Encrypted</code> status condition for the Kubernetes API server to verify that its resources were successfully decrypted:
							</p><pre class="programlisting language-terminal">$ oc get kubeapiserver -o=jsonpath='{range .items[0].status.conditions[?(@.type=="Encrypted")]}{.reason}{"\n"}{.message}{"\n"}'</pre><p class="simpara">
								The output shows <code class="literal">DecryptionCompleted</code> upon successful decryption:
							</p><pre class="programlisting language-terminal">DecryptionCompleted
Encryption mode set to identity and everything is decrypted</pre><p class="simpara">
								If the output shows <code class="literal">DecryptionInProgress</code>, decryption is still in progress. Wait a few minutes and try again.
							</p></li><li class="listitem"><p class="simpara">
								Review the <code class="literal">Encrypted</code> status condition for the OpenShift OAuth API server to verify that its resources were successfully decrypted:
							</p><pre class="programlisting language-terminal">$ oc get authentication.operator.openshift.io -o=jsonpath='{range .items[0].status.conditions[?(@.type=="Encrypted")]}{.reason}{"\n"}{.message}{"\n"}'</pre><p class="simpara">
								The output shows <code class="literal">DecryptionCompleted</code> upon successful decryption:
							</p><pre class="programlisting language-terminal">DecryptionCompleted
Encryption mode set to identity and everything is decrypted</pre><p class="simpara">
								If the output shows <code class="literal">DecryptionInProgress</code>, decryption is still in progress. Wait a few minutes and try again.
							</p></li></ol></div></li></ol></div></section></section><section class="chapter" id="pod-vulnerability-scan"><div class="titlepage"><div><div><h1 class="title">Chapter 15. Scanning pods for vulnerabilities</h1></div></div></div><p>
			Using the Red Hat Quay Container Security Operator, you can access vulnerability scan results from the OpenShift Container Platform web console for container images used in active pods on the cluster. The Red Hat Quay Container Security Operator:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Watches containers associated with pods on all or specified namespaces
				</li><li class="listitem">
					Queries the container registry where the containers came from for vulnerability information, provided an image’s registry is running image scanning (such as <a class="link" href="https://quay.io">Quay.io</a> or a <a class="link" href="https://access.redhat.com/products/red-hat-quay">Red Hat Quay</a> registry with Clair scanning)
				</li><li class="listitem">
					Exposes vulnerabilities via the <code class="literal">ImageManifestVuln</code> object in the Kubernetes API
				</li></ul></div><p>
			Using the instructions here, the Red Hat Quay Container Security Operator is installed in the <code class="literal">openshift-operators</code> namespace, so it is available to all namespaces on your OpenShift Container Platform cluster.
		</p><section class="section" id="security-pod-scan-cso_pod-vulnerability-scan"><div class="titlepage"><div><div><h2 class="title">15.1. Installing the Red Hat Quay Container Security Operator</h2></div></div></div><p>
				You can install the Red Hat Quay Container Security Operator from the OpenShift Container Platform web console Operator Hub, or by using the CLI.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed the <code class="literal">oc</code> CLI.
					</li><li class="listitem">
						You have administrator privileges to the OpenShift Container Platform cluster.
					</li><li class="listitem">
						You have containers that come from a Red Hat Quay or Quay.io registry running on your cluster.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						You can install the Red Hat Quay Container Security Operator by using the OpenShift Container Platform web console:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								On the web console, navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span> and select <span class="strong strong"><strong>Security</strong></span>.
							</li><li class="listitem">
								Select the <span class="strong strong"><strong>Red Hat Quay Container Security Operator</strong></span> Operator, and then select <span class="strong strong"><strong>Install</strong></span>.
							</li><li class="listitem">
								On the <span class="strong strong"><strong>Red Hat Quay Container Security Operator</strong></span> page, select <span class="strong strong"><strong>Install</strong></span>. <span class="strong strong"><strong>Update channel</strong></span>, <span class="strong strong"><strong>Installation mode</strong></span>, and <span class="strong strong"><strong>Update approval</strong></span> are selected automatically. The <span class="strong strong"><strong>Installed Namespace</strong></span> field defaults to <code class="literal">openshift-operators</code>. You can adjust these settings as needed.
							</li><li class="listitem">
								Select <span class="strong strong"><strong>Install</strong></span>. The <span class="strong strong"><strong>Red Hat Quay Container Security Operator</strong></span> appears after a few moments on the <span class="strong strong"><strong>Installed Operators</strong></span> page.
							</li><li class="listitem"><p class="simpara">
								Optional: You can add custom certificates to the Red Hat Quay Container Security Operator. For example, create a certificate named <code class="literal">quay.crt</code> in the current directory. Then, run the following command to add the custom certificate to the Red Hat Quay Container Security Operator:
							</p><pre class="programlisting language-terminal">$ oc create secret generic container-security-operator-extra-certs --from-file=quay.crt -n openshift-operators</pre></li><li class="listitem">
								Optional: If you added a custom certificate, restart the Red Hat Quay Container Security Operator pod for the new certificates to take effect.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Alternatively, you can install the Red Hat Quay Container Security Operator by using the CLI:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Retrieve the latest version of the Container Security Operator and its channel by entering the following command:
							</p><pre class="programlisting language-terminal">$ oc get packagemanifests container-security-operator \
  -o jsonpath='{range .status.channels[*]}{@.currentCSV} {@.name}{"\n"}{end}' \
  | awk '{print "STARTING_CSV=" $1 " CHANNEL=" $2 }' \
  | sort -nr \
  | head -1</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">STARTING_CSV=container-security-operator.v3.8.9 CHANNEL=stable-3.8</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Using the output from the previous command, create a <code class="literal">Subscription</code> custom resource for the Red Hat Quay Container Security Operator and save it as <code class="literal">container-security-operator.yaml</code>. For example:
							</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: container-security-operator
  namespace: openshift-operators
spec:
  channel: ${CHANNEL} <span id="CO93-1"><!--Empty--></span><span class="callout">1</span>
  installPlanApproval: Automatic
  name: container-security-operator
  source: redhat-operators
  sourceNamespace: openshift-marketplace
  startingCSV: ${STARTING_CSV} <span id="CO93-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO93-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Specify the value you obtained in the previous step for the <code class="literal">spec.channel</code> parameter.
									</div></dd><dt><a href="#CO93-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Specify the value you obtained in the previous step for the <code class="literal">spec.startingCSV</code> parameter.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Enter the following command to apply the configuration:
							</p><pre class="programlisting language-terminal">$ oc apply -f container-security-operator.yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">subscription.operators.coreos.com/container-security-operator created</pre>

								</p></div></li></ol></div></li></ol></div></section><section class="section" id="security-pod-scan-cso-using_pod-vulnerability-scan"><div class="titlepage"><div><div><h2 class="title">15.2. Using the Red Hat Quay Container Security Operator</h2></div></div></div><p>
				The following procedure shows you how to use the Red Hat Quay Container Security Operator.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed the Red Hat Quay Container Security Operator.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						On the OpenShift Container Platform web console, navigate to <span class="strong strong"><strong>Home</strong></span> → <span class="strong strong"><strong>Overview</strong></span>. Under the <span class="strong strong"><strong>Status</strong></span> section, <span class="strong strong"><strong>Quay Image Security</strong></span> provides the number of vulnerabilities found.
					</li><li class="listitem"><p class="simpara">
						Click <span class="strong strong"><strong>Quay Image Security</strong></span> to reveal the <span class="strong strong"><strong>Quay Image Security breakdown</strong></span>, which details the severity of the vulnerabilities, whether the vulnerabilities can be fixed, and the total number of vulnerabilities. For example:
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/1e73a928ae726c6d155e7992a613153a/image_security.png" alt="Access image scanning data from OpenShift Container Platform dashboard"/></span>

					</p></li><li class="listitem"><p class="simpara">
						You can address detected vulnerabilities in one of two ways:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Select the link to the vulnerability. This takes you to the container registry that the container came from, where you can see information about the vulnerability. The following example shows detected vulnerabilities from a Quay.io registry:
							</p><p class="simpara">
								<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/cf3da068e576f163f825420f22c8b3e0/cso-registry-vulnerable.png" alt="The Red Hat Quay Container Security Operator points you to a registry containing the vulnerable image"/></span>

							</p></li><li class="listitem"><p class="simpara">
								Select the <span class="strong strong"><strong>namespace</strong></span> link. This takes you to the <span class="strong strong"><strong>ImageManifestVuln</strong></span> page, where you can see the name of the selected image and all of the namespaces where that image is running. For example, the following image shows you that a particular vulnerable image is running in the <code class="literal">quay-enterprise</code> namespace:
							</p><p class="simpara">
								<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/e3c649754b61483a1179ab876d366112/cso-namespace-vulnerable.png" alt="View namespaces a vulnerable image is running in"/></span>

							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						After you have learned what images are vulnerable, how to fix those vulnerabilities, and the namespaces that the images are being run in, you can improve security by performing the following actions:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Alert anyone in your organization who is running the image and request that they correct the vulnerability.
							</li><li class="listitem"><p class="simpara">
								Stop the images from running by deleting the deployment or other object that started the pod that the image is in.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									If you delete the pod, it might take several minutes for the vulnerability information to reset on the dashboard.
								</p></div></div></li></ol></div></li></ol></div></section><section class="section" id="security-pod-scan-query-cli_pod-vulnerability-scan"><div class="titlepage"><div><div><h2 class="title">15.3. Querying image vulnerabilities from the CLI</h2></div></div></div><p>
				Using the <code class="literal">oc</code> command, you can display information about vulnerabilities detected by the Red Hat Quay Container Security Operator.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed the Red Hat Quay Container Security Operator on your OpenShift Container Platform instance.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Enter the following command to query for detected container image vulnerabilities:
					</p><pre class="programlisting language-terminal">$ oc get vuln --all-namespaces</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">NAMESPACE     NAME              AGE
default       sha256.ca90...    6m56s
skynet        sha256.ca90...    9m37s</pre>

						</p></div></li><li class="listitem"><p class="simpara">
						To display details for a particular vulnerability, append the vulnerability name and its namespace to the <code class="literal">oc describe</code> command. The following example shows an active container whose image includes an RPM package with a vulnerability:
					</p><pre class="programlisting language-terminal">$ oc describe vuln --namespace mynamespace sha256.ac50e3752...</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">Name:         sha256.ac50e3752...
Namespace:    quay-enterprise
...
Spec:
  Features:
    Name:            nss-util
    Namespace Name:  centos:7
    Version:         3.44.0-3.el7
    Versionformat:   rpm
    Vulnerabilities:
      Description: Network Security Services (NSS) is a set of libraries...</pre>

						</p></div></li></ol></div></section></section><section class="chapter" id="network-bound-disk-encryption-nbde"><div class="titlepage"><div><div><h1 class="title">Chapter 16. Network-Bound Disk Encryption (NBDE)</h1></div></div></div><section class="section" id="nbde-about-disk-encryption-technology"><div class="titlepage"><div><div><h2 class="title">16.1. About disk encryption technology</h2></div></div></div><p>
				Network-Bound Disk Encryption (NBDE) allows you to encrypt root volumes of hard drives on physical and virtual machines without having to manually enter a password when restarting machines.
			</p><section class="section" id="nbde-disk-encryption-technology-comparison_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.1.1. Disk encryption technology comparison</h3></div></div></div><p>
					To understand the merits of Network-Bound Disk Encryption (NBDE) for securing data at rest on edge servers, compare key escrow and TPM disk encryption without Clevis to NBDE on systems running Red Hat Enterprise Linux (RHEL).
				</p><p>
					The following table presents some tradeoffs to consider around the threat model and the complexity of each encryption solution.
				</p><div class="informaltable"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139961121265200" scope="col">Scenario</th><th align="left" valign="top" id="idm139961121264112" scope="col">Key escrow</th><th align="left" valign="top" id="idm139961121263024" scope="col">TPM disk encryption (without Clevis)</th><th align="left" valign="top" id="idm139961121261920" scope="col">NBDE</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139961121265200"> <p>
									Protects against single-disk theft
								</p>
								 </td><td align="left" valign="top" headers="idm139961121264112"> <p>
									X
								</p>
								 </td><td align="left" valign="top" headers="idm139961121263024"> <p>
									X
								</p>
								 </td><td align="left" valign="top" headers="idm139961121261920"> <p>
									X
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139961121265200"> <p>
									Protects against entire-server theft
								</p>
								 </td><td align="left" valign="top" headers="idm139961121264112"> <p>
									X
								</p>
								 </td><td align="left" valign="top" headers="idm139961121263024"> </td><td align="left" valign="top" headers="idm139961121261920"> <p>
									X
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139961121265200"> <p>
									Systems can reboot independently from the network
								</p>
								 </td><td align="left" valign="top" headers="idm139961121264112"> </td><td align="left" valign="top" headers="idm139961121263024"> <p>
									X
								</p>
								 </td><td align="left" valign="top" headers="idm139961121261920"> </td></tr><tr><td align="left" valign="top" headers="idm139961121265200"> <p>
									No periodic rekeying
								</p>
								 </td><td align="left" valign="top" headers="idm139961121264112"> </td><td align="left" valign="top" headers="idm139961121263024"> <p>
									X
								</p>
								 </td><td align="left" valign="top" headers="idm139961121261920"> </td></tr><tr><td align="left" valign="top" headers="idm139961121265200"> <p>
									Key is never transmitted over a network
								</p>
								 </td><td align="left" valign="top" headers="idm139961121264112"> </td><td align="left" valign="top" headers="idm139961121263024"> <p>
									X
								</p>
								 </td><td align="left" valign="top" headers="idm139961121261920"> <p>
									X
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139961121265200"> <p>
									Supported by OpenShift
								</p>
								 </td><td align="left" valign="top" headers="idm139961121264112"> </td><td align="left" valign="top" headers="idm139961121263024"> <p>
									X
								</p>
								 </td><td align="left" valign="top" headers="idm139961121261920"> <p>
									X
								</p>
								 </td></tr></tbody></table></div><section class="section" id="nbde-key-escrow_nbde-implementation"><div class="titlepage"><div><div><h4 class="title">16.1.1.1. Key escrow</h4></div></div></div><p>
						Key escrow is the traditional system for storing cryptographic keys. The key server on the network stores the encryption key for a node with an encrypted boot disk and returns it when queried. The complexities around key management, transport encryption, and authentication do not make this a reasonable choice for boot disk encryption.
					</p><p>
						Although available in Red Hat Enterprise Linux (RHEL), key escrow-based disk encryption setup and management is a manual process and not suited to OpenShift Container Platform automation operations, including automated addition of nodes, and currently not supported by OpenShift Container Platform.
					</p></section><section class="section" id="nbde-tpm-encryption_nbde-implementation"><div class="titlepage"><div><div><h4 class="title">16.1.1.2. TPM encryption</h4></div></div></div><p>
						Trusted Platform Module (TPM) disk encryption is best suited for data centers or installations in remote protected locations. Full disk encryption utilities such as dm-crypt and BitLocker encrypt disks with a TPM bind key, and then store the TPM bind key in the TPM, which is attached to the motherboard of the node. The main benefit of this method is that there is no external dependency, and the node is able to decrypt its own disks at boot time without any external interaction.
					</p><p>
						TPM disk encryption protects against decryption of data if the disk is stolen from the node and analyzed externally. However, for insecure locations this may not be sufficient. For example, if an attacker steals the entire node, the attacker can intercept the data when powering on the node, because the node decrypts its own disks. This applies to nodes with physical TPM2 chips as well as virtual machines with Virtual Trusted Platform Module (VTPM) access.
					</p></section><section class="section" id="nbde-network-bound-disk-encryption_nbde-implementation"><div class="titlepage"><div><div><h4 class="title">16.1.1.3. Network-Bound Disk Encryption (NBDE)</h4></div></div></div><p>
						Network-Bound Disk Encryption (NBDE) effectively ties the encryption key to an external server or set of servers in a secure and anonymous way across the network. This is not a key escrow, in that the nodes do not store the encryption key or transfer it over the network, but otherwise behaves in a similar fashion.
					</p><p>
						Clevis and Tang are generic client and server components that provide network-bound encryption. Red Hat Enterprise Linux CoreOS (RHCOS) uses these components in conjunction with Linux Unified Key Setup-on-disk-format (LUKS) to encrypt and decrypt root and non-root storage volumes to accomplish Network-Bound Disk Encryption.
					</p><p>
						When a node starts, it attempts to contact a predefined set of Tang servers by performing a cryptographic handshake. If it can reach the required number of Tang servers, the node can construct its disk decryption key and unlock the disks to continue booting. If the node cannot access a Tang server due to a network outage or server unavailability, the node cannot boot and continues retrying indefinitely until the Tang servers become available again. Because the key is effectively tied to the node’s presence in a network, an attacker attempting to gain access to the data at rest would need to obtain both the disks on the node, and network access to the Tang server as well.
					</p><p>
						The following figure illustrates the deployment model for NBDE.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/6730655fe574055b7907c92ba2b6dea4/179_OpenShift_NBDE_implementation_0821_1.png" alt="NBDE deployment model"/></div></div><p>
						The following figure illustrates NBDE behavior during a reboot.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/0c98a4380aa04f7838df462a51a2c266/179_OpenShift_NBDE_implementation_0821_2.png" alt="NBDE reboot behavior"/></div></div></section><section class="section" id="nbde-secret-sharing-encryption_nbde-implementation"><div class="titlepage"><div><div><h4 class="title">16.1.1.4. Secret sharing encryption</h4></div></div></div><p>
						Shamir’s secret sharing (sss) is a cryptographic algorithm to securely divide up, distribute, and re-assemble keys. Using this algorithm, OpenShift Container Platform can support more complicated mixtures of key protection.
					</p><p>
						When you configure a cluster node to use multiple Tang servers, OpenShift Container Platform uses sss to set up a decryption policy that will succeed if at least one of the specified servers is available. You can create layers for additional security. For example, you can define a policy where OpenShift Container Platform requires both the TPM and one of the given list of Tang servers to decrypt the disk.
					</p></section></section><section class="section" id="nbde-using-tang-servers-for-disk-encryption_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.1.2. Tang server disk encryption</h3></div></div></div><p>
					The following components and technologies implement Network-Bound Disk Encryption (NBDE).
				</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/ac88796341834a81c9a37f80ce6dd121/179_OpenShift_NBDE_implementation_0821_3.png" alt="Network-Bound Disk Encryption (NBDE)"/></div></div><p>
					<span class="emphasis"><em>Tang</em></span> is a server for binding data to network presence. It makes a node containing the data available when the node is bound to a certain secure network. Tang is stateless and does not require Transport Layer Security (TLS) or authentication. Unlike escrow-based solutions, where the key server stores all encryption keys and has knowledge of every encryption key, Tang never interacts with any node keys, so it never gains any identifying information from the node.
				</p><p>
					<span class="emphasis"><em>Clevis</em></span> is a pluggable framework for automated decryption that provides automated unlocking of Linux Unified Key Setup-on-disk-format (LUKS) volumes. The Clevis package runs on the node and provides the client side of the feature.
				</p><p>
					A <span class="emphasis"><em>Clevis pin</em></span> is a plugin into the Clevis framework. There are three pin types:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">TPM2</span></dt><dd>
								Binds the disk encryption to the TPM2.
							</dd><dt><span class="term">Tang</span></dt><dd>
								Binds the disk encryption to a Tang server to enable NBDE.
							</dd><dt><span class="term">Shamir’s secret sharing (sss)</span></dt><dd><p class="simpara">
								Allows more complex combinations of other pins. It allows more nuanced policies such as the following:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Must be able to reach one of these three Tang servers
									</li><li class="listitem">
										Must be able to reach three of these five Tang servers
									</li><li class="listitem">
										Must be able to reach the TPM2 AND at least one of these three Tang servers
									</li></ul></div></dd></dl></div></section><section class="section" id="nbde-locating-the-tang-servers_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.1.3. Tang server location planning</h3></div></div></div><p>
					When planning your Tang server environment, consider the physical and network locations of the Tang servers.
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Physical location</span></dt><dd><p class="simpara">
								The geographic location of the Tang servers is relatively unimportant, as long as they are suitably secured from unauthorized access or theft and offer the required availability and accessibility to run a critical service.
							</p><p class="simpara">
								Nodes with Clevis clients do not require local Tang servers as long as the Tang servers are available at all times. Disaster recovery requires both redundant power and redundant network connectivity to Tang servers regardless of their location.
							</p></dd><dt><span class="term">Network location</span></dt><dd><p class="simpara">
								Any node with network access to the Tang servers can decrypt their own disk partitions, or any other disks encrypted by the same Tang servers.
							</p><p class="simpara">
								Select network locations for the Tang servers that ensure the presence or absence of network connectivity from a given host allows for permission to decrypt. For example, firewall protections might be in place to prohibit access from any type of guest or public network, or any network jack located in an unsecured area of the building.
							</p><p class="simpara">
								Additionally, maintain network segregation between production and development networks. This assists in defining appropriate network locations and adds an additional layer of security.
							</p><p class="simpara">
								Do not deploy Tang servers on the same resource, for example, the same <code class="literal">rolebindings.rbac.authorization.k8s.io</code> cluster, that they are responsible for unlocking. However, a cluster of Tang servers and other security resources can be a useful configuration to enable support of multiple additional clusters and cluster resources.
							</p></dd></dl></div></section><section class="section" id="nbde-deciding-the-number-of-tang-servers-to-use_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.1.4. Tang server sizing requirements</h3></div></div></div><p>
					The requirements around availability, network, and physical location drive the decision of how many Tang servers to use, rather than any concern over server capacity.
				</p><p>
					Tang servers do not maintain the state of data encrypted using Tang resources. Tang servers are either fully independent or share only their key material, which enables them to scale well.
				</p><p>
					There are two ways Tang servers handle key material:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Multiple Tang servers share key material:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									You must load balance Tang servers sharing keys behind the same URL. The configuration can be as simple as round-robin DNS, or you can use physical load balancers.
								</li><li class="listitem">
									You can scale from a single Tang server to multiple Tang servers. Scaling Tang servers does not require rekeying or client reconfiguration on the node when the Tang servers share key material and the same URL.
								</li><li class="listitem">
									Client node setup and key rotation only requires one Tang server.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Multiple Tang servers generate their own key material:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									You can configure multiple Tang servers at installation time.
								</li><li class="listitem">
									You can scale an individual Tang server behind a load balancer.
								</li><li class="listitem">
									All Tang servers must be available during client node setup or key rotation.
								</li><li class="listitem">
									When a client node boots using the default configuration, the Clevis client contacts all Tang servers. Only <span class="emphasis"><em>n</em></span> Tang servers must be online to proceed with decryption. The default value for <span class="emphasis"><em>n</em></span> is 1.
								</li><li class="listitem">
									Red Hat does not support post-installation configuration that changes the behavior of the Tang servers.
								</li></ul></div></li></ul></div></section><section class="section" id="nbde-logging-considerations_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.1.5. Logging considerations</h3></div></div></div><p>
					Centralized logging of Tang traffic is advantageous because it might allow you to detect such things as unexpected decryption requests. For example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A node requesting decryption of a passphrase that does not correspond to its boot sequence
						</li><li class="listitem">
							A node requesting decryption outside of a known maintenance activity, such as cycling keys
						</li></ul></div></section></section><section class="section" id="nbde-tang-server-installation-considerations"><div class="titlepage"><div><div><h2 class="title">16.2. Tang server installation considerations</h2></div></div></div><section class="section" id="nbde-installation-scenarios_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.2.1. Installation scenarios</h3></div></div></div><p>
					Consider the following recommendations when planning Tang server installations:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Small environments can use a single set of key material, even when using multiple Tang servers:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Key rotations are easier.
								</li><li class="listitem">
									Tang servers can scale easily to permit high availability.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Large environments can benefit from multiple sets of key material:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Physically diverse installations do not require the copying and synchronizing of key material between geographic regions.
								</li><li class="listitem">
									Key rotations are more complex in large environments.
								</li><li class="listitem">
									Node installation and rekeying require network connectivity to all Tang servers.
								</li><li class="listitem">
									A small increase in network traffic can occur due to a booting node querying all Tang servers during decryption. Note that while only one Clevis client query must succeed, Clevis queries all Tang servers.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Further complexity:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Additional manual reconfiguration can permit the Shamir’s secret sharing (sss) of <code class="literal">any N of M servers online</code> in order to decrypt the disk partition. Decrypting disks in this scenario requires multiple sets of key material, and manual management of Tang servers and nodes with Clevis clients after the initial installation.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							High level recommendations:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									For a single RAN deployment, a limited set of Tang servers can run in the corresponding domain controller (DC).
								</li><li class="listitem">
									For multiple RAN deployments, you must decide whether to run Tang servers in each corresponding DC or whether a global Tang environment better suits the other needs and requirements of the system.
								</li></ul></div></li></ul></div></section><section class="section" id="nbde-installing-a-tang-server_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.2.2. Installing a Tang server</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							You can install a Tang server on a Red Hat Enterprise Linux (RHEL) machine using either of the following commands:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
									Install the Tang server by using the <code class="literal">yum</code> command:
								</p><pre class="programlisting language-terminal">$ sudo yum install tang</pre></li><li class="listitem"><p class="simpara">
									Install the Tang server by using the <code class="literal">dnf</code> command:
								</p><pre class="programlisting language-terminal">$ sudo dnf install tang</pre></li></ul></div></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Installation can also be containerized and is very lightweight.
					</p></div></div><section class="section" id="nbde-compute-requirements_nbde-implementation"><div class="titlepage"><div><div><h4 class="title">16.2.2.1. Compute requirements</h4></div></div></div><p>
						The computational requirements for the Tang server are very low. Any typical server grade configuration that you would use to deploy a server into production can provision sufficient compute capacity.
					</p><p>
						High availability considerations are solely for availability and not additional compute power to satisfy client demands.
					</p></section><section class="section" id="nbde-automatic-start-at-boot_nbde-implementation"><div class="titlepage"><div><div><h4 class="title">16.2.2.2. Automatic start at boot</h4></div></div></div><p>
						Due to the sensitive nature of the key material the Tang server uses, you should keep in mind that the overhead of manual intervention during the Tang server’s boot sequence can be beneficial.
					</p><p>
						By default, if a Tang server starts and does not have key material present in the expected local volume, it will create fresh material and serve it. You can avoid this default behavior by either starting with pre-existing key material or aborting the startup and waiting for manual intervention.
					</p></section><section class="section" id="nbde-http-versus-https_nbde-implementation"><div class="titlepage"><div><div><h4 class="title">16.2.2.3. HTTP versus HTTPS</h4></div></div></div><p>
						Traffic to the Tang server can be encrypted (HTTPS) or plaintext (HTTP). There are no significant security advantages of encrypting this traffic, and leaving it decrypted removes any complexity or failure conditions related to Transport Layer Security (TLS) certificate checking in the node running a Clevis client.
					</p><p>
						While it is possible to perform passive monitoring of unencrypted traffic between the node’s Clevis client and the Tang server, the ability to use this traffic to determine the key material is at best a future theoretical concern. Any such traffic analysis would require large quantities of captured data. Key rotation would immediately invalidate it. Finally, any threat actor able to perform passive monitoring has already obtained the necessary network access to perform manual connections to the Tang server and can perform the simpler manual decryption of captured Clevis headers.
					</p><p>
						However, because other network policies in place at the installation site might require traffic encryption regardless of application, consider leaving this decision to the cluster administrator.
					</p></section></section><section class="section" id="nbde-openshift-installation-with-nbde_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.2.3. Installation considerations with Network-Bound Disk Encryption</h3></div></div></div><p>
					Network-Bound Disk Encryption (NBDE) must be enabled when a cluster node is installed. However, you can change the disk encryption policy at any time after it was initialized at installation.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening/configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption_security-hardening">Configuring automated unlocking of encrypted volumes using policy-based decryption</a>
						</li><li class="listitem">
							<a class="link" href="https://catalog.redhat.com/software/containers/detail/5fbc405674aa0cc23b445f8f?container-tabs=overview&amp;gti-tabs=registry-tokens">Official Tang server container</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installation-special-config-storage_installing-customizing">Encrypting and mirroring disks during installation</a>
						</li></ul></div></section></section><section class="section" id="nbde-managing-encryption-keys"><div class="titlepage"><div><div><h2 class="title">16.3. Tang server encryption key management</h2></div></div></div><p>
				The cryptographic mechanism to recreate the encryption key is based on the <span class="emphasis"><em>blinded key</em></span> stored on the node and the private key of the involved Tang servers. To protect against the possibility of an attacker who has obtained both the Tang server private key and the node’s encrypted disk, periodic rekeying is advisable.
			</p><p>
				You must perform the rekeying operation for every node before you can delete the old key from the Tang server. The following sections provide procedures for rekeying and deleting old keys.
			</p><section class="section" id="nbde-backing-up-server-keys_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.3.1. Backing up keys for a Tang server</h3></div></div></div><p>
					The Tang server uses <code class="literal">/usr/libexec/tangd-keygen</code> to generate new keys and stores them in the <code class="literal">/var/db/tang</code> directory by default. To recover the Tang server in the event of a failure, back up this directory. The keys are sensitive and because they are able to perform the boot disk decryption of all hosts that have used them, the keys must be protected accordingly.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Copy the backup key from the <code class="literal">/var/db/tang</code> directory to the temp directory from which you can restore the key.
						</li></ul></div></section><section class="section" id="nbde-recovering-server-keys_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.3.2. Recovering keys for a Tang server</h3></div></div></div><p>
					You can recover the keys for a Tang server by accessing the keys from a backup.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Restore the key from your backup folder to the <code class="literal">/var/db/tang/</code> directory.
						</p><p class="simpara">
							When the Tang server starts up, it advertises and uses these restored keys.
						</p></li></ul></div></section><section class="section" id="nbde-rekeying-tang-servers_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.3.3. Rekeying Tang servers</h3></div></div></div><p>
					This procedure uses a set of three Tang servers, each with unique keys, as an example.
				</p><p>
					Using redundant Tang servers reduces the chances of nodes failing to boot automatically.
				</p><p>
					Rekeying a Tang server, and all associated NBDE-encrypted nodes, is a three-step procedure.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							A working Network-Bound Disk Encryption (NBDE) installation on one or more nodes.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Generate a new Tang server key.
						</li><li class="listitem">
							Rekey all NBDE-encrypted nodes so they use the new key.
						</li><li class="listitem"><p class="simpara">
							Delete the old Tang server key.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Deleting the old key before all NBDE-encrypted nodes have completed their rekeying causes those nodes to become overly dependent on any other configured Tang servers.
							</p></div></div></li></ol></div><div class="figure" id="idm139961119317104"><p class="title"><strong>Figure 16.1. Example workflow for rekeying a Tang server</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Security_and_compliance-en-US/images/7ca99379d14d14d75c8d2f49f6cf0d5c/179_OpenShift_NBDE_implementation_0821_4.png" alt="Rekeying a Tang server"/></div></div></div><section class="section" id="nbde-generating-a-new-tang-server-key_nbde-implementation"><div class="titlepage"><div><div><h4 class="title">16.3.3.1. Generating a new Tang server key</h4></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								A root shell on the Linux machine running the Tang server.
							</li><li class="listitem"><p class="simpara">
								To facilitate verification of the Tang server key rotation, encrypt a small test file with the old key:
							</p><pre class="programlisting language-terminal"># echo plaintext | clevis encrypt tang '{"url":"http://localhost:7500”}' -y &gt;/tmp/encrypted.oldkey</pre></li><li class="listitem"><p class="simpara">
								Verify that the encryption succeeded and the file can be decrypted to produce the same string <code class="literal">plaintext</code>:
							</p><pre class="programlisting language-terminal"># clevis decrypt &lt;/tmp/encrypted.oldkey</pre></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Locate and access the directory that stores the Tang server key. This is usually the <code class="literal">/var/db/tang</code> directory. Check the currently advertised key thumbprint:
							</p><pre class="programlisting language-terminal"># tang-show-keys 7500</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">36AHjNH3NZDSnlONLz1-V4ie6t8</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Enter the Tang server key directory:
							</p><pre class="programlisting language-terminal"># cd /var/db/tang/</pre></li><li class="listitem"><p class="simpara">
								List the current Tang server keys:
							</p><pre class="programlisting language-terminal"># ls -A1</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">36AHjNH3NZDSnlONLz1-V4ie6t8.jwk
gJZiNPMLRBnyo_ZKfK4_5SrnHYo.jwk</pre>

								</p></div><p class="simpara">
								During normal Tang server operations, there are two <code class="literal">.jwk</code> files in this directory: one for signing and verification, and another for key derivation.
							</p></li><li class="listitem"><p class="simpara">
								Disable advertisement of the old keys:
							</p><pre class="programlisting language-terminal"># for key in *.jwk; do \
  mv -- "$key" ".$key"; \
done</pre><p class="simpara">
								New clients setting up Network-Bound Disk Encryption (NBDE) or requesting keys will no longer see the old keys. Existing clients can still access and use the old keys until they are deleted. The Tang server reads but does not advertise keys stored in UNIX hidden files, which start with the <code class="literal">.</code> character.
							</p></li><li class="listitem"><p class="simpara">
								Generate a new key:
							</p><pre class="programlisting language-terminal"># /usr/libexec/tangd-keygen /var/db/tang</pre></li><li class="listitem"><p class="simpara">
								List the current Tang server keys to verify the old keys are no longer advertised, as they are now hidden files, and new keys are present:
							</p><pre class="programlisting language-terminal"># ls -A1</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">.36AHjNH3NZDSnlONLz1-V4ie6t8.jwk
.gJZiNPMLRBnyo_ZKfK4_5SrnHYo.jwk
Bp8XjITceWSN_7XFfW7WfJDTomE.jwk
WOjQYkyK7DxY_T5pMncMO5w0f6E.jwk</pre>

								</p></div><p class="simpara">
								Tang automatically advertises the new keys.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									More recent Tang server installations include a helper <code class="literal">/usr/libexec/tangd-rotate-keys</code> directory that takes care of disabling advertisement and generating the new keys simultaneously.
								</p></div></div></li><li class="listitem">
								If you are running multiple Tang servers behind a load balancer that share the same key material, ensure the changes made here are properly synchronized across the entire set of servers before proceeding.
							</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Verify that the Tang server is advertising the new key, and not advertising the old key:
							</p><pre class="programlisting language-terminal"># tang-show-keys 7500</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">WOjQYkyK7DxY_T5pMncMO5w0f6E</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Verify that the old key, while not advertised, is still available to decryption requests:
							</p><pre class="programlisting language-terminal"># clevis decrypt &lt;/tmp/encrypted.oldkey</pre></li></ol></div></section><section class="section" id="nbde-rekeying-all-nbde-nodes_nbde-implementation"><div class="titlepage"><div><div><h4 class="title">16.3.3.2. Rekeying all NBDE nodes</h4></div></div></div><p>
						You can rekey all of the nodes on a remote cluster by using a <code class="literal">DaemonSet</code> object without incurring any downtime to the remote cluster.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If a node loses power during the rekeying, it is possible that it might become unbootable, and must be redeployed via Red Hat Advanced Cluster Management (RHACM) or a GitOps pipeline.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">cluster-admin</code> access to all clusters with Network-Bound Disk Encryption (NBDE) nodes.
							</li><li class="listitem">
								All Tang servers must be accessible to every NBDE node undergoing rekeying, even if the keys of a Tang server have not changed.
							</li><li class="listitem">
								Obtain the Tang server URL and key thumbprint for every Tang server.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a <code class="literal">DaemonSet</code> object based on the following template. This template sets up three redundant Tang servers, but can be easily adapted to other situations. Change the Tang server URLs and thumbprints in the <code class="literal">NEW_TANG_PIN</code> environment to suit your environment:
							</p><pre class="programlisting language-yaml">apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: tang-rekey
  namespace: openshift-machine-config-operator
spec:
  selector:
    matchLabels:
      name: tang-rekey
  template:
    metadata:
      labels:
        name: tang-rekey
    spec:
      containers:
      - name: tang-rekey
        image: registry.access.redhat.com/ubi9/ubi-minimal:latest
        imagePullPolicy: IfNotPresent
        command:
        - "/sbin/chroot"
        - "/host"
        - "/bin/bash"
        - "-ec"
        args:
        - |
          rm -f /tmp/rekey-complete || true
          echo "Current tang pin:"
          clevis-luks-list -d $ROOT_DEV -s 1
          echo "Applying new tang pin: $NEW_TANG_PIN"
          clevis-luks-edit -f -d $ROOT_DEV -s 1 -c "$NEW_TANG_PIN"
          echo "Pin applied successfully"
          touch /tmp/rekey-complete
          sleep infinity
        readinessProbe:
          exec:
            command:
            - cat
            - /host/tmp/rekey-complete
          initialDelaySeconds: 30
          periodSeconds: 10
        env:
        - name: ROOT_DEV
          value: /dev/disk/by-partlabel/root
        - name: NEW_TANG_PIN
          value: &gt;-
            {"t":1,"pins":{"tang":[
              {"url":"http://tangserver01:7500","thp":"WOjQYkyK7DxY_T5pMncMO5w0f6E"},
              {"url":"http://tangserver02:7500","thp":"I5Ynh2JefoAO3tNH9TgI4obIaXI"},
              {"url":"http://tangserver03:7500","thp":"38qWZVeDKzCPG9pHLqKzs6k1ons"}
            ]}}
        volumeMounts:
        - name: hostroot
          mountPath: /host
        securityContext:
          privileged: true
      volumes:
      - name: hostroot
        hostPath:
          path: /
      nodeSelector:
        kubernetes.io/os: linux
      priorityClassName: system-node-critical
      restartPolicy: Always
      serviceAccount: machine-config-daemon
      serviceAccountName: machine-config-daemon</pre><p class="simpara">
								In this case, even though you are rekeying <code class="literal">tangserver01</code>, you must specify not only the new thumbprint for <code class="literal">tangserver01</code>, but also the current thumbprints for all other Tang servers. Failure to specify all thumbprints for a rekeying operation opens up the opportunity for a man-in-the-middle attack.
							</p></li><li class="listitem"><p class="simpara">
								To distribute the daemon set to every cluster that must be rekeyed, run the following command:
							</p><pre class="programlisting language-terminal">$ oc apply -f tang-rekey.yaml</pre><p class="simpara">
								However, to run at scale, wrap the daemon set in an ACM policy. This ACM configuration must contain one policy to deploy the daemon set, a second policy to check that all the daemon set pods are READY, and a placement rule to apply it to the appropriate set of clusters.
							</p></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							After validating that the daemon set has successfully rekeyed all servers, delete the daemon set. If you do not delete the daemon set, it must be deleted before the next rekeying operation.
						</p></div></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
							After you distribute the daemon set, monitor the daemon sets to ensure that the rekeying has completed successfully. The script in the example daemon set terminates with an error if the rekeying failed, and remains in the <code class="literal">CURRENT</code> state if successful. There is also a readiness probe that marks the pod as <code class="literal">READY</code> when the rekeying has completed successfully.
						</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								This is an example of the output listing for the daemon set before the rekeying has completed:
							</p><pre class="programlisting language-terminal">$ oc get -n openshift-machine-config-operator ds tang-rekey</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME         DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR            AGE
tang-rekey   1         1         0       1            0           kubernetes.io/os=linux   11s</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								This is an example of the output listing for the daemon set after the rekeying has completed successfully:
							</p><pre class="programlisting language-terminal">$ oc get -n openshift-machine-config-operator ds tang-rekey</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME         DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR            AGE
tang-rekey   1         1         1       1            1           kubernetes.io/os=linux   13h</pre>

								</p></div></li></ul></div><p>
						Rekeying usually takes a few minutes to complete.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If you use ACM policies to distribute the daemon sets to multiple clusters, you must include a compliance policy that checks every daemon set’s READY count is equal to the DESIRED count. In this way, compliance to such a policy demonstrates that all daemon set pods are READY and the rekeying has completed successfully. You could also use an ACM search to query all of the daemon sets' states.
						</p></div></div></section><section class="section" id="nbde-troubleshooting-temporary-error-conditions_nbde-implementation"><div class="titlepage"><div><div><h4 class="title">16.3.3.3. Troubleshooting temporary rekeying errors for Tang servers</h4></div></div></div><p>
						To determine if the error condition from rekeying the Tang servers is temporary, perform the following procedure. Temporary error conditions might include:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Temporary network outages
							</li><li class="listitem">
								Tang server maintenance
							</li></ul></div><p>
						Generally, when these types of temporary error conditions occur, you can wait until the daemon set succeeds in resolving the error or you can delete the daemon set and not try again until the temporary error condition has been resolved.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Restart the pod that performs the rekeying operation using the normal Kubernetes pod restart policy.
							</li><li class="listitem">
								If any of the associated Tang servers are unavailable, try rekeying until all the servers are back online.
							</li></ol></div></section><section class="section" id="nbde-troubleshooting-permanent-error-conditions_nbde-implementation"><div class="titlepage"><div><div><h4 class="title">16.3.3.4. Troubleshooting permanent rekeying errors for Tang servers</h4></div></div></div><p>
						If, after rekeying the Tang servers, the <code class="literal">READY</code> count does not equal the <code class="literal">DESIRED</code> count after an extended period of time, it might indicate a permanent failure condition. In this case, the following conditions might apply:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A typographical error in the Tang server URL or thumbprint in the <code class="literal">NEW_TANG_PIN</code> definition.
							</li><li class="listitem">
								The Tang server is decommissioned or the keys are permanently lost.
							</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The commands shown in this procedure can be run on the Tang server or on any Linux system that has network access to the Tang server.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Validate the Tang server configuration by performing a simple encrypt and decrypt operation on each Tang server’s configuration as defined in the daemon set.
							</p><p class="simpara">
								This is an example of an encryption and decryption attempt with a bad thumbprint:
							</p><pre class="programlisting language-terminal">$ echo "okay" | clevis encrypt tang \
  '{"url":"http://tangserver02:7500","thp":"badthumbprint"}' | \
  clevis decrypt</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">Unable to fetch advertisement: 'http://tangserver02:7500/adv/badthumbprint'!</pre>

								</p></div><p class="simpara">
								This is an example of an encryption and decryption attempt with a good thumbprint:
							</p><pre class="programlisting language-terminal">$ echo "okay" | clevis encrypt tang \
  '{"url":"http://tangserver03:7500","thp":"goodthumbprint"}' | \
  clevis decrypt</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">okay</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								After you identify the root cause, remedy the underlying situation:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Delete the non-working daemon set.
									</li><li class="listitem"><p class="simpara">
										Edit the daemon set definition to fix the underlying issue. This might include any of the following actions:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												Edit a Tang server entry to correct the URL and thumbprint.
											</li><li class="listitem">
												Remove a Tang server that is no longer in service.
											</li><li class="listitem">
												Add a new Tang server that is a replacement for a decommissioned server.
											</li></ul></div></li></ol></div></li><li class="listitem">
								Distribute the updated daemon set again.
							</li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When replacing, removing, or adding a Tang server from a configuration, the rekeying operation will succeed as long as at least one original server is still functional, including the server currently being rekeyed. If none of the original Tang servers are functional or can be recovered, recovery of the system is impossible and you must redeploy the affected nodes.
						</p></div></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
							Check the logs from each pod in the daemon set to determine whether the rekeying completed successfully. If the rekeying is not successful, the logs might indicate the failure condition.
						</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Locate the name of the container that was created by the daemon set:
							</p><pre class="programlisting language-terminal">$ oc get pods -A | grep tang-rekey</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">openshift-machine-config-operator  tang-rekey-7ks6h  1/1  Running   20 (8m39s ago)  89m</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Print the logs from the container. The following log is from a completed successful rekeying operation:
							</p><pre class="programlisting language-terminal">$ oc logs tang-rekey-7ks6h</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">Current tang pin:
1: sss '{"t":1,"pins":{"tang":[{"url":"http://10.46.55.192:7500"},{"url":"http://10.46.55.192:7501"},{"url":"http://10.46.55.192:7502"}]}}'
Applying new tang pin: {"t":1,"pins":{"tang":[
  {"url":"http://tangserver01:7500","thp":"WOjQYkyK7DxY_T5pMncMO5w0f6E"},
  {"url":"http://tangserver02:7500","thp":"I5Ynh2JefoAO3tNH9TgI4obIaXI"},
  {"url":"http://tangserver03:7500","thp":"38qWZVeDKzCPG9pHLqKzs6k1ons"}
]}}
Updating binding...
Binding edited successfully
Pin applied successfully</pre>

								</p></div></li></ol></div></section></section><section class="section" id="nbde-deleting-old-tang-server-keys_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.3.4. Deleting old Tang server keys</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							A root shell on the Linux machine running the Tang server.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Locate and access the directory where the Tang server key is stored. This is usually the <code class="literal">/var/db/tang</code> directory:
						</p><pre class="programlisting language-terminal"># cd /var/db/tang/</pre></li><li class="listitem"><p class="simpara">
							List the current Tang server keys, showing the advertised and unadvertised keys:
						</p><pre class="programlisting language-terminal"># ls -A1</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">.36AHjNH3NZDSnlONLz1-V4ie6t8.jwk
.gJZiNPMLRBnyo_ZKfK4_5SrnHYo.jwk
Bp8XjITceWSN_7XFfW7WfJDTomE.jwk
WOjQYkyK7DxY_T5pMncMO5w0f6E.jwk</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Delete the old keys:
						</p><pre class="programlisting language-terminal"># rm .*.jwk</pre></li><li class="listitem"><p class="simpara">
							List the current Tang server keys to verify the unadvertised keys are no longer present:
						</p><pre class="programlisting language-terminal"># ls -A1</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Bp8XjITceWSN_7XFfW7WfJDTomE.jwk
WOjQYkyK7DxY_T5pMncMO5w0f6E.jwk</pre>

							</p></div></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
						At this point, the server still advertises the new keys, but an attempt to decrypt based on the old key will fail.
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Query the Tang server for the current advertised key thumbprints:
						</p><pre class="programlisting language-terminal"># tang-show-keys 7500</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">WOjQYkyK7DxY_T5pMncMO5w0f6E</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Decrypt the test file created earlier to verify decryption against the old keys fails:
						</p><pre class="programlisting language-terminal"># clevis decrypt &lt;/tmp/encryptValidation</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Error communicating with the server!</pre>

							</p></div></li></ol></div><p>
					If you are running multiple Tang servers behind a load balancer that share the same key material, ensure the changes made are properly synchronized across the entire set of servers before proceeding.
				</p></section></section><section class="section" id="nbde-disaster-recovery-considerations"><div class="titlepage"><div><div><h2 class="title">16.4. Disaster recovery considerations</h2></div></div></div><p>
				This section describes several potential disaster situations and the procedures to respond to each of them. Additional situations will be added here as they are discovered or presumed likely to be possible.
			</p><section class="section" id="nbde-loss-of-a-client-machine_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.4.1. Loss of a client machine</h3></div></div></div><p>
					The loss of a cluster node that uses the Tang server to decrypt its disk partition is <span class="emphasis"><em>not</em></span> a disaster. Whether the machine was stolen, suffered hardware failure, or another loss scenario is not important: the disks are encrypted and considered unrecoverable.
				</p><p>
					However, in the event of theft, a precautionary rotation of the Tang server’s keys and rekeying of all remaining nodes would be prudent to ensure the disks remain unrecoverable even in the event the thieves subsequently gain access to the Tang servers.
				</p><p>
					To recover from this situation, either reinstall or replace the node.
				</p></section><section class="section" id="nbde-loss-of-client-connectivity_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.4.2. Planning for a loss of client network connectivity</h3></div></div></div><p>
					The loss of network connectivity to an individual node will cause it to become unable to boot in an unattended fashion.
				</p><p>
					If you are planning work that might cause a loss of network connectivity, you can reveal the passphrase for an onsite technician to use manually, and then rotate the keys afterwards to invalidate it:
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Before the network becomes unavailable, show the password used in the first slot <code class="literal">-s 1</code> of device <code class="literal">/dev/vda2</code> with this command:
						</p><pre class="programlisting language-terminal">$ sudo clevis luks pass -d /dev/vda2 -s 1</pre></li><li class="listitem"><p class="simpara">
							Invalidate that value and regenerate a new random boot-time passphrase with this command:
						</p><pre class="programlisting language-terminal">$ sudo clevis luks regen -d /dev/vda2 -s 1</pre></li></ol></div></section><section class="section" id="nbde-unexpected-loss-of-network-connectivity_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.4.3. Unexpected loss of network connectivity</h3></div></div></div><p>
					If the network disruption is unexpected and a node reboots, consider the following scenarios:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If any nodes are still online, ensure that they do not reboot until network connectivity is restored. This is not applicable for single-node clusters.
						</li><li class="listitem">
							The node will remain offline until such time that either network connectivity is restored, or a pre-established passphrase is entered manually at the console. In exceptional circumstances, network administrators might be able to reconfigure network segments to reestablish access, but this is counter to the intent of NBDE, which is that lack of network access means lack of ability to boot.
						</li><li class="listitem">
							The lack of network access at the node can reasonably be expected to impact that node’s ability to function as well as its ability to boot. Even if the node were to boot via manual intervention, the lack of network access would make it effectively useless.
						</li></ul></div></section><section class="section" id="nbde-recovering-network-connectivity-manually_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.4.4. Recovering network connectivity manually</h3></div></div></div><p>
					A somewhat complex and manually intensive process is also available to the onsite technician for network recovery.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							The onsite technician extracts the Clevis header from the hard disks. Depending on BIOS lockdown, this might involve removing the disks and installing them in a lab machine.
						</li><li class="listitem">
							The onsite technician transmits the Clevis headers to a colleague with legitimate access to the Tang network who then performs the decryption.
						</li><li class="listitem">
							Due to the necessity of limited access to the Tang network, the technician should not be able to access that network via VPN or other remote connectivity. Similarly, the technician cannot patch the remote server through to this network in order to decrypt the disks automatically.
						</li><li class="listitem">
							The technician reinstalls the disk and manually enters the plain text passphrase provided by their colleague.
						</li><li class="listitem">
							The machine successfully starts even without direct access to the Tang servers. Note that the transmission of the key material from the install site to another site with network access must be done carefully.
						</li><li class="listitem">
							When network connectivity is restored, the technician rotates the encryption keys.
						</li></ol></div></section><section class="section" id="nbde-emergency-recovery-of-network-connectivity_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.4.5. Emergency recovery of network connectivity</h3></div></div></div><p>
					If you are unable to recover network connectivity manually, consider the following steps. Be aware that these steps are discouraged if other methods to recover network connectivity are available.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							This method must only be performed by a highly trusted technician.
						</li><li class="listitem">
							Taking the Tang server’s key material to the remote site is considered to be a breach of the key material and all servers must be rekeyed and re-encrypted.
						</li><li class="listitem">
							This method must be used in extreme cases only, or as a proof of concept recovery method to demonstrate its viability.
						</li><li class="listitem">
							Equally extreme, but theoretically possible, is to power the server in question with an Uninterruptible Power Supply (UPS), transport the server to a location with network connectivity to boot and decrypt the disks, and then restore the server at the original location on battery power to continue operation.
						</li><li class="listitem">
							If you want to use a backup manual passphrase, you must create it before the failure situation occurs.
						</li><li class="listitem">
							Just as attack scenarios become more complex with TPM and Tang compared to a stand-alone Tang installation, so emergency disaster recovery processes are also made more complex if leveraging the same method.
						</li></ul></div></section><section class="section" id="nbde-loss-of-a-network-segment_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.4.6. Loss of a network segment</h3></div></div></div><p>
					The loss of a network segment, making a Tang server temporarily unavailable, has the following consequences:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							OpenShift Container Platform nodes continue to boot as normal, provided other servers are available.
						</li><li class="listitem">
							New nodes cannot establish their encryption keys until the network segment is restored. In this case, ensure connectivity to remote geographic locations for the purposes of high availability and redundancy. This is because when you are installing a new node or rekeying an existing node, all of the Tang servers you are referencing in that operation must be available.
						</li></ul></div><p>
					A hybrid model for a vastly diverse network, such as five geographic regions in which each client is connected to the closest three clients is worth investigating.
				</p><p>
					In this scenario, new clients are able to establish their encryption keys with the subset of servers that are reachable. For example, in the set of <code class="literal">tang1</code>, <code class="literal">tang2</code> and <code class="literal">tang3</code> servers, if <code class="literal">tang2</code> becomes unreachable clients can still establish their encryption keys with <code class="literal">tang1</code> and <code class="literal">tang3</code>, and at a later time re-establish with the full set. This can involve either a manual intervention or a more complex automation to be available.
				</p></section><section class="section" id="nbde-loss-of-a-tang-server_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.4.7. Loss of a Tang server</h3></div></div></div><p>
					The loss of an individual Tang server within a load balanced set of servers with identical key material is completely transparent to the clients.
				</p><p>
					The temporary failure of all Tang servers associated with the same URL, that is, the entire load balanced set, can be considered the same as the loss of a network segment. Existing clients have the ability to decrypt their disk partitions so long as another preconfigured Tang server is available. New clients cannot enroll until at least one of these servers comes back online.
				</p><p>
					You can mitigate the physical loss of a Tang server by either reinstalling the server or restoring the server from backups. Ensure that the backup and restore processes of the key material is adequately protected from unauthorized access.
				</p></section><section class="section" id="nbde-compromise-of-key-material_nbde-implementation"><div class="titlepage"><div><div><h3 class="title">16.4.8. Rekeying compromised key material</h3></div></div></div><p>
					If key material is potentially exposed to unauthorized third parties, such as through the physical theft of a Tang server or associated data, immediately rotate the keys.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Rekey any Tang server holding the affected material.
						</li><li class="listitem">
							Rekey all clients using the Tang server.
						</li><li class="listitem">
							Destroy the original key material.
						</li><li class="listitem">
							Scrutinize any incidents that result in unintended exposure of the master encryption key. If possible, take compromised nodes offline and re-encrypt their disks.
						</li></ol></div><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
					Reformatting and reinstalling on the same physical hardware, although slow, is easy to automate and test.
				</p></div></div></section></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm139961123667648"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2023 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div>


  <nav class="pvof-doc__book-nav">
  <ol class="book-nav__list">
              </ol>
</nav>


          </div>
              </div>
              <div id="comments-footer" class="book-comments">
          

  

        </div>
          </div>
  </article>
<meta itemscope="" itemref="md1">



    </div>
      <!-- CP_PRIMER_FOOTER -->            </div>
        </main>
    </div>
    <!--googleoff: all-->
    <div id="to-top"><a class="btn_slideto" href="#masthead" aria-label="Back to Top"><span class="web-icon-upload"></span></a></div>
    <footer class="footer-main">
        <div class="footer-top">
            <div class="container">

              <div class="brand">
                <a href="https://redhat.com">
                  <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                    <defs>
                      <style>
                        .rh-logo-hat {
                          fill: #e00;
                        }
                        .rh-logo-type {
                          fill: #fff;
                        }
                      </style>
                    </defs>
                    <title>Red Hat</title>
                    <path
                      class="rh-logo-hat"
                      d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
                      <path class="rh-logo-band"
                      d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
                      <path
                      class="rh-logo-type"
                      d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
                  </svg>
                </a>
              </div>

              <div role="navigation" aria-label="quick">
                  <h3>Quick Links</h3>
                  <ul>
                      <li><a class="download-software" href="https://access.redhat.com/downloads/">Downloads</a></li>
                      <li><a class="manage-subscriptions" href="https://access.redhat.com/management">Subscriptions</a></li>
                      <li><a class="support-cases" href="https://access.redhat.com/support">Support Cases</a></li>
                      <li><a class="customer-service" href="https://access.redhat.com/support/customer-service">Customer Service</a></li>
                      <li><a class="quick-docs" href="https://access.redhat.com/documentation">Product Documentation</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="help">
                  <h3>Help</h3>
                  <ul>
                      <li><a class="contact-us" href="https://access.redhat.com/support/contact/">Contact Us</a></li>
                      <li><a class="cp-faqs" href="https://access.redhat.com/articles/33844">Customer Portal FAQ</a></li>
                      <li><a class="login-problems" href="https://access.redhat.com/help/login_assistance">Log-in Assistance</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="site">
                  <h3>Site Info</h3>
                  <ul>
                      <li><a class="trust-red-hat" href="https://www.redhat.com/en/trust">Trust Red Hat</a></li>
                      <li><a class="browser-support-policy" href="https://www.redhat.com/en/about/browser-support">Browser Support Policy</a></li>
                      <li><a class="accessibility" href="https://www.redhat.com/en/about/digital-accessibility">Accessibility</a></li>
                      <li><a class="recognition" href="https://access.redhat.com/recognition/">Awards and Recognition</a></li>
                      <li><a class="colophon" href="https://access.redhat.com/help/colophon/">Colophon</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="other">
                  <h3>Related Sites</h3>
                  <ul>
                      <li><a href="https://www.redhat.com/" class="red-hat-com">redhat.com</a></li>
                      <li><a href="http://developers.redhat.com/" class="red-hat-developers">developers.redhat.com</a></li>
                      <li><a href="https://connect.redhat.com/" class="partner-connect">connect.redhat.com</a></li>
                      <li><a href="https://cloud.redhat.com/" class="cloud-com">cloud.redhat.com</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="about">
                  <h3>About</h3>
                  <ul>
                      <li><a href="https://access.redhat.com/subscription-value" class="subscription-value">Red Hat Subscription Value</a></li>
                      <li><a href="https://www.redhat.com/about/" class="about-red-hat">About Red Hat</a></li>
                      <li><a href="http://jobs.redhat.com" class="about-jobs">Red Hat Jobs</a></li>
                  </ul>
              </div>

            </div>
        </div>

        <div class="anchor">
            <div class="container">
                <div class="status-legal">
                    <a hidden href="https://status.redhat.com" class="status-page-widget">
                        <span class="status-description"></span>
                        <span class="status-dot shape-circle"></span>
                    </a>
                    <div class="legal-copyright">
                        <div class="copyright">Copyright © 2023 Red Hat, Inc.</div>
                        <div role="navigation" aria-label="legal" class="legal">
                            <ul>
                                <li><a href="http://www.redhat.com/en/about/privacy-policy" class="privacy-policy">Privacy Statement</a></li>
                                <li><a href="https://www.redhat.com/en/about/terms-use" class="terms-of-use">Terms of Use</a></li>
                                <li><a href="http://www.redhat.com/en/about/all-policies-guidelines" class="all-policies">All Policies and Guidelines</a></li>
                                <li><a id="teconsent"></a></li>
                            </ul>
                            <div id="privacy_policy">We've updated our <a href='http://www.redhat.com/en/about/privacy-policy' class='privacy-policy'>Privacy Statement</a> effective September 15, 2023.
                            </div>
                          </div>
                        </div>
                </div>
                <div class="social">
                    <a href="http://www.redhat.com/summit/" class="summit">
                        <img src="https://access.redhat.com/chrome_themes/nimbus/img/rh-summit-red-a.svg" alt="Red Hat Summit" /> <span class="offscreen">Red Hat Summit</span>
                    </a>

                    <div class="social-media">
                        <a href="https://twitter.com/RedHat" class="sm-icon twitter"><span class="nicon-twitter"></span><span class="offscreen">Twitter</span></a>                        
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- TrustArc -->
    <div id="consent_blackbar"></div> 
    <!--googleon: all-->
</div>
<!-- /CP_PRIMER_FOOTER -->


  </div>

    
  </body>
</html>
