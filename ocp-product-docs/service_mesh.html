<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="og: https://ogp.me/ns#">
  <head>
    <meta charset="utf-8" />
<link rel="canonical" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/index" />
<link rel="shortlink" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/index" />
<meta property="og:site_name" content="Red Hat Customer Portal" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/index" />
<meta property="og:title" content="Service Mesh OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<meta property="og:description" content="This document provides information on how to use Service Mesh in OpenShift Container Platform." />
<meta property="og:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="This document provides information on how to use Service Mesh in OpenShift Container Platform." />
<meta name="twitter:title" content="Service Mesh OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<meta name="twitter:url" content="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/index" />
<meta name="twitter:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="title" content="Service Mesh OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<link rel="alternate" hreflang="en" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/index" />
<link rel="alternate" hreflang="ko" href="https://access.redhat.com/documentation/ko-kr/openshift_container_platform/4.13/html-single/service_mesh/index" />
<link rel="alternate" hreflang="zh-hans" href="https://access.redhat.com/documentation/zh-cn/openshift_container_platform/4.13/html-single/service_mesh/index" />
<link rel="alternate" hreflang="ja" href="https://access.redhat.com/documentation/ja-jp/openshift_container_platform/4.13/html-single/service_mesh/index" />
<link rel="alternate" hreflang="es" href="https://access.redhat.com/documentation/es-es/openshift_container_platform/4.13/html-single/service_mesh/index" />
<link rel="alternate" hreflang="ru" href="https://access.redhat.com/documentation/ru-ru/openshift_container_platform/4.13/html-single/service_mesh/index" />
<link rel="alternate" hreflang="pt-br" href="https://access.redhat.com/documentation/pt-br/openshift_container_platform/4.13/html-single/service_mesh/index" />
<link rel="alternate" hreflang="it" href="https://access.redhat.com/documentation/it-it/openshift_container_platform/4.13/html-single/service_mesh/index" />
<link rel="alternate" hreflang="de" href="https://access.redhat.com/documentation/de-de/openshift_container_platform/4.13/html-single/service_mesh/index" />
<link rel="alternate" hreflang="fr" href="https://access.redhat.com/documentation/fr-fr/openshift_container_platform/4.13/html-single/service_mesh/index" />
<link rel="alternate" hreflang="zh-hant" href="https://access.redhat.com/documentation/zh-tw/openshift_container_platform/4.13/html-single/service_mesh/index" />
<link rel="alternate" hreflang="id" href="https://access.redhat.com/documentation/id-id/openshift_container_platform/4.13/html-single/service_mesh/index" />
<link rel="alternate" hreflang="th" href="https://access.redhat.com/documentation/th-th/openshift_container_platform/4.13/html-single/service_mesh/index" />
<link rel="alternate" hreflang="vi" href="https://access.redhat.com/documentation/vi-vn/openshift_container_platform/4.13/html-single/service_mesh/index" />
<meta name="Generator" content="Drupal 9 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="revision" product="b0738f19-59ac-47eb-9512-8a439cd6dfb0" title="8d992678-85f6-43d3-8d59-1edb6c0784f4" page="4a52dca8-0ed4-466c-8660-0cef7eba625b" revision="dccd48b1f252cc22dad43e9ae6252b9287d98ca1:en-us" body="bebab3a68539366a39b4d1a241f4183c.html" toc="c48bb856404dc044cdfcedc1ec3a864d.json" />

    <title>Service Mesh OpenShift Container Platform 4.13 | Red Hat Customer Portal</title>
    <link rel="stylesheet" media="all" href="/sites/dxp-docs/files/css/css_87GMcmxT1ib8ziQiU2KUAnTDFtZQV6iP-KGslA9LigM.css" />
<link rel="stylesheet" media="all" href="/sites/dxp-docs/files/css/css__Xq4GfgPDJw9K_yYJFmlRZGJeCENu3R3r4s0K7Tr_9g.css" />

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"documentation\/en-us\/openshift_container_platform\/4.13\/html-single\/service_mesh\/index","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"red_hat_jwt":{"client_id":"customer-portal","cookie_name":"rh_jwt","leeway":"0","realm":"redhat-external","sso_host":"https:\/\/sso.redhat.com\/","user_integration":1,"user_plugin":"drupal_user_auth","use_external_js":0,"use_internal_js":0,"use_in_admin":0},"user":{"uid":0,"permissionsHash":"d8ea0bce2d740dacbdfe0257cf55baa0e33f7fb8468a26d055ce75daaaa2d315"}}</script>
<script src="/sites/dxp-docs/files/js/js_EQWKo9EokWkWS99x_e1oM-NEM0zlKyTkp_83mGdm5Ks.js"></script>

    <!-- CP_PRIMER_HEAD -->  <!-- TrustArc & DTM -->
  <script src="//static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>
  <script src="//www.redhat.com/dtm.js"></script><meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<!--[if IEMobile]><meta http-equiv="cleartype" content="on"><![endif]-->

<!-- metaInclude -->
<meta name="avalon-host-info" content="dxp-kbase-prod-139-77b4fb8768-25dr9" />
<meta name="avalon-version" content="27861f77" />
<meta name="cp-chrome-build-date" content="2023-10-06T19:17:59.039Z" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#000000">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#000000">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-status-bar-style" content="#000000">
<link rel="manifest" href="https://access.redhat.com/webassets/avalon/j/manifest.json">
<!-- Open Search - Tap to search -->
<link rel="search" type="application/opensearchdescription+xml" title="Red Hat Customer Portal" href="https://access.redhat.com/webassets/avalon/j/opensearch.xml" />
<!-- title -->
<title>Red Hat Customer Portal - Access to 24x7 support and knowledge</title>
<!-- /title -->
<script type="text/javascript">
    window.portal = {
        analytics : {},
        host      : "https://access.redhat.com",
        idp_url   : "https://sso.redhat.com",
        lang      : "en", 
        version   : "27861f77",
        builddate : "2023-10-06T19:17:59.039Z",        fetchdate : "2023-10-10T17:45:08-0400",        nrid      : "NOLONGERSUPPORTED",
        nrlk      : "NOLONGERSUPPORTED"
    };
</script>
<script type="text/javascript">
    if (!/\/logout.*/.test(location.pathname) && portal.host === location.origin && document.cookie.indexOf('rh_sso_session') >= 0 && !(document.cookie.indexOf('rh_jwt') >= 0)) window.location = '/login?redirectTo=' + encodeURIComponent(window.location.href);
</script>
<!-- cssInclude -->

<link rel="shortcut icon" href="https://access.redhat.com/webassets/avalon/g/favicon.ico" /><link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/bootstrap.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/bootstrap-grid.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/main.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/components.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/pages.css?v=27861f77" />

<link href="https://access.redhat.com/webassets/avalon/s/chosen.css?v=27861f77" rel="stylesheet" type="text/css" />

<!--[if lte IE 9]>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/ie.css" />
<![endif]--><noscript>
    <style type="text/css" media="screen"> .primary-nav { display: block; } </style>
</noscript>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/webassets/avalon/j/public_modules/node_modules/@cpelements/pfe-navigation/dist/pfe-navigation--lightdom.min.css" />
<!-- /cssInclude -->
<script src="https://access.redhat.com/webassets/avalon/j/public_modules/node_modules/@cpelements/pfe-navigation/dist/ie-polyfills.js?v=27861f77"></script>

<script async>
  if (!HTMLScriptElement.supports || !HTMLScriptElement.supports('importmap')) {
    import("https://www.redhatstatic.com/dx/v1-alpha/es-module-shims@1.7.3.js");
  }
</script>
<script type="importmap">
{
  "imports": {
    "@patternfly/elements/" : "https://www.redhatstatic.com/dx/v1-alpha/@patternfly/elements@2.2.2/",
    "@rhds/elements/":"https://www.redhatstatic.com/dx/v1-alpha/@rhds/elements@1.1.0/elements/",
    "@rhds/elements/lib/":"https://www.redhatstatic.com/dx/v1-alpha/@rhds/elements@1.1.0/lib/",
    "@cpelements/elements/":"https://www.redhatstatic.com/dx/v1-alpha/@cpelements/elements@2.0.0-alpha.7/elements/"
  }
}
</script><script type="text/javascript" src="https://access.redhat.com/webassets/avalon/j/lib/require.js?v=27861f77" data-main="/webassets/avalon/j/"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<script src="https://access.redhat.com/chrome_themes/nimbus/js/ie8.js"></script>
<![endif]-->
<script type="text/javascript" src="https://access.redhat.com/chrome_themes/nimbus/js/new-nav.js?v=27861f77" ></script>
<!-- /CP_PRIMER_HEAD -->

  </head>
  <body>
    
      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
      <!-- CP_PRIMER_HEADER -->
<div id="page-wrap" class="page-wrap">
    <div id="pers-top-page-wrap" class="top-page-wrap pers-loader-bg">

      <div id="hero-bg-top-left" class="summit-bg-shapes"></div>
      <div id="hero-bg-top-right" class="summit-bg-shapes"></div>

        <!--googleoff: all-->
        <header class="masthead" id="masthead">

            <a href="#pfe-navigation" id="global-skip-to-nav" class="skip-link visually-hidden">Skip to navigation</a>
            <a href="#cp-main" class="skip-link visually-hidden">Skip to main content</a>            <nav id="portal-utility-nav" class="utility-navigation utility-navigation--bar hidden-at-mobile" data-analytics-region="utility" aria-labelledby="nav__utility-nav--desktop">
                <h3 id="nav__utility-nav--desktop" class="element-invisible">Utilities
                </h3>
                <ul aria-labelledby="nav__utility-nav--desktop">
                    <li id="nav-subscription" data-portal-tour-1="1">
                        <a class="top-nav-subscriptions" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Subscription" href="https://access.redhat.com/management/" >Subscriptions
                        </a>
                    </li>
                    <li id="nav-downloads" data-portal-tour-1="2">
                        <a class="top-nav-downloads" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Downloads" href="https://access.redhat.com/downloads/" >Downloads
                        </a>
                    </li>
                    <li id="nav-containers">
                        <a class="top-nav-containers" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Containers" href="https://catalog.redhat.com/software/containers/explore/" >Containers
                        </a>
                    </li>
                    <li id="nav-support" data-portal-tour-1="3">
                        <a class="top-nav-support-cases" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Support Cases" href="https://access.redhat.com/support/cases/" >Support Cases
                        </a>
                    </li>
                </ul>
            </nav>

            <pfe-navigation id="pfe-navigation" data-analytics-region="mega menu">
                <div class="pfe-navigation__logo-wrapper" id="pfe-navigation__logo-wrapper">
                    <a href="https://access.redhat.com/" class="pfe-navigation__logo-link" data-analytics-text="logo" data-analytics-category="MM|logo">
                        <img class="pfe-navigation__logo-image" alt="Red Hat Customer Portal" src="https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg" />
                    </a>
                </div>

                <nav class="pfe-navigation" aria-label="Main Navigation" data-analytics-region="main nav">
                    <ul class="pfe-navigation__menu" id="pfe-navigation__menu">                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-subscription--mobile" data-portal-tour-1="1">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Subscription" href="https://access.redhat.com/management/" >Subscriptions
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-downloads--mobile" data-portal-tour-1="2">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Downloads" href="https://access.redhat.com/downloads/" >Downloads
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-containers--mobile">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Containers" href="https://catalog.redhat.com/software/containers/explore/" >Containers
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-support--mobile" data-portal-tour-1="3">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Support Cases" href="https://access.redhat.com/support/cases/" >Support Cases
                            </a>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a href="https://access.redhat.com/products/" class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Products and Services">Products &amp; Services
                            </a>
                            <div class="pfe-navigation__dropdown has-primary-detail">                                <div class="desktop-col-span-2 tablet-col-span-all">
                                    <h3>
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Products" href="https://access.redhat.com/products/">Products
                                        </a>
                                    </h3>
                                    <slot name="main-menu__dropdown--product__product-listing"></slot>
                                </div>                                <div>
                                    <h3 id="nav__products__support">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Support" href="https://access.redhat.com/support">Support
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__support">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Production Support" href="https://access.redhat.com/support/offerings/production/">Production Support
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Development Support" href="https://access.redhat.com/support/offerings/developer/">Development Support
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Product Life Cycles" href="https://access.redhat.com/product-life-cycles/">Product Life Cycles
                                                    </a></li>
                                    </ul>

                                    <h3 id="nav__products__services">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Services" href="https://www.redhat.com/en/services">Services
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__services">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Consulting" href="https://www.redhat.com/en/services/consulting">Consulting
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Technical Account Management" href="https://access.redhat.com/support/offerings/tam/">Technical Account Management
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Training and Certifications" href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications
                                                    </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__products__documentation">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Documentation" href="https://access.redhat.com/documentation">Documentation
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__documentation">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat Enterprise Linux" href="https://access.redhat.com/documentation/en/red_hat_enterprise_linux">Red Hat Enterprise Linux
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat JBoss Enterprise Application Platform" href="https://access.redhat.com/documentation/en/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat OpenStack Platform" href="https://access.redhat.com/documentation/en/red_hat_openstack_platform">Red Hat OpenStack Platform
                                                    </a></li>
                                                    <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat OpenShift Container Platform" href="https://access.redhat.com/documentation/en/openshift_container_platform">Red Hat OpenShift Container Platform
                                                        </a></li>
                                    </ul>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="All Documentation" data-analytics-linkType="cta" href="https://access.redhat.com/documentation">All Documentation
                                        </a>
                                    </pfe-cta>

                                    <h3 id="nav__products__catalog"><a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Ecosystem Catalog" href="https://catalog.redhat.com/">Ecosystem Catalog
                                        </a></h3>
                                        <ul aria-labelledby="nav__products__catalog">
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Ecosystem Catalog" data-analytics-text="Red Hat Partner Ecosystem" href="https://access.redhat.com/ecosystem/">Red Hat Partner Ecosystem
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Ecosystem Catalog" data-analytics-text="Partner Resources" href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources
                                                    </a></li>
                                        </ul>
                                </div>
                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Tools" href="https://access.redhat.com/labs/">Tools
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="nav__tools__tools" data-analytics-level="2" data-analytics-text="Tools" data-analytics-category="Tools">Tools
                                    </h3>
                                    <ul aria-labelledby="nav__tools__tools">
                                        <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Solution Engine" href="https://access.redhat.com/support/cases/#/troubleshoot">Troubleshoot a product issue
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Packages" href="https://access.redhat.com/downloads/content/package-browser">Packages
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Errata" href="https://access.redhat.com/errata/">Errata
                                                    </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__tools__labs">
                                        <a data-analytics-level="2" data-analytics-category="Tools" data-analytics-text="Customer Portal Labs" href="https://access.redhat.com/labs/">Customer Portal Labs
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__tools__labs">
                                        <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Configuration" href="https://access.redhat.com/labs/#!?type=config">Configuration
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Deployment" href="https://access.redhat.com/labs/#!?type=deploy">Deployment
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Security" href="https://access.redhat.com/labs/#!?type=security">Security
                                                    </a></li>                                                    <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Troubleshooting" href="https://access.redhat.com/labs/#!?type=troubleshoot">Troubleshoot
                                                        </a></li>
                                    </ul>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="All Labs" data-analytics-linkType="cta" href="https://access.redhat.com/labs/">All labs
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h4 id="nav__tools__red-hat-insights">
                                        <a data-analytics-level="2" data-analytics-category="Tools" data-analytics-text="Red Hat Insights" href="//www.redhat.com/en/technologies/management/insights">Red Hat Insights
                                        </a>
                                    </h4>
                                    <p>Increase visibility into IT operations to detect and resolve technical issues before they impact your business.</p>
                                    <a data-analytics-level="3" data-analytics-category="Tools|Red Hat Insights" data-analytics-text="Learn more" href="https://www.redhat.com/en/technologies/management/insights">Learn More
                                    </a>
                                    <br>
                                    <a data-analytics-level="3" data-analytics-category="Tools|Red Hat Insights" data-analytics-text="Go to Insights" href="https://cloud.redhat.com/insights">Go to Insights
                                    </a>
                                </div>
                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Security" href="https://access.redhat.com/security/">Security
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="security__security-center">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Red Hat Product Security Center" href="https://access.redhat.com/security">Red Hat Product Security Center
                                        </a>
                                    </h3>
                                    <p>Engage with our Red Hat Product Security team, access security updates, and ensure your environments are not exposed to any known security vulnerabilities.
                                    </p>
                                    <pfe-cta pfe-priority="primary">
                                        <a data-analytics-level="3" data-analytics-category="Security|Red Hat Product Security Center" data-analytics-text="Product Security Center" data-analytics-linkType="cta" href="https://access.redhat.com/security/">Product Security Center
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__security__updates" data-analytics-level="2" data-analytics-text="Security Updates" data-analytics-category="Security">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Security Updates" href="/security">Security Updates
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__security__updates">
                                        <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Security Advisories" href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Red Hat CVE Database" href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Security Labs" href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs
                                                    </a></li>
                                    </ul>
                                    <p class="margin-top-xl">Keep your systems secure with Red Hat&#039;s specialized responses to security vulnerabilities.
                                    </p>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="View Responses" data-analytics-linkType="cta" href="https://access.redhat.com/security/vulnerability">View Responses
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__security__resources">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Resources" href="https://access.redhat.com/security/overview">Resources
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__security__resources">                                            <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Security Blog" href="//redhat.com/en/blog/channel/security">Security Blog
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Security Measurement" href="https://www.redhat.com/security/data/metrics/">Security Measurement
                                                    </a></li>
                                                    <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Severity Ratings" href="https://access.redhat.com/security/updates/classification/">Severity Ratings
                                                        </a></li>
                                                        <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Backporting Policies" href="https://access.redhat.com/security/updates/backporting/">Backporting Policies
                                                            </a></li>
                                                            <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Product Signing (GPG) Keys" href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys
                                                                </a></li>
                                    </ul>
                                </div>

                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a href="https://access.redhat.com/community/" class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Community">Community
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="nav__community__cp-community">
                                        <a href="https://access.redhat.com/community" data-analytics-level="2" data-analytics-text="Customer Portal Community" data-analytics-text="Customer Portal Community" data-analytics-category="Community">Customer Portal Community
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__community__cp-community">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Discussions" href="https://access.redhat.com/discussions">Discussions
                                            </a></li>                                                <li><a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Private Groups" href="https://access.redhat.com/groups/">Private Groups
                                                    </a></li>
                                    </ul>

                                    <pfe-cta pfe-priority="primary">
                                        <a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Community Activity" data-analytics-linkType="cta" href="https://access.redhat.com/community/">Community Activity
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__community__events" data-analytics-level="2" data-analytics-text="Customer Events" data-analytics-category="Community">Customer Events
                                    </h3>
                                    <ul aria-labelledby="nav__community__events">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Customer Events" data-analytics-text="Red Hat Convergence" href="https://access.redhat.com/convergence/">Red Hat Convergence
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Community|Customer Events" data-analytics-text="Red Hat Summit" href="http://www.redhat.com/summit/">Red Hat Summit
                                                </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__community__stories" data-analytics-level="2" data-analytics-text="Stories" data-analytics-category="Community">Stories
                                    </h3>
                                    <ul aria-labelledby="nav__community__stories">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Stories" data-analytics-text="Red Hat Subscription Value" href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-text="You Asked. We Acted." data-analytics-category="Community|Stories" href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Community|Stories" data-analytics-text="Open Source Communities" href="http://www.redhat.com/en/open-source">Open Source Communities
                                                    </a></li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                    </ul>                </nav>                <div id="site-search" slot="search" class="utility-link site-search">
                    <div class="content">
                        <form class="ng-pristine ng-valid topSearchForm" id="topSearchForm" name="topSearchForm" action="/search/browse/search/" method="get" enctype="application/x-www-form-urlencoded">
                            <cp-search-autocomplete class="push-bottom" path="/webassets/avalon/j/data.json"></cp-search-autocomplete>                            <div>Or <a href="/support/cases/#/troubleshoot">troubleshoot an issue</a>.
                            </div>
                        </form>
                    </div>
                </div>


                <div slot="secondary-links" id="localesMenu">
                    <button class="pfe-navigation__secondary-link">
                        <pfe-icon icon="web-icon-globe" size="sm" aria-hidden="true"></pfe-icon>English
                    </button>

                    <pfe-navigation-dropdown dropdown-width="single">
                        <h2 class="utility-header">Select Your Language
                        </h2>
                        <ul class="reset">
                            <li><a href="https://access.redhat.com/changeLanguage?language=en" data-lang="en" id="en" data-analytics-text="English">English</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=ko" data-lang="ko" id="ko" data-analytics-text="Korean">한국어</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=ja"    data-lang="ja"    id="ja" data-analytics-text="Japanese">日本語</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" data-lang="zh_CN" id="zh_CN" data-analytics-text="Chinese">中文 (中国)</a></li>
                        </ul>

                    </pfe-navigation-dropdown>
                </div>                <rh-account-dropdown slot="account"></rh-account-dropdown>                <pfe-primary-detail breakpoint-width="600" class="main-menu__dropdown--product__product-listing" slot="main-menu__dropdown--product__product-listing" consistent-height>
                    <h3 slot="details-nav">Infrastructure and Management                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Enterprise Linux" href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Satellite" href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Subscription Management" href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Insights" href="https://access.redhat.com/products/red-hat-insights/">Red Hat Insights
                                </a>
                            </li>
                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Ansible Automation Platform" href="https://access.redhat.com/products/red-hat-ansible-automation-platform/">Red Hat Ansible Automation Platform
                                </a></li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Cloud Computing                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift" href="https://access.redhat.com/products/openshift">Red Hat OpenShift
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenStack Platform" href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat OpenShift Container Platform" href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat OpenShift Data Science" href="https://access.redhat.com/products/red-hat-openshift-data-science/">Red Hat OpenShift Data Science
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift Dedicated" href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat Advanced Cluster Security for Kubernetes" href="https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/">Red Hat Advanced Cluster Security for Kubernetes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat Advanced Cluster Management for Kubernetes" href="https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/">Red Hat Advanced Cluster Management for Kubernetes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat Quay" href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat CodeReady Workspaces" href="https://access.redhat.com/products/red-hat-codeready-workspaces/">OpenShift Dev Spaces
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift Service on AWS" href="https://access.redhat.com/products/red-hat-openshift-service-aws">Red Hat OpenShift Service on AWS
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Storage                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Gluster Storage" href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Hyperconverged Infrastructure" href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Ceph Storage" href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Openshift Container Storage" href="https://access.redhat.com/products/red-hat-openshift-data-foundation">Red Hat OpenShift Data Foundation
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Runtimes                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Runtimes" href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat JBoss Enterprise Application Platform" href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Data Grid" href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat JBoss Web Server" href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Single Sign On" href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat support for Spring Boot" href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat build of Node.js" href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js
                                </a>
                            </li>                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat build of Quarkus" href="https://access.redhat.com/products/quarkus/">Red Hat build of Quarkus
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Integration and Automation                    </h3>
                    <div slot="details">
                        <ul class="border-bottom" id="portal-menu-border-bottom">
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat Application Foundations" href="https://access.redhat.com/products/red-hat-application-foundations/">Red Hat Application Foundations
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat Fuse" href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat AMQ" href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat 3scale API Management" href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div slot="details-nav--footer">
                        <pfe-cta pfe-priority="primary">
                            <a href="https://access.redhat.com/products/" class="pfe-navigation__menu-link" data-analytics-level="2" data-analytics-text="All Products" data-analytics-category="Products and Services|Products:" data-analytics-linkType="cta">All Products
                            </a>
                        </pfe-cta>
                    </div>
                </pfe-primary-detail>

            </pfe-navigation>

            <div id="scroll-anchor"></div>

            <!--[if IE 8]>
                <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                <span class="icon-warning alert-icon" aria-hidden="true"></span>
                You are using an unsupported web browser. Update to a supported browser for the best experience. <a href="/announcements/2120951">Read the announcement</a>.
                </div>
                </div>
            <![endif]-->
            <!--[if IE 9]>
                <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                <span class="icon-warning alert-icon" aria-hidden="true"></span>As of March 1, 2016, the Red Hat Customer Portal will no longer support Internet Explorer 9. See our new <a href="/help/browsers">browser support policy</a> for more information.
                </div>
                </div>
            <![endif]-->
            <div id="site-section"></div>
        </header>
        <!--googleon: all-->

        <main id="cp-main" class="portal-content-area">
            <div id="cp-content" class="main-content">                            <!-- /CP_PRIMER_HEADER -->

      <div class="container">
        

                                                                                                        <script>breadcrumbs = [["Products & Services","\/products\/"],["Product Documentation","\/documentation"],["OpenShift Container Platform","\/documentation\/en-us\/openshift_container_platform"],["4.13","\/documentation\/en-us\/openshift_container_platform\/4.13"],["Service Mesh","\/documentation\/en-us\/openshift_container_platform\/4.13\/html\/service_mesh"],["Service Mesh","\/documentation\/en-us\/openshift_container_platform\/4.13\/html\/service_mesh\/--single-page-document--"]]</script>

<div data-drupal-messages-fallback class="hidden"></div>


    </div>
        <div class="container">
        

  

  


  <article class="pvof-doc__content-wrapper__outer pvof-doc__content-wrapper__outer--css-not-removed">
    <script>
      'use strict';

            var $outerWrapper = document.querySelector('.pvof-doc__content-wrapper__outer');
      if ($outerWrapper && $outerWrapper.closest) {
        var $containerWrapper = $outerWrapper.closest('.container');
        if ($containerWrapper) {
          $containerWrapper.classList.remove('container');
          $containerWrapper.classList.add('j-chrome-content-container');
        }
      }

            var cssRemoved = false;
      try {
        var $crapCss = document.querySelectorAll(
          'link[href*="/chrome_themes/nimbus/css/pages.css"], link[href*="/chrome_themes/nimbus/css/components.css"]'
        );
        if ($crapCss.length) {
          for (let index = 0; index < $crapCss.length; index++) {
            const $stylesheet = $crapCss[index];
            $stylesheet.remove();
          }
        }
        cssRemoved = true;
      }
      catch (error) {
        console.error('Ran into an issue while trying to retheme page', error);
        cssRemoved = false;
      }

            if (cssRemoved) {
        var $pvofOuterWrapper = document.querySelector('.pvof-doc__content-wrapper__outer--css-not-removed');
        if ($pvofOuterWrapper) {
          $pvofOuterWrapper.classList.remove('pvof-doc__content-wrapper__outer--css-not-removed');
        }
      }
    </script>
    <div itemscope="" itemtype="https://schema.org/TechArticle" itemref="techArticle-md1 techArticle-md2 techArticle-md3"></div>
    <div itemscope="" itemtype="https://schema.org/SoftwareApplication" itemref="softwareApplication-md1 softwareApplication-md2 softwareApplication-md3 softwareApplication-md4"></div>
    <div class="pvof-doc__content-wrapper pvof-doc__content-wrapper--has-sidebar">
                                <div class="pvof-doc__content-wrapper__inner j-superdoc j-superdoc--has-nav">
                            <div class="pvof-sidebar__wrapper j-doc-nav j-superdoc__nav">
            <div class="j-sidebar__menu-container">
              <button class="j-sidebar__menu-trigger content-expander__trigger">
                <span class="j-sidebar__menu-trigger__open-text">Jump To</span>
                <span class="j-sidebar__menu-trigger__close-text">Close</span>
              </button>

              <div class="pvof-sidebar__inner-wrapper j-doc-nav__wrapper content-expander">
                <div class="j-sidebar__menu-details-container">
                  <button class="j-sidebar__menu-details-button j-sidebar__menu-details-button--expand">
                    Expand all
                  </button>
                  <button class="j-sidebar__menu-details-button j-sidebar__menu-details-button--collapse">
                    Collapse all
                  </button>
                </div>
                

  <nav id="pvof-doc__toc" class="pvof-doc__toc">
  <h2 class="j-doc-nav__title" id="j-doc-nav__title">
    Table of contents
  </h2>
  <div class="pvof-doc__toc-inner">
              <ol class="j-doc-nav__list" aria-labelledby="j-doc-nav__title">
                  <li class="j-doc-nav__list-item">
                                    

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh" class="j-doc-nav__link ">
    Service Mesh
  </a>
  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#service-mesh-2-x" class="j-doc-nav__link j-doc-nav__link--has-children">
    1. Service Mesh 2.x
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1. Service Mesh 2.x"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1. Service Mesh 2.x"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-about" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.1. About OpenShift Service Mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.1. About OpenShift Service Mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.1. About OpenShift Service Mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-servicemesh-overview_ossm-about" class="j-doc-nav__link ">
    1.1.1. Introduction to Red Hat OpenShift Service Mesh
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-core-features_ossm-about" class="j-doc-nav__link ">
    1.1.2. Core features
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#service-mesh-release-notes" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2. Service Mesh Release Notes
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2. Service Mesh Release Notes"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2. Service Mesh Release Notes"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#making-open-source-more-inclusive_ossm-release-notes" class="j-doc-nav__link ">
    1.2.1. Making open source more inclusive
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-rn-new-features_ossm-release-notes" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2. New features and enhancements
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2. New features and enhancements"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2. New features and enhancements"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-4-3" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.1. New features Red Hat OpenShift Service Mesh version 2.4.3
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.1. New features Red Hat OpenShift Service Mesh version 2.4.3"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.1. New features Red Hat OpenShift Service Mesh version 2.4.3"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-4-3" class="j-doc-nav__link ">
    1.2.2.1.1. Component versions included in Red Hat OpenShift Service Mesh version 2.4.3
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#red-hat-openshift-service-mesh-operator-to-arm-based-clusters" class="j-doc-nav__link ">
    1.2.2.1.2. Red Hat OpenShift Service Mesh operator to ARM-based clusters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#remote-procedure-calls-grpc-api-support-for-external-authorization-configuration" class="j-doc-nav__link ">
    1.2.2.1.3. Remote Procedure Calls (gRPC) API support for external authorization configuration
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-4-2" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.2. New features Red Hat OpenShift Service Mesh version 2.4.2
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.2. New features Red Hat OpenShift Service Mesh version 2.4.2"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.2. New features Red Hat OpenShift Service Mesh version 2.4.2"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-4-2" class="j-doc-nav__link ">
    1.2.2.2.1. Component versions included in Red Hat OpenShift Service Mesh version 2.4.2
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-4-1" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.3. New features Red Hat OpenShift Service Mesh version 2.4.1
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.3. New features Red Hat OpenShift Service Mesh version 2.4.1"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.3. New features Red Hat OpenShift Service Mesh version 2.4.1"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-4-1" class="j-doc-nav__link ">
    1.2.2.3.1. Component versions included in Red Hat OpenShift Service Mesh version 2.4.1
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-4" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.4. New features Red Hat OpenShift Service Mesh version 2.4
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.4. New features Red Hat OpenShift Service Mesh version 2.4"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.4. New features Red Hat OpenShift Service Mesh version 2.4"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-4" class="j-doc-nav__link ">
    1.2.2.4.1. Component versions included in Red Hat OpenShift Service Mesh version 2.4
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#cluster-wide-deployments" class="j-doc-nav__link ">
    1.2.2.4.2. Cluster-wide deployments
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#support-for-discovery-selectors" class="j-doc-nav__link ">
    1.2.2.4.3. Support for discovery selectors
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#integration-with-cert-manager-istio-csr" class="j-doc-nav__link ">
    1.2.2.4.4. Integration with cert-manager istio-csr
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#integration-with-external-authorization-systems" class="j-doc-nav__link ">
    1.2.2.4.5. Integration with external authorization systems
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#integration-with-external-prometheus-installation" class="j-doc-nav__link ">
    1.2.2.4.6. Integration with external Prometheus installation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#single-stack-ipv6-support" class="j-doc-nav__link ">
    1.2.2.4.7. Single stack IPv6 support
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#openshift-container-platform-gateway-api-support" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.4.8. OpenShift Container Platform Gateway API support
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.4.8. OpenShift Container Platform Gateway API support"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.4.8. OpenShift Container Platform Gateway API support"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#enabling-openshift-container-platform-gateway-api" class="j-doc-nav__link ">
    1.2.2.4.8.1. Enabling OpenShift Container Platform Gateway API
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#control-plane-deployment-on-infrastructure-nodes" class="j-doc-nav__link ">
    1.2.2.4.9. Control plane deployment on infrastructure nodes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#istio-1-16-support" class="j-doc-nav__link ">
    1.2.2.4.10. Istio 1.16 support
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-3-7" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.5. New features Red Hat OpenShift Service Mesh version 2.3.7
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.5. New features Red Hat OpenShift Service Mesh version 2.3.7"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.5. New features Red Hat OpenShift Service Mesh version 2.3.7"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-3-7" class="j-doc-nav__link ">
    1.2.2.5.1. Component versions included in Red Hat OpenShift Service Mesh version 2.3.7
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-3-6" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.6. New features Red Hat OpenShift Service Mesh version 2.3.6
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.6. New features Red Hat OpenShift Service Mesh version 2.3.6"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.6. New features Red Hat OpenShift Service Mesh version 2.3.6"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-3-6" class="j-doc-nav__link ">
    1.2.2.6.1. Component versions included in Red Hat OpenShift Service Mesh version 2.3.6
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-3-5" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.7. New features Red Hat OpenShift Service Mesh version 2.3.5
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.7. New features Red Hat OpenShift Service Mesh version 2.3.5"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.7. New features Red Hat OpenShift Service Mesh version 2.3.5"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-3-5" class="j-doc-nav__link ">
    1.2.2.7.1. Component versions included in Red Hat OpenShift Service Mesh version 2.3.5
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-3-4" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.8. New features Red Hat OpenShift Service Mesh version 2.3.4
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.8. New features Red Hat OpenShift Service Mesh version 2.3.4"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.8. New features Red Hat OpenShift Service Mesh version 2.3.4"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-3-4" class="j-doc-nav__link ">
    1.2.2.8.1. Component versions included in Red Hat OpenShift Service Mesh version 2.3.4
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-3-3" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.9. New features Red Hat OpenShift Service Mesh version 2.3.3
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.9. New features Red Hat OpenShift Service Mesh version 2.3.3"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.9. New features Red Hat OpenShift Service Mesh version 2.3.3"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-3-3" class="j-doc-nav__link ">
    1.2.2.9.1. Component versions included in Red Hat OpenShift Service Mesh version 2.3.3
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-3-2" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.10. New features Red Hat OpenShift Service Mesh version 2.3.2
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.10. New features Red Hat OpenShift Service Mesh version 2.3.2"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.10. New features Red Hat OpenShift Service Mesh version 2.3.2"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-3-2" class="j-doc-nav__link ">
    1.2.2.10.1. Component versions included in Red Hat OpenShift Service Mesh version 2.3.2
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-3-1" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.11. New features Red Hat OpenShift Service Mesh version 2.3.1
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.11. New features Red Hat OpenShift Service Mesh version 2.3.1"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.11. New features Red Hat OpenShift Service Mesh version 2.3.1"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-3-1" class="j-doc-nav__link ">
    1.2.2.11.1. Component versions included in Red Hat OpenShift Service Mesh version 2.3.1
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-3" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.12. New features Red Hat OpenShift Service Mesh version 2.3
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.12. New features Red Hat OpenShift Service Mesh version 2.3"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.12. New features Red Hat OpenShift Service Mesh version 2.3"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-3" class="j-doc-nav__link ">
    1.2.2.12.1. Component versions included in Red Hat OpenShift Service Mesh version 2.3
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-container-network-interface-cni-daemonset-container-and-configmap" class="j-doc-nav__link ">
    1.2.2.12.2. New Container Network Interface (CNI) DaemonSet container and ConfigMap
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#gateway-injection-support" class="j-doc-nav__link ">
    1.2.2.12.3. Gateway injection support
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#istio-1-14-support" class="j-doc-nav__link ">
    1.2.2.12.4. Istio 1.14 Support
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#openshift-service-mesh-console" class="j-doc-nav__link ">
    1.2.2.12.5. OpenShift Service Mesh Console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#cluster-wide-deployment" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.12.6. Cluster-wide deployment
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.12.6. Cluster-wide deployment"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.12.6. Cluster-wide deployment"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#configuring-cluster-wide-deployment" class="j-doc-nav__link ">
    1.2.2.12.6.1. Configuring cluster-wide deployment
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-2-10" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.13. New features Red Hat OpenShift Service Mesh version 2.2.10
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.13. New features Red Hat OpenShift Service Mesh version 2.2.10"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.13. New features Red Hat OpenShift Service Mesh version 2.2.10"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-10" class="j-doc-nav__link ">
    1.2.2.13.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.10
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-2-9" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.14. New features Red Hat OpenShift Service Mesh version 2.2.9
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.14. New features Red Hat OpenShift Service Mesh version 2.2.9"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.14. New features Red Hat OpenShift Service Mesh version 2.2.9"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-9" class="j-doc-nav__link ">
    1.2.2.14.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.9
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-2-8" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.15. New features Red Hat OpenShift Service Mesh version 2.2.8
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.15. New features Red Hat OpenShift Service Mesh version 2.2.8"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.15. New features Red Hat OpenShift Service Mesh version 2.2.8"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-8" class="j-doc-nav__link ">
    1.2.2.15.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.8
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-2-7" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.16. New features Red Hat OpenShift Service Mesh version 2.2.7
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.16. New features Red Hat OpenShift Service Mesh version 2.2.7"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.16. New features Red Hat OpenShift Service Mesh version 2.2.7"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-7" class="j-doc-nav__link ">
    1.2.2.16.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.7
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-2-6" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.17. New features Red Hat OpenShift Service Mesh version 2.2.6
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.17. New features Red Hat OpenShift Service Mesh version 2.2.6"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.17. New features Red Hat OpenShift Service Mesh version 2.2.6"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-6" class="j-doc-nav__link ">
    1.2.2.17.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.6
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-2-5" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.18. New features Red Hat OpenShift Service Mesh version 2.2.5
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.18. New features Red Hat OpenShift Service Mesh version 2.2.5"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.18. New features Red Hat OpenShift Service Mesh version 2.2.5"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-5" class="j-doc-nav__link ">
    1.2.2.18.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.5
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-2-4" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.19. New features Red Hat OpenShift Service Mesh version 2.2.4
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.19. New features Red Hat OpenShift Service Mesh version 2.2.4"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.19. New features Red Hat OpenShift Service Mesh version 2.2.4"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-4" class="j-doc-nav__link ">
    1.2.2.19.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.4
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-2-3" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.20. New features Red Hat OpenShift Service Mesh version 2.2.3
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.20. New features Red Hat OpenShift Service Mesh version 2.2.3"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.20. New features Red Hat OpenShift Service Mesh version 2.2.3"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-3" class="j-doc-nav__link ">
    1.2.2.20.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.3
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-2-2" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.21. New features Red Hat OpenShift Service Mesh version 2.2.2
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.21. New features Red Hat OpenShift Service Mesh version 2.2.2"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.21. New features Red Hat OpenShift Service Mesh version 2.2.2"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-2" class="j-doc-nav__link ">
    1.2.2.21.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.2
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#copy-route-labels" class="j-doc-nav__link ">
    1.2.2.21.2. Copy route labels
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-version-2-2-1" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.22. New features Red Hat OpenShift Service Mesh version 2.2.1
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.22. New features Red Hat OpenShift Service Mesh version 2.2.1"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.22. New features Red Hat OpenShift Service Mesh version 2.2.1"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-1" class="j-doc-nav__link ">
    1.2.2.22.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.1
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-2" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.23. New features Red Hat OpenShift Service Mesh 2.2
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.23. New features Red Hat OpenShift Service Mesh 2.2"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.23. New features Red Hat OpenShift Service Mesh 2.2"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-2" class="j-doc-nav__link ">
    1.2.2.23.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#literal-wasmplugin-literal-api" class="j-doc-nav__link ">
    1.2.2.23.2. WasmPlugin API
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#rosa-support" class="j-doc-nav__link ">
    1.2.2.23.3. ROSA support
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#literal-istio-node-literal-daemonset-renamed" class="j-doc-nav__link ">
    1.2.2.23.4. istio-node DaemonSet renamed
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#envoy-sidecar-networking-changes" class="j-doc-nav__link ">
    1.2.2.23.5. Envoy sidecar networking changes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#service-mesh-control-plane-1-1" class="j-doc-nav__link ">
    1.2.2.23.6. Service Mesh Control Plane 1.1
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#istio-1-12-support" class="j-doc-nav__link ">
    1.2.2.23.7. Istio 1.12 Support
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#kubernetes-gateway-api" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.23.8. Kubernetes Gateway API
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.23.8. Kubernetes Gateway API"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.23.8. Kubernetes Gateway API"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#installing-the-gateway-api-crds" class="j-doc-nav__link ">
    1.2.2.23.8.1. Installing the Gateway API CRDs
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#enabling-kubernetes-gateway-api" class="j-doc-nav__link ">
    1.2.2.23.8.2. Enabling Kubernetes Gateway API
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#manually-linking-an-existing-gateway-to-a-gateway-resource" class="j-doc-nav__link ">
    1.2.2.23.8.3. Manually linking an existing gateway to a Gateway resource
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-1-6" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.24. New features Red Hat OpenShift Service Mesh 2.1.6
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.24. New features Red Hat OpenShift Service Mesh 2.1.6"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.24. New features Red Hat OpenShift Service Mesh 2.1.6"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-6" class="j-doc-nav__link ">
    1.2.2.24.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.6
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-1-5-2" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.25. New features Red Hat OpenShift Service Mesh 2.1.5.2
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.25. New features Red Hat OpenShift Service Mesh 2.1.5.2"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.25. New features Red Hat OpenShift Service Mesh 2.1.5.2"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-5-2" class="j-doc-nav__link ">
    1.2.2.25.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.5.2
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-1-5-1" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.26. New features Red Hat OpenShift Service Mesh 2.1.5.1
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.26. New features Red Hat OpenShift Service Mesh 2.1.5.1"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.26. New features Red Hat OpenShift Service Mesh 2.1.5.1"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-5-1" class="j-doc-nav__link ">
    1.2.2.26.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.5.1
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-1-5" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.27. New features Red Hat OpenShift Service Mesh 2.1.5
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.27. New features Red Hat OpenShift Service Mesh 2.1.5"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.27. New features Red Hat OpenShift Service Mesh 2.1.5"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-5" class="j-doc-nav__link ">
    1.2.2.27.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.5
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-1-4" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.28. New features Red Hat OpenShift Service Mesh 2.1.4
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.28. New features Red Hat OpenShift Service Mesh 2.1.4"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.28. New features Red Hat OpenShift Service Mesh 2.1.4"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-4" class="j-doc-nav__link ">
    1.2.2.28.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.4
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-1-3" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.29. New features Red Hat OpenShift Service Mesh 2.1.3
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.29. New features Red Hat OpenShift Service Mesh 2.1.3"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.29. New features Red Hat OpenShift Service Mesh 2.1.3"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-3" class="j-doc-nav__link ">
    1.2.2.29.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.3
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-1-2-1" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.30. New features Red Hat OpenShift Service Mesh 2.1.2.1
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.30. New features Red Hat OpenShift Service Mesh 2.1.2.1"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.30. New features Red Hat OpenShift Service Mesh 2.1.2.1"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-2-1" class="j-doc-nav__link ">
    1.2.2.30.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.2.1
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-1-2" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.31. New features Red Hat OpenShift Service Mesh 2.1.2
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.31. New features Red Hat OpenShift Service Mesh 2.1.2"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.31. New features Red Hat OpenShift Service Mesh 2.1.2"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-2" class="j-doc-nav__link ">
    1.2.2.31.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.2
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-1-1" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.32. New features Red Hat OpenShift Service Mesh 2.1.1
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.32. New features Red Hat OpenShift Service Mesh 2.1.1"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.32. New features Red Hat OpenShift Service Mesh 2.1.1"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-1" class="j-doc-nav__link ">
    1.2.2.32.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.1
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-config-disable-networkpolicy_ossm-release-notes" class="j-doc-nav__link ">
    1.2.2.32.2. Disabling network policies
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-and-enhancements-red-hat-openshift-service-mesh-2-1" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.33. New features and enhancements Red Hat OpenShift Service Mesh 2.1
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.33. New features and enhancements Red Hat OpenShift Service Mesh 2.1"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.33. New features and enhancements Red Hat OpenShift Service Mesh 2.1"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-1" class="j-doc-nav__link ">
    1.2.2.33.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#service-mesh-federation" class="j-doc-nav__link ">
    1.2.2.33.2. Service Mesh Federation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ovn-kubernetes-container-network-interface-cni-generally-available" class="j-doc-nav__link ">
    1.2.2.33.3. OVN-Kubernetes Container Network Interface (CNI) generally available
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#service-mesh-webassembly-wasm-extensions" class="j-doc-nav__link ">
    1.2.2.33.4. Service Mesh WebAssembly (WASM) Extensions
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#threescale-webassembly-adapter-wasm" class="j-doc-nav__link ">
    1.2.2.33.5. 3scale WebAssembly Adapter (WASM)
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#istio-1-9-support" class="j-doc-nav__link ">
    1.2.2.33.6. Istio 1.9 Support
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#improved-service-mesh-operator-performance" class="j-doc-nav__link ">
    1.2.2.33.7. Improved Service Mesh operator performance
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#kiali-updates" class="j-doc-nav__link ">
    1.2.2.33.8. Kiali updates
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-0-11-1" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.34. New features Red Hat OpenShift Service Mesh 2.0.11.1
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.34. New features Red Hat OpenShift Service Mesh 2.0.11.1"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.34. New features Red Hat OpenShift Service Mesh 2.0.11.1"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-0-11-1" class="j-doc-nav__link ">
    1.2.2.34.1. Component versions included in Red Hat OpenShift Service Mesh version 2.0.11.1
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-0-11" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.35. New features Red Hat OpenShift Service Mesh 2.0.11
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.35. New features Red Hat OpenShift Service Mesh 2.0.11"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.35. New features Red Hat OpenShift Service Mesh 2.0.11"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-0-11" class="j-doc-nav__link ">
    1.2.2.35.1. Component versions included in Red Hat OpenShift Service Mesh version 2.0.11
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-0-10" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.36. New features Red Hat OpenShift Service Mesh 2.0.10
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.36. New features Red Hat OpenShift Service Mesh 2.0.10"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.36. New features Red Hat OpenShift Service Mesh 2.0.10"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-0-10" class="j-doc-nav__link ">
    1.2.2.36.1. Component versions included in Red Hat OpenShift Service Mesh version 2.0.10
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-0-9" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.37. New features Red Hat OpenShift Service Mesh 2.0.9
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.37. New features Red Hat OpenShift Service Mesh 2.0.9"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.37. New features Red Hat OpenShift Service Mesh 2.0.9"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-2-0-9" class="j-doc-nav__link ">
    1.2.2.37.1. Component versions included in Red Hat OpenShift Service Mesh version 2.0.9
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-0-8" class="j-doc-nav__link ">
    1.2.2.38. New features Red Hat OpenShift Service Mesh 2.0.8
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-0-7-1" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.39. New features Red Hat OpenShift Service Mesh 2.0.7.1
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.39. New features Red Hat OpenShift Service Mesh 2.0.7.1"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.39. New features Red Hat OpenShift Service Mesh 2.0.7.1"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#change-in-how-red-hat-openshift-service-mesh-handles-uri-fragments" class="j-doc-nav__link ">
    1.2.2.39.1. Change in how Red Hat OpenShift Service Mesh handles URI fragments
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#required-update-for-authorization-policies" class="j-doc-nav__link ">
    1.2.2.39.2. Required update for authorization policies
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-0-7" class="j-doc-nav__link ">
    1.2.2.40. New features Red Hat OpenShift Service Mesh 2.0.7
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#red-hat-openshift-service-mesh-on-red-hat-openshift-dedicated-and-microsoft-azure-red-hat-openshift" class="j-doc-nav__link ">
    1.2.2.41. Red Hat OpenShift Service Mesh on Red Hat OpenShift Dedicated and Microsoft Azure Red Hat OpenShift
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-0-6" class="j-doc-nav__link ">
    1.2.2.42. New features Red Hat OpenShift Service Mesh 2.0.6
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-0-5" class="j-doc-nav__link ">
    1.2.2.43. New features Red Hat OpenShift Service Mesh 2.0.5
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-0-4" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.2.44. New features Red Hat OpenShift Service Mesh 2.0.4
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.2.44. New features Red Hat OpenShift Service Mesh 2.0.4"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.2.44. New features Red Hat OpenShift Service Mesh 2.0.4"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#manual-updates-cve-2021-29492_ossm-release-notes" class="j-doc-nav__link ">
    1.2.2.44.1. Manual updates required by CVE-2021-29492 and CVE-2021-31920
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#updating-the-path-normalization-configuration" class="j-doc-nav__link ">
    1.2.2.44.2. Updating the path normalization configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#path-normalization-configuration-examples" class="j-doc-nav__link ">
    1.2.2.44.3. Path normalization configuration examples
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#configuring-your-smcp-for-path-normalization" class="j-doc-nav__link ">
    1.2.2.44.4. Configuring your SMCP for path normalization
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#configuring-for-case-normalization" class="j-doc-nav__link ">
    1.2.2.44.5. Configuring for case normalization
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-0-3" class="j-doc-nav__link ">
    1.2.2.45. New features Red Hat OpenShift Service Mesh 2.0.3
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-0-2" class="j-doc-nav__link ">
    1.2.2.46. New features Red Hat OpenShift Service Mesh 2.0.2
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-0-1" class="j-doc-nav__link ">
    1.2.2.47. New features Red Hat OpenShift Service Mesh 2.0.1
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-2-0" class="j-doc-nav__link ">
    1.2.2.48. New features Red Hat OpenShift Service Mesh 2.0
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-rn-tech-preview_ossm-release-notes" class="j-doc-nav__link ">
    1.2.3. Technology Preview
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-deprecated-features_ossm-release-notes" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.4. Deprecated and removed features
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.4. Deprecated and removed features"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.4. Deprecated and removed features"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#deprecated-and-removed-features-in-red-hat-openshift-service-mesh-2-4" class="j-doc-nav__link ">
    1.2.4.1. Deprecated and removed features in Red Hat OpenShift Service Mesh 2.4
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#deprecated-and-removed-features-in-red-hat-openshift-service-mesh-2-3" class="j-doc-nav__link ">
    1.2.4.2. Deprecated and removed features in Red Hat OpenShift Service Mesh 2.3
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#deprecated-features-in-red-hat-openshift-service-mesh-2-2" class="j-doc-nav__link ">
    1.2.4.3. Deprecated features in Red Hat OpenShift Service Mesh 2.2
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#removed-features-in-red-hat-openshift-service-mesh-2-2" class="j-doc-nav__link ">
    1.2.4.4. Removed features in Red Hat OpenShift Service Mesh 2.2
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#removed-features-in-red-hat-openshift-service-mesh-2-1" class="j-doc-nav__link ">
    1.2.4.5. Removed features in Red Hat OpenShift Service Mesh 2.1
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#deprecated-features-in-red-hat-openshift-service-mesh-2-0" class="j-doc-nav__link ">
    1.2.4.6. Deprecated features in Red Hat OpenShift Service Mesh 2.0
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-rn-known-issues_ossm-release-notes" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.5. Known issues
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.5. Known issues"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.5. Known issues"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-rn-known-issues-ossm_ossm-release-notes" class="j-doc-nav__link ">
    1.2.5.1. Service Mesh known issues
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-rn-known-issues-kiali_ossm-release-notes" class="j-doc-nav__link ">
    1.2.5.2. Kiali known issues
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-rn-fixed-issues_ossm-release-notes" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.2.6. Fixed issues
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.2.6. Fixed issues"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.2.6. Fixed issues"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-rn-fixed-issues-ossm_ossm-release-notes" class="j-doc-nav__link ">
    1.2.6.1. Service Mesh fixed issues
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-architecture" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.3. Understanding Service Mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.3. Understanding Service Mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.3. Understanding Service Mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-understanding-service-mesh_ossm-architecture" class="j-doc-nav__link ">
    1.3.1. Understanding service mesh
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-architecture_ossm-architecture" class="j-doc-nav__link ">
    1.3.2. Service Mesh architecture
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#understanding-kiali" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.3.3. Understanding Kiali
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.3.3. Understanding Kiali"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.3.3. Understanding Kiali"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-kiali-overview_ossm-architecture" class="j-doc-nav__link ">
    1.3.3.1. Kiali overview
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-kiali-architecture_ossm-architecture" class="j-doc-nav__link ">
    1.3.3.2. Kiali architecture
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-kiali-features_ossm-architecture" class="j-doc-nav__link ">
    1.3.3.3. Kiali features
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#understanding-distributed-tracing" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.3.4. Understanding distributed tracing
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.3.4. Understanding distributed tracing"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.3.4. Understanding distributed tracing"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-product-overview_ossm-architecture" class="j-doc-nav__link ">
    1.3.4.1. Distributed tracing overview
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-architecture_ossm-architecture" class="j-doc-nav__link ">
    1.3.4.2. Red Hat OpenShift distributed tracing platform architecture
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-features_ossm-architecture" class="j-doc-nav__link ">
    1.3.4.3. Red Hat OpenShift distributed tracing platform features
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#next-steps" class="j-doc-nav__link ">
    1.3.5. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-deployment-models" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.4. Service mesh deployment models
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.4. Service mesh deployment models"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.4. Service mesh deployment models"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-deploy-cluster-wide-mesh_ossm-deployment-models" class="j-doc-nav__link ">
    1.4.1. Cluster-Wide (Single Tenant) mesh deployment model
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-deploy-multitenant_ossm-deployment-models" class="j-doc-nav__link ">
    1.4.2. Multitenant deployment model
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-deploy-multi-mesh_ossm-deployment-models" class="j-doc-nav__link ">
    1.4.3. Multimesh or federated deployment model
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-vs-community" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.5. Service Mesh and Istio differences
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.5. Service Mesh and Istio differences"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.5. Service Mesh and Istio differences"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-vs-istio_ossm-vs-istio" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.5.1. Differences between Istio and Red Hat OpenShift Service Mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.5.1. Differences between Istio and Red Hat OpenShift Service Mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.5.1. Differences between Istio and Red Hat OpenShift Service Mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cli-tool_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.1. Command line tool
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-installation-upgrade_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.2. Installation and upgrades
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-automatic-injection_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.3. Automatic injection
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-rbac_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.4. Istio Role Based Access Control features
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-openssl_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.5. OpenSSL
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-external-workloads_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.6. External workloads
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-virtual-machine-support_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.7. Virtual Machine Support
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-component-modifications_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.8. Component modifications
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-envoy-filters_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.9. Envoy filters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-envoy-services_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.10. Envoy services
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cni_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.11. Istio Container Network Interface (CNI) plugin
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-global-mtls_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.12. Global mTLS settings
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-gateways_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.13. Gateways
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-multicluster-configuration_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.14. Multicluster configurations
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-certificate-signing-request_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.15. Custom Certificate Signing Requests (CSR)
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routes-gateways_ossm-vs-istio" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.5.1.16. Routes for Istio Gateways
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.5.1.16. Routes for Istio Gateways"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.5.1.16. Routes for Istio Gateways"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-catch-all-domains_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.16.1. Catch-all domains
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-subdomains_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.16.2. Subdomains
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-tls_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.1.16.3. Transport layer security
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-multitenant-install_ossm-vs-istio" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.5.2. Multitenant installations
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.5.2. Multitenant installations"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.5.2. Multitenant installations"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-mt-vs-clusterwide_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.2.1. Multitenancy versus cluster-wide installations
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cluster-scoped-resources_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.2.2. Cluster scoped resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-kiali-service-mesh_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.3. Kiali and service mesh
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-jaeger-service-mesh_ossm-vs-istio" class="j-doc-nav__link ">
    1.5.4. Distributed tracing and service mesh
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#preparing-ossm-installation" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.6. Preparing to install Service Mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.6. Preparing to install Service Mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.6. Preparing to install Service Mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#prerequisites" class="j-doc-nav__link ">
    1.6.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-supported-configurations_preparing-ossm-installation" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.6.2. Supported configurations
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.6.2. Supported configurations"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.6.2. Supported configurations"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-supported-platforms_preparing-ossm-installation" class="j-doc-nav__link ">
    1.6.2.1. Supported platforms
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-unsupported-configurations_preparing-ossm-installation" class="j-doc-nav__link ">
    1.6.2.2. Unsupported configurations
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-supported-configurations-networks_preparing-ossm-installation" class="j-doc-nav__link ">
    1.6.2.3. Supported network configurations
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-supported-configurations-sm_preparing-ossm-installation" class="j-doc-nav__link ">
    1.6.2.4. Supported configurations for Service Mesh
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-supported-configurations-kiali_preparing-ossm-installation" class="j-doc-nav__link ">
    1.6.2.5. Supported configurations for Kiali
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-supported-configurations-jaeger_preparing-ossm-installation" class="j-doc-nav__link ">
    1.6.2.6. Supported configurations for Distributed Tracing
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-supported-configurations-webassembly_preparing-ossm-installation" class="j-doc-nav__link ">
    1.6.2.7. Supported WebAssembly module
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#next-steps-2" class="j-doc-nav__link ">
    1.6.3. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#installing-ossm" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.7. Installing the Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.7. Installing the Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.7. Installing the Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-installation-activities_installing-ossm" class="j-doc-nav__link ">
    1.7.1. Operator overview
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-install-ossm-operator_installing-ossm" class="j-doc-nav__link ">
    1.7.2. Installing the Operators
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-config-operator-infrastructure-node_installing-ossm" class="j-doc-nav__link ">
    1.7.3. Configuring the Service Mesh Operator to run on infrastructure nodes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-confirm-operator-infrastructure-node_installing-ossm" class="j-doc-nav__link ">
    1.7.4. Verifying the Service Mesh Operator is running on infrastructure node
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#next-steps-3" class="j-doc-nav__link ">
    1.7.5. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-create-smcp" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.8. Creating the ServiceMeshControlPlane
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.8. Creating the ServiceMeshControlPlane"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.8. Creating the ServiceMeshControlPlane"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-about-smcp_ossm-create-smcp" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.8.1. About ServiceMeshControlPlane
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.8.1. About ServiceMeshControlPlane"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.8.1. About ServiceMeshControlPlane"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-control-plane-deploy-operatorhub_ossm-create-smcp" class="j-doc-nav__link ">
    1.8.1.1. Deploying the Service Mesh control plane from the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-control-plane-deploy-cli_ossm-create-smcp" class="j-doc-nav__link ">
    1.8.1.2. Deploying the Service Mesh control plane using the CLI
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-validate-control-plane-cli_ossm-create-smcp" class="j-doc-nav__link ">
    1.8.1.3. Validating your SMCP installation with the CLI
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-about-control-plane-components-and-infrastructure-nodes_ossm-create-smcp" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.8.2. About control plane components and infrastructure nodes
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.8.2. About control plane components and infrastructure nodes"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.8.2. About control plane components and infrastructure nodes"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-config-control-plane-infrastructure-node-console_ossm-create-smcp" class="j-doc-nav__link ">
    1.8.2.1. Configuring all control plane components to run on infrastructure nodes using the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-config-individual-control-plane-infrastructure-node-console_ossm-create-smcp" class="j-doc-nav__link ">
    1.8.2.2. Configuring individual control plane components to run on infrastructure nodes using the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-config-control-plane-infrastructure-node-cli_ossm-create-smcp" class="j-doc-nav__link ">
    1.8.2.3. Configuring all control plane components to run on infrastructure nodes using the CLI
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-config-individual-control-plane-infrastructure-node-cli_ossm-create-smcp" class="j-doc-nav__link ">
    1.8.2.4. Configuring individual control plane components to run on infrastructure nodes using the CLI
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-confirm-smcp-infrastructure-node_ossm-create-smcp" class="j-doc-nav__link ">
    1.8.2.5. Verifying the Service Mesh control plane is running on infrastructure nodes
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-about-control-plane-and-cluster-wide-deployment_ossm-create-smcp" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.8.3. About control plane and cluster-wide deployments
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.8.3. About control plane and cluster-wide deployments"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.8.3. About control plane and cluster-wide deployments"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-deploy-cluster-wide-control-plane-console_ossm-create-smcp" class="j-doc-nav__link ">
    1.8.3.1. Configuring the control plane for cluster-wide deployment with the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-deploy-cluster-wide-control-plane-cli_ossm-create-smcp" class="j-doc-nav__link ">
    1.8.3.2. Configuring the control plane for cluster-wide deployment with the CLI
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-customize-smrr-cluster-wide_ossm-create-smcp" class="j-doc-nav__link ">
    1.8.3.3. Customizing the member roll for a cluster-wide mesh
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-validate-control-plane-kiali_ossm-create-smcp" class="j-doc-nav__link ">
    1.8.4. Validating your SMCP installation with Kiali
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-install-rosa_ossm-create-smcp" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.8.5. Installing on Red Hat OpenShift Service on AWS (ROSA)
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.8.5. Installing on Red Hat OpenShift Service on AWS (ROSA)"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.8.5. Installing on Red Hat OpenShift Service on AWS (ROSA)"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-install-rosa-location_ossm-create-smcp" class="j-doc-nav__link ">
    1.8.5.1. Installation location
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-install-rosa-smcp_ossm-create-smcp" class="j-doc-nav__link ">
    1.8.5.2. Required Service Mesh control plane configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-install-rosa-kiali-config_ossm-create-smcp" class="j-doc-nav__link ">
    1.8.5.3. Restrictions on Kiali configuration
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#additional-resources" class="j-doc-nav__link ">
    1.8.6. Additional resources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#next-steps-4" class="j-doc-nav__link ">
    1.8.7. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-create-mesh" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.9. Adding services to a service mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.9. Adding services to a service mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.9. Adding services to a service mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-about-adding-namespace_ossm-create-mesh" class="j-doc-nav__link ">
    1.9.1. About adding projects to a service mesh
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-member-roll-create_ossm-create-mesh" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.9.2. Creating the Red Hat OpenShift Service Mesh member roll
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.9.2. Creating the Red Hat OpenShift Service Mesh member roll"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.9.2. Creating the Red Hat OpenShift Service Mesh member roll"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-member-roll-create-console_ossm-create-mesh" class="j-doc-nav__link ">
    1.9.2.1. Creating the member roll from the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-member-roll-create-cli_ossm-create-mesh" class="j-doc-nav__link ">
    1.9.2.2. Creating the member roll from the CLI
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-about-adding-projects-using-smmr_ossm-create-mesh" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.9.3. About adding projects using the ServiceMeshMemberRoll resource
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.9.3. About adding projects using the ServiceMeshMemberRoll resource"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.9.3. About adding projects using the ServiceMeshMemberRoll resource"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-add-project-member-roll-recourse-console_ossm-create-mesh" class="j-doc-nav__link ">
    1.9.3.1. Adding or removing projects from the mesh using the ServiceMeshMemberRoll resource with the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-add-project-member-roll-resource-cli_ossm-create-mesh" class="j-doc-nav__link ">
    1.9.3.2. Adding or removing projects from the mesh using ServiceMeshMemberRoll resource with the CLI
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-about-adding-projects-using-smm_ossm-create-mesh" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.9.4. About adding projects using the ServiceMeshMember resource
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.9.4. About adding projects using the ServiceMeshMember resource"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.9.4. About adding projects using the ServiceMeshMember resource"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-adding-project-using-smm-resource-console_ossm-create-mesh" class="j-doc-nav__link ">
    1.9.4.1. Adding a project to the mesh using the ServiceMeshMember resource with the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-adding-project-using-smm-resource-cli_ossm-create-mesh" class="j-doc-nav__link ">
    1.9.4.2. Adding a project to the mesh using the ServiceMeshMember resource with the CLI
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-about-adding-projects-using-label-selectors_ossm-create-mesh" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.9.5. About adding projects using label selectors
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.9.5. About adding projects using label selectors"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.9.5. About adding projects using label selectors"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-adding-project-using-label-selectors-console_ossm-create-mesh" class="j-doc-nav__link ">
    1.9.5.1. Adding a project to the mesh using label selectors with the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-adding-project-using-label-selectors-cli_ossm-create-mesh" class="j-doc-nav__link ">
    1.9.5.2. Adding a project to the mesh using label selectors with the CLI
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-tutorial-bookinfo-overview_ossm-create-mesh" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.9.6. Bookinfo example application
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.9.6. Bookinfo example application"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.9.6. Bookinfo example application"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-tutorial-bookinfo-install_ossm-create-mesh" class="j-doc-nav__link ">
    1.9.6.1. Installing the Bookinfo application
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-tutorial-bookinfo-adding-destination-rules_ossm-create-mesh" class="j-doc-nav__link ">
    1.9.6.2. Adding default destination rules
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-tutorial-bookinfo-verify-install_ossm-create-mesh" class="j-doc-nav__link ">
    1.9.6.3. Verifying the Bookinfo installation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-tutorial-bookinfo-removing_ossm-create-mesh" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.9.6.4. Removing the Bookinfo application
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.9.6.4. Removing the Bookinfo application"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.9.6.4. Removing the Bookinfo application"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-delete-bookinfo-project_ossm-create-mesh" class="j-doc-nav__link ">
    1.9.6.4.1. Delete the Bookinfo project
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-remove-bookinfo-smmr_ossm-create-mesh" class="j-doc-nav__link ">
    1.9.6.4.2. Remove the Bookinfo project from the Service Mesh member roll
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#next-steps-5" class="j-doc-nav__link ">
    1.9.7. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#deploying-applications-ossm" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.10. Enabling sidecar injection
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.10. Enabling sidecar injection"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.10. Enabling sidecar injection"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#prerequisites-2" class="j-doc-nav__link ">
    1.10.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-automatic-sidecar-injection_deploying-applications-ossm" class="j-doc-nav__link ">
    1.10.2. Enabling automatic sidecar injection
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-validating-sidecar_deploying-applications-ossm" class="j-doc-nav__link ">
    1.10.3. Validating sidecar injection
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-sidecar-injection-env-var_deploying-applications-ossm" class="j-doc-nav__link ">
    1.10.4. Setting proxy environment variables through annotations
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-update-app-sidecar_deploying-applications-ossm" class="j-doc-nav__link ">
    1.10.5. Updating sidecar proxies
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#next-steps-6" class="j-doc-nav__link ">
    1.10.6. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#upgrading-ossm" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.11. Upgrading Service Mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.11. Upgrading Service Mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.11. Upgrading Service Mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-versioning_ossm-upgrade" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.11.1. Understanding versioning
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.11.1. Understanding versioning"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.11.1. Understanding versioning"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#how-versioning-affects-service-mesh-upgrades" class="j-doc-nav__link ">
    1.11.1.1. How versioning affects Service Mesh upgrades
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-versions_ossm-upgrade" class="j-doc-nav__link ">
    1.11.1.2. Understanding Service Mesh versions
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-upgrade-considerations_ossm-upgrade" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.11.2. Upgrade considerations
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.11.2. Upgrade considerations"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.11.2. Upgrade considerations"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-upgrade-known-issues_ossm-upgrade" class="j-doc-nav__link ">
    1.11.2.1. Known issues that may affect upgrade
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-upgrading-operator_ossm-upgrade" class="j-doc-nav__link ">
    1.11.3. Upgrading the Operators
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#upgrading-control-plane" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.11.4. Upgrading the control plane
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.11.4. Upgrading the control plane"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.11.4. Upgrading the control plane"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-upgrade-23-24-changes_ossm-upgrade" class="j-doc-nav__link ">
    1.11.4.1. Upgrade changes from version 2.3 to version 2.4
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-upgrade-22-23-changes_ossm-upgrade" class="j-doc-nav__link ">
    1.11.4.2. Upgrade changes from version 2.2 to version 2.3
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-upgrade-21-22-changes_ossm-upgrade" class="j-doc-nav__link ">
    1.11.4.3. Upgrade changes from version 2.1 to version 2.2
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-upgrade-20-21-changes_ossm-upgrade" class="j-doc-nav__link ">
    1.11.4.4. Upgrade changes from version 2.0 to version 2.1
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-upgrading-smcp_ossm-upgrade" class="j-doc-nav__link ">
    1.11.4.5. Upgrading the Service Mesh control plane
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-migrating-to-20_ossm-upgrade" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.11.4.6. Migrating Red Hat OpenShift Service Mesh from version 1.1 to version 2.0
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.11.4.6. Migrating Red Hat OpenShift Service Mesh from version 1.1 to version 2.0"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.11.4.6. Migrating Red Hat OpenShift Service Mesh from version 1.1 to version 2.0"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-migrating_ossm-upgrade" class="j-doc-nav__link ">
    1.11.4.6.1. Upgrading Red Hat OpenShift Service Mesh
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-migrating-smcp_ossm-upgrade" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.11.4.6.2. Configuring the 2.0 ServiceMeshControlPlane
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.11.4.6.2. Configuring the 2.0 ServiceMeshControlPlane"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.11.4.6.2. Configuring the 2.0 ServiceMeshControlPlane"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-migrating-differences-arch_ossm-upgrade" class="j-doc-nav__link ">
    1.11.4.6.2.1. Architecture changes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-migrating-differences-annotation_ossm-upgrade" class="j-doc-nav__link ">
    1.11.4.6.2.2. Annotation changes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-migrating-differences-behavior_ossm-upgrade" class="j-doc-nav__link ">
    1.11.4.6.2.3. Behavioral changes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-migrating-unsupported-resources_ossm-upgrade" class="j-doc-nav__link ">
    1.11.4.6.2.4. Migration details for unsupported resources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-migrating-mixer_ossm-upgrade" class="j-doc-nav__link ">
    1.11.4.6.2.5. Mixer plugins
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-migrating-mtls_ossm-upgrade" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.11.4.6.2.6. Mutual TLS changes
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.11.4.6.2.6. Mutual TLS changes"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.11.4.6.2.6. Mutual TLS changes"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#other-mtls-examples" class="j-doc-nav__link ">
    1.11.4.6.2.6.1. Other mTLS Examples
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-migrating-config-recipes_ossm-upgrade" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.11.4.6.3. Configuration recipes
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.11.4.6.3. Configuration recipes"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.11.4.6.3. Configuration recipes"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-migrating-config-mtls_ossm-upgrade" class="j-doc-nav__link ">
    1.11.4.6.3.1. Mutual TLS in a data plane
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-migrating-config-sign-key_ossm-upgrade" class="j-doc-nav__link ">
    1.11.4.6.3.2. Custom signing key
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-migrating-config-tracing_ossm-upgrade" class="j-doc-nav__link ">
    1.11.4.6.3.3. Tracing
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-migrating-config-vis_ossm-upgrade" class="j-doc-nav__link ">
    1.11.4.6.3.4. Visualization
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#resource-utilization-and-scheduling" class="j-doc-nav__link ">
    1.11.4.6.3.5. Resource utilization and scheduling
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-migrrating-apps_ossm-upgrade" class="j-doc-nav__link ">
    1.11.4.6.4. Next steps for migrating your applications and workloads
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#upgrading-data-plane" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.11.5. Upgrading the data plane
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.11.5. Upgrading the data plane"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.11.5. Upgrading the data plane"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-upgrading-apps-workloads_ossm-upgrade" class="j-doc-nav__link ">
    1.11.5.1. Updating your applications and workloads
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-profiles-users" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.12. Managing users and profiles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.12. Managing users and profiles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.12. Managing users and profiles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-members_ossm-profiles-users" class="j-doc-nav__link ">
    1.12.1. Creating the Red Hat OpenShift Service Mesh members
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-control-plane-profiles_ossm-profiles-users" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.12.2. Creating Service Mesh control plane profiles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.12.2. Creating Service Mesh control plane profiles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.12.2. Creating Service Mesh control plane profiles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-create-configmap_ossm-profiles-users" class="j-doc-nav__link ">
    1.12.2.1. Creating the ConfigMap
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-config-network-policy_ossm-profiles-users" class="j-doc-nav__link ">
    1.12.2.2. Setting the correct network policy
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-security" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.13. Security
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.13. Security"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.13. Security"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-security-mtls_ossm-security" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.13.1. About mutual Transport Layer Security (mTLS)
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.13.1. About mutual Transport Layer Security (mTLS)"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.13.1. About mutual Transport Layer Security (mTLS)"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-security-enabling-strict-mtls_ossm-security" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.13.1.1. Enabling strict mTLS across the service mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.13.1.1. Enabling strict mTLS across the service mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.13.1.1. Enabling strict mTLS across the service mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-security-mtls-sidecars-incoming-services_ossm-security" class="j-doc-nav__link ">
    1.13.1.1.1. Configuring sidecars for incoming connections for specific services
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-security-mtls-sidecars-outgoing_ossm-security" class="j-doc-nav__link ">
    1.13.1.1.2. Configuring sidecars for outgoing connections
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-security-min-max-tls_ossm-security" class="j-doc-nav__link ">
    1.13.1.1.3. Setting the minimum and maximum protocol versions
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-validating-sidecar_ossm-security" class="j-doc-nav__link ">
    1.13.1.2. Validating encryption with Kiali
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-vs-istio_ossm-security" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.13.2. Configuring Role Based Access Control (RBAC)
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.13.2. Configuring Role Based Access Control (RBAC)"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.13.2. Configuring Role Based Access Control (RBAC)"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#configure-intra-project-communication" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.13.2.1. Configure intra-project communication
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.13.2.1. Configure intra-project communication"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.13.2.1. Configure intra-project communication"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#restrict-access-to-services-outside-a-namespace" class="j-doc-nav__link ">
    1.13.2.1.1. Restrict access to services outside a namespace
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#creating-allow-all-and-default-deny-all-authorization-policies" class="j-doc-nav__link ">
    1.13.2.1.2. Creating allow-all and default deny-all authorization policies
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#allow-or-deny-access-to-the-ingress-gateway" class="j-doc-nav__link ">
    1.13.2.2. Allow or deny access to the ingress gateway
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#restrict-access-with-json-web-token" class="j-doc-nav__link ">
    1.13.2.3. Restrict access with JSON Web Token
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-security-cipher_ossm-security" class="j-doc-nav__link ">
    1.13.3. Configuring cipher suites and ECDH curves
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cert-manage_ossm-security" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.13.4. Adding an external certificate authority key and certificate
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.13.4. Adding an external certificate authority key and certificate"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.13.4. Adding an external certificate authority key and certificate"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cert-manage-add-cert-key_ossm-security" class="j-doc-nav__link ">
    1.13.4.1. Adding an existing certificate and key
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cert-manage-verify-cert_ossm-security" class="j-doc-nav__link ">
    1.13.4.2. Verifying your certificates
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cert-cleanup_ossm-security" class="j-doc-nav__link ">
    1.13.4.3. Removing the certificates
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cert-manager-integration-istio_ossm-security" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.13.5. About integrating Service Mesh with cert-manager and istio-csr
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.13.5. About integrating Service Mesh with cert-manager and istio-csr"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.13.5. About integrating Service Mesh with cert-manager and istio-csr"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cert-manager-installation_ossm-security" class="j-doc-nav__link ">
    1.13.5.1. Installing cert-manager
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#additional-resources_cert-manager-operator-red-hat-openshift" class="j-doc-nav__link ">
    1.13.6. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-traffic" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.14. Managing traffic in your service mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.14. Managing traffic in your service mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.14. Managing traffic in your service mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-gateways_traffic-management" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.14.1. Using gateways
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.14.1. Using gateways"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.14.1. Using gateways"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-automatic-gateway-injection_traffic-management" class="j-doc-nav__link ">
    1.14.1.1. Enabling gateway injection
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-deploying-automatic-gateway-injection_traffic-management" class="j-doc-nav__link ">
    1.14.1.2. Deploying automatic gateway injection
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-ingress_traffic-management" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.14.1.3. Managing ingress traffic
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.14.1.3. Managing ingress traffic"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.14.1.3. Managing ingress traffic"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-determine-ingress_traffic-management" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.14.1.3.1. Determining the ingress IP and ports
  </a>
                              <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.14.1.3.1. Determining the ingress IP and ports"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.14.1.3.1. Determining the ingress IP and ports"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-config-ig-lb_traffic-management" class="j-doc-nav__link ">
    1.14.1.3.1.1. Determining ingress ports with a load balancer
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-config-ig-no-lb_traffic-management" class="j-doc-nav__link ">
    1.14.1.3.1.2. Determining ingress ports without a load balancer
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-ingress-gateway_traffic-management" class="j-doc-nav__link ">
    1.14.1.4. Configuring an ingress gateway
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-auto-route_traffic-management" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.14.2. Understanding automatic routes
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.14.2. Understanding automatic routes"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.14.2. Understanding automatic routes"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-auto-route-subdomains_traffic-management" class="j-doc-nav__link ">
    1.14.2.1. Routes with subdomains
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-auto-route-create-subdomains_traffic-management" class="j-doc-nav__link ">
    1.14.2.2. Creating subdomain routes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-auto-route-annotations_traffic-management" class="j-doc-nav__link ">
    1.14.2.3. Route labels and annotations
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-auto-route-enable_traffic-management" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.14.2.4. Disabling automatic route creation
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.14.2.4. Disabling automatic route creation"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.14.2.4. Disabling automatic route creation"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#disabling-automatic-route-creation-specific-cases_traffic-management" class="j-doc-nav__link ">
    1.14.2.4.1. Disabling automatic route creation for specific cases
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#disabling-automatic-route-creation-all-cases_traffic-management" class="j-doc-nav__link ">
    1.14.2.4.2. Disabling automatic route creation for all cases
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-service-entries_traffic-management" class="j-doc-nav__link ">
    1.14.3. Understanding service entries
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-virtual-services_traffic-management" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.14.4. Using VirtualServices
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.14.4. Using VirtualServices"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.14.4. Using VirtualServices"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-vs_traffic-management" class="j-doc-nav__link ">
    1.14.4.1. Configuring VirtualServices
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#virtualservice-configuration-reference" class="j-doc-nav__link ">
    1.14.4.2. VirtualService configuration reference
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-destination-rules_traffic-management" class="j-doc-nav__link ">
    1.14.5. Understanding destination rules
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-understanding-networkpolicy_traffic-management" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.14.6. Understanding network policies
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.14.6. Understanding network policies"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.14.6. Understanding network policies"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-config-disable-networkpolicy_traffic-management" class="j-doc-nav__link ">
    1.14.6.1. Disabling automatic NetworkPolicy creation
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-sidecar_traffic-management" class="j-doc-nav__link ">
    1.14.7. Configuring sidecars for traffic management
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#routing-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.14.8. Routing Tutorial
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.14.8. Routing Tutorial"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.14.8. Routing Tutorial"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-bookinfo_traffic-management" class="j-doc-nav__link ">
    1.14.8.1. Bookinfo routing tutorial
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-bookinfo-applying_traffic-management" class="j-doc-nav__link ">
    1.14.8.2. Applying a virtual service
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-bookinfo-test_traffic-management" class="j-doc-nav__link ">
    1.14.8.3. Testing the new route configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-bookinfo-route_traffic-management" class="j-doc-nav__link ">
    1.14.8.4. Route based on user identity
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-observability" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.15. Metrics, logs, and traces
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.15. Metrics, logs, and traces"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.15. Metrics, logs, and traces"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-observability-addresses_observability" class="j-doc-nav__link ">
    1.15.1. Discovering console addresses
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-accessing-kiali-console_observability" class="j-doc-nav__link ">
    1.15.2. Accessing the Kiali console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-observability-visual_observability" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.15.3. Viewing service mesh data in the Kiali console
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.15.3. Viewing service mesh data in the Kiali console"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.15.3. Viewing service mesh data in the Kiali console"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-observability-topology_observability" class="j-doc-nav__link ">
    1.15.3.1. Changing graph layouts in Kiali
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-viewing-logs_observability" class="j-doc-nav__link ">
    1.15.3.2. Viewing logs in the Kiali console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-viewing-metrics_observability" class="j-doc-nav__link ">
    1.15.3.3. Viewing metrics in the Kiali console
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-overview-distr-tracing_observability" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.15.4. Distributed tracing
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.15.4. Distributed tracing"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.15.4. Distributed tracing"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-config-external-jaeger_observability" class="j-doc-nav__link ">
    1.15.4.1. Connecting an existing distributed tracing instance
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-config-sampling_observability" class="j-doc-nav__link ">
    1.15.4.2. Adjusting the sampling rate
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-accessing-jaeger-console_observability" class="j-doc-nav__link ">
    1.15.5. Accessing the Jaeger console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-access-grafana_observability" class="j-doc-nav__link ">
    1.15.6. Accessing the Grafana console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-access-prometheus_observability" class="j-doc-nav__link ">
    1.15.7. Accessing the Prometheus console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-integrating-with-user-workload-monitoring_observability" class="j-doc-nav__link ">
    1.15.8. Integrating with user-workload monitoring
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#additional-resources_user-workload-monitoring" class="j-doc-nav__link ">
    1.15.9. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-performance-scalability" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.16. Performance and scalability
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.16. Performance and scalability"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.16. Performance and scalability"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-recommended-resources_performance-scalability" class="j-doc-nav__link ">
    1.16.1. Setting limits on compute resources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-load-test-results_performance-scalability" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.16.2. Load test results
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.16.2. Load test results"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.16.2. Load test results"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#service-mesh-control-plane-performance" class="j-doc-nav__link ">
    1.16.2.1. Service Mesh Control plane performance
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#data-plane-performance" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.16.2.2. Data plane performance
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.16.2.2. Data plane performance"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.16.2.2. Data plane performance"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#cpu-and-memory-consumption" class="j-doc-nav__link ">
    1.16.2.2.1. CPU and memory consumption
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#additional-latency" class="j-doc-nav__link ">
    1.16.2.2.2. Additional latency
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-production" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.17. Configuring Service Mesh for production
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.17. Configuring Service Mesh for production"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.17. Configuring Service Mesh for production"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-smcp-prod_ossm-architecture" class="j-doc-nav__link ">
    1.17.1. Configuring your ServiceMeshControlPlane resource for production
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#additional-resources_ossm-production" class="j-doc-nav__link ">
    1.17.2. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.18. Connecting service meshes
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.18. Connecting service meshes"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.18. Connecting service meshes"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-overview_federation" class="j-doc-nav__link ">
    1.18.1. Federation overview
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-features_federation" class="j-doc-nav__link ">
    1.18.2. Federation features
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-security_federation" class="j-doc-nav__link ">
    1.18.3. Federation security
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-limitations_federation" class="j-doc-nav__link ">
    1.18.4. Federation limitations
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-prerequisites_federation" class="j-doc-nav__link ">
    1.18.5. Federation prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-planning_federation" class="j-doc-nav__link ">
    1.18.6. Planning your mesh federation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-across-clusters_federation" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.18.7. Mesh federation across clusters
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.18.7. Mesh federation across clusters"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.18.7. Mesh federation across clusters"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#exposing-the-federation-ingress-on-clusters-running-on-bare-metal" class="j-doc-nav__link ">
    1.18.7.1. Exposing the federation ingress on clusters running on bare metal
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#exposing-the-federation-ingress-on-clusters-running-on-ibm-power-and-ibm-z" class="j-doc-nav__link ">
    1.18.7.2. Exposing the federation ingress on clusters running on IBM Power and IBM Z
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#exposing-the-federation-ingress-on-amazon-web-services-aws" class="j-doc-nav__link ">
    1.18.7.3. Exposing the federation ingress on Amazon Web Services (AWS)
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#exposing-the-federation-ingress-on-azure" class="j-doc-nav__link ">
    1.18.7.4. Exposing the federation ingress on Azure
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#exposing-the-federation-ingress-on-google-cloud-platform-gcp" class="j-doc-nav__link ">
    1.18.7.5. Exposing the federation ingress on Google Cloud Platform (GCP)
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#con-my-concept-module-a_federation" class="j-doc-nav__link ">
    1.18.8. Federation implementation checklist
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-config-smcp_federation" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.18.9. Configuring a Service Mesh control plane for federation
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.18.9. Configuring a Service Mesh control plane for federation"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.18.9. Configuring a Service Mesh control plane for federation"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#understanding-federation-gateways" class="j-doc-nav__link ">
    1.18.9.1. Understanding federation gateways
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#understanding-federation-trust-domain-parameters" class="j-doc-nav__link ">
    1.18.9.2. Understanding federation trust domain parameters
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-joining_federation" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.18.10. Joining a federated mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.18.10. Joining a federated mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.18.10. Joining a federated mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-create-peer_federation" class="j-doc-nav__link ">
    1.18.10.1. Creating a ServiceMeshPeer resource
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-config-export_federation" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.18.11. Exporting a service from a federated mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.18.11. Exporting a service from a federated mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.18.11. Exporting a service from a federated mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-create-export_federation" class="j-doc-nav__link ">
    1.18.11.1. Creating an ExportedServiceSet
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-config-import_federation" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.18.12. Importing a service into a federated mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.18.12. Importing a service into a federated mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.18.12. Importing a service into a federated mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-create-import_federation" class="j-doc-nav__link ">
    1.18.12.1. Creating an ImportedServiceSet
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-config-failover-overview_federation" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.18.13. Configuring a federated mesh for failover
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.18.13. Configuring a federated mesh for failover"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.18.13. Configuring a federated mesh for failover"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-config-importedserviceset-failover_federation" class="j-doc-nav__link ">
    1.18.13.1. Configuring an ImportedServiceSet for failover
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-config-destinationrule-failover_federation" class="j-doc-nav__link ">
    1.18.13.2. Configuring a DestinationRule for failover
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-remove-service_federation" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.18.14. Removing a service from the federated mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.18.14. Removing a service from the federated mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.18.14. Removing a service from the federated mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#to-remove-a-service-from-a-single-mesh" class="j-doc-nav__link ">
    1.18.14.1. To remove a service from a single mesh
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#to-remove-a-service-from-the-entire-federated-mesh" class="j-doc-nav__link ">
    1.18.14.2. To remove a service from the entire federated mesh
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-federation-remove-mesh_federation" class="j-doc-nav__link ">
    1.18.15. Removing a mesh from the federated mesh
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-extensions" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.19. Extensions
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.19. Extensions"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.19. Extensions"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-extensions-overview_ossm-extensions" class="j-doc-nav__link ">
    1.19.1. WebAssembly modules overview
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-extensions-wasmplugin-format_ossm-extensions" class="j-doc-nav__link ">
    1.19.2. WasmPlugin container format
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-wasm-ref-wasmplugin_ossm-extensions" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.19.3. WasmPlugin API reference
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.19.3. WasmPlugin API reference"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.19.3. WasmPlugin API reference"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-wasmplugin-deploy_ossm-extensions" class="j-doc-nav__link ">
    1.19.3.1. Deploying WasmPlugin resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-extensions-smextension-format_ossm-extensions" class="j-doc-nav__link ">
    1.19.4. ServiceMeshExtension container format
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-wasm-ref-smextension_ossm-extensions" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.19.5. ServiceMeshExtension reference
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.19.5. ServiceMeshExtension reference"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.19.5. ServiceMeshExtension reference"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-smextensions-deploy_ossm-extensions" class="j-doc-nav__link ">
    1.19.5.1. Deploying ServiceMeshExtension resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-extensions-migration-overview_ossm-extensions" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.19.6. Migrating from ServiceMeshExtension to WasmPlugin resources
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.19.6. Migrating from ServiceMeshExtension to WasmPlugin resources"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.19.6. Migrating from ServiceMeshExtension to WasmPlugin resources"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-extensions-migration-api-changes_ossm-extensions" class="j-doc-nav__link ">
    1.19.6.1. API changes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-extensions-migration-format-changes_ossm-extensions" class="j-doc-nav__link ">
    1.19.6.2. Container image format changes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-extensions-migrating-to-wasmplugin_ossm-extensions" class="j-doc-nav__link ">
    1.19.6.3. Migrating to WasmPlugin resources
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-webassembly-module" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.20. Using the 3scale WebAssembly module
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.20. Using the 3scale WebAssembly module"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.20. Using the 3scale WebAssembly module"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#compatibility_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.1. Compatibility
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#usage-as-a-stand-alone-module_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.2. Usage as a stand-alone module
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#prerequisites_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.3. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-configuring-the-threescale-wasm-auth-module_ossm-threescale-webassembly-module" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.20.4. Configuring the threescale-wasm-auth module
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.20.4. Configuring the threescale-wasm-auth module"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.20.4. Configuring the threescale-wasm-auth module"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#the-wasmplugin-api-extension_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.4.1. The WasmPlugin API extension
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-applying-external-service-entry-objects_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.5. Applying 3scale external ServiceEntry objects
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-webassembly-module-configuration_ossm-threescale-webassembly-module" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.20.6. The 3scale WebAssembly module configuration
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.20.6. The 3scale WebAssembly module configuration"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.20.6. The 3scale WebAssembly module configuration"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#threescale-configuring-the-threescale-webassembly-module_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.6.1. Configuring the 3scale WebAssembly module
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-webassembly-module-api-object_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.6.2. The 3scale WebAssembly module api object
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-webassembly-module-system-object_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.6.3. The 3scale WebAssembly module system object
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-webassembly-module-upstream-object_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.6.4. The 3scale WebAssembly module upstream object
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-webassembly-module-backend-object_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.6.5. The 3scale WebAssembly module backend object
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-webassembly-module-services-object_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.6.6. The 3scale WebAssembly module services object
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-webassembly-module-credentials-object_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.6.7. The 3scale WebAssembly module credentials object
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-webassembly-module-lookup-queries_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.6.8. The 3scale WebAssembly module lookup queries
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-webassembly-module-source-object_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.6.9. The 3scale WebAssembly module source object
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-webassembly-module-operations-object_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.6.10. The 3scale WebAssembly module operations object
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-webassembly-module-mapping-rules-object_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.6.11. The 3scale WebAssembly module mapping_rules object
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-webassembly-module-mapping-rule-object_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.6.12. The 3scale WebAssembly module mapping_rule object
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-webassembly-module-examples-for-credentials-use-cases_ossm-threescale-webassembly-module" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.20.7. The 3scale WebAssembly module examples for credentials use cases
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.20.7. The 3scale WebAssembly module examples for credentials use cases"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.20.7. The 3scale WebAssembly module examples for credentials use cases"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#api-key-in-query-string-parameters_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.7.1. API key (user_key) in query string parameters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#application-id-and-key_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.7.2. Application ID and key
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#authorization-header_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.7.3. Authorization header
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#openid-connect-use-case_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.7.4. OpenID Connect (OIDC) use case
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#picking-up-the-jwt-token-from-a-header_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.7.5. Picking up the JWT token from a header
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-webassembly-module-minimal-working-configuration_ossm-threescale-webassembly-module" class="j-doc-nav__link ">
    1.20.8. 3scale WebAssembly module minimal working configuration
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#threescale-adapter" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.21. Using the 3scale Istio adapter
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.21. Using the 3scale Istio adapter"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.21. Using the 3scale Istio adapter"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-integrate_threescale-adapter" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.21.1. Integrate the 3scale adapter with Red Hat OpenShift Service Mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.21.1. Integrate the 3scale adapter with Red Hat OpenShift Service Mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.21.1. Integrate the 3scale adapter with Red Hat OpenShift Service Mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-cr_threescale-adapter" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.21.1.1. Generating 3scale custom resources
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.21.1.1. Generating 3scale custom resources"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.21.1.1. Generating 3scale custom resources"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-templates_threescale-adapter" class="j-doc-nav__link ">
    1.21.1.1.1. Generate templates from URL examples
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-manifests_threescale-adapter" class="j-doc-nav__link ">
    1.21.1.2. Generating manifests from a deployed adapter
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-routing_threescale-adapter" class="j-doc-nav__link ">
    1.21.1.3. Routing service traffic through the adapter
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-integration-settings_threescale-adapter" class="j-doc-nav__link ">
    1.21.2. Configure the integration settings in 3scale
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-caching_threescale-adapter" class="j-doc-nav__link ">
    1.21.3. Caching behavior
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-authentication_threescale-adapter" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.21.4. Authenticating requests
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.21.4. Authenticating requests"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.21.4. Authenticating requests"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-authentication-patterns_threescale-adapter" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.21.4.1. Applying authentication patterns
  </a>
                              <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.21.4.1. Applying authentication patterns"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.21.4.1. Applying authentication patterns"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-apikey-authentication_threescale-adapter" class="j-doc-nav__link ">
    1.21.4.1.1. API key authentication method
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-appidapikey-authentication_threescale-adapter" class="j-doc-nav__link ">
    1.21.4.1.2. Application ID and application key pair authentication method
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-openid-authentication_threescale-adapter" class="j-doc-nav__link ">
    1.21.4.1.3. OpenID authentication method
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-hybrid-authentication_threescale-adapter" class="j-doc-nav__link ">
    1.21.4.1.4. Hybrid authentication method
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-metrics_threescale-adapter" class="j-doc-nav__link ">
    1.21.5. 3scale Adapter metrics
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#threescale-backend-cache_threescale-adapter" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.21.6. 3scale backend cache
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.21.6. 3scale backend cache"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.21.6. 3scale backend cache"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#advantages-of-enabling-backend-cache" class="j-doc-nav__link ">
    1.21.6.1. Advantages of enabling backend cache
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#trade-offs-for-having-lower-latencies" class="j-doc-nav__link ">
    1.21.6.2. Trade-offs for having lower latencies
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#backend-cache-configuration-settings" class="j-doc-nav__link ">
    1.21.6.3. Backend cache configuration settings
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#threescale-istio-adapter-apicast_threescale-adapter" class="j-doc-nav__link ">
    1.21.7. 3scale Istio Adapter APIcast emulation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-istio-adapter-verification_threescale-adapter" class="j-doc-nav__link ">
    1.21.8. 3scale Istio adapter verification
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-istio-adapter-troubleshooting-checklist_threescale-adapter" class="j-doc-nav__link ">
    1.21.9. 3scale Istio adapter troubleshooting checklist
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-troubleshooting" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.22. Troubleshooting your service mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.22. Troubleshooting your service mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.22. Troubleshooting your service mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-versions_troubleshooting-ossm" class="j-doc-nav__link ">
    1.22.1. Understanding Service Mesh versions
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#troubleshooting-operator-installation" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.22.2. Troubleshooting Operator installation
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.22.2. Troubleshooting Operator installation"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.22.2. Troubleshooting Operator installation"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-validating-operators_troubleshooting-ossm" class="j-doc-nav__link ">
    1.22.2.1. Validating Operator installation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-troubleshooting-operators_troubleshooting-ossm" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.22.2.2. Troubleshooting service mesh Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.22.2.2. Troubleshooting service mesh Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.22.2.2. Troubleshooting service mesh Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#viewing-operator-pod-logs" class="j-doc-nav__link ">
    1.22.2.2.1. Viewing Operator pod logs
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#troubleshooting-the-control-plane" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.22.3. Troubleshooting the control plane
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.22.3. Troubleshooting the control plane"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.22.3. Troubleshooting the control plane"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-validating-smcp_troubleshooting-ossm" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.22.3.1. Validating the Service Mesh control plane installation
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.22.3.1. Validating the Service Mesh control plane installation"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.22.3.1. Validating the Service Mesh control plane installation"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-accessing-kiali-console_troubleshooting-ossm" class="j-doc-nav__link ">
    1.22.3.1.1. Accessing the Kiali console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-accessing-jaeger-console_troubleshooting-ossm" class="j-doc-nav__link ">
    1.22.3.1.2. Accessing the Jaeger console
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-troubleshooting-smcp_troubleshooting-ossm" class="j-doc-nav__link ">
    1.22.3.2. Troubleshooting the Service Mesh control plane
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#troubleshooting-the-data-plane" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.22.4. Troubleshooting the data plane
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.22.4. Troubleshooting the data plane"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.22.4. Troubleshooting the data plane"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-troubleshooting-injection_troubleshooting-ossm" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.22.4.1. Troubleshooting sidecar injection
  </a>
                              <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.22.4.1. Troubleshooting sidecar injection"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.22.4.1. Troubleshooting sidecar injection"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#troubleshooting-istio-sidecar-injection" class="j-doc-nav__link ">
    1.22.4.1.1. Troubleshooting Istio sidecar injection
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#troubleshooting-jaeger-agent-sidecar-injection" class="j-doc-nav__link ">
    1.22.4.1.2. Troubleshooting Jaeger agent sidecar injection
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-troubleshooting-proxy_troubleshooting-ossm" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.23. Troubleshooting Envoy proxy
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.23. Troubleshooting Envoy proxy"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.23. Troubleshooting Envoy proxy"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#enabling-envoy-access-logs" class="j-doc-nav__link ">
    1.23.1. Enabling Envoy access logs
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#support_troubleshooting-ossm" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.23.2. Getting support
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.23.2. Getting support"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.23.2. Getting support"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#support-knowledgebase-about_troubleshooting-ossm" class="j-doc-nav__link ">
    1.23.2.1. About the Red Hat Knowledgebase
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#support-knowledgebase-search_troubleshooting-ossm" class="j-doc-nav__link ">
    1.23.2.2. Searching the Red Hat Knowledgebase
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-about-collecting-ossm-data_troubleshooting-ossm" class="j-doc-nav__link ">
    1.23.2.3. About collecting service mesh data
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#support-submitting-a-case_troubleshooting-ossm" class="j-doc-nav__link ">
    1.23.2.4. Submitting a support case
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-reference" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.24. Service Mesh control plane configuration reference
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.24. Service Mesh control plane configuration reference"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.24. Service Mesh control plane configuration reference"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cr-example_ossm-reference" class="j-doc-nav__link ">
    1.24.1. Service Mesh Control plane parameters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#spec-parameters" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.24.2. spec parameters
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.24.2. spec parameters"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.24.2. spec parameters"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cr-general_ossm-reference" class="j-doc-nav__link ">
    1.24.2.1. general parameters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cr-profiles_ossm-reference" class="j-doc-nav__link ">
    1.24.2.2. profiles parameters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cr-techPreview_ossm-reference" class="j-doc-nav__link ">
    1.24.2.3. techPreview parameters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cr-tracing_ossm-reference" class="j-doc-nav__link ">
    1.24.2.4. tracing parameters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cr-version_ossm-reference" class="j-doc-nav__link ">
    1.24.2.5. version parameter
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cr-threescale_ossm-reference" class="j-doc-nav__link ">
    1.24.2.6. 3scale configuration
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cr-status_ossm-reference" class="j-doc-nav__link ">
    1.24.3. status parameter
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#additional-resources_ossm-reference" class="j-doc-nav__link ">
    1.24.4. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#kiali-config-ref" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.25. Kiali configuration reference
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.25. Kiali configuration reference"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.25. Kiali configuration reference"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-smcp-kiali_kiali-config-ref" class="j-doc-nav__link ">
    1.25.1. Specifying Kiali configuration in the SMCP
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-specifying-external-kiali_kiali-config-ref" class="j-doc-nav__link ">
    1.25.2. Specifying Kiali configuration in a Kiali custom resource
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#jaeger-config-ref" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.26. Jaeger configuration reference
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.26. Jaeger configuration reference"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.26. Jaeger configuration reference"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-enabling-tracing_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.1. Enabling and disabling tracing
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-specifying-jaeger-configuration_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.2. Specifying Jaeger configuration in the SMCP
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-deploying-jaeger_jaeger-config-reference" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.26.3. Deploying the distributed tracing platform
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.26.3. Deploying the distributed tracing platform"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.26.3. Deploying the distributed tracing platform"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-deploying-jaeger-default_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.3.1. Default distributed tracing platform (Jaeger) deployment
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-deploying-jaeger-production-min_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.3.2. Production distributed tracing platform (Jaeger) deployment (minimal)
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-deploying-jaeger-production_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.3.3. Production distributed tracing platform (Jaeger) deployment (fully customized)
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-deploying-jaeger-streaming_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.3.4. Streaming Jaeger deployment
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-specifying-external-jaeger_jaeger-config-reference" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.26.4. Specifying Jaeger configuration in a Jaeger custom resource
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.26.4. Specifying Jaeger configuration in a Jaeger custom resource"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.26.4. Specifying Jaeger configuration in a Jaeger custom resource"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-deployment-best-practices_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.4.1. Deployment best practices
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-config-security-ossm_jaeger-config-reference" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.26.4.2. Configuring distributed tracing security for service mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.26.4.2. Configuring distributed tracing security for service mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.26.4.2. Configuring distributed tracing security for service mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-config-security-ossm-web_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.4.2.1. Configuring distributed tracing security for service mesh from the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-config-security-ossm-cli_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.4.2.2. Configuring distributed tracing security for service mesh from the command line
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-config-default_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.4.3. Distributed tracing default configuration options
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-config-jaeger-collector_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.4.4. Jaeger Collector configuration options
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-config-sampling_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.4.5. Distributed tracing sampling configuration options
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-config-storage_jaeger-config-reference" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.26.4.6. Distributed tracing storage configuration options
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.26.4.6. Distributed tracing storage configuration options"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.26.4.6. Distributed tracing storage configuration options"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distributed-tracing-config-auto-provisioning-es_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.4.6.1. Auto-provisioning an Elasticsearch instance
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distributed-tracing-config-external-es_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.4.6.2. Connecting to an existing Elasticsearch instance
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-manage-es-certificates_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.4.7. Managing certificates with Elasticsearch
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-config-query_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.4.8. Query configuration options
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-config-ingester_jaeger-config-reference" class="j-doc-nav__link ">
    1.26.4.9. Ingester configuration options
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#removing-ossm" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.27. Uninstalling Service Mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.27. Uninstalling Service Mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.27. Uninstalling Service Mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-control-plane-remove_removing-ossm" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.27.1. Removing the Red Hat OpenShift Service Mesh control plane
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.27.1. Removing the Red Hat OpenShift Service Mesh control plane"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.27.1. Removing the Red Hat OpenShift Service Mesh control plane"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-control-plane-remove-operatorhub_removing-ossm" class="j-doc-nav__link ">
    1.27.1.1. Removing the Service Mesh control plane using the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-control-plane-remove-cli_removing-ossm" class="j-doc-nav__link ">
    1.27.1.2. Removing the Service Mesh control plane using the CLI
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-operatorhub-remove-operators_removing-ossm" class="j-doc-nav__link j-doc-nav__link--has-children">
    1.27.2. Removing the installed Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1.27.2. Removing the installed Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1.27.2. Removing the installed Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-remove-operator-servicemesh_removing-ossm" class="j-doc-nav__link ">
    1.27.2.1. Removing the Operators
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-remove-cleanup_removing-ossm" class="j-doc-nav__link ">
    1.27.3. Clean up Operator resources
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#service-mesh-1-x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2. Service Mesh 1.x
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2. Service Mesh 1.x"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2. Service Mesh 1.x"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#service-mesh-release-notes-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1. Service Mesh Release Notes
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1. Service Mesh Release Notes"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1. Service Mesh Release Notes"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#making-open-source-more-inclusive" class="j-doc-nav__link ">
    2.1.1. Making open source more inclusive
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-servicemesh-overview_ossm-release-notes-v1x" class="j-doc-nav__link ">
    2.1.2. Introduction to Red Hat OpenShift Service Mesh
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#support_ossm-release-notes-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1.3. Getting support
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1.3. Getting support"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1.3. Getting support"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#about-must-gather_ossm-release-notes-v1x" class="j-doc-nav__link ">
    2.1.3.1. About the must-gather tool
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#prerequisites-3" class="j-doc-nav__link ">
    2.1.3.2. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-about-collecting-ossm-data_ossm-release-notes-v1x" class="j-doc-nav__link ">
    2.1.3.3. About collecting service mesh data
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-supported-configurations-v1x_ossm-release-notes-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1.4. Red Hat OpenShift Service Mesh supported configurations
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1.4. Red Hat OpenShift Service Mesh supported configurations"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1.4. Red Hat OpenShift Service Mesh supported configurations"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-supported-configurations-kiali_ossm-release-notes-v1x" class="j-doc-nav__link ">
    2.1.4.1. Supported configurations for Kiali on Red Hat OpenShift Service Mesh
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-supported-configurations-adapters_ossm-release-notes-v1x" class="j-doc-nav__link ">
    2.1.4.2. Supported Mixer adapters
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-rn-new-features-1x_ossm-release-notes-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1.5. New Features
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1.5. New Features"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1.5. New Features"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-18-2" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1.5.1. New features Red Hat OpenShift Service Mesh 1.1.18.2
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1.5.1. New features Red Hat OpenShift Service Mesh 1.1.18.2"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1.5.1. New features Red Hat OpenShift Service Mesh 1.1.18.2"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-1-1-18-2" class="j-doc-nav__link ">
    2.1.5.1.1. Component versions included in Red Hat OpenShift Service Mesh version 1.1.18.2
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-18-1" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1.5.2. New features Red Hat OpenShift Service Mesh 1.1.18.1
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1.5.2. New features Red Hat OpenShift Service Mesh 1.1.18.1"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1.5.2. New features Red Hat OpenShift Service Mesh 1.1.18.1"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-1-1-18-1" class="j-doc-nav__link ">
    2.1.5.2.1. Component versions included in Red Hat OpenShift Service Mesh version 1.1.18.1
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-18" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1.5.3. New features Red Hat OpenShift Service Mesh 1.1.18
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1.5.3. New features Red Hat OpenShift Service Mesh 1.1.18"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1.5.3. New features Red Hat OpenShift Service Mesh 1.1.18"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#component-versions-included-in-red-hat-openshift-service-mesh-version-1-1-18" class="j-doc-nav__link ">
    2.1.5.3.1. Component versions included in Red Hat OpenShift Service Mesh version 1.1.18
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-17-1" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1.5.4. New features Red Hat OpenShift Service Mesh 1.1.17.1
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1.5.4. New features Red Hat OpenShift Service Mesh 1.1.17.1"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1.5.4. New features Red Hat OpenShift Service Mesh 1.1.17.1"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#change-in-how-red-hat-openshift-service-mesh-handles-uri-fragments-2" class="j-doc-nav__link ">
    2.1.5.4.1. Change in how Red Hat OpenShift Service Mesh handles URI fragments
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#required-update-for-authorization-policies-2" class="j-doc-nav__link ">
    2.1.5.4.2. Required update for authorization policies
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-17" class="j-doc-nav__link ">
    2.1.5.5. New features Red Hat OpenShift Service Mesh 1.1.17
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-16" class="j-doc-nav__link ">
    2.1.5.6. New features Red Hat OpenShift Service Mesh 1.1.16
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-15" class="j-doc-nav__link ">
    2.1.5.7. New features Red Hat OpenShift Service Mesh 1.1.15
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-14" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1.5.8. New features Red Hat OpenShift Service Mesh 1.1.14
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1.5.8. New features Red Hat OpenShift Service Mesh 1.1.14"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1.5.8. New features Red Hat OpenShift Service Mesh 1.1.14"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#manual-updates-cve-2021-29492_ossm-release-notes-v1x" class="j-doc-nav__link ">
    2.1.5.8.1. Manual updates required by CVE-2021-29492 and CVE-2021-31920
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#updating-the-path-normalization-configuration-2" class="j-doc-nav__link ">
    2.1.5.8.2. Updating the path normalization configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#path-normalization-configuration-examples-2" class="j-doc-nav__link ">
    2.1.5.8.3. Path normalization configuration examples
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#configuring-your-smcp-for-path-normalization-2" class="j-doc-nav__link ">
    2.1.5.8.4. Configuring your SMCP for path normalization
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-13" class="j-doc-nav__link ">
    2.1.5.9. New features Red Hat OpenShift Service Mesh 1.1.13
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-12" class="j-doc-nav__link ">
    2.1.5.10. New features Red Hat OpenShift Service Mesh 1.1.12
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-11" class="j-doc-nav__link ">
    2.1.5.11. New features Red Hat OpenShift Service Mesh 1.1.11
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-10" class="j-doc-nav__link ">
    2.1.5.12. New features Red Hat OpenShift Service Mesh 1.1.10
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-9" class="j-doc-nav__link ">
    2.1.5.13. New features Red Hat OpenShift Service Mesh 1.1.9
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-8" class="j-doc-nav__link ">
    2.1.5.14. New features Red Hat OpenShift Service Mesh 1.1.8
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-7" class="j-doc-nav__link ">
    2.1.5.15. New features Red Hat OpenShift Service Mesh 1.1.7
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-6" class="j-doc-nav__link ">
    2.1.5.16. New features Red Hat OpenShift Service Mesh 1.1.6
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-5" class="j-doc-nav__link ">
    2.1.5.17. New features Red Hat OpenShift Service Mesh 1.1.5
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-4" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1.5.18. New features Red Hat OpenShift Service Mesh 1.1.4
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1.5.18. New features Red Hat OpenShift Service Mesh 1.1.4"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1.5.18. New features Red Hat OpenShift Service Mesh 1.1.4"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#manual-updates-cve-2020-8663_ossm-release-notes-v1x" class="j-doc-nav__link ">
    2.1.5.18.1. Manual updates required by CVE-2020-8663
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#upgrading_es5_es6_ossm-release-notes-v1x" class="j-doc-nav__link ">
    2.1.5.18.2. Upgrading from Elasticsearch 5 to Elasticsearch 6
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-3" class="j-doc-nav__link ">
    2.1.5.19. New features Red Hat OpenShift Service Mesh 1.1.3
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-2" class="j-doc-nav__link ">
    2.1.5.20. New features Red Hat OpenShift Service Mesh 1.1.2
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-1" class="j-doc-nav__link ">
    2.1.5.21. New features Red Hat OpenShift Service Mesh 1.1.1
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#new-features-red-hat-openshift-service-mesh-1-1-0" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1.5.22. New features Red Hat OpenShift Service Mesh 1.1.0
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1.5.22. New features Red Hat OpenShift Service Mesh 1.1.0"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1.5.22. New features Red Hat OpenShift Service Mesh 1.1.0"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-manual-updates-1.0-1.1_ossm-release-notes-v1x" class="j-doc-nav__link ">
    2.1.5.22.1. Manual updates from 1.0 to 1.1
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-deprecated-features-1x_ossm-release-notes-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1.6. Deprecated features
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1.6. Deprecated features"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1.6. Deprecated features"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#deprecated-features-red-hat-openshift-service-mesh-1-1-5" class="j-doc-nav__link ">
    2.1.6.1. Deprecated features Red Hat OpenShift Service Mesh 1.1.5
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-rn-known-issues-1x_ossm-release-notes-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1.7. Known issues
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1.7. Known issues"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1.7. Known issues"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-rn-known-issues-ossm_ossm-release-notes-v1x" class="j-doc-nav__link ">
    2.1.7.1. Service Mesh known issues
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-rn-known-issues-kiali_ossm-release-notes-v1x" class="j-doc-nav__link ">
    2.1.7.2. Kiali known issues
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-rn-fixed-issues-1x_ossm-release-notes-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1.8. Fixed issues
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1.8. Fixed issues"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1.8. Fixed issues"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-rn-fixed-issues-ossm_ossm-release-notes-v1x" class="j-doc-nav__link ">
    2.1.8.1. Service Mesh fixed issues
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-rn-fixed-issues-kiali_ossm-release-notes-v1x" class="j-doc-nav__link ">
    2.1.8.2. Kiali fixed issues
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-architecture-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.2. Understanding Service Mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.2. Understanding Service Mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.2. Understanding Service Mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-understanding-service-mesh_ossm-architecture-v1x" class="j-doc-nav__link ">
    2.2.1. Understanding service mesh
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-architecture-1x_ossm-architecture-v1x" class="j-doc-nav__link ">
    2.2.2. Red Hat OpenShift Service Mesh Architecture
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#understanding-kiali-2" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.2.3. Understanding Kiali
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.2.3. Understanding Kiali"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.2.3. Understanding Kiali"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-kiali-overview_ossm-architecture-v1x" class="j-doc-nav__link ">
    2.2.3.1. Kiali overview
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-kiali-architecture_ossm-architecture-v1x" class="j-doc-nav__link ">
    2.2.3.2. Kiali architecture
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-kiali-features_ossm-architecture-v1x" class="j-doc-nav__link ">
    2.2.3.3. Kiali features
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#understanding-jaeger" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.2.4. Understanding Jaeger
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.2.4. Understanding Jaeger"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.2.4. Understanding Jaeger"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-product-overview_ossm-architecture-v1x" class="j-doc-nav__link ">
    2.2.4.1. Distributed tracing overview
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#jaeger-architecture_ossm-architecture-v1x" class="j-doc-nav__link ">
    2.2.4.2. Distributed tracing architecture
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-features_ossm-architecture-v1x" class="j-doc-nav__link ">
    2.2.4.3. Red Hat OpenShift distributed tracing platform features
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#next-steps-7" class="j-doc-nav__link ">
    2.2.5. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-vs-community-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.3. Service Mesh and Istio differences
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.3. Service Mesh and Istio differences"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.3. Service Mesh and Istio differences"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-multitenant-install_ossm-vs-istio-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.3.1. Multitenant installations
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.3.1. Multitenant installations"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.3.1. Multitenant installations"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-mt-vs-clusterwide_ossm-vs-istio-v1x" class="j-doc-nav__link ">
    2.3.1.1. Multitenancy versus cluster-wide installations
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cluster-scoped-resources_ossm-vs-istio-v1x" class="j-doc-nav__link ">
    2.3.1.2. Cluster scoped resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-vs-istio_ossm-vs-istio-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.3.2. Differences between Istio and Red Hat OpenShift Service Mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.3.2. Differences between Istio and Red Hat OpenShift Service Mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.3.2. Differences between Istio and Red Hat OpenShift Service Mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cli-tool_ossm-vs-istio-v1x" class="j-doc-nav__link ">
    2.3.2.1. Command line tool
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-automatic-injection_ossm-vs-istio-v1x" class="j-doc-nav__link ">
    2.3.2.2. Automatic injection
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-rbac_ossm-vs-istio-v1x" class="j-doc-nav__link ">
    2.3.2.3. Istio Role Based Access Control features
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-openssl_ossm-vs-istio-v1x" class="j-doc-nav__link ">
    2.3.2.4. OpenSSL
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-component-modifications_ossm-vs-istio-v1x" class="j-doc-nav__link ">
    2.3.2.5. Component modifications
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-envoy-sds-ca_ossm-vs-istio-v1x" class="j-doc-nav__link ">
    2.3.2.6. Envoy, Secret Discovery Service, and certificates
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cni_ossm-vs-istio-v1x" class="j-doc-nav__link ">
    2.3.2.7. Istio Container Network Interface (CNI) plugin
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routes-gateways_ossm-vs-istio-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.3.2.8. Routes for Istio Gateways
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.3.2.8. Routes for Istio Gateways"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.3.2.8. Routes for Istio Gateways"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-catch-all-domains_ossm-vs-istio-v1x" class="j-doc-nav__link ">
    2.3.2.8.1. Catch-all domains
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-subdomains_ossm-vs-istio-v1x" class="j-doc-nav__link ">
    2.3.2.8.2. Subdomains
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-tls_ossm-vs-istio-v1x" class="j-doc-nav__link ">
    2.3.2.8.3. Transport layer security
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-kiali-service-mesh_ossm-vs-istio-v1x" class="j-doc-nav__link ">
    2.3.3. Kiali and service mesh
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-jaeger-service-mesh_ossm-vs-istio-v1x" class="j-doc-nav__link ">
    2.3.4. Distributed tracing and service mesh
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#preparing-ossm-installation-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4. Preparing to install Service Mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4. Preparing to install Service Mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4. Preparing to install Service Mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#prerequisites-4" class="j-doc-nav__link ">
    2.4.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-supported-configurations-v1x_preparing-ossm-installation-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.2. Red Hat OpenShift Service Mesh supported configurations
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.2. Red Hat OpenShift Service Mesh supported configurations"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.2. Red Hat OpenShift Service Mesh supported configurations"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-supported-configurations-kiali_preparing-ossm-installation-v1x" class="j-doc-nav__link ">
    2.4.2.1. Supported configurations for Kiali on Red Hat OpenShift Service Mesh
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-supported-configurations-adapters_preparing-ossm-installation-v1x" class="j-doc-nav__link ">
    2.4.2.2. Supported Mixer adapters
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-installation-activities_preparing-ossm-installation-v1x" class="j-doc-nav__link ">
    2.4.3. Operator overview
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#next-steps-8" class="j-doc-nav__link ">
    2.4.4. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#installing-ossm-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5. Installing Service Mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5. Installing Service Mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5. Installing Service Mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#prerequisites-5" class="j-doc-nav__link ">
    2.5.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-operator-install-elasticsearch_installing-ossm-v1x" class="j-doc-nav__link ">
    2.5.2. Installing the OpenShift Elasticsearch Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#distr-tracing-jaeger-operator-install_installing-ossm-v1x" class="j-doc-nav__link ">
    2.5.3. Installing the Red Hat OpenShift distributed tracing platform (Jaeger) Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-install-kiali_installing-ossm-v1x" class="j-doc-nav__link ">
    2.5.4. Installing the Kiali Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-install-ossm-operator_installing-ossm-v1x" class="j-doc-nav__link ">
    2.5.5. Installing the Operators
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-control-plane-deploy-1x_installing-ossm-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5.6. Deploying the Red Hat OpenShift Service Mesh control plane
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5.6. Deploying the Red Hat OpenShift Service Mesh control plane"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5.6. Deploying the Red Hat OpenShift Service Mesh control plane"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-control-plane-deploy-operatorhub_installing-ossm-v1x" class="j-doc-nav__link ">
    2.5.6.1. Deploying the control plane from the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-control-plane-deploy-cli_installing-ossm-v1x" class="j-doc-nav__link ">
    2.5.6.2. Deploying the control plane from the CLI
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-member-roll-create_installing-ossm-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5.7. Creating the Red Hat OpenShift Service Mesh member roll
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5.7. Creating the Red Hat OpenShift Service Mesh member roll"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5.7. Creating the Red Hat OpenShift Service Mesh member roll"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-member-roll-create-console_installing-ossm-v1x" class="j-doc-nav__link ">
    2.5.7.1. Creating the member roll from the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-member-roll-create-cli_installing-ossm-v1x" class="j-doc-nav__link ">
    2.5.7.2. Creating the member roll from the CLI
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-member-roll-modify_installing-ossm-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5.8. Adding or removing projects from the service mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5.8. Adding or removing projects from the service mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5.8. Adding or removing projects from the service mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-member-roll-modify-console_installing-ossm-v1x" class="j-doc-nav__link ">
    2.5.8.1. Adding or removing projects from the member roll using the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-member-roll-modify-cli_installing-ossm-v1x" class="j-doc-nav__link ">
    2.5.8.2. Adding or removing projects from the member roll using the CLI
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#manual-updates" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5.9. Manual updates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5.9. Manual updates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5.9. Manual updates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-update-app-sidecar_installing-ossm-v1x" class="j-doc-nav__link ">
    2.5.9.1. Updating sidecar proxies
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#next-steps-9" class="j-doc-nav__link ">
    2.5.10. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-security-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.6. Customizing security in a Service Mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.6. Customizing security in a Service Mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.6. Customizing security in a Service Mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-security-mtls_ossm-security-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.6.1. Enabling mutual Transport Layer Security (mTLS)
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.6.1. Enabling mutual Transport Layer Security (mTLS)"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.6.1. Enabling mutual Transport Layer Security (mTLS)"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-security-enabling-strict-mtls_ossm-security-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.6.1.1. Enabling strict mTLS across the mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.6.1.1. Enabling strict mTLS across the mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.6.1.1. Enabling strict mTLS across the mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-security-mtls-sidecars-incoming-services_ossm-security-v1x" class="j-doc-nav__link ">
    2.6.1.1.1. Configuring sidecars for incoming connections for specific services
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-security-mtls-sidecars-outgoing_ossm-security-v1x" class="j-doc-nav__link ">
    2.6.1.2. Configuring sidecars for outgoing connections
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-security-min-max-tls_ossm-security-v1x" class="j-doc-nav__link ">
    2.6.1.3. Setting the minimum and maximum protocol versions
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-security-cipher-1x_ossm-security-v1x" class="j-doc-nav__link ">
    2.6.2. Configuring cipher suites and ECDH curves
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cert-manage-1x_ossm-security-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.6.3. Adding an external certificate authority key and certificate
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.6.3. Adding an external certificate authority key and certificate"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.6.3. Adding an external certificate authority key and certificate"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cert-manage-add-cert-key-1x_ossm-security-v1x" class="j-doc-nav__link ">
    2.6.3.1. Adding an existing certificate and key
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cert-manage-verify-cert-1x_ossm-security-v1x" class="j-doc-nav__link ">
    2.6.3.2. Verifying your certificates
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cert-cleanup-1x_ossm-security-v1x" class="j-doc-nav__link ">
    2.6.3.3. Removing the certificates
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-traffic-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.7. Traffic management
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.7. Traffic management"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.7. Traffic management"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-gateways_routing-traffic-v1x" class="j-doc-nav__link ">
    2.7.1. Using gateways
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-ingress-gateway_routing-traffic-v1x" class="j-doc-nav__link ">
    2.7.2. Configuring an ingress gateway
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-ingress_routing-traffic-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.7.3. Managing ingress traffic
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.7.3. Managing ingress traffic"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.7.3. Managing ingress traffic"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-determine-ingress_routing-traffic-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.7.3.1. Determining the ingress IP and ports
  </a>
                              <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.7.3.1. Determining the ingress IP and ports"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.7.3.1. Determining the ingress IP and ports"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-config-ig-lb_routing-traffic-v1x" class="j-doc-nav__link ">
    2.7.3.1.1. Determining ingress ports with a load balancer
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-config-ig-no-lb_routing-traffic-v1x" class="j-doc-nav__link ">
    2.7.3.1.2. Determining ingress ports without a load balancer
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-auto-route-1x_routing-traffic-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.7.4. Automatic route creation
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.7.4. Automatic route creation"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.7.4. Automatic route creation"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-auto-route-enable_routing-traffic-v1x" class="j-doc-nav__link ">
    2.7.4.1. Enabling Automatic Route Creation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-auto-route-subdomains_routing-traffic-v1x" class="j-doc-nav__link ">
    2.7.4.2. Subdomains
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-service-entries_routing-traffic-v1x" class="j-doc-nav__link ">
    2.7.5. Understanding service entries
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-virtual-services_routing-traffic-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.7.6. Using VirtualServices
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.7.6. Using VirtualServices"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.7.6. Using VirtualServices"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-vs_routing-traffic-v1x" class="j-doc-nav__link ">
    2.7.6.1. Configuring VirtualServices
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#virtualservice-configuration-reference-2" class="j-doc-nav__link ">
    2.7.6.2. VirtualService configuration reference
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-destination-rules_routing-traffic-v1x" class="j-doc-nav__link ">
    2.7.7. Understanding destination rules
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-bookinfo_routing-traffic-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.7.8. Bookinfo routing tutorial
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.7.8. Bookinfo routing tutorial"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.7.8. Bookinfo routing tutorial"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-bookinfo-applying_routing-traffic-v1x" class="j-doc-nav__link ">
    2.7.8.1. Applying a virtual service
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-bookinfo-test_routing-traffic-v1x" class="j-doc-nav__link ">
    2.7.8.2. Testing the new route configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-routing-bookinfo-route_routing-traffic-v1x" class="j-doc-nav__link ">
    2.7.8.3. Route based on user identity
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#additional-resources-2" class="j-doc-nav__link ">
    2.7.9. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#deploying-applications-ossm-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.8. Deploying applications on Service Mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.8. Deploying applications on Service Mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.8. Deploying applications on Service Mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#prerequisites-6" class="j-doc-nav__link ">
    2.8.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-control-plane-templates-1x_deploying-applications-ossm-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.8.2. Creating control plane templates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.8.2. Creating control plane templates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.8.2. Creating control plane templates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-create-configmap_deploying-applications-ossm-v1x" class="j-doc-nav__link ">
    2.8.2.1. Creating the ConfigMap
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-automatic-sidecar-injection_deploying-applications-ossm-v1x" class="j-doc-nav__link ">
    2.8.3. Enabling automatic sidecar injection
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-sidecar-injection-env-var_deploying-applications-ossm-v1x" class="j-doc-nav__link ">
    2.8.4. Setting proxy environment variables through annotations
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-mixer-policy-1x_deploying-applications-ossm-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.8.5. Updating Mixer policy enforcement
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.8.5. Updating Mixer policy enforcement"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.8.5. Updating Mixer policy enforcement"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-config-network-policy_deploying-applications-ossm-v1x" class="j-doc-nav__link ">
    2.8.5.1. Setting the correct network policy
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-tutorial-bookinfo-overview_deploying-applications-ossm-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.8.6. Bookinfo example application
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.8.6. Bookinfo example application"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.8.6. Bookinfo example application"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-tutorial-bookinfo-install_deploying-applications-ossm-v1x" class="j-doc-nav__link ">
    2.8.6.1. Installing the Bookinfo application
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-tutorial-bookinfo-adding-destination-rules_deploying-applications-ossm-v1x" class="j-doc-nav__link ">
    2.8.6.2. Adding default destination rules
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-tutorial-bookinfo-verify-install_deploying-applications-ossm-v1x" class="j-doc-nav__link ">
    2.8.6.3. Verifying the Bookinfo installation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-tutorial-bookinfo-removing_deploying-applications-ossm-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.8.6.4. Removing the Bookinfo application
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.8.6.4. Removing the Bookinfo application"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.8.6.4. Removing the Bookinfo application"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-delete-bookinfo-project_deploying-applications-ossm-v1x" class="j-doc-nav__link ">
    2.8.6.4.1. Delete the Bookinfo project
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-remove-bookinfo-smmr_deploying-applications-ossm-v1x" class="j-doc-nav__link ">
    2.8.6.4.2. Remove the Bookinfo project from the Service Mesh member roll
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#generating-sample-traces-analyzing-trace-data_deploying-applications-ossm-v1x" class="j-doc-nav__link ">
    2.8.7. Generating example traces and analyzing trace data
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-observability-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.9. Data visualization and observability
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.9. Data visualization and observability"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.9. Data visualization and observability"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-observability-access-console_observability-v1x" class="j-doc-nav__link ">
    2.9.1. Viewing service mesh data
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-observability-visual_observability-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.9.2. Viewing service mesh data in the Kiali console
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.9.2. Viewing service mesh data in the Kiali console"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.9.2. Viewing service mesh data in the Kiali console"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-observability-topology_observability-v1x" class="j-doc-nav__link ">
    2.9.2.1. Changing graph layouts in Kiali
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-custom-resources-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.10. Custom resources
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.10. Custom resources"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.10. Custom resources"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#prerequisites-7" class="j-doc-nav__link ">
    2.10.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cr-example-1x_ossm-controler-items-v1x" class="j-doc-nav__link ">
    2.10.2. Red Hat OpenShift Service Mesh custom resources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cr-parameters_ossm-controler-items-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.10.3. ServiceMeshControlPlane parameters
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.10.3. ServiceMeshControlPlane parameters"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.10.3. ServiceMeshControlPlane parameters"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cr-istio-global_ossm-controler-items-v1x" class="j-doc-nav__link ">
    2.10.3.1. Istio global example
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cr-gateway_ossm-controler-items-v1x" class="j-doc-nav__link ">
    2.10.3.2. Istio gateway configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cr-mixer_ossm-controler-items-v1x" class="j-doc-nav__link ">
    2.10.3.3. Istio Mixer configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cr-pilot_ossm-controler-items-v1x" class="j-doc-nav__link ">
    2.10.3.4. Istio Pilot configuration
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#configuring-kiali_ossm-controler-items-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.10.4. Configuring Kiali
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.10.4. Configuring Kiali"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.10.4. Configuring Kiali"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#configuring-kiali-grafana_ossm-controler-items-v1x" class="j-doc-nav__link ">
    2.10.4.1. Configuring Kiali for Grafana
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#configuring-kiali-jaeger_ossm-controler-items-v1x" class="j-doc-nav__link ">
    2.10.4.2. Configuring Kiali for Jaeger
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-configuring-jaeger_ossm-controler-items-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.10.5. Configuring Jaeger
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.10.5. Configuring Jaeger"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.10.5. Configuring Jaeger"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-configuring-jaeger-elasticsearch_ossm-controler-items-v1x" class="j-doc-nav__link ">
    2.10.5.1. Configuring Elasticsearch
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-configuring-jaeger-existing-v1x_ossm-controler-items-v1x" class="j-doc-nav__link ">
    2.10.5.2. Connecting to an existing Jaeger instance
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-jaeger-config-elasticsearch-v1x_ossm-controler-items-v1x" class="j-doc-nav__link ">
    2.10.5.3. Configuring Elasticsearch
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-jaeger-config-es-cleaner-v1x_ossm-controler-items-v1x" class="j-doc-nav__link ">
    2.10.5.4. Configuring the Elasticsearch index cleaner job
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-cr-threescale_ossm-controler-items-v1x" class="j-doc-nav__link ">
    2.10.6. 3scale configuration
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#threescale-adapter-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.11. Using the 3scale Istio adapter
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.11. Using the 3scale Istio adapter"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.11. Using the 3scale Istio adapter"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-integrate-1x_threescale-adapter-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.11.1. Integrate the 3scale adapter with Red Hat OpenShift Service Mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.11.1. Integrate the 3scale adapter with Red Hat OpenShift Service Mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.11.1. Integrate the 3scale adapter with Red Hat OpenShift Service Mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-cr_threescale-adapter-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.11.1.1. Generating 3scale custom resources
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.11.1.1. Generating 3scale custom resources"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.11.1.1. Generating 3scale custom resources"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-templates_threescale-adapter-v1x" class="j-doc-nav__link ">
    2.11.1.1.1. Generate templates from URL examples
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-manifests_threescale-adapter-v1x" class="j-doc-nav__link ">
    2.11.1.2. Generating manifests from a deployed adapter
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-routing_threescale-adapter-v1x" class="j-doc-nav__link ">
    2.11.1.3. Routing service traffic through the adapter
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-integration-settings_threescale-adapter-v1x" class="j-doc-nav__link ">
    2.11.2. Configure the integration settings in 3scale
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-caching_threescale-adapter-v1x" class="j-doc-nav__link ">
    2.11.3. Caching behavior
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-authentication_threescale-adapter-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.11.4. Authenticating requests
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.11.4. Authenticating requests"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.11.4. Authenticating requests"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-authentication-patterns_threescale-adapter-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.11.4.1. Applying authentication patterns
  </a>
                              <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.11.4.1. Applying authentication patterns"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.11.4.1. Applying authentication patterns"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-apikey-authentication_threescale-adapter-v1x" class="j-doc-nav__link ">
    2.11.4.1.1. API key authentication method
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-appidapikey-authentication_threescale-adapter-v1x" class="j-doc-nav__link ">
    2.11.4.1.2. Application ID and application key pair authentication method
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-openid-authentication_threescale-adapter-v1x" class="j-doc-nav__link ">
    2.11.4.1.3. OpenID authentication method
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-hybrid-authentication_threescale-adapter-v1x" class="j-doc-nav__link ">
    2.11.4.1.4. Hybrid authentication method
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-metrics-1x_threescale-adapter-v1x" class="j-doc-nav__link ">
    2.11.5. 3scale Adapter metrics
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-istio-adapter-verification_threescale-adapter-v1x" class="j-doc-nav__link ">
    2.11.6. 3scale Istio adapter verification
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-threescale-istio-adapter-troubleshooting-checklist_threescale-adapter-v1x" class="j-doc-nav__link ">
    2.11.7. 3scale Istio adapter troubleshooting checklist
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#removing-ossm-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.12. Removing Service Mesh
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.12. Removing Service Mesh"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.12. Removing Service Mesh"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-control-plane-remove_removing-ossm-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.12.1. Removing the Red Hat OpenShift Service Mesh control plane
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.12.1. Removing the Red Hat OpenShift Service Mesh control plane"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.12.1. Removing the Red Hat OpenShift Service Mesh control plane"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-control-plane-remove-operatorhub_removing-ossm-v1x" class="j-doc-nav__link ">
    2.12.1.1. Removing the Service Mesh control plane using the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-control-plane-remove-cli_removing-ossm-v1x" class="j-doc-nav__link ">
    2.12.1.2. Removing the Service Mesh control plane using the CLI
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-operatorhub-remove-operators_removing-ossm-v1x" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.12.2. Removing the installed Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.12.2. Removing the installed Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.12.2. Removing the installed Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-remove-operator-servicemesh_removing-ossm-v1x" class="j-doc-nav__link ">
    2.12.2.1. Removing the Operators
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#ossm-remove-cleanup-1x_removing-ossm-v1x" class="j-doc-nav__link ">
    2.12.2.2. Clean up Operator resources
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                    

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh#idm140663647075984" class="j-doc-nav__link ">
    Legal Notice
  </a>
  
          </li>
              </ol>
    
  </div>
</nav>


              </div>
            </div>
            <div class="j-options-container j-options-container--mobile">
              <button class="j-sidebar__menu-trigger j-sidebar__menu-trigger--options content-expander__trigger">
                <span class="j-sidebar__menu-trigger__open-headline">
                  Settings
                </span>
                <span class="j-sidebar__menu-trigger__close-text">Close</span>
              </button>
              

  <ul class="j-doc-options__list content-expander">
    <li class="j-doc-options__item">
          <label class="j-doc-option__label j-doc-option__label--language" for="j-doc-language">
        Language:
      </label>
      <select id="j-doc-language" class="j-doc-option__select">
                  <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh" selected=''>
            English
          </option>
                  <option value="/documentation/ja-jp/openshift_container_platform/4.13/html-single/service_mesh" >
            日本語
          </option>
                  <option value="/documentation/zh-cn/openshift_container_platform/4.13/html-single/service_mesh" >
            简体中文
          </option>
              </select>

            <noscript>
        <div class="j-doc-option__label j-doc-option__label--language" id="j-doc-option__label--language--nojs">
          Language:
        </div>
        <ul aria-labelledby="j-doc-option__label--language--nojs" class="j-doc-option__languages-list">
                      <li>
              <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh">English</a>
            </li>
                      <li>
              <a href="/documentation/ja-jp/openshift_container_platform/4.13/html-single/service_mesh">日本語</a>
            </li>
                      <li>
              <a href="/documentation/zh-cn/openshift_container_platform/4.13/html-single/service_mesh">简体中文</a>
            </li>
                  </ul>
      </noscript>

      </li>

    <li class="j-doc-options__item">
    <label for="j-doc-mode" class="j-doc-option__label j-doc-option__label--format">
      Format:
    </label>
    <select id="j-doc-mode" class="j-doc-option__select">
              <option value="/documentation/en-us/openshift_container_platform/4.13/html/service_mesh"  class="j-doc-options__option j-doc-options__option--multi-page">
          Multi-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh" selected='' class="j-doc-options__option j-doc-options__option--single-page">
          Single-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/pdf/service_mesh/OpenShift_Container_Platform-4.13-Service_Mesh-en-US.pdf"  class="j-doc-options__option j-doc-options__option--pdf">
          PDF
        </option>
          </select>

        <noscript>
      <div class="j-doc-option__label j-doc-option__label--format" id="j-doc-option__label--format--nojs">
        Format:
      </div>
      <ul class="j-doc-option__format-list" aria-labelledby="j-doc-option__label--format--nojs">
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--multi-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html/service_mesh">Multi-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--single-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh">Single-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--pdf"><a href="/documentation/en-us/openshift_container_platform/4.13/pdf/service_mesh/OpenShift_Container_Platform-4.13-Service_Mesh-en-US.pdf">PDF</a></li>
              </ul>
    </noscript>
  </li>
</ul>


              </div>
          </div>
                <div class="pvof-doc__tertiary-sidebar j-doc__tertiary-sidebar">
          <div class="pvof-doc__tertiary-sidebar__inner j-doc__tertiary-sidebar__inner">
            <div class="j-doc__doc-options">
              <div class="j-options-container j-options-container--desktop">
                <button class="j-sidebar__menu-trigger j-sidebar__menu-trigger--tablet content-expander__trigger">
                  <span class="j-sidebar__menu-trigger-icon"></span>
                  <h2 class="visually-hidden">Language and Page Formatting Options</h2>
                </button>
                  

  <ul class="j-doc-options__list content-expander">
    <li class="j-doc-options__item">
          <label class="j-doc-option__label j-doc-option__label--language" for="j-doc-language--2">
        Language:
      </label>
      <select id="j-doc-language--2" class="j-doc-option__select">
                  <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh" selected=''>
            English
          </option>
                  <option value="/documentation/ja-jp/openshift_container_platform/4.13/html-single/service_mesh" >
            日本語
          </option>
                  <option value="/documentation/zh-cn/openshift_container_platform/4.13/html-single/service_mesh" >
            简体中文
          </option>
              </select>

            <noscript>
        <div class="j-doc-option__label j-doc-option__label--language" id="j-doc-option__label--language--nojs">
          Language:
        </div>
        <ul aria-labelledby="j-doc-option__label--language--nojs" class="j-doc-option__languages-list">
                      <li>
              <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh">English</a>
            </li>
                      <li>
              <a href="/documentation/ja-jp/openshift_container_platform/4.13/html-single/service_mesh">日本語</a>
            </li>
                      <li>
              <a href="/documentation/zh-cn/openshift_container_platform/4.13/html-single/service_mesh">简体中文</a>
            </li>
                  </ul>
      </noscript>

      </li>

    <li class="j-doc-options__item">
    <label for="j-doc-mode--2" class="j-doc-option__label j-doc-option__label--format">
      Format:
    </label>
    <select id="j-doc-mode--2" class="j-doc-option__select">
              <option value="/documentation/en-us/openshift_container_platform/4.13/html/service_mesh"  class="j-doc-options__option j-doc-options__option--multi-page">
          Multi-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh" selected='' class="j-doc-options__option j-doc-options__option--single-page">
          Single-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/pdf/service_mesh/OpenShift_Container_Platform-4.13-Service_Mesh-en-US.pdf"  class="j-doc-options__option j-doc-options__option--pdf">
          PDF
        </option>
          </select>

        <noscript>
      <div class="j-doc-option__label j-doc-option__label--format" id="j-doc-option__label--format--nojs">
        Format:
      </div>
      <ul class="j-doc-option__format-list" aria-labelledby="j-doc-option__label--format--nojs">
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--multi-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html/service_mesh">Multi-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--single-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh">Single-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--pdf"><a href="/documentation/en-us/openshift_container_platform/4.13/pdf/service_mesh/OpenShift_Container_Platform-4.13-Service_Mesh-en-US.pdf">PDF</a></li>
              </ul>
    </noscript>
  </li>
</ul>


                </div>
              </div>
          </div>
        </div>

                  <div class="doc-wrapper pvof-doc__wrapper j-superdoc__content-wrapper" id="doc-wrapper">
            

  <div class="pane-page-title">
    <h1 class="title" itemprop="name">Service Mesh</h1>
  </div>


  <div xml:lang="en-US" class="book" id="idm140663689668096"><div class="titlepage"><div><div class="producttitle"><span class="productname">OpenShift Container Platform</span> <span class="productnumber">4.13</span></div><div><h2 class="subtitle">Service Mesh installation, usage, and release notes</h2></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat OpenShift Documentation Team</span></div></div><div><a href="#idm140663647075984">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				This document provides information on how to use Service Mesh in OpenShift Container Platform.
			</div></div></div></div><hr/></div><section class="chapter" id="service-mesh-2-x"><div class="titlepage"><div><div><h1 class="title">Chapter 1. Service Mesh 2.x</h1></div></div></div><section class="section" id="ossm-about"><div class="titlepage"><div><div><h2 class="title">1.1. About OpenShift Service Mesh</h2></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Because Red Hat OpenShift Service Mesh releases on a different cadence from OpenShift Container Platform and because the Red Hat OpenShift Service Mesh Operator supports deploying multiple versions of the <code class="literal">ServiceMeshControlPlane</code>, the Service Mesh documentation does not maintain separate documentation sets for minor versions of the product. The current documentation set applies to the most recent version of Service Mesh unless version-specific limitations are called out in a particular topic or for a particular feature.
				</p><p>
					For additional information about the Red Hat OpenShift Service Mesh life cycle and supported platforms, refer to the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ossm">Platform Life Cycle Policy</a>.
				</p></div></div><section class="section" id="ossm-servicemesh-overview_ossm-about"><div class="titlepage"><div><div><h3 class="title">1.1.1. Introduction to Red Hat OpenShift Service Mesh</h3></div></div></div><p>
					Red Hat OpenShift Service Mesh addresses a variety of problems in a microservice architecture by creating a centralized point of control in an application. It adds a transparent layer on existing distributed applications without requiring any changes to the application code.
				</p><p>
					Microservice architectures split the work of enterprise applications into modular services, which can make scaling and maintenance easier. However, as an enterprise application built on a microservice architecture grows in size and complexity, it becomes difficult to understand and manage. Service Mesh can address those architecture problems by capturing or intercepting traffic between services and can modify, redirect, or create new requests to other services.
				</p><p>
					Service Mesh, which is based on the open source <a class="link" href="https://istio.io/">Istio project</a>, provides an easy way to create a network of deployed services that provides discovery, load balancing, service-to-service authentication, failure recovery, metrics, and monitoring. A service mesh also provides more complex operational functionality, including A/B testing, canary releases, access control, and end-to-end authentication.
				</p></section><section class="section" id="ossm-core-features_ossm-about"><div class="titlepage"><div><div><h3 class="title">1.1.2. Core features</h3></div></div></div><p>
					Red Hat OpenShift Service Mesh provides a number of key capabilities uniformly across a network of services:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Traffic Management</strong></span> - Control the flow of traffic and API calls between services, make calls more reliable, and make the network more robust in the face of adverse conditions.
						</li><li class="listitem">
							<span class="strong strong"><strong>Service Identity and Security</strong></span> - Provide services in the mesh with a verifiable identity and provide the ability to protect service traffic as it flows over networks of varying degrees of trustworthiness.
						</li><li class="listitem">
							<span class="strong strong"><strong>Policy Enforcement</strong></span> - Apply organizational policy to the interaction between services, ensure access policies are enforced and resources are fairly distributed among consumers. Policy changes are made by configuring the mesh, not by changing application code.
						</li><li class="listitem">
							<span class="strong strong"><strong>Telemetry</strong></span> - Gain understanding of the dependencies between services and the nature and flow of traffic between them, providing the ability to quickly identify issues.
						</li></ul></div></section></section><section class="section" id="service-mesh-release-notes"><div class="titlepage"><div><div><h2 class="title">1.2. Service Mesh Release Notes</h2></div></div></div><section class="section" id="making-open-source-more-inclusive_ossm-release-notes"><div class="titlepage"><div><div><h3 class="title">1.2.1. Making open source more inclusive</h3></div></div></div><p>
					Red Hat is committed to replacing problematic language in our code, documentation, and web properties. We are beginning with these four terms: master, slave, blacklist, and whitelist. Because of the enormity of this endeavor, these changes will be implemented gradually over several upcoming releases. For more details, see <a class="link" href="https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language">our CTO Chris Wright’s message</a>.
				</p></section><section class="section" id="ossm-rn-new-features_ossm-release-notes"><div class="titlepage"><div><div><h3 class="title">1.2.2. New features and enhancements</h3></div></div></div><p>
					This release adds improvements related to the following components and concepts.
				</p><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-4-3"><div class="titlepage"><div><div><h4 class="title">1.2.2.1. New features Red Hat OpenShift Service Mesh version 2.4.3</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The Red Hat OpenShift Service Mesh Operator is now available on ARM-based clusters as a Technology Preview feature.
							</li><li class="listitem">
								The <code class="literal">envoyExtAuthzGrpc</code> field has been added, which is used to configure an external authorization provider using the gRPC API.
							</li><li class="listitem">
								Common Vulnerabilities and Exposures (CVEs) have been addressed.
							</li><li class="listitem">
								This release is supported on OpenShift Container Platform 4.10 and newer versions.
							</li></ul></div><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-4-3"><div class="titlepage"><div><div><h5 class="title">1.2.2.1.1. Component versions included in Red Hat OpenShift Service Mesh version 2.4.3</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663687106832" scope="col">Component</th><th align="left" valign="top" id="idm140663687105392" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663687106832"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663687105392"> <p>
											1.16.7
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663687106832"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663687105392"> <p>
											1.24.10
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663687106832"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663687105392"> <p>
											1.42.0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663687106832"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663687105392"> <p>
											1.65.8
										</p>
										 </td></tr></tbody></table></div></section><section class="section" id="red-hat-openshift-service-mesh-operator-to-arm-based-clusters"><div class="titlepage"><div><div><h5 class="title">1.2.2.1.2. Red Hat OpenShift Service Mesh operator to ARM-based clusters</h5></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								Red Hat OpenShift Service Mesh operator to ARM based clusters is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
							</p><p>
								For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
							</p></div></div><p>
							This release makes the Red Hat OpenShift Service Mesh Operator available on ARM-based clusters as a Technology Preview feature. Images are available for Istio, Envoy, Prometheus, Kiali, and Grafana. Images are not available for Jaeger, so Jaeger must be disabled as a Service Mesh add-on.
						</p></section><section class="section" id="remote-procedure-calls-grpc-api-support-for-external-authorization-configuration"><div class="titlepage"><div><div><h5 class="title">1.2.2.1.3. Remote Procedure Calls (gRPC) API support for external authorization configuration</h5></div></div></div><p>
							This enhancement adds the <code class="literal">envoyExtAuthzGrpc</code> field to configure an external authorization provider using the gRPC API.
						</p></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-4-2"><div class="titlepage"><div><div><h4 class="title">1.2.2.2. New features Red Hat OpenShift Service Mesh version 2.4.2</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.10 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-4-2"><div class="titlepage"><div><div><h5 class="title">1.2.2.2.1. Component versions included in Red Hat OpenShift Service Mesh version 2.4.2</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663675331712" scope="col">Component</th><th align="left" valign="top" id="idm140663675330624" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663675331712"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663675330624"> <p>
											1.16.7
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663675331712"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663675330624"> <p>
											1.24.10
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663675331712"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663675330624"> <p>
											1.42.0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663675331712"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663675330624"> <p>
											1.65.7
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-4-1"><div class="titlepage"><div><div><h4 class="title">1.2.2.3. New features Red Hat OpenShift Service Mesh version 2.4.1</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.10 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-4-1"><div class="titlepage"><div><div><h5 class="title">1.2.2.3.1. Component versions included in Red Hat OpenShift Service Mesh version 2.4.1</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663675271392" scope="col">Component</th><th align="left" valign="top" id="idm140663684289648" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663675271392"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663684289648"> <p>
											1.16.5
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663675271392"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663684289648"> <p>
											1.24.8
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663675271392"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663684289648"> <p>
											1.42.0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663675271392"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663684289648"> <p>
											1.65.7
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-4"><div class="titlepage"><div><div><h4 class="title">1.2.2.4. New features Red Hat OpenShift Service Mesh version 2.4</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.10 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-4"><div class="titlepage"><div><div><h5 class="title">1.2.2.4.1. Component versions included in Red Hat OpenShift Service Mesh version 2.4</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663684904736" scope="col">Component</th><th align="left" valign="top" id="idm140663684903648" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663684904736"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663684903648"> <p>
											1.16.5
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663684904736"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663684903648"> <p>
											1.24.8
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663684904736"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663684903648"> <p>
											1.42.0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663684904736"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663684903648"> <p>
											1.65.6
										</p>
										 </td></tr></tbody></table></div></section><section class="section" id="cluster-wide-deployments"><div class="titlepage"><div><div><h5 class="title">1.2.2.4.2. Cluster-wide deployments</h5></div></div></div><p>
							This enhancement introduces a generally available version of cluster-wide deployments. A cluster-wide deployment contains a service mesh control plane that monitors resources for an entire cluster. The control plane uses a single query across all namespaces to monitor each Istio or Kubernetes resource that affects the mesh configuration. Reducing the number of queries the control plane performs in a cluster-wide deployment improves performance.
						</p></section><section class="section" id="support-for-discovery-selectors"><div class="titlepage"><div><div><h5 class="title">1.2.2.4.3. Support for discovery selectors</h5></div></div></div><p>
							This enhancement introduces a generally available version of the <code class="literal">meshConfig.discoverySelectors</code> field, which can be used in cluster-wide deployments to limit the services the service mesh control plane can discover.
						</p><pre class="programlisting language-yaml">spec:
  meshConfig
    discoverySelectors:
    - matchLabels:
        env: prod
        region: us-east1
    - matchExpressions:
      - key: app
        operator: In
        values:
          - cassandra
          - spark</pre></section><section class="section" id="integration-with-cert-manager-istio-csr"><div class="titlepage"><div><div><h5 class="title">1.2.2.4.4. Integration with cert-manager istio-csr</h5></div></div></div><p>
							With this update, Red Hat OpenShift Service Mesh integrates with the <code class="literal">cert-manager</code> controller and the <code class="literal">istio-csr</code> agent. <code class="literal">cert-manager</code> adds certificates and certificate issuers as resource types in Kubernetes clusters, and simplifies the process of obtaining, renewing, and using those certificates. <code class="literal">cert-manager</code> provides and rotates an intermediate CA certificate for Istio. Integration with <code class="literal">istio-csr</code> enables users to delegate signing certificate requests from Istio proxies to <code class="literal">cert-manager</code>. <code class="literal">ServiceMeshControlPlane</code> v2.4 accepts CA certificates provided by <code class="literal">cert-manager</code> as <code class="literal">cacerts</code> secret.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Integration with <code class="literal">cert-manager</code> and <code class="literal">istio-csr</code> is not supported on IBM Power, IBM Z, and IBM® LinuxONE.
							</p></div></div></section><section class="section" id="integration-with-external-authorization-systems"><div class="titlepage"><div><div><h5 class="title">1.2.2.4.5. Integration with external authorization systems</h5></div></div></div><p>
							This enhancement introduces a generally available method of integrating Red Hat OpenShift Service Mesh with external authorization systems by using the <code class="literal">action: CUSTOM</code> field of the <code class="literal">AuthorizationPolicy</code> resource. Use the <code class="literal">envoyExtAuthzHttp</code> field to delegate the access control to an external authorization system.
						</p></section><section class="section" id="integration-with-external-prometheus-installation"><div class="titlepage"><div><div><h5 class="title">1.2.2.4.6. Integration with external Prometheus installation</h5></div></div></div><p>
							This enhancement introduces a generally available version of the Prometheus extension provider. You can expose metrics to the OpenShift Container Platform monitoring stack or a custom Prometheus installation by setting the value of the <code class="literal">extensionProviders</code> field to <code class="literal">prometheus</code> in the <code class="literal">spec.meshConfig</code> specification. The telemetry object configures Istio proxies to collect traffic metrics. Service Mesh only supports the Telemetry API for Prometheus metrics.
						</p><pre class="programlisting language-yaml">spec:
  meshConfig:
    extensionProviders:
    - name: prometheus
      prometheus: {}
---
apiVersion: telemetry.istio.io/v1alpha1
kind: Telemetry
metadata:
  name: enable-prometheus-metrics
spec:
  metrics:
  - providers:
    - name: prometheus</pre></section><section class="section" id="single-stack-ipv6-support"><div class="titlepage"><div><div><h5 class="title">1.2.2.4.7. Single stack IPv6 support</h5></div></div></div><p>
							This enhancement introduces generally available support for single stack IPv6 clusters, providing access to a broader range of IP addresses. Dual stack IPv4 or IPv6 cluster is not supported.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Single stack IPv6 support is not available on IBM Power, IBM Z, and IBM® LinuxONE.
							</p></div></div></section><section class="section" id="openshift-container-platform-gateway-api-support"><div class="titlepage"><div><div><h5 class="title">1.2.2.4.8. OpenShift Container Platform Gateway API support</h5></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								OpenShift Container Platform Gateway API support is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
							</p><p>
								For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
							</p></div></div><p>
							This enhancement introduces an updated Technology Preview version of the OpenShift Container Platform Gateway API. By default, the OpenShift Container Platform Gateway API is disabled.
						</p><section class="section" id="enabling-openshift-container-platform-gateway-api"><div class="titlepage"><div><div><h6 class="title">1.2.2.4.8.1. Enabling OpenShift Container Platform Gateway API</h6></div></div></div><p>
								To enable the OpenShift Container Platform Gateway API, set the value of the <code class="literal">enabled</code> field to <code class="literal">true</code> in the <code class="literal">techPreview.gatewayAPI</code> specification of the <code class="literal">ServiceMeshControlPlane</code> resource.
							</p><pre class="programlisting language-yaml">spec:
  techPreview:
    gatewayAPI:
      enabled: true</pre><p>
								Previously, environment variables were used to enable the Gateway API.
							</p><pre class="programlisting language-yaml">spec:
  runtime:
    components:
      pilot:
        container:
          env:
            PILOT_ENABLE_GATEWAY_API: "true"
            PILOT_ENABLE_GATEWAY_API_STATUS: "true"
            PILOT_ENABLE_GATEWAY_API_DEPLOYMENT_CONTROLLER: "true"</pre></section></section><section class="section" id="control-plane-deployment-on-infrastructure-nodes"><div class="titlepage"><div><div><h5 class="title">1.2.2.4.9. Control plane deployment on infrastructure nodes</h5></div></div></div><p>
							Service Mesh control plane deployment is now supported and documented on OpenShift infrastructure nodes. For more information, see the following documentation:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Configuring all Service Mesh control plane components to run on infrastructure nodes
								</li><li class="listitem">
									Configuring individual Service Mesh control plane components to run on infrastructure nodes
								</li></ul></div></section><section class="section" id="istio-1-16-support"><div class="titlepage"><div><div><h5 class="title">1.2.2.4.10. Istio 1.16 support</h5></div></div></div><p>
							Service Mesh 2.4 is based on Istio 1.16, which brings in new features and product enhancements. While many Istio 1.16 features are supported, the following exceptions should be noted:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									HBONE protocol for sidecars is an experimental feature that is not supported.
								</li><li class="listitem">
									Service Mesh on ARM64 architecture is not supported.
								</li><li class="listitem">
									OpenTelemetry API remains a Technology Preview feature.
								</li></ul></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-3-7"><div class="titlepage"><div><div><h4 class="title">1.2.2.5. New features Red Hat OpenShift Service Mesh version 2.3.7</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.10 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-3-7"><div class="titlepage"><div><div><h5 class="title">1.2.2.5.1. Component versions included in Red Hat OpenShift Service Mesh version 2.3.7</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663679787792" scope="col">Component</th><th align="left" valign="top" id="idm140663679786704" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663679787792"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663679786704"> <p>
											1.14.6
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663679787792"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663679786704"> <p>
											1.22.11
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663679787792"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663679786704"> <p>
											1.42.0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663679787792"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663679786704"> <p>
											1.57.11
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-3-6"><div class="titlepage"><div><div><h4 class="title">1.2.2.6. New features Red Hat OpenShift Service Mesh version 2.3.6</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.10 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-3-6"><div class="titlepage"><div><div><h5 class="title">1.2.2.6.1. Component versions included in Red Hat OpenShift Service Mesh version 2.3.6</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663685996944" scope="col">Component</th><th align="left" valign="top" id="idm140663685995856" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663685996944"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663685995856"> <p>
											1.14.5
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663685996944"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663685995856"> <p>
											1.22.11
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663685996944"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663685995856"> <p>
											1.42.0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663685996944"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663685995856"> <p>
											1.57.10
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-3-5"><div class="titlepage"><div><div><h4 class="title">1.2.2.7. New features Red Hat OpenShift Service Mesh version 2.3.5</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.10 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-3-5"><div class="titlepage"><div><div><h5 class="title">1.2.2.7.1. Component versions included in Red Hat OpenShift Service Mesh version 2.3.5</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663679506688" scope="col">Component</th><th align="left" valign="top" id="idm140663679505600" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663679506688"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663679505600"> <p>
											1.14.5
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663679506688"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663679505600"> <p>
											1.22.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663679506688"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663679505600"> <p>
											1.42.0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663679506688"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663679505600"> <p>
											1.57.10
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-3-4"><div class="titlepage"><div><div><h4 class="title">1.2.2.8. New features Red Hat OpenShift Service Mesh version 2.3.4</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.10 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-3-4"><div class="titlepage"><div><div><h5 class="title">1.2.2.8.1. Component versions included in Red Hat OpenShift Service Mesh version 2.3.4</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663667301168" scope="col">Component</th><th align="left" valign="top" id="idm140663667300080" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663667301168"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663667300080"> <p>
											1.14.6
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663667301168"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663667300080"> <p>
											1.22.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663667301168"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663667300080"> <p>
											1.42.0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663667301168"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663667300080"> <p>
											1.57.9
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-3-3"><div class="titlepage"><div><div><h4 class="title">1.2.2.9. New features Red Hat OpenShift Service Mesh version 2.3.3</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.9 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-3-3"><div class="titlepage"><div><div><h5 class="title">1.2.2.9.1. Component versions included in Red Hat OpenShift Service Mesh version 2.3.3</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663672195072" scope="col">Component</th><th align="left" valign="top" id="idm140663672193984" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663672195072"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663672193984"> <p>
											1.14.5
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663672195072"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663672193984"> <p>
											1.22.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663672195072"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663672193984"> <p>
											1.42.0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663672195072"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663672193984"> <p>
											1.57.7
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-3-2"><div class="titlepage"><div><div><h4 class="title">1.2.2.10. New features Red Hat OpenShift Service Mesh version 2.3.2</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.9 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-3-2"><div class="titlepage"><div><div><h5 class="title">1.2.2.10.1. Component versions included in Red Hat OpenShift Service Mesh version 2.3.2</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663674080320" scope="col">Component</th><th align="left" valign="top" id="idm140663677140112" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663674080320"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663677140112"> <p>
											1.14.5
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663674080320"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663677140112"> <p>
											1.22.7
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663674080320"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663677140112"> <p>
											1.39
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663674080320"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663677140112"> <p>
											1.57.6
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-3-1"><div class="titlepage"><div><div><h4 class="title">1.2.2.11. New features Red Hat OpenShift Service Mesh version 2.3.1</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh introduces new features, addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.9 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-3-1"><div class="titlepage"><div><div><h5 class="title">1.2.2.11.1. Component versions included in Red Hat OpenShift Service Mesh version 2.3.1</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663682326240" scope="col">Component</th><th align="left" valign="top" id="idm140663682325152" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663682326240"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663682325152"> <p>
											1.14.5
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663682326240"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663682325152"> <p>
											1.22.4
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663682326240"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663682325152"> <p>
											1.39
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663682326240"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663682325152"> <p>
											1.57.5
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-3"><div class="titlepage"><div><div><h4 class="title">1.2.2.12. New features Red Hat OpenShift Service Mesh version 2.3</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh introduces new features, addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.9 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-3"><div class="titlepage"><div><div><h5 class="title">1.2.2.12.1. Component versions included in Red Hat OpenShift Service Mesh version 2.3</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663665746384" scope="col">Component</th><th align="left" valign="top" id="idm140663666030064" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663665746384"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663666030064"> <p>
											1.14.3
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663665746384"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663666030064"> <p>
											1.22.4
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663665746384"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663666030064"> <p>
											1.38
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663665746384"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663666030064"> <p>
											1.57.3
										</p>
										 </td></tr></tbody></table></div></section><section class="section" id="new-container-network-interface-cni-daemonset-container-and-configmap"><div class="titlepage"><div><div><h5 class="title">1.2.2.12.2. New Container Network Interface (CNI) DaemonSet container and ConfigMap</h5></div></div></div><p>
							The <code class="literal">openshift-operators</code> namespace includes a new istio CNI DaemonSet <code class="literal">istio-cni-node-v2-3</code> and a new <code class="literal">ConfigMap</code> resource, <code class="literal">istio-cni-config-v2-3</code>.
						</p><p>
							When upgrading to Service Mesh Control Plane 2.3, the existing <code class="literal">istio-cni-node</code> DaemonSet is not changed, and a new <code class="literal">istio-cni-node-v2-3</code> DaemonSet is created.
						</p><p>
							This name change does not affect previous releases or any <code class="literal">istio-cni-node</code> CNI DaemonSet associated with a Service Mesh Control Plane deployed using a previous release.
						</p></section><section class="section" id="gateway-injection-support"><div class="titlepage"><div><div><h5 class="title">1.2.2.12.3. Gateway injection support</h5></div></div></div><p>
							This release introduces generally available support for Gateway injection. Gateway configurations are applied to standalone Envoy proxies that are running at the edge of the mesh, rather than the sidecar Envoy proxies running alongside your service workloads. This enables the ability to customize gateway options. When using gateway injection, you must create the following resources in the namespace where you want to run your gateway proxy: <code class="literal">Service</code>, <code class="literal">Deployment</code>, <code class="literal">Role</code>, and <code class="literal">RoleBinding</code>.
						</p></section><section class="section" id="istio-1-14-support"><div class="titlepage"><div><div><h5 class="title">1.2.2.12.4. Istio 1.14 Support</h5></div></div></div><p>
							Service Mesh 2.3 is based on Istio 1.14, which brings in new features and product enhancements. While many Istio 1.14 features are supported, the following exceptions should be noted:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									ProxyConfig API is supported with the exception of the image field.
								</li><li class="listitem">
									Telemetry API is a Technology Preview feature.
								</li><li class="listitem">
									SPIRE runtime is not a supported feature.
								</li></ul></div></section><section class="section" id="openshift-service-mesh-console"><div class="titlepage"><div><div><h5 class="title">1.2.2.12.5. OpenShift Service Mesh Console</h5></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								OpenShift Service Mesh Console is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
							</p><p>
								For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
							</p></div></div><p>
							This release introduces a Technology Preview version of the OpenShift Container Platform Service Mesh Console, which integrates the Kiali interface directly into the OpenShift web console. For additional information, see <a class="link" href="https://cloud.redhat.com/blog/introducing-the-openshift-service-mesh-console-a-developer-preview">Introducing the OpenShift Service Mesh Console (A Technology Preview)</a>
						</p></section><section class="section" id="cluster-wide-deployment"><div class="titlepage"><div><div><h5 class="title">1.2.2.12.6. Cluster-wide deployment</h5></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								Cluster-wide deployment is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
							</p><p>
								For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
							</p></div></div><p>
							This release introduces cluster-wide deployment as a Technology Preview feature. A cluster-wide deployment contains a Service Mesh Control Plane that monitors resources for an entire cluster. The control plane uses a single query across all namespaces to monitor each Istio or Kubernetes resource kind that affects the mesh configuration. In contrast, the multitenant approach uses a query per namespace for each resource kind. Reducing the number of queries the control plane performs in a cluster-wide deployment improves performance.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								This cluster-wide deployment documentation is only applicable for control planes deployed using SMCP v2.3. cluster-wide deployments created using SMCP v2.3 are not compatible with cluster-wide deployments created using SMCP v2.4.
							</p></div></div><section class="section" id="configuring-cluster-wide-deployment"><div class="titlepage"><div><div><h6 class="title">1.2.2.12.6.1. Configuring cluster-wide deployment</h6></div></div></div><p>
								The following example <code class="literal">ServiceMeshControlPlane</code> object configures a cluster-wide deployment.
							</p><p>
								To create an SMCP for cluster-wide deployment, a user must belong to the <code class="literal">cluster-admin</code> ClusterRole. If the SMCP is configured for cluster-wide deployment, it must be the only SMCP in the cluster. You cannot change the control plane mode from multitenant to cluster-wide (or from cluster-wide to multitenant). If a multitenant control plane already exists, delete it and create a new one.
							</p><p>
								This example configures the SMCP for cluster-wide deployment.
							</p><pre class="programlisting language-yaml">  apiVersion: maistra.io/v2
  kind: ServiceMeshControlPlane
  metadata:
    name: cluster-wide
    namespace: istio-system
  spec:
    version: v2.3
    techPreview:
      controlPlaneMode: ClusterScoped <span id="CO1-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO1-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Enables Istiod to monitor resources at the cluster level rather than monitor each individual namespace.
									</div></dd></dl></div><p>
								Additionally, the SMMR must also be configured for cluster-wide deployment. This example configures the SMMR for cluster-wide deployment.
							</p><pre class="programlisting language-yaml">  apiVersion: maistra.io/v1
  kind: ServiceMeshMemberRoll
  metadata:
    name: default
  spec:
    members:
    - '*' <span id="CO2-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO2-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Adds all namespaces to the mesh, including any namespaces you subsequently create. The following namespaces are not part of the mesh: kube, openshift, kube-* and openshift-*.
									</div></dd></dl></div></section></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-2-10"><div class="titlepage"><div><div><h4 class="title">1.2.2.13. New features Red Hat OpenShift Service Mesh version 2.2.10</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.10 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-10"><div class="titlepage"><div><div><h5 class="title">1.2.2.13.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.10</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663677021392" scope="col">Component</th><th align="left" valign="top" id="idm140663660256352" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663677021392"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663660256352"> <p>
											1.12.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663677021392"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663660256352"> <p>
											1.20.8
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663677021392"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663660256352"> <p>
											1.42.0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663677021392"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663660256352"> <p>
											1.48.8
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-2-9"><div class="titlepage"><div><div><h4 class="title">1.2.2.14. New features Red Hat OpenShift Service Mesh version 2.2.9</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.10 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-9"><div class="titlepage"><div><div><h5 class="title">1.2.2.14.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.9</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663678434432" scope="col">Component</th><th align="left" valign="top" id="idm140663678433344" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663678434432"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663678433344"> <p>
											1.12.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663678434432"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663678433344"> <p>
											1.20.8
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663678434432"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663678433344"> <p>
											1.42.0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663678434432"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663678433344"> <p>
											1.48.7
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-2-8"><div class="titlepage"><div><div><h4 class="title">1.2.2.15. New features Red Hat OpenShift Service Mesh version 2.2.8</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.10 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-8"><div class="titlepage"><div><div><h5 class="title">1.2.2.15.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.8</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663688857168" scope="col">Component</th><th align="left" valign="top" id="idm140663674040208" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663688857168"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663674040208"> <p>
											1.12.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663688857168"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663674040208"> <p>
											1.20.8
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663688857168"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663674040208"> <p>
											1.42.0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663688857168"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663674040208"> <p>
											1.48.7
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-2-7"><div class="titlepage"><div><div><h4 class="title">1.2.2.16. New features Red Hat OpenShift Service Mesh version 2.2.7</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.10 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-7"><div class="titlepage"><div><div><h5 class="title">1.2.2.16.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.7</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663676158960" scope="col">Component</th><th align="left" valign="top" id="idm140663676157872" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663676158960"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663676157872"> <p>
											1.12.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663676158960"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663676157872"> <p>
											1.20.8
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663676158960"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663676157872"> <p>
											1.42.0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663676158960"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663676157872"> <p>
											1.48.6
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-2-6"><div class="titlepage"><div><div><h4 class="title">1.2.2.17. New features Red Hat OpenShift Service Mesh version 2.2.6</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.9 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-6"><div class="titlepage"><div><div><h5 class="title">1.2.2.17.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.6</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663686493728" scope="col">Component</th><th align="left" valign="top" id="idm140663686492640" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663686493728"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663686492640"> <p>
											1.12.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663686493728"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663686492640"> <p>
											1.20.8
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663686493728"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663686492640"> <p>
											1.39
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663686493728"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663686492640"> <p>
											1.48.5
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-2-5"><div class="titlepage"><div><div><h4 class="title">1.2.2.18. New features Red Hat OpenShift Service Mesh version 2.2.5</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.9 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-5"><div class="titlepage"><div><div><h5 class="title">1.2.2.18.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.5</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663687580304" scope="col">Component</th><th align="left" valign="top" id="idm140663687579216" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663687580304"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663687579216"> <p>
											1.12.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663687580304"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663687579216"> <p>
											1.20.8
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663687580304"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663687579216"> <p>
											1.39
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663687580304"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663687579216"> <p>
											1.48.3
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-2-4"><div class="titlepage"><div><div><h4 class="title">1.2.2.19. New features Red Hat OpenShift Service Mesh version 2.2.4</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.9 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-4"><div class="titlepage"><div><div><h5 class="title">1.2.2.19.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.4</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663676969056" scope="col">Component</th><th align="left" valign="top" id="idm140663676967968" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663676969056"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663676967968"> <p>
											1.12.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663676969056"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663676967968"> <p>
											1.20.8
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663676969056"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663676967968"> <p>
											1.36.14
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663676969056"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663676967968"> <p>
											1.48.3
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-2-3"><div class="titlepage"><div><div><h4 class="title">1.2.2.20. New features Red Hat OpenShift Service Mesh version 2.2.3</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), bug fixes, and is supported on OpenShift Container Platform 4.9 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-3"><div class="titlepage"><div><div><h5 class="title">1.2.2.20.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.3</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663688281040" scope="col">Component</th><th align="left" valign="top" id="idm140663688279952" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663688281040"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663688279952"> <p>
											1.12.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663688281040"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663688279952"> <p>
											1.20.8
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663688281040"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663688279952"> <p>
											1.36
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663688281040"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663688279952"> <p>
											1.48.3
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-2-2"><div class="titlepage"><div><div><h4 class="title">1.2.2.21. New features Red Hat OpenShift Service Mesh version 2.2.2</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), bug fixes, and is supported on OpenShift Container Platform 4.9 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-2"><div class="titlepage"><div><div><h5 class="title">1.2.2.21.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.2</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663670276336" scope="col">Component</th><th align="left" valign="top" id="idm140663670275248" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663670276336"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663670275248"> <p>
											1.12.7
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663670276336"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663670275248"> <p>
											1.20.6
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663670276336"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663670275248"> <p>
											1.36
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663670276336"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663670275248"> <p>
											1.48.2-1
										</p>
										 </td></tr></tbody></table></div></section><section class="section" id="copy-route-labels"><div class="titlepage"><div><div><h5 class="title">1.2.2.21.2. Copy route labels</h5></div></div></div><p>
							With this enhancement, in addition to copying annotations, you can copy specific labels for an OpenShift route. Red Hat OpenShift Service Mesh copies all labels and annotations present in the Istio Gateway resource (with the exception of annotations starting with kubectl.kubernetes.io) into the managed OpenShift Route resource.
						</p></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-version-2-2-1"><div class="titlepage"><div><div><h4 class="title">1.2.2.22. New features Red Hat OpenShift Service Mesh version 2.2.1</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), bug fixes, and is supported on OpenShift Container Platform 4.9 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-2-1"><div class="titlepage"><div><div><h5 class="title">1.2.2.22.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2.1</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663646258352" scope="col">Component</th><th align="left" valign="top" id="idm140663646257264" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663646258352"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663646257264"> <p>
											1.12.7
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663646258352"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663646257264"> <p>
											1.20.6
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663646258352"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663646257264"> <p>
											1.34.1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663646258352"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663646257264"> <p>
											1.48.2-1
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-2"><div class="titlepage"><div><div><h4 class="title">1.2.2.23. New features Red Hat OpenShift Service Mesh 2.2</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh adds new features and enhancements, and is supported on OpenShift Container Platform 4.9 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-2"><div class="titlepage"><div><div><h5 class="title">1.2.2.23.1. Component versions included in Red Hat OpenShift Service Mesh version 2.2</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663678782864" scope="col">Component</th><th align="left" valign="top" id="idm140663678781776" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663678782864"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663678781776"> <p>
											1.12.7
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663678782864"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663678781776"> <p>
											1.20.4
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663678782864"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663678781776"> <p>
											1.34.1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663678782864"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663678781776"> <p>
											1.48.0.16
										</p>
										 </td></tr></tbody></table></div></section><section class="section" id="literal-wasmplugin-literal-api"><div class="titlepage"><div><div><h5 class="title">1.2.2.23.2. <code class="literal">WasmPlugin</code> API</h5></div></div></div><p>
							This release adds support for the <code class="literal">WasmPlugin</code> API and deprecates the <code class="literal">ServiceMeshExtension</code> API.
						</p></section><section class="section" id="rosa-support"><div class="titlepage"><div><div><h5 class="title">1.2.2.23.3. ROSA support</h5></div></div></div><p>
							This release introduces service mesh support for Red Hat OpenShift on AWS (ROSA), including multi-cluster federation.
						</p></section><section class="section" id="literal-istio-node-literal-daemonset-renamed"><div class="titlepage"><div><div><h5 class="title">1.2.2.23.4. <code class="literal">istio-node</code> DaemonSet renamed</h5></div></div></div><p>
							This release, the <code class="literal">istio-node</code> DaemonSet is renamed to <code class="literal">istio-cni-node</code> to match the name in upstream Istio.
						</p></section><section class="section" id="envoy-sidecar-networking-changes"><div class="titlepage"><div><div><h5 class="title">1.2.2.23.5. Envoy sidecar networking changes</h5></div></div></div><p>
							Istio 1.10 updated Envoy to send traffic to the application container using <code class="literal">eth0</code> rather than <code class="literal">lo</code> by default.
						</p></section><section class="section" id="service-mesh-control-plane-1-1"><div class="titlepage"><div><div><h5 class="title">1.2.2.23.6. Service Mesh Control Plane 1.1</h5></div></div></div><p>
							This release marks the end of support for Service Mesh Control Planes based on Service Mesh 1.1 for all platforms.
						</p></section><section class="section" id="istio-1-12-support"><div class="titlepage"><div><div><h5 class="title">1.2.2.23.7. Istio 1.12 Support</h5></div></div></div><p>
							Service Mesh 2.2 is based on Istio 1.12, which brings in new features and product enhancements. While many Istio 1.12 features are supported, the following unsupported features should be noted:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									AuthPolicy Dry Run is a tech preview feature.
								</li><li class="listitem">
									gRPC Proxyless Service Mesh is a tech preview feature.
								</li><li class="listitem">
									Telemetry API is a tech preview feature.
								</li><li class="listitem">
									Discovery selectors is not a supported feature.
								</li><li class="listitem">
									External control plane is not a supported feature.
								</li><li class="listitem">
									Gateway injection is not a supported feature.
								</li></ul></div></section><section class="section" id="kubernetes-gateway-api"><div class="titlepage"><div><div><h5 class="title">1.2.2.23.8. Kubernetes Gateway API</h5></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								Kubernetes Gateway API is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
							</p><p>
								For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
							</p></div></div><p>
							Kubernetes Gateway API is a technology preview feature that is disabled by default. If the Kubernetes API deployment controller is disabled, you must manually deploy and link an ingress gateway to the created Gateway object.
						</p><p>
							If the Kubernetes API deployment controller is enabled, then an ingress gateway automatically deploys when a Gateway object is created.
						</p><section class="section" id="installing-the-gateway-api-crds"><div class="titlepage"><div><div><h6 class="title">1.2.2.23.8.1. Installing the Gateway API CRDs</h6></div></div></div><p>
								The Gateway API CRDs do not come pre-installed by default on OpenShift clusters. Install the CRDs prior to enabling Gateway API support in the SMCP.
							</p><pre class="programlisting language-terminal">$ kubectl get crd gateways.gateway.networking.k8s.io || { kubectl kustomize "github.com/kubernetes-sigs/gateway-api/config/crd?ref=v0.4.0" | kubectl apply -f -; }</pre></section><section class="section" id="enabling-kubernetes-gateway-api"><div class="titlepage"><div><div><h6 class="title">1.2.2.23.8.2. Enabling Kubernetes Gateway API</h6></div></div></div><p>
								To enable the feature, set the following environment variables for the <code class="literal">Istiod</code> container in <code class="literal">ServiceMeshControlPlane</code>:
							</p><pre class="programlisting language-yaml">spec:
  runtime:
    components:
      pilot:
        container:
          env:
            PILOT_ENABLE_GATEWAY_API: "true"
            PILOT_ENABLE_GATEWAY_API_STATUS: "true"
            # and optionally, for the deployment controller
            PILOT_ENABLE_GATEWAY_API_DEPLOYMENT_CONTROLLER: "true"</pre><p>
								Restricting route attachment on Gateway API listeners is possible using the <code class="literal">SameNamespace</code> or <code class="literal">All</code> settings. Istio ignores usage of label selectors in <code class="literal">listeners.allowedRoutes.namespaces</code> and reverts to the default behavior (<code class="literal">SameNamespace</code>).
							</p></section><section class="section" id="manually-linking-an-existing-gateway-to-a-gateway-resource"><div class="titlepage"><div><div><h6 class="title">1.2.2.23.8.3. Manually linking an existing gateway to a Gateway resource</h6></div></div></div><p>
								If the Kubernetes API deployment controller is disabled, you must manually deploy and then link an ingress gateway to the created Gateway resource.
							</p><pre class="programlisting language-yaml">  apiVersion: gateway.networking.k8s.io/v1alpha2
  kind: Gateway
  metadata:
    name: gateway
  spec:
    addresses:
    - value: ingress.istio-gateways.svc.cluster.local
      type: Hostname</pre></section></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-1-6"><div class="titlepage"><div><div><h4 class="title">1.2.2.24. New features Red Hat OpenShift Service Mesh 2.1.6</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.9 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-6"><div class="titlepage"><div><div><h5 class="title">1.2.2.24.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.6</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663678335376" scope="col">Component</th><th align="left" valign="top" id="idm140663678334288" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663678335376"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663678334288"> <p>
											1.9.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663678335376"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663678334288"> <p>
											1.17.5
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663678335376"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663678334288"> <p>
											1.36
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663678335376"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663678334288"> <p>
											1.36.16
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-1-5-2"><div class="titlepage"><div><div><h4 class="title">1.2.2.25. New features Red Hat OpenShift Service Mesh 2.1.5.2</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), contains bug fixes, and is supported on OpenShift Container Platform 4.9 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-5-2"><div class="titlepage"><div><div><h5 class="title">1.2.2.25.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.5.2</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663677731056" scope="col">Component</th><th align="left" valign="top" id="idm140663677729968" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663677731056"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663677729968"> <p>
											1.9.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663677731056"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663677729968"> <p>
											1.17.5
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663677731056"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663677729968"> <p>
											1.36
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663677731056"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663677729968"> <p>
											1.24.17
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-1-5-1"><div class="titlepage"><div><div><h4 class="title">1.2.2.26. New features Red Hat OpenShift Service Mesh 2.1.5.1</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), bug fixes, and is supported on OpenShift Container Platform 4.9 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-5-1"><div class="titlepage"><div><div><h5 class="title">1.2.2.26.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.5.1</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663685702768" scope="col">Component</th><th align="left" valign="top" id="idm140663685701680" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663685702768"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663685701680"> <p>
											1.9.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663685702768"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663685701680"> <p>
											1.17.5
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663685702768"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663685701680"> <p>
											1.36
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663685702768"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663685701680"> <p>
											1.36.13
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-1-5"><div class="titlepage"><div><div><h4 class="title">1.2.2.27. New features Red Hat OpenShift Service Mesh 2.1.5</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), bug fixes, and is supported on OpenShift Container Platform 4.9 and later versions.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-5"><div class="titlepage"><div><div><h5 class="title">1.2.2.27.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.5</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663665810688" scope="col">Component</th><th align="left" valign="top" id="idm140663665809600" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663665810688"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663665809600"> <p>
											1.9.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663665810688"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663665809600"> <p>
											1.17.1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663665810688"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663665809600"> <p>
											1.36
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663665810688"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663665809600"> <p>
											1.36.12-1
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-1-4"><div class="titlepage"><div><div><h4 class="title">1.2.2.28. New features Red Hat OpenShift Service Mesh 2.1.4</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-4"><div class="titlepage"><div><div><h5 class="title">1.2.2.28.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.4</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663669004448" scope="col">Component</th><th align="left" valign="top" id="idm140663669003360" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663669004448"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663669003360"> <p>
											1.9.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663669004448"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663669003360"> <p>
											1.17.1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663669004448"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663669003360"> <p>
											1.30.2
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663669004448"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663669003360"> <p>
											1.36.12-1
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-1-3"><div class="titlepage"><div><div><h4 class="title">1.2.2.29. New features Red Hat OpenShift Service Mesh 2.1.3</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-3"><div class="titlepage"><div><div><h5 class="title">1.2.2.29.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.3</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663687904800" scope="col">Component</th><th align="left" valign="top" id="idm140663687903712" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663687904800"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663687903712"> <p>
											1.9.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663687904800"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663687903712"> <p>
											1.17.1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663687904800"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663687903712"> <p>
											1.30.2
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663687904800"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663687903712"> <p>
											1.36.10-2
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-1-2-1"><div class="titlepage"><div><div><h4 class="title">1.2.2.30. New features Red Hat OpenShift Service Mesh 2.1.2.1</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-2-1"><div class="titlepage"><div><div><h5 class="title">1.2.2.30.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.2.1</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663676980320" scope="col">Component</th><th align="left" valign="top" id="idm140663676979232" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663676980320"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663676979232"> <p>
											1.9.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663676980320"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663676979232"> <p>
											1.17.1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663676980320"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663676979232"> <p>
											1.30.2
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663676980320"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663676979232"> <p>
											1.36.9
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-1-2"><div class="titlepage"><div><div><h4 class="title">1.2.2.31. New features Red Hat OpenShift Service Mesh 2.1.2</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p><p>
						With this release, the Red Hat OpenShift distributed tracing platform (Jaeger) Operator is now installed to the <code class="literal">openshift-distributed-tracing</code> namespace by default. Previously the default installation had been in the <code class="literal">openshift-operator</code> namespace.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-2"><div class="titlepage"><div><div><h5 class="title">1.2.2.31.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.2</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663678634544" scope="col">Component</th><th align="left" valign="top" id="idm140663678633456" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663678634544"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663678633456"> <p>
											1.9.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663678634544"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663678633456"> <p>
											1.17.1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663678634544"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663678633456"> <p>
											1.30.1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663678634544"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663678633456"> <p>
											1.36.8
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-1-1"><div class="titlepage"><div><div><h4 class="title">1.2.2.32. New features Red Hat OpenShift Service Mesh 2.1.1</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p><p>
						This release also adds the ability to disable the automatic creation of network policies.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-1-1"><div class="titlepage"><div><div><h5 class="title">1.2.2.32.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1.1</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663673761312" scope="col">Component</th><th align="left" valign="top" id="idm140663672828960" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663673761312"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663672828960"> <p>
											1.9.9
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663673761312"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663672828960"> <p>
											1.17.1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663673761312"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663672828960"> <p>
											1.24.1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663673761312"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663672828960"> <p>
											1.36.7
										</p>
										 </td></tr></tbody></table></div></section><section class="section" id="ossm-config-disable-networkpolicy_ossm-release-notes"><div class="titlepage"><div><div><h5 class="title">1.2.2.32.2. Disabling network policies</h5></div></div></div><p>
							Red Hat OpenShift Service Mesh automatically creates and manages a number of <code class="literal">NetworkPolicies</code> resources in the Service Mesh control plane and application namespaces. This is to ensure that applications and the control plane can communicate with each other.
						</p><p>
							If you want to disable the automatic creation and management of <code class="literal">NetworkPolicies</code> resources, for example to enforce company security policies, you can do so. You can edit the <code class="literal">ServiceMeshControlPlane</code> to set the <code class="literal">spec.security.manageNetworkPolicy</code> setting to <code class="literal">false</code>
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								When you disable <code class="literal">spec.security.manageNetworkPolicy</code> Red Hat OpenShift Service Mesh will not create <span class="strong strong"><strong>any</strong></span> <code class="literal">NetworkPolicy</code> objects. The system administrator is responsible for managing the network and fixing any issues this might cause.
							</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									In the OpenShift Container Platform web console, click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
								</li><li class="listitem">
									Select the project where you installed the Service Mesh control plane, for example <code class="literal">istio-system</code>, from the Project menu.
								</li><li class="listitem">
									Click the Red Hat OpenShift Service Mesh Operator. In the <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span> column, click the name of your <code class="literal">ServiceMeshControlPlane</code>, for example <code class="literal">basic-install</code>.
								</li><li class="listitem">
									On the <span class="strong strong"><strong>Create ServiceMeshControlPlane Details</strong></span> page, click <code class="literal">YAML</code> to modify your configuration.
								</li><li class="listitem"><p class="simpara">
									Set the <code class="literal">ServiceMeshControlPlane</code> field <code class="literal">spec.security.manageNetworkPolicy</code> to <code class="literal">false</code>, as shown in this example.
								</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
spec:
  security:
      trust:
      manageNetworkPolicy: false</pre></li><li class="listitem">
									Click <span class="strong strong"><strong>Save</strong></span>.
								</li></ol></div></section></section><section class="section" id="new-features-and-enhancements-red-hat-openshift-service-mesh-2-1"><div class="titlepage"><div><div><h4 class="title">1.2.2.33. New features and enhancements Red Hat OpenShift Service Mesh 2.1</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh adds support for Istio 1.9.8, Envoy Proxy 1.17.1, Jaeger 1.24.1, and Kiali 1.36.5 on OpenShift Container Platform 4.6 EUS, 4.7, 4.8, 4.9, along with new features and enhancements.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-1"><div class="titlepage"><div><div><h5 class="title">1.2.2.33.1. Component versions included in Red Hat OpenShift Service Mesh version 2.1</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663676789360" scope="col">Component</th><th align="left" valign="top" id="idm140663676788272" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663676789360"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663676788272"> <p>
											1.9.6
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663676789360"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663676788272"> <p>
											1.17.1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663676789360"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663676788272"> <p>
											1.24.1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663676789360"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663676788272"> <p>
											1.36.5
										</p>
										 </td></tr></tbody></table></div></section><section class="section" id="service-mesh-federation"><div class="titlepage"><div><div><h5 class="title">1.2.2.33.2. Service Mesh Federation</h5></div></div></div><p>
							New Custom Resource Definitions (CRDs) have been added to support federating service meshes. Service meshes may be federated both within the same cluster or across different OpenShift clusters. These new resources include:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">ServiceMeshPeer</code> - Defines a federation with a separate service mesh, including gateway configuration, root trust certificate configuration, and status fields. In a pair of federated meshes, each mesh will define its own separate <code class="literal">ServiceMeshPeer</code> resource.
								</li><li class="listitem">
									<code class="literal">ExportedServiceMeshSet</code> - Defines which services for a given <code class="literal">ServiceMeshPeer</code> are available for the peer mesh to import.
								</li><li class="listitem">
									<code class="literal">ImportedServiceSet</code> - Defines which services for a given <code class="literal">ServiceMeshPeer</code> are imported from the peer mesh. These services must also be made available by the peer’s <code class="literal">ExportedServiceMeshSet</code> resource.
								</li></ul></div><p>
							Service Mesh Federation is not supported between clusters on Red Hat OpenShift Service on AWS (ROSA), Azure Red Hat OpenShift (ARO), or OpenShift Dedicated (OSD).
						</p></section><section class="section" id="ovn-kubernetes-container-network-interface-cni-generally-available"><div class="titlepage"><div><div><h5 class="title">1.2.2.33.3. OVN-Kubernetes Container Network Interface (CNI) generally available</h5></div></div></div><p>
							The OVN-Kubernetes Container Network Interface (CNI) was previously introduced as a Technology Preview feature in Red Hat OpenShift Service Mesh 2.0.1 and is now generally available in Red Hat OpenShift Service Mesh 2.1 and 2.0.x for use on OpenShift Container Platform 4.7.32, OpenShift Container Platform 4.8.12, and OpenShift Container Platform 4.9.
						</p></section><section class="section" id="service-mesh-webassembly-wasm-extensions"><div class="titlepage"><div><div><h5 class="title">1.2.2.33.4. Service Mesh WebAssembly (WASM) Extensions</h5></div></div></div><p>
							The <code class="literal">ServiceMeshExtensions</code> Custom Resource Definition (CRD), first introduced in 2.0 as Technology Preview, is now generally available. You can use CRD to build your own plugins, but Red Hat does not provide support for the plugins you create.
						</p><p>
							Mixer has been completely removed in Service Mesh 2.1. Upgrading from a Service Mesh 2.0.x release to 2.1 will be blocked if Mixer is enabled. Mixer plugins will need to be ported to WebAssembly Extensions.
						</p></section><section class="section" id="threescale-webassembly-adapter-wasm"><div class="titlepage"><div><div><h5 class="title">1.2.2.33.5. 3scale WebAssembly Adapter (WASM)</h5></div></div></div><p>
							With Mixer now officially removed, OpenShift Service Mesh 2.1 does not support the 3scale mixer adapter. Before upgrading to Service Mesh 2.1, remove the Mixer-based 3scale adapter and any additional Mixer plugins. Then, manually install and configure the new 3scale WebAssembly adapter with Service Mesh 2.1+ using a <code class="literal">ServiceMeshExtension</code> resource.
						</p><p>
							3scale 2.11 introduces an updated Service Mesh integration based on <code class="literal">WebAssembly</code>.
						</p></section><section class="section" id="istio-1-9-support"><div class="titlepage"><div><div><h5 class="title">1.2.2.33.6. Istio 1.9 Support</h5></div></div></div><p>
							Service Mesh 2.1 is based on Istio 1.9, which brings in a large number of new features and product enhancements. While the majority of Istio 1.9 features are supported, the following exceptions should be noted:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Virtual Machine integration is not yet supported
								</li><li class="listitem">
									Kubernetes Gateway API is not yet supported
								</li><li class="listitem">
									Remote fetch and load of WebAssembly HTTP filters are not yet supported
								</li><li class="listitem">
									Custom CA Integration using the Kubernetes CSR API is not yet supported
								</li><li class="listitem">
									Request Classification for monitoring traffic is a tech preview feature
								</li><li class="listitem">
									Integration with external authorization systems via Authorization policy’s CUSTOM action is a tech preview feature
								</li></ul></div></section><section class="section" id="improved-service-mesh-operator-performance"><div class="titlepage"><div><div><h5 class="title">1.2.2.33.7. Improved Service Mesh operator performance</h5></div></div></div><p>
							The amount of time Red Hat OpenShift Service Mesh uses to prune old resources at the end of every <code class="literal">ServiceMeshControlPlane</code> reconciliation has been reduced. This results in faster <code class="literal">ServiceMeshControlPlane</code> deployments, and allows changes applied to existing SMCPs to take effect more quickly.
						</p></section><section class="section" id="kiali-updates"><div class="titlepage"><div><div><h5 class="title">1.2.2.33.8. Kiali updates</h5></div></div></div><p>
							Kiali 1.36 includes the following features and enhancements:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Service Mesh troubleshooting functionality
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											Control plane and gateway monitoring
										</li><li class="listitem">
											Proxy sync statuses
										</li><li class="listitem">
											Envoy configuration views
										</li><li class="listitem">
											Unified view showing Envoy proxy and application logs interleaved
										</li></ul></div></li><li class="listitem">
									Namespace and cluster boxing to support federated service mesh views
								</li><li class="listitem">
									New validations, wizards, and distributed tracing enhancements
								</li></ul></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-0-11-1"><div class="titlepage"><div><div><h4 class="title">1.2.2.34. New features Red Hat OpenShift Service Mesh 2.0.11.1</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), bug fixes, and is supported on OpenShift Container Platform 4.9 or later.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-0-11-1"><div class="titlepage"><div><div><h5 class="title">1.2.2.34.1. Component versions included in Red Hat OpenShift Service Mesh version 2.0.11.1</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663689056992" scope="col">Component</th><th align="left" valign="top" id="idm140663664395280" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663689056992"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663664395280"> <p>
											1.6.14
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663689056992"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663664395280"> <p>
											1.14.5
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663689056992"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663664395280"> <p>
											1.36
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663689056992"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663664395280"> <p>
											1.24.17
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-0-11"><div class="titlepage"><div><div><h4 class="title">1.2.2.35. New features Red Hat OpenShift Service Mesh 2.0.11</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs), bug fixes, and is supported on OpenShift Container Platform 4.9 or later.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-0-11"><div class="titlepage"><div><div><h5 class="title">1.2.2.35.1. Component versions included in Red Hat OpenShift Service Mesh version 2.0.11</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663664590176" scope="col">Component</th><th align="left" valign="top" id="idm140663664589088" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663664590176"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663664589088"> <p>
											1.6.14
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663664590176"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663664589088"> <p>
											1.14.5
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663664590176"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663664589088"> <p>
											1.36
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663664590176"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663664589088"> <p>
											1.24.16-1
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-0-10"><div class="titlepage"><div><div><h4 class="title">1.2.2.36. New features Red Hat OpenShift Service Mesh 2.0.10</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-0-10"><div class="titlepage"><div><div><h5 class="title">1.2.2.36.1. Component versions included in Red Hat OpenShift Service Mesh version 2.0.10</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663665762448" scope="col">Component</th><th align="left" valign="top" id="idm140663665761360" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663665762448"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663665761360"> <p>
											1.6.14
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663665762448"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663665761360"> <p>
											1.14.5
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663665762448"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663665761360"> <p>
											1.28.0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663665762448"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663665761360"> <p>
											1.24.16-1
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-0-9"><div class="titlepage"><div><div><h4 class="title">1.2.2.37. New features Red Hat OpenShift Service Mesh 2.0.9</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-2-0-9"><div class="titlepage"><div><div><h5 class="title">1.2.2.37.1. Component versions included in Red Hat OpenShift Service Mesh version 2.0.9</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663686595008" scope="col">Component</th><th align="left" valign="top" id="idm140663686593920" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663686595008"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663686593920"> <p>
											1.6.14
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663686595008"> <p>
											Envoy Proxy
										</p>
										 </td><td align="left" valign="top" headers="idm140663686593920"> <p>
											1.14.5
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663686595008"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663686593920"> <p>
											1.24.1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663686595008"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663686593920"> <p>
											1.24.11
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-0-8"><div class="titlepage"><div><div><h4 class="title">1.2.2.38. New features Red Hat OpenShift Service Mesh 2.0.8</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-0-7-1"><div class="titlepage"><div><div><h4 class="title">1.2.2.39. New features Red Hat OpenShift Service Mesh 2.0.7.1</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs).
					</p><section class="section" id="change-in-how-red-hat-openshift-service-mesh-handles-uri-fragments"><div class="titlepage"><div><div><h5 class="title">1.2.2.39.1. Change in how Red Hat OpenShift Service Mesh handles URI fragments</h5></div></div></div><p>
							Red Hat OpenShift Service Mesh contains a remotely exploitable vulnerability, <a class="link" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-39156">CVE-2021-39156</a>, where an HTTP request with a fragment (a section in the end of a URI that begins with a # character) in the URI path could bypass the Istio URI path-based authorization policies. For instance, an Istio authorization policy denies requests sent to the URI path <code class="literal">/user/profile</code>. In the vulnerable versions, a request with URI path <code class="literal">/user/profile#section1</code> bypasses the deny policy and routes to the backend (with the normalized URI <code class="literal">path /user/profile%23section1</code>), possibly leading to a security incident.
						</p><p>
							You are impacted by this vulnerability if you use authorization policies with DENY actions and <code class="literal">operation.paths</code>, or ALLOW actions and <code class="literal">operation.notPaths</code>.
						</p><p>
							With the mitigation, the fragment part of the request’s URI is removed before the authorization and routing. This prevents a request with a fragment in its URI from bypassing authorization policies which are based on the URI without the fragment part.
						</p><p>
							To opt-out from the new behavior in the mitigation, the fragment section in the URI will be kept. You can configure your <code class="literal">ServiceMeshControlPlane</code> to keep URI fragments.
						</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								Disabling the new behavior will normalize your paths as described above and is considered unsafe. Ensure that you have accommodated for this in any security policies before opting to keep URI fragments.
							</p></div></div><div class="formalpara"><p class="title"><strong>Example <code class="literal">ServiceMeshControlPlane</code> modification</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
spec:
  techPreview:
    meshConfig:
      defaultConfig:
        proxyMetadata: HTTP_STRIP_FRAGMENT_FROM_PATH_UNSAFE_IF_DISABLED: "false"</pre>

							</p></div></section><section class="section" id="required-update-for-authorization-policies"><div class="titlepage"><div><div><h5 class="title">1.2.2.39.2. Required update for authorization policies</h5></div></div></div><p>
							Istio generates hostnames for both the hostname itself and all matching ports. For instance, a virtual service or Gateway for a host of "httpbin.foo" generates a config matching "httpbin.foo and httpbin.foo:*". However, exact match authorization policies only match the exact string given for the <code class="literal">hosts</code> or <code class="literal">notHosts</code> fields.
						</p><p>
							Your cluster is impacted if you have <code class="literal">AuthorizationPolicy</code> resources using exact string comparison for the rule to determine <a class="link" href="https://istio.io/latest/docs/reference/config/security/authorization-policy/#Operation">hosts or notHosts</a>.
						</p><p>
							You must update your authorization policy <a class="link" href="https://istio.io/latest/docs/reference/config/security/authorization-policy/#Rule">rules</a> to use prefix match instead of exact match. For example, replacing <code class="literal">hosts: ["httpbin.com"]</code> with <code class="literal">hosts: ["httpbin.com:*"]</code> in the first <code class="literal">AuthorizationPolicy</code> example.
						</p><div class="formalpara"><p class="title"><strong>First example AuthorizationPolicy using prefix match</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: httpbin
  namespace: foo
spec:
  action: DENY
  rules:
  - from:
    - source:
        namespaces: ["dev"]
    to:
    - operation:
        hosts: [“httpbin.com”,"httpbin.com:*"]</pre>

							</p></div><div class="formalpara"><p class="title"><strong>Second example AuthorizationPolicy using prefix match</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: httpbin
  namespace: default
spec:
  action: DENY
  rules:
  - to:
    - operation:
        hosts: ["httpbin.example.com:*"]</pre>

							</p></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-0-7"><div class="titlepage"><div><div><h4 class="title">1.2.2.40. New features Red Hat OpenShift Service Mesh 2.0.7</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="red-hat-openshift-service-mesh-on-red-hat-openshift-dedicated-and-microsoft-azure-red-hat-openshift"><div class="titlepage"><div><div><h4 class="title">1.2.2.41. Red Hat OpenShift Service Mesh on Red Hat OpenShift Dedicated and Microsoft Azure Red Hat OpenShift</h4></div></div></div><p>
						Red Hat OpenShift Service Mesh is now supported through Red Hat OpenShift Dedicated and Microsoft Azure Red Hat OpenShift.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-0-6"><div class="titlepage"><div><div><h4 class="title">1.2.2.42. New features Red Hat OpenShift Service Mesh 2.0.6</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-0-5"><div class="titlepage"><div><div><h4 class="title">1.2.2.43. New features Red Hat OpenShift Service Mesh 2.0.5</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-0-4"><div class="titlepage"><div><div><h4 class="title">1.2.2.44. New features Red Hat OpenShift Service Mesh 2.0.4</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							There are manual steps that must be completed to address CVE-2021-29492 and CVE-2021-31920.
						</p></div></div><section class="section" id="manual-updates-cve-2021-29492_ossm-release-notes"><div class="titlepage"><div><div><h5 class="title">1.2.2.44.1. Manual updates required by CVE-2021-29492 and CVE-2021-31920</h5></div></div></div><p>
							Istio contains a remotely exploitable vulnerability where an HTTP request path with multiple slashes or escaped slash characters (<code class="literal">%2F</code> or <code class="literal">%5C</code>) could potentially bypass an Istio authorization policy when path-based authorization rules are used.
						</p><p>
							For example, assume an Istio cluster administrator defines an authorization DENY policy to reject the request at path <code class="literal">/admin</code>. A request sent to the URL path <code class="literal">//admin</code> will NOT be rejected by the authorization policy.
						</p><p>
							According to <a class="link" href="https://tools.ietf.org/html/rfc3986#section-6">RFC 3986</a>, the path <code class="literal">//admin</code> with multiple slashes should technically be treated as a different path from the <code class="literal">/admin</code>. However, some backend services choose to normalize the URL paths by merging multiple slashes into a single slash. This can result in a bypass of the authorization policy (<code class="literal">//admin</code> does not match <code class="literal">/admin</code>), and a user can access the resource at path <code class="literal">/admin</code> in the backend; this would represent a security incident.
						</p><p>
							Your cluster is impacted by this vulnerability if you have authorization policies using <code class="literal">ALLOW action + notPaths</code> field or <code class="literal">DENY action + paths field</code> patterns. These patterns are vulnerable to unexpected policy bypasses.
						</p><p>
							Your cluster is NOT impacted by this vulnerability if:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									You don’t have authorization policies.
								</li><li class="listitem">
									Your authorization policies don’t define <code class="literal">paths</code> or <code class="literal">notPaths</code> fields.
								</li><li class="listitem">
									Your authorization policies use <code class="literal">ALLOW action + paths</code> field or <code class="literal">DENY action + notPaths</code> field patterns. These patterns could only cause unexpected rejection instead of policy bypasses. The upgrade is optional for these cases.
								</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The Red Hat OpenShift Service Mesh configuration location for path normalization is different from the Istio configuration.
							</p></div></div></section><section class="section" id="updating-the-path-normalization-configuration"><div class="titlepage"><div><div><h5 class="title">1.2.2.44.2. Updating the path normalization configuration</h5></div></div></div><p>
							Istio authorization policies can be based on the URL paths in the HTTP request. <a class="link" href="https://en.wikipedia.org/wiki/URI_normalization">Path normalization</a>, also known as URI normalization, modifies and standardizes the incoming requests' paths so that the normalized paths can be processed in a standard way. Syntactically different paths may be equivalent after path normalization.
						</p><p>
							Istio supports the following normalization schemes on the request paths before evaluating against the authorization policies and routing the requests:
						</p><div class="table" id="idm140663671363808"><p class="title"><strong>Table 1.1. Normalization schemes</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663669665536" scope="col">Option</th><th align="left" valign="top" id="idm140663669664448" scope="col">Description</th><th align="left" valign="top" id="idm140663669663360" scope="col">Example</th><th align="left" valign="top" id="idm140663669662272" scope="col">Notes</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663669665536"> <p>
											<code class="literal">NONE</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663669664448"> <p>
											No normalization is done. Anything received by Envoy will be forwarded exactly as-is to any backend service.
										</p>
										 </td><td align="left" valign="top" headers="idm140663669663360"> <p>
											<code class="literal">../%2Fa../b</code> is evaluated by the authorization policies and sent to your service.
										</p>
										 </td><td align="left" valign="top" headers="idm140663669662272"> <p>
											This setting is vulnerable to CVE-2021-31920.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663669665536"> <p>
											<code class="literal">BASE</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663669664448"> <p>
											This is currently the option used in the <span class="strong strong"><strong>default</strong></span> installation of Istio. This applies the <a class="link" href="https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-normalize-path"><code class="literal">normalize_path</code></a> option on Envoy proxies, which follows <a class="link" href="https://tools.ietf.org/html/rfc3986">RFC 3986</a> with extra normalization to convert backslashes to forward slashes.
										</p>
										 </td><td align="left" valign="top" headers="idm140663669663360"> <p>
											<code class="literal">/a/../b</code> is normalized to <code class="literal">/b</code>. <code class="literal">\da</code> is normalized to <code class="literal">/da</code>.
										</p>
										 </td><td align="left" valign="top" headers="idm140663669662272"> <p>
											This setting is vulnerable to CVE-2021-31920.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663669665536"> <p>
											<code class="literal">MERGE_SLASHES</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663669664448"> <p>
											Slashes are merged after the <span class="emphasis"><em>BASE</em></span> normalization.
										</p>
										 </td><td align="left" valign="top" headers="idm140663669663360"> <p>
											<code class="literal">/a//b</code> is normalized to <code class="literal">/a/b</code>.
										</p>
										 </td><td align="left" valign="top" headers="idm140663669662272"> <p>
											Update to this setting to mitigate CVE-2021-31920.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663669665536"> <p>
											<code class="literal">DECODE_AND_MERGE_SLASHES</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663669664448"> <p>
											The strictest setting when you allow all traffic by default. This setting is recommended, with the caveat that you must thoroughly test your authorization policies routes. <a class="link" href="https://tools.ietf.org/html/rfc3986#section-2.1">Percent-encoded</a> slash and backslash characters (<code class="literal">%2F</code>, <code class="literal">%2f</code>, <code class="literal">%5C</code> and <code class="literal">%5c</code>) are decoded to <code class="literal">/</code> or <code class="literal">\</code>, before the <code class="literal">MERGE_SLASHES</code> normalization.
										</p>
										 </td><td align="left" valign="top" headers="idm140663669663360"> <p>
											<code class="literal">/a%2fb</code> is normalized to <code class="literal">/a/b</code>.
										</p>
										 </td><td align="left" valign="top" headers="idm140663669662272"> <p>
											Update to this setting to mitigate CVE-2021-31920. This setting is more secure, but also has the potential to break applications. Test your applications before deploying to production.
										</p>
										 </td></tr></tbody></table></div></div><p>
							The normalization algorithms are conducted in the following order:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
									Percent-decode <code class="literal">%2F</code>, <code class="literal">%2f</code>, <code class="literal">%5C</code> and <code class="literal">%5c</code>.
								</li><li class="listitem">
									The <a class="link" href="https://tools.ietf.org/html/rfc3986">RFC 3986</a> and other normalization implemented by the <a class="link" href="https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-normalize-path"><code class="literal">normalize_path</code></a> option in Envoy.
								</li><li class="listitem">
									Merge slashes.
								</li></ol></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								While these normalization options represent recommendations from HTTP standards and common industry practices, applications may interpret a URL in any way it chooses to. When using denial policies, ensure that you understand how your application behaves.
							</p></div></div></section><section class="section" id="path-normalization-configuration-examples"><div class="titlepage"><div><div><h5 class="title">1.2.2.44.3. Path normalization configuration examples</h5></div></div></div><p>
							Ensuring Envoy normalizes request paths to match your backend services' expectations is critical to the security of your system. The following examples can be used as a reference for you to configure your system. The normalized URL paths, or the original URL paths if <code class="literal">NONE</code> is selected, will be:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
									Used to check against the authorization policies.
								</li><li class="listitem">
									Forwarded to the backend application.
								</li></ol></div><div class="table" id="idm140663673274304"><p class="title"><strong>Table 1.2. Configuration examples</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663669263568" scope="col">If your application…​</th><th align="left" valign="top" id="idm140663669262448" scope="col">Choose…​</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663669263568"> <p>
											Relies on the proxy to do normalization
										</p>
										 </td><td align="left" valign="top" headers="idm140663669262448"> <p>
											<code class="literal">BASE</code>, <code class="literal">MERGE_SLASHES</code> or <code class="literal">DECODE_AND_MERGE_SLASHES</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663669263568"> <p>
											Normalizes request paths based on <a class="link" href="https://tools.ietf.org/html/rfc3986">RFC 3986</a> and does not merge slashes.
										</p>
										 </td><td align="left" valign="top" headers="idm140663669262448"> <p>
											<code class="literal">BASE</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663669263568"> <p>
											Normalizes request paths based on <a class="link" href="https://tools.ietf.org/html/rfc3986">RFC 3986</a> and merges slashes, but does not decode <a class="link" href="https://tools.ietf.org/html/rfc3986#section-2.1">percent-encoded</a> slashes.
										</p>
										 </td><td align="left" valign="top" headers="idm140663669262448"> <p>
											<code class="literal">MERGE_SLASHES</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663669263568"> <p>
											Normalizes request paths based on <a class="link" href="https://tools.ietf.org/html/rfc3986">RFC 3986</a>, decodes <a class="link" href="https://tools.ietf.org/html/rfc3986#section-2.1">percent-encoded</a> slashes, and merges slashes.
										</p>
										 </td><td align="left" valign="top" headers="idm140663669262448"> <p>
											<code class="literal">DECODE_AND_MERGE_SLASHES</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663669263568"> <p>
											Processes request paths in a way that is incompatible with <a class="link" href="https://tools.ietf.org/html/rfc3986">RFC 3986</a>.
										</p>
										 </td><td align="left" valign="top" headers="idm140663669262448"> <p>
											<code class="literal">NONE</code>
										</p>
										 </td></tr></tbody></table></div></div></section><section class="section" id="configuring-your-smcp-for-path-normalization"><div class="titlepage"><div><div><h5 class="title">1.2.2.44.4. Configuring your SMCP for path normalization</h5></div></div></div><p>
							To configure path normalization for Red Hat OpenShift Service Mesh, specify the following in your <code class="literal">ServiceMeshControlPlane</code>. Use the configuration examples to help determine the settings for your system.
						</p><div class="formalpara"><p class="title"><strong>SMCP v2 pathNormalization</strong></p><p>
								
<pre class="programlisting language-yaml">spec:
  techPreview:
    global:
      pathNormalization: &lt;option&gt;</pre>

							</p></div></section><section class="section" id="configuring-for-case-normalization"><div class="titlepage"><div><div><h5 class="title">1.2.2.44.5. Configuring for case normalization</h5></div></div></div><p>
							In some environments, it may be useful to have paths in authorization policies compared in a case insensitive manner. For example, treating <code class="literal"><a class="link" href="https://myurl/get">https://myurl/get</a></code> and <code class="literal"><a class="link" href="https://myurl/GeT">https://myurl/GeT</a></code> as equivalent. In those cases, you can use the <code class="literal">EnvoyFilter</code> shown below. This filter will change both the path used for comparison and the path presented to the application. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
						</p><p>
							Save the <code class="literal">EnvoyFilter</code> to a file and run the following command:
						</p><pre class="programlisting language-terminal">$ oc create -f &lt;myEnvoyFilterFile&gt;</pre><pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: EnvoyFilter
metadata:
  name: ingress-case-insensitive
  namespace: istio-system
spec:
  configPatches:
  - applyTo: HTTP_FILTER
    match:
      context: GATEWAY
      listener:
        filterChain:
          filter:
            name: "envoy.filters.network.http_connection_manager"
            subFilter:
              name: "envoy.filters.http.router"
    patch:
      operation: INSERT_BEFORE
      value:
        name: envoy.lua
        typed_config:
            "@type": "type.googleapis.com/envoy.extensions.filters.http.lua.v3.Lua"
            inlineCode: |
              function envoy_on_request(request_handle)
                local path = request_handle:headers():get(":path")
                request_handle:headers():replace(":path", string.lower(path))
              end</pre></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-0-3"><div class="titlepage"><div><div><h4 class="title">1.2.2.45. New features Red Hat OpenShift Service Mesh 2.0.3</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p><p>
						In addition, this release has the following new features:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Added an option to the <code class="literal">must-gather</code> data collection tool that gathers information from a specified Service Mesh control plane namespace. For more information, see <a class="link" href="https://issues.redhat.com/browse/OSSM-351">OSSM-351</a>.
							</li><li class="listitem">
								Improved performance for Service Mesh control planes with hundreds of namespaces
							</li></ul></div></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-0-2"><div class="titlepage"><div><div><h4 class="title">1.2.2.46. New features Red Hat OpenShift Service Mesh 2.0.2</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh adds support for IBM Z and IBM Power Systems. It also addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-0-1"><div class="titlepage"><div><div><h4 class="title">1.2.2.47. New features Red Hat OpenShift Service Mesh 2.0.1</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-2-0"><div class="titlepage"><div><div><h4 class="title">1.2.2.48. New features Red Hat OpenShift Service Mesh 2.0</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh adds support for Istio 1.6.5, Jaeger 1.20.0, Kiali 1.24.2, and the 3scale Istio Adapter 2.0 and OpenShift Container Platform 4.6.
					</p><p>
						In addition, this release has the following new features:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Simplifies installation, upgrades, and management of the Service Mesh control plane.
							</li><li class="listitem">
								Reduces the Service Mesh control plane’s resource usage and startup time.
							</li><li class="listitem"><p class="simpara">
								Improves performance by reducing inter-control plane communication over networking.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Adds support for Envoy’s Secret Discovery Service (SDS). SDS is a more secure and efficient mechanism for delivering secrets to Envoy side car proxies.
									</li></ul></div></li><li class="listitem">
								Removes the need to use Kubernetes Secrets, which have well known security risks.
							</li><li class="listitem"><p class="simpara">
								Improves performance during certificate rotation, as proxies no longer require a restart to recognize new certificates.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Adds support for Istio’s Telemetry v2 architecture, which is built using WebAssembly extensions. This new architecture brings significant performance improvements.
									</li><li class="listitem">
										Updates the ServiceMeshControlPlane resource to v2 with a streamlined configuration to make it easier to manage the Service Mesh Control Plane.
									</li><li class="listitem">
										Introduces WebAssembly extensions as a <a class="link" href="https://access.redhat.com/support/offerings/techpreview">Technology Preview</a> feature.
									</li></ul></div></li></ul></div></section></section><section class="section" id="ossm-rn-tech-preview_ossm-release-notes"><div class="titlepage"><div><div><h3 class="title">1.2.3. Technology Preview</h3></div></div></div><p>
					Some features in this release are currently in Technology Preview. These experimental features are not intended for production use.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
					</p><p>
						For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
					</p></div></div></section><section class="section" id="ossm-deprecated-features_ossm-release-notes"><div class="titlepage"><div><div><h3 class="title">1.2.4. Deprecated and removed features</h3></div></div></div><p>
					Some features available in previous releases have been deprecated or removed.
				</p><p>
					Deprecated functionality is still included in OpenShift Container Platform and continues to be supported; however, it will be removed in a future release of this product and is not recommended for new deployments.
				</p><p>
					Removed functionality no longer exists in the product.
				</p><section class="section" id="deprecated-and-removed-features-in-red-hat-openshift-service-mesh-2-4"><div class="titlepage"><div><div><h4 class="title">1.2.4.1. Deprecated and removed features in Red Hat OpenShift Service Mesh 2.4</h4></div></div></div><p>
						The v2.1 <code class="literal">ServiceMeshControlPlane</code> resource is no longer supported. Customers should upgrade their mesh deployments to use a later version of the <code class="literal">ServiceMeshControlPlane</code> resource.
					</p><p>
						Support for Istio OpenShift Routing (IOR) is deprecated and will be removed in a future release.
					</p><p>
						Support for Grafana is deprecated and will be removed in a future release.
					</p><p>
						Support for the following cipher suites, which were deprecated in Red Hat OpenShift Service Mesh 2.3, has been removed from the default list of ciphers used in TLS negotiations on both the client and server sides. Applications that require access to services requiring one of these cipher suites will fail to connect when a TLS connection is initiated from the proxy.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								ECDHE-ECDSA-AES128-SHA
							</li><li class="listitem">
								ECDHE-RSA-AES128-SHA
							</li><li class="listitem">
								AES128-GCM-SHA256
							</li><li class="listitem">
								AES128-SHA
							</li><li class="listitem">
								ECDHE-ECDSA-AES256-SHA
							</li><li class="listitem">
								ECDHE-RSA-AES256-SHA
							</li><li class="listitem">
								AES256-GCM-SHA384
							</li><li class="listitem">
								AES256-SHA
							</li></ul></div></section><section class="section" id="deprecated-and-removed-features-in-red-hat-openshift-service-mesh-2-3"><div class="titlepage"><div><div><h4 class="title">1.2.4.2. Deprecated and removed features in Red Hat OpenShift Service Mesh 2.3</h4></div></div></div><p>
						Support for the following cipher suites has been deprecated. In a future release, they will be removed from the default list of ciphers used in TLS negotiations on both the client and server sides.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								ECDHE-ECDSA-AES128-SHA
							</li><li class="listitem">
								ECDHE-RSA-AES128-SHA
							</li><li class="listitem">
								AES128-GCM-SHA256
							</li><li class="listitem">
								AES128-SHA
							</li><li class="listitem">
								ECDHE-ECDSA-AES256-SHA
							</li><li class="listitem">
								ECDHE-RSA-AES256-SHA
							</li><li class="listitem">
								AES256-GCM-SHA384
							</li><li class="listitem">
								AES256-SHA
							</li></ul></div><p>
						The <code class="literal">ServiceMeshExtension</code> API, which was deprecated in Red Hat OpenShift Service Mesh version 2.2, was removed in Red Hat OpenShift Service Mesh version 2.3. If you are using the <code class="literal">ServiceMeshExtension</code> API, you must migrate to the <code class="literal">WasmPlugin</code> API to continue using your WebAssembly extensions.
					</p></section><section class="section" id="deprecated-features-in-red-hat-openshift-service-mesh-2-2"><div class="titlepage"><div><div><h4 class="title">1.2.4.3. Deprecated features in Red Hat OpenShift Service Mesh 2.2</h4></div></div></div><p>
						The <code class="literal">ServiceMeshExtension</code> API is deprecated as of release 2.2 and will be removed in a future release. While <code class="literal">ServiceMeshExtension</code> API is still supported in release 2.2, customers should start moving to the new <code class="literal">WasmPlugin</code> API.
					</p></section><section class="section" id="removed-features-in-red-hat-openshift-service-mesh-2-2"><div class="titlepage"><div><div><h4 class="title">1.2.4.4. Removed features in Red Hat OpenShift Service Mesh 2.2</h4></div></div></div><p>
						This release marks the end of support for Service Mesh control planes based on Service Mesh 1.1 for all platforms.
					</p></section><section class="section" id="removed-features-in-red-hat-openshift-service-mesh-2-1"><div class="titlepage"><div><div><h4 class="title">1.2.4.5. Removed features in Red Hat OpenShift Service Mesh 2.1</h4></div></div></div><p>
						In Service Mesh 2.1, the Mixer component is removed. Bug fixes and support is provided through the end of the Service Mesh 2.0 life cycle.
					</p><p>
						Upgrading from a Service Mesh 2.0.x release to 2.1 will not proceed if Mixer plugins are enabled. Mixer plugins must be ported to WebAssembly Extensions.
					</p></section><section class="section" id="deprecated-features-in-red-hat-openshift-service-mesh-2-0"><div class="titlepage"><div><div><h4 class="title">1.2.4.6. Deprecated features in Red Hat OpenShift Service Mesh 2.0</h4></div></div></div><p>
						The Mixer component was deprecated in release 2.0 and will be removed in release 2.1. While using Mixer for implementing extensions was still supported in release 2.0, extensions should have been migrated to the new <a class="link" href="https://istio.io/latest/blog/2020/wasm-announce/">WebAssembly</a> mechanism.
					</p><p>
						The following resource types are no longer supported in Red Hat OpenShift Service Mesh 2.0:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<code class="literal">Policy</code> (authentication.istio.io/v1alpha1) is no longer supported. Depending on the specific configuration in your Policy resource, you may have to configure multiple resources to achieve the same effect.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Use <code class="literal">RequestAuthentication</code> (security.istio.io/v1beta1)
									</li><li class="listitem">
										Use <code class="literal">PeerAuthentication</code> (security.istio.io/v1beta1)
									</li></ul></div></li><li class="listitem"><p class="simpara">
								<code class="literal">ServiceMeshPolicy</code> (maistra.io/v1) is no longer supported.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Use <code class="literal">RequestAuthentication</code> or <code class="literal">PeerAuthentication</code>, as mentioned above, but place in the Service Mesh control plane namespace.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								<code class="literal">RbacConfig</code> (rbac.istio.io/v1alpha1) is no longer supported.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Replaced by <code class="literal">AuthorizationPolicy</code> (security.istio.io/v1beta1), which encompasses behavior of <code class="literal">RbacConfig</code>, <code class="literal">ServiceRole</code>, and <code class="literal">ServiceRoleBinding</code>.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								<code class="literal">ServiceMeshRbacConfig</code> (maistra.io/v1) is no longer supported.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Use <code class="literal">AuthorizationPolicy</code> as above, but place in Service Mesh control plane namespace.
									</li></ul></div></li><li class="listitem">
								<code class="literal">ServiceRole</code> (rbac.istio.io/v1alpha1) is no longer supported.
							</li><li class="listitem">
								<code class="literal">ServiceRoleBinding</code> (rbac.istio.io/v1alpha1) is no longer supported.
							</li><li class="listitem">
								In Kiali, the <code class="literal">login</code> and <code class="literal">LDAP</code> strategies are deprecated. A future version will introduce authentication using OpenID providers.
							</li></ul></div></section></section><section class="section" id="ossm-rn-known-issues_ossm-release-notes"><div class="titlepage"><div><div><h3 class="title">1.2.5. Known issues</h3></div></div></div><p>
					These limitations exist in Red Hat OpenShift Service Mesh:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Red Hat OpenShift Service Mesh does not yet fully support <a class="link" href="https://issues.redhat.com/browse/MAISTRA-1314">IPv6</a>. As a result, Red Hat OpenShift Service Mesh does not support dual-stack clusters.
						</li><li class="listitem">
							Graph layout - The layout for the Kiali graph can render differently, depending on your application architecture and the data to display (number of graph nodes and their interactions). Because it is difficult if not impossible to create a single layout that renders nicely for every situation, Kiali offers a choice of several different layouts. To choose a different layout, you can choose a different <span class="strong strong"><strong>Layout Schema</strong></span> from the <span class="strong strong"><strong>Graph Settings</strong></span> menu.
						</li><li class="listitem">
							The first time you access related services such as distributed tracing platform (Jaeger) and Grafana, from the Kiali console, you must accept the certificate and re-authenticate using your OpenShift Container Platform login credentials. This happens due to an issue with how the framework displays embedded pages in the console.
						</li><li class="listitem">
							The Bookinfo sample application cannot be installed on IBM Power, IBM Z, and IBM® LinuxONE.
						</li><li class="listitem">
							WebAssembly extensions are not supported on IBM Power, IBM Z, and IBM® LinuxONE.
						</li><li class="listitem">
							LuaJIT is not supported on IBM Power, IBM Z, and IBM® LinuxONE.
						</li><li class="listitem">
							Single stack IPv6 support is not available on IBM Power, IBM Z, and IBM® LinuxONE.
						</li></ul></div><section class="section" id="ossm-rn-known-issues-ossm_ossm-release-notes"><div class="titlepage"><div><div><h4 class="title">1.2.5.1. Service Mesh known issues</h4></div></div></div><p>
						These are the known issues in Red Hat OpenShift Service Mesh:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-3890">OSSM-3890</a> Attempting to use the Gateway API in a multitenant mesh deployment generates an error message similar to the following:
							</p><pre class="programlisting language-text">2023-05-02T15:20:42.541034Z	error	watch error in cluster Kubernetes: failed to list *v1alpha2.TLSRoute: the server could not find the requested resource (get tlsroutes.gateway.networking.k8s.io)
2023-05-02T15:20:42.616450Z	info	kube	controller "gateway.networking.k8s.io/v1alpha2/TCPRoute" is syncing...</pre><p class="simpara">
								To support Gateway API in a multitenant mesh deployment, all Gateway API Custom Resource Definition (CRD) files must be present in the cluster.
							</p><p class="simpara">
								In a multitenant mesh deployment, CRD scan is disabled, and Istio has no way to discover which CRDs are present in a cluster. As a result, Istio attempts to watch all supported Gateway API CRDs, but generates errors if some of those CRDs are not present.
							</p><p class="simpara">
								Service Mesh 2.3.1 and later versions support both <code class="literal">v1alpha2</code> and <code class="literal">v1beta1</code> CRDs. Therefore, both CRD versions must be present for a multitenant mesh deployment to support the Gateway API.
							</p><p class="simpara">
								Workaround: In the following example, the <code class="literal">kubectl get</code> operation installs the <code class="literal">v1alpha2</code> and <code class="literal">v1beta1</code> CRDs. Note the URL contains the additional <code class="literal">experimental</code> segment and updates any of your existing scripts accordingly:
							</p><pre class="programlisting language-terminal">$ kubectl get crd gateways.gateway.networking.k8s.io ||   { kubectl kustomize "github.com/kubernetes-sigs/gateway-api/config/crd/experimental?ref=v0.5.1" | kubectl apply -f -; }</pre></li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-2042">OSSM-2042</a> Deployment of SMCP named <code class="literal">default</code> fails. If you are creating an SMCP object, and set its version field to v2.3, the name of the object cannot be <code class="literal">default</code>. If the name is <code class="literal">default</code>, then the control plane fails to deploy, and OpenShift generates a <code class="literal">Warning</code> event with the following message:
							</p><p class="simpara">
								<code class="literal">Error processing component mesh-config: error: [mesh-config/templates/telemetryv2_1.6.yaml: Internal error occurred: failed calling webhook "rev.validation.istio.io": Post "https://istiod-default.istio-system.svc:443/validate?timeout=10s": x509: certificate is valid for istiod.istio-system.svc, istiod-remote.istio-system.svc, istio-pilot.istio-system.svc, not istiod-default.istio-system.svc, mesh-config/templates/enable-mesh-permissive.yaml</code>
							</p></li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-1655">OSSM-1655</a> Kiali dashboard shows error after enabling mTLS in <code class="literal">SMCP</code>.
							</p><p class="simpara">
								After enabling the <code class="literal">spec.security.controlPlane.mtls</code> setting in the SMCP, the Kiali console displays the following error message <code class="literal">No subsets defined</code>.
							</p></li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-1505">OSSM-1505</a> This issue only occurs when using the <code class="literal">ServiceMeshExtension</code> resource on OpenShift Container Platform 4.11. When you use <code class="literal">ServiceMeshExtension</code> on OpenShift Container Platform 4.11 the resource never becomes ready. If you inspect the issue using <code class="literal">oc describe ServiceMeshExtension</code> you will see the following error: <code class="literal">stderr: Error creating mount namespace before pivot: function not implemented</code>.
							</p><p class="simpara">
								Workaround: <code class="literal">ServiceMeshExtension</code> was deprecated in Service Mesh 2.2. Migrate from <code class="literal">ServiceMeshExtension</code> to the <code class="literal">WasmPlugin</code> resource. For more information, see Migrating from <code class="literal">ServiceMeshExtension</code> to <code class="literal">WasmPlugin</code> resources.
							</p></li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-1396">OSSM-1396</a> If a gateway resource contains the <code class="literal">spec.externalIPs</code> setting, instead of being recreated when the <code class="literal">ServiceMeshControlPlane</code> is updated, the gateway is removed and never recreated.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-1168">OSSM-1168</a> When service mesh resources are created as a single YAML file, the Envoy proxy sidecar is not reliably injected into pods. When the SMCP, SMMR, and Deployment resources are created individually, the deployment works as expected.
							</li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-1115">OSSM-1115</a> The <code class="literal">concurrency</code> field of the <code class="literal">spec.proxy</code> API did not propagate to the istio-proxy. The <code class="literal">concurrency</code> field works when set with <code class="literal">ProxyConfig</code>. The <code class="literal">concurrency</code> field specifies the number of worker threads to run. If the field is set to <code class="literal">0</code>, then the number of worker threads available is equal to the number of CPU cores. If the field is not set, then the number of worker threads available defaults to <code class="literal">2</code>.
							</p><p class="simpara">
								In the following example, the <code class="literal">concurrency</code> field is set to <code class="literal">0</code>.
							</p><pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1beta1
kind: ProxyConfig
metadata:
  name: mesh-wide-concurrency
  namespace: &lt;istiod-namespace&gt;
spec:
  concurrency: 0</pre></li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-1052">OSSM-1052</a> When configuring a Service <code class="literal">ExternalIP</code> for the ingressgateway in the Service Mesh control plane, the service is not created. The schema for the SMCP is missing the parameter for the service.
							</p><p class="simpara">
								Workaround: Disable the gateway creation in the SMCP spec and manage the gateway deployment entirely manually (including Service, Role and RoleBinding).
							</p></li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-882">OSSM-882</a> This applies for Service Mesh 2.1 and earlier. Namespace is in the accessible_namespace list but does not appear in Kiali UI. By default, Kiali will not show any namespaces that start with "kube" because these namespaces are typically internal-use only and not part of a mesh.
							</p><p class="simpara">
								For example, if you create a namespace called 'akube-a' and add it to the Service Mesh member roll, then the Kiali UI does not display the namespace. For defined exclusion patterns, the software excludes namespaces that start with or contain the pattern.
							</p><p class="simpara">
								Workaround: Change the Kiali Custom Resource setting so it prefixes the setting with a carat (^). For example:
							</p><pre class="programlisting language-yaml">api:
  namespaces:
    exclude:
    - "^istio-operator"
    - "^kube-.*"
    - "^openshift.*"
    - "^ibm.*"
    - "^kiali-operator"</pre></li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-2692">MAISTRA-2692</a> With Mixer removed, custom metrics that have been defined in Service Mesh 2.0.x cannot be used in 2.1. Custom metrics can be configured using <code class="literal">EnvoyFilter</code>. Red Hat is unable to support <code class="literal">EnvoyFilter</code> configuration except where explicitly documented. This is due to tight coupling with the underlying Envoy APIs, meaning that backward compatibility cannot be maintained.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-2648">MAISTRA-2648</a> Service mesh extensions are currently not compatible with meshes deployed on IBM Z.
							</li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-1959">MAISTRA-1959</a> <span class="emphasis"><em>Migration to 2.0</em></span> Prometheus scraping (<code class="literal">spec.addons.prometheus.scrape</code> set to <code class="literal">true</code>) does not work when mTLS is enabled. Additionally, Kiali displays extraneous graph data when mTLS is disabled.
							</p><p class="simpara">
								This problem can be addressed by excluding port 15020 from proxy configuration, for example,
							</p><pre class="programlisting language-yaml">spec:
  proxy:
    networking:
      trafficControl:
        inbound:
          excludedPorts:
          - 15020</pre></li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-453">MAISTRA-453</a> If you create a new project and deploy pods immediately, sidecar injection does not occur. The operator fails to add the <code class="literal">maistra.io/member-of</code> before the pods are created, therefore the pods must be deleted and recreated for sidecar injection to occur.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-158">MAISTRA-158</a> Applying multiple gateways referencing the same hostname will cause all gateways to stop functioning.
							</li></ul></div></section><section class="section" id="ossm-rn-known-issues-kiali_ossm-release-notes"><div class="titlepage"><div><div><h4 class="title">1.2.5.2. Kiali known issues</h4></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							New issues for Kiali should be created in the <a class="link" href="https://issues.redhat.com/projects/OSSM/">OpenShift Service Mesh</a> project with the <code class="literal">Component</code> set to <code class="literal">Kiali</code>.
						</p></div></div><p>
						These are the known issues in Kiali:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/KIALI-2206">KIALI-2206</a> When you are accessing the Kiali console for the first time, and there is no cached browser data for Kiali, the “View in Grafana” link on the Metrics tab of the Kiali Service Details page redirects to the wrong location. The only way you would encounter this issue is if you are accessing Kiali for the first time.
							</li><li class="listitem">
								<a class="link" href="https://github.com/kiali/kiali/issues/507">KIALI-507</a> Kiali does not support Internet Explorer 11. This is because the underlying frameworks do not support Internet Explorer. To access the Kiali console, use one of the two most recent versions of the Chrome, Edge, Firefox or Safari browser.
							</li></ul></div></section></section><section class="section" id="ossm-rn-fixed-issues_ossm-release-notes"><div class="titlepage"><div><div><h3 class="title">1.2.6. Fixed issues</h3></div></div></div><p>
					The following issues have been resolved in previous releases:
				</p><section class="section" id="ossm-rn-fixed-issues-ossm_ossm-release-notes"><div class="titlepage"><div><div><h4 class="title">1.2.6.1. Service Mesh fixed issues</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-4197">OSSM-4197</a> Previously, if you deployed a v2.2 or v2.1 of the 'ServiceMeshControlPlane' resource, the <code class="literal">/etc/cni/multus/net.d/</code> directory was not created. As a result, the <code class="literal">istio-cni</code> pod failed to become ready, and the <code class="literal">istio-cni</code> pods log contained the following message:
							</p><pre class="programlisting language-terminal">$ error   Installer exits with open /host/etc/cni/multus/net.d/v2-2-istio-cni.kubeconfig.tmp.841118073: no such file or directory</pre><p class="simpara">
								Now, if you deploy a v2.2 or v2.1 of the 'ServiceMeshControlPlane' resource, the <code class="literal">/etc/cni/multus/net.d/</code> directory is created, and the <code class="literal">istio-cni</code> pod becomes ready.
							</p></li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-3993">OSSM-3993</a> Previously, Kiali only supported OpenShift OAuth via a proxy on the standard HTTPS port of <code class="literal">443</code>. Now, Kiali supports OpenShift OAuth over a non-standard HTTPS port. To enable the port, you must set the <code class="literal">spec.server.web_port</code> field to the proxy’s non-standard HTTPS port in the Kiali CR.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-3936">OSSM-3936</a> Previously, the values for the <code class="literal">injection_label_rev</code> and <code class="literal">injection_label_name</code> attributes were hardcoded. This prevented custom configurations from taking effect in the Kiali Custom Resource Definition (CRD). Now, the attribute values are not hardcoded. You can customize the values for the <code class="literal">injection_label_rev</code> and <code class="literal">injection_label_name</code> attributes in the <code class="literal">spec.istio_labels</code> specification.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-3644">OSSM-3644</a> Previously, the federation egress-gateway received the wrong update of network gateway endpoints, causing extra endpoint entries. Now, the federation-egress gateway has been updated on the server side so it receives the correct network gateway endpoints.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-3595">OSSM-3595</a> Previously, the <code class="literal">istio-cni</code> plugin sometimes failed on RHEL because SELinux did not allow the utility <code class="literal">iptables-restore</code> to open files in the <code class="literal">/tmp</code> directory. Now, SELinux passes <code class="literal">iptables-restore</code> via <code class="literal">stdin</code> input stream instead of via a file.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-3586">OSSM-3586</a> Previously, Istio proxies were slow to start when Google Cloud Platform (GCP) metadata servers were not available. When you upgrade to Istio 1.14.6, Istio proxies start as expected on GCP, even if metadata servers are not available.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-3025">OSSM-3025</a> Istiod sometimes fails to become ready. Sometimes, when a mesh contained many member namespaces, the Istiod pod did not become ready due to a deadlock within Istiod. The deadlock is now resolved and the pod now starts as expected.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-2493">OSSM-2493</a> Default <code class="literal">nodeSelector</code> and <code class="literal">tolerations</code> in SMCP not passed to Kiali. The <code class="literal">nodeSelector</code> and <code class="literal">tolerations</code> you add to <code class="literal">SMCP.spec.runtime.defaults</code> are now passed to the Kiali resource.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-2492">OSSM-2492</a> Default tolerations in SMCP not passed to Jaeger. The <code class="literal">nodeSelector</code> and <code class="literal">tolerations</code> you add to <code class="literal">SMCP.spec.runtime.defaults</code> are now passed to the Jaeger resource.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-2374">OSSM-2374</a> If you deleted one of the <code class="literal">ServiceMeshMember</code> resources, then the Service Mesh operator deleted the <code class="literal">ServiceMeshMemberRoll</code>. While this is expected behavior when you delete the last <code class="literal">ServiceMeshMember</code>, the operator should not delete the <code class="literal">ServiceMeshMemberRoll</code> if it contains any members in addition to the one that was deleted. This issue is now fixed and the operator only deletes the ServiceMeshMemberRoll when the last <code class="literal">ServiceMeshMember</code> resource is deleted.
							</li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-2373">OSSM-2373</a> Error trying to get OAuth metadata when logging in. To fetch the cluster version, the <code class="literal">system:anonymous</code> account is used. With the cluster’s default bundled ClusterRoles and ClusterRoleBinding, the anonymous account can fetch the version correctly. If the <code class="literal">system:anonymous</code> account loses its privileges to fetch the cluster version, OpenShift authentication becomes unusable.
							</p><p class="simpara">
								This is fixed by using the Kiali SA to fetch the cluster version. This also allows for improved security on the cluster.
							</p></li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-2371">OSSM-2371</a> Despite Kiali being configured as "view-only," a user can change the proxy logging level via the Workload details' Logs tab’s kebab menu. This issue has been fixed so the options under "Set Proxy Log Level" are disabled when Kiali is configured as "view-only."
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-2344">OSSM-2344</a> Restarting Istiod causes Kiali to flood CRI-O with port-forward requests. This issue occurred when Kiali could not connect to Istiod and Kiali simultaneously issued a large number of requests to istiod. Kiali now limits the number of requests it sends to istiod.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-2335">OSSM-2335</a> Dragging the mouse pointer over the Traces scatterchart plot sometimes caused the Kiali console to stop responding due to concurrent backend requests.
							</li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-2221">OSSM-2221</a> Previously, gateway injection in the <code class="literal">ServiceMeshControlPlane</code> namespace was not possible because the <code class="literal">ignore-namespace</code> label was applied to the namespace by default.
							</p><p class="simpara">
								When creating a v2.4 control plane, the namespace no longer has the <code class="literal">ignore-namespace</code> label applied, and gateway injection is possible.
							</p><p class="simpara">
								In the following example, the <code class="literal">oc label</code> command removes the <code class="literal">ignore-namespace</code> label from a namespace in an existing deployment:
							</p><pre class="programlisting language-terminal">$ oc label namespace &lt;istio_system&gt; maistra.io/ignore-namespace-</pre><p class="simpara">
								In the example above, &lt;istio_system&gt; represents the name of the <code class="literal">ServiceMeshControlPlane</code> namespace.
							</p></li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-2053">OSSM-2053</a> Using Red Hat OpenShift Service Mesh Operator 2.2 or 2.3, during SMCP reconciliation, the SMMR controller removed the member namespaces from <code class="literal">SMMR.status.configuredMembers</code>. This caused the services in the member namespaces to become unavailable for a few moments.
							</p><p class="simpara">
								Using Red Hat OpenShift Service Mesh Operator 2.2 or 2.3, the SMMR controller no longer removes the namespaces from <code class="literal">SMMR.status.configuredMembers</code>. Instead, the controller adds the namespaces to <code class="literal">SMMR.status.pendingMembers</code> to indicate that they are not up-to-date. During reconciliation, as each namespace synchronizes with the SMCP, the namespace is automatically removed from <code class="literal">SMMR.status.pendingMembers</code>.
							</p></li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-1962">OSSM-1962</a> Use <code class="literal">EndpointSlices</code> in federation controller. The federation controller now uses <code class="literal">EndpointSlices</code>, which improves scalability and performance in large deployments. The PILOT_USE_ENDPOINT_SLICE flag is enabled by default. Disabling the flag prevents use of federation deployments.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-1668">OSSM-1668</a> A new field <code class="literal">spec.security.jwksResolverCA</code> was added to the Version 2.1 <code class="literal">SMCP</code> but was missing in the 2.2.0 and 2.2.1 releases. When upgrading from an Operator version where this field was present to an Operator version that was missing this field, the <code class="literal">.spec.security.jwksResolverCA</code> field was not available in the <code class="literal">SMCP</code>.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-1325">OSSM-1325</a> istiod pod crashes and displays the following error message: <code class="literal">fatal error: concurrent map iteration and map write</code>.
							</li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-1211">OSSM-1211</a> Configuring Federated service meshes for failover does not work as expected.
							</p><p class="simpara">
								The Istiod pilot log displays the following error: <code class="literal">envoy connection [C289] TLS error: 337047686:SSL routines:tls_process_server_certificate:certificate verify failed</code>
							</p></li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-1099">OSSM-1099</a> The Kiali console displayed the message <code class="literal">Sorry, there was a problem. Try a refresh or navigate to a different page.</code>
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-1074">OSSM-1074</a> Pod annotations defined in SMCP are not injected in the pods.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-999">OSSM-999</a> Kiali retention did not work as expected. Calendar times were greyed out in the dashboard graph.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-797">OSSM-797</a> Kiali Operator pod generates <code class="literal">CreateContainerConfigError</code> while installing or updating the operator.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-722">OSSM-722</a> Namespace starting with <code class="literal">kube</code> is hidden from Kiali.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-569">OSSM-569</a> There is no CPU memory limit for the Prometheus <code class="literal">istio-proxy</code> container. The Prometheus <code class="literal">istio-proxy</code> sidecar now uses the resource limits defined in <code class="literal">spec.proxy.runtime.container</code>.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-535">OSSM-535</a> Support validationMessages in SMCP. The <code class="literal">ValidationMessages</code> field in the Service Mesh Control Plane can now be set to <code class="literal">True</code>. This writes a log for the status of the resources, which can be helpful when troubleshooting problems.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-449">OSSM-449</a> VirtualService and Service causes an error "Only unique values for domains are permitted. Duplicate entry of domain."
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-419">OSSM-419</a> Namespaces with similar names will all show in Kiali namespace list, even though namespaces may not be defined in Service Mesh Member Role.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-296">OSSM-296</a> When adding health configuration to the Kiali custom resource (CR) is it not being replicated to the Kiali configmap.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-291">OSSM-291</a> In the Kiali console, on the Applications, Services, and Workloads pages, the "Remove Label from Filters" function is not working.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-289">OSSM-289</a> In the Kiali console, on the Service Details pages for the 'istio-ingressgateway' and 'jaeger-query' services there are no Traces being displayed. The traces exist in Jaeger.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-287">OSSM-287</a> In the Kiali console there are no traces being displayed on the Graph Service.
							</li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-285">OSSM-285</a> When trying to access the Kiali console, receive the following error message "Error trying to get OAuth Metadata".
							</p><p class="simpara">
								Workaround: Restart the Kiali pod.
							</p></li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-2735">MAISTRA-2735</a> The resources that the Service Mesh Operator deletes when reconciling the SMCP changed in Red Hat OpenShift Service Mesh version 2.1. Previously, the Operator deleted a resource with the following labels:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">maistra.io/owner</code>
									</li><li class="listitem">
										<code class="literal">app.kubernetes.io/version</code>
									</li></ul></div><p class="simpara">
								Now, the Operator ignores resources that does not also include the <code class="literal">app.kubernetes.io/managed-by=maistra-istio-operator</code> label. If you create your own resources, you should not add the <code class="literal">app.kubernetes.io/managed-by=maistra-istio-operator</code> label to them.
							</p></li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-2687">MAISTRA-2687</a> Red Hat OpenShift Service Mesh 2.1 federation gateway does not send the full certificate chain when using external certificates. The Service Mesh federation egress gateway only sends the client certificate. Because the federation ingress gateway only knows about the root certificate, it cannot verify the client certificate unless you add the root certificate to the federation import <code class="literal">ConfigMap</code>.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-2635">MAISTRA-2635</a> Replace deprecated Kubernetes API. To remain compatible with OpenShift Container Platform 4.8, the <code class="literal">apiextensions.k8s.io/v1beta1</code> API was deprecated as of Red Hat OpenShift Service Mesh 2.0.8.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-2631">MAISTRA-2631</a> The WASM feature is not working because podman is failing due to nsenter binary not being present. Red Hat OpenShift Service Mesh generates the following error message: <code class="literal">Error: error configuring CNI network plugin exec: "nsenter": executable file not found in $PATH</code>. The container image now contains nsenter and WASM works as expected.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-2534">MAISTRA-2534</a> When istiod attempted to fetch the JWKS for an issuer specified in a JWT rule, the issuer service responded with a 502. This prevented the proxy container from becoming ready and caused deployments to hang. The fix for the <a class="link" href="https://github.com/istio/istio/issues/24629">community bug</a> has been included in the Service Mesh 2.0.7 release.
							</li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-2411">MAISTRA-2411</a> When the Operator creates a new ingress gateway using <code class="literal">spec.gateways.additionaIngress</code> in the <code class="literal">ServiceMeshControlPlane</code>, Operator is not creating a <code class="literal">NetworkPolicy</code> for the additional ingress gateway like it does for the default istio-ingressgateway. This is causing a 503 response from the route of the new gateway.
							</p><p class="simpara">
								Workaround: Manually create the <code class="literal">NetworkPolicy</code> in the &lt;istio-system&gt; namespace.
							</p></li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-2401">MAISTRA-2401</a> CVE-2021-3586 servicemesh-operator: NetworkPolicy resources incorrectly specified ports for ingress resources. The NetworkPolicy resources installed for Red Hat OpenShift Service Mesh did not properly specify which ports could be accessed. This allowed access to all ports on these resources from any pod. Network policies applied to the following resources are affected:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Galley
									</li><li class="listitem">
										Grafana
									</li><li class="listitem">
										Istiod
									</li><li class="listitem">
										Jaeger
									</li><li class="listitem">
										Kiali
									</li><li class="listitem">
										Prometheus
									</li><li class="listitem">
										Sidecar injector
									</li></ul></div></li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-2378">MAISTRA-2378</a> When the cluster is configured to use OpenShift SDN with <code class="literal">ovs-multitenant</code> and the mesh contains a large number of namespaces (200+), the OpenShift Container Platform networking plugin is unable to configure the namespaces quickly. Service Mesh times out causing namespaces to be continuously dropped from the service mesh and then reenlisted.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-2370">MAISTRA-2370</a> Handle tombstones in listerInformer. The updated cache codebase was not handling tombstones when translating the events from the namespace caches to the aggregated cache, leading to a panic in the go routine.
							</li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-2117">MAISTRA-2117</a> Add optional <code class="literal">ConfigMap</code> mount to operator. The CSV now contains an optional <code class="literal">ConfigMap</code> volume mount, which mounts the <code class="literal">smcp-templates</code> <code class="literal">ConfigMap</code> if it exists. If the <code class="literal">smcp-templates</code> <code class="literal">ConfigMap</code> does not exist, the mounted directory is empty. When you create the <code class="literal">ConfigMap</code>, the directory is populated with the entries from the <code class="literal">ConfigMap</code> and can be referenced in <code class="literal">SMCP.spec.profiles</code>. No restart of the Service Mesh operator is required.
							</p><p class="simpara">
								Customers using the 2.0 operator with a modified CSV to mount the smcp-templates ConfigMap can upgrade to Red Hat OpenShift Service Mesh 2.1. After upgrading, you can continue using an existing ConfigMap, and the profiles it contains, without editing the CSV. Customers that previously used ConfigMap with a different name will either have to rename the ConfigMap or update the CSV after upgrading.
							</p></li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-2010">MAISTRA-2010</a> AuthorizationPolicy does not support <code class="literal">request.regex.headers</code> field. The <code class="literal">validatingwebhook</code> rejects any AuthorizationPolicy with the field, and even if you disable that, Pilot tries to validate it using the same code, and it does not work.
							</li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-1979">MAISTRA-1979</a> <span class="emphasis"><em>Migration to 2.0</em></span> The conversion webhook drops the following important fields when converting <code class="literal">SMCP.status</code> from v2 to v1:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										conditions
									</li><li class="listitem">
										components
									</li><li class="listitem">
										observedGeneration
									</li><li class="listitem"><p class="simpara">
										annotations
									</p><p class="simpara">
										Upgrading the operator to 2.0 might break client tools that read the SMCP status using the maistra.io/v1 version of the resource.
									</p><p class="simpara">
										This also causes the READY and STATUS columns to be empty when you run <code class="literal">oc get servicemeshcontrolplanes.v1.maistra.io</code>.
									</p></li></ul></div></li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-1947">MAISTRA-1947</a> <span class="emphasis"><em>Technology Preview</em></span> Updates to ServiceMeshExtensions are not applied.
							</p><p class="simpara">
								Workaround: Remove and recreate the <code class="literal">ServiceMeshExtensions</code>.
							</p></li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-1983">MAISTRA-1983</a> <span class="emphasis"><em>Migration to 2.0</em></span> Upgrading to 2.0.0 with an existing invalid <code class="literal">ServiceMeshControlPlane</code> cannot easily be repaired. The invalid items in the <code class="literal">ServiceMeshControlPlane</code> resource caused an unrecoverable error. The fix makes the errors recoverable. You can delete the invalid resource and replace it with a new one or edit the resource to fix the errors. For more information about editing your resource, see [Configuring the Red Hat OpenShift Service Mesh installation].
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-1502">MAISTRA-1502</a> As a result of CVEs fixes in version 1.0.10, the Istio dashboards are not available from the <span class="strong strong"><strong>Home Dashboard</strong></span> menu in Grafana. To access the Istio dashboards, click the <span class="strong strong"><strong>Dashboard</strong></span> menu in the navigation panel and select the <span class="strong strong"><strong>Manage</strong></span> tab.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-1399">MAISTRA-1399</a> Red Hat OpenShift Service Mesh no longer prevents you from installing unsupported CNI protocols. The supported network configurations has not changed.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-1089">MAISTRA-1089</a> <span class="emphasis"><em>Migration to 2.0</em></span> Gateways created in a non-control plane namespace are automatically deleted. After removing the gateway definition from the SMCP spec, you need to manually delete these resources.
							</li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-858">MAISTRA-858</a> The following Envoy log messages describing <a class="link" href="https://www.envoyproxy.io/docs/envoy/latest/intro/deprecated">deprecated options and configurations associated with Istio 1.1.x</a> are expected:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										[2019-06-03 07:03:28.943][19][warning][misc] [external/envoy/source/common/protobuf/utility.cc:129] Using deprecated option 'envoy.api.v2.listener.Filter.config'. This configuration will be removed from Envoy soon.
									</li><li class="listitem">
										[2019-08-12 22:12:59.001][13][warning][misc] [external/envoy/source/common/protobuf/utility.cc:174] Using deprecated option 'envoy.api.v2.Listener.use_original_dst' from file lds.proto. This configuration will be removed from Envoy soon.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-806">MAISTRA-806</a> Evicted Istio Operator Pod causes mesh and CNI not to deploy.
							</p><p class="simpara">
								Workaround: If the <code class="literal">istio-operator</code> pod is evicted while deploying the control pane, delete the evicted <code class="literal">istio-operator</code> pod.
							</p></li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-681">MAISTRA-681</a> When the Service Mesh control plane has many namespaces, it can lead to performance issues.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-193">MAISTRA-193</a> Unexpected console info messages are visible when health checking is enabled for citadel.
							</li><li class="listitem">
								<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=1821432">Bugzilla 1821432</a> The toggle controls in OpenShift Container Platform Custom Resource details page does not update the CR correctly. UI Toggle controls in the Service Mesh Control Plane (SMCP) Overview page in the OpenShift Container Platform web console sometimes updates the wrong field in the resource. To update a SMCP, edit the YAML content directly or update the resource from the command line instead of clicking the toggle controls.
							</li></ul></div></section></section></section><section class="section" id="ossm-architecture"><div class="titlepage"><div><div><h2 class="title">1.3. Understanding Service Mesh</h2></div></div></div><p>
				Red Hat OpenShift Service Mesh provides a platform for behavioral insight and operational control over your networked microservices in a service mesh. With Red Hat OpenShift Service Mesh, you can connect, secure, and monitor microservices in your OpenShift Container Platform environment.
			</p><section class="section" id="ossm-understanding-service-mesh_ossm-architecture"><div class="titlepage"><div><div><h3 class="title">1.3.1. Understanding service mesh</h3></div></div></div><p>
					A <span class="emphasis"><em>service mesh</em></span> is the network of microservices that make up applications in a distributed microservice architecture and the interactions between those microservices. When a Service Mesh grows in size and complexity, it can become harder to understand and manage.
				</p><p>
					Based on the open source <a class="link" href="https://istio.io/">Istio</a> project, Red Hat OpenShift Service Mesh adds a transparent layer on existing distributed applications without requiring any changes to the service code. You add Red Hat OpenShift Service Mesh support to services by deploying a special sidecar proxy to relevant services in the mesh that intercepts all network communication between microservices. You configure and manage the Service Mesh using the Service Mesh control plane features.
				</p><p>
					Red Hat OpenShift Service Mesh gives you an easy way to create a network of deployed services that provide:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Discovery
						</li><li class="listitem">
							Load balancing
						</li><li class="listitem">
							Service-to-service authentication
						</li><li class="listitem">
							Failure recovery
						</li><li class="listitem">
							Metrics
						</li><li class="listitem">
							Monitoring
						</li></ul></div><p>
					Red Hat OpenShift Service Mesh also provides more complex operational functions including:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A/B testing
						</li><li class="listitem">
							Canary releases
						</li><li class="listitem">
							Access control
						</li><li class="listitem">
							End-to-end authentication
						</li></ul></div></section><section class="section" id="ossm-architecture_ossm-architecture"><div class="titlepage"><div><div><h3 class="title">1.3.2. Service Mesh architecture</h3></div></div></div><p>
					Service mesh technology operates at the network communication level. That is, service mesh components capture or intercept traffic to and from microservices, either modifying requests, redirecting them, or creating new requests to other services.
				</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/f59a87f7fbacaa4463a28e892881c6d7/ossm-architecture.png" alt="Service Mesh architecture image"/></div></div><p>
					At a high level, Red Hat OpenShift Service Mesh consists of a data plane and a control plane
				</p><p>
					The <span class="strong strong"><strong>data plane</strong></span> is a set of intelligent proxies, running alongside application containers in a pod, that intercept and control all inbound and outbound network communication between microservices in the service mesh. The data plane is implemented in such a way that it intercepts all inbound (ingress) and outbound (egress) network traffic. The Istio data plane is composed of Envoy containers running along side application containers in a pod. The Envoy container acts as a proxy, controlling all network communication into and out of the pod.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>Envoy proxies</strong></span> are the only Istio components that interact with data plane traffic. All incoming (ingress) and outgoing (egress) network traffic between services flows through the proxies. The Envoy proxy also collects all metrics related to services traffic within the mesh. Envoy proxies are deployed as sidecars, running in the same pod as services. Envoy proxies are also used to implement mesh gateways.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<span class="strong strong"><strong>Sidecar proxies</strong></span> manage inbound and outbound communication for their workload instance.
								</li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>Gateways</strong></span> are proxies operating as load balancers receiving incoming or outgoing HTTP/TCP connections. Gateway configurations are applied to standalone Envoy proxies that are running at the edge of the mesh, rather than sidecar Envoy proxies running alongside your service workloads. You use a Gateway to manage inbound and outbound traffic for your mesh, letting you specify which traffic you want to enter or leave the mesh.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
											<span class="strong strong"><strong>Ingress-gateway</strong></span> - Also known as an Ingress Controller, the Ingress Gateway is a dedicated Envoy proxy that receives and controls traffic entering the service mesh. An Ingress Gateway allows features such as monitoring and route rules to be applied to traffic entering the cluster.
										</li><li class="listitem">
											<span class="strong strong"><strong>Egress-gateway</strong></span> - Also known as an egress controller, the Egress Gateway is a dedicated Envoy proxy that manages traffic leaving the service mesh. An Egress Gateway allows features such as monitoring and route rules to be applied to traffic exiting the mesh.
										</li></ul></div></li></ul></div></li></ul></div><p>
					The <span class="strong strong"><strong>control plane</strong></span> manages and configures the proxies that make up the data plane. It is the authoritative source for configuration, manages access control and usage policies, and collects metrics from the proxies in the service mesh.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							The Istio control plane is composed of <span class="strong strong"><strong>Istiod</strong></span> which consolidates several previous control plane components (Citadel, Galley, Pilot) into a single binary. Istiod provides service discovery, configuration, and certificate management. It converts high-level routing rules to Envoy configurations and propagates them to the sidecars at runtime.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Istiod can act as a Certificate Authority (CA), generating certificates supporting secure mTLS communication in the data plane. You can also use an external CA for this purpose.
								</li><li class="listitem">
									Istiod is responsible for injecting sidecar proxy containers into workloads deployed to an OpenShift cluster.
								</li></ul></div></li></ul></div><p>
					Red Hat OpenShift Service Mesh uses the <span class="strong strong"><strong>istio-operator</strong></span> to manage the installation of the control plane. An <span class="emphasis"><em>Operator</em></span> is a piece of software that enables you to implement and automate common activities in your OpenShift cluster. It acts as a controller, allowing you to set or change the desired state of objects in your cluster, in this case, a Red Hat OpenShift Service Mesh installation.
				</p><p>
					Red Hat OpenShift Service Mesh also bundles the following Istio add-ons as part of the product:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Kiali</strong></span> - Kiali is the management console for Red Hat OpenShift Service Mesh. It provides dashboards, observability, and robust configuration and validation capabilities. It shows the structure of your service mesh by inferring traffic topology and displays the health of your mesh. Kiali provides detailed metrics, powerful validation, access to Grafana, and strong integration with the distributed tracing platform (Jaeger).
						</li><li class="listitem">
							<span class="strong strong"><strong>Prometheus</strong></span> - Red Hat OpenShift Service Mesh uses Prometheus to store telemetry information from services. Kiali depends on Prometheus to obtain metrics, health status, and mesh topology.
						</li><li class="listitem">
							<span class="strong strong"><strong>Jaeger</strong></span> - Red Hat OpenShift Service Mesh supports the distributed tracing platform (Jaeger). Jaeger is an open source traceability server that centralizes and displays traces associated with a single request between multiple services. Using the distributed tracing platform (Jaeger) you can monitor and troubleshoot your microservices-based distributed systems.
						</li><li class="listitem">
							<span class="strong strong"><strong>Elasticsearch</strong></span> - Elasticsearch is an open source, distributed, JSON-based search and analytics engine. The distributed tracing platform (Jaeger) uses Elasticsearch for persistent storage.
						</li><li class="listitem">
							<span class="strong strong"><strong>Grafana</strong></span> - Grafana provides mesh administrators with advanced query and metrics analysis and dashboards for Istio data. Optionally, Grafana can be used to analyze service mesh metrics.
						</li></ul></div><p>
					The following Istio integrations are supported with Red Hat OpenShift Service Mesh:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>3scale</strong></span> - Istio provides an optional integration with Red Hat 3scale API Management solutions. For versions prior to 2.1, this integration was achieved via the 3scale Istio adapter. For version 2.1 and later, the 3scale integration is achieved via a WebAssembly module.
						</li></ul></div><p>
					For information about how to install the 3scale adapter, refer to the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#threescale-adapter">3scale Istio adapter documentation</a>
				</p></section><section class="section" id="understanding-kiali"><div class="titlepage"><div><div><h3 class="title">1.3.3. Understanding Kiali</h3></div></div></div><p>
					Kiali provides visibility into your service mesh by showing you the microservices in your service mesh, and how they are connected.
				</p><section class="section" id="ossm-kiali-overview_ossm-architecture"><div class="titlepage"><div><div><h4 class="title">1.3.3.1. Kiali overview</h4></div></div></div><p>
						Kiali provides observability into the Service Mesh running on OpenShift Container Platform. Kiali helps you define, validate, and observe your Istio service mesh. It helps you to understand the structure of your service mesh by inferring the topology, and also provides information about the health of your service mesh.
					</p><p>
						Kiali provides an interactive graph view of your namespace in real time that provides visibility into features like circuit breakers, request rates, latency, and even graphs of traffic flows. Kiali offers insights about components at different levels, from Applications to Services and Workloads, and can display the interactions with contextual information and charts on the selected graph node or edge. Kiali also provides the ability to validate your Istio configurations, such as gateways, destination rules, virtual services, mesh policies, and more. Kiali provides detailed metrics, and a basic Grafana integration is available for advanced queries. Distributed tracing is provided by integrating Jaeger into the Kiali console.
					</p><p>
						Kiali is installed by default as part of the Red Hat OpenShift Service Mesh.
					</p></section><section class="section" id="ossm-kiali-architecture_ossm-architecture"><div class="titlepage"><div><div><h4 class="title">1.3.3.2. Kiali architecture</h4></div></div></div><p>
						Kiali is based on the open source <a class="link" href="https://kiali.io/">Kiali project</a>. Kiali is composed of two components: the Kiali application and the Kiali console.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Kiali application</strong></span> (back end) – This component runs in the container application platform and communicates with the service mesh components, retrieves and processes data, and exposes this data to the console. The Kiali application does not need storage. When deploying the application to a cluster, configurations are set in ConfigMaps and secrets.
							</li><li class="listitem">
								<span class="strong strong"><strong>Kiali console</strong></span> (front end) – The Kiali console is a web application. The Kiali application serves the Kiali console, which then queries the back end for data to present it to the user.
							</li></ul></div><p>
						In addition, Kiali depends on external services and components provided by the container application platform and Istio.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Red Hat Service Mesh</strong></span> (Istio) - Istio is a Kiali requirement. Istio is the component that provides and controls the service mesh. Although Kiali and Istio can be installed separately, Kiali depends on Istio and will not work if it is not present. Kiali needs to retrieve Istio data and configurations, which are exposed through Prometheus and the cluster API.
							</li><li class="listitem">
								<span class="strong strong"><strong>Prometheus</strong></span> - A dedicated Prometheus instance is included as part of the Red Hat OpenShift Service Mesh installation. When Istio telemetry is enabled, metrics data are stored in Prometheus. Kiali uses this Prometheus data to determine the mesh topology, display metrics, calculate health, show possible problems, and so on. Kiali communicates directly with Prometheus and assumes the data schema used by Istio Telemetry. Prometheus is an Istio dependency and a hard dependency for Kiali, and many of Kiali’s features will not work without Prometheus.
							</li><li class="listitem">
								<span class="strong strong"><strong>Cluster API</strong></span> - Kiali uses the API of the OpenShift Container Platform (cluster API) to fetch and resolve service mesh configurations. Kiali queries the cluster API to retrieve, for example, definitions for namespaces, services, deployments, pods, and other entities. Kiali also makes queries to resolve relationships between the different cluster entities. The cluster API is also queried to retrieve Istio configurations like virtual services, destination rules, route rules, gateways, quotas, and so on.
							</li><li class="listitem">
								<span class="strong strong"><strong>Jaeger</strong></span> - Jaeger is optional, but is installed by default as part of the Red Hat OpenShift Service Mesh installation. When you install the distributed tracing platform (Jaeger) as part of the default Red Hat OpenShift Service Mesh installation, the Kiali console includes a tab to display distributed tracing data. Note that tracing data will not be available if you disable Istio’s distributed tracing feature. Also note that user must have access to the namespace where the Service Mesh control plane is installed to view tracing data.
							</li><li class="listitem">
								<span class="strong strong"><strong>Grafana</strong></span> - Grafana is optional, but is installed by default as part of the Red Hat OpenShift Service Mesh installation. When available, the metrics pages of Kiali display links to direct the user to the same metric in Grafana. Note that user must have access to the namespace where the Service Mesh control plane is installed to view links to the Grafana dashboard and view Grafana data.
							</li></ul></div></section><section class="section" id="ossm-kiali-features_ossm-architecture"><div class="titlepage"><div><div><h4 class="title">1.3.3.3. Kiali features</h4></div></div></div><p>
						The Kiali console is integrated with Red Hat Service Mesh and provides the following capabilities:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Health</strong></span> – Quickly identify issues with applications, services, or workloads.
							</li><li class="listitem">
								<span class="strong strong"><strong>Topology</strong></span> – Visualize how your applications, services, or workloads communicate via the Kiali graph.
							</li><li class="listitem">
								<span class="strong strong"><strong>Metrics</strong></span> – Predefined metrics dashboards let you chart service mesh and application performance for Go, Node.js. Quarkus, Spring Boot, Thorntail and Vert.x. You can also create your own custom dashboards.
							</li><li class="listitem">
								<span class="strong strong"><strong>Tracing</strong></span> – Integration with Jaeger lets you follow the path of a request through various microservices that make up an application.
							</li><li class="listitem">
								<span class="strong strong"><strong>Validations</strong></span> – Perform advanced validations on the most common Istio objects (Destination Rules, Service Entries, Virtual Services, and so on).
							</li><li class="listitem">
								<span class="strong strong"><strong>Configuration</strong></span> – Optional ability to create, update and delete Istio routing configuration using wizards or directly in the YAML editor in the Kiali Console.
							</li></ul></div></section></section><section class="section" id="understanding-distributed-tracing"><div class="titlepage"><div><div><h3 class="title">1.3.4. Understanding distributed tracing</h3></div></div></div><p>
					Every time a user takes an action in an application, a request is executed by the architecture that may require dozens of different services to participate to produce a response. The path of this request is a distributed transaction. The distributed tracing platform (Jaeger) lets you perform distributed tracing, which follows the path of a request through various microservices that make up an application.
				</p><p>
					<span class="strong strong"><strong>Distributed tracing</strong></span> is a technique that is used to tie the information about different units of work together—usually executed in different processes or hosts—to understand a whole chain of events in a distributed transaction. Distributed tracing lets developers visualize call flows in large service oriented architectures. It can be invaluable in understanding serialization, parallelism, and sources of latency.
				</p><p>
					The distributed tracing platform (Jaeger) records the execution of individual requests across the whole stack of microservices, and presents them as traces. A <span class="strong strong"><strong>trace</strong></span> is a data/execution path through the system. An end-to-end trace comprises one or more spans.
				</p><p>
					A <span class="strong strong"><strong>span</strong></span> represents a logical unit of work that has an operation name, the start time of the operation, and the duration. Spans may be nested and ordered to model causal relationships.
				</p><section class="section" id="distr-tracing-product-overview_ossm-architecture"><div class="titlepage"><div><div><h4 class="title">1.3.4.1. Distributed tracing overview</h4></div></div></div><p>
						As a service owner, you can use distributed tracing to instrument your services to gather insights into your service architecture. You can use the Red Hat OpenShift distributed tracing platform for monitoring, network profiling, and troubleshooting the interaction between components in modern, cloud-native, microservices-based applications.
					</p><p>
						With the distributed tracing platform, you can perform the following functions:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Monitor distributed transactions
							</li><li class="listitem">
								Optimize performance and latency
							</li><li class="listitem">
								Perform root cause analysis
							</li></ul></div><p>
						The distributed tracing platform consists of three components:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Red Hat OpenShift distributed tracing platform (Jaeger)</strong></span>, which is based on the open source <a class="link" href="https://www.jaegertracing.io/">Jaeger project</a>.
							</li><li class="listitem">
								<span class="strong strong"><strong>Red Hat OpenShift distributed tracing platform (Tempo)</strong></span>, which is based on the open source <a class="link" href="https://grafana.com/oss/tempo/">Grafana Tempo project</a>.
							</li><li class="listitem">
								<span class="strong strong"><strong>Red Hat OpenShift distributed tracing data collection</strong></span>, which is based on the open source <a class="link" href="https://opentelemetry.io/">OpenTelemetry project</a>.
							</li></ul></div></section><section class="section" id="distr-tracing-architecture_ossm-architecture"><div class="titlepage"><div><div><h4 class="title">1.3.4.2. Red Hat OpenShift distributed tracing platform architecture</h4></div></div></div><p>
						Red Hat OpenShift distributed tracing platform is made up of several components that work together to collect, store, and display tracing data.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Red Hat OpenShift distributed tracing platform (Jaeger)</strong></span> - This component is based on the open source <a class="link" href="https://www.jaegertracing.io/">Jaeger project</a>.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<span class="strong strong"><strong>Client</strong></span> (Jaeger client, Tracer, Reporter, instrumented application, client libraries)- The distributed tracing platform (Jaeger) clients are language-specific implementations of the OpenTracing API. They can be used to instrument applications for distributed tracing either manually or with a variety of existing open source frameworks, such as Camel (Fuse), Spring Boot (RHOAR), MicroProfile (RHOAR/Thorntail), Wildfly (EAP), and many more, that are already integrated with OpenTracing.
									</li><li class="listitem">
										<span class="strong strong"><strong>Agent</strong></span> (Jaeger agent, Server Queue, Processor Workers) - The distributed tracing platform (Jaeger) agent is a network daemon that listens for spans sent over User Datagram Protocol (UDP), which it batches and sends to the Collector. The agent is meant to be placed on the same host as the instrumented application. This is typically accomplished by having a sidecar in container environments such as Kubernetes.
									</li><li class="listitem">
										<span class="strong strong"><strong>Jaeger Collector</strong></span> (Collector, Queue, Workers) - Similar to the Jaeger agent, the Jaeger Collector receives spans and places them in an internal queue for processing. This allows the Jaeger Collector to return immediately to the client/agent instead of waiting for the span to make its way to the storage.
									</li><li class="listitem">
										<span class="strong strong"><strong>Storage</strong></span> (Data Store) - Collectors require a persistent storage backend. Red Hat OpenShift distributed tracing platform (Jaeger) has a pluggable mechanism for span storage. Note that for this release, the only supported storage is Elasticsearch.
									</li><li class="listitem">
										<span class="strong strong"><strong>Query</strong></span> (Query Service) - Query is a service that retrieves traces from storage.
									</li><li class="listitem">
										<span class="strong strong"><strong>Ingester</strong></span> (Ingester Service) - Red Hat OpenShift distributed tracing platform can use Apache Kafka as a buffer between the Collector and the actual Elasticsearch backing storage. Ingester is a service that reads data from Kafka and writes to the Elasticsearch storage backend.
									</li><li class="listitem">
										<span class="strong strong"><strong>Jaeger Console</strong></span> – With the Red Hat OpenShift distributed tracing platform (Jaeger) user interface, you can visualize your distributed tracing data. On the Search page, you can find traces and explore details of the spans that make up an individual trace.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Red Hat OpenShift distributed tracing platform (Tempo)</strong></span> - This component is based on the open source <a class="link" href="https://grafana.com/oss/tempo/">Grafana Tempo project</a>.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<span class="strong strong"><strong>Gateway</strong></span> – The Gateway handles authentication, authorization, and forwarding requests to the Distributor or Query front-end service.
									</li><li class="listitem">
										<span class="strong strong"><strong>Distributor</strong></span> – The Distributor accepts spans in multiple formats including Jaeger, OpenTelemetry, and Zipkin. It routes spans to Ingesters by hashing the <code class="literal">traceID</code> and using a distributed consistent hash ring.
									</li><li class="listitem">
										<span class="strong strong"><strong>Ingester</strong></span> – The Ingester batches a trace into blocks, creates bloom filters and indexes, and then flushes it all to the back end.
									</li><li class="listitem">
										<span class="strong strong"><strong>Query Frontend</strong></span> – The Query Frontend is responsible for sharding the search space for an incoming query. The search query is then sent to the Queriers. The Query Frontend deployment exposes the Jaeger UI through the Tempo Query sidecar.
									</li><li class="listitem">
										<span class="strong strong"><strong>Querier</strong></span> - The Querier is responsible for finding the requested trace ID in either the Ingesters or the back-end storage. Depending on parameters, it can query the Ingesters and pull Bloom indexes from the back end to search blocks in object storage.
									</li><li class="listitem">
										<span class="strong strong"><strong>Compactor</strong></span> – The Compactors stream blocks to and from the back-end storage to reduce the total number of blocks.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Red Hat OpenShift distributed tracing data collection</strong></span> - This component is based on the open source <a class="link" href="https://opentelemetry.io/">OpenTelemetry project</a>.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<span class="strong strong"><strong>OpenTelemetry Collector</strong></span> - The OpenTelemetry Collector is a vendor-agnostic way to receive, process, and export telemetry data. The OpenTelemetry Collector supports open-source observability data formats, for example, Jaeger and Prometheus, sending to one or more open-source or commercial back-ends. The Collector is the default location instrumentation libraries export their telemetry data.
									</li></ul></div></li></ul></div></section><section class="section" id="distr-tracing-features_ossm-architecture"><div class="titlepage"><div><div><h4 class="title">1.3.4.3. Red Hat OpenShift distributed tracing platform features</h4></div></div></div><p>
						Red Hat OpenShift distributed tracing platform provides the following capabilities:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Integration with Kiali – When properly configured, you can view distributed tracing platform data from the Kiali console.
							</li><li class="listitem">
								High scalability – The distributed tracing platform back end is designed to have no single points of failure and to scale with the business needs.
							</li><li class="listitem">
								Distributed Context Propagation – Enables you to connect data from different components together to create a complete end-to-end trace.
							</li><li class="listitem">
								Backwards compatibility with Zipkin – Red Hat OpenShift distributed tracing platform has APIs that enable it to be used as a drop-in replacement for Zipkin, but Red Hat is not supporting Zipkin compatibility in this release.
							</li></ul></div></section></section><section class="section" id="next-steps"><div class="titlepage"><div><div><h3 class="title">1.3.5. Next steps</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#preparing-ossm-installation">Prepare to install Red Hat OpenShift Service Mesh</a> in your OpenShift Container Platform environment.
						</li></ul></div></section></section><section class="section" id="ossm-deployment-models"><div class="titlepage"><div><div><h2 class="title">1.4. Service mesh deployment models</h2></div></div></div><p>
				Red Hat OpenShift Service Mesh supports several different deployment models that can be combined in different ways to best suit your business requirements.
			</p><p>
				In Istio, a tenant is a group of users that share common access and privileges for a set of deployed workloads. You can use tenants to provide a level of isolation between different teams. You can segregate access to different tenants using <code class="literal">NetworkPolicies</code>, <code class="literal">AuthorizationPolicies</code>, and <code class="literal">exportTo</code> annotations on istio.io or service resources.
			</p><section class="section" id="ossm-deploy-cluster-wide-mesh_ossm-deployment-models"><div class="titlepage"><div><div><h3 class="title">1.4.1. Cluster-Wide (Single Tenant) mesh deployment model</h3></div></div></div><p>
					A cluster-wide deployment contains a Service Mesh Control Plane that monitors resources for an entire cluster. Monitoring resources for an entire cluster closely resembles Istio functionality in that the control plane uses a single query across all namespaces to monitor Istio and Kubernetes resources. As a result, cluster-wide deployments decrease the number of requests sent to the API server.
				</p><p>
					Similar to Istio, a cluster-wide mesh includes namespaces with the <code class="literal">istio-injection=enabled</code> namespace label by default. You can change this label by modifying the <code class="literal">spec.labelSelectors</code> field of the <code class="literal">ServiceMeshMemberRoll</code> resource.
				</p></section><section class="section" id="ossm-deploy-multitenant_ossm-deployment-models"><div class="titlepage"><div><div><h3 class="title">1.4.2. Multitenant deployment model</h3></div></div></div><p>
					Red Hat OpenShift Service Mesh installs a <code class="literal">ServiceMeshControlPlane</code> that is configured for multitenancy by default. Red Hat OpenShift Service Mesh uses a multitenant Operator to manage the Service Mesh control plane lifecycle. Within a mesh, namespaces are used for tenancy.
				</p><p>
					Red Hat OpenShift Service Mesh uses <code class="literal">ServiceMeshControlPlane</code> resources to manage mesh installations, whose scope is limited by default to namespace that contains the resource. You use <code class="literal">ServiceMeshMemberRoll</code> and <code class="literal">ServiceMeshMember</code> resources to include additional namespaces into the mesh. A namespace can only be included in a single mesh, and multiple meshes can be installed in a single OpenShift cluster.
				</p><p>
					Typical service mesh deployments use a single Service Mesh control plane to configure communication between services in the mesh. Red Hat OpenShift Service Mesh supports “soft multitenancy”, where there is one control plane and one mesh per tenant, and there can be multiple independent control planes within the cluster. Multitenant deployments specify the projects that can access the Service Mesh and isolate the Service Mesh from other control plane instances.
				</p><p>
					The cluster administrator gets control and visibility across all the Istio control planes, while the tenant administrator only gets control over their specific Service Mesh, Kiali, and Jaeger instances.
				</p><p>
					You can grant a team permission to deploy its workloads only to a given namespace or set of namespaces. If granted the <code class="literal">mesh-user</code> role by the service mesh administrator, users can create a <code class="literal">ServiceMeshMember</code> resource to add namespaces to the <code class="literal">ServiceMeshMemberRoll</code>.
				</p></section><section class="section" id="ossm-deploy-multi-mesh_ossm-deployment-models"><div class="titlepage"><div><div><h3 class="title">1.4.3. Multimesh or federated deployment model</h3></div></div></div><p>
					<span class="emphasis"><em>Federation</em></span> is a deployment model that lets you share services and workloads between separate meshes managed in distinct administrative domains.
				</p><p>
					The Istio multi-cluster model requires a high level of trust between meshes and remote access to all Kubernetes API servers on which the individual meshes reside. Red Hat OpenShift Service Mesh federation takes an opinionated approach to a multi-cluster implementation of Service Mesh that assumes <span class="emphasis"><em>minimal</em></span> trust between meshes.
				</p><p>
					A <span class="emphasis"><em>federated mesh</em></span> is a group of meshes behaving as a single mesh. The services in each mesh can be unique services, for example a mesh adding services by importing them from another mesh, can provide additional workloads for the same services across the meshes, providing high availability, or a combination of both. All meshes that are joined into a federated mesh remain managed individually, and you must explicitly configure which services are exported to and imported from other meshes in the federation. Support functions such as certificate generation, metrics and trace collection remain local in their respective meshes.
				</p></section></section><section class="section" id="ossm-vs-community"><div class="titlepage"><div><div><h2 class="title">1.5. Service Mesh and Istio differences</h2></div></div></div><p>
				Red Hat OpenShift Service Mesh differs from an installation of Istio to provide additional features or to handle differences when deploying on OpenShift Container Platform.
			</p><section class="section" id="ossm-vs-istio_ossm-vs-istio"><div class="titlepage"><div><div><h3 class="title">1.5.1. Differences between Istio and Red Hat OpenShift Service Mesh</h3></div></div></div><p>
					The following features are different in Service Mesh and Istio.
				</p><section class="section" id="ossm-cli-tool_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.1.1. Command line tool</h4></div></div></div><p>
						The command line tool for Red Hat OpenShift Service Mesh is <code class="literal">oc</code>.  Red Hat OpenShift Service Mesh does not support <code class="literal">istioctl</code>.
					</p></section><section class="section" id="ossm-installation-upgrade_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.1.2. Installation and upgrades</h4></div></div></div><p>
						Red Hat OpenShift Service Mesh does not support Istio installation profiles.
					</p><p>
						Red Hat OpenShift Service Mesh does not support canary upgrades of the service mesh.
					</p></section><section class="section" id="ossm-automatic-injection_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.1.3. Automatic injection</h4></div></div></div><p>
						The upstream Istio community installation automatically injects the sidecar into pods within the projects you have labeled.
					</p><p>
						Red Hat OpenShift Service Mesh does not automatically inject the sidecar into any pods, but you must opt in to injection using an annotation without labeling projects. This method requires fewer privileges and does not conflict with other OpenShift Container Platform capabilities such as builder pods. To enable automatic injection, specify the <code class="literal">sidecar.istio.io/inject</code> label, or annotation, as described in the <span class="emphasis"><em>Automatic sidecar injection</em></span> section.
					</p><div class="table" id="idm140663659995232"><p class="title"><strong>Table 1.3. Sidecar injection label and annotation settings</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663659972352" scope="col"> </th><th align="left" valign="top" id="idm140663659971424" scope="col">Upstream Istio</th><th align="left" valign="top" id="idm140663659970336" scope="col">Red Hat OpenShift Service Mesh</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663659972352"> <p>
										Namespace Label
									</p>
									 </td><td align="left" valign="top" headers="idm140663659971424"> <p>
										supports "enabled" and "disabled"
									</p>
									 </td><td align="left" valign="top" headers="idm140663659970336"> <p>
										supports "disabled"
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663659972352"> <p>
										Pod Label
									</p>
									 </td><td align="left" valign="top" headers="idm140663659971424"> <p>
										supports "true" and "false"
									</p>
									 </td><td align="left" valign="top" headers="idm140663659970336"> <p>
										supports "true" and "false"
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663659972352"> <p>
										Pod Annotation
									</p>
									 </td><td align="left" valign="top" headers="idm140663659971424"> <p>
										supports "false" only
									</p>
									 </td><td align="left" valign="top" headers="idm140663659970336"> <p>
										supports "true" and "false"
									</p>
									 </td></tr></tbody></table></div></div></section><section class="section" id="ossm-rbac_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.1.4. Istio Role Based Access Control features</h4></div></div></div><p>
						Istio Role Based Access Control (RBAC) provides a mechanism you can use to control access to a service. You can identify subjects by user name or by specifying a set of properties and apply access controls accordingly.
					</p><p>
						The upstream Istio community installation includes options to perform exact header matches, match wildcards in headers, or check for a header containing a specific prefix or suffix.
					</p><p>
						Red Hat OpenShift Service Mesh extends the ability to match request headers by using a regular expression. Specify a property key of <code class="literal">request.regex.headers</code> with a regular expression.
					</p><div class="formalpara"><p class="title"><strong>Upstream Istio community matching request headers example</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: httpbin-usernamepolicy
spec:
  action: ALLOW
  rules:
    - when:
        - key: 'request.regex.headers[username]'
          values:
            - "allowed.*"
  selector:
    matchLabels:
      app: httpbin</pre>

						</p></div></section><section class="section" id="ossm-openssl_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.1.5. OpenSSL</h4></div></div></div><p>
						Red Hat OpenShift Service Mesh replaces BoringSSL with OpenSSL. OpenSSL is a software library that contains an open source implementation of the Secure Sockets Layer (SSL) and Transport Layer Security (TLS) protocols. The Red Hat OpenShift Service Mesh Proxy binary dynamically links the OpenSSL libraries (libssl and libcrypto) from the underlying Red Hat Enterprise Linux operating system.
					</p></section><section class="section" id="ossm-external-workloads_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.1.6. External workloads</h4></div></div></div><p>
						Red Hat OpenShift Service Mesh does not support external workloads, such as virtual machines running outside OpenShift on bare metal servers.
					</p></section><section class="section" id="ossm-virtual-machine-support_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.1.7. Virtual Machine Support</h4></div></div></div><p>
						You can deploy virtual machines to OpenShift using OpenShift Virtualization. Then, you can apply a mesh policy, such as mTLS or AuthorizationPolicy, to these virtual machines, just like any other pod that is part of a mesh.
					</p></section><section class="section" id="ossm-component-modifications_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.1.8. Component modifications</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A <span class="emphasis"><em>maistra-version</em></span> label has been added to all resources.
							</li><li class="listitem">
								All Ingress resources have been converted to OpenShift Route resources.
							</li><li class="listitem">
								Grafana, distributed tracing (Jaeger), and Kiali are enabled by default and exposed through OpenShift routes.
							</li><li class="listitem">
								Godebug has been removed from all templates
							</li><li class="listitem">
								The <code class="literal">istio-multi</code> ServiceAccount and ClusterRoleBinding have been removed, as well as the <code class="literal">istio-reader</code> ClusterRole.
							</li></ul></div></section><section class="section" id="ossm-envoy-filters_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.1.9. Envoy filters</h4></div></div></div><p>
						Red Hat OpenShift Service Mesh does not support <code class="literal">EnvoyFilter</code> configuration except where explicitly documented. Due to tight coupling with the underlying Envoy APIs, backward compatibility cannot be maintained. <code class="literal">EnvoyFilter</code> patches are very sensitive to the format of the Envoy configuration that is generated by Istio. If the configuration generated by Istio changes, it has the potential to break the application of the <code class="literal">EnvoyFilter</code>.
					</p></section><section class="section" id="ossm-envoy-services_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.1.10. Envoy services</h4></div></div></div><p>
						Red Hat OpenShift Service Mesh does not support QUIC-based services.
					</p></section><section class="section" id="ossm-cni_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.1.11. Istio Container Network Interface (CNI) plugin</h4></div></div></div><p>
						Red Hat OpenShift Service Mesh includes CNI plugin, which provides you with an alternate way to configure application pod networking. The CNI plugin replaces the <code class="literal">init-container</code> network configuration eliminating the need to grant service accounts and projects access to security context constraints (SCCs) with elevated privileges.
					</p></section><section class="section" id="ossm-global-mtls_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.1.12. Global mTLS settings</h4></div></div></div><p>
						Red Hat OpenShift Service Mesh creates a <code class="literal">PeerAuthentication</code> resource that enables or disables Mutual TLS authentication (mTLS) within the mesh.
					</p></section><section class="section" id="ossm-gateways_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.1.13. Gateways</h4></div></div></div><p>
						Red Hat OpenShift Service Mesh installs ingress and egress gateways by default. You can disable gateway installation in the <code class="literal">ServiceMeshControlPlane</code> (SMCP) resource by using the following settings:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">spec.gateways.enabled=false</code> to disable both ingress and egress gateways.
							</li><li class="listitem">
								<code class="literal">spec.gateways.ingress.enabled=false</code> to disable ingress gateways.
							</li><li class="listitem">
								<code class="literal">spec.gateways.egress.enabled=false</code> to disable egress gateways.
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The Operator annotates the default gateways to indicate that they are generated by and managed by the Red Hat OpenShift Service Mesh Operator.
						</p></div></div></section><section class="section" id="ossm-multicluster-configuration_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.1.14. Multicluster configurations</h4></div></div></div><p>
						Red Hat OpenShift Service Mesh support for multicluster configurations is limited to the federation of service meshes across multiple clusters.
					</p></section><section class="section" id="ossm-certificate-signing-request_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.1.15. Custom Certificate Signing Requests (CSR)</h4></div></div></div><p>
						You cannot configure Red Hat OpenShift Service Mesh to process CSRs through the Kubernetes certificate authority (CA).
					</p></section><section class="section" id="ossm-routes-gateways_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.1.16. Routes for Istio Gateways</h4></div></div></div><p>
						OpenShift routes for Istio Gateways are automatically managed in Red Hat OpenShift Service Mesh. Every time an Istio Gateway is created, updated or deleted inside the service mesh, an OpenShift route is created, updated or deleted.
					</p><p>
						A Red Hat OpenShift Service Mesh control plane component called Istio OpenShift Routing (IOR) synchronizes the gateway route. For more information, see Automatic route creation.
					</p><section class="section" id="ossm-catch-all-domains_ossm-vs-istio"><div class="titlepage"><div><div><h5 class="title">1.5.1.16.1. Catch-all domains</h5></div></div></div><p>
							Catch-all domains ("*") are not supported. If one is found in the Gateway definition, Red Hat OpenShift Service Mesh <span class="emphasis"><em>will</em></span> create the route, but will rely on OpenShift to create a default hostname. This means that the newly created route will <span class="emphasis"><em>not</em></span> be a catch all ("*") route, instead it will have a hostname in the form <code class="literal">&lt;route-name&gt;[-&lt;project&gt;].&lt;suffix&gt;</code>. See the OpenShift Container Platform documentation for more information about how default hostnames work and how a <code class="literal">cluster-admin</code> can customize it. If you use Red Hat OpenShift Dedicated, refer to the Red Hat OpenShift Dedicated the <code class="literal">dedicated-admin</code> role.
						</p></section><section class="section" id="ossm-subdomains_ossm-vs-istio"><div class="titlepage"><div><div><h5 class="title">1.5.1.16.2. Subdomains</h5></div></div></div><p>
							Subdomains (e.g.: "*.domain.com") are supported. However this ability doesn’t come enabled by default in OpenShift Container Platform. This means that Red Hat OpenShift Service Mesh <span class="emphasis"><em>will</em></span> create the route with the subdomain, but it will only be in effect if OpenShift Container Platform is configured to enable it.
						</p></section><section class="section" id="ossm-tls_ossm-vs-istio"><div class="titlepage"><div><div><h5 class="title">1.5.1.16.3. Transport layer security</h5></div></div></div><p>
							Transport Layer Security (TLS) is supported. This means that, if the Gateway contains a <code class="literal">tls</code> section, the OpenShift Route will be configured to support TLS.
						</p><h6 id="additional-resources_ossm-vs-istio-v2x">Additional resources</h6><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-auto-route_traffic-management">Automatic route creation</a>
								</li></ul></div></section></section></section><section class="section" id="ossm-multitenant-install_ossm-vs-istio"><div class="titlepage"><div><div><h3 class="title">1.5.2. Multitenant installations</h3></div></div></div><p>
					Whereas upstream Istio takes a single tenant approach, Red Hat OpenShift Service Mesh supports multiple independent control planes within the cluster. Red Hat OpenShift Service Mesh uses a multitenant operator to manage the control plane lifecycle.
				</p><p>
					Red Hat OpenShift Service Mesh installs a multitenant control plane by default. You specify the projects that can access the Service Mesh, and isolate the Service Mesh from other control plane instances.
				</p><section class="section" id="ossm-mt-vs-clusterwide_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.2.1. Multitenancy versus cluster-wide installations</h4></div></div></div><p>
						The main difference between a multitenant installation and a cluster-wide installation is the scope of privileges used by istod. The components no longer use cluster-scoped Role Based Access Control (RBAC) resource <code class="literal">ClusterRoleBinding</code>.
					</p><p>
						Every project in the <code class="literal">ServiceMeshMemberRoll</code> <code class="literal">members</code> list will have a <code class="literal">RoleBinding</code> for each service account associated with the control plane deployment and each control plane deployment will only watch those member projects. Each member project has a <code class="literal">maistra.io/member-of</code> label added to it, where the <code class="literal">member-of</code> value is the project containing the control plane installation.
					</p><p>
						Red Hat OpenShift Service Mesh configures each member project to ensure network access between itself, the control plane, and other member projects. The exact configuration differs depending on how OpenShift Container Platform software-defined networking (SDN) is configured. See About OpenShift SDN for additional details.
					</p><p>
						If the OpenShift Container Platform cluster is configured to use the SDN plugin:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong><code class="literal">NetworkPolicy</code></strong></span>: Red Hat OpenShift Service Mesh creates a <code class="literal">NetworkPolicy</code> resource in each member project allowing ingress to all pods from the other members and the control plane. If you remove a member from Service Mesh, this <code class="literal">NetworkPolicy</code> resource is deleted from the project.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									This also restricts ingress to only member projects. If you require ingress from non-member projects, you need to create a <code class="literal">NetworkPolicy</code> to allow that traffic through.
								</p></div></div></li><li class="listitem">
								<span class="strong strong"><strong>Multitenant</strong></span>: Red Hat OpenShift Service Mesh joins the <code class="literal">NetNamespace</code> for each member project to the <code class="literal">NetNamespace</code> of the control plane project (the equivalent of running <code class="literal">oc adm pod-network join-projects --to control-plane-project member-project</code>). If you remove a member from the Service Mesh, its <code class="literal">NetNamespace</code> is isolated from the control plane (the equivalent of running <code class="literal">oc adm pod-network isolate-projects member-project</code>).
							</li><li class="listitem">
								<span class="strong strong"><strong>Subnet</strong></span>: No additional configuration is performed.
							</li></ul></div></section><section class="section" id="ossm-cluster-scoped-resources_ossm-vs-istio"><div class="titlepage"><div><div><h4 class="title">1.5.2.2. Cluster scoped resources</h4></div></div></div><p>
						Upstream Istio has two cluster scoped resources that it relies on. The <code class="literal">MeshPolicy</code> and the <code class="literal">ClusterRbacConfig</code>. These are not compatible with a multitenant cluster and have been replaced as described below.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="emphasis"><em>ServiceMeshPolicy</em></span> replaces MeshPolicy for configuration of control-plane-wide authentication policies. This must be created in the same project as the control plane.
							</li><li class="listitem">
								<span class="emphasis"><em>ServicemeshRbacConfig</em></span> replaces ClusterRbacConfig for configuration of control-plane-wide role based access control. This must be created in the same project as the control plane.
							</li></ul></div></section></section><section class="section" id="ossm-kiali-service-mesh_ossm-vs-istio"><div class="titlepage"><div><div><h3 class="title">1.5.3. Kiali and service mesh</h3></div></div></div><p>
					Installing Kiali via the Service Mesh on OpenShift Container Platform differs from community Kiali installations in multiple ways. These modifications are sometimes necessary to resolve issues, provide additional features, or to handle differences when deploying on OpenShift Container Platform.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Kiali has been enabled by default.
						</li><li class="listitem">
							Ingress has been enabled by default.
						</li><li class="listitem">
							Updates have been made to the Kiali ConfigMap.
						</li><li class="listitem">
							Updates have been made to the ClusterRole settings for Kiali.
						</li><li class="listitem">
							Do not edit the ConfigMap, because your changes might be overwritten by the Service Mesh or Kiali Operators. Files that the Kiali Operator manages have a <code class="literal">kiali.io/</code> label or annotation. Updating the Operator files should be restricted to those users with <code class="literal">cluster-admin</code> privileges. If you use Red Hat OpenShift Dedicated, updating the Operator files should be restricted to those users with <code class="literal">dedicated-admin</code> privileges.
						</li></ul></div></section><section class="section" id="ossm-jaeger-service-mesh_ossm-vs-istio"><div class="titlepage"><div><div><h3 class="title">1.5.4. Distributed tracing and service mesh</h3></div></div></div><p>
					Installing the distributed tracing platform (Jaeger) with the Service Mesh on OpenShift Container Platform differs from community Jaeger installations in multiple ways. These modifications are sometimes necessary to resolve issues, provide additional features, or to handle differences when deploying on OpenShift Container Platform.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Distributed tracing has been enabled by default for Service Mesh.
						</li><li class="listitem">
							Ingress has been enabled by default for Service Mesh.
						</li><li class="listitem">
							The name for the Zipkin port name has changed to <code class="literal">jaeger-collector-zipkin</code> (from <code class="literal">http</code>)
						</li><li class="listitem">
							Jaeger uses Elasticsearch for storage by default when you select either the <code class="literal">production</code> or <code class="literal">streaming</code> deployment option.
						</li><li class="listitem">
							The community version of Istio provides a generic "tracing" route. Red Hat OpenShift Service Mesh uses a "jaeger" route that is installed by the Red Hat OpenShift distributed tracing platform (Jaeger) Operator and is already protected by OAuth.
						</li><li class="listitem">
							Red Hat OpenShift Service Mesh uses a sidecar for the Envoy proxy, and Jaeger also uses a sidecar, for the Jaeger agent. These two sidecars are configured separately and should not be confused with each other. The proxy sidecar creates spans related to the pod’s ingress and egress traffic. The agent sidecar receives the spans emitted by the application and sends them to the Jaeger Collector.
						</li></ul></div></section></section><section class="section" id="preparing-ossm-installation"><div class="titlepage"><div><div><h2 class="title">1.6. Preparing to install Service Mesh</h2></div></div></div><p>
				Before you can install Red Hat OpenShift Service Mesh, you must subscribe to OpenShift Container Platform and install OpenShift Container Platform in a supported configuration.
			</p><section class="section" id="prerequisites"><div class="titlepage"><div><div><h3 class="title">1.6.1. Prerequisites</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Maintain an active OpenShift Container Platform subscription on your Red Hat account. If you do not have a subscription, contact your sales representative for more information.
						</li><li class="listitem">
							Review the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/architecture/#installation-overview_architecture-installation">OpenShift Container Platform 4.13 overview</a>.
						</li><li class="listitem"><p class="simpara">
							Install OpenShift Container Platform 4.13. If you are installing Red Hat OpenShift Service Mesh on a <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#supported-installation-methods-for-different-platforms">restricted network</a>, follow the instructions for your chosen OpenShift Container Platform infrastructure.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-aws-account">Install OpenShift Container Platform 4.13 on AWS</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-aws-user-infra">Install OpenShift Container Platform 4.13 on user-provisioned AWS</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-bare-metal">Install OpenShift Container Platform 4.13 on bare metal</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-vsphere">Install OpenShift Container Platform 4.13 on vSphere</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-ibm-z">Install OpenShift Container Platform 4.13 on IBM Z and IBM® LinuxONE</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-ibm-power">Install OpenShift Container Platform 4.13 on IBM Power</a>
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Install the version of the OpenShift Container Platform command line utility (the <code class="literal">oc</code> client tool) that matches your OpenShift Container Platform version and add it to your path.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									If you are using OpenShift Container Platform 4.13, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cli_tools/#cli-about-cli_cli-developer-commands">About the OpenShift CLI</a>.
								</li></ul></div></li></ul></div><p>
					For additional information about Red Hat OpenShift Service Mesh lifecycle and supported platforms, refer to the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ossm">Support Policy</a>.
				</p></section><section class="section" id="ossm-supported-configurations_preparing-ossm-installation"><div class="titlepage"><div><div><h3 class="title">1.6.2. Supported configurations</h3></div></div></div><p>
					The following configurations are supported for the current release of Red Hat OpenShift Service Mesh.
				</p><section class="section" id="ossm-supported-platforms_preparing-ossm-installation"><div class="titlepage"><div><div><h4 class="title">1.6.2.1. Supported platforms</h4></div></div></div><p>
						The Red Hat OpenShift Service Mesh Operator supports multiple versions of the <code class="literal">ServiceMeshControlPlane</code> resource. Version 2.4 Service Mesh control planes are supported on the following platform versions:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Red Hat OpenShift Container Platform version 4.10 or later.
							</li><li class="listitem">
								Red Hat OpenShift Dedicated version 4.
							</li><li class="listitem">
								Azure Red Hat OpenShift (ARO) version 4.
							</li><li class="listitem">
								Red Hat OpenShift Service on AWS (ROSA).
							</li></ul></div></section><section class="section" id="ossm-unsupported-configurations_preparing-ossm-installation"><div class="titlepage"><div><div><h4 class="title">1.6.2.2. Unsupported configurations</h4></div></div></div><p>
						Explicitly unsupported cases include:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								OpenShift Online is not supported for Red Hat OpenShift Service Mesh.
							</li><li class="listitem">
								Red Hat OpenShift Service Mesh does not support the management of microservices outside the cluster where Service Mesh is running.
							</li></ul></div></section><section class="section" id="ossm-supported-configurations-networks_preparing-ossm-installation"><div class="titlepage"><div><div><h4 class="title">1.6.2.3. Supported network configurations</h4></div></div></div><p>
						Red Hat OpenShift Service Mesh supports the following network configurations.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								OpenShift-SDN
							</li><li class="listitem">
								OVN-Kubernetes is available on all supported versions of OpenShift Container Platform.
							</li><li class="listitem">
								Third-Party Container Network Interface (CNI) plugins that have been certified on OpenShift Container Platform and passed Service Mesh conformance testing. See <a class="link" href="https://access.redhat.com/articles/5436171">Certified OpenShift CNI Plug-ins</a> for more information.
							</li></ul></div></section><section class="section" id="ossm-supported-configurations-sm_preparing-ossm-installation"><div class="titlepage"><div><div><h4 class="title">1.6.2.4. Supported configurations for Service Mesh</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								This release of Red Hat OpenShift Service Mesh is only available on OpenShift Container Platform x86_64, IBM Z, and IBM Power.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										IBM Z is only supported on OpenShift Container Platform 4.10 and later.
									</li><li class="listitem">
										IBM Power is only supported on OpenShift Container Platform 4.10 and later.
									</li></ul></div></li><li class="listitem">
								Configurations where all Service Mesh components are contained within a single OpenShift Container Platform cluster.
							</li><li class="listitem">
								Configurations that do not integrate external services such as virtual machines.
							</li><li class="listitem">
								Red Hat OpenShift Service Mesh does not support <code class="literal">EnvoyFilter</code> configuration except where explicitly documented.
							</li></ul></div></section><section class="section" id="ossm-supported-configurations-kiali_preparing-ossm-installation"><div class="titlepage"><div><div><h4 class="title">1.6.2.5. Supported configurations for Kiali</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The Kiali console is only supported on the two most recent releases of the Google Chrome, Microsoft Edge, Mozilla Firefox, or Apple Safari browsers.
							</li><li class="listitem">
								The <code class="literal">openshift</code> authentication strategy is the only supported authentication configuration when Kiali is deployed with Red Hat OpenShift Service Mesh (OSSM). The <code class="literal">openshift</code> strategy controls access based on the individual’s role-based access control (RBAC) roles of the OpenShift Container Platform.
							</li></ul></div></section><section class="section" id="ossm-supported-configurations-jaeger_preparing-ossm-installation"><div class="titlepage"><div><div><h4 class="title">1.6.2.6. Supported configurations for Distributed Tracing</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Jaeger agent as a sidecar is the only supported configuration for Jaeger. Jaeger as a daemonset is not supported for multitenant installations or OpenShift Dedicated.
							</li></ul></div></section><section class="section" id="ossm-supported-configurations-webassembly_preparing-ossm-installation"><div class="titlepage"><div><div><h4 class="title">1.6.2.7. Supported WebAssembly module</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								3scale WebAssembly is the only provided WebAssembly module. You can create custom WebAssembly modules.
							</li></ul></div></section></section><section class="section" id="next-steps-2"><div class="titlepage"><div><div><h3 class="title">1.6.3. Next steps</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#installing-ossm">Install Red Hat OpenShift Service Mesh</a> in your OpenShift Container Platform environment.
						</li></ul></div></section></section><section class="section" id="installing-ossm"><div class="titlepage"><div><div><h2 class="title">1.7. Installing the Operators</h2></div></div></div><p>
				To install Red Hat OpenShift Service Mesh, first install the required Operators on OpenShift Container Platform and then create a <code class="literal">ServiceMeshControlPlane</code> resource to deploy the control plane.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					This basic installation is configured based on the default OpenShift settings and is not designed for production use.  Use this default installation to verify your installation, and then configure your service mesh for your specific environment.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Read the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#preparing-ossm-installation">Preparing to install Red Hat OpenShift Service Mesh</a> process.
					</li><li class="listitem">
						An account with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
					</li></ul></div><p>
				The following steps show how to install a basic instance of Red Hat OpenShift Service Mesh on OpenShift Container Platform.
			</p><section class="section" id="ossm-installation-activities_installing-ossm"><div class="titlepage"><div><div><h3 class="title">1.7.1. Operator overview</h3></div></div></div><p>
					Red Hat OpenShift Service Mesh requires the following four Operators:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>OpenShift Elasticsearch</strong></span> - (Optional) Provides database storage for tracing and logging with the distributed tracing platform (Jaeger). It is based on the open source <a class="link" href="https://www.elastic.co/">Elasticsearch</a> project.
						</li><li class="listitem">
							<span class="strong strong"><strong>Red Hat OpenShift distributed tracing platform (Jaeger)</strong></span> - Provides distributed tracing to monitor and troubleshoot transactions in complex distributed systems. It is based on the open source <a class="link" href="https://www.jaegertracing.io/">Jaeger</a> project.
						</li><li class="listitem">
							<span class="strong strong"><strong>Kiali Operator provided by Red Hat</strong></span> - Provides observability for your service mesh. You can view configurations, monitor traffic, and analyze traces in a single console. It is based on the open source <a class="link" href="https://www.kiali.io/">Kiali</a> project.
						</li><li class="listitem">
							<span class="strong strong"><strong>Red Hat OpenShift Service Mesh</strong></span> - Allows you to connect, secure, control, and observe the microservices that comprise your applications. The Service Mesh Operator defines and monitors the <code class="literal">ServiceMeshControlPlane</code> resources that manage the deployment, updating, and deletion of the Service Mesh components. It is based on the open source <a class="link" href="https://istio.io/">Istio</a> project.
						</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Do not install Community versions of the Operators. Community Operators are not supported.
					</p></div></div></section><section class="section" id="ossm-install-ossm-operator_installing-ossm"><div class="titlepage"><div><div><h3 class="title">1.7.2. Installing the Operators</h3></div></div></div><p>
					To install Red Hat OpenShift Service Mesh, install the following Operators in this order. Repeat the procedure for each Operator.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							OpenShift Elasticsearch
						</li><li class="listitem">
							Red Hat OpenShift distributed tracing platform (Jaeger)
						</li><li class="listitem">
							Kiali Operator provided by Red Hat
						</li><li class="listitem">
							Red Hat OpenShift Service Mesh
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you have already installed the OpenShift Elasticsearch Operator as part of OpenShift Logging, you do not need to install the OpenShift Elasticsearch Operator again. The Red Hat OpenShift distributed tracing platform (Jaeger) Operator will create the Elasticsearch instance using the installed OpenShift Elasticsearch Operator.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform web console as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
						</li><li class="listitem">
							In the OpenShift Container Platform web console, click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span>.
						</li><li class="listitem">
							Type the name of the Operator into the filter box and select the Red Hat version of the Operator. Community versions of the Operators are not supported.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Install</strong></span>.
						</li><li class="listitem">
							On the <span class="strong strong"><strong>Install Operator</strong></span> page for each Operator, accept the default settings.
						</li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Install</strong></span>. Wait until the Operator has installed before repeating the steps for the next Operator in the list.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The OpenShift Elasticsearch Operator is installed in the <code class="literal">openshift-operators-redhat</code> namespace and is available for all namespaces in the cluster.
								</li><li class="listitem">
									The Red Hat OpenShift distributed tracing platform (Jaeger) is installed in the <code class="literal">openshift-distributed-tracing</code> namespace and is available for all namespaces in the cluster.
								</li><li class="listitem">
									The Kiali Operator provided by Red Hat and the Red Hat OpenShift Service Mesh Operator are installed in the <code class="literal">openshift-operators</code> namespace and are available for all namespaces in the cluster.
								</li></ul></div></li><li class="listitem">
							After all you have installed all four Operators, click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> to verify that your Operators installed.
						</li></ol></div></section><section class="section" id="ossm-config-operator-infrastructure-node_installing-ossm"><div class="titlepage"><div><div><h3 class="title">1.7.3. Configuring the Service Mesh Operator to run on infrastructure nodes</h3></div></div></div><p>
					This task should only be performed if the Service Mesh Operator runs on an infrastructure node.
				</p><p>
					If the operator will run on a worker node, skip this task.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The Service Mesh Operator must be installed.
						</li><li class="listitem">
							One of the nodes comprising the deployment must be an infrastructure node. For more information, see "Creating infrastructure machine sets."
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							List the operators installed in the namespace:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-operators get subscriptions</pre></li><li class="listitem"><p class="simpara">
							Edit the Service Mesh Operator <code class="literal">Subscription</code> resource to specify where the operator should run:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-operators edit subscription &lt;name&gt; <span id="CO3-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO3-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									<code class="literal">&lt;name&gt;</code> represents the name of the <code class="literal">Subscription</code> resource. The default name of the <code class="literal">Subscription</code> resource is <code class="literal">servicemeshoperator</code>.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Add the <code class="literal">nodeSelector</code> and <code class="literal">tolerations</code> to <code class="literal">spec.config</code> in the <code class="literal">Subscription</code> resource:
						</p><pre class="programlisting language-yaml">spec:
  config:
    nodeSelector: <span id="CO4-1"><!--Empty--></span><span class="callout">1</span>
      node-role.kubernetes.io/infra: ""
    tolerations: <span id="CO4-2"><!--Empty--></span><span class="callout">2</span>
    - effect: NoSchedule
      key: node-role.kubernetes.io/infra
      value: reserved
    - effect: NoExecute
      key: node-role.kubernetes.io/infra
      value: reserved</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO4-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Ensures that the operator pod is only scheduled on an infrastructure node.
								</div></dd><dt><a href="#CO4-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Ensures that the pod is accepted by the infrastructure node.
								</div></dd></dl></div></li></ol></div></section><section class="section" id="ossm-confirm-operator-infrastructure-node_installing-ossm"><div class="titlepage"><div><div><h3 class="title">1.7.4. Verifying the Service Mesh Operator is running on infrastructure node</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Verify that the node associated with the Operator pod is an infrastructure node:
						</p><pre class="programlisting language-terminal">$ oc -n openshift-operators get po -l name=istio-operator -owide</pre></li></ul></div></section><section class="section" id="next-steps-3"><div class="titlepage"><div><div><h3 class="title">1.7.5. Next steps</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The Red Hat OpenShift Service Mesh Operator does not create the Service Mesh custom resource definitions (CRDs) until you deploy a Service Mesh control plane. You can use the <code class="literal">ServiceMeshControlPlane</code> resource to install and configure the Service Mesh components. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-create-smcp">Creating the ServiceMeshControlPlane</a>.
						</li></ul></div></section></section><section class="section" id="ossm-create-smcp"><div class="titlepage"><div><div><h2 class="title">1.8. Creating the ServiceMeshControlPlane</h2></div></div></div><section class="section" id="ossm-about-smcp_ossm-create-smcp"><div class="titlepage"><div><div><h3 class="title">1.8.1. About ServiceMeshControlPlane</h3></div></div></div><p>
					The control plane includes Istiod, Ingress and Egress Gateways, and other components, such as Kiali and Jaeger. The control plane must be deployed in a separate namespace than the Service Mesh Operators and the data plane applications and services. You can deploy a basic installation of the <code class="literal">ServiceMeshControlPlane</code>(SMCP) from the OpenShift Container Platform web console or the command line using the <code class="literal">oc</code> client tool.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						This basic installation is configured based on the default OpenShift Container Platform settings and is not designed for production use. Use this default installation to verify your installation, and then configure your <code class="literal">ServiceMeshControlPlane</code> settings for your environment.
					</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Red Hat OpenShift Service on AWS (ROSA) places additional restrictions on where you can create resources, and as a result, the default deployment does not work. See Installing Service Mesh on Red Hat OpenShift Service on AWS for additional requirements before deploying your SMCP in a ROSA environment.
					</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The Service Mesh documentation uses <code class="literal">istio-system</code> as the example project, but you can deploy the service mesh to any project.
					</p></div></div><section class="section" id="ossm-control-plane-deploy-operatorhub_ossm-create-smcp"><div class="titlepage"><div><div><h4 class="title">1.8.1.1. Deploying the Service Mesh control plane from the web console</h4></div></div></div><p>
						You can deploy a basic <code class="literal">ServiceMeshControlPlane</code> by using the web console. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The Red Hat OpenShift Service Mesh Operator must be installed.
							</li><li class="listitem">
								An account with the <code class="literal">cluster-admin</code> role.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
							</li><li class="listitem"><p class="simpara">
								Create a project named <code class="literal">istio-system</code>.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Navigate to <span class="strong strong"><strong>Home</strong></span> → <span class="strong strong"><strong>Projects</strong></span>.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Create Project</strong></span>.
									</li><li class="listitem"><p class="simpara">
										In the <span class="strong strong"><strong>Name</strong></span> field, enter <code class="literal">istio-system</code>. The <code class="literal">ServiceMeshControlPlane</code> resource must be installed in a project that is separate from your microservices and Operators.
									</p><p class="simpara">
										These steps use <code class="literal">istio-system</code> as an example, but you can deploy your Service Mesh control plane in any project as long as it is separate from the project that contains your services.
									</p></li><li class="listitem">
										Click <span class="strong strong"><strong>Create</strong></span>.
									</li></ol></div></li><li class="listitem">
								Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the Red Hat OpenShift Service Mesh Operator, then click <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span>.
							</li><li class="listitem">
								On the <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span> tab, click <span class="strong strong"><strong>Create ServiceMeshControlPlane</strong></span>.
							</li><li class="listitem"><p class="simpara">
								On the <span class="strong strong"><strong>Create ServiceMeshControlPlane</strong></span> page, accept the default Service Mesh control plane version to take advantage of the features available in the most current version of the product. The version of the control plane determines the features available regardless of the version of the Operator.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Click <span class="strong strong"><strong>Create</strong></span>. The Operator creates pods, services, and Service Mesh control plane components based on your configuration parameters. You can configure <code class="literal">ServiceMeshControlPlane</code> settings later.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								To verify the control plane installed correctly, click the <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span> tab.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Click the name of the new control plane.
									</li><li class="listitem">
										Click the <span class="strong strong"><strong>Resources</strong></span> tab to see the Red Hat OpenShift Service Mesh control plane resources the Operator created and configured.
									</li></ol></div></li></ol></div></section><section class="section" id="ossm-control-plane-deploy-cli_ossm-create-smcp"><div class="titlepage"><div><div><h4 class="title">1.8.1.2. Deploying the Service Mesh control plane using the CLI</h4></div></div></div><p>
						You can deploy a basic <code class="literal">ServiceMeshControlPlane</code> from the command line.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The Red Hat OpenShift Service Mesh Operator must be installed.
							</li><li class="listitem">
								Access to the OpenShift CLI (<code class="literal">oc</code>).
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Log in to the OpenShift Container Platform CLI as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
							</p><pre class="programlisting language-terminal">$ oc login --username=&lt;NAMEOFUSER&gt; https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
								Create a project named <code class="literal">istio-system</code>.
							</p><pre class="programlisting language-terminal">$ oc new-project istio-system</pre></li><li class="listitem"><p class="simpara">
								Create a <code class="literal">ServiceMeshControlPlane</code> file named <code class="literal">istio-installation.yaml</code> using the following example. The version of the Service Mesh control plane determines the features available regardless of the version of the Operator.
							</p><div class="formalpara"><p class="title"><strong>Example version 2.4 istio-installation.yaml</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
  namespace: istio-system
spec:
  version: v2.4
  tracing:
    type: Jaeger
    sampling: 10000
  addons:
    jaeger:
      name: jaeger
      install:
        storage:
          type: Memory
    kiali:
      enabled: true
      name: kiali
    grafana:
      enabled: true</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Run the following command to deploy the Service Mesh control plane, where <code class="literal">&lt;istio_installation.yaml&gt;</code> includes the full path to your file.
							</p><pre class="programlisting language-terminal">$ oc create -n istio-system -f &lt;istio_installation.yaml&gt;</pre></li><li class="listitem"><p class="simpara">
								To watch the progress of the pod deployment, run the following command:
							</p><pre class="programlisting language-terminal">$ oc get pods -n istio-system -w</pre><p class="simpara">
								You should see output similar to the following:
							</p><pre class="programlisting language-terminal">NAME                                   READY   STATUS    RESTARTS   AGE
grafana-b4d59bd7-mrgbr                 2/2     Running   0          65m
istio-egressgateway-678dc97b4c-wrjkp   1/1     Running   0          108s
istio-ingressgateway-b45c9d54d-4qg6n   1/1     Running   0          108s
istiod-basic-55d78bbbcd-j5556          1/1     Running   0          108s
jaeger-67c75bd6dc-jv6k6                2/2     Running   0          65m
kiali-6476c7656c-x5msp                 1/1     Running   0          43m
prometheus-58954b8d6b-m5std            2/2     Running   0          66m</pre></li></ol></div></section><section class="section" id="ossm-validate-control-plane-cli_ossm-create-smcp"><div class="titlepage"><div><div><h4 class="title">1.8.1.3. Validating your SMCP installation with the CLI</h4></div></div></div><p>
						You can validate the creation of the <code class="literal">ServiceMeshControlPlane</code> from the command line.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Log in to the OpenShift Container Platform CLI as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
							</p><pre class="programlisting language-terminal">$ oc login https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
								Run the following command to verify the Service Mesh control plane installation, where <code class="literal">istio-system</code> is the namespace where you installed the Service Mesh control plane.
							</p><pre class="programlisting language-terminal">$ oc get smcp -n istio-system</pre><p class="simpara">
								The installation has finished successfully when the <code class="literal">STATUS</code> column is <code class="literal">ComponentsReady</code>.
							</p><pre class="programlisting language-terminal">NAME    READY   STATUS            PROFILES      VERSION   AGE
basic   10/10   ComponentsReady   ["default"]   2.1.1     66m</pre></li></ol></div></section></section><section class="section" id="ossm-about-control-plane-components-and-infrastructure-nodes_ossm-create-smcp"><div class="titlepage"><div><div><h3 class="title">1.8.2. About control plane components and infrastructure nodes</h3></div></div></div><p>
					Infrastructure nodes provide a way to isolate infrastructure workloads for two primary purposes:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							To prevent incurring billing costs against subscription counts
						</li><li class="listitem">
							To separate maintenance and management of infrastructure workloads
						</li></ul></div><p>
					You can configure some or all of the Service Mesh control plane components to run on infrastructure nodes.
				</p><section class="section" id="ossm-config-control-plane-infrastructure-node-console_ossm-create-smcp"><div class="titlepage"><div><div><h4 class="title">1.8.2.1. Configuring all control plane components to run on infrastructure nodes using the web console</h4></div></div></div><p>
						Perform this task if all of the components deployed by the Service Mesh control plane will run on infrastructure nodes. These deployed components include Istiod, Ingress Gateway, and Egress Gateway, and optional applications such as Prometheus, Grafana, and Distributed Tracing.
					</p><p>
						If the control plane will run on a worker node, skip this task.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have installed the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								You are logged in as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you are logged in as a user with the <code class="literal">dedicated-admin</code> role.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console.
							</li><li class="listitem">
								Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the Red Hat OpenShift Service Mesh Operator, and then click <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span>.
							</li><li class="listitem">
								Click the name of the control plane resource. For example, <code class="literal">basic</code>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>YAML</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Add the <code class="literal">nodeSelector</code> and <code class="literal">tolerations</code> fields to the <code class="literal">spec.runtime.defaults.pod</code> specification in the <code class="literal">ServiceMeshControlPlane</code> resource, as shown in the following example:
							</p><pre class="programlisting language-yaml">spec:
  runtime:
    defaults:
      pod:
        nodeSelector: <span id="CO5-1"><!--Empty--></span><span class="callout">1</span>
          node-role.kubernetes.io/infra: ""
        tolerations: <span id="CO5-2"><!--Empty--></span><span class="callout">2</span>
        - effect: NoSchedule
          key: node-role.kubernetes.io/infra
          value: reserved
        - effect: NoExecute
          key: node-role.kubernetes.io/infra
          value: reserved</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO5-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Ensures that the <code class="literal">ServiceMeshControlPlane</code> pod is only scheduled on an infrastructure node.
									</div></dd><dt><a href="#CO5-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Ensures that the pod is accepted by the infrastructure node for execution.
									</div></dd></dl></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Reload</strong></span>.
							</li></ol></div></section><section class="section" id="ossm-config-individual-control-plane-infrastructure-node-console_ossm-create-smcp"><div class="titlepage"><div><div><h4 class="title">1.8.2.2. Configuring individual control plane components to run on infrastructure nodes using the web console</h4></div></div></div><p>
						Perform this task if individual components deployed by the Service Mesh control plane will run on infrastructure nodes. These deployed components include Istiod, the Ingress Gateway, and the Egress Gateway.
					</p><p>
						If the control plane will run on a worker node, skip this task.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have installed the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								You are logged in as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you are logged in as a user with the <code class="literal">dedicated-admin</code> role.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console.
							</li><li class="listitem">
								Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the Red Hat OpenShift Service Mesh Operator, and then click <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span>.
							</li><li class="listitem">
								Click the name of the control plane resource. For example, <code class="literal">basic</code>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>YAML</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Add the <code class="literal">nodeSelector</code> and <code class="literal">tolerations</code> fields to the <code class="literal">spec.runtime.components.pilot.pod</code> specification in the <code class="literal">ServiceMeshControlPlane</code> resource, as shown in the following example:
							</p><pre class="programlisting language-yaml">spec:
  runtime:
    components:
      pilot:
        pod:
          nodeSelector: <span id="CO6-1"><!--Empty--></span><span class="callout">1</span>
            node-role.kubernetes.io/infra: ""
          tolerations: <span id="CO6-2"><!--Empty--></span><span class="callout">2</span>
          - effect: NoSchedule
            key: node-role.kubernetes.io/infra
            value: reserved
          - effect: NoExecute
            key: node-role.kubernetes.io/infra
            value: reserved</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO6-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Ensures that the <code class="literal">Istiod</code> pod is only scheduled on an infrastructure node.
									</div></dd><dt><a href="#CO6-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Ensures that the pod is accepted by the infrastructure node for execution.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Add the <code class="literal">nodeSelector</code> and the <code class="literal">tolerations</code> fields to the <code class="literal">spec.gateways.ingress.runtime.pod</code> and <code class="literal">spec.gateways.egress.runtime.pod</code> specifications in the <code class="literal">ServiceMeshControlPlane</code> resource, as shown in the following example:
							</p><pre class="programlisting language-yaml">spec:
  gateways:
    ingress:
      runtime:
        pod:
          nodeSelector: <span id="CO7-1"><!--Empty--></span><span class="callout">1</span>
            node-role.kubernetes.io/infra: ""
          tolerations: <span id="CO7-2"><!--Empty--></span><span class="callout">2</span>
          - effect: NoSchedule
            key: node-role.kubernetes.io/infra
            value: reserved
          - effect: NoExecute
            key: node-role.kubernetes.io/infra
            value: reserved
    egress:
      runtime:
        pod:
          nodeSelector: <span id="CO7-3"><!--Empty--></span><span class="callout">3</span>
            node-role.kubernetes.io/infra: ""
          tolerations: <span id="CO7-4"><!--Empty--></span><span class="callout">4</span>
          - effect: NoSchedule
            key: node-role.kubernetes.io/infra
            value: reserved
          - effect: NoExecute
            key: node-role.kubernetes.io/infra
            value: reserved</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO7-1"><span class="callout">1</span></a> <a href="#CO7-3"><span class="callout">3</span></a> </dt><dd><div class="para">
										Ensures that the gateway pod is only scheduled on an infrastructure node
									</div></dd><dt><a href="#CO7-2"><span class="callout">2</span></a> <a href="#CO7-4"><span class="callout">4</span></a> </dt><dd><div class="para">
										Ensures that the pod is accepted by the infrastructure node for execution.
									</div></dd></dl></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Reload</strong></span>.
							</li></ol></div></section><section class="section" id="ossm-config-control-plane-infrastructure-node-cli_ossm-create-smcp"><div class="titlepage"><div><div><h4 class="title">1.8.2.3. Configuring all control plane components to run on infrastructure nodes using the CLI</h4></div></div></div><p>
						Perform this task if all of the components deployed by the Service Mesh control plane will run on infrastructure nodes. These deployed components include Istiod, Ingress Gateway, and Egress Gateway, and optional applications such as Prometheus, Grafana, and Distributed Tracing.
					</p><p>
						If the control plane will run on a worker node, skip this task.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have installed the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								You are logged in as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you are logged in as a user with the <code class="literal">dedicated-admin</code> role.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Open the <code class="literal">ServiceMeshControlPlane</code> resource as a YAML file:
							</p><pre class="programlisting language-terminal">$ oc -n istio-system edit smcp &lt;name&gt; <span id="CO8-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO8-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										<code class="literal">&lt;name&gt;</code> represents the name of the <code class="literal">ServiceMeshControlPlane</code> resource.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								To run all of the Service Mesh components deployed by the <code class="literal">ServiceMeshControlPlane</code> on infrastructure nodes, add the <code class="literal">nodeSelector</code> and <code class="literal">tolerations</code> fields to the <code class="literal">spec.runtime.defaults.pod</code> spec in the <code class="literal">ServiceMeshControlPlane</code> resource:
							</p><pre class="programlisting language-yaml">spec:
  runtime:
    defaults:
      pod:
        nodeSelector: <span id="CO9-1"><!--Empty--></span><span class="callout">1</span>
          node-role.kubernetes.io/infra: ""
        tolerations: <span id="CO9-2"><!--Empty--></span><span class="callout">2</span>
        - effect: NoSchedule
          key: node-role.kubernetes.io/infra
          value: reserved
        - effect: NoExecute
          key: node-role.kubernetes.io/infra
          value: reserved</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO9-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Ensures that the SMCP pods are only scheduled on an infrastructure node.
									</div></dd><dt><a href="#CO9-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Ensures that the pods are accepted by the infrastructure node.
									</div></dd></dl></div></li></ol></div></section><section class="section" id="ossm-config-individual-control-plane-infrastructure-node-cli_ossm-create-smcp"><div class="titlepage"><div><div><h4 class="title">1.8.2.4. Configuring individual control plane components to run on infrastructure nodes using the CLI</h4></div></div></div><p>
						Perform this task if individual components deployed by the Service Mesh control plane will run on infrastructure nodes. These deployed components include Istiod, the Ingress Gateway, and the Egress Gateway.
					</p><p>
						If the control plane will run on a worker node, skip this task.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have installed the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								You are logged in as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you are logged in as a user with the <code class="literal">dedicated-admin</code> role.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Open the <code class="literal">ServiceMeshControlPlane</code> resource as a YAML file.
							</p><pre class="programlisting language-terminal">$ oc -n istio-system edit smcp &lt;name&gt; <span id="CO10-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO10-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										<code class="literal">&lt;name&gt;</code> represents the name of the <code class="literal">ServiceMeshControlPlane</code> resource.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								To run the Istiod component on an infrastructure node, add the <code class="literal">nodeSelector</code> and the <code class="literal">tolerations</code> fields to the <code class="literal">spec.runtime.components.pilot.pod</code> spec in the <code class="literal">ServiceMeshControlPlane</code> resource.
							</p><pre class="programlisting language-yaml">spec:
  runtime:
    components:
      pilot:
        pod:
          nodeSelector: <span id="CO11-1"><!--Empty--></span><span class="callout">1</span>
            node-role.kubernetes.io/infra: ""
          tolerations: <span id="CO11-2"><!--Empty--></span><span class="callout">2</span>
          - effect: NoSchedule
            key: node-role.kubernetes.io/infra
            value: reserved
          - effect: NoExecute
            key: node-role.kubernetes.io/infra
            value: reserved</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO11-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Ensures that the <code class="literal">Istiod</code> pod is only scheduled on an infrastructure node.
									</div></dd><dt><a href="#CO11-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Ensures that the pod is accepted by the infrastructure node.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								To run Ingress and Egress Gateways on infrastructure nodes, add the <code class="literal">nodeSelector</code> and the <code class="literal">tolerations</code> fields to the <code class="literal">spec.gateways.ingress.runtime.pod</code> spec and the <code class="literal">spec.gateways.egress.runtime.pod</code> spec in the <code class="literal">ServiceMeshControlPlane</code> resource.
							</p><pre class="programlisting language-yaml">spec:
  gateways:
    ingress:
      runtime:
        pod:
          nodeSelector: <span id="CO12-1"><!--Empty--></span><span class="callout">1</span>
            node-role.kubernetes.io/infra: ""
          tolerations: <span id="CO12-2"><!--Empty--></span><span class="callout">2</span>
          - effect: NoSchedule
            key: node-role.kubernetes.io/infra
            value: reserved
          - effect: NoExecute
            key: node-role.kubernetes.io/infra
            value: reserved
    egress:
      runtime:
        pod:
          nodeSelector: <span id="CO12-3"><!--Empty--></span><span class="callout">3</span>
            node-role.kubernetes.io/infra: ""
          tolerations: <span id="CO12-4"><!--Empty--></span><span class="callout">4</span>
          - effect: NoSchedule
            key: node-role.kubernetes.io/infra
            value: reserved
          - effect: NoExecute
            key: node-role.kubernetes.io/infra
            value: reserved</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO12-1"><span class="callout">1</span></a> <a href="#CO12-3"><span class="callout">3</span></a> </dt><dd><div class="para">
										Ensures that the gateway pod is only scheduled on an infrastructure node
									</div></dd><dt><a href="#CO12-2"><span class="callout">2</span></a> <a href="#CO12-4"><span class="callout">4</span></a> </dt><dd><div class="para">
										Ensures that the pod is accepted by the infrastructure node.
									</div></dd></dl></div></li></ol></div></section><section class="section" id="ossm-confirm-smcp-infrastructure-node_ossm-create-smcp"><div class="titlepage"><div><div><h4 class="title">1.8.2.5. Verifying the Service Mesh control plane is running on infrastructure nodes</h4></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Confirm that the nodes associated with Istiod, Ingress Gateway, and Egress Gateway pods are infrastructure nodes:
							</p><pre class="programlisting language-terminal">$ oc -n istio-system get pods -owide</pre></li></ul></div></section></section><section class="section" id="ossm-about-control-plane-and-cluster-wide-deployment_ossm-create-smcp"><div class="titlepage"><div><div><h3 class="title">1.8.3. About control plane and cluster-wide deployments</h3></div></div></div><p>
					A cluster-wide deployment contains a Service Mesh Control Plane that monitors resources for an entire cluster. Monitoring resources for an entire cluster closely resembles Istio functionality in that the control plane uses a single query across all namespaces to monitor Istio and Kubernetes resources. As a result, cluster-wide deployments decrease the number of requests sent to the API server.
				</p><p>
					You can configure the Service Mesh Control Plane for cluster-wide deployments using either the OpenShift Container Platform web console or the CLI.
				</p><section class="section" id="ossm-deploy-cluster-wide-control-plane-console_ossm-create-smcp"><div class="titlepage"><div><div><h4 class="title">1.8.3.1. Configuring the control plane for cluster-wide deployment with the web console</h4></div></div></div><p>
						You can configure the <code class="literal">ServiceMeshControlPlane</code> resource for cluster-wide deployment using the OpenShift Container Platform web console. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The Red Hat OpenShift Service Mesh Operator is installed.
							</li><li class="listitem">
								You are logged in using an account with the <code class="literal">cluster-admin</code> role, or if you use Red Hat OpenShift Dedicated with the <code class="literal">dedicated-admin</code> role.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a project named <code class="literal">istio-system</code>.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Navigate to <span class="strong strong"><strong>Home</strong></span> → <span class="strong strong"><strong>Projects</strong></span>.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Create Project</strong></span>.
									</li><li class="listitem"><p class="simpara">
										In the <span class="strong strong"><strong>Name</strong></span> field, enter <code class="literal">istio-system</code>. The <code class="literal">ServiceMeshControlPlane</code> resource must be installed in a project that is separate from your microservices and Operators.
									</p><p class="simpara">
										These steps use <code class="literal">istio-system</code> as an example. You can deploy the Service Mesh control plane to any project as long as it is separate from the project that contains your services.
									</p></li><li class="listitem">
										Click <span class="strong strong"><strong>Create</strong></span>.
									</li></ol></div></li><li class="listitem">
								Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the Red Hat OpenShift Service Mesh Operator, then click <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span>.
							</li><li class="listitem">
								On the <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span> tab, click <span class="strong strong"><strong>Create ServiceMeshControlPlane</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>YAML view</strong></span>. The version of the Service Mesh control plane determines the features available regardless of the version of the Operator.
							</li><li class="listitem"><p class="simpara">
								Modify the <code class="literal">spec.mode</code> field of the YAML file to specify <code class="literal">ClusterWide</code>.
							</p><div class="formalpara"><p class="title"><strong>Example version 2.4 istio-installation.yaml</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
  namespace: istio-system
spec:
  version: v2.4
  mode: ClusterWide</pre>

								</p></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Create</strong></span>. The Operator creates pods, services, and Service Mesh control plane components based on your configuration parameters. The operator also creates the <code class="literal">ServiceMeshMemberRoll</code> if it does not exist as part of the default configuration.
							</li><li class="listitem"><p class="simpara">
								To verify that the control plane installed correctly, click the <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span> tab.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Click the name of the new <code class="literal">ServiceMeshControlPlane</code> object.
									</li><li class="listitem">
										Click the <span class="strong strong"><strong>Resources</strong></span> tab to see the Red Hat OpenShift Service Mesh control plane resources that the Operator created and configured.
									</li></ol></div></li></ol></div><p>
						This module is included in the following assemblies: * service_mesh/v2x/ossm-create-smcp.adoc :_content-type: PROCEDURE
					</p></section><section class="section" id="ossm-deploy-cluster-wide-control-plane-cli_ossm-create-smcp"><div class="titlepage"><div><div><h4 class="title">1.8.3.2. Configuring the control plane for cluster-wide deployment with the CLI</h4></div></div></div><p>
						You can configure the <code class="literal">ServiceMeshControlPlane</code> resource for cluster-wide deployment using the CLI. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane namespace.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The Red Hat OpenShift Service Mesh Operator is installed.
							</li><li class="listitem">
								You have access to the OpenShift CLI (<code class="literal">oc</code>).
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Log in to the OpenShift Container Platform CLI as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
							</p><pre class="programlisting language-terminal">$ oc login --username=&lt;NAMEOFUSER&gt; https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
								Create a project named <code class="literal">istio-system</code>.
							</p><pre class="programlisting language-terminal">$ oc new-project istio-system</pre></li><li class="listitem"><p class="simpara">
								Create a <code class="literal">ServiceMeshControlPlane</code> file named <code class="literal">istio-installation.yaml</code> using the following example.
							</p><div class="formalpara"><p class="title"><strong>Example version 2.4 istio-installation.yaml</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
  namespace: istio-system
spec:
  version: v2.4
  mode: ClusterWide</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Run the following command to deploy the Service Mesh control plane, where <code class="literal">&lt;istio_installation.yaml&gt;</code> includes the full path to your file.
							</p><pre class="programlisting language-terminal">$ oc create -n istio-system -f &lt;istio_installation.yaml&gt;</pre></li><li class="listitem"><p class="simpara">
								To monitor the progress of the pod deployment, run the following command:
							</p><pre class="programlisting language-terminal">$ oc get pods -n istio-system -w</pre><p class="simpara">
								You should see output similar to the following example:
							</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                   READY   STATUS    RESTARTS   AGE
grafana-b4d59bd7-mrgbr                 2/2     Running   0          65m
istio-egressgateway-678dc97b4c-wrjkp   1/1     Running   0          108s
istio-ingressgateway-b45c9d54d-4qg6n   1/1     Running   0          108s
istiod-basic-55d78bbbcd-j5556          1/1     Running   0          108s
jaeger-67c75bd6dc-jv6k6                2/2     Running   0          65m
kiali-6476c7656c-x5msp                 1/1     Running   0          43m
prometheus-58954b8d6b-m5std            2/2     Running   0          66m</pre>

								</p></div></li></ol></div><p>
						This module is included in the following assemblies: * service_mesh/v2x/ossm-create-smcp.adoc
					</p></section><section class="section" id="ossm-customize-smrr-cluster-wide_ossm-create-smcp"><div class="titlepage"><div><div><h4 class="title">1.8.3.3. Customizing the member roll for a cluster-wide mesh</h4></div></div></div><p>
						In cluster-wide mode, when you create the <code class="literal">ServiceMeshControlPlane</code> resource, the <code class="literal">ServiceMeshMemberRoll</code> resource is also created. You can modify the <code class="literal">ServiceMeshMemberRoll</code> resource after it gets created. After you modify the resource, the Service Mesh operator no longer changes it. If you modify the <code class="literal">ServiceMeshMemberRoll</code> resource by using the OpenShift Container Platform web console, accept the prompt to overwrite the modifications.
					</p><p>
						Alternatively, you can create a <code class="literal">ServiceMeshMemberRoll</code> resource before deploying the <code class="literal">ServiceMeshControlPlane</code> resource. When you create the <code class="literal">ServiceMeshControlPlane</code> resource, the Service Mesh Operator will not modify the <code class="literal">ServiceMeshMemberRoll</code>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The <code class="literal">ServiceMeshMemberRoll</code> resource name must be named <code class="literal">default</code> and must be created in the same project namespace as the <code class="literal">ServiceMeshControlPlane</code> resource.
						</p></div></div><p>
						There are two ways to add a namespace to the mesh. You can either add the namespace by specifying its name in the <code class="literal">spec.members</code> list, or configure a set of namespace label selectors to include or exclude namespaces based on their labels.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Regardless of how members are specified in the <code class="literal">ServiceMeshMemberRoll</code> resource, you can also add members to the mesh by creating the <code class="literal">ServiceMeshMember</code> resource in each namespace.
						</p></div></div></section></section><section class="section" id="ossm-validate-control-plane-kiali_ossm-create-smcp"><div class="titlepage"><div><div><h3 class="title">1.8.4. Validating your SMCP installation with Kiali</h3></div></div></div><p>
					You can use the Kiali console to validate your Service Mesh installation. The Kiali console offers several ways to validate your Service Mesh components are deployed and configured properly.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform web console as a user with cluster-admin rights. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
						</li><li class="listitem">
							Navigate to <span class="strong strong"><strong>Networking</strong></span> → <span class="strong strong"><strong>Routes</strong></span>.
						</li><li class="listitem"><p class="simpara">
							On the <span class="strong strong"><strong>Routes</strong></span> page, select the Service Mesh control plane project, for example <code class="literal">istio-system</code>, from the <span class="strong strong"><strong>Namespace</strong></span> menu.
						</p><p class="simpara">
							The <span class="strong strong"><strong>Location</strong></span> column displays the linked address for each route.
						</p></li><li class="listitem">
							If necessary, use the filter to find the route for the Kiali console. Click the route <span class="strong strong"><strong>Location</strong></span> to launch the console.
						</li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Log In With OpenShift</strong></span>.
						</p><p class="simpara">
							When you first log in to the Kiali Console, you see the <span class="strong strong"><strong>Overview</strong></span> page which displays all the namespaces in your service mesh that you have permission to view. When there are multiple namespaces shown on the <span class="strong strong"><strong>Overview</strong></span> page, Kiali shows namespaces with health or validation problems first.
						</p><div class="figure" id="idm140663674742976"><p class="title"><strong>Figure 1.1. Kiali Overview page</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/8bd04c5e1d4eed5fec02d48b0a31d405/ossm-kiali-overview.png" alt="Kiali Overview page showing istio-system"/></div></div></div><p class="simpara">
							The tile for each namespace displays the number of labels, the <span class="strong strong"><strong>Istio Config</strong></span> health, the number of and <span class="strong strong"><strong>Applications</strong></span> health, and <span class="strong strong"><strong>Traffic</strong></span> for the namespace. If you are validating the console installation and namespaces have not yet been added to the mesh, there might not be any data to display other than <code class="literal">istio-system</code>.
						</p></li><li class="listitem"><p class="simpara">
							Kiali has four dashboards specifically for the namespace where the Service Mesh control plane is installed. To view these dashboards, click the <span class="strong strong"><strong>Options</strong></span> menu 
							<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
							 on the tile for the control plane namespace, for example, <code class="literal">istio-system</code>, and select one of the following options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Istio Mesh Dashboard</strong></span>
								</li><li class="listitem">
									<span class="strong strong"><strong>Istio Control Plane Dashboard</strong></span>
								</li><li class="listitem">
									<span class="strong strong"><strong>Istio Performance Dashboard</strong></span>
								</li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>Istio Wasm Exetension Dashboard</strong></span>
								</p><div class="figure" id="idm140663667489920"><p class="title"><strong>Figure 1.2. Grafana Istio Control Plane Dashboard</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/8fa6553dc84d17e3908f39ba2988e712/ossm-grafana-control-plane-dashboard.png" alt="Istio Control Plane Dashboard showing data for bookinfo sample project"/></div></div></div><p class="simpara">
									Kiali also installs two additional Grafana dashboards, available from the Grafana <span class="strong strong"><strong>Home</strong></span> page:
								</p></li><li class="listitem">
									<span class="strong strong"><strong>Istio Workload Dashboard</strong></span>
								</li><li class="listitem">
									<span class="strong strong"><strong>Istio Service Dashboard</strong></span>
								</li></ul></div></li><li class="listitem"><p class="simpara">
							To view the Service Mesh control plane nodes, click the <span class="strong strong"><strong>Graph</strong></span> page, select the <span class="strong strong"><strong>Namespace</strong></span> where you installed the <code class="literal">ServiceMeshControlPlane</code> from the menu, for example <code class="literal">istio-system</code>.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									If necessary, click <span class="strong strong"><strong>Display idle nodes</strong></span>.
								</li><li class="listitem">
									To learn more about the <span class="strong strong"><strong>Graph</strong></span> page, click the <span class="strong strong"><strong>Graph tour</strong></span> link.
								</li><li class="listitem">
									To view the mesh topology, select one or more additional namespaces from the Service Mesh Member Roll from the <span class="strong strong"><strong>Namespace</strong></span> menu.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							To view the list of applications in the <code class="literal">istio-system</code> namespace, click the <span class="strong strong"><strong>Applications</strong></span> page. Kiali displays the health of the applications.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Hover your mouse over the information icon to view any additional information noted in the <span class="strong strong"><strong>Details</strong></span> column.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							To view the list of workloads in the <code class="literal">istio-system</code> namespace, click the <span class="strong strong"><strong>Workloads</strong></span> page. Kiali displays the health of the workloads.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Hover your mouse over the information icon to view any additional information noted in the <span class="strong strong"><strong>Details</strong></span> column.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							To view the list of services in the <code class="literal">istio-system</code> namespace, click the <span class="strong strong"><strong>Services</strong></span> page. Kiali displays the health of the services and of the configurations.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Hover your mouse over the information icon to view any additional information noted in the <span class="strong strong"><strong>Details</strong></span> column.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							To view a list of the Istio Configuration objects in the <code class="literal">istio-system</code> namespace, click the <span class="strong strong"><strong>Istio Config</strong></span> page. Kiali displays the health of the configuration.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									If there are configuration errors, click the row and Kiali opens the configuration file with the error highlighted.
								</li></ol></div></li></ol></div></section><section class="section" id="ossm-install-rosa_ossm-create-smcp"><div class="titlepage"><div><div><h3 class="title">1.8.5. Installing on Red Hat OpenShift Service on AWS (ROSA)</h3></div></div></div><p>
					Starting with version 2.2, Red Hat OpenShift Service Mesh supports installation on Red Hat OpenShift Service on AWS (ROSA). This section documents the additional requirements when installing Service Mesh on this platform.
				</p><section class="section" id="ossm-install-rosa-location_ossm-create-smcp"><div class="titlepage"><div><div><h4 class="title">1.8.5.1. Installation location</h4></div></div></div><p>
						You must create a new namespace, for example <code class="literal">istio-system</code>, when installing Red Hat OpenShift Service Mesh and creating the <code class="literal">ServiceMeshControlPlane</code>.
					</p></section><section class="section" id="ossm-install-rosa-smcp_ossm-create-smcp"><div class="titlepage"><div><div><h4 class="title">1.8.5.2. Required Service Mesh control plane configuration</h4></div></div></div><p>
						The default configuration in the <code class="literal">ServiceMeshControlPlane</code> file does not work on a ROSA cluster. You must modify the default SMCP and set <code class="literal">spec.security.identity.type=ThirdParty</code> when installing on Red Hat OpenShift Service on AWS.
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">ServiceMeshControlPlane</code> resource for ROSA</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
  namespace: istio-system
spec:
  version: v2.4
  security:
    identity:
      type: ThirdParty  #required setting for ROSA
  tracing:
    type: Jaeger
    sampling: 10000
  policy:
    type: Istiod
  addons:
    grafana:
      enabled: true
    jaeger:
      install:
        storage:
          type: Memory
    kiali:
      enabled: true
    prometheus:
      enabled: true
  telemetry:
    type: Istiod</pre>

						</p></div></section><section class="section" id="ossm-install-rosa-kiali-config_ossm-create-smcp"><div class="titlepage"><div><div><h4 class="title">1.8.5.3. Restrictions on Kiali configuration</h4></div></div></div><p>
						Red Hat OpenShift Service on AWS places additional restrictions on where you can create resources and does not let you create the Kiali resource in a Red Hat managed namespace.
					</p><p>
						This means that the following common settings for <code class="literal">spec.deployment.accessible_namespaces</code> are not allowed in a ROSA cluster:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">['**']</code> (all namespaces)
							</li><li class="listitem">
								<code class="literal">default</code>
							</li><li class="listitem">
								<code class="literal">codeready-*</code>
							</li><li class="listitem">
								<code class="literal">openshift-*</code>
							</li><li class="listitem">
								<code class="literal">redhat-*</code>
							</li></ul></div><p>
						The validation error message provides a complete list of all the restricted namespaces.
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">Kiali</code> resource for ROSA</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: kiali.io/v1alpha1
kind: Kiali
metadata:
  name: kiali
  namespace: istio-system
spec:
  auth:
    strategy: openshift
  deployment:
    accessible_namespaces:   #restricted setting for ROSA
      - istio-system
    image_pull_policy: ''
    ingress_enabled: true
    namespace: istio-system</pre>

						</p></div></section></section><section class="section _additional-resources" id="additional-resources"><div class="titlepage"><div><div><h3 class="title">1.8.6. Additional resources</h3></div></div></div><p>
					Red Hat OpenShift Service Mesh supports multiple independent control planes within the cluster. You can create reusable configurations with <code class="literal">ServiceMeshControlPlane</code> profiles. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-control-plane-profiles_ossm-profiles-users">Creating control plane profiles</a>.
				</p></section><section class="section" id="next-steps-4"><div class="titlepage"><div><div><h3 class="title">1.8.7. Next steps</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Add a project to the Service Mesh so that applications can be made available. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-create-mesh">Adding services to a service mesh</a>.
						</li></ul></div></section></section><section class="section" id="ossm-create-mesh"><div class="titlepage"><div><div><h2 class="title">1.9. Adding services to a service mesh</h2></div></div></div><p>
				A project contains services; however, the services are only available if you add the project to the service mesh.
			</p><section class="section" id="ossm-about-adding-namespace_ossm-create-mesh"><div class="titlepage"><div><div><h3 class="title">1.9.1. About adding projects to a service mesh</h3></div></div></div><p>
					After installing the Operators and creating the <code class="literal">ServiceMeshControlPlane</code> resource, add one or more projects to the service mesh.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						In OpenShift Container Platform, a project is essentially a Kubernetes namespace with additional annotations, such as the range of user IDs that can be used in the project. Typically, the OpenShift Container Platform web console uses the term project, and the CLI uses the term namespace, but the terms are essentially synonymous.
					</p></div></div><p>
					You can add projects to an existing service mesh using either the OpenShift Container Platform web console or the CLI. There are three methods to add a project to a service mesh:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Specifying the project name in the <code class="literal">ServiceMeshMemberRoll</code> resource.
						</li><li class="listitem">
							Configuring label selectors in the <code class="literal">spec.labelSelectors</code> field of the <code class="literal">ServiceMeshMemberRoll</code> resource.
						</li><li class="listitem">
							Creating the <code class="literal">ServiceMeshMember</code> resource in the project.
						</li></ul></div><p>
					If you use the first method, then you must create the <code class="literal">ServiceMeshMemberRoll</code> resource.
				</p></section><section class="section" id="ossm-member-roll-create_ossm-create-mesh"><div class="titlepage"><div><div><h3 class="title">1.9.2. Creating the Red Hat OpenShift Service Mesh member roll</h3></div></div></div><p>
					The <code class="literal">ServiceMeshMemberRoll</code> lists the projects that belong to the Service Mesh control plane. Only projects listed in the <code class="literal">ServiceMeshMemberRoll</code> are affected by the control plane. A project does not belong to a service mesh until you add it to the member roll for a particular control plane deployment.
				</p><p>
					You must create a <code class="literal">ServiceMeshMemberRoll</code> resource named <code class="literal">default</code> in the same project as the <code class="literal">ServiceMeshControlPlane</code>, for example <code class="literal">istio-system</code>.
				</p><section class="section" id="ossm-member-roll-create-console_ossm-create-mesh"><div class="titlepage"><div><div><h4 class="title">1.9.2.1. Creating the member roll from the web console</h4></div></div></div><p>
						You can add one or more projects to the Service Mesh member roll from the web console. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								An installed, verified Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								List of existing projects to add to the service mesh.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console.
							</li><li class="listitem"><p class="simpara">
								If you do not already have services for your mesh, or you are starting from scratch, create a project for your applications. It must be different from the project where you installed the Service Mesh control plane.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Navigate to <span class="strong strong"><strong>Home</strong></span> → <span class="strong strong"><strong>Projects</strong></span>.
									</li><li class="listitem">
										Enter a name in the <span class="strong strong"><strong>Name</strong></span> field.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Create</strong></span>.
									</li></ol></div></li><li class="listitem">
								Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Project</strong></span> menu and choose the project where your <code class="literal">ServiceMeshControlPlane</code> resource is deployed from the list, for example <code class="literal">istio-system</code>.
							</li><li class="listitem">
								Click the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Istio Service Mesh Member Roll</strong></span> tab.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Create ServiceMeshMemberRoll</strong></span>
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Members</strong></span>, then enter the name of your project in the <span class="strong strong"><strong>Value</strong></span> field. You can add any number of projects, but a project can only belong to <span class="strong strong"><strong>one</strong></span> <code class="literal">ServiceMeshMemberRoll</code> resource.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Create</strong></span>.
							</li></ol></div></section><section class="section" id="ossm-member-roll-create-cli_ossm-create-mesh"><div class="titlepage"><div><div><h4 class="title">1.9.2.2. Creating the member roll from the CLI</h4></div></div></div><p>
						You can add a project to the <code class="literal">ServiceMeshMemberRoll</code> from the command line.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								An installed, verified Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								List of projects to add to the service mesh.
							</li><li class="listitem">
								Access to the OpenShift CLI (<code class="literal">oc</code>).
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Log in to the OpenShift Container Platform CLI.
							</p><pre class="programlisting language-terminal">$ oc login --username=&lt;NAMEOFUSER&gt; https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
								If you do not already have services for your mesh, or you are starting from scratch, create a project for your applications. It must be different from the project where you installed the Service Mesh control plane.
							</p><pre class="programlisting language-terminal">$ oc new-project &lt;your-project&gt;</pre></li><li class="listitem"><p class="simpara">
								To add your projects as members, modify the following example YAML. You can add any number of projects, but a project can only belong to <span class="strong strong"><strong>one</strong></span> <code class="literal">ServiceMeshMemberRoll</code> resource. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
							</p><div class="formalpara"><p class="title"><strong>Example servicemeshmemberroll-default.yaml</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshMemberRoll
metadata:
  name: default
  namespace: istio-system
spec:
  members:
    # a list of projects joined into the service mesh
    - your-project-name
    - another-project-name</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Run the following command to upload and create the <code class="literal">ServiceMeshMemberRoll</code> resource in the <code class="literal">istio-system</code> namespace.
							</p><pre class="programlisting language-terminal">$ oc create -n istio-system -f servicemeshmemberroll-default.yaml</pre></li><li class="listitem"><p class="simpara">
								Run the following command to verify the <code class="literal">ServiceMeshMemberRoll</code> was created successfully.
							</p><pre class="programlisting language-terminal">$ oc get smmr -n istio-system default</pre><p class="simpara">
								The installation has finished successfully when the <code class="literal">STATUS</code> column is <code class="literal">Configured</code>.
							</p></li></ol></div></section></section><section class="section" id="ossm-about-adding-projects-using-smmr_ossm-create-mesh"><div class="titlepage"><div><div><h3 class="title">1.9.3. About adding projects using the ServiceMeshMemberRoll resource</h3></div></div></div><p>
					Using the <code class="literal">ServiceMeshMemberRoll</code> resource is the simplest way to add a project to a service mesh. To add a project, specify the project name in the <code class="literal">spec.members</code> field of the <code class="literal">ServiceMeshMemberRoll</code> resource. The <code class="literal">ServiceMeshMemberRoll</code> resource specifies which projects are controlled by the <code class="literal">ServiceMeshControlPlane</code> resource.
				</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/9fdd62329fa28022e3dcca9df5861e18/ossm-adding-project-using-smmr.png" alt="Adding project using `ServiceMeshMemberRoll` resource image"/></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Adding projects using this method requires the user to have the <code class="literal">update servicemeshmemberrolls</code> and the <code class="literal">update pods</code> privileges in the project that is being added.
					</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							If you already have an application, workload, or service to add to the service mesh, see the following:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Adding or removing projects from the mesh using the <code class="literal">ServiceMeshMemberRoll</code> resource with the web console
								</li><li class="listitem">
									Adding or removing projects from the mesh using the <code class="literal">ServiceMeshMemberRoll</code> resource with the CLI
								</li></ul></div></li><li class="listitem">
							Alternatively, to install a sample application called Bookinfo and add it to a <code class="literal">ServiceMeshMemberRoll</code> resource, see the Bookinfo example application tutorial.
						</li></ul></div><section class="section" id="ossm-add-project-member-roll-recourse-console_ossm-create-mesh"><div class="titlepage"><div><div><h4 class="title">1.9.3.1. Adding or removing projects from the mesh using the ServiceMeshMemberRoll resource with the web console</h4></div></div></div><p>
						You can add or remove projects from the mesh using the <code class="literal">ServiceMeshMemberRoll</code> resource with the OpenShift Container Platform web console. You can add any number of projects, but a project can only belong to <span class="strong strong"><strong>one</strong></span> mesh.
					</p><p>
						The <code class="literal">ServiceMeshMemberRoll</code> resource is deleted when its corresponding <code class="literal">ServiceMeshControlPlane</code> resource is deleted.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								An installed, verified Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								An existing <code class="literal">ServiceMeshMemberRoll</code> resource.
							</li><li class="listitem">
								The name of the project with the <code class="literal">ServiceMeshMemberRoll</code> resource.
							</li><li class="listitem">
								The names of the projects you want to add or remove from the mesh.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console.
							</li><li class="listitem">
								Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Project</strong></span> menu and choose the project where your <code class="literal">ServiceMeshControlPlane</code> resource is deployed from the list. For example <code class="literal">istio-system</code>.
							</li><li class="listitem">
								Click the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Istio Service Mesh Member Roll</strong></span> tab.
							</li><li class="listitem">
								Click the <code class="literal">default</code> link.
							</li><li class="listitem">
								Click the YAML tab.
							</li><li class="listitem"><p class="simpara">
								Modify the YAML to add projects as members (or delete them to remove existing members). You can add any number of projects, but a project can only belong to <span class="strong strong"><strong>one</strong></span> <code class="literal">ServiceMeshMemberRoll</code> resource.
							</p><div class="formalpara"><p class="title"><strong>Example servicemeshmemberroll-default.yaml</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshMemberRoll
metadata:
  name: default
  namespace: istio-system #control plane project
spec:
  members:
    # a list of projects joined into the service mesh
    - your-project-name
    - another-project-name</pre>

								</p></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Reload</strong></span>.
							</li></ol></div></section><section class="section" id="ossm-add-project-member-roll-resource-cli_ossm-create-mesh"><div class="titlepage"><div><div><h4 class="title">1.9.3.2. Adding or removing projects from the mesh using ServiceMeshMemberRoll resource with the CLI</h4></div></div></div><p>
						You can add one or more projects to the mesh using the <code class="literal">ServiceMeshMemberRoll</code> resource with the CLI. You can add any number of projects, but a project can only belong to <span class="strong strong"><strong>one</strong></span> mesh.
					</p><p>
						The <code class="literal">ServiceMeshMemberRoll</code> resource is deleted when its corresponding <code class="literal">ServiceMeshControlPlane</code> resource is deleted.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								An installed, verified Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								An existing <code class="literal">ServiceMeshMemberRoll</code> resource.
							</li><li class="listitem">
								The name of the project with the <code class="literal">ServiceMeshMemberRoll</code> resource.
							</li><li class="listitem">
								The names of the projects you want to add or remove from the mesh.
							</li><li class="listitem">
								Access to the OpenShift CLI (<code class="literal">oc</code>).
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform CLI.
							</li><li class="listitem"><p class="simpara">
								Edit the <code class="literal">ServiceMeshMemberRoll</code> resource.
							</p><pre class="programlisting language-terminal">$ oc edit smmr -n &lt;controlplane-namespace&gt;</pre></li><li class="listitem"><p class="simpara">
								Modify the YAML to add or remove projects as members. You can add any number of projects, but a project can only belong to <span class="strong strong"><strong>one</strong></span> <code class="literal">ServiceMeshMemberRoll</code> resource.
							</p><div class="formalpara"><p class="title"><strong>Example servicemeshmemberroll-default.yaml</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshMemberRoll
metadata:
  name: default
  namespace: istio-system #control plane project
spec:
  members:
    # a list of projects joined into the service mesh
    - your-project-name
    - another-project-name</pre>

								</p></div></li><li class="listitem">
								Save the file and exit the editor.
							</li></ol></div></section></section><section class="section" id="ossm-about-adding-projects-using-smm_ossm-create-mesh"><div class="titlepage"><div><div><h3 class="title">1.9.4. About adding projects using the ServiceMeshMember resource</h3></div></div></div><p>
					A <code class="literal">ServiceMeshMember</code> resource provides a way to add a project to a service mesh without modifying the <code class="literal">ServiceMeshMemberRoll</code> resource. To add a project, create a <code class="literal">ServiceMeshMember</code> resource in the project that you want to add to the service mesh. When the Service Mesh Operator processes the <code class="literal">ServiceMeshMember</code> object, the project appears in the <code class="literal">status.members</code> list of the <code class="literal">ServiceMeshMemberRoll</code> resource. Then, the services that reside in the project are made available to the mesh.
				</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/1afa6b490d576140209bb078c2c2b9af/ossm-adding-project-using-smm.png" alt="Adding project using `ServiceMeshMember` resource image"/></div></div><p>
					The mesh administrator must grant each mesh user permission to reference the <code class="literal">ServiceMeshControlPlane</code> resource in the <code class="literal">ServiceMeshMember</code> resource. With this permission in place, a mesh user can add a project to a mesh even when that user does not have direct access rights for the service mesh project or the <code class="literal">ServiceMeshMemberRoll</code> resource. For more information, see Creating the Red Hat OpenShift Service Mesh members.
				</p><section class="section" id="ossm-adding-project-using-smm-resource-console_ossm-create-mesh"><div class="titlepage"><div><div><h4 class="title">1.9.4.1. Adding a project to the mesh using the ServiceMeshMember resource with the web console</h4></div></div></div><p>
						You can add one or more projects to the mesh using the <code class="literal">ServiceMeshMember</code> resource with the OpenShift Container Platform web console.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have installed the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								You know the name of the <code class="literal">ServiceMeshControlPlane</code> resource and the name of the project that the resource belongs to.
							</li><li class="listitem">
								You know the name of the project you want to add to the mesh.
							</li><li class="listitem">
								A service mesh administrator must explicitly grant access to the service mesh. Administrators can grant users permissions to access the mesh by assigning them the <code class="literal">mesh-user</code> <code class="literal">Role</code> using a <code class="literal">RoleBinding</code> or <code class="literal">ClusterRoleBinding</code>. For more information, see <span class="emphasis"><em>Creating the Red Hat OpenShift Service Mesh members</em></span>.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console.
							</li><li class="listitem">
								Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Project</strong></span> menu and choose the project that you want to add to the mesh from the drop-down list. For example, <code class="literal">istio-system</code>.
							</li><li class="listitem">
								Click the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Istio Service Mesh Member</strong></span> tab.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Create ServiceMeshMember</strong></span>
							</li><li class="listitem">
								Accept the default name for the <code class="literal">ServiceMeshMember</code>.
							</li><li class="listitem">
								Click to expand <span class="strong strong"><strong>ControlPlaneRef</strong></span>.
							</li><li class="listitem">
								In the <span class="strong strong"><strong>Namespace</strong></span> field, select the project that the <code class="literal">ServiceMeshControlPlane</code> resource belongs to. For example, <code class="literal">istio-system</code>.
							</li><li class="listitem">
								In the <span class="strong strong"><strong>Name</strong></span> field, enter the name of the <code class="literal">ServiceMeshControlPlane</code> resource that this namespace belongs to. For example, <code class="literal">basic</code>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Create</strong></span>.
							</li><li class="listitem">
								Confirm the <code class="literal">ServiceMeshMember</code> resource was created, and that the project was added to the mesh. Click the resource name; for example, <code class="literal">default</code>. View the <span class="strong strong"><strong>Conditions</strong></span> section shown at the end of the screen. Confirm that the <code class="literal">Status</code> of the <code class="literal">Reconciled</code> and <code class="literal">Ready</code> conditions is <code class="literal">True</code>. If the <code class="literal">Status</code> is <code class="literal">False</code>, see the <code class="literal">Reason</code> and <code class="literal">Message</code> columns for more information.
							</li></ol></div></section><section class="section" id="ossm-adding-project-using-smm-resource-cli_ossm-create-mesh"><div class="titlepage"><div><div><h4 class="title">1.9.4.2. Adding a project to the mesh using the ServiceMeshMember resource with the CLI</h4></div></div></div><p>
						You can add one or more projects to the mesh using the <code class="literal">ServiceMeshMember</code> resource with the CLI.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have installed the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								You know the name of the <code class="literal">ServiceMeshControlPlane</code> resource and the name of the project it belongs to.
							</li><li class="listitem">
								You know the name of the project you want to add to the mesh.
							</li><li class="listitem">
								A service mesh administrator must explicitly grant access to the service mesh. Administrators can grant users permissions to access the mesh by assigning them the <code class="literal">mesh-user</code> <code class="literal">Role</code> using a <code class="literal">RoleBinding</code> or <code class="literal">ClusterRoleBinding</code>. For more information, see <span class="emphasis"><em>Creating the Red Hat OpenShift Service Mesh members</em></span>.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform CLI.
							</li><li class="listitem"><p class="simpara">
								Create the YAML file for the <code class="literal">ServiceMeshMember</code> manifest. The manifest adds the <code class="literal">my-application</code> project to the service mesh that was created by the <code class="literal">ServiceMeshControlPlane</code> resource deployed in the <code class="literal">istio-system</code> namespace:
							</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshMember
metadata:
  name: default
  namespace: my-application
spec:
  controlPlaneRef:
    namespace: istio-system
    name: basic</pre></li><li class="listitem"><p class="simpara">
								Apply the YAML file to create the <code class="literal">ServiceMeshMember</code> resource:
							</p><pre class="programlisting language-terminal">$ oc apply -f &lt;file-name&gt;</pre></li><li class="listitem"><p class="simpara">
								After creating the <code class="literal">ServiceMeshMember</code> resource, verify that the namespace is part of the mesh. Confirm the that the value <code class="literal">True</code> appears in the <code class="literal">READY</code> column when you run the following command:
							</p><pre class="programlisting language-terminal">$ oc get smm default -n my-application</pre><p class="simpara">
								Alternatively, if you can access the <code class="literal">ServiceMeshMemberRoll</code> resource, you can also confirm that the <code class="literal">my-application</code> namespace is displayed in the <code class="literal">status.members</code> and <code class="literal">status.configuredMembers</code> fields of the <code class="literal">ServiceMeshMemberRoll</code> resource.
							</p></li></ol></div></section></section><section class="section" id="ossm-about-adding-projects-using-label-selectors_ossm-create-mesh"><div class="titlepage"><div><div><h3 class="title">1.9.5. About adding projects using label selectors</h3></div></div></div><p>
					For cluster-wide deployments, you can use label selectors to add projects to the mesh. Label selectors specified in the <code class="literal">ServiceMeshMemberRoll</code> resource enable the Service Mesh Operator to add or remove namespaces to or from the mesh based on namespace labels. Unlike other standard OpenShift Container Platform resources that you can use to specify a single label selector, you can use the <code class="literal">ServiceMeshMemberRoll</code> resource to specify multiple label selectors.
				</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/a1b754791ccb959357dc771433bf146c/ossm-adding-project-using-label-selector.png" alt="Adding project using label selector image"/></div></div><p>
					If the labels for a namespace match any of the selectors specified in the <code class="literal">ServiceMeshMemberRoll</code> resource, then the namespace is included in the mesh.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						In OpenShift Container Platform, a project is essentially a Kubernetes namespace with additional annotations, such as the range of user IDs that can be used in the project. Typically, the OpenShift Container Platform web console uses the term <span class="emphasis"><em>project</em></span>, and the CLI uses the term <span class="emphasis"><em>namespace</em></span>, but the terms are essentially synonymous.
					</p></div></div><section class="section" id="ossm-adding-project-using-label-selectors-console_ossm-create-mesh"><div class="titlepage"><div><div><h4 class="title">1.9.5.1. Adding a project to the mesh using label selectors with the web console</h4></div></div></div><p>
						You can use labels selectors to add a project to the Service Mesh with the OpenShift Container Platform web console.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have installed the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								The deployment has an existing <code class="literal">ServiceMeshMemberRoll</code> resource.
							</li><li class="listitem">
								You are logged in as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you are logged in as a user with the <code class="literal">dedicated-admin</code> role.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console.
							</li><li class="listitem">
								Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Project</strong></span> menu, and from the drop-down list, select the project where your <code class="literal">ServiceMeshMemberRoll</code> resource is deployed. For example, <span class="strong strong"><strong>istio-system</strong></span>.
							</li><li class="listitem">
								Click the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Istio Service Mesh Member Roll</strong></span> tab.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Create ServiceMeshMember Roll</strong></span>.
							</li><li class="listitem">
								Accept the default name for the <code class="literal">ServiceMeshMemberRoll</code>.
							</li><li class="listitem"><p class="simpara">
								In the <span class="strong strong"><strong>Labels</strong></span> field, enter key-value pairs to define the labels that identify which namespaces to include in the service mesh. If a project namespace has either label specified by the selectors, then the project namespace is included in the service mesh. You do not need to include both labels.
							</p><p class="simpara">
								For example, entering <code class="literal">mykey=myvalue</code> includes all namespaces with this label as part of the mesh. When the selector identifies a match, the project namespace is added to the service mesh.
							</p><p class="simpara">
								Entering <code class="literal">myotherkey=myothervalue</code> includes all namespaces with this label as part of the mesh. When the selector identifies a match, the project namespace is added to the service mesh.
							</p></li><li class="listitem">
								Click <span class="strong strong"><strong>Create</strong></span>.
							</li></ol></div></section><section class="section" id="ossm-adding-project-using-label-selectors-cli_ossm-create-mesh"><div class="titlepage"><div><div><h4 class="title">1.9.5.2. Adding a project to the mesh using label selectors with the CLI</h4></div></div></div><p>
						You can use label selectors to add a project to the Service Mesh with the CLI.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have installed the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								The deployment has an existing <code class="literal">ServiceMeshMemberRoll</code> resource.
							</li><li class="listitem">
								You are logged in as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you are logged in as a user with the <code class="literal">dedicated-admin</code> role.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform CLI.
							</li><li class="listitem"><p class="simpara">
								Edit the <code class="literal">ServiceMeshMemberRoll</code> resource.
							</p><pre class="programlisting language-terminal">$ oc edit smmr -n &lt;controlplane_project&gt;</pre><p class="simpara">
								The previous example uses <code class="literal">&lt;controlplane_project&gt;</code> as an example. You can deploy the Service Mesh control plane to any project as long as it is separate from the project that contains your services.
							</p></li><li class="listitem"><p class="simpara">
								Modify the YAML file to include namespace label selectors in the <code class="literal">spec.memberSelectors</code> field of the <code class="literal">ServiceMeshMemberRoll</code> resource.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Instead of using the <code class="literal">matchLabels</code> field, you can also use the <code class="literal">matchExpressions</code> field in the selector.
								</p></div></div><pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshMemberRoll
metadata:
  name: default
  namespace: istio-system
spec:
  memberSelectors: <span id="CO13-1"><!--Empty--></span><span class="callout">1</span>
  - matchLabels: <span id="CO13-2"><!--Empty--></span><span class="callout">2</span>
      mykey: myvalue <span id="CO13-3"><!--Empty--></span><span class="callout">3</span>
  - matchLabels: <span id="CO13-4"><!--Empty--></span><span class="callout">4</span>
      myotherkey: myothervalue <span id="CO13-5"><!--Empty--></span><span class="callout">5</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO13-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Contains the label selectors used to identify which project namespaces are included in the service mesh. If a project namespace has either label specified by the selectors, then the project namespace is included in the service mesh. The project namespace does not need both labels to be included.
									</div></dd><dt><a href="#CO13-2"><span class="callout">2</span></a> <a href="#CO13-3"><span class="callout">3</span></a> </dt><dd><div class="para">
										Specifies all namespaces with the <code class="literal">mykey=myvalue</code> label. When the selector identifies a match, the project namespace is added to the service mesh.
									</div></dd><dt><a href="#CO13-4"><span class="callout">4</span></a> <a href="#CO13-5"><span class="callout">5</span></a> </dt><dd><div class="para">
										Specifies all namespaces with the <code class="literal">myotherkey=myothervalue</code> label. When the selector identifies a match, the project namespace is added to the service mesh.
									</div></dd></dl></div></li></ol></div></section></section><section class="section" id="ossm-tutorial-bookinfo-overview_ossm-create-mesh"><div class="titlepage"><div><div><h3 class="title">1.9.6. Bookinfo example application</h3></div></div></div><p>
					The Bookinfo example application allows you to test your Red Hat OpenShift Service Mesh 2.4.3 installation on OpenShift Container Platform.
				</p><p>
					The Bookinfo application displays information about a book, similar to a single catalog entry of an online book store. The application displays a page that describes the book, book details (ISBN, number of pages, and other information), and book reviews.
				</p><p>
					The Bookinfo application consists of these microservices:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">productpage</code> microservice calls the <code class="literal">details</code> and <code class="literal">reviews</code> microservices to populate the page.
						</li><li class="listitem">
							The <code class="literal">details</code> microservice contains book information.
						</li><li class="listitem">
							The <code class="literal">reviews</code> microservice contains book reviews. It also calls the <code class="literal">ratings</code> microservice.
						</li><li class="listitem">
							The <code class="literal">ratings</code> microservice contains book ranking information that accompanies a book review.
						</li></ul></div><p>
					There are three versions of the reviews microservice:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Version v1 does not call the <code class="literal">ratings</code> Service.
						</li><li class="listitem">
							Version v2 calls the <code class="literal">ratings</code> Service and displays each rating as one to five black stars.
						</li><li class="listitem">
							Version v3 calls the <code class="literal">ratings</code> Service and displays each rating as one to five red stars.
						</li></ul></div><section class="section" id="ossm-tutorial-bookinfo-install_ossm-create-mesh"><div class="titlepage"><div><div><h4 class="title">1.9.6.1. Installing the Bookinfo application</h4></div></div></div><p>
						This tutorial walks you through how to create a sample application by creating a project, deploying the Bookinfo application to that project, and viewing the running application in Service Mesh.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites:</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								OpenShift Container Platform 4.1 or higher installed.
							</li><li class="listitem">
								Red Hat OpenShift Service Mesh 2.4.3 installed.
							</li><li class="listitem">
								Access to the OpenShift CLI (<code class="literal">oc</code>).
							</li><li class="listitem">
								An account with the <code class="literal">cluster-admin</code> role.
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The Bookinfo sample application cannot be installed on IBM Z and IBM Power.
						</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The commands in this section assume the Service Mesh control plane project is <code class="literal">istio-system</code>. If you installed the control plane in another namespace, edit each command before you run it.
						</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console as a user with cluster-admin rights. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Home</strong></span> → <span class="strong strong"><strong>Projects</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Create Project</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Enter <code class="literal">bookinfo</code> as the <span class="strong strong"><strong>Project Name</strong></span>, enter a <span class="strong strong"><strong>Display Name</strong></span>, and enter a <span class="strong strong"><strong>Description</strong></span>, then click <span class="strong strong"><strong>Create</strong></span>.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Alternatively, you can run this command from the CLI to create the <code class="literal">bookinfo</code> project.
									</p><pre class="programlisting language-terminal">$ oc new-project bookinfo</pre></li></ul></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Project</strong></span> menu and use the Service Mesh control plane namespace. In this example, use <code class="literal">istio-system</code>.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Red Hat OpenShift Service Mesh</strong></span> Operator.
							</li><li class="listitem"><p class="simpara">
								Click the <span class="strong strong"><strong>Istio Service Mesh Member Roll</strong></span> tab.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										If you have already created a Istio Service Mesh Member Roll, click the name, then click the YAML tab to open the YAML editor.
									</li><li class="listitem">
										If you have not created a <code class="literal">ServiceMeshMemberRoll</code>, click <span class="strong strong"><strong>Create ServiceMeshMemberRoll</strong></span>.
									</li></ol></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Members</strong></span>, then enter the name of your project in the <span class="strong strong"><strong>Value</strong></span> field.
							</li><li class="listitem"><p class="simpara">
								Click <span class="strong strong"><strong>Create</strong></span> to save the updated Service Mesh Member Roll.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Or, save the following example to a YAML file.
									</p><div class="formalpara"><p class="title"><strong>Bookinfo ServiceMeshMemberRoll example servicemeshmemberroll-default.yaml</strong></p><p>
											
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshMemberRoll
metadata:
  name: default
spec:
  members:
  - bookinfo</pre>

										</p></div></li><li class="listitem"><p class="simpara">
										Run the following command to upload that file and create the <code class="literal">ServiceMeshMemberRoll</code> resource in the <code class="literal">istio-system</code> namespace. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
									</p><pre class="programlisting language-terminal">$ oc create -n istio-system -f servicemeshmemberroll-default.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								Run the following command to verify the <code class="literal">ServiceMeshMemberRoll</code> was created successfully.
							</p><pre class="programlisting language-terminal">$ oc get smmr -n istio-system -o wide</pre><p class="simpara">
								The installation has finished successfully when the <code class="literal">STATUS</code> column is <code class="literal">Configured</code>.
							</p><pre class="programlisting language-terminal">NAME      READY   STATUS       AGE   MEMBERS
default   1/1     Configured   70s   ["bookinfo"]</pre></li><li class="listitem"><p class="simpara">
								From the CLI, deploy the Bookinfo application in the <span class="emphasis"><em>`bookinfo`</em></span> project by applying the <code class="literal">bookinfo.yaml</code> file:
							</p><pre class="programlisting language-bash">$ oc apply -n bookinfo -f https://raw.githubusercontent.com/Maistra/istio/maistra-2.4/samples/bookinfo/platform/kube/bookinfo.yaml</pre><p class="simpara">
								You should see output similar to the following:
							</p><pre class="programlisting language-terminal">service/details created
serviceaccount/bookinfo-details created
deployment.apps/details-v1 created
service/ratings created
serviceaccount/bookinfo-ratings created
deployment.apps/ratings-v1 created
service/reviews created
serviceaccount/bookinfo-reviews created
deployment.apps/reviews-v1 created
deployment.apps/reviews-v2 created
deployment.apps/reviews-v3 created
service/productpage created
serviceaccount/bookinfo-productpage created
deployment.apps/productpage-v1 created</pre></li><li class="listitem"><p class="simpara">
								Create the ingress gateway by applying the <code class="literal">bookinfo-gateway.yaml</code> file:
							</p><pre class="programlisting language-bash">$ oc apply -n bookinfo -f https://raw.githubusercontent.com/Maistra/istio/maistra-2.4/samples/bookinfo/networking/bookinfo-gateway.yaml</pre><p class="simpara">
								You should see output similar to the following:
							</p><pre class="programlisting language-terminal">gateway.networking.istio.io/bookinfo-gateway created
virtualservice.networking.istio.io/bookinfo created</pre></li><li class="listitem"><p class="simpara">
								Set the value for the <code class="literal">GATEWAY_URL</code> parameter:
							</p><pre class="programlisting language-terminal">$ export GATEWAY_URL=$(oc -n istio-system get route istio-ingressgateway -o jsonpath='{.spec.host}')</pre></li></ol></div></section><section class="section" id="ossm-tutorial-bookinfo-adding-destination-rules_ossm-create-mesh"><div class="titlepage"><div><div><h4 class="title">1.9.6.2. Adding default destination rules</h4></div></div></div><p>
						Before you can use the Bookinfo application, you must first add default destination rules. There are two preconfigured YAML files, depending on whether or not you enabled mutual transport layer security (TLS) authentication.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To add destination rules, run one of the following commands:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										If you did not enable mutual TLS:
									</p><pre class="programlisting language-bash">$ oc apply -n bookinfo -f https://raw.githubusercontent.com/Maistra/istio/maistra-2.4/samples/bookinfo/networking/destination-rule-all.yaml</pre></li><li class="listitem"><p class="simpara">
										If you enabled mutual TLS:
									</p><pre class="programlisting language-bash">$ oc apply -n bookinfo -f https://raw.githubusercontent.com/Maistra/istio/maistra-2.4/samples/bookinfo/networking/destination-rule-all-mtls.yaml</pre><p class="simpara">
										You should see output similar to the following:
									</p><pre class="programlisting language-terminal">destinationrule.networking.istio.io/productpage created
destinationrule.networking.istio.io/reviews created
destinationrule.networking.istio.io/ratings created
destinationrule.networking.istio.io/details created</pre></li></ul></div></li></ol></div></section><section class="section" id="ossm-tutorial-bookinfo-verify-install_ossm-create-mesh"><div class="titlepage"><div><div><h4 class="title">1.9.6.3. Verifying the Bookinfo installation</h4></div></div></div><p>
						To confirm that the sample Bookinfo application was successfully deployed, perform the following steps.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Red Hat OpenShift Service Mesh installed.
							</li><li class="listitem">
								Complete the steps for installing the Bookinfo sample app.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure from CLI</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform CLI.
							</li><li class="listitem"><p class="simpara">
								Verify that all pods are ready with this command:
							</p><pre class="programlisting language-terminal">$ oc get pods -n bookinfo</pre><p class="simpara">
								All pods should have a status of <code class="literal">Running</code>. You should see output similar to the following:
							</p><pre class="programlisting language-terminal">NAME                              READY   STATUS    RESTARTS   AGE
details-v1-55b869668-jh7hb        2/2     Running   0          12m
productpage-v1-6fc77ff794-nsl8r   2/2     Running   0          12m
ratings-v1-7d7d8d8b56-55scn       2/2     Running   0          12m
reviews-v1-868597db96-bdxgq       2/2     Running   0          12m
reviews-v2-5b64f47978-cvssp       2/2     Running   0          12m
reviews-v3-6dfd49b55b-vcwpf       2/2     Running   0          12m</pre></li><li class="listitem"><p class="simpara">
								Run the following command to retrieve the URL for the product page:
							</p><pre class="programlisting language-terminal">echo "http://$GATEWAY_URL/productpage"</pre></li><li class="listitem">
								Copy and paste the output in a web browser to verify the Bookinfo product page is deployed.
							</li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure from Kiali web console</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Obtain the address for the Kiali web console.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Log in to the OpenShift Container Platform web console as a user with <code class="literal">cluster-admin</code> rights. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
									</li><li class="listitem">
										Navigate to <span class="strong strong"><strong>Networking</strong></span> → <span class="strong strong"><strong>Routes</strong></span>.
									</li><li class="listitem"><p class="simpara">
										On the <span class="strong strong"><strong>Routes</strong></span> page, select the Service Mesh control plane project, for example <code class="literal">istio-system</code>, from the <span class="strong strong"><strong>Namespace</strong></span> menu.
									</p><p class="simpara">
										The <span class="strong strong"><strong>Location</strong></span> column displays the linked address for each route.
									</p></li><li class="listitem">
										Click the link in the <span class="strong strong"><strong>Location</strong></span> column for Kiali.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Log In With OpenShift</strong></span>. The Kiali <span class="strong strong"><strong>Overview</strong></span> screen presents tiles for each project namespace.
									</li></ol></div></li><li class="listitem">
								In Kiali, click <span class="strong strong"><strong>Graph</strong></span>.
							</li><li class="listitem">
								Select bookinfo from the <span class="strong strong"><strong>Namespace</strong></span> list, and App graph from the <span class="strong strong"><strong>Graph Type</strong></span> list.
							</li><li class="listitem"><p class="simpara">
								Click <span class="strong strong"><strong>Display idle nodes</strong></span> from the <span class="strong strong"><strong>Display</strong></span> menu.
							</p><p class="simpara">
								This displays nodes that are defined but have not received or sent requests. It can confirm that an application is properly defined, but that no request traffic has been reported.
							</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/3b5cf079c8338b3554382168075fffb3/ossm-kiali-graph-bookinfo.png" alt="Kiali displaying bookinfo application"/></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Use the <span class="strong strong"><strong>Duration</strong></span> menu to increase the time period to help ensure older traffic is captured.
									</li><li class="listitem">
										Use the <span class="strong strong"><strong>Refresh Rate</strong></span> menu to refresh traffic more or less often, or not at all.
									</li></ul></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Services</strong></span>, <span class="strong strong"><strong>Workloads</strong></span> or <span class="strong strong"><strong>Istio Config</strong></span> to see list views of bookinfo components, and confirm that they are healthy.
							</li></ol></div></section><section class="section" id="ossm-tutorial-bookinfo-removing_ossm-create-mesh"><div class="titlepage"><div><div><h4 class="title">1.9.6.4. Removing the Bookinfo application</h4></div></div></div><p>
						Follow these steps to remove the Bookinfo application.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								OpenShift Container Platform 4.1 or higher installed.
							</li><li class="listitem">
								Red Hat OpenShift Service Mesh 2.4.3 installed.
							</li><li class="listitem">
								Access to the OpenShift CLI (<code class="literal">oc</code>).
							</li></ul></div><section class="section" id="ossm-delete-bookinfo-project_ossm-create-mesh"><div class="titlepage"><div><div><h5 class="title">1.9.6.4.1. Delete the Bookinfo project</h5></div></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									Log in to the OpenShift Container Platform web console.
								</li><li class="listitem">
									Click to <span class="strong strong"><strong>Home</strong></span> → <span class="strong strong"><strong>Projects</strong></span>.
								</li><li class="listitem">
									Click the <code class="literal">bookinfo</code> menu 
									<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
									 , and then click <span class="strong strong"><strong>Delete Project</strong></span>.
								</li><li class="listitem"><p class="simpara">
									Type <code class="literal">bookinfo</code> in the confirmation dialog box, and then click <span class="strong strong"><strong>Delete</strong></span>.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
											Alternatively, you can run this command using the CLI to create the <code class="literal">bookinfo</code> project.
										</p><pre class="programlisting language-terminal">$ oc delete project bookinfo</pre></li></ul></div></li></ol></div></section><section class="section" id="ossm-remove-bookinfo-smmr_ossm-create-mesh"><div class="titlepage"><div><div><h5 class="title">1.9.6.4.2. Remove the Bookinfo project from the Service Mesh member roll</h5></div></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									Log in to the OpenShift Container Platform web console.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
								</li><li class="listitem">
									Click the <span class="strong strong"><strong>Project</strong></span> menu and choose <code class="literal">istio-system</code> from the list.
								</li><li class="listitem">
									Click the <span class="strong strong"><strong>Istio Service Mesh Member Roll</strong></span> link under <span class="strong strong"><strong>Provided APIS</strong></span> for the <span class="strong strong"><strong>Red Hat OpenShift Service Mesh</strong></span> Operator.
								</li><li class="listitem">
									Click the <code class="literal">ServiceMeshMemberRoll</code> menu 
									<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
									 and select <span class="strong strong"><strong>Edit Service Mesh Member Roll</strong></span>.
								</li><li class="listitem"><p class="simpara">
									Edit the default Service Mesh Member Roll YAML and remove <code class="literal">bookinfo</code> from the <span class="strong strong"><strong>members</strong></span> list.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
											Alternatively, you can run this command using the CLI to remove the <code class="literal">bookinfo</code> project from the <code class="literal">ServiceMeshMemberRoll</code>. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
										</p><pre class="programlisting language-terminal">$ oc -n istio-system patch --type='json' smmr default -p '[{"op": "remove", "path": "/spec/members", "value":["'"bookinfo"'"]}]'</pre></li></ul></div></li><li class="listitem">
									Click <span class="strong strong"><strong>Save</strong></span> to update Service Mesh Member Roll.
								</li></ol></div></section></section></section><section class="section" id="next-steps-5"><div class="titlepage"><div><div><h3 class="title">1.9.7. Next steps</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							To continue the installation process, you must <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#deploying-applications-ossm">enable sidecar injection</a>.
						</li></ul></div></section></section><section class="section" id="deploying-applications-ossm"><div class="titlepage"><div><div><h2 class="title">1.10. Enabling sidecar injection</h2></div></div></div><p>
				After adding the namespaces that contain your services to your mesh, the next step is to enable automatic sidecar injection in the Deployment resource for your application. You must enable automatic sidecar injection for each deployment.
			</p><p>
				If you have installed the Bookinfo sample application, the application was deployed and the sidecars were injected as part of the installation procedure. If you are using your own project and service, deploy your applications on OpenShift Container Platform.
			</p><p>
				For more information, see the OpenShift Container Platform documentation, <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/building_applications/#understanding-deployments-and-deploymentconfigs">Understanding Deployment and DeploymentConfig objects</a>.
			</p><section class="section" id="prerequisites-2"><div class="titlepage"><div><div><h3 class="title">1.10.1. Prerequisites</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-tutorial-bookinfo-overview_ossm-create-mesh">Services deployed to the mesh</a>, for example the Bookinfo sample application.
						</li><li class="listitem">
							A Deployment resource file.
						</li></ul></div></section><section class="section" id="ossm-automatic-sidecar-injection_deploying-applications-ossm"><div class="titlepage"><div><div><h3 class="title">1.10.2. Enabling automatic sidecar injection</h3></div></div></div><p>
					When deploying an application, you must opt-in to injection by configuring the annotation <code class="literal">sidecar.istio.io/inject</code> in <code class="literal">spec.template.metadata.annotations</code> to <code class="literal">true</code> in the <code class="literal">deployment</code> object. Opting in ensures that the sidecar injection does not interfere with other OpenShift Container Platform features such as builder pods used by numerous frameworks within the OpenShift Container Platform ecosystem.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Identify the namespaces that are part of your service mesh and the deployments that need automatic sidecar injection.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To find your deployments use the <code class="literal">oc get</code> command.
						</p><pre class="programlisting language-terminal">$ oc get deployment -n &lt;namespace&gt;</pre><p class="simpara">
							For example, to view the deployment file for the 'ratings-v1' microservice in the <code class="literal">bookinfo</code> namespace, use the following command to see the resource in YAML format.
						</p><pre class="programlisting language-terminal">oc get deployment -n bookinfo ratings-v1 -o yaml</pre></li><li class="listitem">
							Open the application’s deployment configuration YAML file in an editor.
						</li><li class="listitem"><p class="simpara">
							Add <code class="literal">spec.template.metadata.annotations.sidecar.istio/inject</code> to your Deployment YAML and set <code class="literal">sidecar.istio.io/inject</code> to <code class="literal">true</code> as shown in the following example.
						</p><div class="formalpara"><p class="title"><strong>Example snippet from bookinfo deployment-ratings-v1.yaml</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: ratings-v1
  namespace: bookinfo
  labels:
    app: ratings
    version: v1
spec:
  template:
    metadata:
      annotations:
        sidecar.istio.io/inject: 'true'</pre>

							</p></div></li><li class="listitem">
							Save the Deployment configuration file.
						</li><li class="listitem"><p class="simpara">
							Add the file back to the project that contains your app.
						</p><pre class="programlisting language-terminal">$ oc apply -n &lt;namespace&gt; -f deployment.yaml</pre><p class="simpara">
							In this example, <code class="literal">bookinfo</code> is the name of the project that contains the <code class="literal">ratings-v1</code> app and <code class="literal">deployment-ratings-v1.yaml</code> is the file you edited.
						</p><pre class="programlisting language-terminal">$ oc apply -n bookinfo -f deployment-ratings-v1.yaml</pre></li><li class="listitem"><p class="simpara">
							To verify that the resource uploaded successfully, run the following command.
						</p><pre class="programlisting language-terminal">$ oc get deployment -n &lt;namespace&gt; &lt;deploymentName&gt; -o yaml</pre><p class="simpara">
							For example,
						</p><pre class="programlisting language-terminal">$ oc get deployment -n bookinfo ratings-v1 -o yaml</pre></li></ol></div></section><section class="section" id="ossm-validating-sidecar_deploying-applications-ossm"><div class="titlepage"><div><div><h3 class="title">1.10.3. Validating sidecar injection</h3></div></div></div><p>
					The Kiali console offers several ways to validate whether or not your applications, services, and workloads have a sidecar proxy.
				</p><div class="figure" id="idm140663660037904"><p class="title"><strong>Figure 1.3. Missing sidecar badge</strong></p><div class="figure-contents"><div class="mediaobject"><object type="image/svg+xml" class="svg-img" data="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/0f8f59d4060df5382adfbd2ca5f42400/ossm-node-badge-missing-sidecar.svg"><embed type="image/svg+xml" src="images/ossm-node-badge-missing-sidecar.svg"><!--Empty--></embed></object></div></div></div><p>
					The <span class="strong strong"><strong>Graph</strong></span> page displays a node badge indicating a <span class="strong strong"><strong>Missing Sidecar</strong></span> on the following graphs:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							App graph
						</li><li class="listitem">
							Versioned app graph
						</li><li class="listitem">
							Workload graph
						</li></ul></div><div class="figure" id="idm140663672843232"><p class="title"><strong>Figure 1.4. Missing sidecar icon</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/64f85f0a93c61068d57eee222be0e395/ossm-icon-missing-sidecar.png" alt="Missing Sidecar icon"/></div></div></div><p>
					The <span class="strong strong"><strong>Applications</strong></span> page displays a <span class="strong strong"><strong>Missing Sidecar</strong></span> icon in the <span class="strong strong"><strong>Details</strong></span> column for any applications in a namespace that do not have a sidecar.
				</p><p>
					The <span class="strong strong"><strong>Workloads</strong></span> page displays a <span class="strong strong"><strong>Missing Sidecar</strong></span> icon in the <span class="strong strong"><strong>Details</strong></span> column for any applications in a namespace that do not have a sidecar.
				</p><p>
					The <span class="strong strong"><strong>Services</strong></span> page displays a <span class="strong strong"><strong>Missing Sidecar</strong></span> icon in the <span class="strong strong"><strong>Details</strong></span> column for any applications in a namespace that do not have a sidecar. When there are multiple versions of a service, you use the <span class="strong strong"><strong>Service Details</strong></span> page to view <span class="strong strong"><strong>Missing Sidecar</strong></span> icons.
				</p><p>
					The <span class="strong strong"><strong>Workload Details</strong></span> page has a special unified <span class="strong strong"><strong>Logs</strong></span> tab that lets you view and correlate application and proxy logs. You can view the Envoy logs as another way to validate sidecar injection for your application workloads.
				</p><p>
					The <span class="strong strong"><strong>Workload Details</strong></span> page also has an <span class="strong strong"><strong>Envoy</strong></span> tab for any workload that is an Envoy proxy or has been injected with an Envoy proxy. This tab displays a built-in Envoy dashboard that includes subtabs for <span class="strong strong"><strong>Clusters</strong></span>, <span class="strong strong"><strong>Listeners</strong></span>, <span class="strong strong"><strong>Routes</strong></span>, <span class="strong strong"><strong>Bootstrap</strong></span>, <span class="strong strong"><strong>Config</strong></span>, and <span class="strong strong"><strong>Metrics</strong></span>.
				</p><p>
					For information about enabling Envoy access logs, see the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#enabling-envoy-access-logs">Troubleshooting</a> section.
				</p><p>
					For information about viewing Envoy logs, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-viewing-logs_observability">Viewing logs in the Kiali console</a>
				</p></section><section class="section" id="ossm-sidecar-injection-env-var_deploying-applications-ossm"><div class="titlepage"><div><div><h3 class="title">1.10.4. Setting proxy environment variables through annotations</h3></div></div></div><p>
					Configuration for the Envoy sidecar proxies is managed by the <code class="literal">ServiceMeshControlPlane</code>.
				</p><p>
					You can set environment variables for the sidecar proxy for applications by adding pod annotations to the deployment in the <code class="literal">injection-template.yaml</code> file. The environment variables are injected to the sidecar.
				</p><div class="formalpara"><p class="title"><strong>Example injection-template.yaml</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: resource
spec:
  replicas: 7
  selector:
    matchLabels:
      app: resource
  template:
    metadata:
      annotations:
        sidecar.maistra.io/proxyEnv: "{ \"maistra_test_env\": \"env_value\", \"maistra_test_env_2\": \"env_value_2\" }"</pre>

					</p></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						You should never include <code class="literal">maistra.io/</code> labels and annotations when creating your own custom resources. These labels and annotations indicate that the resources are generated and managed by the Operator. If you are copying content from an Operator-generated resource when creating your own resources, do not include labels or annotations that start with <code class="literal">maistra.io/</code>. Resources that include these labels or annotations will be overwritten or deleted by the Operator during the next reconciliation.
					</p></div></div></section><section class="section" id="ossm-update-app-sidecar_deploying-applications-ossm"><div class="titlepage"><div><div><h3 class="title">1.10.5. Updating sidecar proxies</h3></div></div></div><p>
					In order to update the configuration for sidecar proxies the application administrator must restart the application pods.
				</p><p>
					If your deployment uses automatic sidecar injection, you can update the pod template in the deployment by adding or modifying an annotation. Run the following command to redeploy the pods:
				</p><pre class="programlisting language-terminal">$ oc patch deployment/&lt;deployment&gt; -p '{"spec":{"template":{"metadata":{"annotations":{"kubectl.kubernetes.io/restartedAt": "'`date -Iseconds`'"}}}}}'</pre><p>
					If your deployment does not use automatic sidecar injection, you must manually update the sidecars by modifying the sidecar container image specified in the deployment or pod, and then restart the pods.
				</p></section><section class="section" id="next-steps-6"><div class="titlepage"><div><div><h3 class="title">1.10.6. Next steps</h3></div></div></div><p>
					Configure Red Hat OpenShift Service Mesh features for your environment.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-security">Security</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-routing-traffic">Traffic management</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-observability">Metrics, logs, and traces</a>
						</li></ul></div></section></section><section class="section" id="upgrading-ossm"><div class="titlepage"><div><div><h2 class="title">1.11. Upgrading Service Mesh</h2></div></div></div><p>
				To access the most current features of Red Hat OpenShift Service Mesh, upgrade to the current version, 2.4.3.
			</p><section class="section" id="ossm-versioning_ossm-upgrade"><div class="titlepage"><div><div><h3 class="title">1.11.1. Understanding versioning</h3></div></div></div><p>
					Red Hat uses semantic versioning for product releases. Semantic Versioning is a 3-component number in the format of X.Y.Z, where:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							X stands for a Major version. Major releases usually denote some sort of breaking change: architectural changes, API changes, schema changes, and similar major updates.
						</li><li class="listitem">
							Y stands for a Minor version. Minor releases contain new features and functionality while maintaining backwards compatibility.
						</li><li class="listitem">
							Z stands for a Patch version (also known as a z-stream release). Patch releases are used to addresses Common Vulnerabilities and Exposures (CVEs) and release bug fixes. New features and functionality are generally not released as part of a Patch release.
						</li></ul></div><section class="section" id="how-versioning-affects-service-mesh-upgrades"><div class="titlepage"><div><div><h4 class="title">1.11.1.1. How versioning affects Service Mesh upgrades</h4></div></div></div><p>
						Depending on the version of the update you are making, the upgrade process is different.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Patch updates</strong></span> - Patch upgrades are managed by the Operator Lifecycle Manager (OLM); they happen automatically when you update your Operators.
							</li><li class="listitem">
								<span class="strong strong"><strong>Minor upgrades</strong></span> - Minor upgrades require both updating to the most recent Red Hat OpenShift Service Mesh Operator version and manually modifying the <code class="literal">spec.version</code> value in your <code class="literal">ServiceMeshControlPlane</code> resources.
							</li><li class="listitem">
								<span class="strong strong"><strong>Major upgrades</strong></span> - Major upgrades require both updating to the most recent Red Hat OpenShift Service Mesh Operator version and manually modifying the <code class="literal">spec.version</code> value in your <code class="literal">ServiceMeshControlPlane</code> resources. Because major upgrades can contain changes that are not backwards compatible, additional manual changes might be required.
							</li></ul></div></section><section class="section" id="ossm-versions_ossm-upgrade"><div class="titlepage"><div><div><h4 class="title">1.11.1.2. Understanding Service Mesh versions</h4></div></div></div><p>
						In order to understand what version of Red Hat OpenShift Service Mesh you have deployed on your system, you need to understand how each of the component versions is managed.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Operator</strong></span> version - The most current Operator version is 2.4.3. The Operator version number only indicates the version of the currently installed Operator. Because the Red Hat OpenShift Service Mesh Operator supports multiple versions of the Service Mesh control plane, the version of the Operator does not determine the version of your deployed <code class="literal">ServiceMeshControlPlane</code> resources.
							</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									Upgrading to the latest Operator version automatically applies patch updates, but does not automatically upgrade your Service Mesh control plane to the latest minor version.
								</p></div></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>ServiceMeshControlPlane</strong></span> version - The <code class="literal">ServiceMeshControlPlane</code> version determines what version of Red Hat OpenShift Service Mesh you are using. The value of the <code class="literal">spec.version</code> field in the <code class="literal">ServiceMeshControlPlane</code> resource controls the architecture and configuration settings that are used to install and deploy Red Hat OpenShift Service Mesh. When you create the Service Mesh control plane you can set the version in one of two ways:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										To configure in the Form View, select the version from the <span class="strong strong"><strong>Control Plane Version</strong></span> menu.
									</li><li class="listitem">
										To configure in the YAML View, set the value for <code class="literal">spec.version</code> in the YAML file.
									</li></ul></div></li></ul></div><p>
						Operator Lifecycle Manager (OLM) does not manage Service Mesh control plane upgrades, so the version number for your Operator and <code class="literal">ServiceMeshControlPlane</code> (SMCP) may not match, unless you have manually upgraded your SMCP.
					</p></section></section><section class="section" id="ossm-upgrade-considerations_ossm-upgrade"><div class="titlepage"><div><div><h3 class="title">1.11.2. Upgrade considerations</h3></div></div></div><p>
					The <code class="literal">maistra.io/</code> label or annotation should not be used on a user-created custom resource, because it indicates that the resource was generated by and should be managed by the Red Hat OpenShift Service Mesh Operator.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						During the upgrade, the Operator makes changes, including deleting or replacing files, to resources that include the following labels or annotations that indicate that the resource is managed by the Operator.
					</p></div></div><p>
					Before upgrading check for user-created custom resources that include the following labels or annotations:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">maistra.io/</code> AND the <code class="literal">app.kubernetes.io/managed-by</code> label set to <code class="literal">maistra-istio-operator</code> (Red Hat OpenShift Service Mesh)
						</li><li class="listitem">
							<code class="literal">kiali.io/</code> (Kiali)
						</li><li class="listitem">
							<code class="literal">jaegertracing.io/</code> (Red Hat OpenShift distributed tracing platform (Jaeger))
						</li><li class="listitem">
							<code class="literal">logging.openshift.io/</code> (Red Hat Elasticsearch)
						</li></ul></div><p>
					Before upgrading, check your user-created custom resources for labels or annotations that indicate they are Operator managed. Remove the label or annotation from custom resources that you do not want to be managed by the Operator.
				</p><p>
					When upgrading to version 2.0, the Operator only deletes resources with these labels in the same namespace as the SMCP.
				</p><p>
					When upgrading to version 2.1, the Operator deletes resources with these labels in all namespaces.
				</p><section class="section" id="ossm-upgrade-known-issues_ossm-upgrade"><div class="titlepage"><div><div><h4 class="title">1.11.2.1. Known issues that may affect upgrade</h4></div></div></div><p>
						Known issues that may affect your upgrade include:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								When upgrading an Operator, custom configurations for Jaeger or Kiali might be reverted. Before upgrading an Operator, note any custom configuration settings for the Jaeger or Kiali objects in the Service Mesh production deployment so that you can recreate them.
							</li><li class="listitem">
								Red Hat OpenShift Service Mesh does not support the use of <code class="literal">EnvoyFilter</code> configuration except where explicitly documented. This is due to tight coupling with the underlying Envoy APIs, meaning that backward compatibility cannot be maintained. If you are using Envoy Filters, and the configuration generated by Istio has changed due to the lastest version of Envoy introduced by upgrading your <code class="literal">ServiceMeshControlPlane</code>, that has the potential to break any <code class="literal">EnvoyFilter</code> you may have implemented.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-1505">OSSM-1505</a> <code class="literal">ServiceMeshExtension</code> does not work with OpenShift Container Platform version 4.11. Because <code class="literal">ServiceMeshExtension</code> has been deprecated in Red Hat OpenShift Service Mesh 2.2, this known issue will not be fixed and you must migrate your extensions to <code class="literal">WasmPluging</code>
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-1396">OSSM-1396</a> If a gateway resource contains the <code class="literal">spec.externalIPs</code> setting, rather than being recreated when the <code class="literal">ServiceMeshControlPlane</code> is updated, the gateway is removed and never recreated.
							</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-1052">OSSM-1052</a> When configuring a Service <code class="literal">ExternalIP</code> for the ingressgateway in the Service Mesh control plane, the service is not created. The schema for the SMCP is missing the parameter for the service.
							</p><p class="simpara">
								Workaround: Disable the gateway creation in the SMCP spec and manage the gateway deployment entirely manually (including Service, Role and RoleBinding).
							</p></li></ul></div></section></section><section class="section" id="ossm-upgrading-operator_ossm-upgrade"><div class="titlepage"><div><div><h3 class="title">1.11.3. Upgrading the Operators</h3></div></div></div><p>
					In order to keep your Service Mesh patched with the latest security fixes, bug fixes, and software updates, you must keep your Operators updated. You initiate patch updates by upgrading your Operators.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The version of the Operator does <span class="strong strong"><strong>not</strong></span> determine the version of your service mesh. The version of your deployed Service Mesh control plane determines your version of Service Mesh.
					</p></div></div><p>
					Because the Red Hat OpenShift Service Mesh Operator supports multiple versions of the Service Mesh control plane, updating the Red Hat OpenShift Service Mesh Operator does <span class="emphasis"><em>not</em></span> update the <code class="literal">spec.version</code> value of your deployed <code class="literal">ServiceMeshControlPlane</code>. Also note that the <code class="literal">spec.version</code> value is a two digit number, for example 2.2, and that patch updates, for example 2.2.1, are not reflected in the SMCP version value.
				</p><p>
					Operator Lifecycle Manager (OLM) controls the installation, upgrade, and role-based access control (RBAC) of Operators in a cluster. The OLM runs by default in OpenShift Container Platform. OLM queries for available Operators as well as upgrades for installed Operators.
				</p><p>
					Whether or not you have to take action to upgrade your Operators depends on the settings you selected when installing them. When you installed each of your Operators, you selected an <span class="strong strong"><strong>Update Channel</strong></span> and an <span class="strong strong"><strong>Approval Strategy</strong></span>. The combination of these two settings determine when and how your Operators are updated.
				</p><div class="table" id="idm140663684875104"><p class="title"><strong>Table 1.4. Interaction of Update Channel and Approval Strategy</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663660358432" scope="col"> </th><th align="left" valign="top" id="idm140663660357504" scope="col">Versioned channel</th><th align="left" valign="top" id="idm140663660356416" scope="col">"Stable" or "Preview" Channel</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663660358432"> <p>
									<span class="strong strong"><strong>Automatic</strong></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140663660357504"> <p>
									Automatically updates the Operator for minor and patch releases for that version only. Will not automatically update to the next major version (that is, from version 2.0 to 3.0). Manual change to Operator subscription required to update to the next major version.
								</p>
								 </td><td align="left" valign="top" headers="idm140663660356416"> <p>
									Automatically updates Operator for all major, minor, and patch releases.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663660358432"> <p>
									<span class="strong strong"><strong>Manual</strong></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140663660357504"> <p>
									Manual updates required for minor and patch releases for the specified version. Manual change to Operator subscription required to update to the next major version.
								</p>
								 </td><td align="left" valign="top" headers="idm140663660356416"> <p>
									Manual updates required for all major, minor, and patch releases.
								</p>
								 </td></tr></tbody></table></div></div><p>
					When you update your Red Hat OpenShift Service Mesh Operator the Operator Lifecycle Manager (OLM) removes the old Operator pod and starts a new pod. Once the new Operator pod starts, the reconciliation process checks the <code class="literal">ServiceMeshControlPlane</code> (SMCP), and if there are updated container images available for any of the Service Mesh control plane components, it replaces those Service Mesh control plane pods with ones that use the new container images.
				</p><p>
					When you upgrade the Kiali and Red Hat OpenShift distributed tracing platform (Jaeger) Operators, the OLM reconciliation process scans the cluster and upgrades the managed instances to the version of the new Operator. For example, if you update the Red Hat OpenShift distributed tracing platform (Jaeger) Operator from version 1.30.2 to version 1.34.1, the Operator scans for running instances of distributed tracing platform (Jaeger) and upgrades them to 1.34.1 as well.
				</p><p>
					To stay on a particular patch version of Red Hat OpenShift Service Mesh, you would need to disable automatic updates and remain on that specific version of the Operator.
				</p><p>
					For more information about upgrading Operators, refer to the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#updating-installed-operators">Operator Lifecycle Manager</a> documentation.
				</p></section><section class="section" id="upgrading-control-plane"><div class="titlepage"><div><div><h3 class="title">1.11.4. Upgrading the control plane</h3></div></div></div><p>
					You must manually update the control plane for minor and major releases. The community Istio project recommends canary upgrades, Red Hat OpenShift Service Mesh only supports in-place upgrades. Red Hat OpenShift Service Mesh requires that you upgrade from each minor release to the next minor release in sequence. For example, you must upgrade from version 2.0 to version 2.1, and then upgrade to version 2.2. You cannot update from Red Hat OpenShift Service Mesh 2.0 to 2.2 directly.
				</p><p>
					When you upgrade the service mesh control plane, all Operator managed resources, for example gateways, are also upgraded.
				</p><p>
					Although you can deploy multiple versions of the control plane in the same cluster, Red Hat OpenShift Service Mesh does not support canary upgrades of the service mesh. That is, you can have different SCMP resources with different values for <code class="literal">spec.version</code>, but they cannot be managing the same mesh.
				</p><p>
					For more information about migrating your extensions, refer to <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-extensions-migration-overview_ossm-extensions">Migrating from ServiceMeshExtension to WasmPlugin resources</a>.
				</p><section class="section" id="ossm-upgrade-23-24-changes_ossm-upgrade"><div class="titlepage"><div><div><h4 class="title">1.11.4.1. Upgrade changes from version 2.3 to version 2.4</h4></div></div></div><p>
						Upgrading the Service Mesh control plane from version 2.3 to 2.4 introduces the following behavioral changes:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Support for Istio OpenShift Routing (IOR) has been deprecated. IOR functionality is still enabled, but it will be removed in a future release.
							</li><li class="listitem"><p class="simpara">
								The following cipher suites are no longer supported, and were removed from the list of ciphers used in client and server side TLS negotiations.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										ECDHE-ECDSA-AES128-SHA
									</li><li class="listitem">
										ECDHE-RSA-AES128-SHA
									</li><li class="listitem">
										AES128-GCM-SHA256
									</li><li class="listitem">
										AES128-SHA
									</li><li class="listitem">
										ECDHE-ECDSA-AES256-SHA
									</li><li class="listitem">
										ECDHE-RSA-AES256-SHA
									</li><li class="listitem">
										AES256-GCM-SHA384
									</li><li class="listitem"><p class="simpara">
										AES256-SHA
									</p><p class="simpara">
										Applications that require access to services that use one of these cipher suites will fail to connect when the proxy initiates a TLS connection.
									</p></li></ul></div></li></ul></div></section><section class="section" id="ossm-upgrade-22-23-changes_ossm-upgrade"><div class="titlepage"><div><div><h4 class="title">1.11.4.2. Upgrade changes from version 2.2 to version 2.3</h4></div></div></div><p>
						Upgrading the Service Mesh control plane from version 2.2 to 2.3 introduces the following behavioral changes:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								This release requires use of the <code class="literal">WasmPlugin</code> API. Support for the <code class="literal">ServiceMeshExtension</code> API, which was deprecated in 2.2, has now been removed. If you attempt to upgrade while using the <code class="literal">ServiceMeshExtension</code> API, then the upgrade fails.
							</li></ul></div></section><section class="section" id="ossm-upgrade-21-22-changes_ossm-upgrade"><div class="titlepage"><div><div><h4 class="title">1.11.4.3. Upgrade changes from version 2.1 to version 2.2</h4></div></div></div><p>
						Upgrading the Service Mesh control plane from version 2.1 to 2.2 introduces the following behavioral changes:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The <code class="literal">istio-node</code> DaemonSet is renamed to <code class="literal">istio-cni-node</code> to match the name in upstream Istio.
							</li><li class="listitem">
								Istio 1.10 updated Envoy to send traffic to the application container using <code class="literal">eth0</code> rather than <code class="literal">lo</code> by default.
							</li><li class="listitem">
								This release adds support for the <code class="literal">WasmPlugin</code> API and deprecates the <code class="literal">ServiceMeshExtension</code> API.
							</li></ul></div></section><section class="section" id="ossm-upgrade-20-21-changes_ossm-upgrade"><div class="titlepage"><div><div><h4 class="title">1.11.4.4. Upgrade changes from version 2.0 to version 2.1</h4></div></div></div><p>
						Upgrading the Service Mesh control plane from version 2.0 to 2.1 introduces the following architectural and behavioral changes.
					</p><div class="formalpara"><p class="title"><strong>Architecture changes</strong></p><p>
							Mixer has been completely removed in Red Hat OpenShift Service Mesh 2.1. Upgrading from a Red Hat OpenShift Service Mesh 2.0.x release to 2.1 will be blocked if Mixer is enabled.
						</p></div><p>
						If you see the following message when upgrading from v2.0 to v2.1, update the existing <code class="literal">Mixer</code> type to <code class="literal">Istiod</code> type in the existing Control Plane spec before you update the <code class="literal">.spec.version</code> field:
					</p><pre class="programlisting language-text">An error occurred
admission webhook smcp.validation.maistra.io denied the request: [support for policy.type "Mixer" and policy.Mixer options have been removed in v2.1, please use another alternative, support for telemetry.type "Mixer" and telemetry.Mixer options have been removed in v2.1, please use another alternative]”</pre><p>
						For example:
					</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
spec:
  policy:
    type: Istiod
  telemetry:
    type: Istiod
  version: v2.4</pre><div class="itemizedlist" id="ossm-upgrading-differences-behavior_ossm-upgrade"><p class="title"><strong>Behavioral changes</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<code class="literal">AuthorizationPolicy</code> updates:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										With the PROXY protocol, if you’re using <code class="literal">ipBlocks</code> and <code class="literal">notIpBlocks</code> to specify remote IP addresses, update the configuration to use <code class="literal">remoteIpBlocks</code> and <code class="literal">notRemoteIpBlocks</code> instead.
									</li><li class="listitem">
										Added support for nested JSON Web Token (JWT) claims.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								<code class="literal">EnvoyFilter</code> breaking changes&gt;
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Must use <code class="literal">typed_config</code>
									</li><li class="listitem">
										xDS v2 is no longer supported
									</li><li class="listitem">
										Deprecated filter names
									</li></ul></div></li><li class="listitem">
								Older versions of proxies may report 503 status codes when receiving 1xx or 204 status codes from newer proxies.
							</li></ul></div></section><section class="section" id="ossm-upgrading-smcp_ossm-upgrade"><div class="titlepage"><div><div><h4 class="title">1.11.4.5. Upgrading the Service Mesh control plane</h4></div></div></div><p>
						To upgrade Red Hat OpenShift Service Mesh, you must update the version field of the Red Hat OpenShift Service Mesh <code class="literal">ServiceMeshControlPlane</code> v2 resource. Then, once it is configured and applied, restart the application pods to update each sidecar proxy and its configuration.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You are running OpenShift Container Platform 4.9 or later.
							</li><li class="listitem">
								You have the latest Red Hat OpenShift Service Mesh Operator.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Switch to the project that contains your <code class="literal">ServiceMeshControlPlane</code> resource. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
							</p><pre class="programlisting language-terminal">$ oc project istio-system</pre></li><li class="listitem"><p class="simpara">
								Check your v2 <code class="literal">ServiceMeshControlPlane</code> resource configuration to verify it is valid.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Run the following command to view your <code class="literal">ServiceMeshControlPlane</code> resource as a v2 resource.
									</p><pre class="programlisting language-terminal">$ oc get smcp -o yaml</pre><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
										Back up your Service Mesh control plane configuration.
									</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
								Update the <code class="literal">.spec.version</code> field and apply the configuration.
							</p><p class="simpara">
								For example:
							</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
spec:
  version: v2.4</pre><p class="simpara">
								Alternatively, instead of using the command line, you can use the web console to edit the Service Mesh control plane. In the OpenShift Container Platform web console, click <span class="strong strong"><strong>Project</strong></span> and select the project name you just entered.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
									</li><li class="listitem">
										Find your <code class="literal">ServiceMeshControlPlane</code> instance.
									</li><li class="listitem">
										Select <span class="strong strong"><strong>YAML view</strong></span> and update text of the YAML file, as shown in the previous example.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Save</strong></span>.
									</li></ol></div></li></ol></div></section><section class="section" id="ossm-migrating-to-20_ossm-upgrade"><div class="titlepage"><div><div><h4 class="title">1.11.4.6. Migrating Red Hat OpenShift Service Mesh from version 1.1 to version 2.0</h4></div></div></div><p>
						Upgrading from version 1.1 to 2.0 requires manual steps that migrate your workloads and application to a new instance of Red Hat OpenShift Service Mesh running the new version.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You must upgrade to OpenShift Container Platform 4.7. before you upgrade to Red Hat OpenShift Service Mesh 2.0.
							</li><li class="listitem">
								You must have Red Hat OpenShift Service Mesh version 2.0 operator. If you selected the <span class="strong strong"><strong>automatic</strong></span> upgrade path, the operator automatically downloads the latest information. However, there are steps you must take to use the features in Red Hat OpenShift Service Mesh version 2.0.
							</li></ul></div><section class="section" id="ossm-migrating_ossm-upgrade"><div class="titlepage"><div><div><h5 class="title">1.11.4.6.1. Upgrading Red Hat OpenShift Service Mesh</h5></div></div></div><p>
							To upgrade Red Hat OpenShift Service Mesh, you must create an instance of Red Hat OpenShift Service Mesh <code class="literal">ServiceMeshControlPlane</code> v2 resource in a new namespace. Then, once it’s configured, move your microservice applications and workloads from your old mesh to the new service mesh.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Check your v1 <code class="literal">ServiceMeshControlPlane</code> resource configuration to make sure it is valid.
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Run the following command to view your <code class="literal">ServiceMeshControlPlane</code> resource as a v2 resource.
										</p><pre class="programlisting language-terminal">$ oc get smcp -o yaml</pre></li><li class="listitem">
											Check the <code class="literal">spec.techPreview.errored.message</code> field in the output for information about any invalid fields.
										</li><li class="listitem">
											If there are invalid fields in your v1 resource, the resource is not reconciled and cannot be edited as a v2 resource. All updates to v2 fields will be overridden by the original v1 settings. To fix the invalid fields, you can replace, patch, or edit the v1 version of the resource. You can also delete the resource without fixing it. After the resource has been fixed, it can be reconciled, and you can to modify or view the v2 version of the resource.
										</li><li class="listitem"><p class="simpara">
											To fix the resource by editing a file, use <code class="literal">oc get</code> to retrieve the resource, edit the text file locally, and replace the resource with the file you edited.
										</p><pre class="programlisting language-terminal">$ oc get smcp.v1.maistra.io &lt;smcp_name&gt; &gt; smcp-resource.yaml
#Edit the smcp-resource.yaml file.
$ oc replace -f smcp-resource.yaml</pre></li><li class="listitem"><p class="simpara">
											To fix the resource using patching, use <code class="literal">oc patch</code>.
										</p><pre class="programlisting language-terminal">$ oc patch smcp.v1.maistra.io &lt;smcp_name&gt; --type json --patch '[{"op": "replace","path":"/spec/path/to/bad/setting","value":"corrected-value"}]'</pre></li><li class="listitem"><p class="simpara">
											To fix the resource by editing with command line tools, use <code class="literal">oc edit</code>.
										</p><pre class="programlisting language-terminal">$ oc edit smcp.v1.maistra.io &lt;smcp_name&gt;</pre></li></ol></div></li><li class="listitem"><p class="simpara">
									Back up your Service Mesh control plane configuration. Switch to the project that contains your <code class="literal">ServiceMeshControlPlane</code> resource. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
								</p><pre class="programlisting language-terminal">$ oc project istio-system</pre></li><li class="listitem"><p class="simpara">
									Enter the following command to retrieve the current configuration. Your &lt;smcp_name&gt; is specified in the metadata of your <code class="literal">ServiceMeshControlPlane</code> resource, for example <code class="literal">basic-install</code> or <code class="literal">full-install</code>.
								</p><pre class="programlisting language-terminal">$ oc get servicemeshcontrolplanes.v1.maistra.io &lt;smcp_name&gt; -o yaml &gt; &lt;smcp_name&gt;.v1.yaml</pre></li><li class="listitem"><p class="simpara">
									Convert your <code class="literal">ServiceMeshControlPlane</code> to a v2 control plane version that contains information about your configuration as a starting point.
								</p><pre class="programlisting language-terminal">$ oc get smcp &lt;smcp_name&gt; -o yaml &gt; &lt;smcp_name&gt;.v2.yaml</pre></li><li class="listitem"><p class="simpara">
									Create a project. In the OpenShift Container Platform console Project menu, click <code class="literal">New Project</code> and enter a name for your project, <code class="literal">istio-system-upgrade</code>, for example. Or, you can run this command from the CLI.
								</p><pre class="programlisting language-terminal">$ oc new-project istio-system-upgrade</pre></li><li class="listitem">
									Update the <code class="literal">metadata.namespace</code> field in your v2 <code class="literal">ServiceMeshControlPlane</code> with your new project name. In this example, use <code class="literal">istio-system-upgrade</code>.
								</li><li class="listitem">
									Update the <code class="literal">version</code> field from 1.1 to 2.0 or remove it in your v2 <code class="literal">ServiceMeshControlPlane</code>.
								</li><li class="listitem"><p class="simpara">
									Create a <code class="literal">ServiceMeshControlPlane</code> in the new namespace. On the command line, run the following command to deploy the control plane with the v2 version of the <code class="literal">ServiceMeshControlPlane</code> that you retrieved. In this example, replace `&lt;smcp_name.v2&gt; `with the path to your file.
								</p><pre class="programlisting language-terminal">$ oc create -n istio-system-upgrade -f &lt;smcp_name&gt;.v2.yaml</pre><p class="simpara">
									Alternatively, you can use the console to create the Service Mesh control plane. In the OpenShift Container Platform web console, click <span class="strong strong"><strong>Project</strong></span>. Then, select the project name you just entered.
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
											Click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
										</li><li class="listitem">
											Click <span class="strong strong"><strong>Create ServiceMeshControlPlane</strong></span>.
										</li><li class="listitem">
											Select <span class="strong strong"><strong>YAML view</strong></span> and paste text of the YAML file you retrieved into the field. Check that the <code class="literal">apiVersion</code> field is set to <code class="literal">maistra.io/v2</code> and modify the <code class="literal">metadata.namespace</code> field to use the new namespace, for example <code class="literal">istio-system-upgrade</code>.
										</li><li class="listitem">
											Click <span class="strong strong"><strong>Create</strong></span>.
										</li></ol></div></li></ol></div></section><section class="section" id="ossm-migrating-smcp_ossm-upgrade"><div class="titlepage"><div><div><h5 class="title">1.11.4.6.2. Configuring the 2.0 ServiceMeshControlPlane</h5></div></div></div><p>
							The <code class="literal">ServiceMeshControlPlane</code> resource has been changed for Red Hat OpenShift Service Mesh version 2.0. After you created a v2 version of the <code class="literal">ServiceMeshControlPlane</code> resource, modify it to take advantage of the new features and to fit your deployment. Consider the following changes to the specification and behavior of Red Hat OpenShift Service Mesh 2.0 as you’re modifying your <code class="literal">ServiceMeshControlPlane</code> resource. You can also refer to the Red Hat OpenShift Service Mesh 2.0 product documentation for new information to features you use. The v2 resource must be used for Red Hat OpenShift Service Mesh 2.0 installations.
						</p><section class="section" id="ossm-migrating-differences-arch_ossm-upgrade"><div class="titlepage"><div><div><h6 class="title">1.11.4.6.2.1. Architecture changes</h6></div></div></div><p>
								The architectural units used by previous versions have been replaced by Istiod. In 2.0 the Service Mesh control plane components Mixer, Pilot, Citadel, Galley, and the sidecar injector functionality have been combined into a single component, Istiod.
							</p><p>
								Although Mixer is no longer supported as a control plane component, Mixer policy and telemetry plugins are now supported through WASM extensions in Istiod. Mixer can be enabled for policy and telemetry if you need to integrate legacy Mixer plugins.
							</p><p>
								Secret Discovery Service (SDS) is used to distribute certificates and keys to sidecars directly from Istiod. In Red Hat OpenShift Service Mesh version 1.1, secrets were generated by Citadel, which were used by the proxies to retrieve their client certificates and keys.
							</p></section><section class="section" id="ossm-migrating-differences-annotation_ossm-upgrade"><div class="titlepage"><div><div><h6 class="title">1.11.4.6.2.2. Annotation changes</h6></div></div></div><p>
								The following annotations are no longer supported in v2.0. If you are using one of these annotations, you must update your workload before moving it to a v2.0 Service Mesh control plane.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">sidecar.maistra.io/proxyCPULimit</code> has been replaced with <code class="literal">sidecar.istio.io/proxyCPULimit</code>. If you were using <code class="literal">sidecar.maistra.io</code> annotations on your workloads, you must modify those workloads to use <code class="literal">sidecar.istio.io</code> equivalents instead.
									</li><li class="listitem">
										<code class="literal">sidecar.maistra.io/proxyMemoryLimit</code> has been replaced with <code class="literal">sidecar.istio.io/proxyMemoryLimit</code>
									</li><li class="listitem">
										<code class="literal">sidecar.istio.io/discoveryAddress</code> is no longer supported. Also, the default discovery address has moved from <code class="literal">pilot.&lt;control_plane_namespace&gt;.svc:15010</code> (or port 15011, if mtls is enabled) to <code class="literal">istiod-&lt;smcp_name&gt;.&lt;control_plane_namespace&gt;.svc:15012</code>.
									</li><li class="listitem">
										The health status port is no longer configurable and is hard-coded to 15021. * If you were defining a custom status port, for example, <code class="literal">status.sidecar.istio.io/port</code>, you must remove the override before moving the workload to a v2.0 Service Mesh control plane. Readiness checks can still be disabled by setting the status port to <code class="literal">0</code>.
									</li><li class="listitem">
										Kubernetes Secret resources are no longer used to distribute client certificates for sidecars. Certificates are now distributed through Istiod’s SDS service. If you were relying on mounted secrets, they are longer available for workloads in v2.0 Service Mesh control planes.
									</li></ul></div></section><section class="section" id="ossm-migrating-differences-behavior_ossm-upgrade"><div class="titlepage"><div><div><h6 class="title">1.11.4.6.2.3. Behavioral changes</h6></div></div></div><p>
								Some features in Red Hat OpenShift Service Mesh 2.0 work differently than they did in previous versions.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										The readiness port on gateways has moved from <code class="literal">15020</code> to <code class="literal">15021</code>.
									</li><li class="listitem">
										The target host visibility includes VirtualService, as well as ServiceEntry resources. It includes any restrictions applied through Sidecar resources.
									</li><li class="listitem">
										Automatic mutual TLS is enabled by default. Proxy to proxy communication is automatically configured to use mTLS, regardless of global PeerAuthentication policies in place.
									</li><li class="listitem">
										Secure connections are always used when proxies communicate with the Service Mesh control plane regardless of <code class="literal">spec.security.controlPlane.mtls</code> setting. The <code class="literal">spec.security.controlPlane.mtls</code> setting is only used when configuring connections for Mixer telemetry or policy.
									</li></ul></div></section><section class="section" id="ossm-migrating-unsupported-resources_ossm-upgrade"><div class="titlepage"><div><div><h6 class="title">1.11.4.6.2.4. Migration details for unsupported resources</h6></div></div></div><div class="formalpara"><p class="title"><strong>Policy (authentication.istio.io/v1alpha1)</strong></p><p>
									Policy resources must be migrated to new resource types for use with v2.0 Service Mesh control planes, PeerAuthentication and RequestAuthentication. Depending on the specific configuration in your Policy resource, you may have to configure multiple resources to achieve the same effect.
								</p></div><div class="formalpara"><p class="title"><strong>Mutual TLS</strong></p><p>
									Mutual TLS enforcement is accomplished using the <code class="literal">security.istio.io/v1beta1</code> PeerAuthentication resource. The legacy <code class="literal">spec.peers.mtls.mode</code> field maps directly to the new resource’s <code class="literal">spec.mtls.mode</code> field. Selection criteria has changed from specifying a service name in <code class="literal">spec.targets[x].name</code> to a label selector in <code class="literal">spec.selector.matchLabels</code>. In PeerAuthentication, the labels must match the selector on the services named in the targets list. Any port-specific settings will need to be mapped into <code class="literal">spec.portLevelMtls</code>.
								</p></div><div class="formalpara"><p class="title"><strong>Authentication</strong></p><p>
									Additional authentication methods specified in <code class="literal">spec.origins</code>, must be mapped into a <code class="literal">security.istio.io/v1beta1</code> RequestAuthentication resource. <code class="literal">spec.selector.matchLabels</code> must be configured similarly to the same field on PeerAuthentication. Configuration specific to JWT principals from <code class="literal">spec.origins.jwt</code> items map to similar fields in <code class="literal">spec.rules</code> items.
								</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">spec.origins[x].jwt.triggerRules</code> specified in the Policy must be mapped into one or more <code class="literal">security.istio.io/v1beta1</code> AuthorizationPolicy resources. Any <code class="literal">spec.selector.labels</code> must be configured similarly to the same field on RequestAuthentication.
									</li><li class="listitem">
										<code class="literal">spec.origins[x].jwt.triggerRules.excludedPaths</code> must be mapped into an AuthorizationPolicy whose spec.action is set to ALLOW, with <code class="literal">spec.rules[x].to.operation.path</code> entries matching the excluded paths.
									</li><li class="listitem">
										<code class="literal">spec.origins[x].jwt.triggerRules.includedPaths</code> must be mapped into a separate AuthorizationPolicy whose <code class="literal">spec.action</code> is set to <code class="literal">ALLOW</code>, with <code class="literal">spec.rules[x].to.operation.path</code> entries matching the included paths, and <code class="literal">spec.rules.[x].from.source.requestPrincipals</code> entries that align with the <code class="literal">specified spec.origins[x].jwt.issuer</code> in the Policy resource.
									</li></ul></div><div class="formalpara"><p class="title"><strong>ServiceMeshPolicy (maistra.io/v1)</strong></p><p>
									ServiceMeshPolicy was configured automatically for the Service Mesh control plane through the <code class="literal">spec.istio.global.mtls.enabled</code> in the v1 resource or <code class="literal">spec.security.dataPlane.mtls</code> in the v2 resource setting. For v2 control planes, a functionally equivalent PeerAuthentication resource is created during installation. This feature is deprecated in Red Hat OpenShift Service Mesh version 2.0
								</p></div><div class="formalpara"><p class="title"><strong>RbacConfig, ServiceRole, ServiceRoleBinding (rbac.istio.io/v1alpha1)</strong></p><p>
									These resources were replaced by the <code class="literal">security.istio.io/v1beta1</code> AuthorizationPolicy resource.
								</p></div><p>
								Mimicking RbacConfig behavior requires writing a default AuthorizationPolicy whose settings depend on the spec.mode specified in the RbacConfig.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										When <code class="literal">spec.mode</code> is set to <code class="literal">OFF</code>, no resource is required as the default policy is ALLOW, unless an AuthorizationPolicy applies to the request.
									</li><li class="listitem">
										When <code class="literal">spec.mode</code> is set to ON, set <code class="literal">spec: {}</code>. You must create AuthorizationPolicy policies for all services in the mesh.
									</li><li class="listitem">
										<code class="literal">spec.mode</code> is set to <code class="literal">ON_WITH_INCLUSION</code>, must create an AuthorizationPolicy with <code class="literal">spec: {}</code> in each included namespace. Inclusion of individual services is not supported by AuthorizationPolicy. However, as soon as any AuthorizationPolicy is created that applies to the workloads for the service, all other requests not explicitly allowed will be denied.
									</li><li class="listitem">
										When <code class="literal">spec.mode</code> is set to <code class="literal">ON_WITH_EXCLUSION</code>, it is not supported by AuthorizationPolicy. A global DENY policy can be created, but an AuthorizationPolicy must be created for every workload in the mesh because there is no allow-all policy that can be applied to either a namespace or a workload.
									</li></ul></div><p>
								AuthorizationPolicy includes configuration for both the selector to which the configuration applies, which is similar to the function ServiceRoleBinding provides and the rules which should be applied, which is similar to the function ServiceRole provides.
							</p><div class="formalpara"><p class="title"><strong>ServiceMeshRbacConfig (maistra.io/v1)</strong></p><p>
									This resource is replaced by using a <code class="literal">security.istio.io/v1beta1</code> AuthorizationPolicy resource with an empty spec.selector in the Service Mesh control plane’s namespace. This policy will be the default authorization policy applied to all workloads in the mesh. For specific migration details, see RbacConfig above.
								</p></div></section><section class="section" id="ossm-migrating-mixer_ossm-upgrade"><div class="titlepage"><div><div><h6 class="title">1.11.4.6.2.5. Mixer plugins</h6></div></div></div><p>
								Mixer components are disabled by default in version 2.0. If you rely on Mixer plugins for your workload, you must configure your version 2.0 <code class="literal">ServiceMeshControlPlane</code> to include the Mixer components.
							</p><p>
								To enable the Mixer policy components, add the following snippet to your <code class="literal">ServiceMeshControlPlane</code>.
							</p><pre class="programlisting language-yaml">spec:
  policy:
    type: Mixer</pre><p>
								To enable the Mixer telemetry components, add the following snippet to your <code class="literal">ServiceMeshControlPlane</code>.
							</p><pre class="programlisting language-yaml">spec:
  telemetry:
    type: Mixer</pre><p>
								Legacy mixer plugins can also be migrated to WASM and integrated using the new ServiceMeshExtension (maistra.io/v1alpha1) custom resource.
							</p><p>
								Built-in WASM filters included in the upstream Istio distribution are not available in Red Hat OpenShift Service Mesh 2.0.
							</p></section><section class="section" id="ossm-migrating-mtls_ossm-upgrade"><div class="titlepage"><div><div><h6 class="title">1.11.4.6.2.6. Mutual TLS changes</h6></div></div></div><p>
								When using mTLS with workload specific PeerAuthentication policies, a corresponding DestinationRule is required to allow traffic if the workload policy differs from the namespace/global policy.
							</p><p>
								Auto mTLS is enabled by default, but can be disabled by setting <code class="literal">spec.security.dataPlane.automtls</code> to false in the <code class="literal">ServiceMeshControlPlane</code> resource. When disabling auto mTLS, DestinationRules may be required for proper communication between services. For example, setting PeerAuthentication to <code class="literal">STRICT</code> for one namespace may prevent services in other namespaces from accessing them, unless a DestinationRule configures TLS mode for the services in the namespace.
							</p><p>
								For information about mTLS, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-security-mtls_ossm-security">Enabling mutual Transport Layer Security (mTLS)</a>
							</p><section class="section" id="other-mtls-examples"><div class="titlepage"><div><div><h6 class="title">1.11.4.6.2.6.1. Other mTLS Examples</h6></div></div></div><p>
									To disable mTLS For productpage service in the bookinfo sample application, your Policy resource was configured the following way for Red Hat OpenShift Service Mesh v1.1.
								</p><div class="formalpara"><p class="title"><strong>Example Policy resource</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: authentication.istio.io/v1alpha1
kind: Policy
metadata:
  name: productpage-mTLS-disable
  namespace: &lt;namespace&gt;
spec:
  targets:
  - name: productpage</pre>

									</p></div><p>
									To disable mTLS For productpage service in the bookinfo sample application, use the following example to configure your PeerAuthentication resource for Red Hat OpenShift Service Mesh v2.0.
								</p><div class="formalpara"><p class="title"><strong>Example PeerAuthentication resource</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: productpage-mTLS-disable
  namespace: &lt;namespace&gt;
spec:
  mtls:
    mode: DISABLE
  selector:
    matchLabels:
      # this should match the selector for the "productpage" service
      app: productpage</pre>

									</p></div><p>
									To enable mTLS With JWT authentication for the <code class="literal">productpage</code> service in the bookinfo sample application, your Policy resource was configured the following way for Red Hat OpenShift Service Mesh v1.1.
								</p><div class="formalpara"><p class="title"><strong>Example Policy resource</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: authentication.istio.io/v1alpha1
kind: Policy
metadata:
  name: productpage-mTLS-with-JWT
  namespace: &lt;namespace&gt;
spec:
  targets:
  - name: productpage
    ports:
    - number: 9000
  peers:
  - mtls:
  origins:
  - jwt:
      issuer: "https://securetoken.google.com"
      audiences:
      - "productpage"
      jwksUri: "https://www.googleapis.com/oauth2/v1/certs"
      jwtHeaders:
      - "x-goog-iap-jwt-assertion"
      triggerRules:
      - excludedPaths:
        - exact: /health_check
  principalBinding: USE_ORIGIN</pre>

									</p></div><p>
									To enable mTLS With JWT authentication for the productpage service in the bookinfo sample application, use the following example to configure your PeerAuthentication resource for Red Hat OpenShift Service Mesh v2.0.
								</p><div class="formalpara"><p class="title"><strong>Example PeerAuthentication resource</strong></p><p>
										
<pre class="programlisting language-yaml">#require mtls for productpage:9000
apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: productpage-mTLS-with-JWT
  namespace: &lt;namespace&gt;
spec:
  selector:
    matchLabels:
      # this should match the selector for the "productpage" service
      app: productpage
  portLevelMtls:
    9000:
      mode: STRICT
---
#JWT authentication for productpage
apiVersion: security.istio.io/v1beta1
kind: RequestAuthentication
metadata:
  name: productpage-mTLS-with-JWT
  namespace: &lt;namespace&gt;
spec:
  selector:
    matchLabels:
      # this should match the selector for the "productpage" service
      app: productpage
  jwtRules:
  - issuer: "https://securetoken.google.com"
    audiences:
    - "productpage"
    jwksUri: "https://www.googleapis.com/oauth2/v1/certs"
    fromHeaders:
    - name: "x-goog-iap-jwt-assertion"
---
#Require JWT token to access product page service from
#any client to all paths except /health_check
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: productpage-mTLS-with-JWT
  namespace: &lt;namespace&gt;
spec:
  action: ALLOW
  selector:
    matchLabels:
      # this should match the selector for the "productpage" service
      app: productpage
  rules:
  - to: # require JWT token to access all other paths
      - operation:
          notPaths:
          - /health_check
    from:
      - source:
          # if using principalBinding: USE_PEER in the Policy,
          # then use principals, e.g.
          # principals:
          # - “*”
          requestPrincipals:
          - “*”
  - to: # no JWT token required to access health_check
      - operation:
          paths:
          - /health_check</pre>

									</p></div></section></section></section><section class="section" id="ossm-migrating-config-recipes_ossm-upgrade"><div class="titlepage"><div><div><h5 class="title">1.11.4.6.3. Configuration recipes</h5></div></div></div><p>
							You can configure the following items with these configuration recipes.
						</p><section class="section" id="ossm-migrating-config-mtls_ossm-upgrade"><div class="titlepage"><div><div><h6 class="title">1.11.4.6.3.1. Mutual TLS in a data plane</h6></div></div></div><p>
								Mutual TLS for data plane communication is configured through <code class="literal">spec.security.dataPlane.mtls</code> in the <code class="literal">ServiceMeshControlPlane</code> resource, which is <code class="literal">false</code> by default.
							</p></section><section class="section" id="ossm-migrating-config-sign-key_ossm-upgrade"><div class="titlepage"><div><div><h6 class="title">1.11.4.6.3.2. Custom signing key</h6></div></div></div><p>
								Istiod manages client certificates and private keys used by service proxies. By default, Istiod uses a self-signed certificate for signing, but you can configure a custom certificate and private key. For more information about how to configure signing keys, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-cert-manage_ossm-security">Adding an external certificate authority key and certificate</a>
							</p></section><section class="section" id="ossm-migrating-config-tracing_ossm-upgrade"><div class="titlepage"><div><div><h6 class="title">1.11.4.6.3.3. Tracing</h6></div></div></div><p>
								Tracing is configured in <code class="literal">spec.tracing</code>. Currently, the only type of tracer that is supported is <code class="literal">Jaeger</code>. Sampling is a scaled integer representing 0.01% increments, for example, 1 is 0.01% and 10000 is 100%. The tracing implementation and sampling rate can be specified:
							</p><pre class="programlisting language-yaml">spec:
  tracing:
    sampling: 100 # 1%
    type: Jaeger</pre><p>
								Jaeger is configured in the <code class="literal">addons</code> section of the <code class="literal">ServiceMeshControlPlane</code> resource.
							</p><pre class="programlisting language-yaml">spec:
  addons:
    jaeger:
      name: jaeger
      install:
        storage:
          type: Memory # or Elasticsearch for production mode
          memory:
            maxTraces: 100000
          elasticsearch: # the following values only apply if storage:type:=Elasticsearch
            storage: # specific storageclass configuration for the Jaeger Elasticsearch (optional)
              size: "100G"
              storageClassName: "storageclass"
            nodeCount: 3
            redundancyPolicy: SingleRedundancy
  runtime:
    components:
      tracing.jaeger: {} # general Jaeger specific runtime configuration (optional)
      tracing.jaeger.elasticsearch: #runtime configuration for Jaeger Elasticsearch deployment (optional)
        container:
          resources:
            requests:
              memory: "1Gi"
              cpu: "500m"
            limits:
              memory: "1Gi"</pre><p>
								The Jaeger installation can be customized with the <code class="literal">install</code> field. Container configuration, such as resource limits is configured in <code class="literal">spec.runtime.components.jaeger</code> related fields. If a Jaeger resource matching the value of <code class="literal">spec.addons.jaeger.name</code> exists, the Service Mesh control plane will be configured to use the existing installation. Use an existing Jaeger resource to fully customize your Jaeger installation.
							</p></section><section class="section" id="ossm-migrating-config-vis_ossm-upgrade"><div class="titlepage"><div><div><h6 class="title">1.11.4.6.3.4. Visualization</h6></div></div></div><p>
								Kiali and Grafana are configured under the <code class="literal">addons</code> section of the <code class="literal">ServiceMeshControlPlane</code> resource.
							</p><pre class="programlisting language-yaml">spec:
  addons:
    grafana:
      enabled: true
      install: {} # customize install
    kiali:
      enabled: true
      name: kiali
      install: {} # customize install</pre><p>
								The Grafana and Kiali installations can be customized through their respective <code class="literal">install</code> fields. Container customization, such as resource limits, is configured in <code class="literal">spec.runtime.components.kiali</code> and <code class="literal">spec.runtime.components.grafana</code>. If an existing Kiali resource matching the value of name exists, the Service Mesh control plane configures the Kiali resource for use with the control plane. Some fields in the Kiali resource are overridden, such as the <code class="literal">accessible_namespaces</code> list, as well as the endpoints for Grafana, Prometheus, and tracing. Use an existing resource to fully customize your Kiali installation.
							</p></section><section class="section" id="resource-utilization-and-scheduling"><div class="titlepage"><div><div><h6 class="title">1.11.4.6.3.5. Resource utilization and scheduling</h6></div></div></div><p>
								Resources are configured under <code class="literal">spec.runtime.&lt;component&gt;</code>. The following component names are supported.
							</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663674489072" scope="col">Component</th><th align="left" valign="top" id="idm140663674487984" scope="col">Description</th><th align="left" valign="top" id="idm140663674486896" scope="col">Versions supported</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												security
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												Citadel container
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v1.0/1.1
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												galley
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												Galley container
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v1.0/1.1
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												pilot
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												Pilot/Istiod container
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v1.0/1.1/2.0
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												mixer
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												istio-telemetry and istio-policy containers
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v1.0/1.1
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												<code class="literal">mixer.policy</code>
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												istio-policy container
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v2.0
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												<code class="literal">mixer.telemetry</code>
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												istio-telemetry container
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v2.0
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												<code class="literal">global.oauthproxy</code>
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												oauth-proxy container used with various addons
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v1.0/1.1/2.0
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												<code class="literal">sidecarInjectorWebhook</code>
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												sidecar injector webhook container
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v1.0/1.1
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												<code class="literal">tracing.jaeger</code>
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												general Jaeger container - not all settings may be applied. Complete customization of Jaeger installation is supported by specifying an existing Jaeger resource in the Service Mesh control plane configuration.
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v1.0/1.1/2.0
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												<code class="literal">tracing.jaeger.agent</code>
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												settings specific to Jaeger agent
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v1.0/1.1/2.0
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												<code class="literal">tracing.jaeger.allInOne</code>
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												settings specific to Jaeger allInOne
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v1.0/1.1/2.0
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												<code class="literal">tracing.jaeger.collector</code>
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												settings specific to Jaeger collector
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v1.0/1.1/2.0
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												<code class="literal">tracing.jaeger.elasticsearch</code>
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												settings specific to Jaeger elasticsearch deployment
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v1.0/1.1/2.0
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												<code class="literal">tracing.jaeger.query</code>
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												settings specific to Jaeger query
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v1.0/1.1/2.0
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												prometheus
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												prometheus container
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v1.0/1.1/2.0
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												kiali
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												Kiali container - complete customization of Kiali installation is supported by specifying an existing Kiali resource in the Service Mesh control plane configuration.
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v1.0/1.1/2.0
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												grafana
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												Grafana container
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v1.0/1.1/2.0
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												3scale
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												3scale container
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v1.0/1.1/2.0
											</p>
											 </td></tr><tr><td align="left" valign="top" headers="idm140663674489072"> <p>
												<code class="literal">wasmExtensions.cacher</code>
											</p>
											 </td><td align="left" valign="top" headers="idm140663674487984"> <p>
												WASM extensions cacher container
											</p>
											 </td><td align="left" valign="top" headers="idm140663674486896"> <p>
												v2.0 - tech preview
											</p>
											 </td></tr></tbody></table></div><p>
								Some components support resource limiting and scheduling. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-performance-scalability">Performance and scalability</a>.
							</p></section></section><section class="section" id="ossm-migrrating-apps_ossm-upgrade"><div class="titlepage"><div><div><h5 class="title">1.11.4.6.4. Next steps for migrating your applications and workloads</h5></div></div></div><p>
							Move the application workload to the new mesh and remove the old instances to complete your upgrade.
						</p></section></section></section><section class="section" id="upgrading-data-plane"><div class="titlepage"><div><div><h3 class="title">1.11.5. Upgrading the data plane</h3></div></div></div><p>
					Your data plane will still function after you have upgraded the control plane. But in order to apply updates to the Envoy proxy and any changes to the proxy configuration, you must restart your application pods and workloads.
				</p><section class="section" id="ossm-upgrading-apps-workloads_ossm-upgrade"><div class="titlepage"><div><div><h4 class="title">1.11.5.1. Updating your applications and workloads</h4></div></div></div><p>
						To complete the migration, restart all of the application pods in the mesh to upgrade the Envoy sidecar proxies and their configuration.
					</p><p>
						To perform a rolling update of a deployment use the following command:
					</p><pre class="programlisting language-terminal">$ oc rollout restart &lt;deployment&gt;</pre><p>
						You must perform a rolling update for all applications that make up the mesh.
					</p></section></section></section><section class="section" id="ossm-profiles-users"><div class="titlepage"><div><div><h2 class="title">1.12. Managing users and profiles</h2></div></div></div><section class="section" id="ossm-members_ossm-profiles-users"><div class="titlepage"><div><div><h3 class="title">1.12.1. Creating the Red Hat OpenShift Service Mesh members</h3></div></div></div><p>
					<code class="literal">ServiceMeshMember</code> resources provide a way for Red Hat OpenShift Service Mesh administrators to delegate permissions to add projects to a service mesh, even when the respective users don’t have direct access to the service mesh project or member roll. While project administrators are automatically given permission to create the <code class="literal">ServiceMeshMember</code> resource in their project, they cannot point it to any <code class="literal">ServiceMeshControlPlane</code> until the service mesh administrator explicitly grants access to the service mesh. Administrators can grant users permissions to access the mesh by granting them the <code class="literal">mesh-user</code> user role. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
				</p><pre class="programlisting language-terminal">$ oc policy add-role-to-user -n istio-system --role-namespace istio-system mesh-user &lt;user_name&gt;</pre><p>
					Administrators can modify the <code class="literal">mesh-user</code> role binding in the Service Mesh control plane project to specify the users and groups that are granted access. The <code class="literal">ServiceMeshMember</code> adds the project to the <code class="literal">ServiceMeshMemberRoll</code> within the Service Mesh control plane project that it references.
				</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshMember
metadata:
  name: default
spec:
  controlPlaneRef:
    namespace: istio-system
    name: basic</pre><p>
					The <code class="literal">mesh-users</code> role binding is created automatically after the administrator creates the <code class="literal">ServiceMeshControlPlane</code> resource. An administrator can use the following command to add a role to a user.
				</p><pre class="programlisting language-terminal">$ oc policy add-role-to-user</pre><p>
					The administrator can also create the <code class="literal">mesh-user</code> role binding before the administrator creates the <code class="literal">ServiceMeshControlPlane</code> resource. For example, the administrator can create it in the same <code class="literal">oc apply</code> operation as the <code class="literal">ServiceMeshControlPlane</code> resource.
				</p><p>
					This example adds a role binding for <code class="literal">alice</code>:
				</p><pre class="programlisting language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  namespace: istio-system
  name: mesh-users
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: mesh-user
subjects:
- apiGroup: rbac.authorization.k8s.io
  kind: User
  name: alice</pre></section><section class="section" id="ossm-control-plane-profiles_ossm-profiles-users"><div class="titlepage"><div><div><h3 class="title">1.12.2. Creating Service Mesh control plane profiles</h3></div></div></div><p>
					You can create reusable configurations with <code class="literal">ServiceMeshControlPlane</code> profiles. Individual users can extend the profiles they create with their own configurations. Profiles can also inherit configuration information from other profiles. For example, you can create an accounting control plane for the accounting team and a marketing control plane for the marketing team. If you create a development template and a production template, members of the marketing team and the accounting team can extend the development and production profiles with team-specific customization.
				</p><p>
					When you configure Service Mesh control plane profiles, which follow the same syntax as the <code class="literal">ServiceMeshControlPlane</code>, users inherit settings in a hierarchical fashion. The Operator is delivered with a <code class="literal">default</code> profile with default settings for Red Hat OpenShift Service Mesh.
				</p><section class="section" id="ossm-create-configmap_ossm-profiles-users"><div class="titlepage"><div><div><h4 class="title">1.12.2.1. Creating the ConfigMap</h4></div></div></div><p>
						To add custom profiles, you must create a <code class="literal">ConfigMap</code> named <code class="literal">smcp-templates</code> in the <code class="literal">openshift-operators</code> project. The Operator container automatically mounts the <code class="literal">ConfigMap</code>.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								An installed, verified Service Mesh Operator.
							</li><li class="listitem">
								An account with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
							</li><li class="listitem">
								Location of the Operator deployment.
							</li><li class="listitem">
								Access to the OpenShift CLI (<code class="literal">oc</code>).
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform CLI as a <code class="literal">cluster-admin</code>. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
							</li><li class="listitem"><p class="simpara">
								From the CLI, run this command to create the ConfigMap named <code class="literal">smcp-templates</code> in the <code class="literal">openshift-operators</code> project and replace <code class="literal">&lt;profiles-directory&gt;</code> with the location of the <code class="literal">ServiceMeshControlPlane</code> files on your local disk:
							</p><pre class="programlisting language-terminal">$ oc create configmap --from-file=&lt;profiles-directory&gt; smcp-templates -n openshift-operators</pre></li><li class="listitem"><p class="simpara">
								You can use the <code class="literal">profiles</code> parameter in the <code class="literal">ServiceMeshControlPlane</code> to specify one or more templates.
							</p><pre class="programlisting language-yaml">  apiVersion: maistra.io/v2
  kind: ServiceMeshControlPlane
  metadata:
    name: basic
  spec:
    profiles:
    - default</pre></li></ol></div></section><section class="section" id="ossm-config-network-policy_ossm-profiles-users"><div class="titlepage"><div><div><h4 class="title">1.12.2.2. Setting the correct network policy</h4></div></div></div><p>
						Service Mesh creates network policies in the Service Mesh control plane and member namespaces to allow traffic between them. Before you deploy, consider the following conditions to ensure the services in your service mesh that were previously exposed through an OpenShift Container Platform route.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Traffic into the service mesh must always go through the ingress-gateway for Istio to work properly.
							</li><li class="listitem">
								Deploy services external to the service mesh in separate namespaces that are not in any service mesh.
							</li><li class="listitem">
								Non-mesh services that need to be deployed within a service mesh enlisted namespace should label their deployments <code class="literal">maistra.io/expose-route: "true"</code>, which ensures OpenShift Container Platform routes to these services still work.
							</li></ul></div></section></section></section><section class="section" id="ossm-security"><div class="titlepage"><div><div><h2 class="title">1.13. Security</h2></div></div></div><p>
				If your service mesh application is constructed with a complex array of microservices, you can use Red Hat OpenShift Service Mesh to customize the security of the communication between those services. The infrastructure of OpenShift Container Platform along with the traffic management features of Service Mesh help you manage the complexity of your applications and secure microservices.
			</p><div class="formalpara"><p class="title"><strong>Before you begin</strong></p><p>
					If you have a project, add your project to the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-member-roll-create_ossm-create-mesh"><code class="literal">ServiceMeshMemberRoll</code> resource</a>.
				</p></div><p>
				If you don’t have a project, install the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-tutorial-bookinfo-overview_ossm-create-mesh">Bookinfo sample application</a> and add it to the <code class="literal">ServiceMeshMemberRoll</code> resource. The sample application helps illustrate security concepts.
			</p><section class="section" id="ossm-security-mtls_ossm-security"><div class="titlepage"><div><div><h3 class="title">1.13.1. About mutual Transport Layer Security (mTLS)</h3></div></div></div><p>
					Mutual Transport Layer Security (mTLS) is a protocol that enables two parties to authenticate each other. It is the default mode of authentication in some protocols (IKE, SSH) and optional in others (TLS). You can use mTLS without changes to the application or service code. The TLS is handled entirely by the service mesh infrastructure and between the two sidecar proxies.
				</p><p>
					By default, mTLS in Red Hat OpenShift Service Mesh is enabled and set to permissive mode, where the sidecars in Service Mesh accept both plain-text traffic and connections that are encrypted using mTLS. If a service in your mesh is communicating with a service outside the mesh, strict mTLS could break communication between those services. Use permissive mode while you migrate your workloads to Service Mesh. Then, you can enable strict mTLS across your mesh, namespace, or application.
				</p><p>
					Enabling mTLS across your mesh at the Service Mesh control plane level secures all the traffic in your service mesh without rewriting your applications and workloads. You can secure namespaces in your mesh at the data plane level in the <code class="literal">ServiceMeshControlPlane</code> resource. To customize traffic encryption connections, configure namespaces at the application level with <code class="literal">PeerAuthentication</code> and <code class="literal">DestinationRule</code> resources.
				</p><section class="section" id="ossm-security-enabling-strict-mtls_ossm-security"><div class="titlepage"><div><div><h4 class="title">1.13.1.1. Enabling strict mTLS across the service mesh</h4></div></div></div><p>
						If your workloads do not communicate with outside services, you can quickly enable mTLS across your mesh without communication interruptions. You can enable it by setting <code class="literal">spec.security.dataPlane.mtls</code> to <code class="literal">true</code> in the <code class="literal">ServiceMeshControlPlane</code> resource. The Operator creates the required resources.
					</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
spec:
  version: v2.4
  security:
    dataPlane:
      mtls: true</pre><p>
						You can also enable mTLS by using the OpenShift Container Platform web console.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the web console.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Project</strong></span> menu and select the project where you installed the Service Mesh control plane, for example <span class="strong strong"><strong>istio-system</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Service Mesh Control Plane</strong></span> under <span class="strong strong"><strong>Provided APIs</strong></span>.
							</li><li class="listitem">
								Click the name of your <code class="literal">ServiceMeshControlPlane</code> resource, for example, <code class="literal">basic</code>.
							</li><li class="listitem">
								On the <span class="strong strong"><strong>Details</strong></span> page, click the toggle in the <span class="strong strong"><strong>Security</strong></span> section for <span class="strong strong"><strong>Data Plane Security</strong></span>.
							</li></ol></div><section class="section" id="ossm-security-mtls-sidecars-incoming-services_ossm-security"><div class="titlepage"><div><div><h5 class="title">1.13.1.1.1. Configuring sidecars for incoming connections for specific services</h5></div></div></div><p>
							You can also configure mTLS for individual services by creating a policy.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Create a YAML file using the following example.
								</p><div class="formalpara"><p class="title"><strong>PeerAuthentication Policy example policy.yaml</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: default
  namespace: &lt;namespace&gt;
spec:
  mtls:
    mode: STRICT</pre>

									</p></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
											Replace <code class="literal">&lt;namespace&gt;</code> with the namespace where the service is located.
										</li></ol></div></li><li class="listitem"><p class="simpara">
									Run the following command to create the resource in the namespace where the service is located. It must match the <code class="literal">namespace</code> field in the Policy resource you just created.
								</p><pre class="programlisting language-terminal">$ oc create -n &lt;namespace&gt; -f &lt;policy.yaml&gt;</pre></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								If you are not using automatic mTLS and you are setting <code class="literal">PeerAuthentication</code> to STRICT, you must create a <code class="literal">DestinationRule</code> resource for your service.
							</p></div></div></section><section class="section" id="ossm-security-mtls-sidecars-outgoing_ossm-security"><div class="titlepage"><div><div><h5 class="title">1.13.1.1.2. Configuring sidecars for outgoing connections</h5></div></div></div><p>
							Create a destination rule to configure Service Mesh to use mTLS when sending requests to other services in the mesh.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Create a YAML file using the following example.
								</p><div class="formalpara"><p class="title"><strong>DestinationRule example destination-rule.yaml</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: DestinationRule
metadata:
  name: default
  namespace: &lt;namespace&gt;
spec:
  host: "*.&lt;namespace&gt;.svc.cluster.local"
  trafficPolicy:
   tls:
    mode: ISTIO_MUTUAL</pre>

									</p></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
											Replace <code class="literal">&lt;namespace&gt;</code> with the namespace where the service is located.
										</li></ol></div></li><li class="listitem"><p class="simpara">
									Run the following command to create the resource in the namespace where the service is located. It must match the <code class="literal">namespace</code> field in the <code class="literal">DestinationRule</code> resource you just created.
								</p><pre class="programlisting language-terminal">$ oc create -n &lt;namespace&gt; -f &lt;destination-rule.yaml&gt;</pre></li></ol></div></section><section class="section" id="ossm-security-min-max-tls_ossm-security"><div class="titlepage"><div><div><h5 class="title">1.13.1.1.3. Setting the minimum and maximum protocol versions</h5></div></div></div><p>
							If your environment has specific requirements for encrypted traffic in your service mesh, you can control the cryptographic functions that are allowed by setting the <code class="literal">spec.security.controlPlane.tls.minProtocolVersion</code> or <code class="literal">spec.security.controlPlane.tls.maxProtocolVersion</code> in your <code class="literal">ServiceMeshControlPlane</code> resource. Those values, configured in your Service Mesh control plane resource, define the minimum and maximum TLS version used by mesh components when communicating securely over TLS.
						</p><p>
							The default is <code class="literal">TLS_AUTO</code> and does not specify a version of TLS.
						</p><div class="table" id="idm140663672713264"><p class="title"><strong>Table 1.5. Valid values</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663660171200" scope="col">Value</th><th align="left" valign="top" id="idm140663660170112" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663660171200"> <p>
											<code class="literal">TLS_AUTO</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663660170112"> <p>
											default
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663660171200"> <p>
											<code class="literal">TLSv1_0</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663660170112"> <p>
											TLS version 1.0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663660171200"> <p>
											<code class="literal">TLSv1_1</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663660170112"> <p>
											TLS version 1.1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663660171200"> <p>
											<code class="literal">TLSv1_2</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663660170112"> <p>
											TLS version 1.2
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663660171200"> <p>
											<code class="literal">TLSv1_3</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663660170112"> <p>
											TLS version 1.3
										</p>
										 </td></tr></tbody></table></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									Log in to the web console.
								</li><li class="listitem">
									Click the <span class="strong strong"><strong>Project</strong></span> menu and select the project where you installed the Service Mesh control plane, for example <span class="strong strong"><strong>istio-system</strong></span>.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Service Mesh Control Plane</strong></span> under <span class="strong strong"><strong>Provided APIs</strong></span>.
								</li><li class="listitem">
									Click the name of your <code class="literal">ServiceMeshControlPlane</code> resource, for example, <code class="literal">basic</code>.
								</li><li class="listitem">
									Click the <span class="strong strong"><strong>YAML</strong></span> tab.
								</li><li class="listitem"><p class="simpara">
									Insert the following code snippet in the YAML editor. Replace the value in the <code class="literal">minProtocolVersion</code> with the TLS version value. In this example, the minimum TLS version is set to <code class="literal">TLSv1_2</code>.
								</p><div class="formalpara"><p class="title"><strong>ServiceMeshControlPlane snippet</strong></p><p>
										
<pre class="programlisting language-yaml">kind: ServiceMeshControlPlane
spec:
  security:
    controlPlane:
      tls:
        minProtocolVersion: TLSv1_2</pre>

									</p></div></li><li class="listitem">
									Click <span class="strong strong"><strong>Save</strong></span>.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Refresh</strong></span> to verify that the changes updated correctly.
								</li></ol></div></section></section><section class="section" id="ossm-validating-sidecar_ossm-security"><div class="titlepage"><div><div><h4 class="title">1.13.1.2. Validating encryption with Kiali</h4></div></div></div><p>
						The Kiali console offers several ways to validate whether or not your applications, services, and workloads have mTLS encryption enabled.
					</p><div class="figure" id="idm140663646767136"><p class="title"><strong>Figure 1.5. Masthead icon mesh-wide mTLS enabled</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/d36101afefb618f85c2e7cc2b0db104a/ossm-kiali-masthead-mtls-enabled.png" alt="mTLS enabled"/></div></div></div><p>
						At the right side of the masthead, Kiali shows a lock icon when the mesh has strictly enabled mTLS for the whole service mesh. It means that all communications in the mesh use mTLS.
					</p><div class="figure" id="idm140663673299600"><p class="title"><strong>Figure 1.6. Masthead icon mesh-wide mTLS partially enabled</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/fec43ee345427929dedb0ba5edc31c3d/ossm-kiali-masthead-mtls-partial.png" alt="mTLS partially enabled"/></div></div></div><p>
						Kiali displays a hollow lock icon when either the mesh is configured in <code class="literal">PERMISSIVE</code> mode or there is a error in the mesh-wide mTLS configuration.
					</p><div class="figure" id="idm140663673294656"><p class="title"><strong>Figure 1.7. Security badge</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/a1e3c6682f7fd5de7e8c650c569be46d/ossm-kiali-graph-badge-security.png" alt="Security badge"/></div></div></div><p>
						The <span class="strong strong"><strong>Graph</strong></span> page has the option to display a <span class="strong strong"><strong>Security</strong></span> badge on the graph edges to indicate that mTLS is enabled. To enable security badges on the graph, from the <span class="strong strong"><strong>Display</strong></span> menu, under <span class="strong strong"><strong>Show Badges</strong></span>, select the <span class="strong strong"><strong>Security</strong></span> checkbox. When an edge shows a lock icon, it means at least one request with mTLS enabled is present. In case there are both mTLS and non-mTLS requests, the side-panel will show the percentage of requests that use mTLS.
					</p><p>
						The <span class="strong strong"><strong>Applications Detail Overview</strong></span> page displays a <span class="strong strong"><strong>Security</strong></span> icon on the graph edges where at least one request with mTLS enabled is present.
					</p><p>
						The <span class="strong strong"><strong>Workloads Detail Overview</strong></span> page displays a <span class="strong strong"><strong>Security</strong></span> icon on the graph edges where at least one request with mTLS enabled is present.
					</p><p>
						The <span class="strong strong"><strong>Services Detail Overview</strong></span> page displays a <span class="strong strong"><strong>Security</strong></span> icon on the graph edges where at least one request with mTLS enabled is present. Also note that Kiali displays a lock icon in the <span class="strong strong"><strong>Network</strong></span> section next to ports that are configured for mTLS.
					</p></section></section><section class="section" id="ossm-vs-istio_ossm-security"><div class="titlepage"><div><div><h3 class="title">1.13.2. Configuring Role Based Access Control (RBAC)</h3></div></div></div><p>
					Role-based access control (RBAC) objects determine whether a user or service is allowed to perform a given action within a project. You can define mesh-, namespace-, and workload-wide access control for your workloads in the mesh.
				</p><p>
					To configure RBAC, create an <code class="literal">AuthorizationPolicy</code> resource in the namespace for which you are configuring access. If you are configuring mesh-wide access, use the project where you installed the Service Mesh control plane, for example <code class="literal">istio-system</code>.
				</p><p>
					For example, with RBAC, you can create policies that:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Configure intra-project communication.
						</li><li class="listitem">
							Allow or deny full access to all workloads in the default namespace.
						</li><li class="listitem">
							Allow or deny ingress gateway access.
						</li><li class="listitem">
							Require a token for access.
						</li></ul></div><p>
					An authorization policy includes a selector, an action, and a list of rules:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">selector</code> field specifies the target of the policy.
						</li><li class="listitem">
							The <code class="literal">action</code> field specifies whether to allow or deny the request.
						</li><li class="listitem"><p class="simpara">
							The <code class="literal">rules</code> field specifies when to trigger the action.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									The <code class="literal">from</code> field specifies constraints on the request origin.
								</li><li class="listitem">
									The <code class="literal">to</code> field specifies constraints on request target and parameters.
								</li><li class="listitem">
									The <code class="literal">when</code> field specifies additional conditions that to apply the rule.
								</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create your <code class="literal">AuthorizationPolicy</code> resource. The following example shows a resource that updates the ingress-policy <code class="literal">AuthorizationPolicy</code> to deny an IP address from accessing the ingress gateway.
						</p><pre class="programlisting language-yaml">apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: ingress-policy
  namespace: istio-system
spec:
  selector:
    matchLabels:
      app: istio-ingressgateway
  action: DENY
  rules:
  - from:
    - source:
      ipBlocks: ["1.2.3.4"]</pre></li><li class="listitem"><p class="simpara">
							Run the following command after you write your resource to create your resource in your namespace. The namespace must match your <code class="literal">metadata.namespace</code> field in your <code class="literal">AuthorizationPolicy</code> resource.
						</p><pre class="programlisting language-terminal">$ oc create -n istio-system -f &lt;filename&gt;</pre></li></ol></div><div class="formalpara"><p class="title"><strong>Next steps</strong></p><p>
						Consider the following examples for other common configurations.
					</p></div><section class="section" id="configure-intra-project-communication"><div class="titlepage"><div><div><h4 class="title">1.13.2.1. Configure intra-project communication</h4></div></div></div><p>
						You can use <code class="literal">AuthorizationPolicy</code> to configure your Service Mesh control plane to allow or deny the traffic communicating with your mesh or services in your mesh.
					</p><section class="section" id="restrict-access-to-services-outside-a-namespace"><div class="titlepage"><div><div><h5 class="title">1.13.2.1.1. Restrict access to services outside a namespace</h5></div></div></div><p>
							You can deny requests from any source that is not in the <code class="literal">bookinfo</code> namespace with the following <code class="literal">AuthorizationPolicy</code> resource example.
						</p><pre class="programlisting language-yaml">apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
 name: httpbin-deny
 namespace: bookinfo
spec:
 selector:
   matchLabels:
     app: httpbin
     version: v1
 action: DENY
 rules:
 - from:
   - source:
       notNamespaces: ["bookinfo"]</pre></section><section class="section" id="creating-allow-all-and-default-deny-all-authorization-policies"><div class="titlepage"><div><div><h5 class="title">1.13.2.1.2. Creating allow-all and default deny-all authorization policies</h5></div></div></div><p>
							The following example shows an allow-all authorization policy that allows full access to all workloads in the <code class="literal">bookinfo</code> namespace.
						</p><pre class="programlisting language-yaml">apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: allow-all
  namespace: bookinfo
spec:
  action: ALLOW
  rules:
  - {}</pre><p>
							The following example shows a policy that denies any access to all workloads in the <code class="literal">bookinfo</code> namespace.
						</p><pre class="programlisting language-yaml">apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: deny-all
  namespace: bookinfo
spec:
  {}</pre></section></section><section class="section" id="allow-or-deny-access-to-the-ingress-gateway"><div class="titlepage"><div><div><h4 class="title">1.13.2.2. Allow or deny access to the ingress gateway</h4></div></div></div><p>
						You can set an authorization policy to add allow or deny lists based on IP addresses.
					</p><pre class="programlisting language-yaml">apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: ingress-policy
  namespace: istio-system
spec:
  selector:
    matchLabels:
      app: istio-ingressgateway
  action: ALLOW
  rules:
  - from:
    - source:
       ipBlocks: ["1.2.3.4", "5.6.7.0/24"]</pre></section><section class="section" id="restrict-access-with-json-web-token"><div class="titlepage"><div><div><h4 class="title">1.13.2.3. Restrict access with JSON Web Token</h4></div></div></div><p>
						You can restrict what can access your mesh with a JSON Web Token (JWT). After authentication, a user or service can access routes, services that are associated with that token.
					</p><p>
						Create a <code class="literal">RequestAuthentication</code> resource, which defines the authentication methods that are supported by a workload. The following example accepts a JWT issued by <code class="literal"><a class="link" href="http://localhost:8080/auth/realms/master">http://localhost:8080/auth/realms/master</a></code>.
					</p><pre class="programlisting language-yaml">apiVersion: "security.istio.io/v1beta1"
kind: "RequestAuthentication"
metadata:
  name: "jwt-example"
  namespace: bookinfo
spec:
  selector:
    matchLabels:
      app: httpbin
  jwtRules:
  - issuer: "http://localhost:8080/auth/realms/master"
    jwksUri: "http://keycloak.default.svc:8080/auth/realms/master/protocol/openid-connect/certs"</pre><p>
						Then, create an <code class="literal">AuthorizationPolicy</code> resource in the same namespace to work with <code class="literal">RequestAuthentication</code> resource you created. The following example requires a JWT to be present in the <code class="literal">Authorization</code> header when sending a request to <code class="literal">httpbin</code> workloads.
					</p><pre class="programlisting language-yaml">apiVersion: "security.istio.io/v1beta1"
kind: "AuthorizationPolicy"
metadata:
  name: "frontend-ingress"
  namespace: bookinfo
spec:
  selector:
    matchLabels:
      app: httpbin
  action: DENY
  rules:
  - from:
    - source:
        notRequestPrincipals: ["*"]</pre></section></section><section class="section" id="ossm-security-cipher_ossm-security"><div class="titlepage"><div><div><h3 class="title">1.13.3. Configuring cipher suites and ECDH curves</h3></div></div></div><p>
					Cipher suites and Elliptic-curve Diffie–Hellman (ECDH curves) can help you secure your service mesh. You can define a comma separated list of cipher suites using <code class="literal">spec.security.controlplane.tls.cipherSuites</code> and ECDH curves using <code class="literal">spec.security.controlplane.tls.ecdhCurves</code> in your <code class="literal">ServiceMeshControlPlane</code> resource. If either of these attributes are empty, then the default values are used.
				</p><p>
					The <code class="literal">cipherSuites</code> setting is effective if your service mesh uses TLS 1.2 or earlier. It has no effect when negotiating with TLS 1.3.
				</p><p>
					Set your cipher suites in the comma separated list in order of priority. For example, <code class="literal">ecdhCurves: CurveP256, CurveP384</code> sets <code class="literal">CurveP256</code> as a higher priority than <code class="literal">CurveP384</code>.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						You must include either <code class="literal">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</code> or <code class="literal">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</code> when you configure the cipher suite. HTTP/2 support requires at least one of these cipher suites.
					</p></div></div><p>
					The supported cipher suites are:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256
						</li><li class="listitem">
							TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256
						</li><li class="listitem">
							TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
						</li><li class="listitem">
							TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
						</li><li class="listitem">
							TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
						</li><li class="listitem">
							TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
						</li><li class="listitem">
							TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256
						</li><li class="listitem">
							TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA
						</li><li class="listitem">
							TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256
						</li><li class="listitem">
							TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA
						</li><li class="listitem">
							TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA
						</li><li class="listitem">
							TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA
						</li><li class="listitem">
							TLS_RSA_WITH_AES_128_GCM_SHA256
						</li><li class="listitem">
							TLS_RSA_WITH_AES_256_GCM_SHA384
						</li><li class="listitem">
							TLS_RSA_WITH_AES_128_CBC_SHA256
						</li><li class="listitem">
							TLS_RSA_WITH_AES_128_CBC_SHA
						</li><li class="listitem">
							TLS_RSA_WITH_AES_256_CBC_SHA
						</li><li class="listitem">
							TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA
						</li><li class="listitem">
							TLS_RSA_WITH_3DES_EDE_CBC_SHA
						</li></ul></div><p>
					The supported ECDH Curves are:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							CurveP256
						</li><li class="listitem">
							CurveP384
						</li><li class="listitem">
							CurveP521
						</li><li class="listitem">
							X25519
						</li></ul></div></section><section class="section" id="ossm-cert-manage_ossm-security"><div class="titlepage"><div><div><h3 class="title">1.13.4. Adding an external certificate authority key and certificate</h3></div></div></div><p>
					By default, Red Hat OpenShift Service Mesh generates a self-signed root certificate and key and uses them to sign the workload certificates. You can also use the user-defined certificate and key to sign workload certificates with user-defined root certificate. This task demonstrates an example to plug certificates and key into Service Mesh.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Install Red Hat OpenShift Service Mesh with mutual TLS enabled to configure certificates.
						</li><li class="listitem">
							This example uses the certificates from the <a class="link" href="https://github.com/maistra/istio/tree/maistra-2.4/samples/certs">Maistra repository</a>. For production, use your own certificates from your certificate authority.
						</li><li class="listitem">
							Deploy the Bookinfo sample application to verify the results with these instructions.
						</li><li class="listitem">
							OpenSSL is required to verify certificates.
						</li></ul></div><section class="section" id="ossm-cert-manage-add-cert-key_ossm-security"><div class="titlepage"><div><div><h4 class="title">1.13.4.1. Adding an existing certificate and key</h4></div></div></div><p>
						To use an existing signing (CA) certificate and key, you must create a chain of trust file that includes the CA certificate, key, and root certificate. You must use the following exact file names for each of the corresponding certificates. The CA certificate is named <code class="literal">ca-cert.pem</code>, the key is <code class="literal">ca-key.pem</code>, and the root certificate, which signs <code class="literal">ca-cert.pem</code>, is named <code class="literal">root-cert.pem</code>. If your workload uses intermediate certificates, you must specify them in a <code class="literal">cert-chain.pem</code> file.
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Save the example certificates from the <a class="link" href="https://github.com/maistra/istio/tree/maistra-2.4/samples/certs">Maistra repository</a> locally and replace <code class="literal">&lt;path&gt;</code> with the path to your certificates.
							</li><li class="listitem"><p class="simpara">
								Create a secret named <code class="literal">cacert</code> that includes the input files <code class="literal">ca-cert.pem</code>, <code class="literal">ca-key.pem</code>, <code class="literal">root-cert.pem</code> and <code class="literal">cert-chain.pem</code>.
							</p><pre class="programlisting language-terminal">$ oc create secret generic cacerts -n istio-system --from-file=&lt;path&gt;/ca-cert.pem \
    --from-file=&lt;path&gt;/ca-key.pem --from-file=&lt;path&gt;/root-cert.pem \
    --from-file=&lt;path&gt;/cert-chain.pem</pre></li><li class="listitem"><p class="simpara">
								In the <code class="literal">ServiceMeshControlPlane</code> resource set <code class="literal">spec.security.dataPlane.mtls true</code> to <code class="literal">true</code> and configure the <code class="literal">certificateAuthority</code> field as shown in the following example. The default <code class="literal">rootCADir</code> is <code class="literal">/etc/cacerts</code>. You do not need to set the <code class="literal">privateKey</code> if the key and certs are mounted in the default location. Service Mesh reads the certificates and key from the secret-mount files.
							</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
spec:
  security:
    dataPlane:
      mtls: true
    certificateAuthority:
      type: Istiod
      istiod:
        type: PrivateKey
        privateKey:
          rootCADir: /etc/cacerts</pre></li><li class="listitem"><p class="simpara">
								After creating/changing/deleting the <code class="literal">cacert</code> secret, the Service Mesh control plane <code class="literal">istiod</code> and <code class="literal">gateway</code> pods must be restarted so the changes go into effect. Use the following command to restart the pods:
							</p><pre class="programlisting language-terminal">$ oc -n istio-system delete pods -l 'app in (istiod,istio-ingressgateway, istio-egressgateway)'</pre><p class="simpara">
								The Operator will automatically recreate the pods after they have been deleted.
							</p></li><li class="listitem"><p class="simpara">
								Restart the bookinfo application pods so that the sidecar proxies pick up the secret changes. Use the following command to restart the pods:
							</p><pre class="programlisting language-terminal">$ oc -n bookinfo delete pods --all</pre><p class="simpara">
								You should see output similar to the following:
							</p><pre class="programlisting language-terminal">pod "details-v1-6cd699df8c-j54nh" deleted
pod "productpage-v1-5ddcb4b84f-mtmf2" deleted
pod "ratings-v1-bdbcc68bc-kmng4" deleted
pod "reviews-v1-754ddd7b6f-lqhsv" deleted
pod "reviews-v2-675679877f-q67r2" deleted
pod "reviews-v3-79d7549c7-c2gjs" deleted</pre></li><li class="listitem"><p class="simpara">
								Verify that the pods were created and are ready with the following command:
							</p><pre class="programlisting language-terminal">$ oc get pods -n bookinfo</pre></li></ol></div></section><section class="section" id="ossm-cert-manage-verify-cert_ossm-security"><div class="titlepage"><div><div><h4 class="title">1.13.4.2. Verifying your certificates</h4></div></div></div><p>
						Use the Bookinfo sample application to verify that the workload certificates are signed by the certificates that were plugged into the CA. This process requires that you have <code class="literal">openssl</code> installed on your machine.
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To extract certificates from bookinfo workloads use the following command:
							</p><pre class="programlisting language-terminal">$ sleep 60
$ oc -n bookinfo exec "$(oc -n bookinfo get pod -l app=productpage -o jsonpath={.items..metadata.name})" -c istio-proxy -- openssl s_client -showcerts -connect details:9080 &gt; bookinfo-proxy-cert.txt
$ sed -n '/-----BEGIN CERTIFICATE-----/{:start /-----END CERTIFICATE-----/!{N;b start};/.*/p}' bookinfo-proxy-cert.txt &gt; certs.pem
$ awk 'BEGIN {counter=0;} /BEGIN CERT/{counter++} { print &gt; "proxy-cert-" counter ".pem"}' &lt; certs.pem</pre><p class="simpara">
								After running the command, you should have three files in your working directory: <code class="literal">proxy-cert-1.pem</code>, <code class="literal">proxy-cert-2.pem</code> and <code class="literal">proxy-cert-3.pem</code>.
							</p></li><li class="listitem"><p class="simpara">
								Verify that the root certificate is the same as the one specified by the administrator. Replace <code class="literal">&lt;path&gt;</code> with the path to your certificates.
							</p><pre class="programlisting language-terminal">$ openssl x509 -in &lt;path&gt;/root-cert.pem -text -noout &gt; /tmp/root-cert.crt.txt</pre><p class="simpara">
								Run the following syntax at the terminal window.
							</p><pre class="programlisting language-terminal">$ openssl x509 -in ./proxy-cert-3.pem -text -noout &gt; /tmp/pod-root-cert.crt.txt</pre><p class="simpara">
								Compare the certificates by running the following syntax at the terminal window.
							</p><pre class="programlisting language-terminal">$ diff -s /tmp/root-cert.crt.txt /tmp/pod-root-cert.crt.txt</pre><p class="simpara">
								You should see the following result: <code class="literal">Files /tmp/root-cert.crt.txt and /tmp/pod-root-cert.crt.txt are identical</code>
							</p></li><li class="listitem"><p class="simpara">
								Verify that the CA certificate is the same as the one specified by the administrator. Replace <code class="literal">&lt;path&gt;</code> with the path to your certificates.
							</p><pre class="programlisting language-terminal">$ openssl x509 -in &lt;path&gt;/ca-cert.pem -text -noout &gt; /tmp/ca-cert.crt.txt</pre><p class="simpara">
								Run the following syntax at the terminal window.
							</p><pre class="programlisting language-terminal">$ openssl x509 -in ./proxy-cert-2.pem -text -noout &gt; /tmp/pod-cert-chain-ca.crt.txt</pre><p class="simpara">
								Compare the certificates by running the following syntax at the terminal window.
							</p><pre class="programlisting language-terminal">$ diff -s /tmp/ca-cert.crt.txt /tmp/pod-cert-chain-ca.crt.txt</pre><p class="simpara">
								You should see the following result: <code class="literal">Files /tmp/ca-cert.crt.txt and /tmp/pod-cert-chain-ca.crt.txt are identical.</code>
							</p></li><li class="listitem"><p class="simpara">
								Verify the certificate chain from the root certificate to the workload certificate. Replace <code class="literal">&lt;path&gt;</code> with the path to your certificates.
							</p><pre class="programlisting language-terminal">$ openssl verify -CAfile &lt;(cat &lt;path&gt;/ca-cert.pem &lt;path&gt;/root-cert.pem) ./proxy-cert-1.pem</pre><p class="simpara">
								You should see the following result: <code class="literal">./proxy-cert-1.pem: OK</code>
							</p></li></ol></div></section><section class="section" id="ossm-cert-cleanup_ossm-security"><div class="titlepage"><div><div><h4 class="title">1.13.4.3. Removing the certificates</h4></div></div></div><p>
						To remove the certificates you added, follow these steps.
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Remove the secret <code class="literal">cacerts</code>. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
							</p><pre class="programlisting language-terminal">$ oc delete secret cacerts -n istio-system</pre></li><li class="listitem"><p class="simpara">
								Redeploy Service Mesh with a self-signed root certificate in the <code class="literal">ServiceMeshControlPlane</code> resource.
							</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
spec:
  security:
    dataPlane:
      mtls: true</pre></li></ol></div></section></section><section class="section" id="ossm-cert-manager-integration-istio_ossm-security"><div class="titlepage"><div><div><h3 class="title">1.13.5. About integrating Service Mesh with cert-manager and istio-csr</h3></div></div></div><p>
					The cert-manager tool is a solution for X.509 certificate management on Kubernetes. It delivers a unified API to integrate applications with private or public key infrastructure (PKI), such as Vault, Google Cloud Certificate Authority Service, Let’s Encrypt, and other providers.
				</p><p>
					The cert-manager tool ensures the certificates are valid and up-to-date by attempting to renew certificates at a configured time before they expire.
				</p><p>
					For Istio users, cert-manager also provides integration with <code class="literal">istio-csr</code>, which is a certificate authority (CA) server that handles certificate signing requests (CSR) from Istio proxies. The server then delegates signing to cert-manager, which forwards CSRs to the configured CA server.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Red Hat provides support for integrating with <code class="literal">istio-csr</code> and cert-manager. Red Hat does not provide direct support for the <code class="literal">istio-csr</code> or the community cert-manager components. The use of community cert-manager shown here is for demonstration purposes only.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							One of these versions of cert-manager:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									cert-manager Operator for Red Hat OpenShift 1.10 or later
								</li><li class="listitem">
									community cert-manager Operator 1.11 or later
								</li><li class="listitem">
									cert-manager 1.11 or later
								</li></ul></div></li><li class="listitem">
							OpenShift Service Mesh Operator 2.4 or later
						</li><li class="listitem">
							<code class="literal">istio-csr</code> 0.6.0 or later
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						To avoid creating config maps in all namespaces when the <code class="literal">istio-csr</code> server is installed with the <code class="literal">jetstack/cert-manager-istio-csr</code> Helm chart, use the following setting: <code class="literal">app.controller.configmapNamespaceSelector: "maistra.io/member-of: &lt;istio-namespace&gt;"</code> in the <code class="literal">istio-csr.yaml</code> file.
					</p></div></div><section class="section" id="ossm-cert-manager-installation_ossm-security"><div class="titlepage"><div><div><h4 class="title">1.13.5.1. Installing cert-manager</h4></div></div></div><p>
						You can install the <code class="literal">cert-manager</code> tool to manage the lifecycle of TLS certificates and ensure that they are valid and up-to-date. If you are running Istio in your environment, you can also install the <code class="literal">istio-csr</code> certificate authority (CA) server, which handles certificate signing requests (CSR) from Istio proxies. The <code class="literal">istio-csr</code> CA delegates signing to the <code class="literal">cert-manager</code> tool, which delegates to the configured CA.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create the root cluster issuer:
							</p><pre class="programlisting language-terminal">$ oc apply -f cluster-issuer.yaml</pre><pre class="programlisting language-terminal">$ oc apply -n istio-system -f istio-ca.yaml</pre><div class="formalpara"><p class="title"><strong>Example <code class="literal">cluster-issuer.yaml</code></strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: cert-manager.io/v1
kind: Issuer
metadata:
  name: selfsigned-root-issuer
  namespace: cert-manager
spec:
  selfSigned: {}
---
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: root-ca
  namespace: cert-manager
spec:
  isCA: true
  duration: 21600h # 900d
  secretName: root-ca
  commonName: root-ca.my-company.net
  subject:
    organizations:
    - my-company.net
  issuerRef:
    name: selfsigned-root-issuer
    kind: Issuer
    group: cert-manager.io
---
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: root-ca
spec:
  ca:
    secretName: root-ca</pre>

								</p></div><div class="formalpara"><p class="title"><strong>Example <code class="literal">istio-ca.yaml</code></strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: istio-ca
  namespace: istio-system
spec:
  isCA: true
  duration: 21600h
  secretName: istio-ca
  commonName: istio-ca.my-company.net
  subject:
    organizations:
    - my-company.net
  issuerRef:
    name: root-ca
    kind: ClusterIssuer
    group: cert-manager.io
---
apiVersion: cert-manager.io/v1
kind: Issuer
metadata:
  name: istio-ca
  namespace: istio-system
spec:
  ca:
    secretName: istio-ca</pre>

								</p></div><div class="informalexample"><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The namespace of the <code class="literal">selfsigned-root-issuer</code> issuer and <code class="literal">root-ca</code> certificate is <code class="literal">cert-manager</code> because <code class="literal">root-ca</code> is a cluster issuer, so the cert-manager looks for a referenced secret in its own namespace. Its own namespace is <code class="literal">cert-manager</code> in the case of the cert-manager Operator for Red Hat OpenShift.
								</p></div></div></div></li><li class="listitem"><p class="simpara">
								Install <code class="literal">istio-csr</code>:
							</p><pre class="programlisting language-terminal">$ helm install istio-csr jetstack/cert-manager-istio-csr \
    -n istio-system \
    -f deploy/examples/cert-manager/istio-csr/istio-csr.yaml</pre><div class="formalpara"><p class="title"><strong>Example <code class="literal">istio-csr.yaml</code></strong></p><p>
									
<pre class="programlisting language-yaml">replicaCount: 2

image:
  repository: quay.io/jetstack/cert-manager-istio-csr
  tag: v0.6.0
  pullSecretName: ""

app:
  certmanager:
    namespace: istio-system
    issuer:
      group: cert-manager.io
      kind: Issuer
      name: istio-ca

  controller:
    configmapNamespaceSelector: "maistra.io/member-of=istio-system"
    leaderElectionNamespace: istio-system

  istio:
    namespace: istio-system
    revisions: ["basic"]

  server:
    maxCertificateDuration: 5m

  tls:
    certificateDNSNames:
    # This DNS name must be set in the SMCP spec.security.certificateAuthority.cert-manager.address
    - cert-manager-istio-csr.istio-system.svc</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Deploy SMCP:
							</p><pre class="programlisting language-terminal">$ oc apply -f mesh.yaml -n istio-system</pre><div class="formalpara"><p class="title"><strong>Example <code class="literal">mesh.yaml</code></strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
spec:
  addons:
    grafana:
      enabled: false
    kiali:
      enabled: false
    prometheus:
      enabled: false
  proxy:
    accessLogging:
      file:
        name: /dev/stdout
  security:
    certificateAuthority:
      cert-manager:
        address: cert-manager-istio-csr.istio-system.svc:443
      type: cert-manager
    dataPlane:
      mtls: true
    identity:
      type: ThirdParty
  tracing:
    type: None
---
apiVersion: maistra.io/v1
kind: ServiceMeshMemberRoll
metadata:
  name: default
spec:
  members:
  - httpbin
  - sleep</pre>

								</p></div></li></ol></div><div class="informalexample"><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							<code class="literal">security.identity.type: ThirdParty</code> must be set when <code class="literal">security.certificateAuthority.type: cert-manager</code> is configured.
						</p></div></div></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
							Use the sample <code class="literal">httpbin</code> service and <code class="literal">sleep</code> app to check mTLS traffic from ingress gateways and verify that the <code class="literal">cert-manager</code> tool is installed.
						</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Deploy the HTTP and <code class="literal">sleep</code> apps:
							</p><pre class="programlisting language-terminal">$ oc new-project &lt;namespace&gt;</pre><pre class="programlisting language-terminal">$ oc apply -f https://raw.githubusercontent.com/maistra/istio/maistra-2.4/samples/httpbin/httpbin.yaml</pre><pre class="programlisting language-terminal">$ oc apply -f https://raw.githubusercontent.com/maistra/istio/maistra-2.4/samples/sleep/sleep.yaml</pre></li><li class="listitem"><p class="simpara">
								Verify that <code class="literal">sleep</code> can access the <code class="literal">httpbin</code> service:
							</p><pre class="programlisting language-terminal">$ oc exec "$(oc get pod -l app=sleep -n &lt;namespace&gt; \
   -o jsonpath={.items..metadata.name})" -c sleep -n &lt;namespace&gt; -- \
   curl http://httpbin.&lt;namespace&gt;:8000/ip -s -o /dev/null \
   -w "%{http_code}\n"</pre><div class="formalpara"><p class="title"><strong>Example output:</strong></p><p>
									
<pre class="programlisting language-terminal">200</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Check mTLS traffic from the ingress gateway to the <code class="literal">httpbin</code> service:
							</p><pre class="programlisting language-terminal">$ oc apply -n &lt;namespace&gt; -f https://raw.githubusercontent.com/maistra/istio/maistra-2.4/samples/httpbin/httpbin-gateway.yaml</pre></li><li class="listitem"><p class="simpara">
								Get the <code class="literal">istio-ingressgateway</code> route:
							</p><pre class="programlisting language-terminal">INGRESS_HOST=$(oc -n istio-system get routes istio-ingressgateway -o jsonpath='{.spec.host}')</pre></li><li class="listitem"><p class="simpara">
								Verify mTLS traffic from the ingress gateway to the <code class="literal">httpbin</code> service:
							</p><pre class="programlisting language-terminal">$ curl -s -I http://$INGRESS_HOST/headers -o /dev/null -w "%{http_code}" -s</pre></li></ol></div></section></section><section class="section _additional-resources" id="additional-resources_cert-manager-operator-red-hat-openshift"><div class="titlepage"><div><div><h3 class="title">1.13.6. Additional resources</h3></div></div></div><p>
					For information about how to install the cert-manager Operator for OpenShift Container Platform, see: <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/security_and_compliance/#installing-the-cert-manager-operator-for-red-hat-openshift">Installing the cert-manager Operator for Red Hat OpenShift</a>.
				</p></section></section><section class="section" id="ossm-routing-traffic"><div class="titlepage"><div><div><h2 class="title">1.14. Managing traffic in your service mesh</h2></div></div></div><p>
				Using Red Hat OpenShift Service Mesh, you can control the flow of traffic and API calls between services. Some services in your service mesh might need to communicate within the mesh and others might need to be hidden. You can manage the traffic to hide specific backend services, expose services, create testing or versioning deployments, or add a security layer on a set of services.
			</p><section class="section" id="ossm-gateways_traffic-management"><div class="titlepage"><div><div><h3 class="title">1.14.1. Using gateways</h3></div></div></div><p>
					You can use a gateway to manage inbound and outbound traffic for your mesh to specify which traffic you want to enter or leave the mesh. Gateway configurations are applied to standalone Envoy proxies that are running at the edge of the mesh, rather than sidecar Envoy proxies running alongside your service workloads.
				</p><p>
					Unlike other mechanisms for controlling traffic entering your systems, such as the Kubernetes Ingress APIs, Red Hat OpenShift Service Mesh gateways use the full power and flexibility of traffic routing.
				</p><p>
					The Red Hat OpenShift Service Mesh gateway resource can use layer 4-6 load balancing properties, such as ports, to expose and configure Red Hat OpenShift Service Mesh TLS settings. Instead of adding application-layer traffic routing (L7) to the same API resource, you can bind a regular Red Hat OpenShift Service Mesh virtual service to the gateway and manage gateway traffic like any other data plane traffic in a service mesh.
				</p><p>
					Gateways are primarily used to manage ingress traffic, but you can also configure egress gateways. An egress gateway lets you configure a dedicated exit node for the traffic leaving the mesh. This enables you to limit which services have access to external networks, which adds security control to your service mesh. You can also use a gateway to configure a purely internal proxy.
				</p><div class="formalpara"><p class="title"><strong>Gateway example</strong></p><p>
						A gateway resource describes a load balancer operating at the edge of the mesh receiving incoming or outgoing HTTP/TCP connections. The specification describes a set of ports that should be exposed, the type of protocol to use, SNI configuration for the load balancer, and so on.
					</p></div><p>
					The following example shows a sample gateway configuration for external HTTPS ingress traffic:
				</p><pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: Gateway
metadata:
  name: ext-host-gwy
spec:
  selector:
    istio: ingressgateway # use istio default controller
  servers:
  - port:
      number: 443
      name: https
      protocol: HTTPS
    hosts:
    - ext-host.example.com
    tls:
      mode: SIMPLE
      serverCertificate: /tmp/tls.crt
      privateKey: /tmp/tls.key</pre><p>
					This gateway configuration lets HTTPS traffic from <code class="literal">ext-host.example.com</code> into the mesh on port 443, but doesn’t specify any routing for the traffic.
				</p><p>
					To specify routing and for the gateway to work as intended, you must also bind the gateway to a virtual service. You do this using the virtual service’s gateways field, as shown in the following example:
				</p><pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: virtual-svc
spec:
  hosts:
  - ext-host.example.com
  gateways:
    - ext-host-gwy</pre><p>
					You can then configure the virtual service with routing rules for the external traffic.
				</p><section class="section" id="ossm-automatic-gateway-injection_traffic-management"><div class="titlepage"><div><div><h4 class="title">1.14.1.1. Enabling gateway injection</h4></div></div></div><p>
						Gateway configurations apply to standalone Envoy proxies running at the edge of the mesh, rather than sidecar Envoy proxies running alongside your service workloads. Because gateways are Envoy proxies, you can configure Service Mesh to inject gateways automatically, similar to how you can inject sidecars.
					</p><p>
						Using automatic injection for gateways, you can deploy and manage gateways independent from the <code class="literal">ServiceMeshControlPlane</code> resource and manage the gateways with your user applications. Using auto-injection for gateway deployments gives developers full control over the gateway deployment while simplifying operations. When a new upgrade is available, or a configuration has changed, you restart the gateway pods to update them. Doing so makes the experience of operating a gateway deployment the same as operating sidecars.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Injection is disabled by default for the <code class="literal">ServiceMeshControlPlane</code> namespace, for example the <code class="literal">istio-system</code> namespace. As a security best practice, deploy gateways in a different namespace from the control plane.
						</p></div></div></section><section class="section" id="ossm-deploying-automatic-gateway-injection_traffic-management"><div class="titlepage"><div><div><h4 class="title">1.14.1.2. Deploying automatic gateway injection</h4></div></div></div><p>
						When deploying a gateway, you must opt-in to injection by adding an injection label or annotation to the gateway <code class="literal">deployment</code> object. The following example deploys a gateway.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The namespace must be a member of the mesh by defining it in the <code class="literal">ServiceMeshMemberRoll</code> or by creating a <code class="literal">ServiceMeshMember</code> resource.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Set a unique label for the Istio ingress gateway. This setting is required to ensure that the gateway can select the workload. This example uses <code class="literal">ingressgateway</code> as the name of the gateway.
							</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Service
metadata:
  name: istio-ingressgateway
  namespace: istio-ingress
spec:
  type: ClusterIP
  selector:
    istio: ingressgateway
  ports:
  - name: http2
    port: 80
    targetPort: 8080
  - name: https
    port: 443
    targetPort: 8443
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: istio-ingressgateway
  namespace: istio-ingress
spec:
  selector:
    matchLabels:
      istio: ingressgateway
  template:
    metadata:
      annotations:
        inject.istio.io/templates: gateway
      labels:
        istio: ingressgateway
        sidecar.istio.io/inject: "true" <span id="CO14-1"><!--Empty--></span><span class="callout">1</span>
    spec:
      containers:
      - name: istio-proxy
        image: auto <span id="CO14-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO14-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Enable gateway injection by setting the <code class="literal">sidecar.istio.io/inject</code> field to <code class="literal">"true"</code>.
									</div></dd><dt><a href="#CO14-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Set the <code class="literal">image</code> field to <code class="literal">auto</code> so that the image automatically updates each time the pod starts.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Set up roles to allow reading credentials for TLS.
							</p><pre class="programlisting language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: istio-ingressgateway-sds
  namespace: istio-ingress
rules:
  - apiGroups: [""]
    resources: ["secrets"]
    verbs: ["get", "watch", "list"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: istio-ingressgateway-sds
  namespace: istio-ingress
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: istio-ingressgateway-sds
subjects:
- kind: ServiceAccount
  name: default</pre></li><li class="listitem"><p class="simpara">
								Grant access to the new gateway from outside the cluster, which is required whenever <code class="literal">spec.security.manageNetworkPolicy</code> is set to <code class="literal">true</code>.
							</p><pre class="programlisting language-yaml">apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: gatewayingress
  namespace: istio-ingress
spec:
  podSelector:
    matchLabels:
      istio: ingressgateway
  ingress:
    - {}
  policyTypes:
  - Ingress</pre></li><li class="listitem"><p class="simpara">
								Automatically scale the pod when ingress traffic increases. This example sets the minimum replicas to <code class="literal">2</code> and the maximum replicas to <code class="literal">5</code>. It also creates another replica when utilization reaches 80%.
							</p><pre class="programlisting language-yaml">apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  labels:
    istio: ingressgateway
    release: istio
  name: ingressgatewayhpa
  namespace: istio-ingress
spec:
  maxReplicas: 5
  metrics:
  - resource:
      name: cpu
      target:
        averageUtilization: 80
        type: Utilization
    type: Resource
  minReplicas: 2
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: istio-ingressgateway</pre></li><li class="listitem"><p class="simpara">
								Specify the minimum number of pods that must be running on the node. This example ensures one replica is running if a pod gets restarted on a new node.
							</p><pre class="programlisting language-yaml">apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  labels:
    istio: ingressgateway
    release: istio
  name: ingressgatewaypdb
  namespace: istio-ingress
spec:
  minAvailable: 1
  selector:
    matchLabels:
      istio: ingressgateway</pre></li></ol></div></section><section class="section" id="ossm-routing-ingress_traffic-management"><div class="titlepage"><div><div><h4 class="title">1.14.1.3. Managing ingress traffic</h4></div></div></div><p>
						In Red Hat OpenShift Service Mesh, the Ingress Gateway enables features such as monitoring, security, and route rules to apply to traffic that enters the cluster. Use a Service Mesh gateway to expose a service outside of the service mesh.
					</p><section class="section" id="ossm-routing-determine-ingress_traffic-management"><div class="titlepage"><div><div><h5 class="title">1.14.1.3.1. Determining the ingress IP and ports</h5></div></div></div><p>
							Ingress configuration differs depending on if your environment supports an external load balancer. An external load balancer is set in the ingress IP and ports for the cluster. To determine if your cluster’s IP and ports are configured for external load balancers, run the following command. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
						</p><pre class="programlisting language-terminal">$ oc get svc istio-ingressgateway -n istio-system</pre><p>
							That command returns the <code class="literal">NAME</code>, <code class="literal">TYPE</code>, <code class="literal">CLUSTER-IP</code>, <code class="literal">EXTERNAL-IP</code>, <code class="literal">PORT(S)</code>, and <code class="literal">AGE</code> of each item in your namespace.
						</p><p>
							If the <code class="literal">EXTERNAL-IP</code> value is set, your environment has an external load balancer that you can use for the ingress gateway.
						</p><p>
							If the <code class="literal">EXTERNAL-IP</code> value is <code class="literal">&lt;none&gt;</code>, or perpetually <code class="literal">&lt;pending&gt;</code>, your environment does not provide an external load balancer for the ingress gateway. You can access the gateway using the service’s <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#configuring-the-node-port-service-range">node port</a>.
						</p><section class="section" id="ossm-routing-config-ig-lb_traffic-management"><div class="titlepage"><div><div><h6 class="title">1.14.1.3.1.1. Determining ingress ports with a load balancer</h6></div></div></div><p>
								Follow these instructions if your environment has an external load balancer.
							</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
										Run the following command to set the ingress IP and ports. This command sets a variable in your terminal.
									</p><pre class="programlisting language-terminal">$ export INGRESS_HOST=$(oc -n istio-system get service istio-ingressgateway -o jsonpath='{.status.loadBalancer.ingress[0].ip}')</pre></li><li class="listitem"><p class="simpara">
										Run the following command to set the ingress port.
									</p><pre class="programlisting language-terminal">$ export INGRESS_PORT=$(oc -n istio-system get service istio-ingressgateway -o jsonpath='{.spec.ports[?(@.name=="http2")].port}')</pre></li><li class="listitem"><p class="simpara">
										Run the following command to set the secure ingress port.
									</p><pre class="programlisting language-terminal">$ export SECURE_INGRESS_PORT=$(oc -n istio-system get service istio-ingressgateway -o jsonpath='{.spec.ports[?(@.name=="https")].port}')</pre></li><li class="listitem"><p class="simpara">
										Run the following command to set the TCP ingress port.
									</p><pre class="programlisting language-terminal">$ export TCP_INGRESS_PORT=$(kubectl -n istio-system get service istio-ingressgateway -o jsonpath='{.spec.ports[?(@.name=="tcp")].port}')</pre></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									In some environments, the load balancer may be exposed using a hostname instead of an IP address. For that case, the ingress gateway’s <code class="literal">EXTERNAL-IP</code> value is not an IP address. Instead, it’s a hostname, and the previous command fails to set the <code class="literal">INGRESS_HOST</code> environment variable.
								</p><p>
									In that case, use the following command to correct the <code class="literal">INGRESS_HOST</code> value:
								</p></div></div><pre class="programlisting language-terminal">$ export INGRESS_HOST=$(oc -n istio-system get service istio-ingressgateway -o jsonpath='{.status.loadBalancer.ingress[0].hostname}')</pre></section><section class="section" id="ossm-routing-config-ig-no-lb_traffic-management"><div class="titlepage"><div><div><h6 class="title">1.14.1.3.1.2. Determining ingress ports without a load balancer</h6></div></div></div><p>
								If your environment does not have an external load balancer, determine the ingress ports and use a node port instead.
							</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
										Set the ingress ports.
									</p><pre class="programlisting language-terminal">$ export INGRESS_PORT=$(oc -n istio-system get service istio-ingressgateway -o jsonpath='{.spec.ports[?(@.name=="http2")].nodePort}')</pre></li><li class="listitem"><p class="simpara">
										Run the following command to set the secure ingress port.
									</p><pre class="programlisting language-terminal">$ export SECURE_INGRESS_PORT=$(oc -n istio-system get service istio-ingressgateway -o jsonpath='{.spec.ports[?(@.name=="https")].nodePort}')</pre></li><li class="listitem"><p class="simpara">
										Run the following command to set the TCP ingress port.
									</p><pre class="programlisting language-terminal">$ export TCP_INGRESS_PORT=$(kubectl -n istio-system get service istio-ingressgateway -o jsonpath='{.spec.ports[?(@.name=="tcp")].nodePort}')</pre></li></ol></div></section></section></section><section class="section" id="ossm-routing-ingress-gateway_traffic-management"><div class="titlepage"><div><div><h4 class="title">1.14.1.4. Configuring an ingress gateway</h4></div></div></div><p>
						An ingress gateway is a load balancer operating at the edge of the mesh that receives incoming HTTP/TCP connections. It configures exposed ports and protocols but does not include any traffic routing configuration. Traffic routing for ingress traffic is instead configured with routing rules, the same way as for internal service requests.
					</p><p>
						The following steps show how to create a gateway and configure a <code class="literal">VirtualService</code> to expose a service in the Bookinfo sample application to outside traffic for paths <code class="literal">/productpage</code> and <code class="literal">/login</code>.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a gateway to accept traffic.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Create a YAML file, and copy the following YAML into it.
									</p><div class="formalpara"><p class="title"><strong>Gateway example gateway.yaml</strong></p><p>
											
<pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: Gateway
metadata:
  name: bookinfo-gateway
spec:
  selector:
    istio: ingressgateway
  servers:
  - port:
      number: 80
      name: http
      protocol: HTTP
    hosts:
    - "*"</pre>

										</p></div></li><li class="listitem"><p class="simpara">
										Apply the YAML file.
									</p><pre class="programlisting language-terminal">$ oc apply -f gateway.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								Create a <code class="literal">VirtualService</code> object to rewrite the host header.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Create a YAML file, and copy the following YAML into it.
									</p><div class="formalpara"><p class="title"><strong>Virtual service example</strong></p><p>
											
<pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: bookinfo
spec:
  hosts:
  - "*"
  gateways:
  - bookinfo-gateway
  http:
  - match:
    - uri:
        exact: /productpage
    - uri:
        prefix: /static
    - uri:
        exact: /login
    - uri:
        exact: /logout
    - uri:
        prefix: /api/v1/products
    route:
    - destination:
        host: productpage
        port:
          number: 9080</pre>

										</p></div></li><li class="listitem"><p class="simpara">
										Apply the YAML file.
									</p><pre class="programlisting language-terminal">$ oc apply -f vs.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								Test that the gateway and VirtualService have been set correctly.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Set the Gateway URL.
									</p><pre class="programlisting language-terminal">export GATEWAY_URL=$(oc -n istio-system get route istio-ingressgateway -o jsonpath='{.spec.host}')</pre></li><li class="listitem"><p class="simpara">
										Set the port number. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
									</p><pre class="programlisting language-terminal">export TARGET_PORT=$(oc -n istio-system get route istio-ingressgateway -o jsonpath='{.spec.port.targetPort}')</pre></li><li class="listitem"><p class="simpara">
										Test a page that has been explicitly exposed.
									</p><pre class="programlisting language-terminal">curl -s -I "$GATEWAY_URL/productpage"</pre><p class="simpara">
										The expected result is <code class="literal">200</code>.
									</p></li></ol></div></li></ol></div></section></section><section class="section" id="ossm-auto-route_traffic-management"><div class="titlepage"><div><div><h3 class="title">1.14.2. Understanding automatic routes</h3></div></div></div><p>
					OpenShift routes for gateways are automatically managed in Service Mesh. Every time an Istio Gateway is created, updated or deleted inside the service mesh, an OpenShift route is created, updated or deleted.
				</p><section class="section" id="ossm-auto-route-subdomains_traffic-management"><div class="titlepage"><div><div><h4 class="title">1.14.2.1. Routes with subdomains</h4></div></div></div><p>
						Red Hat OpenShift Service Mesh creates the route with the subdomain, but OpenShift Container Platform must be configured to enable it. Subdomains, for example <code class="literal">*.domain.com</code>, are supported, but not by default. Configure an OpenShift Container Platform wildcard policy before configuring a wildcard host gateway.
					</p><p>
						For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#using-wildcard-routes_configuring-ingress">Using wildcard routes</a>.
					</p></section><section class="section" id="ossm-auto-route-create-subdomains_traffic-management"><div class="titlepage"><div><div><h4 class="title">1.14.2.2. Creating subdomain routes</h4></div></div></div><p>
						The following example creates a gateway in the Bookinfo sample application, which creates subdomain routes.
					</p><pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: Gateway
metadata:
  name: gateway1
spec:
  selector:
    istio: ingressgateway
  servers:
  - port:
      number: 80
      name: http
      protocol: HTTP
    hosts:
    - www.bookinfo.com
    - bookinfo.example.com</pre><p>
						The <code class="literal">Gateway</code> resource creates the following OpenShift routes. You can check that the routes are created by using the following command. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
					</p><pre class="programlisting language-terminal">$ oc -n istio-system get routes</pre><div class="formalpara"><p class="title"><strong>Expected output</strong></p><p>
							
<pre class="programlisting language-terminal">NAME           HOST/PORT             PATH  SERVICES               PORT  TERMINATION   WILDCARD
gateway1-lvlfn bookinfo.example.com        istio-ingressgateway   &lt;all&gt;               None
gateway1-scqhv www.bookinfo.com            istio-ingressgateway   &lt;all&gt;               None</pre>

						</p></div><p>
						If you delete the gateway, Red Hat OpenShift Service Mesh deletes the routes. However, routes you have manually created are never modified by Red Hat OpenShift Service Mesh.
					</p></section><section class="section" id="ossm-auto-route-annotations_traffic-management"><div class="titlepage"><div><div><h4 class="title">1.14.2.3. Route labels and annotations</h4></div></div></div><p>
						Sometimes specific labels or annotations are needed in an OpenShift route. For example, some advanced features in OpenShift routes are managed using special annotations. See "Route-specific annotations" in the following "Additional resources" section.
					</p><p>
						For this and other use cases, Red Hat OpenShift Service Mesh will copy all labels and annotations present in the Istio gateway resource (with the exception of annotations starting with <code class="literal">kubectl.kubernetes.io</code>) into the managed OpenShift route resource.
					</p><p>
						If you need specific labels or annotations in the OpenShift routes created by Service Mesh, create them in the Istio gateway resource and they will be copied into the OpenShift route resources managed by the Service Mesh.
					</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#nw-route-specific-annotations_route-configuration">Route-specific annotations</a>.
							</li></ul></div></section><section class="section" id="ossm-auto-route-enable_traffic-management"><div class="titlepage"><div><div><h4 class="title">1.14.2.4. Disabling automatic route creation</h4></div></div></div><p>
						By default, the <code class="literal">ServiceMeshControlPlane</code> resource automatically synchronizes the Istio gateway resources with OpenShift routes. Disabling the automatic route creation allows you more flexibility to control routes if you have a special case or prefer to control routes manually.
					</p><section class="section" id="disabling-automatic-route-creation-specific-cases_traffic-management"><div class="titlepage"><div><div><h5 class="title">1.14.2.4.1. Disabling automatic route creation for specific cases</h5></div></div></div><p>
							If you want to disable the automatic management of OpenShift routes for a specific Istio gateway, you must add the annotation <code class="literal">maistra.io/manageRoute: false</code> to the gateway metadata definition. Red Hat OpenShift Service Mesh will ignore Istio gateways with this annotation, while keeping the automatic management of the other Istio gateways.
						</p></section><section class="section" id="disabling-automatic-route-creation-all-cases_traffic-management"><div class="titlepage"><div><div><h5 class="title">1.14.2.4.2. Disabling automatic route creation for all cases</h5></div></div></div><p>
							You can disable the automatic management of OpenShift routes for all gateways in your mesh.
						</p><p>
							Disable integration between Istio gateways and OpenShift routes by setting the <code class="literal">ServiceMeshControlPlane</code> field <code class="literal">gateways.openshiftRoute.enabled</code> to <code class="literal">false</code>. For example, see the following resource snippet.
						</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v1alpha1
kind: ServiceMeshControlPlane
metadata:
  namespace: istio-system
spec:
  gateways:
    openshiftRoute:
      enabled: false</pre></section></section></section><section class="section" id="ossm-routing-service-entries_traffic-management"><div class="titlepage"><div><div><h3 class="title">1.14.3. Understanding service entries</h3></div></div></div><p>
					A service entry adds an entry to the service registry that Red Hat OpenShift Service Mesh maintains internally. After you add the service entry, the Envoy proxies send traffic to the service as if it is a service in your mesh. Service entries allow you to do the following:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Manage traffic for services that run outside of the service mesh.
						</li><li class="listitem">
							Redirect and forward traffic for external destinations (such as, APIs consumed from the web) or traffic to services in legacy infrastructure.
						</li><li class="listitem">
							Define retry, timeout, and fault injection policies for external destinations.
						</li><li class="listitem">
							Run a mesh service in a Virtual Machine (VM) by adding VMs to your mesh.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Add services from a different cluster to the mesh to configure a multicluster Red Hat OpenShift Service Mesh mesh on Kubernetes.
					</p></div></div><div class="formalpara"><p class="title"><strong>Service entry examples</strong></p><p>
						The following example is a mesh-external service entry that adds the <code class="literal">ext-resource</code> external dependency to the Red Hat OpenShift Service Mesh service registry:
					</p></div><pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: ServiceEntry
metadata:
  name: svc-entry
spec:
  hosts:
  - ext-svc.example.com
  ports:
  - number: 443
    name: https
    protocol: HTTPS
  location: MESH_EXTERNAL
  resolution: DNS</pre><p>
					Specify the external resource using the <code class="literal">hosts</code> field. You can qualify it fully or use a wildcard prefixed domain name.
				</p><p>
					You can configure virtual services and destination rules to control traffic to a service entry in the same way you configure traffic for any other service in the mesh. For example, the following destination rule configures the traffic route to use mutual TLS to secure the connection to the <code class="literal">ext-svc.example.com</code> external service that is configured using the service entry:
				</p><pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: DestinationRule
metadata:
  name: ext-res-dr
spec:
  host: ext-svc.example.com
  trafficPolicy:
    tls:
      mode: MUTUAL
      clientCertificate: /etc/certs/myclientcert.pem
      privateKey: /etc/certs/client_private_key.pem
      caCertificates: /etc/certs/rootcacerts.pem</pre></section><section class="section" id="ossm-routing-virtual-services_traffic-management"><div class="titlepage"><div><div><h3 class="title">1.14.4. Using VirtualServices</h3></div></div></div><p>
					You can route requests dynamically to multiple versions of a microservice through Red Hat OpenShift Service Mesh with a virtual service. With virtual services, you can:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Address multiple application services through a single virtual service. If your mesh uses Kubernetes, for example, you can configure a virtual service to handle all services in a specific namespace. A virtual service enables you to turn a monolithic application into a service consisting of distinct microservices with a seamless consumer experience.
						</li><li class="listitem">
							Configure traffic rules in combination with gateways to control ingress and egress traffic.
						</li></ul></div><section class="section" id="ossm-routing-vs_traffic-management"><div class="titlepage"><div><div><h4 class="title">1.14.4.1. Configuring VirtualServices</h4></div></div></div><p>
						Requests are routed to services within a service mesh with virtual services. Each virtual service consists of a set of routing rules that are evaluated in order. Red Hat OpenShift Service Mesh matches each given request to the virtual service to a specific real destination within the mesh.
					</p><p>
						Without virtual services, Red Hat OpenShift Service Mesh distributes traffic using least requests load balancing between all service instances. With a virtual service, you can specify traffic behavior for one or more hostnames. Routing rules in the virtual service tell Red Hat OpenShift Service Mesh how to send the traffic for the virtual service to appropriate destinations. Route destinations can be versions of the same service or entirely different services.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a YAML file using the following example to route requests to different versions of the Bookinfo sample application service depending on which user connects to the application.
							</p><div class="formalpara"><p class="title"><strong>Example VirtualService.yaml</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: reviews
spec:
  hosts:
  - reviews
  http:
  - match:
    - headers:
        end-user:
          exact: jason
    route:
    - destination:
        host: reviews
        subset: v2
  - route:
    - destination:
        host: reviews
        subset: v3</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Run the following command to apply <code class="literal">VirtualService.yaml</code>, where <code class="literal">VirtualService.yaml</code> is the path to the file.
							</p><pre class="programlisting language-terminal">$ oc apply -f &lt;VirtualService.yaml&gt;</pre></li></ol></div></section><section class="section" id="virtualservice-configuration-reference"><div class="titlepage"><div><div><h4 class="title">1.14.4.2. VirtualService configuration reference</h4></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663671101264" scope="col">Parameter</th><th align="left" valign="top" id="idm140663671100176" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663671101264">
<pre class="literallayout">spec:
  hosts:</pre>
									 </td><td align="left" valign="top" headers="idm140663671100176"> <p>
										The <code class="literal">hosts</code> field lists the virtual service’s destination address to which the routing rules apply. This is the address(es) that are used to send requests to the service. The virtual service hostname can be an IP address, a DNS name, or a short name that resolves to a fully qualified domain name.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663671101264">
<pre class="literallayout">spec:
  http:
  - match:</pre>
									 </td><td align="left" valign="top" headers="idm140663671100176"> <p>
										The <code class="literal">http</code> section contains the virtual service’s routing rules which describe match conditions and actions for routing HTTP/1.1, HTTP2, and gRPC traffic sent to the destination as specified in the hosts field. A routing rule consists of the destination where you want the traffic to go and any specified match conditions. The first routing rule in the example has a condition that begins with the match field. In this example, this routing applies to all requests from the user <code class="literal">jason</code>. Add the <code class="literal">headers</code>, <code class="literal">end-user</code>, and <code class="literal">exact</code> fields to select the appropriate requests.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663671101264">
<pre class="literallayout">spec:
  http:
  - match:
    - destination:</pre>
									 </td><td align="left" valign="top" headers="idm140663671100176"> <p>
										The <code class="literal">destination</code> field in the route section specifies the actual destination for traffic that matches this condition. Unlike the virtual service’s host, the destination’s host must be a real destination that exists in the Red Hat OpenShift Service Mesh service registry. This can be a mesh service with proxies or a non-mesh service added using a service entry. In this example, the hostname is a Kubernetes service name:
									</p>
									 </td></tr></tbody></table></div></section></section><section class="section" id="ossm-routing-destination-rules_traffic-management"><div class="titlepage"><div><div><h3 class="title">1.14.5. Understanding destination rules</h3></div></div></div><p>
					Destination rules are applied after virtual service routing rules are evaluated, so they apply to the traffic’s real destination. Virtual services route traffic to a destination. Destination rules configure what happens to traffic at that destination.
				</p><p>
					By default, Red Hat OpenShift Service Mesh uses a least requests load balancing policy, where the service instance in the pool with the least number of active connections receives the request. Red Hat OpenShift Service Mesh also supports the following models, which you can specify in destination rules for requests to a particular service or service subset.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Random: Requests are forwarded at random to instances in the pool.
						</li><li class="listitem">
							Weighted: Requests are forwarded to instances in the pool according to a specific percentage.
						</li><li class="listitem">
							Least requests: Requests are forwarded to instances with the least number of requests.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Destination rule example</strong></p><p>
						The following example destination rule configures three different subsets for the <code class="literal">my-svc</code> destination service, with different load balancing policies:
					</p></div><pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: DestinationRule
metadata:
  name: my-destination-rule
spec:
  host: my-svc
  trafficPolicy:
    loadBalancer:
      simple: RANDOM
  subsets:
  - name: v1
    labels:
      version: v1
  - name: v2
    labels:
      version: v2
    trafficPolicy:
      loadBalancer:
        simple: ROUND_ROBIN
  - name: v3
    labels:
      version: v3</pre></section><section class="section" id="ossm-understanding-networkpolicy_traffic-management"><div class="titlepage"><div><div><h3 class="title">1.14.6. Understanding network policies</h3></div></div></div><p>
					Red Hat OpenShift Service Mesh automatically creates and manages a number of <code class="literal">NetworkPolicies</code> resources in the Service Mesh control plane and application namespaces. This is to ensure that applications and the control plane can communicate with each other.
				</p><p>
					For example, if you have configured your OpenShift Container Platform cluster to use the SDN plugin, Red Hat OpenShift Service Mesh creates a <code class="literal">NetworkPolicy</code> resource in each member project. This enables ingress to all pods in the mesh from the other mesh members and the control plane. This also restricts ingress to only member projects. If you require ingress from non-member projects, you need to create a <code class="literal">NetworkPolicy</code> to allow that traffic through. If you remove a namespace from Service Mesh, this <code class="literal">NetworkPolicy</code> resource is deleted from the project.
				</p><section class="section" id="ossm-config-disable-networkpolicy_traffic-management"><div class="titlepage"><div><div><h4 class="title">1.14.6.1. Disabling automatic NetworkPolicy creation</h4></div></div></div><p>
						If you want to disable the automatic creation and management of <code class="literal">NetworkPolicy</code> resources, for example to enforce company security policies, or to allow direct access to pods in the mesh, you can do so. You can edit the <code class="literal">ServiceMeshControlPlane</code> and set <code class="literal">spec.security.manageNetworkPolicy</code> to <code class="literal">false</code>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When you disable <code class="literal">spec.security.manageNetworkPolicy</code> Red Hat OpenShift Service Mesh will not create <span class="strong strong"><strong>any</strong></span> <code class="literal">NetworkPolicy</code> objects. The system administrator is responsible for managing the network and fixing any issues this might cause.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Red Hat OpenShift Service Mesh Operator version 2.1.1 or higher installed.
							</li><li class="listitem">
								<code class="literal">ServiceMeshControlPlane</code> resource updated to version 2.1 or higher.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								In the OpenShift Container Platform web console, click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Select the project where you installed the Service Mesh control plane, for example <code class="literal">istio-system</code>, from the <span class="strong strong"><strong>Project</strong></span> menu.
							</li><li class="listitem">
								Click the Red Hat OpenShift Service Mesh Operator. In the <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span> column, click the name of your <code class="literal">ServiceMeshControlPlane</code>, for example <code class="literal">basic-install</code>.
							</li><li class="listitem">
								On the <span class="strong strong"><strong>Create ServiceMeshControlPlane Details</strong></span> page, click <code class="literal">YAML</code> to modify your configuration.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">ServiceMeshControlPlane</code> field <code class="literal">spec.security.manageNetworkPolicy</code> to <code class="literal">false</code>, as shown in this example.
							</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
spec:
  security:
      manageNetworkPolicy: false</pre></li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span>.
							</li></ol></div></section></section><section class="section" id="ossm-routing-sidecar_traffic-management"><div class="titlepage"><div><div><h3 class="title">1.14.7. Configuring sidecars for traffic management</h3></div></div></div><p>
					By default, Red Hat OpenShift Service Mesh configures every Envoy proxy to accept traffic on all the ports of its associated workload, and to reach every workload in the mesh when forwarding traffic. You can use a sidecar configuration to do the following:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Fine-tune the set of ports and protocols that an Envoy proxy accepts.
						</li><li class="listitem">
							Limit the set of services that the Envoy proxy can reach.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						To optimize performance of your service mesh, consider limiting Envoy proxy configurations.
					</p></div></div><p>
					In the Bookinfo sample application, configure a Sidecar so all services can reach other services running in the same namespace and control plane. This Sidecar configuration is required for using Red Hat OpenShift Service Mesh policy and telemetry features.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a YAML file using the following example to specify that you want a sidecar configuration to apply to all workloads in a particular namespace. Otherwise, choose specific workloads using a <code class="literal">workloadSelector</code>.
						</p><div class="formalpara"><p class="title"><strong>Example sidecar.yaml</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: Sidecar
metadata:
  name: default
  namespace: bookinfo
spec:
  egress:
  - hosts:
    - "./*"
    - "istio-system/*"</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Run the following command to apply <code class="literal">sidecar.yaml</code>, where <code class="literal">sidecar.yaml</code> is the path to the file.
						</p><pre class="programlisting language-terminal">$ oc apply -f sidecar.yaml</pre></li><li class="listitem"><p class="simpara">
							Run the following command to verify that the sidecar was created successfully.
						</p><pre class="programlisting language-terminal">$ oc get sidecar</pre></li></ol></div></section><section class="section" id="routing-tutorial"><div class="titlepage"><div><div><h3 class="title">1.14.8. Routing Tutorial</h3></div></div></div><p>
					This guide references the Bookinfo sample application to provide examples of routing in an example application. Install the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-tutorial-bookinfo-overview_ossm-create-mesh">Bookinfo application</a> to learn how these routing examples work.
				</p><section class="section" id="ossm-routing-bookinfo_traffic-management"><div class="titlepage"><div><div><h4 class="title">1.14.8.1. Bookinfo routing tutorial</h4></div></div></div><p>
						The Service Mesh Bookinfo sample application consists of four separate microservices, each with multiple versions. After installing the Bookinfo sample application, three different versions of the <code class="literal">reviews</code> microservice run concurrently.
					</p><p>
						When you access the Bookinfo app <code class="literal">/product</code> page in a browser and refresh several times, sometimes the book review output contains star ratings and other times it does not. Without an explicit default service version to route to, Service Mesh routes requests to all available versions one after the other.
					</p><p>
						This tutorial helps you apply rules that route all traffic to <code class="literal">v1</code> (version 1) of the microservices. Later, you can apply a rule to route traffic based on the value of an HTTP request header.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites:</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Deploy the Bookinfo sample application to work with the following examples.
							</li></ul></div></section><section class="section" id="ossm-routing-bookinfo-applying_traffic-management"><div class="titlepage"><div><div><h4 class="title">1.14.8.2. Applying a virtual service</h4></div></div></div><p>
						In the following procedure, the virtual service routes all traffic to <code class="literal">v1</code> of each micro-service by applying virtual services that set the default version for the micro-services.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Apply the virtual services.
							</p><pre class="programlisting language-bash">$ oc apply -f https://raw.githubusercontent.com/Maistra/istio/maistra-2.4/samples/bookinfo/networking/virtual-service-all-v1.yaml</pre></li><li class="listitem"><p class="simpara">
								To verify that you applied the virtual services, display the defined routes with the following command:
							</p><pre class="programlisting language-terminal">$ oc get virtualservices -o yaml</pre><p class="simpara">
								That command returns a resource of <code class="literal">kind: VirtualService</code> in YAML format.
							</p></li></ol></div><p>
						You have configured Service Mesh to route to the <code class="literal">v1</code> version of the Bookinfo microservices including the <code class="literal">reviews</code> service version 1.
					</p></section><section class="section" id="ossm-routing-bookinfo-test_traffic-management"><div class="titlepage"><div><div><h4 class="title">1.14.8.3. Testing the new route configuration</h4></div></div></div><p>
						Test the new configuration by refreshing the <code class="literal">/productpage</code> of the Bookinfo application.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Set the value for the <code class="literal">GATEWAY_URL</code> parameter. You can use this variable to find the URL for your Bookinfo product page later. In this example, istio-system is the name of the control plane project.
							</p><pre class="programlisting language-terminal">export GATEWAY_URL=$(oc -n istio-system get route istio-ingressgateway -o jsonpath='{.spec.host}')</pre></li><li class="listitem"><p class="simpara">
								Run the following command to retrieve the URL for the product page.
							</p><pre class="programlisting language-terminal">echo "http://$GATEWAY_URL/productpage"</pre></li><li class="listitem">
								Open the Bookinfo site in your browser.
							</li></ol></div><p>
						The reviews part of the page displays with no rating stars, no matter how many times you refresh. This is because you configured Service Mesh to route all traffic for the reviews service to the version <code class="literal">reviews:v1</code> and this version of the service does not access the star ratings service.
					</p><p>
						Your service mesh now routes traffic to one version of a service.
					</p></section><section class="section" id="ossm-routing-bookinfo-route_traffic-management"><div class="titlepage"><div><div><h4 class="title">1.14.8.4. Route based on user identity</h4></div></div></div><p>
						Change the route configuration so that all traffic from a specific user is routed to a specific service version. In this case, all traffic from a user named <code class="literal">jason</code> will be routed to the service <code class="literal">reviews:v2</code>.
					</p><p>
						Service Mesh does not have any special, built-in understanding of user identity. This example is enabled by the fact that the <code class="literal">productpage</code> service adds a custom <code class="literal">end-user</code> header to all outbound HTTP requests to the reviews service.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Run the following command to enable user-based routing in the Bookinfo sample application.
							</p><pre class="programlisting language-bash">$ oc apply -f https://raw.githubusercontent.com/Maistra/istio/maistra-2.4/samples/bookinfo/networking/virtual-service-reviews-test-v2.yaml</pre></li><li class="listitem"><p class="simpara">
								Run the following command to confirm the rule is created. This command returns all resources of <code class="literal">kind: VirtualService</code> in YAML format.
							</p><pre class="programlisting language-terminal">$ oc get virtualservice reviews -o yaml</pre></li><li class="listitem">
								On the <code class="literal">/productpage</code> of the Bookinfo app, log in as user <code class="literal">jason</code> with no password.
							</li><li class="listitem">
								Refresh the browser. The star ratings appear next to each review.
							</li><li class="listitem">
								Log in as another user (pick any name you want). Refresh the browser. Now the stars are gone. Traffic is now routed to <code class="literal">reviews:v1</code> for all users except Jason.
							</li></ol></div><p>
						You have successfully configured the Bookinfo sample application to route traffic based on user identity.
					</p></section></section></section><section class="section" id="ossm-observability"><div class="titlepage"><div><div><h2 class="title">1.15. Metrics, logs, and traces</h2></div></div></div><p>
				Once you have added your application to the mesh, you can observe the data flow through your application. If you do not have your own application installed, you can see how observability works in Red Hat OpenShift Service Mesh by installing the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-tutorial-bookinfo-overview_ossm-create-mesh">Bookinfo sample application</a>.
			</p><section class="section" id="ossm-observability-addresses_observability"><div class="titlepage"><div><div><h3 class="title">1.15.1. Discovering console addresses</h3></div></div></div><p>
					Red Hat OpenShift Service Mesh provides the following consoles to view your service mesh data:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Kiali console</strong></span> - Kiali is the management console for Red Hat OpenShift Service Mesh.
						</li><li class="listitem">
							<span class="strong strong"><strong>Jaeger console</strong></span> - Jaeger is the management console for Red Hat OpenShift distributed tracing platform.
						</li><li class="listitem">
							<span class="strong strong"><strong>Grafana console</strong></span> - Grafana provides mesh administrators with advanced query and metrics analysis and dashboards for Istio data. Optionally, Grafana can be used to analyze service mesh metrics.
						</li><li class="listitem">
							<span class="strong strong"><strong>Prometheus console</strong></span> - Red Hat OpenShift Service Mesh uses Prometheus to store telemetry information from services.
						</li></ul></div><p>
					When you install the Service Mesh control plane, it automatically generates routes for each of the installed components. Once you have the route address, you can access the Kiali, Jaeger, Prometheus, or Grafana console to view and manage your service mesh data.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisite</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The component must be enabled and installed. For example, if you did not install distributed tracing, you will not be able to access the Jaeger console.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure from OpenShift console</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform web console as a user with cluster-admin rights. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
						</li><li class="listitem">
							Navigate to <span class="strong strong"><strong>Networking</strong></span> → <span class="strong strong"><strong>Routes</strong></span>.
						</li><li class="listitem"><p class="simpara">
							On the <span class="strong strong"><strong>Routes</strong></span> page, select the Service Mesh control plane project, for example <code class="literal">istio-system</code>, from the <span class="strong strong"><strong>Namespace</strong></span> menu.
						</p><p class="simpara">
							The <span class="strong strong"><strong>Location</strong></span> column displays the linked address for each route.
						</p></li><li class="listitem">
							If necessary, use the filter to find the component console whose route you want to access. Click the route <span class="strong strong"><strong>Location</strong></span> to launch the console.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Log In With OpenShift</strong></span>.
						</li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure from the CLI</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Log in to the OpenShift Container Platform CLI as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
						</p><pre class="programlisting language-terminal">$ oc login --username=&lt;NAMEOFUSER&gt; https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
							Switch to the Service Mesh control plane project. In this example, <code class="literal">istio-system</code> is the Service Mesh control plane project. Run the following command:
						</p><pre class="programlisting language-terminal">$ oc project istio-system</pre></li><li class="listitem"><p class="simpara">
							To get the routes for the various Red Hat OpenShift Service Mesh consoles, run the folowing command:
						</p><pre class="programlisting language-terminal">$ oc get routes</pre><p class="simpara">
							This command returns the URLs for the Kiali, Jaeger, Prometheus, and Grafana web consoles, and any other routes in your service mesh. You should see output similar to the following:
						</p><pre class="programlisting language-terminal">NAME                    HOST/PORT                         SERVICES              PORT    TERMINATION
bookinfo-gateway        bookinfo-gateway-yourcompany.com  istio-ingressgateway          http2
grafana                 grafana-yourcompany.com           grafana               &lt;all&gt;   reencrypt/Redirect
istio-ingressgateway    istio-ingress-yourcompany.com     istio-ingressgateway  8080
jaeger                  jaeger-yourcompany.com            jaeger-query          &lt;all&gt;   reencrypt
kiali                   kiali-yourcompany.com             kiali                 20001   reencrypt/Redirect
prometheus              prometheus-yourcompany.com        prometheus            &lt;all&gt;   reencrypt/Redirect</pre></li><li class="listitem">
							Copy the URL for the console you want to access from the <code class="literal">HOST/PORT</code> column into a browser to open the console.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Log In With OpenShift</strong></span>.
						</li></ol></div></section><section class="section" id="ossm-accessing-kiali-console_observability"><div class="titlepage"><div><div><h3 class="title">1.15.2. Accessing the Kiali console</h3></div></div></div><p>
					You can view your application’s topology, health, and metrics in the Kiali console. If your service is experiencing problems, the Kiali console lets you view the data flow through your service. You can view insights about the mesh components at different levels, including abstract applications, services, and workloads. Kiali also provides an interactive graph view of your namespace in real time.
				</p><p>
					To access the Kiali console you must have Red Hat OpenShift Service Mesh installed, Kiali installed and configured.
				</p><p>
					The installation process creates a route to access the Kiali console.
				</p><p>
					If you know the URL for the Kiali console, you can access it directly. If you do not know the URL, use the following directions.
				</p><div class="orderedlist"><p class="title"><strong>Procedure for administrators</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform web console with an administrator role.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Home</strong></span> → <span class="strong strong"><strong>Projects</strong></span>.
						</li><li class="listitem">
							On the <span class="strong strong"><strong>Projects</strong></span> page, if necessary, use the filter to find the name of your project.
						</li><li class="listitem">
							Click the name of your project, for example, <code class="literal">bookinfo</code>.
						</li><li class="listitem">
							On the <span class="strong strong"><strong>Project details</strong></span> page, in the <span class="strong strong"><strong>Launcher</strong></span> section, click the <span class="strong strong"><strong>Kiali</strong></span> link.
						</li><li class="listitem"><p class="simpara">
							Log in to the Kiali console with the same user name and password that you use to access the OpenShift Container Platform console.
						</p><p class="simpara">
							When you first log in to the Kiali Console, you see the <span class="strong strong"><strong>Overview</strong></span> page which displays all the namespaces in your service mesh that you have permission to view.
						</p><p class="simpara">
							If you are validating the console installation and namespaces have not yet been added to the mesh, there might not be any data to display other than <code class="literal">istio-system</code>.
						</p></li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure for developers</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform web console with a developer role.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Project</strong></span>.
						</li><li class="listitem">
							On the <span class="strong strong"><strong>Project Details</strong></span> page, if necessary, use the filter to find the name of your project.
						</li><li class="listitem">
							Click the name of your project, for example, <code class="literal">bookinfo</code>.
						</li><li class="listitem">
							On the <span class="strong strong"><strong>Project</strong></span> page, in the <span class="strong strong"><strong>Launcher</strong></span> section, click the <span class="strong strong"><strong>Kiali</strong></span> link.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Log In With OpenShift</strong></span>.
						</li></ol></div></section><section class="section" id="ossm-observability-visual_observability"><div class="titlepage"><div><div><h3 class="title">1.15.3. Viewing service mesh data in the Kiali console</h3></div></div></div><p>
					The Kiali Graph offers a powerful visualization of your mesh traffic. The topology combines real-time request traffic with your Istio configuration information to present immediate insight into the behavior of your service mesh, letting you quickly pinpoint issues. Multiple Graph Types let you visualize traffic as a high-level service topology, a low-level workload topology, or as an application-level topology.
				</p><p>
					There are several graphs to choose from:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The <span class="strong strong"><strong>App graph</strong></span> shows an aggregate workload for all applications that are labeled the same.
						</li><li class="listitem">
							The <span class="strong strong"><strong>Service graph</strong></span> shows a node for each service in your mesh but excludes all applications and workloads from the graph. It provides a high level view and aggregates all traffic for defined services.
						</li><li class="listitem">
							The <span class="strong strong"><strong>Versioned App graph</strong></span> shows a node for each version of an application. All versions of an application are grouped together.
						</li><li class="listitem">
							The <span class="strong strong"><strong>Workload graph</strong></span> shows a node for each workload in your service mesh. This graph does not require you to use the application and version labels. If your application does not use version labels, use this the graph.
						</li></ul></div><p>
					Graph nodes are decorated with a variety of information, pointing out various route routing options like virtual services and service entries, as well as special configuration like fault-injection and circuit breakers. It can identify mTLS issues, latency issues, error traffic and more. The Graph is highly configurable, can show traffic animation, and has powerful Find and Hide abilities.
				</p><p>
					Click the <span class="strong strong"><strong>Legend</strong></span> button to view information about the shapes, colors, arrows, and badges displayed in the graph.
				</p><p>
					To view a summary of metrics, select any node or edge in the graph to display its metric details in the summary details panel.
				</p><section class="section" id="ossm-observability-topology_observability"><div class="titlepage"><div><div><h4 class="title">1.15.3.1. Changing graph layouts in Kiali</h4></div></div></div><p>
						The layout for the Kiali graph can render differently depending on your application architecture and the data to display. For example, the number of graph nodes and their interactions can determine how the Kiali graph is rendered. Because it is not possible to create a single layout that renders nicely for every situation, Kiali offers a choice of several different layouts.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								If you do not have your own application installed, install the Bookinfo sample application. Then generate traffic for the Bookinfo application by entering the following command several times.
							</p><pre class="programlisting language-terminal">$ curl "http://$GATEWAY_URL/productpage"</pre><p class="simpara">
								This command simulates a user visiting the <code class="literal">productpage</code> microservice of the application.
							</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Launch the Kiali console.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Log In With OpenShift</strong></span>.
							</li><li class="listitem">
								In Kiali console, click <span class="strong strong"><strong>Graph</strong></span> to view a namespace graph.
							</li><li class="listitem">
								From the <span class="strong strong"><strong>Namespace</strong></span> menu, select your application namespace, for example, <code class="literal">bookinfo</code>.
							</li><li class="listitem"><p class="simpara">
								To choose a different graph layout, do either or both of the following:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Select different graph data groupings from the menu at the top of the graph.
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												App graph
											</li><li class="listitem">
												Service graph
											</li><li class="listitem">
												Versioned App graph (default)
											</li><li class="listitem">
												Workload graph
											</li></ul></div></li><li class="listitem"><p class="simpara">
										Select a different graph layout from the Legend at the bottom of the graph.
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												Layout default dagre
											</li><li class="listitem">
												Layout 1 cose-bilkent
											</li><li class="listitem">
												Layout 2 cola
											</li></ul></div></li></ul></div></li></ol></div></section><section class="section" id="ossm-viewing-logs_observability"><div class="titlepage"><div><div><h4 class="title">1.15.3.2. Viewing logs in the Kiali console</h4></div></div></div><p>
						You can view logs for your workloads in the Kiali console. The <span class="strong strong"><strong>Workload Detail</strong></span> page includes a <span class="strong strong"><strong>Logs</strong></span> tab which displays a unified logs view that displays both application and proxy logs. You can select how often you want the log display in Kiali to be refreshed.
					</p><p>
						To change the logging level on the logs displayed in Kiali, you change the logging configuration for the workload or the proxy.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Service Mesh installed and configured.
							</li><li class="listitem">
								Kiali installed and configured.
							</li><li class="listitem">
								The address for the Kiali console.
							</li><li class="listitem">
								Application or Bookinfo sample application added to the mesh.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Launch the Kiali console.
							</li><li class="listitem"><p class="simpara">
								Click <span class="strong strong"><strong>Log In With OpenShift</strong></span>.
							</p><p class="simpara">
								The Kiali Overview page displays namespaces that have been added to the mesh that you have permissions to view.
							</p></li><li class="listitem">
								Click <span class="strong strong"><strong>Workloads</strong></span>.
							</li><li class="listitem">
								On the <span class="strong strong"><strong>Workloads</strong></span> page, select the project from the <span class="strong strong"><strong>Namespace</strong></span> menu.
							</li><li class="listitem">
								If necessary, use the filter to find the workload whose logs you want to view. Click the workload <span class="strong strong"><strong>Name</strong></span>. For example, click <span class="strong strong"><strong>ratings-v1</strong></span>.
							</li><li class="listitem">
								On the <span class="strong strong"><strong>Workload Details</strong></span> page, click the <span class="strong strong"><strong>Logs</strong></span> tab to view the logs for the workload.
							</li></ol></div><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
						If you do not see any log entries, you may need to adjust either the Time Range or the Refresh interval.
					</p></div></div></section><section class="section" id="ossm-viewing-metrics_observability"><div class="titlepage"><div><div><h4 class="title">1.15.3.3. Viewing metrics in the Kiali console</h4></div></div></div><p>
						You can view inbound and outbound metrics for your applications, workloads, and services in the Kiali console. The Detail pages include the following tabs:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								inbound Application metrics
							</li><li class="listitem">
								outbound Application metrics
							</li><li class="listitem">
								inbound Workload metrics
							</li><li class="listitem">
								outbound Workload metrics
							</li><li class="listitem">
								inbound Service metrics
							</li></ul></div><p>
						These tabs display predefined metrics dashboards, tailored to the relevant application, workload or service level. The application and workload detail views show request and response metrics such as volume, duration, size, or TCP traffic. The service detail view shows request and response metrics for inbound traffic only.
					</p><p>
						Kiali lets you customize the charts by choosing the charted dimensions. Kiali can also present metrics reported by either source or destination proxy metrics. And for troubleshooting, Kiali can overlay trace spans on the metrics.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Service Mesh installed and configured.
							</li><li class="listitem">
								Kiali installed and configured.
							</li><li class="listitem">
								The address for the Kiali console.
							</li><li class="listitem">
								(Optional) Distributed tracing installed and configured.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Launch the Kiali console.
							</li><li class="listitem"><p class="simpara">
								Click <span class="strong strong"><strong>Log In With OpenShift</strong></span>.
							</p><p class="simpara">
								The Kiali Overview page displays namespaces that have been added to the mesh that you have permissions to view.
							</p></li><li class="listitem">
								Click either <span class="strong strong"><strong>Applications</strong></span>, <span class="strong strong"><strong>Workloads</strong></span>, or <span class="strong strong"><strong>Services</strong></span>.
							</li><li class="listitem">
								On the <span class="strong strong"><strong>Applications</strong></span>, <span class="strong strong"><strong>Workloads</strong></span>, or <span class="strong strong"><strong>Services</strong></span> page, select the project from the <span class="strong strong"><strong>Namespace</strong></span> menu.
							</li><li class="listitem">
								If necessary, use the filter to find the application, workload, or service whose logs you want to view. Click the <span class="strong strong"><strong>Name</strong></span>.
							</li><li class="listitem">
								On the <span class="strong strong"><strong>Application Detail</strong></span>, <span class="strong strong"><strong>Workload Details</strong></span>, or <span class="strong strong"><strong>Service Details</strong></span> page, click either the <span class="strong strong"><strong>Inbound Metrics</strong></span> or <span class="strong strong"><strong>Outbound Metrics</strong></span> tab to view the metrics.
							</li></ol></div></section></section><section class="section" id="ossm-overview-distr-tracing_observability"><div class="titlepage"><div><div><h3 class="title">1.15.4. Distributed tracing</h3></div></div></div><p>
					Distributed tracing is the process of tracking the performance of individual services in an application by tracing the path of the service calls in the application. Each time a user takes action in an application, a request is executed that might require many services to interact to produce a response. The path of this request is called a distributed transaction.
				</p><p>
					Red Hat OpenShift Service Mesh uses Red Hat OpenShift distributed tracing platform to allow developers to view call flows in a microservice application.
				</p><section class="section" id="ossm-config-external-jaeger_observability"><div class="titlepage"><div><div><h4 class="title">1.15.4.1. Connecting an existing distributed tracing instance</h4></div></div></div><p>
						If you already have an existing Red Hat OpenShift distributed tracing platform (Jaeger) instance in OpenShift Container Platform, you can configure your <code class="literal">ServiceMeshControlPlane</code> resource to use that instance for distributed tracing platform.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Red Hat OpenShift distributed tracing platform instance installed and configured.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								In the OpenShift Container Platform web console, click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Project</strong></span> menu and select the project where you installed the Service Mesh control plane, for example <span class="strong strong"><strong>istio-system</strong></span>.
							</li><li class="listitem">
								Click the Red Hat OpenShift Service Mesh Operator. In the <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span> column, click the name of your <code class="literal">ServiceMeshControlPlane</code> resource, for example <code class="literal">basic</code>.
							</li><li class="listitem"><p class="simpara">
								Add the name of your distributed tracing platform (Jaeger) instance to the <code class="literal">ServiceMeshControlPlane</code>.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Click the <span class="strong strong"><strong>YAML</strong></span> tab.
									</li><li class="listitem"><p class="simpara">
										Add the name of your distributed tracing platform (Jaeger) instance to <code class="literal">spec.addons.jaeger.name</code> in your <code class="literal">ServiceMeshControlPlane</code> resource. In the following example, <code class="literal">distr-tracing-production</code> is the name of the distributed tracing platform (Jaeger) instance.
									</p><div class="formalpara"><p class="title"><strong>Example distributed tracing configuration</strong></p><p>
											
<pre class="programlisting language-yaml">spec:
  addons:
    jaeger:
      name: distr-tracing-production</pre>

										</p></div></li><li class="listitem">
										Click <span class="strong strong"><strong>Save</strong></span>.
									</li></ol></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Reload</strong></span> to verify the <code class="literal">ServiceMeshControlPlane</code> resource was configured correctly.
							</li></ol></div></section><section class="section" id="ossm-config-sampling_observability"><div class="titlepage"><div><div><h4 class="title">1.15.4.2. Adjusting the sampling rate</h4></div></div></div><p>
						A trace is an execution path between services in the service mesh. A trace is comprised of one or more spans. A span is a logical unit of work that has a name, start time, and duration. The sampling rate determines how often a trace is persisted.
					</p><p>
						The Envoy proxy sampling rate is set to sample 100% of traces in your service mesh by default. A high sampling rate consumes cluster resources and performance but is useful when debugging issues. Before you deploy Red Hat OpenShift Service Mesh in production, set the value to a smaller proportion of traces. For example, set <code class="literal">spec.tracing.sampling</code> to <code class="literal">100</code> to sample 1% of traces.
					</p><p>
						Configure the Envoy proxy sampling rate as a scaled integer representing 0.01% increments.
					</p><p>
						In a basic installation, <code class="literal">spec.tracing.sampling</code> is set to <code class="literal">10000</code>, which samples 100% of traces. For example:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Setting the value to 10 samples 0.1% of traces.
							</li><li class="listitem">
								Setting the value to 500 samples 5% of traces.
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The Envoy proxy sampling rate applies for applications that are available to a Service Mesh, and use the Envoy proxy. This sampling rate determines how much data the Envoy proxy collects and tracks.
						</p><p>
							The Jaeger remote sampling rate applies to applications that are external to the Service Mesh, and do not use the Envoy proxy, such as a database. This sampling rate determines how much data the distributed tracing system collects and stores. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/distributed_tracing/#distr-tracing-config-sampling_deploying-distributed-tracing-platform">Distributed tracing configuration options</a>.
						</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								In the OpenShift Container Platform web console, click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Project</strong></span> menu and select the project where you installed the control plane, for example <span class="strong strong"><strong>istio-system</strong></span>.
							</li><li class="listitem">
								Click the Red Hat OpenShift Service Mesh Operator. In the <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span> column, click the name of your <code class="literal">ServiceMeshControlPlane</code> resource, for example <code class="literal">basic</code>.
							</li><li class="listitem"><p class="simpara">
								To adjust the sampling rate, set a different value for <code class="literal">spec.tracing.sampling</code>.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Click the <span class="strong strong"><strong>YAML</strong></span> tab.
									</li><li class="listitem"><p class="simpara">
										Set the value for <code class="literal">spec.tracing.sampling</code> in your <code class="literal">ServiceMeshControlPlane</code> resource. In the following example, set it to <code class="literal">100</code>.
									</p><div class="formalpara"><p class="title"><strong>Jaeger sampling example</strong></p><p>
											
<pre class="programlisting language-yaml">spec:
  tracing:
    sampling: 100</pre>

										</p></div></li><li class="listitem">
										Click <span class="strong strong"><strong>Save</strong></span>.
									</li></ol></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Reload</strong></span> to verify the <code class="literal">ServiceMeshControlPlane</code> resource was configured correctly.
							</li></ol></div></section></section><section class="section" id="ossm-accessing-jaeger-console_observability"><div class="titlepage"><div><div><h3 class="title">1.15.5. Accessing the Jaeger console</h3></div></div></div><p>
					To access the Jaeger console you must have Red Hat OpenShift Service Mesh installed, Red Hat OpenShift distributed tracing platform (Jaeger) installed and configured.
				</p><p>
					The installation process creates a route to access the Jaeger console.
				</p><p>
					If you know the URL for the Jaeger console, you can access it directly. If you do not know the URL, use the following directions.
				</p><div class="orderedlist"><p class="title"><strong>Procedure from OpenShift console</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform web console as a user with cluster-admin rights. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
						</li><li class="listitem">
							Navigate to <span class="strong strong"><strong>Networking</strong></span> → <span class="strong strong"><strong>Routes</strong></span>.
						</li><li class="listitem"><p class="simpara">
							On the <span class="strong strong"><strong>Routes</strong></span> page, select the Service Mesh control plane project, for example <code class="literal">istio-system</code>, from the <span class="strong strong"><strong>Namespace</strong></span> menu.
						</p><p class="simpara">
							The <span class="strong strong"><strong>Location</strong></span> column displays the linked address for each route.
						</p></li><li class="listitem">
							If necessary, use the filter to find the <code class="literal">jaeger</code> route. Click the route <span class="strong strong"><strong>Location</strong></span> to launch the console.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Log In With OpenShift</strong></span>.
						</li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure from Kiali console</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Launch the Kiali console.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Distributed Tracing</strong></span> in the left navigation pane.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Log In With OpenShift</strong></span>.
						</li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure from the CLI</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Log in to the OpenShift Container Platform CLI as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
						</p><pre class="programlisting language-terminal">$ oc login --username=&lt;NAMEOFUSER&gt; https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
							To query for details of the route using the command line, enter the following command. In this example, <code class="literal">istio-system</code> is the Service Mesh control plane namespace.
						</p><pre class="programlisting language-terminal">$ export JAEGER_URL=$(oc get route -n istio-system jaeger -o jsonpath='{.spec.host}')</pre></li><li class="listitem">
							Launch a browser and navigate to <code class="literal">https://&lt;JAEGER_URL&gt;</code>, where <code class="literal">&lt;JAEGER_URL&gt;</code> is the route that you discovered in the previous step.
						</li><li class="listitem">
							Log in using the same user name and password that you use to access the OpenShift Container Platform console.
						</li><li class="listitem"><p class="simpara">
							If you have added services to the service mesh and have generated traces, you can use the filters and <span class="strong strong"><strong>Find Traces</strong></span> button to search your trace data.
						</p><p class="simpara">
							If you are validating the console installation, there is no trace data to display.
						</p></li></ol></div><p>
					For more information about configuring Jaeger, see the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/distributed_tracing/#distr-tracing-deploy-default_deploying-distributed-tracing-platform">distributed tracing documentation</a>.
				</p></section><section class="section" id="ossm-access-grafana_observability"><div class="titlepage"><div><div><h3 class="title">1.15.6. Accessing the Grafana console</h3></div></div></div><p>
					Grafana is an analytics tool you can use to view, query, and analyze your service mesh metrics. In this example, <code class="literal">istio-system</code> is the Service Mesh control plane namespace. To access Grafana, do the following:
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform web console.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Project</strong></span> menu and select the project where you installed the Service Mesh control plane, for example <span class="strong strong"><strong>istio-system</strong></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Routes</strong></span>.
						</li><li class="listitem">
							Click the link in the <span class="strong strong"><strong>Location</strong></span> column for the <span class="strong strong"><strong>Grafana</strong></span> row.
						</li><li class="listitem">
							Log in to the Grafana console with your OpenShift Container Platform credentials.
						</li></ol></div></section><section class="section" id="ossm-access-prometheus_observability"><div class="titlepage"><div><div><h3 class="title">1.15.7. Accessing the Prometheus console</h3></div></div></div><p>
					Prometheus is a monitoring and alerting tool that you can use to collect multi-dimensional data about your microservices. In this example, <code class="literal">istio-system</code> is the Service Mesh control plane namespace.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform web console.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Project</strong></span> menu and select the project where you installed the Service Mesh control plane, for example <span class="strong strong"><strong>istio-system</strong></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Routes</strong></span>.
						</li><li class="listitem">
							Click the link in the <span class="strong strong"><strong>Location</strong></span> column for the <span class="strong strong"><strong>Prometheus</strong></span> row.
						</li><li class="listitem">
							Log in to the Prometheus console with your OpenShift Container Platform credentials.
						</li></ol></div></section><section class="section" id="ossm-integrating-with-user-workload-monitoring_observability"><div class="titlepage"><div><div><h3 class="title">1.15.8. Integrating with user-workload monitoring</h3></div></div></div><p>
					By default, Red Hat OpenShift Service Mesh (OSSM) installs the Service Mesh control plane (SMCP) with a dedicated instance of Prometheus for collecting metrics from a mesh. However, production systems need more advanced monitoring systems, like OpenShift Container Platform monitoring for user-defined projects.
				</p><p>
					The following steps show how to integrate Service Mesh with user-workload monitoring.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							User-workload monitoring is enabled.
						</li><li class="listitem">
							Red Hat OpenShift Service Mesh Operator 2.4 is installed.
						</li><li class="listitem">
							Kiali Operator 1.65 is installed.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a token to Thanos for Kiali by running the following commands:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Set the <code class="literal">SECRET</code> environment variable by running the following command:
								</p><pre class="programlisting language-terminal">$ SECRET=`oc get secret -n openshift-user-workload-monitoring |
 grep  prometheus-user-workload-token | head -n 1 | awk '{print $1 }'`</pre></li><li class="listitem"><p class="simpara">
									Set the <code class="literal">TOKEN</code> environment variable by running the following command:
								</p><pre class="programlisting language-terminal">$ TOKEN=`oc get secret $SECRET -n openshift-user-workload-monitoring -o jsonpath='{.data.token}' | base64 -d`</pre></li><li class="listitem"><p class="simpara">
									Create a token to Thanos for Kiali by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create secret generic thanos-querier-web-token -n istio-system --from-literal=token=$TOKEN</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Configure Kiali for user-workload monitoring:
						</p><pre class="programlisting language-yaml">apiVersion: kiali.io/v1alpha1
kind: Kiali
metadata:
  name: kiali-user-workload-monitoring
  namespace: istio-system
spec:
  external_services:
    istio:
      url_service_version: 'http://istiod-basic.istio-system:15014/version'
    prometheus:
      auth:
        token: secret:thanos-querier-web-token:token
        type: bearer
        use_kiali_token: false
      query_scope:
        mesh_id: "basic-istio-system"
      thanos_proxy:
        enabled: true
      url: https://thanos-querier.openshift-monitoring.svc.cluster.local:9091
  version: v1.65</pre></li><li class="listitem"><p class="simpara">
							Configure the SMCP for external Prometheus:
						</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
  namespace: istio-system
spec:
  addons:
    prometheus:
      enabled: false <span id="CO15-1"><!--Empty--></span><span class="callout">1</span>
    grafana:
      enabled: false <span id="CO15-2"><!--Empty--></span><span class="callout">2</span>
    kiali:
      name: kiali-user-workload-monitoring
  meshConfig:
    extensionProviders:
    - name: prometheus
      prometheus: {}</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO15-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Disable the default Prometheus instance provided by OSSM.
								</div></dd><dt><a href="#CO15-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Disable Grafana. It is not supported with an external Prometheus instance.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Apply a custom network policy to allow ingress traffic from the monitoring namespace:
						</p><pre class="programlisting language-yaml">apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: user-workload-access
  namespace: bookinfo <span id="CO16-1"><!--Empty--></span><span class="callout">1</span>
spec:
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          network.openshift.io/policy-group: monitoring
  podSelector: {}
  policyTypes:
  - Ingress</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO16-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									The custom network policy must be applied to all namespaces.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Apply a <code class="literal">Telemetry</code> object to enable traffic metrics in Istio proxies:
						</p><pre class="programlisting language-yaml">apiVersion: telemetry.istio.io/v1alpha1
kind: Telemetry
metadata:
  name: enable-prometheus-metrics
  namespace: istio-system <span id="CO17-1"><!--Empty--></span><span class="callout">1</span>
spec:
  selector: <span id="CO17-2"><!--Empty--></span><span class="callout">2</span>
    matchLabels:
      app: bookinfo
  metrics:
  - providers:
    - name: prometheus</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO17-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									A <code class="literal">Telemetry</code> object created in the control plane namespace applies to all workloads in a mesh. To apply telemetry to only one namespace, create the object in the target namespace.
								</div></dd><dt><a href="#CO17-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Optional: Setting the <code class="literal">selector.matchLabels</code> spec applies the <code class="literal">Telemetry</code> object to specific workloads in the target namespace.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Apply a <code class="literal">ServiceMonitor</code> object to monitor the Istio control plane:
						</p><pre class="programlisting language-yaml">apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: istiod-monitor
  namespace: istio-system <span id="CO18-1"><!--Empty--></span><span class="callout">1</span>
spec:
  targetLabels:
  - app
  selector:
    matchLabels:
      istio: pilot
  endpoints:
  - port: http-monitoring
    interval: 30s
    relabelings:
    - action: replace
      replacement: "basic-istio-system" <span id="CO18-2"><!--Empty--></span><span class="callout">2</span>
      targetLabel: mesh_id</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO18-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Since OpenShift Container Platform monitoring ignores the <code class="literal">namespaceSelector</code> spec in <code class="literal">ServiceMonitor</code> and <code class="literal">PodMonitor</code> objects, you must apply the <code class="literal">PodMonitor</code> object in all mesh namespaces, including the control plane namespace.
								</div></dd><dt><a href="#CO18-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									The string <code class="literal">"basic-istio-system"</code> is a combination of the SMCP name and its namespace, but any label can be used as long as it is unique for every mesh using user workload monitoring in the cluster. The <code class="literal">spec.prometheus.query_scope</code> of the Kiali resource configured in Step 2 needs to match this value.
								</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								If there is only one mesh using user-workload monitoring, then both the <code class="literal">mesh_id</code> relabeling and the <code class="literal">spec.prometheus.query_scope</code> field in the Kiali resource are optional (but the <code class="literal">query_scope</code> field given here should be removed if the <code class="literal">mesh_id</code> label is removed).
							</p><p>
								If there might be multiple meshes using user-workload monitoring, then both the <code class="literal">mesh_id</code> relabelings and the <code class="literal">spec.prometheus.query_scope</code> field in the Kiali resource are required so that Kiali only sees metrics from its associated mesh. If Kiali is not being deployed, applying the <code class="literal">mesh_id</code> relabeling is still recommended so that metrics from different meshes can be distinguished from one another.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Apply a <code class="literal">PodMonitor</code> object to collect metrics from Istio proxies:
						</p><pre class="programlisting language-yaml">apiVersion: monitoring.coreos.com/v1
kind: PodMonitor
metadata:
  name: istio-proxies-monitor
  namespace: istio-system <span id="CO19-1"><!--Empty--></span><span class="callout">1</span>
spec:
  selector:
    matchExpressions:
    - key: istio-prometheus-ignore
      operator: DoesNotExist
  podMetricsEndpoints:
  - path: /stats/prometheus
    interval: 30s
    relabelings:
    - action: keep
      sourceLabels: [__meta_kubernetes_pod_container_name]
      regex: "istio-proxy"
    - action: keep
      sourceLabels: [__meta_kubernetes_pod_annotationpresent_prometheus_io_scrape]
    - action: replace
      regex: (\d+);(([A-Fa-f0-9]{1,4}::?){1,7}[A-Fa-f0-9]{1,4})
      replacement: '[$2]:$1'
      sourceLabels: [__meta_kubernetes_pod_annotation_prometheus_io_port,
      __meta_kubernetes_pod_ip]
      targetLabel: __address__
    - action: replace
      regex: (\d+);((([0-9]+?)(\.|$)){4})
      replacement: $2:$1
      sourceLabels: [__meta_kubernetes_pod_annotation_prometheus_io_port,
      __meta_kubernetes_pod_ip]
      targetLabel: __address__
    - action: labeldrop
      regex: "__meta_kubernetes_pod_label_(.+)"
    - sourceLabels: [__meta_kubernetes_namespace]
      action: replace
      targetLabel: namespace
    - sourceLabels: [__meta_kubernetes_pod_name]
      action: replace
      targetLabel: pod_name
    - action: replace
      replacement: "basic-istio-system" <span id="CO19-2"><!--Empty--></span><span class="callout">2</span>
      targetLabel: mesh_id</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO19-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Since OpenShift Container Platform monitoring ignores the <code class="literal">namespaceSelector</code> spec in <code class="literal">ServiceMonitor</code> and <code class="literal">PodMonitor</code> objects, you must apply the <code class="literal">PodMonitor</code> object in all mesh namespaces, including the control plane namespace.
								</div></dd><dt><a href="#CO19-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									The string <code class="literal">"basic-istio-system"</code> is a combination of the SMCP name and its namespace, but any label can be used as long as it is unique for every mesh using user workload monitoring in the cluster. The <code class="literal">spec.prometheus.query_scope</code> of the Kiali resource configured in Step 2 needs to match this value.
								</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								If there is only one mesh using user-workload monitoring, then both the <code class="literal">mesh_id</code> relabeling and the <code class="literal">spec.prometheus.query_scope</code> field in the Kiali resource are optional (but the <code class="literal">query_scope</code> field given here should be removed if the <code class="literal">mesh_id</code> label is removed).
							</p><p>
								If there might be multiple meshes using user-workload monitoring, then both the <code class="literal">mesh_id</code> relabelings and the <code class="literal">spec.prometheus.query_scope</code> field in the Kiali resource are required so that Kiali only sees metrics from its associated mesh. If Kiali is not being deployed, applying the <code class="literal">mesh_id</code> relabeling is still recommended so that metrics from different meshes can be distinguished from one another.
							</p></div></div></li><li class="listitem">
							Open the OpenShift Container Platform web console, and check that metrics are visible.
						</li></ol></div></section><section class="section _additional-resources" id="additional-resources_user-workload-monitoring"><div class="titlepage"><div><div><h3 class="title">1.15.9. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/monitoring/#enabling-monitoring-for-user-defined-projects-1">Enabling monitoring for user-defined projects</a>
						</li></ul></div></section></section><section class="section" id="ossm-performance-scalability"><div class="titlepage"><div><div><h2 class="title">1.16. Performance and scalability</h2></div></div></div><p>
				The default <code class="literal">ServiceMeshControlPlane</code> settings are not intended for production use; they are designed to install successfully on a default OpenShift Container Platform installation, which is a resource-limited environment. After you have verified a successful SMCP installation, you should modify the settings defined within the SMCP to suit your environment.
			</p><section class="section" id="ossm-recommended-resources_performance-scalability"><div class="titlepage"><div><div><h3 class="title">1.16.1. Setting limits on compute resources</h3></div></div></div><p>
					By default, <code class="literal">spec.proxy</code> has the settings <code class="literal">cpu: 10m</code> and <code class="literal">memory: 128M</code>. If you are using Pilot, <code class="literal">spec.runtime.components.pilot</code> has the same default values.
				</p><p>
					The settings in the following example are based on 1,000 services and 1,000 requests per second. You can change the values for <code class="literal">cpu</code> and <code class="literal">memory</code> in the <code class="literal">ServiceMeshControlPlane</code>.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the OpenShift Container Platform web console, click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Project</strong></span> menu and select the project where you installed the Service Mesh control plane, for example <span class="strong strong"><strong>istio-system</strong></span>.
						</li><li class="listitem">
							Click the Red Hat OpenShift Service Mesh Operator. In the <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span> column, click the name of your <code class="literal">ServiceMeshControlPlane</code>, for example <code class="literal">basic</code>.
						</li><li class="listitem"><p class="simpara">
							Add the name of your standalone Jaeger instance to the <code class="literal">ServiceMeshControlPlane</code>.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Click the <span class="strong strong"><strong>YAML</strong></span> tab.
								</li><li class="listitem"><p class="simpara">
									Set the values for <code class="literal">spec.proxy.runtime.container.resources.requests.cpu</code> and <code class="literal">spec.proxy.runtime.container.resources.requests.memory</code> in your <code class="literal">ServiceMeshControlPlane</code> resource.
								</p><div class="formalpara"><p class="title"><strong>Example version 2.4 ServiceMeshControlPlane</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
  namespace: istio-system
spec:
  version: v2.4
  proxy:
    runtime:
      container:
        resources:
          requests:
            cpu: 600m
            memory: 50Mi
          limits: {}

  runtime:
    components:
      pilot:
        container:
          resources:
            requests:
              cpu: 1000m
              memory: 1.6Gi
            limits: {}</pre>

									</p></div></li><li class="listitem">
									Click <span class="strong strong"><strong>Save</strong></span>.
								</li></ol></div></li><li class="listitem">
							Click <span class="strong strong"><strong>Reload</strong></span> to verify the <code class="literal">ServiceMeshControlPlane</code> resource was configured correctly.
						</li></ol></div></section><section class="section" id="ossm-load-test-results_performance-scalability"><div class="titlepage"><div><div><h3 class="title">1.16.2. Load test results</h3></div></div></div><p>
					The upstream Istio community load tests mesh consists of <span class="strong strong"><strong>1000</strong></span> services and <span class="strong strong"><strong>2000</strong></span> sidecars with 70,000 mesh-wide requests per second. Running the tests using Istio 1.12.3, generated the following results:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The Envoy proxy uses <span class="strong strong"><strong>0.35 vCPU</strong></span> and <span class="strong strong"><strong>40 MB memory</strong></span> per 1000 requests per second going through the proxy.
						</li><li class="listitem">
							Istiod uses <span class="strong strong"><strong>1 vCPU</strong></span> and <span class="strong strong"><strong>1.5 GB</strong></span> of memory.
						</li><li class="listitem">
							The Envoy proxy adds <span class="strong strong"><strong>2.65 ms</strong></span> to the 90th percentile latency.
						</li><li class="listitem">
							The legacy <code class="literal">istio-telemetry</code> service (disabled by default in Service Mesh 2.0) uses <span class="strong strong"><strong>0.6 vCPU</strong></span> per 1000 mesh-wide requests per second for deployments that use Mixer. The data plane components, the Envoy proxies, handle data flowing through the system. The Service Mesh control plane component, Istiod, configures the data plane. The data plane and control plane have distinct performance concerns.
						</li></ul></div><section class="section" id="service-mesh-control-plane-performance"><div class="titlepage"><div><div><h4 class="title">1.16.2.1. Service Mesh Control plane performance</h4></div></div></div><p>
						Istiod configures sidecar proxies based on user authored configuration files and the current state of the system. In a Kubernetes environment, Custom Resource Definitions (CRDs) and deployments constitute the configuration and state of the system. The Istio configuration objects like gateways and virtual services, provide the user-authored configuration. To produce the configuration for the proxies, Istiod processes the combined configuration and system state from the Kubernetes environment and the user-authored configuration.
					</p><p>
						The Service Mesh control plane supports thousands of services, spread across thousands of pods with a similar number of user authored virtual services and other configuration objects. Istiod’s CPU and memory requirements scale with the number of configurations and possible system states. The CPU consumption scales with the following factors:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The rate of deployment changes.
							</li><li class="listitem">
								The rate of configuration changes.
							</li><li class="listitem">
								The number of proxies connecting to Istiod.
							</li></ul></div><p>
						However this part is inherently horizontally scalable.
					</p></section><section class="section" id="data-plane-performance"><div class="titlepage"><div><div><h4 class="title">1.16.2.2. Data plane performance</h4></div></div></div><p>
						Data plane performance depends on many factors, for example:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Number of client connections
							</li><li class="listitem">
								Target request rate
							</li><li class="listitem">
								Request size and response size
							</li><li class="listitem">
								Number of proxy worker threads
							</li><li class="listitem">
								Protocol
							</li><li class="listitem">
								CPU cores
							</li><li class="listitem">
								Number and types of proxy filters, specifically telemetry v2 related filters.
							</li></ul></div><p>
						The latency, throughput, and the proxies' CPU and memory consumption are measured as a function of these factors.
					</p><section class="section" id="cpu-and-memory-consumption"><div class="titlepage"><div><div><h5 class="title">1.16.2.2.1. CPU and memory consumption</h5></div></div></div><p>
							Since the sidecar proxy performs additional work on the data path, it consumes CPU and memory. As of Istio 1.12.3, a proxy consumes about 0.5 vCPU per 1000 requests per second.
						</p><p>
							The memory consumption of the proxy depends on the total configuration state the proxy holds. A large number of listeners, clusters, and routes can increase memory usage.
						</p><p>
							Since the proxy normally doesn’t buffer the data passing through, request rate doesn’t affect the memory consumption.
						</p></section><section class="section" id="additional-latency"><div class="titlepage"><div><div><h5 class="title">1.16.2.2.2. Additional latency</h5></div></div></div><p>
							Since Istio injects a sidecar proxy on the data path, latency is an important consideration. Istio adds an authentication filter, a telemetry filter, and a metadata exchange filter to the proxy. Every additional filter adds to the path length inside the proxy and affects latency.
						</p><p>
							The Envoy proxy collects raw telemetry data after a response is sent to the client. The time spent collecting raw telemetry for a request does not contribute to the total time taken to complete that request. However, since the worker is busy handling the request, the worker won’t start handling the next request immediately. This process adds to the queue wait time of the next request and affects average and tail latencies. The actual tail latency depends on the traffic pattern.
						</p><p>
							Inside the mesh, a request traverses the client-side proxy and then the server-side proxy. In the default configuration of Istio 1.12.3 (that is, Istio with telemetry v2), the two proxies add about 1.7 ms and 2.7 ms to the 90th and 99th percentile latency, respectively, over the baseline data plane latency.
						</p></section></section></section></section><section class="section" id="ossm-production"><div class="titlepage"><div><div><h2 class="title">1.17. Configuring Service Mesh for production</h2></div></div></div><p>
				When you are ready to move from a basic installation to production, you must configure your control plane, tracing, and security certificates to meet production requirements.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Install and configure Red Hat OpenShift Service Mesh.
					</li><li class="listitem">
						Test your configuration in a staging environment.
					</li></ul></div><section class="section" id="ossm-smcp-prod_ossm-architecture"><div class="titlepage"><div><div><h3 class="title">1.17.1. Configuring your ServiceMeshControlPlane resource for production</h3></div></div></div><p>
					If you have installed a basic <code class="literal">ServiceMeshControlPlane</code> resource to test Service Mesh, you must configure it to production specification before you use Red Hat OpenShift Service Mesh in production.
				</p><p>
					You cannot change the <code class="literal">metadata.name</code> field of an existing <code class="literal">ServiceMeshControlPlane</code> resource. For production deployments, you must customize the default template.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Configure the distributed tracing platform (Jaeger) for production.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Edit the <code class="literal">ServiceMeshControlPlane</code> resource to use the <code class="literal">production</code> deployment strategy, by setting <code class="literal">spec.addons.jaeger.install.storage.type</code> to <code class="literal">Elasticsearch</code> and specify additional configuration options under <code class="literal">install</code>. You can create and configure your Jaeger instance and set <code class="literal">spec.addons.jaeger.name</code> to the name of the Jaeger instance.
								</p><div class="formalpara"><p class="title"><strong>Default Jaeger parameters including Elasticsearch</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
spec:
  version: v2.4
  tracing:
    sampling: 100
    type: Jaeger
  addons:
    jaeger:
      name: MyJaeger
      install:
        storage:
          type: Elasticsearch
        ingress:
          enabled: true
  runtime:
    components:
      tracing.jaeger.elasticsearch: # only supports resources and image name
        container:
          resources: {}</pre>

									</p></div></li><li class="listitem">
									Configure the sampling rate for production. For more information, see the Performance and scalability section.
								</li></ol></div></li><li class="listitem">
							Ensure your security certificates are production ready by installing security certificates from an external certificate authority. For more information, see the Security section.
						</li><li class="listitem"><p class="simpara">
							Verify the results. Enter the following command to verify that the <code class="literal">ServiceMeshControlPlane</code> resource updated properly. In this example, <code class="literal">basic</code> is the name of the <code class="literal">ServiceMeshControlPlane</code> resource.
						</p><pre class="programlisting language-terminal">$ oc get smcp basic -o yaml</pre></li></ol></div></section><section class="section _additional-resources" id="additional-resources_ossm-production"><div class="titlepage"><div><div><h3 class="title">1.17.2. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							For more information about tuning Service Mesh for performance, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-performance-scalability">Performance and scalability</a>.
						</li></ul></div></section></section><section class="section" id="ossm-federation"><div class="titlepage"><div><div><h2 class="title">1.18. Connecting service meshes</h2></div></div></div><p>
				<span class="emphasis"><em>Federation</em></span> is a deployment model that lets you share services and workloads between separate meshes managed in distinct administrative domains.
			</p><section class="section" id="ossm-federation-overview_federation"><div class="titlepage"><div><div><h3 class="title">1.18.1. Federation overview</h3></div></div></div><p>
					Federation is a set of features that let you connect services between separate meshes, allowing the use of Service Mesh features such as authentication, authorization, and traffic management across multiple, distinct administrative domains.
				</p><p>
					Implementing a federated mesh lets you run, manage, and observe a single service mesh running across multiple OpenShift clusters. Red Hat OpenShift Service Mesh federation takes an opinionated approach to a multi-cluster implementation of Service Mesh that assumes <span class="emphasis"><em>minimal</em></span> trust between meshes.
				</p><p>
					Service Mesh federation assumes that each mesh is managed individually and retains its own administrator. The default behavior is that no communication is permitted and no information is shared between meshes. The sharing of information between meshes is on an explicit opt-in basis. Nothing is shared in a federated mesh unless it has been configured for sharing. Support functions such as certificate generation, metrics and trace collection remain local in their respective meshes.
				</p><p>
					You configure the <code class="literal">ServiceMeshControlPlane</code> on each service mesh to create ingress and egress gateways specifically for the federation, and to specify the trust domain for the mesh.
				</p><p>
					Federation also involves the creation of additional federation files. The following resources are used to configure the federation between two or more meshes.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A <span class="strong strong"><strong>ServiceMeshPeer</strong></span> resource declares the federation between a pair of service meshes.
						</li><li class="listitem">
							An <span class="strong strong"><strong>ExportedServiceSet</strong></span> resource declares that one or more services from the mesh are available for use by a peer mesh.
						</li><li class="listitem">
							An <span class="strong strong"><strong>ImportedServiceSet</strong></span> resource declares which services exported by a peer mesh will be imported into the mesh.
						</li></ul></div></section><section class="section" id="ossm-federation-features_federation"><div class="titlepage"><div><div><h3 class="title">1.18.2. Federation features</h3></div></div></div><p class="_abstract _abstract">
					Features of the Red Hat OpenShift Service Mesh federated approach to joining meshes include the following:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Supports common root certificates for each mesh.
						</li><li class="listitem">
							Supports different root certificates for each mesh.
						</li><li class="listitem">
							Mesh administrators must manually configure certificate chains, service discovery endpoints, trust domains, etc for meshes outside of the Federated mesh.
						</li><li class="listitem"><p class="simpara">
							Only export/import the services that you want to share between meshes.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Defaults to not sharing information about deployed workloads with other meshes in the federation. A service can be <span class="strong strong"><strong>exported</strong></span> to make it visible to other meshes and allow requests from workloads outside of its own mesh.
								</li><li class="listitem">
									A service that has been exported can be <span class="strong strong"><strong>imported</strong></span> to another mesh, enabling workloads on that mesh to send requests to the imported service.
								</li></ul></div></li><li class="listitem">
							Encrypts communication between meshes at all times.
						</li><li class="listitem">
							Supports configuring load balancing across workloads deployed locally and workloads that are deployed in another mesh in the federation.
						</li></ul></div><p>
					When a mesh is joined to another mesh it can do the following:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Provide trust details about itself to the federated mesh.
						</li><li class="listitem">
							Discover trust details about the federated mesh.
						</li><li class="listitem">
							Provide information to the federated mesh about its own exported services.
						</li><li class="listitem">
							Discover information about services exported by the federated mesh.
						</li></ul></div></section><section class="section" id="ossm-federation-security_federation"><div class="titlepage"><div><div><h3 class="title">1.18.3. Federation security</h3></div></div></div><p>
					Red Hat OpenShift Service Mesh federation takes an opinionated approach to a multi-cluster implementation of Service Mesh that assumes minimal trust between meshes. Data security is built in as part of the federation features.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Each mesh is considered to be a unique tenant, with a unique administration.
						</li><li class="listitem">
							You create a unique trust domain for each mesh in the federation.
						</li><li class="listitem">
							Traffic between the federated meshes is automatically encrypted using mutual Transport Layer Security (mTLS).
						</li><li class="listitem">
							The Kiali graph only displays your mesh and services that you have imported. You cannot see the other mesh or services that have not been imported into your mesh.
						</li></ul></div></section><section class="section" id="ossm-federation-limitations_federation"><div class="titlepage"><div><div><h3 class="title">1.18.4. Federation limitations</h3></div></div></div><p>
					The Red Hat OpenShift Service Mesh federated approach to joining meshes has the following limitations:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Federation of meshes is not supported on OpenShift Dedicated.
						</li></ul></div></section><section class="section" id="ossm-federation-prerequisites_federation"><div class="titlepage"><div><div><h3 class="title">1.18.5. Federation prerequisites</h3></div></div></div><p>
					The Red Hat OpenShift Service Mesh federated approach to joining meshes has the following prerequisites:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Two or more OpenShift Container Platform 4.6 or above clusters.
						</li><li class="listitem">
							Federation was introduced in Red Hat OpenShift Service Mesh 2.1 or later. You must have the Red Hat OpenShift Service Mesh 2.1 or later Operator installed on each mesh that you want to federate.
						</li><li class="listitem">
							You must have a version 2.1 or later <code class="literal">ServiceMeshControlPlane</code> deployed on each mesh that you want to federate.
						</li><li class="listitem">
							You must configure the load balancers supporting the services associated with the federation gateways to support raw TLS traffic. Federation traffic consists of HTTPS for discovery and raw encrypted TCP for service traffic.
						</li><li class="listitem">
							Services that you want to expose to another mesh should be deployed before you can export and import them. However, this is not a strict requirement. You can specify service names that do not yet exist for export/import. When you deploy the services named in the <code class="literal">ExportedServiceSet</code> and <code class="literal">ImportedServiceSet</code> they will be automatically made available for export/import.
						</li></ul></div></section><section class="section" id="ossm-federation-planning_federation"><div class="titlepage"><div><div><h3 class="title">1.18.6. Planning your mesh federation</h3></div></div></div><p>
					Before you start configuring your mesh federation, you should take some time to plan your implementation.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							How many meshes do you plan to join in a federation? You probably want to start with a limited number of meshes, perhaps two or three.
						</li><li class="listitem"><p class="simpara">
							What naming convention do you plan to use for each mesh? Having a pre-defined naming convention will help with configuration and troubleshooting. The examples in this documentation use different colors for each mesh. You should decide on a naming convention that will help you determine who owns and manages each mesh, as well as the following federation resources:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Cluster names
								</li><li class="listitem">
									Cluster network names
								</li><li class="listitem">
									Mesh names and namespaces
								</li><li class="listitem">
									Federation ingress gateways
								</li><li class="listitem">
									Federation egress gateways
								</li><li class="listitem"><p class="simpara">
									Security trust domains
								</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Each mesh in the federation must have its own unique trust domain.
									</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Which services from each mesh do you plan to export to the federated mesh? Each service can be exported individually, or you can specify labels or use wildcards.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Do you want to use aliases for the service namespaces?
								</li><li class="listitem">
									Do you want to use aliases for the exported services?
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Which exported services does each mesh plan to import? Each mesh only imports the services that it needs.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Do you want to use aliases for the imported services?
								</li></ul></div></li></ul></div></section><section class="section" id="ossm-federation-across-clusters_federation"><div class="titlepage"><div><div><h3 class="title">1.18.7. Mesh federation across clusters</h3></div></div></div><p>
					To connect one instance of the OpenShift Service Mesh with one running in a different cluster, the procedure is not much different as when connecting two meshes deployed in the same cluster. However, the ingress gateway of one mesh must be reachable from the other mesh. One way of ensuring this is to configure the gateway service as a <code class="literal">LoadBalancer</code> service if the cluster supports this type of service.
				</p><p>
					The service must be exposed through a load balancer that operates at Layer4 of the OSI model.
				</p><section class="section" id="exposing-the-federation-ingress-on-clusters-running-on-bare-metal"><div class="titlepage"><div><div><h4 class="title">1.18.7.1. Exposing the federation ingress on clusters running on bare metal</h4></div></div></div><p>
						If the cluster runs on bare metal and fully supports <code class="literal">LoadBalancer</code> services, the IP address found in the <code class="literal">.status.loadBalancer.ingress.ip</code> field of the ingress gateway <code class="literal">Service</code> object should be specified as one of the entries in the <code class="literal">.spec.remote.addresses</code> field of the <code class="literal">ServiceMeshPeer</code> object.
					</p><p>
						If the cluster does not support <code class="literal">LoadBalancer</code> services, using a <code class="literal">NodePort</code> service could be an option if the nodes are accessible from the cluster running the other mesh. In the <code class="literal">ServiceMeshPeer</code> object, specify the IP addresses of the nodes in the <code class="literal">.spec.remote.addresses</code> field and the service’s node ports in the <code class="literal">.spec.remote.discoveryPort</code> and <code class="literal">.spec.remote.servicePort</code> fields.
					</p></section><section class="section" id="exposing-the-federation-ingress-on-clusters-running-on-ibm-power-and-ibm-z"><div class="titlepage"><div><div><h4 class="title">1.18.7.2. Exposing the federation ingress on clusters running on IBM Power and IBM Z</h4></div></div></div><p>
						If the cluster runs on IBM Power or IBM Z infrastructure and fully supports <code class="literal">LoadBalancer</code> services, the IP address found in the <code class="literal">.status.loadBalancer.ingress.ip</code> field of the ingress gateway <code class="literal">Service</code> object should be specified as one of the entries in the <code class="literal">.spec.remote.addresses</code> field of the <code class="literal">ServiceMeshPeer</code> object.
					</p><p>
						If the cluster does not support <code class="literal">LoadBalancer</code> services, using a <code class="literal">NodePort</code> service could be an option if the nodes are accessible from the cluster running the other mesh. In the <code class="literal">ServiceMeshPeer</code> object, specify the IP addresses of the nodes in the <code class="literal">.spec.remote.addresses</code> field and the service’s node ports in the <code class="literal">.spec.remote.discoveryPort</code> and <code class="literal">.spec.remote.servicePort</code> fields.
					</p></section><section class="section" id="exposing-the-federation-ingress-on-amazon-web-services-aws"><div class="titlepage"><div><div><h4 class="title">1.18.7.3. Exposing the federation ingress on Amazon Web Services (AWS)</h4></div></div></div><p>
						By default, LoadBalancer services in clusters running on AWS do not support L4 load balancing. In order for Red Hat OpenShift Service Mesh federation to operate correctly, the following annotation must be added to the ingress gateway service:
					</p><p>
						service.beta.kubernetes.io/aws-load-balancer-type: nlb
					</p><p>
						The Fully Qualified Domain Name found in the <code class="literal">.status.loadBalancer.ingress.hostname</code> field of the ingress gateway <code class="literal">Service</code> object should be specified as one of the entries in the <code class="literal">.spec.remote.addresses</code> field of the <code class="literal">ServiceMeshPeer</code> object.
					</p></section><section class="section" id="exposing-the-federation-ingress-on-azure"><div class="titlepage"><div><div><h4 class="title">1.18.7.4. Exposing the federation ingress on Azure</h4></div></div></div><p>
						On Microsoft Azure, merely setting the service type to <code class="literal">LoadBalancer</code> suffices for mesh federation to operate correctly.
					</p><p>
						The IP address found in the <code class="literal">.status.loadBalancer.ingress.ip</code> field of the ingress gateway <code class="literal">Service</code> object should be specified as one of the entries in the <code class="literal">.spec.remote.addresses</code> field of the <code class="literal">ServiceMeshPeer</code> object.
					</p></section><section class="section" id="exposing-the-federation-ingress-on-google-cloud-platform-gcp"><div class="titlepage"><div><div><h4 class="title">1.18.7.5. Exposing the federation ingress on Google Cloud Platform (GCP)</h4></div></div></div><p>
						On Google Cloud Platform, merely setting the service type to <code class="literal">LoadBalancer</code> suffices for mesh federation to operate correctly.
					</p><p>
						The IP address found in the <code class="literal">.status.loadBalancer.ingress.ip</code> field of the ingress gateway <code class="literal">Service</code> object should be specified as one of the entries in the <code class="literal">.spec.remote.addresses</code> field of the <code class="literal">ServiceMeshPeer</code> object.
					</p></section></section><section class="section" id="con-my-concept-module-a_federation"><div class="titlepage"><div><div><h3 class="title">1.18.8. Federation implementation checklist</h3></div></div></div><p>
					Federating services meshes involves the following activities:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="none"><li class="listitem"><p class="simpara">
							❏ Configure networking between the clusters that you are going to federate.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="none"><li class="listitem">
									❏ Configure the load balancers supporting the services associated with the federation gateways to support raw TLS traffic.
								</li></ul></div></li><li class="listitem">
							❏ Installing the Red Hat OpenShift Service Mesh version 2.1 or later Operator in each of your clusters.
						</li><li class="listitem">
							❏ Deploying a version 2.1 or later <code class="literal">ServiceMeshControlPlane</code> to each of your clusters.
						</li><li class="listitem"><p class="simpara">
							❏ Configuring the SMCP for federation for each mesh that you want to federate:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="none"><li class="listitem">
									❏ Create a federation egress gateway for each mesh you are going to federate with.
								</li><li class="listitem">
									❏ Create a federation ingress gateway for each mesh you are going to federate with.
								</li><li class="listitem">
									❏ Configure a unique trust domain.
								</li></ul></div></li><li class="listitem">
							❏ Federate two or more meshes by creating a <code class="literal">ServiceMeshPeer</code> resource for each mesh pair.
						</li><li class="listitem">
							❏ Export services by creating an <code class="literal">ExportedServiceSet</code> resource to make services available from one mesh to a peer mesh.
						</li><li class="listitem">
							❏ Import services by creating an <code class="literal">ImportedServiceSet</code> resource to import services shared by a mesh peer.
						</li></ul></div></section><section class="section" id="ossm-federation-config-smcp_federation"><div class="titlepage"><div><div><h3 class="title">1.18.9. Configuring a Service Mesh control plane for federation</h3></div></div></div><p>
					Before a mesh can be federated, you must configure the <code class="literal">ServiceMeshControlPlane</code> for mesh federation. Because all meshes that are members of the federation are equal, and each mesh is managed independently, you must configure the SMCP for <span class="emphasis"><em>each</em></span> mesh that will participate in the federation.
				</p><p>
					In the following example, the administrator for the <code class="literal">red-mesh</code> is configuring the SMCP for federation with both the <code class="literal">green-mesh</code> and the <code class="literal">blue-mesh</code>.
				</p><div class="formalpara"><p class="title"><strong>Sample SMCP for red-mesh</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: red-mesh
  namespace: red-mesh-system
spec:
  version: v2.4
  runtime:
    defaults:
      container:
        imagePullPolicy: Always
  gateways:
    additionalEgress:
      egress-green-mesh:
        enabled: true
        requestedNetworkView:
        - green-network
        routerMode: sni-dnat
        service:
          metadata:
            labels:
              federation.maistra.io/egress-for: egress-green-mesh
          ports:
          - port: 15443
            name: tls
          - port: 8188
            name: http-discovery  #note HTTP here
      egress-blue-mesh:
        enabled: true
        requestedNetworkView:
        - blue-network
        routerMode: sni-dnat
        service:
          metadata:
            labels:
              federation.maistra.io/egress-for: egress-blue-mesh
          ports:
          - port: 15443
            name: tls
          - port: 8188
            name: http-discovery  #note HTTP here
    additionalIngress:
      ingress-green-mesh:
        enabled: true
        routerMode: sni-dnat
        service:
          type: LoadBalancer
          metadata:
            labels:
              federation.maistra.io/ingress-for: ingress-green-mesh
          ports:
          - port: 15443
            name: tls
          - port: 8188
            name: https-discovery  #note HTTPS here
      ingress-blue-mesh:
        enabled: true
        routerMode: sni-dnat
        service:
          type: LoadBalancer
          metadata:
            labels:
              federation.maistra.io/ingress-for: ingress-blue-mesh
          ports:
          - port: 15443
            name: tls
          - port: 8188
            name: https-discovery  #note HTTPS here
  security:
    trust:
      domain: red-mesh.local</pre>

					</p></div><div class="table" id="idm140663648649584"><p class="title"><strong>Table 1.6. ServiceMeshControlPlane federation configuration parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663648642848" scope="col">Parameter</th><th align="left" valign="top" id="idm140663648641760" scope="col">Description</th><th align="left" valign="top" id="idm140663648640672" scope="col">Values</th><th align="left" valign="top" id="idm140663648639584" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663648642848">
<pre class="literallayout">spec:
  cluster:
    name:</pre>
								 </td><td align="left" valign="top" headers="idm140663648641760"> <p>
									Name of the cluster. You are not required to specify a cluster name, but it is helpful for troubleshooting.
								</p>
								 </td><td align="left" valign="top" headers="idm140663648640672"> <p>
									String
								</p>
								 </td><td align="left" valign="top" headers="idm140663648639584"> <p>
									N/A
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663648642848">
<pre class="literallayout">spec:
  cluster:
    network:</pre>
								 </td><td align="left" valign="top" headers="idm140663648641760"> <p>
									Name of the cluster network. You are not required to specify a name for the network, but it is helpful for configuration and troubleshooting.
								</p>
								 </td><td align="left" valign="top" headers="idm140663648640672"> <p>
									String
								</p>
								 </td><td align="left" valign="top" headers="idm140663648639584"> <p>
									N/A
								</p>
								 </td></tr></tbody></table></div></div><section class="section" id="understanding-federation-gateways"><div class="titlepage"><div><div><h4 class="title">1.18.9.1. Understanding federation gateways</h4></div></div></div><p>
						You use a <span class="strong strong"><strong>gateway</strong></span> to manage inbound and outbound traffic for your mesh, letting you specify which traffic you want to enter or leave the mesh.
					</p><p>
						You use ingress and egress gateways to manage traffic entering and leaving the service mesh (North-South traffic). When you create a federated mesh, you create additional ingress/egress gateways, to facilitate service discovery between federated meshes, communication between federated meshes, and to manage traffic flow between service meshes (East-West traffic).
					</p><p>
						To avoid naming conflicts between meshes, you must create separate egress and ingress gateways for each mesh. For example, <code class="literal">red-mesh</code> would have separate egress gateways for traffic going to <code class="literal">green-mesh</code> and <code class="literal">blue-mesh</code>.
					</p><div class="table" id="idm140663646357408"><p class="title"><strong>Table 1.7. Federation gateway parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663646350704" scope="col">Parameter</th><th align="left" valign="top" id="idm140663646349616" scope="col">Description</th><th align="left" valign="top" id="idm140663646348528" scope="col">Values</th><th align="left" valign="top" id="idm140663646347440" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663646350704">
<pre class="literallayout">spec:
  gateways:
    additionalEgress:
      &lt;egressName&gt;:</pre>
									 </td><td align="left" valign="top" headers="idm140663646349616"> <p>
										Define an additional egress gateway for <span class="emphasis"><em>each</em></span> mesh peer in the federation.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646348528"> </td><td align="left" valign="top" headers="idm140663646347440"> </td></tr><tr><td align="left" valign="top" headers="idm140663646350704">
<pre class="literallayout">spec:
  gateways:
    additionalEgress:
      &lt;egressName&gt;:
        enabled:</pre>
									 </td><td align="left" valign="top" headers="idm140663646349616"> <p>
										This parameter enables or disables the federation egress.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646348528"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646347440"> <p>
										<code class="literal">true</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663646350704">
<pre class="literallayout">spec:
  gateways:
    additionalEgress:
      &lt;egressName&gt;:
        requestedNetworkView:</pre>
									 </td><td align="left" valign="top" headers="idm140663646349616"> <p>
										Networks associated with exported services.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646348528"> <p>
										Set to the value of <code class="literal">spec.cluster.network</code> in the SMCP for the mesh, otherwise use &lt;ServiceMeshPeer-name&gt;-network. For example, if the <code class="literal">ServiceMeshPeer</code> resource for that mesh is named <code class="literal">west</code>, then the network would be named <code class="literal">west-network</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646347440"> </td></tr><tr><td align="left" valign="top" headers="idm140663646350704">
<pre class="literallayout">spec:
  gateways:
    additionalEgress:
      &lt;egressName&gt;:
        routerMode:</pre>
									 </td><td align="left" valign="top" headers="idm140663646349616"> <p>
										The router mode to be used by the gateway.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646348528"> <p>
										<code class="literal">sni-dnat</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646347440"> </td></tr><tr><td align="left" valign="top" headers="idm140663646350704">
<pre class="literallayout">spec:
  gateways:
    additionalEgress:
      &lt;egressName&gt;:
        service:
          metadata:
            labels:
              federation.maistra.io/egress-for:</pre>
									 </td><td align="left" valign="top" headers="idm140663646349616"> <p>
										Specify a unique label for the gateway to prevent federated traffic from flowing through the cluster’s default system gateways.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646348528"> </td><td align="left" valign="top" headers="idm140663646347440"> </td></tr><tr><td align="left" valign="top" headers="idm140663646350704">
<pre class="literallayout">spec:
  gateways:
    additionalEgress:
      &lt;egressName&gt;:
        service:
          ports:</pre>
									 </td><td align="left" valign="top" headers="idm140663646349616"> <p>
										Used to specify the <code class="literal">port:</code> and <code class="literal">name:</code> used for TLS and service discovery. Federation traffic consists of raw encrypted TCP for service traffic.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646348528"> <p>
										Port <code class="literal">15443</code> is required for sending TLS service requests to other meshes in the federation. Port <code class="literal">8188</code> is required for sending service discovery requests to other meshes in the federation.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646347440"> </td></tr><tr><td align="left" valign="top" headers="idm140663646350704">
<pre class="literallayout">spec:
  gateways:
    additionalIngress:</pre>
									 </td><td align="left" valign="top" headers="idm140663646349616"> <p>
										Define an additional ingress gateway gateway for <span class="emphasis"><em>each</em></span> mesh peer in the federation.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646348528"> </td><td align="left" valign="top" headers="idm140663646347440"> </td></tr><tr><td align="left" valign="top" headers="idm140663646350704">
<pre class="literallayout">spec:
  gateways:
    additionalIgress:
      &lt;ingressName&gt;:
        enabled:</pre>
									 </td><td align="left" valign="top" headers="idm140663646349616"> <p>
										This parameter enables or disables the federation ingress.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646348528"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646347440"> <p>
										<code class="literal">true</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663646350704">
<pre class="literallayout">spec:
  gateways:
    additionalIngress:
      &lt;ingressName&gt;:
        routerMode:</pre>
									 </td><td align="left" valign="top" headers="idm140663646349616"> <p>
										The router mode to be used by the gateway.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646348528"> <p>
										<code class="literal">sni-dnat</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646347440"> </td></tr><tr><td align="left" valign="top" headers="idm140663646350704">
<pre class="literallayout">spec:
  gateways:
    additionalIngress:
      &lt;ingressName&gt;:
        service:
          type:</pre>
									 </td><td align="left" valign="top" headers="idm140663646349616"> <p>
										The ingress gateway service must be exposed through a load balancer that operates at Layer 4 of the OSI model and is publicly available.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646348528"> <p>
										<code class="literal">LoadBalancer</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646347440"> </td></tr><tr><td align="left" valign="top" headers="idm140663646350704">
<pre class="literallayout">spec:
  gateways:
    additionalIngress:
      &lt;ingressName&gt;:
        service:
          type:</pre>
									 </td><td align="left" valign="top" headers="idm140663646349616"> <p>
										If the cluster does not support <code class="literal">LoadBalancer</code> services, the ingress gateway service can be exposed through a <code class="literal">NodePort</code> service.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646348528"> <p>
										<code class="literal">NodePort</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646347440"> </td></tr><tr><td align="left" valign="top" headers="idm140663646350704">
<pre class="literallayout">spec:
  gateways:
    additionalIngress:
      &lt;ingressName&gt;:
        service:
          metadata:
            labels:
              federation.maistra.io/ingress-for:</pre>
									 </td><td align="left" valign="top" headers="idm140663646349616"> <p>
										Specify a unique label for the gateway to prevent federated traffic from flowing through the cluster’s default system gateways.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646348528"> </td><td align="left" valign="top" headers="idm140663646347440"> </td></tr><tr><td align="left" valign="top" headers="idm140663646350704">
<pre class="literallayout">spec:
  gateways:
    additionalIngress:
      &lt;ingressName&gt;:
        service:
          ports:</pre>
									 </td><td align="left" valign="top" headers="idm140663646349616"> <p>
										Used to specify the <code class="literal">port:</code> and <code class="literal">name:</code> used for TLS and service discovery. Federation traffic consists of raw encrypted TCP for service traffic. Federation traffic consists of HTTPS for discovery.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646348528"> <p>
										Port <code class="literal">15443</code> is required for receiving TLS service requests to other meshes in the federation. Port <code class="literal">8188</code> is required for receiving service discovery requests to other meshes in the federation.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646347440"> </td></tr><tr><td align="left" valign="top" headers="idm140663646350704">
<pre class="literallayout">spec:
  gateways:
    additionalIngress:
      &lt;ingressName&gt;:
        service:
          ports:
            nodePort:</pre>
									 </td><td align="left" valign="top" headers="idm140663646349616"> <p>
										Used to specify the <code class="literal">nodePort:</code> if the cluster does not support <code class="literal">LoadBalancer</code> services.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646348528"> <p>
										If specified, is required in addition to <code class="literal">port:</code> and <code class="literal">name:</code> for both TLS and service discovery. <code class="literal">nodePort:</code> must be in the range <code class="literal">30000</code>-<code class="literal">32767</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646347440"> </td></tr></tbody></table></div></div><p>
						In the following example, the administrator is configuring the SMCP for federation with the <code class="literal">green-mesh</code> using a <code class="literal">NodePort</code> service.
					</p><div class="formalpara"><p class="title"><strong>Sample SMCP for NodePort</strong></p><p>
							
<pre class="programlisting language-yaml">  gateways:
     additionalIngress:
      ingress-green-mesh:
        enabled: true
        routerMode: sni-dnat
        service:
          type: NodePort
          metadata:
            labels:
              federation.maistra.io/ingress-for: ingress-green-mesh
          ports:
          - port: 15443
            nodePort: 30510
            name: tls
          - port: 8188
            nodePort: 32359
            name: https-discovery</pre>

						</p></div></section><section class="section" id="understanding-federation-trust-domain-parameters"><div class="titlepage"><div><div><h4 class="title">1.18.9.2. Understanding federation trust domain parameters</h4></div></div></div><p>
						Each mesh in the federation must have its own unique trust domain. This value is used when configuring mesh federation in the <code class="literal">ServiceMeshPeer</code> resource.
					</p><pre class="programlisting language-yaml">kind: ServiceMeshControlPlane
metadata:
  name: red-mesh
  namespace: red-mesh-system
spec:
  security:
    trust:
      domain: red-mesh.local</pre><div class="table" id="idm140663650020032"><p class="title"><strong>Table 1.8. Federation security parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663650702992" scope="col">Parameter</th><th align="left" valign="top" id="idm140663650701904" scope="col">Description</th><th align="left" valign="top" id="idm140663650700816" scope="col">Values</th><th align="left" valign="top" id="idm140663650699728" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663650702992">
<pre class="literallayout">spec:
  security:
    trust:
      domain:</pre>
									 </td><td align="left" valign="top" headers="idm140663650701904"> <p>
										Used to specify a unique name for the trust domain for the mesh. Domains must be unique for every mesh in the federation.
									</p>
									 </td><td align="left" valign="top" headers="idm140663650700816"> <p>
										<code class="literal">&lt;mesh-name&gt;.local</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663650699728"> <p>
										N/A
									</p>
									 </td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Procedure from the Console</strong></p><p>
							Follow this procedure to edit the <code class="literal">ServiceMeshControlPlane</code> with the OpenShift Container Platform web console. This example uses the <code class="literal">red-mesh</code> as an example.
						</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console as a user with the cluster-admin role.
							</li><li class="listitem">
								Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Project</strong></span> menu and select the project where you installed the Service Mesh control plane. For example, <code class="literal">red-mesh-system</code>.
							</li><li class="listitem">
								Click the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								On the <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span> tab, click the name of your <code class="literal">ServiceMeshControlPlane</code>, for example <code class="literal">red-mesh</code>.
							</li><li class="listitem">
								On the <span class="strong strong"><strong>Create ServiceMeshControlPlane Details</strong></span> page, click <code class="literal">YAML</code> to modify your configuration.
							</li><li class="listitem">
								Modify your <code class="literal">ServiceMeshControlPlane</code> to add federation ingress and egress gateways and to specify the trust domain.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span>.
							</li></ol></div><div class="formalpara"><p class="title"><strong>Procedure from the CLI</strong></p><p>
							Follow this procedure to create or edit the <code class="literal">ServiceMeshControlPlane</code> with the command line. This example uses the <code class="literal">red-mesh</code> as an example.
						</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Log in to the OpenShift Container Platform CLI as a user with the <code class="literal">cluster-admin</code> role. Enter the following command. Then, enter your username and password when prompted.
							</p><pre class="programlisting language-terminal">$ oc login --username=&lt;NAMEOFUSER&gt; https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
								Change to the project where you installed the Service Mesh control plane, for example red-mesh-system.
							</p><pre class="programlisting language-terminal">$ oc project red-mesh-system</pre></li><li class="listitem">
								Edit the <code class="literal">ServiceMeshControlPlane</code> file to add federation ingress and egress gateways and to specify the trust domain.
							</li><li class="listitem"><p class="simpara">
								Run the following command to edit the Service Mesh control plane where <code class="literal">red-mesh-system</code> is the system namespace and <code class="literal">red-mesh</code> is the name of the <code class="literal">ServiceMeshControlPlane</code> object:
							</p><pre class="programlisting language-terminal">$ oc edit -n red-mesh-system smcp red-mesh</pre></li><li class="listitem"><p class="simpara">
								Enter the following command, where <code class="literal">red-mesh-system</code> is the system namespace, to see the status of the Service Mesh control plane installation.
							</p><pre class="programlisting language-terminal">$ oc get smcp -n red-mesh-system</pre><p class="simpara">
								The installation has finished successfully when the READY column indicates that all components are ready.
							</p><pre class="screen">NAME       READY   STATUS            PROFILES      VERSION   AGE
red-mesh   10/10   ComponentsReady   ["default"]   2.1.0     4m25s</pre></li></ol></div></section></section><section class="section" id="ossm-federation-joining_federation"><div class="titlepage"><div><div><h3 class="title">1.18.10. Joining a federated mesh</h3></div></div></div><p>
					You declare the federation between two meshes by creating a <code class="literal">ServiceMeshPeer</code> resource. The <code class="literal">ServiceMeshPeer</code> resource defines the federation between two meshes, and you use it to configure discovery for the peer mesh, access to the peer mesh, and certificates used to validate the other mesh’s clients.
				</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/f15c7cb7991a9b54800e8fbfb11cb0e8/ossm-federated-mesh.png" alt="Service Mesh federated mesh peers illustration"/></div></div><p>
					Meshes are federated on a one-to-one basis, so each pair of peers requires a pair of <code class="literal">ServiceMeshPeer</code> resources specifying the federation connection to the other service mesh. For example, federating two meshes named <code class="literal">red</code> and <code class="literal">green</code> would require two <code class="literal">ServiceMeshPeer</code> files.
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							On red-mesh-system, create a <code class="literal">ServiceMeshPeer</code> for the green mesh.
						</li><li class="listitem">
							On green-mesh-system, create a <code class="literal">ServiceMeshPeer</code> for the red mesh.
						</li></ol></div><p>
					Federating three meshes named <code class="literal">red</code>, <code class="literal">blue</code>, and <code class="literal">green</code> would require six <code class="literal">ServiceMeshPeer</code> files.
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							On red-mesh-system, create a <code class="literal">ServiceMeshPeer</code> for the green mesh.
						</li><li class="listitem">
							On red-mesh-system, create a <code class="literal">ServiceMeshPeer</code> for the blue mesh.
						</li><li class="listitem">
							On green-mesh-system, create a <code class="literal">ServiceMeshPeer</code> for the red mesh.
						</li><li class="listitem">
							On green-mesh-system, create a <code class="literal">ServiceMeshPeer</code> for the blue mesh.
						</li><li class="listitem">
							On blue-mesh-system, create a <code class="literal">ServiceMeshPeer</code> for the red mesh.
						</li><li class="listitem">
							On blue-mesh-system, create a <code class="literal">ServiceMeshPeer</code> for the green mesh.
						</li></ol></div><p>
					Configuration in the <code class="literal">ServiceMeshPeer</code> resource includes the following:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The address of the other mesh’s ingress gateway, which is used for discovery and service requests.
						</li><li class="listitem">
							The names of the local ingress and egress gateways that is used for interactions with the specified peer mesh.
						</li><li class="listitem">
							The client ID used by the other mesh when sending requests to this mesh.
						</li><li class="listitem">
							The trust domain used by the other mesh.
						</li><li class="listitem">
							The name of a <code class="literal">ConfigMap</code> containing a root certificate that is used to validate client certificates in the trust domain used by the other mesh.
						</li></ul></div><p>
					In the following example, the administrator for the <code class="literal">red-mesh</code> is configuring federation with the <code class="literal">green-mesh</code>.
				</p><div class="formalpara"><p class="title"><strong>Example ServiceMeshPeer resource for red-mesh</strong></p><p>
						
<pre class="programlisting language-yaml">kind: ServiceMeshPeer
apiVersion: federation.maistra.io/v1
metadata:
  name: green-mesh
  namespace: red-mesh-system
spec:
  remote:
    addresses:
    - ingress-red-mesh.green-mesh-system.apps.domain.com
  gateways:
    ingress:
      name: ingress-green-mesh
    egress:
      name: egress-green-mesh
  security:
    trustDomain: green-mesh.local
    clientID: green-mesh.local/ns/green-mesh-system/sa/egress-red-mesh-service-account
    certificateChain:
      kind: ConfigMap
      name: green-mesh-ca-root-cert</pre>

					</p></div><div class="table" id="idm140663668364736"><p class="title"><strong>Table 1.9. ServiceMeshPeer configuration parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663668358944" scope="col">Parameter</th><th align="left" valign="top" id="idm140663668357856" scope="col">Description</th><th align="left" valign="top" id="idm140663668356768" scope="col">Values</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663668358944">
<pre class="literallayout">metadata:
  name:</pre>
								 </td><td align="left" valign="top" headers="idm140663668357856"> <p>
									Name of the peer mesh that this resource is configuring federation with.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668356768"> <p>
									String
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663668358944">
<pre class="literallayout">metadata:
  namespace:</pre>
								 </td><td align="left" valign="top" headers="idm140663668357856"> <p>
									System namespace for this mesh, that is, where the Service Mesh control plane is installed.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668356768"> <p>
									String
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663668358944">
<pre class="literallayout">spec:
  remote:
    addresses:</pre>
								 </td><td align="left" valign="top" headers="idm140663668357856"> <p>
									List of public addresses of the peer meshes' ingress gateways that are servicing requests from this mesh.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668356768"> </td></tr><tr><td align="left" valign="top" headers="idm140663668358944">
<pre class="literallayout">spec:
  remote:
    discoveryPort:</pre>
								 </td><td align="left" valign="top" headers="idm140663668357856"> <p>
									The port on which the addresses are handling discovery requests.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668356768"> <p>
									Defaults to 8188
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663668358944">
<pre class="literallayout">spec:
  remote:
    servicePort:</pre>
								 </td><td align="left" valign="top" headers="idm140663668357856"> <p>
									The port on which the addresses are handling service requests.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668356768"> <p>
									Defaults to 15443
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663668358944">
<pre class="literallayout">spec:
  gateways:
    ingress:
      name:</pre>
								 </td><td align="left" valign="top" headers="idm140663668357856"> <p>
									Name of the ingress on this mesh that is servicing requests received from the peer mesh. For example, <code class="literal">ingress-green-mesh</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668356768"> </td></tr><tr><td align="left" valign="top" headers="idm140663668358944">
<pre class="literallayout">spec:
  gateways:
    egress:
      name:</pre>
								 </td><td align="left" valign="top" headers="idm140663668357856"> <p>
									Name of the egress on this mesh that is servicing requests sent to the peer mesh. For example, <code class="literal">egress-green-mesh</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668356768"> </td></tr><tr><td align="left" valign="top" headers="idm140663668358944">
<pre class="literallayout">spec:
  security:
    trustDomain:</pre>
								 </td><td align="left" valign="top" headers="idm140663668357856"> <p>
									The trust domain used by the peer mesh.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668356768"> <p>
									&lt;peerMeshName&gt;.local
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663668358944">
<pre class="literallayout">spec:
  security:
    clientID:</pre>
								 </td><td align="left" valign="top" headers="idm140663668357856"> <p>
									The client ID used by the peer mesh when calling into this mesh.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668356768"> <p>
									&lt;peerMeshTrustDomain&gt;/ns/&lt;peerMeshSystem&gt;/sa/&lt;peerMeshEgressGatewayName&gt;-service-account
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663668358944">
<pre class="literallayout">spec:
  security:
    certificateChain:
      kind: ConfigMap
      name:</pre>
								 </td><td align="left" valign="top" headers="idm140663668357856"> <p>
									The kind (for example, ConfigMap) and name of a resource containing the root certificate used to validate the client and server certificate(s) presented to this mesh by the peer mesh. The key of the config map entry containing the certificate should be <code class="literal">root-cert.pem</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668356768"> <p>
									kind: ConfigMap name: &lt;peerMesh&gt;-ca-root-cert
								</p>
								 </td></tr></tbody></table></div></div><section class="section" id="ossm-federation-create-peer_federation"><div class="titlepage"><div><div><h4 class="title">1.18.10.1. Creating a ServiceMeshPeer resource</h4></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Two or more OpenShift Container Platform 4.6 or above clusters.
							</li><li class="listitem">
								The clusters must already be networked.
							</li><li class="listitem">
								The load balancers supporting the services associated with the federation gateways must be configured to support raw TLS traffic.
							</li><li class="listitem">
								Each cluster must have a version 2.1 or later <code class="literal">ServiceMeshControlPlane</code> configured to support federation deployed.
							</li><li class="listitem">
								An account with the <code class="literal">cluster-admin</code> role.
							</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure from the CLI</strong></p><p>
							Follow this procedure to create a <code class="literal">ServiceMeshPeer</code> resource from the command line. This example shows the <code class="literal">red-mesh</code> creating a peer resource for the <code class="literal">green-mesh</code>.
						</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Log in to the OpenShift Container Platform CLI as a user with the <code class="literal">cluster-admin</code> role. Enter the following command. Then, enter your username and password when prompted.
							</p><pre class="programlisting language-terminal">$ oc login --username=&lt;NAMEOFUSER&gt; &lt;API token&gt; https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
								Change to the project where you installed the control plane, for example, <code class="literal">red-mesh-system</code>.
							</p><pre class="programlisting language-terminal">$ oc project red-mesh-system</pre></li><li class="listitem"><p class="simpara">
								Create a <code class="literal">ServiceMeshPeer</code> file based the following example for the two meshes that you want to federate.
							</p><div class="formalpara"><p class="title"><strong>Example ServiceMeshPeer resource for red-mesh to green-mesh</strong></p><p>
									
<pre class="programlisting language-yaml">kind: ServiceMeshPeer
apiVersion: federation.maistra.io/v1
metadata:
  name: green-mesh
  namespace: red-mesh-system
spec:
  remote:
    addresses:
    - ingress-red-mesh.green-mesh-system.apps.domain.com
  gateways:
    ingress:
      name: ingress-green-mesh
    egress:
      name: egress-green-mesh
  security:
    trustDomain: green-mesh.local
    clientID: green-mesh.local/ns/green-mesh-system/sa/egress-red-mesh-service-account
    certificateChain:
      kind: ConfigMap
      name: green-mesh-ca-root-cert</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Run the following command to deploy the resource, where <code class="literal">red-mesh-system</code> is the system namespace and <code class="literal">servicemeshpeer.yaml</code> includes a full path to the file you edited:
							</p><pre class="programlisting language-terminal">$ oc create -n red-mesh-system -f servicemeshpeer.yaml</pre></li><li class="listitem"><p class="simpara">
								To confirm that connection between the red mesh and green mesh is established, inspect the status of the green-mesh <code class="literal">ServiceMeshPeer</code> in the red-mesh-system namespace:
							</p><pre class="programlisting language-terminal">$ oc -n red-mesh-system get servicemeshpeer green-mesh -o yaml</pre><div class="formalpara"><p class="title"><strong>Example ServiceMeshPeer connection between red-mesh and green-mesh</strong></p><p>
									
<pre class="programlisting language-yaml">status:
  discoveryStatus:
    active:
    - pod: istiod-red-mesh-b65457658-9wq5j
      remotes:
      - connected: true
        lastConnected: "2021-10-05T13:02:25Z"
        lastFullSync: "2021-10-05T13:02:25Z"
        source: 10.128.2.149
      watch:
        connected: true
        lastConnected: "2021-10-05T13:02:55Z"
        lastDisconnectStatus: 503 Service Unavailable
        lastFullSync: "2021-10-05T13:05:43Z"</pre>

								</p></div><p class="simpara">
								The <code class="literal">status.discoveryStatus.active.remotes</code> field shows that istiod in the peer mesh (in this example, the green mesh) is connected to istiod in the current mesh (in this example, the red mesh).
							</p><p class="simpara">
								The <code class="literal">status.discoveryStatus.active.watch</code> field shows that istiod in the current mesh is connected to istiod in the peer mesh.
							</p><p class="simpara">
								If you check the <code class="literal">servicemeshpeer</code> named <code class="literal">red-mesh</code> in <code class="literal">green-mesh-system</code>, you’ll find information about the same two connections from the perspective of the green mesh.
							</p><p class="simpara">
								When the connection between two meshes is not established, the <code class="literal">ServiceMeshPeer</code> status indicates this in the <code class="literal">status.discoveryStatus.inactive</code> field.
							</p><p class="simpara">
								For more information on why a connection attempt failed, inspect the Istiod log, the access log of the egress gateway handling egress traffic for the peer, and the ingress gateway handling ingress traffic for the current mesh in the peer mesh.
							</p><p class="simpara">
								For example, if the red mesh can’t connect to the green mesh, check the following logs:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										istiod-red-mesh in red-mesh-system
									</li><li class="listitem">
										egress-green-mesh in red-mesh-system
									</li><li class="listitem">
										ingress-red-mesh in green-mesh-system
									</li></ul></div></li></ol></div></section></section><section class="section" id="ossm-federation-config-export_federation"><div class="titlepage"><div><div><h3 class="title">1.18.11. Exporting a service from a federated mesh</h3></div></div></div><p>
					Exporting services allows a mesh to share one or more of its services with another member of the federated mesh.
				</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/11348f2528eded2ba53b60868b417342/ossm-federation-export-service.png" alt="Service Mesh federation exporting service illustration"/></div></div><p>
					You use an <code class="literal">ExportedServiceSet</code> resource to declare the services from one mesh that you are making available to another peer in the federated mesh. You must explicitly declare each service to be shared with a peer.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							You can select services by namespace or name.
						</li><li class="listitem">
							You can use wildcards to select services; for example, to export all the services in a namespace.
						</li><li class="listitem">
							You can export services using an alias. For example, you can export the <code class="literal">foo/bar</code> service as <code class="literal">custom-ns/bar</code>.
						</li><li class="listitem">
							You can only export services that are visible to the mesh’s system namespace. For example, a service in another namespace with a <code class="literal">networking.istio.io/exportTo</code> label set to ‘.’ would not be a candidate for export.
						</li><li class="listitem">
							For exported services, their target services will only see traffic from the ingress gateway, not the original requestor (that is, they won’t see the client ID of either the other mesh’s egress gateway or the workload originating the request)
						</li></ul></div><p>
					The following example is for services that <code class="literal">red-mesh</code> is exporting to <code class="literal">green-mesh</code>.
				</p><div class="formalpara"><p class="title"><strong>Example ExportedServiceSet resource</strong></p><p>
						
<pre class="programlisting language-yaml">kind: ExportedServiceSet
apiVersion: federation.maistra.io/v1
metadata:
  name: green-mesh
  namespace: red-mesh-system
spec:
  exportRules:
  # export ratings.mesh-x-bookinfo as ratings.bookinfo
  - type: NameSelector
    nameSelector:
      namespace: red-mesh-bookinfo
      name: red-ratings
      alias:
        namespace: bookinfo
        name: ratings
  # export any service in red-mesh-bookinfo namespace with label export-service=true
  - type: LabelSelector
    labelSelector:
      namespace: red-mesh-bookinfo
      selector:
        matchLabels:
          export-service: "true"
      aliases: # export all matching services as if they were in the bookinfo namespace
      - namespace: "*"
        name: "*"
        alias:
          namespace: bookinfo</pre>

					</p></div><div class="table" id="idm140663649651408"><p class="title"><strong>Table 1.10. ExportedServiceSet parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663649645632" scope="col">Parameter</th><th align="left" valign="top" id="idm140663649644544" scope="col">Description</th><th align="left" valign="top" id="idm140663649643456" scope="col">Values</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663649645632">
<pre class="literallayout">metadata:
  name:</pre>
								 </td><td align="left" valign="top" headers="idm140663649644544"> <p>
									Name of the ServiceMeshPeer you are exposing this service to.
								</p>
								 </td><td align="left" valign="top" headers="idm140663649643456"> <p>
									Must match the <code class="literal">name</code> value for the mesh in the <code class="literal">ServiceMeshPeer</code> resource.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663649645632">
<pre class="literallayout">metadata:
  namespace:</pre>
								 </td><td align="left" valign="top" headers="idm140663649644544"> <p>
									Name of the project/namespace containing this resource (should be the system namespace for the mesh) .
								</p>
								 </td><td align="left" valign="top" headers="idm140663649643456"> </td></tr><tr><td align="left" valign="top" headers="idm140663649645632">
<pre class="literallayout">spec:
  exportRules:
  - type:</pre>
								 </td><td align="left" valign="top" headers="idm140663649644544"> <p>
									Type of rule that will govern the export for this service. The first matching rule found for the service will be used for the export.
								</p>
								 </td><td align="left" valign="top" headers="idm140663649643456"> <p>
									<code class="literal">NameSelector</code>, <code class="literal">LabelSelector</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663649645632">
<pre class="literallayout">spec:
  exportRules:
  - type: NameSelector
    nameSelector:
      namespace:
      name:</pre>
								 </td><td align="left" valign="top" headers="idm140663649644544"> <p>
									To create a <code class="literal">NameSelector</code> rule, specify the <code class="literal">namespace</code> of the service and the <code class="literal">name</code> of the service as defined in the <code class="literal">Service</code> resource.
								</p>
								 </td><td align="left" valign="top" headers="idm140663649643456"> </td></tr><tr><td align="left" valign="top" headers="idm140663649645632">
<pre class="literallayout">spec:
  exportRules:
  - type: NameSelector
    nameSelector:
      alias:
        namespace:
        name:</pre>
								 </td><td align="left" valign="top" headers="idm140663649644544"> <p>
									To create a <code class="literal">NameSelector</code> rule that uses an alias for the service, after specifying the <code class="literal">namespace</code> and <code class="literal">name</code> for the service, then specify the alias for the <code class="literal">namespace</code> and the alias to be used for <code class="literal">name</code> of the service.
								</p>
								 </td><td align="left" valign="top" headers="idm140663649643456"> </td></tr><tr><td align="left" valign="top" headers="idm140663649645632">
<pre class="literallayout">spec:
  exportRules:
  - type: LabelSelector
    labelSelector:
      namespace: &lt;exportingMesh&gt;
      selector:
        matchLabels:
          &lt;labelKey&gt;: &lt;labelValue&gt;</pre>
								 </td><td align="left" valign="top" headers="idm140663649644544"> <p>
									To create a <code class="literal">LabelSelector</code> rule, specify the <code class="literal">namespace</code> of the service and specify the <code class="literal">label</code> defined in the <code class="literal">Service</code> resource. In the example above, the label is <code class="literal">export-service</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140663649643456"> </td></tr><tr><td align="left" valign="top" headers="idm140663649645632">
<pre class="literallayout">spec:
  exportRules:
  - type: LabelSelector
    labelSelector:
      namespace: &lt;exportingMesh&gt;
      selector:
        matchLabels:
          &lt;labelKey&gt;: &lt;labelValue&gt;
      aliases:
      - namespace:
        name:
        alias:
          namespace:
          name:</pre>
								 </td><td align="left" valign="top" headers="idm140663649644544"> <p>
									To create a <code class="literal">LabelSelector</code> rule that uses aliases for the services, after specifying the <code class="literal">selector</code>, specify the aliases to be used for <code class="literal">name</code> or <code class="literal">namespace</code> of the service. In the example above, the namespace alias is <code class="literal">bookinfo</code> for all matching services.
								</p>
								 </td><td align="left" valign="top" headers="idm140663649643456"> </td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Export services with the name "ratings" from all namespaces in the red-mesh to blue-mesh.</strong></p><p>
						
<pre class="programlisting language-yaml">kind: ExportedServiceSet
apiVersion: federation.maistra.io/v1
metadata:
  name: blue-mesh
  namespace: red-mesh-system
spec:
  exportRules:
  - type: NameSelector
    nameSelector:
      namespace: "*"
      name: ratings</pre>

					</p></div><div class="formalpara"><p class="title"><strong>Export all services from the west-data-center namespace to green-mesh</strong></p><p>
						
<pre class="programlisting language-yaml">kind: ExportedServiceSet
apiVersion: federation.maistra.io/v1
metadata:
  name: green-mesh
  namespace: red-mesh-system
spec:
  exportRules:
  - type: NameSelector
    nameSelector:
      namespace: west-data-center
      name: "*"</pre>

					</p></div><section class="section" id="ossm-federation-create-export_federation"><div class="titlepage"><div><div><h4 class="title">1.18.11.1. Creating an ExportedServiceSet</h4></div></div></div><p>
						You create an <code class="literal">ExportedServiceSet</code> resource to explicitly declare the services that you want to be available to a mesh peer.
					</p><p>
						Services are exported as <code class="literal">&lt;export-name&gt;.&lt;export-namespace&gt;.svc.&lt;ServiceMeshPeer.name&gt;-exports.local</code> and will automatically route to the target service. This is the name by which the exported service is known in the exporting mesh. When the ingress gateway receives a request destined for this name, it will be routed to the actual service being exported. For example, if a service named <code class="literal">ratings.red-mesh-bookinfo</code> is exported to <code class="literal">green-mesh</code> as <code class="literal">ratings.bookinfo</code>, the service will be exported under the name <code class="literal">ratings.bookinfo.svc.green-mesh-exports.local</code>, and traffic received by the ingress gateway for that hostname will be routed to the <code class="literal">ratings.red-mesh-bookinfo</code> service.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The cluster and <code class="literal">ServiceMeshControlPlane</code> have been configured for mesh federation.
							</li><li class="listitem">
								An account with the <code class="literal">cluster-admin</code> role.
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You can configure services for export even if they don’t exist yet. When a service that matches the value specified in the ExportedServiceSet is deployed, it will be automatically exported.
						</p></div></div><div class="formalpara"><p class="title"><strong>Procedure from the CLI</strong></p><p>
							Follow this procedure to create an <code class="literal">ExportedServiceSet</code> from the command line.
						</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Log in to the OpenShift Container Platform CLI as a user with the <code class="literal">cluster-admin</code> role. Enter the following command. Then, enter your username and password when prompted.
							</p><pre class="programlisting language-terminal">$ oc login --username=&lt;NAMEOFUSER&gt; &lt;API token&gt; https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
								Change to the project where you installed the Service Mesh control plane; for example, <code class="literal">red-mesh-system</code>.
							</p><pre class="programlisting language-terminal">$ oc project red-mesh-system</pre></li><li class="listitem"><p class="simpara">
								Create an <code class="literal">ExportedServiceSet</code> file based on the following example where <code class="literal">red-mesh</code> is exporting services to <code class="literal">green-mesh</code>.
							</p><div class="formalpara"><p class="title"><strong>Example ExportedServiceSet resource from red-mesh to green-mesh</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: federation.maistra.io/v1
kind: ExportedServiceSet
metadata:
  name: green-mesh
  namespace: red-mesh-system
spec:
  exportRules:
  - type: NameSelector
    nameSelector:
      namespace: red-mesh-bookinfo
      name: ratings
      alias:
        namespace: bookinfo
        name: red-ratings
  - type: NameSelector
    nameSelector:
      namespace: red-mesh-bookinfo
      name: reviews</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Run the following command to upload and create the <code class="literal">ExportedServiceSet</code> resource in the red-mesh-system namespace.
							</p><pre class="programlisting language-terminal">$ oc create -n &lt;ControlPlaneNamespace&gt; -f &lt;ExportedServiceSet.yaml&gt;</pre><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc create -n red-mesh-system -f export-to-green-mesh.yaml</pre></li><li class="listitem">
								Create additional <code class="literal">ExportedServiceSets</code> as needed for each mesh peer in your federated mesh.
							</li><li class="listitem"><p class="simpara">
								To validate the services you’ve exported from <code class="literal">red-mesh</code> to share with <code class="literal">green-mesh</code>, run the following command:
							</p><pre class="programlisting language-terminal">$ oc get exportedserviceset &lt;PeerMeshExportedTo&gt; -o yaml</pre><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc get exportedserviceset green-mesh -o yaml</pre></li><li class="listitem"><p class="simpara">
								Run the following command to validate the services the red-mesh exports to share with green-mesh:
							</p><pre class="programlisting language-terminal">$ oc get exportedserviceset &lt;PeerMeshExportedTo&gt; -o yaml</pre><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc -n red-mesh-system get exportedserviceset green-mesh -o yaml</pre><div class="formalpara"><p class="title"><strong>Example validating the services exported from the red mesh that are shared with the green mesh.</strong></p><p>
									
<pre class="programlisting language-yaml">  status:
    exportedServices:
    - exportedName: red-ratings.bookinfo.svc.green-mesh-exports.local
      localService:
        hostname: ratings.red-mesh-bookinfo.svc.cluster.local
        name: ratings
        namespace: red-mesh-bookinfo
    - exportedName: reviews.red-mesh-bookinfo.svc.green-mesh-exports.local
      localService:
        hostname: reviews.red-mesh-bookinfo.svc.cluster.local
        name: reviews
        namespace: red-mesh-bookinfo</pre>

								</p></div><p class="simpara">
								The <code class="literal">status.exportedServices</code> array lists the services that are currently exported (these services matched the export rules in the <code class="literal">ExportedServiceSet object</code>). Each entry in the array indicates the name of the exported service and details about the local service that is exported.
							</p><p class="simpara">
								If a service that you expected to be exported is missing, confirm the Service object exists, its name or labels match the <code class="literal">exportRules</code> defined in the <code class="literal">ExportedServiceSet</code> object, and that the Service object’s namespace is configured as a member of the service mesh using the <code class="literal">ServiceMeshMemberRoll</code> or <code class="literal">ServiceMeshMember</code> object.
							</p></li></ol></div></section></section><section class="section" id="ossm-federation-config-import_federation"><div class="titlepage"><div><div><h3 class="title">1.18.12. Importing a service into a federated mesh</h3></div></div></div><p>
					Importing services lets you explicitly specify which services exported from another mesh should be accessible within your service mesh.
				</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/6734470c6e6ae1ee919aa3b9463c0332/ossm-federation-import-service.png" alt="Service Mesh federation importing service illustration"/></div></div><p>
					You use an <code class="literal">ImportedServiceSet</code> resource to select services for import. Only services exported by a mesh peer and explicitly imported are available to the mesh. Services that you do not explicitly import are not made available within the mesh.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							You can select services by namespace or name.
						</li><li class="listitem">
							You can use wildcards to select services, for example, to import all the services that were exported to the namespace.
						</li><li class="listitem">
							You can select services for export using a label selector, which may be global to the mesh, or scoped to a specific member namespace.
						</li><li class="listitem">
							You can import services using an alias. For example, you can import the <code class="literal">custom-ns/bar</code> service as <code class="literal">other-mesh/bar</code>.
						</li><li class="listitem">
							You can specify a custom domain suffix, which will be appended to the <code class="literal">name.namespace</code> of an imported service for its fully qualified domain name; for example, <code class="literal">bar.other-mesh.imported.local</code>.
						</li></ul></div><p>
					The following example is for the <code class="literal">green-mesh</code> importing a service that was exported by <code class="literal">red-mesh</code>.
				</p><div class="formalpara"><p class="title"><strong>Example ImportedServiceSet</strong></p><p>
						
<pre class="programlisting language-yaml">kind: ImportedServiceSet
apiVersion: federation.maistra.io/v1
metadata:
  name: red-mesh #name of mesh that exported the service
  namespace: green-mesh-system #mesh namespace that service is being imported into
spec:
  importRules: # first matching rule is used
  # import ratings.bookinfo as ratings.bookinfo
  - type: NameSelector
    importAsLocal: false
    nameSelector:
      namespace: bookinfo
      name: ratings
      alias:
        # service will be imported as ratings.bookinfo.svc.red-mesh-imports.local
        namespace: bookinfo
        name: ratings</pre>

					</p></div><div class="table" id="idm140663647902624"><p class="title"><strong>Table 1.11. ImportedServiceSet parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663661239632" scope="col">Parameter</th><th align="left" valign="top" id="idm140663661238544" scope="col">Description</th><th align="left" valign="top" id="idm140663661237456" scope="col">Values</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663661239632">
<pre class="literallayout">metadata:
  name:</pre>
								 </td><td align="left" valign="top" headers="idm140663661238544"> <p>
									Name of the ServiceMeshPeer that exported the service to the federated mesh.
								</p>
								 </td><td align="left" valign="top" headers="idm140663661237456"> </td></tr><tr><td align="left" valign="top" headers="idm140663661239632">
<pre class="literallayout">metadata:
  namespace:</pre>
								 </td><td align="left" valign="top" headers="idm140663661238544"> <p>
									Name of the namespace containing the ServiceMeshPeer resource (the mesh system namespace).
								</p>
								 </td><td align="left" valign="top" headers="idm140663661237456"> </td></tr><tr><td align="left" valign="top" headers="idm140663661239632">
<pre class="literallayout">spec:
  importRules:
  - type:</pre>
								 </td><td align="left" valign="top" headers="idm140663661238544"> <p>
									Type of rule that will govern the import for the service. The first matching rule found for the service will be used for the import.
								</p>
								 </td><td align="left" valign="top" headers="idm140663661237456"> <p>
									<code class="literal">NameSelector</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663661239632">
<pre class="literallayout">spec:
  importRules:
  - type: NameSelector
    nameSelector:
      namespace:
      name:</pre>
								 </td><td align="left" valign="top" headers="idm140663661238544"> <p>
									To create a <code class="literal">NameSelector</code> rule, specify the <code class="literal">namespace</code> and the <code class="literal">name</code> of the exported service.
								</p>
								 </td><td align="left" valign="top" headers="idm140663661237456"> </td></tr><tr><td align="left" valign="top" headers="idm140663661239632">
<pre class="literallayout">spec:
  importRules:
  - type: NameSelector
    importAsLocal:</pre>
								 </td><td align="left" valign="top" headers="idm140663661238544"> <p>
									Set to <code class="literal">true</code> to aggregate remote endpoint with local services. When <code class="literal">true</code>, services will be imported as <code class="literal">&lt;name&gt;.&lt;namespace&gt;.svc.cluster.local</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663661237456"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663661239632">
<pre class="literallayout">spec:
  importRules:
  - type: NameSelector
    nameSelector:
      namespace:
      name:
      alias:
        namespace:
        name:</pre>
								 </td><td align="left" valign="top" headers="idm140663661238544"> <p>
									To create a <code class="literal">NameSelector</code> rule that uses an alias for the service, after specifying the <code class="literal">namespace</code> and <code class="literal">name</code> for the service, then specify the alias for the <code class="literal">namespace</code> and the alias to be used for <code class="literal">name</code> of the service.
								</p>
								 </td><td align="left" valign="top" headers="idm140663661237456"> </td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Import the "bookinfo/ratings" service from the red-mesh into blue-mesh</strong></p><p>
						
<pre class="programlisting language-yaml">kind: ImportedServiceSet
apiVersion: federation.maistra.io/v1
metadata:
  name: red-mesh
  namespace: blue-mesh-system
spec:
  importRules:
  - type: NameSelector
    importAsLocal: false
    nameSelector:
      namespace: bookinfo
      name: ratings</pre>

					</p></div><div class="formalpara"><p class="title"><strong>Import all services from the red-mesh’s west-data-center namespace into the green-mesh. These services will be accessible as &lt;name&gt;.west-data-center.svc.red-mesh-imports.local</strong></p><p>
						
<pre class="programlisting language-yaml">kind: ImportedServiceSet
apiVersion: federation.maistra.io/v1
metadata:
  name: red-mesh
  namespace: green-mesh-system
spec:
  importRules:
  - type: NameSelector
    importAsLocal: false
    nameSelector:
      namespace: west-data-center
      name: "*"</pre>

					</p></div><section class="section" id="ossm-federation-create-import_federation"><div class="titlepage"><div><div><h4 class="title">1.18.12.1. Creating an ImportedServiceSet</h4></div></div></div><p>
						You create an <code class="literal">ImportedServiceSet</code> resource to explicitly declare the services that you want to import into your mesh.
					</p><p>
						Services are imported with the name <code class="literal">&lt;exported-name&gt;.&lt;exported-namespace&gt;.svc.&lt;ServiceMeshPeer.name&gt;.remote</code> which is a "hidden" service, visible only within the egress gateway namespace and is associated with the exported service’s hostname. The service will be available locally as <code class="literal">&lt;export-name&gt;.&lt;export-namespace&gt;.&lt;domainSuffix&gt;</code>, where <code class="literal">domainSuffix</code> is <code class="literal">svc.&lt;ServiceMeshPeer.name&gt;-imports.local</code> by default, unless <code class="literal">importAsLocal</code> is set to <code class="literal">true</code>, in which case <code class="literal">domainSuffix</code> is <code class="literal">svc.cluster.local</code>. If <code class="literal">importAsLocal</code> is set to <code class="literal">false</code>, the domain suffix in the import rule will be applied. You can treat the local import just like any other service in the mesh. It automatically routes through the egress gateway, where it is redirected to the exported service’s remote name.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The cluster and <code class="literal">ServiceMeshControlPlane</code> have been configured for mesh federation.
							</li><li class="listitem">
								An account with the <code class="literal">cluster-admin</code> role.
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You can configure services for import even if they haven’t been exported yet. When a service that matches the value specified in the ImportedServiceSet is deployed and exported, it will be automatically imported.
						</p></div></div><div class="formalpara"><p class="title"><strong>Procedure from the CLI</strong></p><p>
							Follow this procedure to create an <code class="literal">ImportedServiceSet</code> from the command line.
						</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Log in to the OpenShift Container Platform CLI as a user with the <code class="literal">cluster-admin</code> role. Enter the following command. Then, enter your username and password when prompted.
							</p><pre class="programlisting language-terminal">$ oc login --username=&lt;NAMEOFUSER&gt; &lt;API token&gt; https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
								Change to the project where you installed the Service Mesh control plane; for example, <code class="literal">green-mesh-system</code>.
							</p><pre class="programlisting language-terminal">$ oc project green-mesh-system</pre></li><li class="listitem"><p class="simpara">
								Create an <code class="literal">ImportedServiceSet</code> file based on the following example where <code class="literal">green-mesh</code> is importing services previously exported by <code class="literal">red-mesh</code>.
							</p><div class="formalpara"><p class="title"><strong>Example ImportedServiceSet resource from red-mesh to green-mesh</strong></p><p>
									
<pre class="programlisting language-yaml">kind: ImportedServiceSet
apiVersion: federation.maistra.io/v1
metadata:
  name: red-mesh
  namespace: green-mesh-system
spec:
  importRules:
  - type: NameSelector
    importAsLocal: false
    nameSelector:
      namespace: bookinfo
      name: red-ratings
      alias:
        namespace: bookinfo
        name: ratings</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Run the following command to upload and create the <code class="literal">ImportedServiceSet</code> resource in the green-mesh-system namespace.
							</p><pre class="programlisting language-terminal">$ oc create -n &lt;ControlPlaneNamespace&gt; -f &lt;ImportedServiceSet.yaml&gt;</pre><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc create -n green-mesh-system -f import-from-red-mesh.yaml</pre></li><li class="listitem">
								Create additional <code class="literal">ImportedServiceSet</code> resources as needed for each mesh peer in your federated mesh.
							</li><li class="listitem"><p class="simpara">
								To validate the services you’ve imported into <code class="literal">green-mesh</code>, run the following command:
							</p><pre class="programlisting language-terminal">$ oc get importedserviceset &lt;PeerMeshImportedInto&gt; -o yaml</pre><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc get importedserviceset green-mesh -o yaml</pre></li><li class="listitem"><p class="simpara">
								Run the following command to validate the services imported into a mesh.
							</p><pre class="programlisting language-terminal">$ oc get importedserviceset &lt;PeerMeshImportedInto&gt; -o yaml</pre><div class="formalpara"><p class="title"><strong>Example validating that the services exported from the red mesh have been imported into the green mesh using the status section of the <code class="literal">importedserviceset/red-mesh' object in the 'green-mesh-system</code> namespace:</strong></p><p>
									
<pre class="programlisting language-terminal">$ oc -n green-mesh-system get importedserviceset/red-mesh -o yaml</pre>

								</p></div><pre class="programlisting language-yaml">status:
  importedServices:
  - exportedName: red-ratings.bookinfo.svc.green-mesh-exports.local
    localService:
      hostname: ratings.bookinfo.svc.red-mesh-imports.local
      name: ratings
      namespace: bookinfo
  - exportedName: reviews.red-mesh-bookinfo.svc.green-mesh-exports.local
    localService:
      hostname: ""
      name: ""
      namespace: ""</pre><p class="simpara">
								In the preceding example only the ratings service is imported, as indicated by the populated fields under <code class="literal">localService</code>. The reviews service is available for import, but isn’t currently imported because it does not match any <code class="literal">importRules</code> in the <code class="literal">ImportedServiceSet</code> object.
							</p></li></ol></div></section></section><section class="section" id="ossm-federation-config-failover-overview_federation"><div class="titlepage"><div><div><h3 class="title">1.18.13. Configuring a federated mesh for failover</h3></div></div></div><p>
					Failover is the ability to switch automatically and seamlessly to a reliable backup system, for example another server. In the case of a federated mesh, you can configure a service in one mesh to failover to a service in another mesh.
				</p><p>
					You configure Federation for failover by setting the <code class="literal">importAsLocal</code> and <code class="literal">locality</code> settings in an <code class="literal">ImportedServiceSet</code> resource and then configuring a <code class="literal">DestinationRule</code> that configures failover for the service to the locality specified in the <code class="literal">ImportedServiceSet</code>.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Two or more OpenShift Container Platform 4.6 or above clusters already networked and federated.
						</li><li class="listitem">
							<code class="literal">ExportedServiceSet</code> resources already created for each mesh peer in the federated mesh.
						</li><li class="listitem">
							<code class="literal">ImportedServiceSet</code> resources already created for each mesh peer in the federated mesh.
						</li><li class="listitem">
							An account with the <code class="literal">cluster-admin</code> role.
						</li></ul></div><section class="section" id="ossm-federation-config-importedserviceset-failover_federation"><div class="titlepage"><div><div><h4 class="title">1.18.13.1. Configuring an ImportedServiceSet for failover</h4></div></div></div><p>
						Locality-weighted load balancing allows administrators to control the distribution of traffic to endpoints based on the localities of where the traffic originates and where it will terminate. These localities are specified using arbitrary labels that designate a hierarchy of localities in {region}/{zone}/{sub-zone} form.
					</p><p>
						In the examples in this section, the <code class="literal">green-mesh</code> is located in the <code class="literal">us-east</code> region, and the <code class="literal">red-mesh</code> is located in the <code class="literal">us-west</code> region.
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">ImportedServiceSet</code> resource from red-mesh to green-mesh</strong></p><p>
							
<pre class="programlisting language-yaml">kind: ImportedServiceSet
apiVersion: federation.maistra.io/v1
metadata:
  name: red-mesh #name of mesh that exported the service
  namespace: green-mesh-system #mesh namespace that service is being imported into
spec:
  importRules: # first matching rule is used
  # import ratings.bookinfo as ratings.bookinfo
  - type: NameSelector
    importAsLocal: true
    nameSelector:
      namespace: bookinfo
      name: ratings
      alias:
        # service will be imported as ratings.bookinfo.svc.red-mesh-imports.local
        namespace: bookinfo
        name: ratings
  #Locality within which imported services should be associated.
  locality:
    region: us-west</pre>

						</p></div><div class="table" id="idm140663648600096"><p class="title"><strong>Table 1.12. <code class="literal">ImportedServiceLocality</code> fields table</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663649431136" scope="col">Name</th><th align="left" valign="top" id="idm140663649430048" scope="col">Description</th><th align="left" valign="top" id="idm140663649428960" scope="col">Type</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663649431136"> <p>
										region:
									</p>
									 </td><td align="left" valign="top" headers="idm140663649430048"> <p>
										Region within which imported services are located.
									</p>
									 </td><td align="left" valign="top" headers="idm140663649428960"> <p>
										string
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663649431136"> <p>
										subzone:
									</p>
									 </td><td align="left" valign="top" headers="idm140663649430048"> <p>
										Subzone within which imported services are located. I Subzone is specified, Zone must also be specified.
									</p>
									 </td><td align="left" valign="top" headers="idm140663649428960"> <p>
										string
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663649431136"> <p>
										zone:
									</p>
									 </td><td align="left" valign="top" headers="idm140663649430048"> <p>
										Zone within which imported services are located. If Zone is specified, Region must also be specified.
									</p>
									 </td><td align="left" valign="top" headers="idm140663649428960"> <p>
										string
									</p>
									 </td></tr></tbody></table></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Log in to the OpenShift Container Platform CLI as a user with the <code class="literal">cluster-admin</code> role, enter the following command:
							</p><pre class="programlisting language-terminal">$ oc login --username=&lt;NAMEOFUSER&gt; &lt;API token&gt; https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
								Change to the project where you installed the Service Mesh control plane, enter the following command:
							</p><pre class="programlisting language-terminal">$ oc project &lt;smcp-system&gt;</pre><p class="simpara">
								For example, <code class="literal">green-mesh-system</code>.
							</p><pre class="programlisting language-terminal">$ oc project green-mesh-system</pre></li><li class="listitem"><p class="simpara">
								Edit the <code class="literal">ImportedServiceSet</code> file, where <code class="literal">&lt;ImportedServiceSet.yaml&gt;</code> includes a full path to the file you want to edit, enter the following command:
							</p><pre class="programlisting language-terminal">$ oc edit -n &lt;smcp-system&gt; -f &lt;ImportedServiceSet.yaml&gt;</pre><p class="simpara">
								For example, if you want to modify the file that imports from the red-mesh-system to the green-mesh-system as shown in the previous <code class="literal">ImportedServiceSet</code> example.
							</p><pre class="programlisting language-terminal">$ oc edit -n green-mesh-system -f import-from-red-mesh.yaml</pre></li><li class="listitem"><p class="simpara">
								Modify the file:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Set <code class="literal">spec.importRules.importAsLocal</code> to <code class="literal">true</code>.
									</li><li class="listitem">
										Set <code class="literal">spec.locality</code> to a <code class="literal">region</code>, <code class="literal">zone</code>, or <code class="literal">subzone</code>.
									</li><li class="listitem">
										Save your changes.
									</li></ol></div></li></ol></div></section><section class="section" id="ossm-federation-config-destinationrule-failover_federation"><div class="titlepage"><div><div><h4 class="title">1.18.13.2. Configuring a DestinationRule for failover</h4></div></div></div><p>
						Create a <code class="literal">DestinationRule</code> resource that configures the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Outlier detection for the service. This is required in order for failover to function properly. In particular, it configures the sidecar proxies to know when endpoints for a service are unhealthy, eventually triggering a failover to the next locality.
							</li><li class="listitem">
								Failover policy between regions. This ensures that failover beyond a region boundary will behave predictably.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Log in to the OpenShift Container Platform CLI as a user with the <code class="literal">cluster-admin</code> role. Enter the following command. Then, enter your username and password when prompted.
							</p><pre class="programlisting language-terminal">$ oc login --username=&lt;NAMEOFUSER&gt; &lt;API token&gt; https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
								Change to the project where you installed the Service Mesh control plane.
							</p><pre class="programlisting language-terminal">$ oc project &lt;smcp-system&gt;</pre><p class="simpara">
								For example, <code class="literal">green-mesh-system</code>.
							</p><pre class="programlisting language-terminal">$ oc project green-mesh-system</pre></li><li class="listitem"><p class="simpara">
								Create a <code class="literal">DestinationRule</code> file based on the following example where if green-mesh is unavailable, the traffic should be routed from the green-mesh in the <code class="literal">us-east</code> region to the red-mesh in <code class="literal">us-west</code>.
							</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">DestinationRule</code></strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: default-failover
  namespace: bookinfo
spec:
  host: "ratings.bookinfo.svc.cluster.local"
  trafficPolicy:
    loadBalancer:
      localityLbSetting:
        enabled: true
        failover:
          - from: us-east
            to: us-west
    outlierDetection:
      consecutive5xxErrors: 3
      interval: 10s
      baseEjectionTime: 1m</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Deploy the <code class="literal">DestinationRule</code>, where <code class="literal">&lt;DestinationRule&gt;</code> includes the full path to your file, enter the following command:
							</p><pre class="programlisting language-terminal">$ oc create -n &lt;application namespace&gt; -f &lt;DestinationRule.yaml&gt;</pre><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc create -n bookinfo -f green-mesh-us-west-DestinationRule.yaml</pre></li></ol></div></section></section><section class="section" id="ossm-federation-remove-service_federation"><div class="titlepage"><div><div><h3 class="title">1.18.14. Removing a service from the federated mesh</h3></div></div></div><p>
					If you need to remove a service from the federated mesh, for example if it has become obsolete or has been replaced by a different service, you can do so.
				</p><section class="section" id="to-remove-a-service-from-a-single-mesh"><div class="titlepage"><div><div><h4 class="title">1.18.14.1. To remove a service from a single mesh</h4></div></div></div><p>
						Remove the entry for the service from the <code class="literal">ImportedServiceSet</code> resource for the mesh peer that no longer should access the service.
					</p></section><section class="section" id="to-remove-a-service-from-the-entire-federated-mesh"><div class="titlepage"><div><div><h4 class="title">1.18.14.2. To remove a service from the entire federated mesh</h4></div></div></div><p>
						Remove the entry for the service from the <code class="literal">ExportedServiceSet</code> resource for the mesh that owns the service.
					</p></section></section><section class="section" id="ossm-federation-remove-mesh_federation"><div class="titlepage"><div><div><h3 class="title">1.18.15. Removing a mesh from the federated mesh</h3></div></div></div><p>
					If you need to remove a mesh from the federation, you can do so.
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Edit the removed mesh’s <code class="literal">ServiceMeshControlPlane</code> resource to remove all federation ingress gateways for peer meshes.
						</li><li class="listitem"><p class="simpara">
							For each mesh peer that the removed mesh has been federated with:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Remove the <code class="literal">ServiceMeshPeer</code> resource that links the two meshes.
								</li><li class="listitem">
									Edit the peer mesh’s <code class="literal">ServiceMeshControlPlane</code> resource to remove the egress gateway that serves the removed mesh.
								</li></ol></div></li></ol></div></section></section><section class="section" id="ossm-extensions"><div class="titlepage"><div><div><h2 class="title">1.19. Extensions</h2></div></div></div><p>
				You can use WebAssembly extensions to add new features directly into the Red Hat OpenShift Service Mesh proxies. This lets you move even more common functionality out of your applications, and implement them in a single language that compiles to WebAssembly bytecode.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					WebAssembly extensions are not supported on IBM Z and IBM Power.
				</p></div></div><section class="section" id="ossm-extensions-overview_ossm-extensions"><div class="titlepage"><div><div><h3 class="title">1.19.1. WebAssembly modules overview</h3></div></div></div><p>
					WebAssembly modules can be run on many platforms, including proxies, and have broad language support, fast execution, and a sandboxed-by-default security model.
				</p><p>
					Red Hat OpenShift Service Mesh extensions are <a class="link" href="https://www.envoyproxy.io/docs/envoy/v1.20.0/intro/arch_overview/http/http_filters#arch-overview-http-filters">Envoy HTTP Filters</a>, giving them a wide range of capabilities:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Manipulating the body and headers of requests and responses.
						</li><li class="listitem">
							Out-of-band HTTP requests to services not in the request path, such as authentication or policy checking.
						</li><li class="listitem">
							Side-channel data storage and queues for filters to communicate with each other.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						When creating new WebAssembly extensions, use the <code class="literal">WasmPlugin</code> API. The <code class="literal">ServiceMeshExtension</code> API was deprecated in Red Hat OpenShift Service Mesh version 2.2 and was removed in Red Hat OpenShift Service Mesh version 2.3.
					</p></div></div><p>
					There are two parts to writing a Red Hat OpenShift Service Mesh extension:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							You must write your extension using an SDK that exposes the <a class="link" href="https://github.com/proxy-wasm/spec">proxy-wasm API</a> and compile it to a WebAssembly module.
						</li><li class="listitem">
							You must then package the module into a container.
						</li></ol></div><div class="formalpara"><p class="title"><strong>Supported languages</strong></p><p>
						You can use any language that compiles to WebAssembly bytecode to write a Red Hat OpenShift Service Mesh extension, but the following languages have existing SDKs that expose the proxy-wasm API so that it can be consumed directly.
					</p></div><div class="table" id="idm140663650112720"><p class="title"><strong>Table 1.13. Supported languages</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663650106960" scope="col">Language</th><th align="left" valign="top" id="idm140663650105872" scope="col">Maintainer</th><th align="left" valign="top" id="idm140663650104784" scope="col">Repository</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663650106960"> <p>
									AssemblyScript
								</p>
								 </td><td align="left" valign="top" headers="idm140663650105872"> <p>
									solo.io
								</p>
								 </td><td align="left" valign="top" headers="idm140663650104784"> <p>
									<a class="link" href="https://github.com/solo-io/proxy-runtime">solo-io/proxy-runtime</a>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650106960"> <p>
									C++
								</p>
								 </td><td align="left" valign="top" headers="idm140663650105872"> <p>
									proxy-wasm team (Istio Community)
								</p>
								 </td><td align="left" valign="top" headers="idm140663650104784"> <p>
									<a class="link" href="https://github.com/proxy-wasm/proxy-wasm-cpp-sdk">proxy-wasm/proxy-wasm-cpp-sdk</a>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650106960"> <p>
									Go
								</p>
								 </td><td align="left" valign="top" headers="idm140663650105872"> <p>
									tetrate.io
								</p>
								 </td><td align="left" valign="top" headers="idm140663650104784"> <p>
									<a class="link" href="https://github.com/tetratelabs/proxy-wasm-go-sdk">tetratelabs/proxy-wasm-go-sdk</a>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650106960"> <p>
									Rust
								</p>
								 </td><td align="left" valign="top" headers="idm140663650105872"> <p>
									proxy-wasm team (Istio Community)
								</p>
								 </td><td align="left" valign="top" headers="idm140663650104784"> <p>
									<a class="link" href="https://github.com/proxy-wasm/proxy-wasm-rust-sdk">proxy-wasm/proxy-wasm-rust-sdk</a>
								</p>
								 </td></tr></tbody></table></div></div></section><section class="section" id="ossm-extensions-wasmplugin-format_ossm-extensions"><div class="titlepage"><div><div><h3 class="title">1.19.2. <code class="literal">WasmPlugin</code> container format</h3></div></div></div><p>
					Istio supports Open Container Initiative (OCI) images in its Wasm Plugin mechanism. You can distribute your Wasm Plugins as a container image, and you can use the <code class="literal">spec.url</code> field to refer to a container registry location. For example, <code class="literal">quay.io/my-username/my-plugin:latest</code>.
				</p><p>
					Because each execution environment (runtime) for a WASM module can have runtime-specific configuration parameters, a WASM image can be composed of two layers:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>plugin.wasm</strong></span> (Required) - Content layer. This layer consists of a <code class="literal">.wasm</code> binary containing the bytecode of your WebAssembly module, to be loaded by the runtime. You must name this file <code class="literal">plugin.wasm</code>.
						</li><li class="listitem">
							<span class="strong strong"><strong>runtime-config.json</strong></span> (Optional) - Configuration layer. This layer consists of a JSON-formatted string that describes metadata about the module for the target runtime. The config layer might also contain additional data, depending on the target runtime. For example, the config for a WASM Envoy Filter contains root_ids available on the filter.
						</li></ul></div></section><section class="section" id="ossm-wasm-ref-wasmplugin_ossm-extensions"><div class="titlepage"><div><div><h3 class="title">1.19.3. WasmPlugin API reference</h3></div></div></div><p>
					The WasmPlugins API provides a mechanism to extend the functionality provided by the Istio proxy through WebAssembly filters.
				</p><p>
					You can deploy multiple WasmPlugins. The <code class="literal">phase</code> and <code class="literal">priority</code> settings determine the order of execution (as part of Envoy’s filter chain), allowing the configuration of complex interactions between user-supplied WasmPlugins and Istio’s internal filters.
				</p><p>
					In the following example, an authentication filter implements an OpenID flow and populates the Authorization header with a JSON Web Token (JWT). Istio authentication consumes this token and deploys it to the ingress gateway. The WasmPlugin file lives in the proxy sidecar filesystem. Note the field <code class="literal">url</code>.
				</p><pre class="programlisting language-yaml">apiVersion: extensions.istio.io/v1alpha1
kind: WasmPlugin
metadata:
  name: openid-connect
  namespace: istio-ingress
spec:
  selector:
    matchLabels:
      istio: ingressgateway
  url: file:///opt/filters/openid.wasm
  sha256: 1ef0c9a92b0420cf25f7fe5d481b231464bc88f486ca3b9c83ed5cc21d2f6210
  phase: AUTHN
  pluginConfig:
    openid_server: authn
    openid_realm: ingress</pre><p>
					Below is the same example, but this time an Open Container Initiative (OCI) image is used instead of a file in the filesystem. Note the fields <code class="literal">url</code>, <code class="literal">imagePullPolicy</code>, and <code class="literal">imagePullSecret</code>.
				</p><pre class="programlisting language-yaml">apiVersion: extensions.istio.io/v1alpha1
kind: WasmPlugin
metadata:
  name: openid-connect
  namespace: istio-system
spec:
  selector:
    matchLabels:
      istio: ingressgateway
  url: oci://private-registry:5000/openid-connect/openid:latest
  imagePullPolicy: IfNotPresent
  imagePullSecret: private-registry-pull-secret
  phase: AUTHN
  pluginConfig:
    openid_server: authn
    openid_realm: ingress</pre><div class="table" id="idm140663650962272"><p class="title"><strong>Table 1.14. WasmPlugin Field Reference</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663650955568" scope="col">Field</th><th align="left" valign="top" id="idm140663650954480" scope="col">Type</th><th align="left" valign="top" id="idm140663650953392" scope="col">Description</th><th align="left" valign="top" id="idm140663650952304" scope="col">Required</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663650955568"> <p>
									spec.selector
								</p>
								 </td><td align="left" valign="top" headers="idm140663650954480"> <p>
									WorkloadSelector
								</p>
								 </td><td align="left" valign="top" headers="idm140663650953392"> <p>
									Criteria used to select the specific set of pods/VMs on which this plugin configuration should be applied. If omitted, this configuration will be applied to all workload instances in the same namespace. If the <code class="literal">WasmPlugin</code> field is present in the config root namespace, it will be applied to all applicable workloads in any namespace.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650952304"> <p>
									No
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650955568"> <p>
									spec.url
								</p>
								 </td><td align="left" valign="top" headers="idm140663650954480"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140663650953392"> <p>
									URL of a Wasm module or OCI container. If no scheme is present, defaults to <code class="literal">oci://</code>, referencing an OCI image. Other valid schemes are <code class="literal">file://</code> for referencing .wasm module files present locally within the proxy container, and <code class="literal">http[s]://</code> for .wasm module files hosted remotely.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650952304"> <p>
									No
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650955568"> <p>
									spec.sha256
								</p>
								 </td><td align="left" valign="top" headers="idm140663650954480"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140663650953392"> <p>
									SHA256 checksum that will be used to verify the Wasm module or OCI container. If the <code class="literal">url</code> field already references a SHA256 (using the <code class="literal">@sha256:</code> notation), it must match the value of this field. If an OCI image is referenced by tag and this field is set, its checksum will be verified against the contents of this field after pulling.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650952304"> <p>
									No
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650955568"> <p>
									spec.imagePullPolicy
								</p>
								 </td><td align="left" valign="top" headers="idm140663650954480"> <p>
									PullPolicy
								</p>
								 </td><td align="left" valign="top" headers="idm140663650953392"> <p>
									The pull behavior to be applied when fetching an OCI image. Only relevant when images are referenced by tag instead of SHA. Defaults to the value <code class="literal">IfNotPresent</code>, except when an OCI image is referenced in the <code class="literal">url</code> field and the <code class="literal">latest</code> tag is used, in which case the value <code class="literal">Always</code> is the default, mirroring K8s behavior. Setting is ignored if the <code class="literal">url</code> field is referencing a Wasm module directly using <code class="literal">file://</code> or <code class="literal">http[s]://</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650952304"> <p>
									No
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650955568"> <p>
									spec.imagePullSecret
								</p>
								 </td><td align="left" valign="top" headers="idm140663650954480"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140663650953392"> <p>
									Credentials to use for OCI image pulling. The name of a secret in the same namespace as the <code class="literal">WasmPlugin</code> object that contains a pull secret for authenticating against the registry when pulling the image.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650952304"> <p>
									No
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650955568"> <p>
									spec.phase
								</p>
								 </td><td align="left" valign="top" headers="idm140663650954480"> <p>
									PluginPhase
								</p>
								 </td><td align="left" valign="top" headers="idm140663650953392"> <p>
									Determines where in the filter chain this <code class="literal">WasmPlugin</code> object is injected.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650952304"> <p>
									No
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650955568"> <p>
									spec.priority
								</p>
								 </td><td align="left" valign="top" headers="idm140663650954480"> <p>
									<code class="literal">int64</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663650953392"> <p>
									Determines the ordering of <code class="literal">WasmPlugins</code> objects that have the same <code class="literal">phase</code> value. When multiple <code class="literal">WasmPlugins</code> objects are applied to the same workload in the same phase, they will be applied by priority and in descending order. If the <code class="literal">priority</code> field is not set, or two <code class="literal">WasmPlugins</code> objects with the same value, the ordering will be determined from the name and namespace of the <code class="literal">WasmPlugins</code> objects. Defaults to the value <code class="literal">0</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650952304"> <p>
									No
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650955568"> <p>
									spec.pluginName
								</p>
								 </td><td align="left" valign="top" headers="idm140663650954480"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140663650953392"> <p>
									The plugin name used in the Envoy configuration. Some Wasm modules might require this value to select the Wasm plugin to execute.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650952304"> <p>
									No
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650955568"> <p>
									spec.pluginConfig
								</p>
								 </td><td align="left" valign="top" headers="idm140663650954480"> <p>
									Struct
								</p>
								 </td><td align="left" valign="top" headers="idm140663650953392"> <p>
									The configuration that will be passed on to the plugin.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650952304"> <p>
									No
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650955568"> <p>
									spec.pluginConfig.verificationKey
								</p>
								 </td><td align="left" valign="top" headers="idm140663650954480"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140663650953392"> <p>
									The public key used to verify signatures of signed OCI images or Wasm modules. Must be supplied in PEM format.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650952304"> <p>
									No
								</p>
								 </td></tr></tbody></table></div></div><p>
					The <code class="literal">WorkloadSelector</code> object specifies the criteria used to determine if a filter can be applied to a proxy. The matching criteria includes the metadata associated with a proxy, workload instance information such as labels attached to the pod/VM, or any other information that the proxy provides to Istio during the initial handshake. If multiple conditions are specified, all conditions need to match in order for the workload instance to be selected. Currently, only label based selection mechanism is supported.
				</p><div class="table" id="idm140663689765008"><p class="title"><strong>Table 1.15. WorkloadSelector</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663689758320" scope="col">Field</th><th align="left" valign="top" id="idm140663689757232" scope="col">Type</th><th align="left" valign="top" id="idm140663661149968" scope="col">Description</th><th align="left" valign="top" id="idm140663661148880" scope="col">Required</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663689758320"> <p>
									matchLabels
								</p>
								 </td><td align="left" valign="top" headers="idm140663689757232"> <p>
									map&lt;string, string&gt;
								</p>
								 </td><td align="left" valign="top" headers="idm140663661149968"> <p>
									One or more labels that indicate a specific set of pods/VMs on which a policy should be applied. The scope of label search is restricted to the configuration namespace in which the resource is present.
								</p>
								 </td><td align="left" valign="top" headers="idm140663661148880"> <p>
									Yes
								</p>
								 </td></tr></tbody></table></div></div><p>
					The <code class="literal">PullPolicy</code> object specifies the pull behavior to be applied when fetching an OCI image.
				</p><div class="table" id="idm140663661138704"><p class="title"><strong>Table 1.16. PullPolicy</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663661133872" scope="col">Value</th><th align="left" valign="top" id="idm140663661132784" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663661133872"> <p>
									&lt;empty&gt;
								</p>
								 </td><td align="left" valign="top" headers="idm140663661132784"> <p>
									Defaults to the value <code class="literal">IfNotPresent</code>, except for OCI images with tag latest, for which the default will be the value <code class="literal">Always</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663661133872"> <p>
									IfNotPresent
								</p>
								 </td><td align="left" valign="top" headers="idm140663661132784"> <p>
									If an existing version of the image has been pulled before, that will be used. If no version of the image is present locally, we will pull the latest version.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663661133872"> <p>
									Always
								</p>
								 </td><td align="left" valign="top" headers="idm140663661132784"> <p>
									Always pull the latest version of an image when applying this plugin.
								</p>
								 </td></tr></tbody></table></div></div><p>
					<code class="literal">Struct</code> represents a structured data value, consisting of fields which map to dynamically typed values. In some languages, Struct might be supported by a native representation. For example, in scripting languages like JavaScript a struct is represented as an object.
				</p><div class="table" id="idm140663713856080"><p class="title"><strong>Table 1.17. Struct</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663713850320" scope="col">Field</th><th align="left" valign="top" id="idm140663713849232" scope="col">Type</th><th align="left" valign="top" id="idm140663713848144" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663713850320"> <p>
									fields
								</p>
								 </td><td align="left" valign="top" headers="idm140663713849232"> <p>
									map&lt;string, Value&gt;
								</p>
								 </td><td align="left" valign="top" headers="idm140663713848144"> <p>
									Map of dynamically typed values.
								</p>
								 </td></tr></tbody></table></div></div><p>
					<code class="literal">PluginPhase</code> specifies the phase in the filter chain where the plugin will be injected.
				</p><div class="table" id="idm140663713839712"><p class="title"><strong>Table 1.18. PluginPhase</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663649399952" scope="col">Field</th><th align="left" valign="top" id="idm140663649398864" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663649399952"> <p>
									&lt;empty&gt;
								</p>
								 </td><td align="left" valign="top" headers="idm140663649398864"> <p>
									Control plane decides where to insert the plugin. This will generally be at the end of the filter chain, right before the Router. Do not specify PluginPhase if the plugin is independent of others.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663649399952"> <p>
									AUTHN
								</p>
								 </td><td align="left" valign="top" headers="idm140663649398864"> <p>
									Insert plugin before Istio authentication filters.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663649399952"> <p>
									AUTHZ
								</p>
								 </td><td align="left" valign="top" headers="idm140663649398864"> <p>
									Insert plugin before Istio authorization filters and after Istio authentication filters.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663649399952"> <p>
									STATS
								</p>
								 </td><td align="left" valign="top" headers="idm140663649398864"> <p>
									Insert plugin before Istio stats filters and after Istio authorization filters.
								</p>
								 </td></tr></tbody></table></div></div><section class="section" id="ossm-wasmplugin-deploy_ossm-extensions"><div class="titlepage"><div><div><h4 class="title">1.19.3.1. Deploying <code class="literal">WasmPlugin</code> resources</h4></div></div></div><p>
						You can enable Red Hat OpenShift Service Mesh extensions using the <code class="literal">WasmPlugin</code> resource. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project. The following example creates an <code class="literal">openid-connect</code> filter that performs an OpenID Connect flow to authenticate the user.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create the following example resource:
							</p><div class="formalpara"><p class="title"><strong>Example plugin.yaml</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: extensions.istio.io/v1alpha1
kind: WasmPlugin
metadata:
  name: openid-connect
  namespace: istio-system
spec:
  selector:
    matchLabels:
      istio: ingressgateway
  url: oci://private-registry:5000/openid-connect/openid:latest
  imagePullPolicy: IfNotPresent
  imagePullSecret: private-registry-pull-secret
  phase: AUTHN
  pluginConfig:
    openid_server: authn
    openid_realm: ingress</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Apply your <code class="literal">plugin.yaml</code> file with the following command:
							</p><pre class="programlisting language-terminal">$ oc apply -f plugin.yaml</pre></li></ol></div></section></section><section class="section" id="ossm-extensions-smextension-format_ossm-extensions"><div class="titlepage"><div><div><h3 class="title">1.19.4. <code class="literal">ServiceMeshExtension</code> container format</h3></div></div></div><p>
					You must have a <code class="literal">.wasm</code> file containing the bytecode of your WebAssembly module, and a <code class="literal">manifest.yaml</code> file in the root of the container filesystem to make your container image a valid extension image.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						When creating new WebAssembly extensions, use the <code class="literal">WasmPlugin</code> API. The <code class="literal">ServiceMeshExtension</code> API was deprecated in Red Hat OpenShift Service Mesh version 2.2 and was removed in Red Hat OpenShift Service Mesh version 2.3.
					</p></div></div><div class="formalpara"><p class="title"><strong>manifest.yaml</strong></p><p>
						
<pre class="programlisting language-yaml">schemaVersion: 1

name: &lt;your-extension&gt;
description: &lt;description&gt;
version: 1.0.0
phase: PreAuthZ
priority: 100
module: extension.wasm</pre>

					</p></div><div class="table" id="idm140663689803104"><p class="title"><strong>Table 1.19. Field Reference for manifest.yml</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663689797328" scope="col">Field</th><th align="left" valign="top" id="idm140663689796240" scope="col">Description</th><th align="left" valign="top" id="idm140663689795152" scope="col">Required</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663689797328"> <p>
									schemaVersion
								</p>
								 </td><td align="left" valign="top" headers="idm140663689796240"> <p>
									Used for versioning of the manifest schema. Currently the only possible value is <code class="literal">1</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140663689795152"> <p>
									This is a required field.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663689797328"> <p>
									name
								</p>
								 </td><td align="left" valign="top" headers="idm140663689796240"> <p>
									The name of your extension.
								</p>
								 </td><td align="left" valign="top" headers="idm140663689795152"> <p>
									This field is just metadata and currently unused.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663689797328"> <p>
									description
								</p>
								 </td><td align="left" valign="top" headers="idm140663689796240"> <p>
									The description of your extension.
								</p>
								 </td><td align="left" valign="top" headers="idm140663689795152"> <p>
									This field is just metadata and currently unused.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663689797328"> <p>
									version
								</p>
								 </td><td align="left" valign="top" headers="idm140663689796240"> <p>
									The version of your extension.
								</p>
								 </td><td align="left" valign="top" headers="idm140663689795152"> <p>
									This field is just metadata and currently unused.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663689797328"> <p>
									phase
								</p>
								 </td><td align="left" valign="top" headers="idm140663689796240"> <p>
									The default execution phase of your extension.
								</p>
								 </td><td align="left" valign="top" headers="idm140663689795152"> <p>
									This is a required field.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663689797328"> <p>
									priority
								</p>
								 </td><td align="left" valign="top" headers="idm140663689796240"> <p>
									The default priority of your extension.
								</p>
								 </td><td align="left" valign="top" headers="idm140663689795152"> <p>
									This is a required field.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663689797328"> <p>
									module
								</p>
								 </td><td align="left" valign="top" headers="idm140663689796240"> <p>
									The relative path from the container filesystem’s root to your WebAssembly module.
								</p>
								 </td><td align="left" valign="top" headers="idm140663689795152"> <p>
									This is a required field.
								</p>
								 </td></tr></tbody></table></div></div></section><section class="section" id="ossm-wasm-ref-smextension_ossm-extensions"><div class="titlepage"><div><div><h3 class="title">1.19.5. ServiceMeshExtension reference</h3></div></div></div><p>
					The ServiceMeshExtension API provides a mechanism to extend the functionality provided by the Istio proxy through WebAssembly filters. There are two parts to writing a WebAssembly extension:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Write your extension using an SDK that exposes the proxy-wasm API and compile it to a WebAssembly module.
						</li><li class="listitem">
							Package it into a container.
						</li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						When creating new WebAssembly extensions, use the <code class="literal">WasmPlugin</code> API. The <code class="literal">ServiceMeshExtension</code> API, which was deprecated in Red Hat OpenShift Service Mesh version 2.2, was removed in Red Hat OpenShift Service Mesh version 2.3.
					</p></div></div><div class="table" id="idm140663661109216"><p class="title"><strong>Table 1.20. ServiceMeshExtension Field Reference</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663661104368" scope="col">Field</th><th align="left" valign="top" id="idm140663661103280" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663661104368"> <p>
									metadata.namespace
								</p>
								 </td><td align="left" valign="top" headers="idm140663661103280"> <p>
									The <code class="literal">metadata.namespace</code> field of a <code class="literal">ServiceMeshExtension</code> source has a special semantic: if it equals the Control Plane Namespace, the extension will be applied to all workloads in the Service Mesh that match its <code class="literal">workloadSelector</code> value. When deployed to any other Mesh Namespace, it will only be applied to workloads in that same Namespace.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663661104368"> <p>
									spec.workloadSelector
								</p>
								 </td><td align="left" valign="top" headers="idm140663661103280"> <p>
									The <code class="literal">spec.workloadSelector</code> field has the same semantic as the <code class="literal">spec.selector</code> field of the <a class="link" href="https://istio.io/v1.6/docs/reference/config/networking/gateway/#Gateway">Istio Gateway resource</a>. It will match a workload based on its Pod labels. If no <code class="literal">workloadSelector</code> value is specified, the extension will be applied to all workloads in the namespace.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663661104368"> <p>
									spec.config
								</p>
								 </td><td align="left" valign="top" headers="idm140663661103280"> <p>
									This is a structured field that will be handed over to the extension, with the semantics dependent on the extension you are deploying.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663661104368"> <p>
									spec.image
								</p>
								 </td><td align="left" valign="top" headers="idm140663661103280"> <p>
									A container image URI pointing to the image that holds the extension.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663661104368"> <p>
									spec.phase
								</p>
								 </td><td align="left" valign="top" headers="idm140663661103280"> <p>
									The phase determines where in the filter chain the extension is injected, in relation to existing Istio functionality like Authentication, Authorization and metrics generation. Valid values are: PreAuthN, PostAuthN, PreAuthZ, PostAuthZ, PreStats, PostStats. This field defaults to the value set in the <code class="literal">manifest.yaml</code> file of the extension, but can be overwritten by the user.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663661104368"> <p>
									spec.priority
								</p>
								 </td><td align="left" valign="top" headers="idm140663661103280"> <p>
									If multiple extensions with the same <code class="literal">spec.phase</code> value are applied to the same workload instance, the <code class="literal">spec.priority</code> value determines the ordering of execution. Extensions with higher priority will be executed first. This allows for inter-dependent extensions. This field defaults to the value set in the <code class="literal">manifest.yaml</code> file of the extension, but can be overwritten by the user.
								</p>
								 </td></tr></tbody></table></div></div><section class="section" id="ossm-smextensions-deploy_ossm-extensions"><div class="titlepage"><div><div><h4 class="title">1.19.5.1. Deploying <code class="literal">ServiceMeshExtension</code> resources</h4></div></div></div><p>
						You can enable Red Hat OpenShift Service Mesh extensions using the <code class="literal">ServiceMeshExtension</code> resource. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When creating new WebAssembly extensions, use the <code class="literal">WasmPlugin</code> API. The <code class="literal">ServiceMeshExtension</code> API was deprecated in Red Hat OpenShift Service Mesh version 2.2 and removed in Red Hat OpenShift Service Mesh version 2.3.
						</p></div></div><p>
						For a complete example that was built using the Rust SDK, take a look at the <a class="link" href="https://github.com/maistra/header-append-filter">header-append-filter</a>. It is a simple filter that appends one or more headers to the HTTP responses, with their names and values taken out from the <code class="literal">config</code> field of the extension. See a sample configuration in the snippet below.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create the following example resource:
							</p><div class="formalpara"><p class="title"><strong>Example ServiceMeshExtension resource extension.yaml</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshExtension
metadata:
  name: header-append
  namespace: istio-system
spec:
  workloadSelector:
    labels:
      app: httpbin
  config:
    first-header: some-value
    another-header: another-value
  image: quay.io/maistra-dev/header-append-filter:2.1
  phase: PostAuthZ
  priority: 100</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Apply your <code class="literal">extension.yaml</code> file with the following command:
							</p><pre class="programlisting language-terminal">$ oc apply -f &lt;extension&gt;.yaml</pre></li></ol></div></section></section><section class="section" id="ossm-extensions-migration-overview_ossm-extensions"><div class="titlepage"><div><div><h3 class="title">1.19.6. Migrating from <code class="literal">ServiceMeshExtension</code> to <code class="literal">WasmPlugin</code> resources</h3></div></div></div><p>
					The <code class="literal">ServiceMeshExtension</code> API, which was deprecated in Red Hat OpenShift Service Mesh version 2.2, was removed in Red Hat OpenShift Service Mesh version 2.3. If you are using the <code class="literal">ServiceMeshExtension</code> API, you must migrate to the <code class="literal">WasmPlugin</code> API to continue using your WebAssembly extensions.
				</p><p>
					The APIs are very similar. The migration consists of two steps:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Renaming your plugin file and updating the module packaging.
						</li><li class="listitem">
							Creating a <code class="literal">WasmPlugin</code> resource that references the updated container image.
						</li></ol></div><section class="section" id="ossm-extensions-migration-api-changes_ossm-extensions"><div class="titlepage"><div><div><h4 class="title">1.19.6.1. API changes</h4></div></div></div><p>
						The new <code class="literal">WasmPlugin</code> API is similar to the <code class="literal">ServiceMeshExtension</code>, but with a few differences, especially in the field names:
					</p><div class="table" id="idm140663649746048"><p class="title"><strong>Table 1.21. Field changes between <code class="literal">ServiceMeshExtensions</code> and <code class="literal">WasmPlugin</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663649740416" scope="col">ServiceMeshExtension</th><th align="left" valign="top" id="idm140663649739328" scope="col">WasmPlugin</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663649740416"> <p>
										<code class="literal">spec.config</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663649739328"> <p>
										<code class="literal">spec.pluginConfig</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663649740416"> <p>
										<code class="literal">spec.workloadSelector</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663649739328"> <p>
										<code class="literal">spec.selector</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663649740416"> <p>
										<code class="literal">spec.image</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663649739328"> <p>
										<code class="literal">spec.url</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663649740416"> <p>
										<code class="literal">spec.phase</code> valid values: PreAuthN, PostAuthN, PreAuthZ, PostAuthZ, PreStats, PostStats
									</p>
									 </td><td align="left" valign="top" headers="idm140663649739328"> <p>
										<code class="literal">spec.phase</code> valid values: &lt;empty&gt;, AUTHN, AUTHZ, STATS
									</p>
									 </td></tr></tbody></table></div></div><p>
						The following is an example of how a <code class="literal">ServiceMeshExtension</code> resource could be converted into a <code class="literal">WasmPlugin</code> resource.
					</p><div class="formalpara"><p class="title"><strong>ServiceMeshExtension resource</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshExtension
metadata:
  name: header-append
  namespace: istio-system
spec:
  workloadSelector:
    labels:
      app: httpbin
  config:
    first-header: some-value
    another-header: another-value
  image: quay.io/maistra-dev/header-append-filter:2.2
  phase: PostAuthZ
  priority: 100</pre>

						</p></div><div class="formalpara"><p class="title"><strong>New WasmPlugin resource equivalent to the ServiceMeshExtension above</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: extensions.istio.io/v1alpha1
kind: WasmPlugin
metadata:
  name: header-append
  namespace: istio-system
spec:
  selector:
    matchLabels:
      app: httpbin
  url: oci://quay.io/maistra-dev/header-append-filter:2.2
  phase: STATS
  pluginConfig:
    first-header: some-value
    another-header: another-value</pre>

						</p></div></section><section class="section" id="ossm-extensions-migration-format-changes_ossm-extensions"><div class="titlepage"><div><div><h4 class="title">1.19.6.2. Container image format changes</h4></div></div></div><p>
						The new <code class="literal">WasmPlugin</code> container image format is similar to the <code class="literal">ServiceMeshExtensions</code>, with the following differences:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The <code class="literal">ServiceMeshExtension</code> container format required a metadata file named <code class="literal">manifest.yaml</code> in the root directory of the container filesystem. The <code class="literal">WasmPlugin</code> container format does not require a <code class="literal">manifest.yaml</code> file.
							</li><li class="listitem">
								The <code class="literal">.wasm</code> file (the actual plugin) that previously could have any filename now must be named <code class="literal">plugin.wasm</code> and must be located in the root directory of the container filesystem.
							</li></ul></div></section><section class="section" id="ossm-extensions-migrating-to-wasmplugin_ossm-extensions"><div class="titlepage"><div><div><h4 class="title">1.19.6.3. Migrating to <code class="literal">WasmPlugin</code> resources</h4></div></div></div><p>
						To upgrade your WebAssembly extensions from the <code class="literal">ServiceMeshExtension</code> API to the <code class="literal">WasmPlugin</code> API, you rename your plugin file.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">ServiceMeshControlPlane</code> is upgraded to version 2.2 or later.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Update your container image. If the plugin is already in <code class="literal">/plugin.wasm</code> inside the container, skip to the next step. If not:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Ensure the plugin file is named <code class="literal">plugin.wasm</code>. You must name the extension file <code class="literal">plugin.wasm</code>.
									</li><li class="listitem">
										Ensure the plugin file is located in the root (/) directory. You must store extension files in the root of the container filesystem..
									</li><li class="listitem">
										Rebuild your container image and push it to a container registry.
									</li></ol></div></li><li class="listitem">
								Remove the <code class="literal">ServiceMeshExtension</code> resource and create a <code class="literal">WasmPlugin</code> resource that refers to the new container image you built.
							</li></ol></div></section></section></section><section class="section" id="ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h2 class="title">1.20. Using the 3scale WebAssembly module</h2></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The <code class="literal">threescale-wasm-auth</code> module runs on integrations of 3scale API Management 2.11 or later with Red Hat OpenShift Service Mesh 2.1.0 or later.
				</p></div></div><p>
				The <code class="literal">threescale-wasm-auth</code> module is a <a class="link" href="https://webassembly.org">WebAssembly</a> module that uses a set of interfaces, known as an application binary interfaces (<span class="emphasis"><em>ABI</em></span>). This is defined by the <a class="link" href="https://github.com/proxy-wasm/spec"><span class="emphasis"><em>Proxy-WASM</em></span></a> specification to drive any piece of software that implements the ABI so it can authorize HTTP requests against 3scale.
			</p><p>
				As an ABI specification, Proxy-WASM defines the interaction between a piece of software named <span class="emphasis"><em>host</em></span> and another named <span class="emphasis"><em>module</em></span>, <span class="emphasis"><em>program</em></span>, or <span class="emphasis"><em>extension</em></span>. The host exposes a set of services used by the module to perform a task, and in this case, to process proxy requests.
			</p><p>
				The host environment is composed of a WebAssembly virtual machine interacting with a piece of software, in this case, an HTTP proxy.
			</p><p>
				The module itself runs in isolation to the outside world except for the instructions it runs on the virtual machine and the ABI specified by Proxy-WASM. This is a safe way to provide extension points to software: the extension can only interact in well-defined ways with the virtual machine and the host. The interaction provides a computing model and a connection to the outside world the proxy is meant to have.
			</p><section class="section" id="compatibility_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h3 class="title">1.20.1. Compatibility</h3></div></div></div><p>
					The <code class="literal">threescale-wasm-auth</code> module is designed to be fully compatible with all implementations of the <span class="emphasis"><em>Proxy-WASM ABI</em></span> specification. At this point, however, it has only been thoroughly tested to work with the <a class="link" href="https://www.envoyproxy.io">Envoy</a> reverse proxy.
				</p></section><section class="section" id="usage-as-a-stand-alone-module_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h3 class="title">1.20.2. Usage as a stand-alone module</h3></div></div></div><p>
					Because of its self-contained design, it is possible to configure this module to work with Proxy-WASM proxies independently of Service Mesh, as well as 3scale Istio adapter deployments.
				</p></section><section class="section" id="prerequisites_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h3 class="title">1.20.3. Prerequisites</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The module works with all supported 3scale releases, except when configuring a service to use <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#configuring-oidc-identity-provider">OpenID connect (OIDC)</a>, which requires 3scale 2.11 or later.
						</li></ul></div></section><section class="section" id="ossm-configuring-the-threescale-wasm-auth-module_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h3 class="title">1.20.4. Configuring the threescale-wasm-auth module</h3></div></div></div><p>
					Cluster administrators on OpenShift Container Platform can configure the <code class="literal">threescale-wasm-auth</code> module to authorize HTTP requests to 3scale API Management through an application binary interface (ABI). The ABI defines the interaction between host and the module, exposing the hosts services, and allows you to use the module to process proxy requests.
				</p><section class="section" id="the-wasmplugin-api-extension_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.4.1. The WasmPlugin API extension</h4></div></div></div><p>
						Service Mesh provides a custom resource definition to specify and apply Proxy-WASM extensions to sidecar proxies, known as <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-extensions-wasmplugin-format_ossm-extensions"><code class="literal">WasmPlugin</code></a>. Service Mesh applies this custom resource to the set of workloads that require HTTP API management with 3scale.
					</p><p>
						See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#crd-extending-api-with-crds">custom resource definition</a> for more information.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Configuring the WebAssembly extension is currently a manual process. Support for fetching the configuration for services from the 3scale system will be available in a future release.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Identify a Kubernetes workload and namespace on your Service Mesh deployment that you will apply this module.
							</li><li class="listitem">
								You must have a 3scale tenant account. See <a class="link" href="https://www.3scale.net/signup">SaaS</a> or <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_3scale_api_management/2.11/html-single/installing_3scale/index#install-threescale-on-openshift-guide">3scale 2.11 On-Premises</a> with a matching service and relevant applications and metrics defined.
							</li><li class="listitem"><p class="simpara">
								If you apply the module to the <code class="literal">&lt;product_page&gt;</code> microservice in the <code class="literal">bookinfo</code> namespace, see the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-tutorial-bookinfo-overview_deploying-applications-ossm-v1x">Bookinfo sample application</a>.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
										The following example is the YAML format for the custom resource for <code class="literal">threescale-wasm-auth</code> module. This example refers to the upstream Maistra version of Service Mesh, <code class="literal">WasmPlugin</code> API. You must declare the namespace where the <code class="literal">threescale-wasm-auth</code> module is deployed, alongside a <code class="literal">selector</code> to identify the set of applications the module will apply to:
									</p><pre class="programlisting language-yaml">apiVersion: extensions.istio.io/v1alpha1
kind: WasmPlugin
metadata:
  name: &lt;threescale_wasm_plugin_name&gt;
  namespace: &lt;bookinfo&gt; <span id="CO20-1"><!--Empty--></span><span class="callout">1</span>
spec:
  selector: <span id="CO20-2"><!--Empty--></span><span class="callout">2</span>
    labels:
      app: &lt;product_page&gt;
  pluginConfig: &lt;yaml_configuration&gt;
  url: oci://registry.redhat.io/3scale-amp2/3scale-auth-wasm-rhel8:0.0.3
  phase: AUTHZ
  priority: 100</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO20-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												The <code class="literal">namespace</code>.
											</div></dd><dt><a href="#CO20-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												The <code class="literal">selector</code>.
											</div></dd></dl></div></li></ul></div></li><li class="listitem"><p class="simpara">
								The <code class="literal">spec.pluginConfig</code> field depends on the module configuration and it is not populated in the previous example. Instead, the example uses the <code class="literal">&lt;yaml_configuration&gt;</code> placeholder value. You can use the format of this custom resource example.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
										The <code class="literal">spec.pluginConfig</code> field varies depending on the application. All other fields persist across multiple instances of this custom resource. As examples:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
												<code class="literal">url</code>: Only changes when newer versions of the module are deployed.
											</li><li class="listitem">
												<code class="literal">phase</code>: Remains the same, since this module needs to be invoked after the proxy has done any local authorization, such as validating OpenID Connect (OIDC) tokens.
											</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
								After you have the module configuration in <code class="literal">spec.pluginConfig</code> and the rest of the custom resource, apply it with the <code class="literal">oc apply</code> command:
							</p><pre class="programlisting language-terminal">$ oc apply -f threescale-wasm-auth-bookinfo.yaml</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-extensions-migration-overview_ossm-extensions">Migrating from <code class="literal">ServiceMeshExtension</code> to <code class="literal">WasmPlugin</code> resources</a>
							</li><li class="listitem">
								<a class="link" href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources">Custom Resources</a>
							</li></ul></div></section></section><section class="section" id="ossm-threescale-applying-external-service-entry-objects_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h3 class="title">1.20.5. Applying 3scale external ServiceEntry objects</h3></div></div></div><p>
					To have the <code class="literal">threescale-wasm-auth</code> module authorize requests against 3scale, the module must have access to 3scale services. You can do this within Red Hat OpenShift Service Mesh by applying an external <code class="literal">ServiceEntry</code> object and a corresponding <code class="literal">DestinationRule</code> object for TLS configuration to use the HTTPS protocol.
				</p><p>
					The custom resources (CRs) set up the service entries and destination rules for secure access from within Service Mesh to 3scale Hosted (SaaS) for the backend and system components of the Service Management API and the Account Management API. The Service Management API receives queries for the authorization status of each request. The Account Management API provides API management configuration settings for your services.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Apply the following external <code class="literal">ServiceEntry</code> CR and related <code class="literal">DestinationRule</code> CR for 3scale Hosted <span class="strong strong"><strong>backend</strong></span> to your cluster:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Add the <code class="literal">ServiceEntry</code> CR to a file called <code class="literal">service-entry-threescale-saas-backend.yml</code>:
								</p><div class="formalpara"><p class="title"><strong>ServiceEntry CR</strong></p><p>
										
<pre class="programlisting language-terminal">apiVersion: networking.istio.io/v1beta1
kind: ServiceEntry
metadata:
  name: service-entry-threescale-saas-backend
spec:
  hosts:
  - su1.3scale.net
  ports:
  - number: 443
    name: https
    protocol: HTTPS
  location: MESH_EXTERNAL
  resolution: DNS</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Add the <code class="literal">DestinationRule</code> CR to a file called <code class="literal">destination-rule-threescale-saas-backend.yml</code>:
								</p><div class="formalpara"><p class="title"><strong>DestinationRule CR</strong></p><p>
										
<pre class="programlisting language-terminal">apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: destination-rule-threescale-saas-backend
spec:
  host: su1.3scale.net
  trafficPolicy:
    tls:
      mode: SIMPLE
      sni: su1.3scale.net</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Apply and save the external <code class="literal">ServiceEntry</code> CR for the 3scale Hosted backend to your cluster, by running the following command:
								</p><pre class="programlisting language-terminal">$ oc apply -f service-entry-threescale-saas-backend.yml</pre></li><li class="listitem"><p class="simpara">
									Apply and save the external <code class="literal">DestinationRule</code> CR for the 3scale Hosted backend to your cluster, by running the following command:
								</p><pre class="programlisting language-terminal">$ oc apply -f destination-rule-threescale-saas-backend.yml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Apply the following external <code class="literal">ServiceEntry</code> CR and related <code class="literal">DestinationRule</code> CR for 3scale Hosted <span class="strong strong"><strong>system</strong></span> to your cluster:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Add the <code class="literal">ServiceEntry</code> CR to a file called <code class="literal">service-entry-threescale-saas-system.yml</code>:
								</p><div class="formalpara"><p class="title"><strong>ServiceEntry CR</strong></p><p>
										
<pre class="programlisting language-terminal">apiVersion: networking.istio.io/v1beta1
kind: ServiceEntry
metadata:
  name: service-entry-threescale-saas-system
spec:
  hosts:
  - multitenant.3scale.net
  ports:
  - number: 443
    name: https
    protocol: HTTPS
  location: MESH_EXTERNAL
  resolution: DNS</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Add the <code class="literal">DestinationRule</code> CR to a file called <code class="literal">destination-rule-threescale-saas-system.yml</code>:
								</p><div class="formalpara"><p class="title"><strong>DestinationRule CR</strong></p><p>
										
<pre class="programlisting language-terminal">apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: destination-rule-threescale-saas-system
spec:
  host: multitenant.3scale.net
  trafficPolicy:
    tls:
      mode: SIMPLE
      sni: multitenant.3scale.net</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Apply and save the external <code class="literal">ServiceEntry</code> CR for the 3scale Hosted system to your cluster, by running the following command:
								</p><pre class="programlisting language-terminal">$ oc apply -f service-entry-threescale-saas-system.yml</pre></li><li class="listitem"><p class="simpara">
									Apply and save the external <code class="literal">DestinationRule</code> CR for the 3scale Hosted system to your cluster, by running the following command:
								</p><pre class="programlisting language-terminal">$ oc apply -f &lt;destination-rule-threescale-saas-system.yml&gt;</pre></li></ol></div></li></ol></div><p>
					Alternatively, you can deploy an in-mesh 3scale service. To deploy an in-mesh 3scale service, change the location of the services in the CR by deploying 3scale and linking to the deployment.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-routing-service-entries_traffic-management">Service entry and destination rule documentation</a>
						</li></ul></div></section><section class="section" id="ossm-threescale-webassembly-module-configuration_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h3 class="title">1.20.6. The 3scale WebAssembly module configuration</h3></div></div></div><p>
					The <code class="literal">WasmPlugin</code> custom resource spec provides the configuration that the <code class="literal">Proxy-WASM</code> module reads from.
				</p><p>
					The spec is embedded in the host and read by the <code class="literal">Proxy-WASM</code> module. Typically, the configurations are in the JSON file format for the modules to parse, however the <code class="literal">WasmPlugin</code> resource can interpret the spec value as YAML and convert it to JSON for consumption by the module.
				</p><p>
					If you use the <code class="literal">Proxy-WASM</code> module in stand-alone mode, you must write the configuration using the JSON format. Using the JSON format means using escaping and quoting where needed within the <code class="literal">host</code> configuration files, for example <code class="literal">Envoy</code>. When you use the WebAssembly module with the <code class="literal">WasmPlugin</code> resource, the configuration is in the YAML format. In this case, an invalid configuration forces the module to show diagnostics based on its JSON representation to a sidecar’s logging stream.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The <code class="literal">EnvoyFilter</code> custom resource is not a supported API, although it can be used in some 3scale Istio adapter or Service Mesh releases. Using the <code class="literal">EnvoyFilter</code> custom resource is not recommended. Use the <code class="literal">WasmPlugin</code> API instead of the <code class="literal">EnvoyFilter</code> custom resource. If you must use the <code class="literal">EnvoyFilter</code> custom resource, you must specify the spec in JSON format.
					</p></div></div><section class="section" id="threescale-configuring-the-threescale-webassembly-module_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.6.1. Configuring the 3scale WebAssembly module</h4></div></div></div><p>
						The architecture of the 3scale WebAssembly module configuration depends on the 3scale account and authorization service, and the list of services to handle.
					</p><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
							The prerequisites are a set of minimum mandatory fields in all cases:
						</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								For the 3scale account and authorization service: the <code class="literal">backend-listener</code> URL.
							</li><li class="listitem">
								For the list of services to handle: the service IDs and at least one credential look up method and where to find it.
							</li><li class="listitem">
								You will find examples for dealing with <code class="literal">userkey</code>, <code class="literal">appid</code> with <code class="literal">appkey</code>, and OpenID Connect (OIDC) patterns.
							</li><li class="listitem">
								The WebAssembly module uses the settings you specified in the static configuration. For example, if you add a mapping rule configuration to the module, it will always apply, even when the 3scale Admin Portal has no such mapping rule. The rest of the <code class="literal">WasmPlugin</code> resource exists around the <code class="literal">spec.pluginConfig</code> YAML entry.
							</li></ul></div></section><section class="section" id="ossm-threescale-webassembly-module-api-object_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.6.2. The 3scale WebAssembly module api object</h4></div></div></div><p>
						The <code class="literal">api</code> top-level string from the 3scale WebAssembly module defines which version of the configuration the module will use.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							A non-existent or unsupported version of the <code class="literal">api</code> object renders the 3scale WebAssembly module inoperable.
						</p></div></div><div class="formalpara"><p class="title"><strong>The <code class="literal">api</code> top-level string example</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: extensions.istio.io/v1alpha1
kind: WasmPlugin
metadata:
  name: &lt;threescale_wasm_plugin_name&gt;
  namespace: &lt;bookinfo&gt;
spec:
  pluginConfig:
    api: v1
...</pre>

						</p></div><p>
						The <code class="literal">api</code> entry defines the rest of the values for the configuration. The only accepted value is <code class="literal">v1</code>. New settings that break compatibility with the current configuration or need more logic that modules using <code class="literal">v1</code> cannot handle, will require different values.
					</p></section><section class="section" id="ossm-threescale-webassembly-module-system-object_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.6.3. The 3scale WebAssembly module system object</h4></div></div></div><p>
						The <code class="literal">system</code> top-level object specifies how to access the 3scale Account Management API for a specific account. The <code class="literal">upstream</code> field is the most important part of the object. The <code class="literal">system</code> object is optional, but recommended unless you are providing a fully static configuration for the 3scale WebAssembly module, which is an option if you do not want to provide connectivity to the <span class="emphasis"><em>system</em></span> component of 3scale.
					</p><p>
						When you provide static configuration objects in addition to the <code class="literal">system</code> object, the static ones always take precedence.
					</p><pre class="programlisting language-yaml">apiVersion: extensions.istio.io/v1alpha1
kind: WasmPlugin
metadata:
  name: &lt;threescale_wasm_plugin_name&gt;
spec:
  pluginConfig:
    system:
      name: &lt;saas_porta&gt;
      upstream: &lt;object&gt;
      token: &lt;my_account_token&gt;
      ttl: 300
  ...</pre><div class="table" id="idm140663661036528"><p class="title"><strong>Table 1.22. <code class="literal">system</code> object fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663661030448" scope="col">Name</th><th align="left" valign="top" id="idm140663661029360" scope="col">Description</th><th align="left" valign="top" id="idm140663661028272" scope="col">Required</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663661030448"> <p>
										<code class="literal">name</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661029360"> <p>
										An identifier for the 3scale service, currently not referenced elsewhere.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661028272"> <p>
										Optional
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661030448"> <p>
										<code class="literal">upstream</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661029360"> <p>
										The details about a network host to be contacted. <code class="literal">upstream</code> refers to the 3scale Account Management API host known as system.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661028272"> <p>
										Yes
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661030448"> <p>
										<code class="literal">token</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661029360"> <p>
										A 3scale personal access token with read permissions.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661028272"> <p>
										Yes
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661030448"> <p>
										<code class="literal">ttl</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661029360"> <p>
										The minimum amount of seconds to consider a configuration retrieved from this host as valid before trying to fetch new changes. The default is 600 seconds (10 minutes). <span class="strong strong"><strong>Note:</strong></span> there is no maximum amount, but the module will generally fetch any configuration within a reasonable amount of time after this TTL elapses.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661028272"> <p>
										Optional
									</p>
									 </td></tr></tbody></table></div></div></section><section class="section" id="ossm-threescale-webassembly-module-upstream-object_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.6.4. The 3scale WebAssembly module upstream object</h4></div></div></div><p>
						The <code class="literal">upstream</code> object describes an external host to which the proxy can perform calls.
					</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v1
upstream:
  name: outbound|443||multitenant.3scale.net
  url: "https://myaccount-admin.3scale.net/"
  timeout: 5000
...</pre><div class="table" id="idm140663661154656"><p class="title"><strong>Table 1.23. <code class="literal">upstream</code> object fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663650253200" scope="col">Name</th><th align="left" valign="top" id="idm140663650252112" scope="col">Description</th><th align="left" valign="top" id="idm140663650251024" scope="col">Required</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663650253200"> <p>
										<code class="literal">name</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663650252112"> <p>
										<code class="literal">name</code> is not a free-form identifier. It is the identifier for the external host as defined by the proxy configuration. In the case of stand-alone <code class="literal">Envoy</code> configurations, it maps to the name of a <a class="link" href="https://www.envoyproxy.io/docs/envoy/v1.19.0/api-v3/config/cluster/v3/cluster.proto#config-cluster-v3-cluster">Cluster</a>, also known as <code class="literal">upstream</code> in other proxies. <span class="strong strong"><strong>Note:</strong></span> the value of this field, because the Service Mesh and 3scale Istio adapter control plane configure the name according to a format using a vertical bar (|) as the separator of multiple fields. For the purposes of this integration, always use the format: <code class="literal">outbound|&lt;port&gt;||&lt;hostname&gt;</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm140663650251024"> <p>
										Yes
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663650253200"> <p>
										<code class="literal">url</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663650252112"> <p>
										The complete URL to access the described service. Unless implied by the scheme, you must include the TCP port.
									</p>
									 </td><td align="left" valign="top" headers="idm140663650251024"> <p>
										Yes
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663650253200"> <p>
										<code class="literal">Timeout</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663650252112"> <p>
										Timeout in milliseconds so that connections to this service that take more than the amount of time to respond will be considered errors. Default is 1000 seconds.
									</p>
									 </td><td align="left" valign="top" headers="idm140663650251024"> <p>
										Optional
									</p>
									 </td></tr></tbody></table></div></div></section><section class="section" id="ossm-threescale-webassembly-module-backend-object_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.6.5. The 3scale WebAssembly module backend object</h4></div></div></div><p>
						The <code class="literal">backend</code> top-level object specifies how to access the 3scale Service Management API for authorizing and reporting HTTP requests. This service is provided by the <span class="emphasis"><em>Backend</em></span> component of 3scale.
					</p><pre class="programlisting language-yaml">apiVersion: extensions.istio.io/v1alpha1
kind: WasmPlugin
metadata:
  name: &lt;threescale_wasm_plugin_name&gt;
spec:
  pluginConfig:
    ...
    backend:
      name: backend
      upstream: &lt;object&gt;
    ...</pre><div class="table" id="idm140663648249024"><p class="title"><strong>Table 1.24. <code class="literal">backend</code> object fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663648242944" scope="col">Name</th><th align="left" valign="top" id="idm140663648241856" scope="col">Description</th><th align="left" valign="top" id="idm140663648240768" scope="col">Required</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663648242944"> <p>
										<code class="literal">name</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648241856"> <p>
										An identifier for the 3scale backend, currently not referenced elsewhere.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648240768"> <p>
										Optional
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648242944"> <p>
										<code class="literal">upstream</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648241856"> <p>
										The details about a network host to be contacted. This must refer to the 3scale Account Management API host, known, system.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648240768"> <p>
										Yes. The most important and required field.
									</p>
									 </td></tr></tbody></table></div></div></section><section class="section" id="ossm-threescale-webassembly-module-services-object_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.6.6. The 3scale WebAssembly module services object</h4></div></div></div><p>
						The <code class="literal">services</code> top-level object specifies which service identifiers are handled by this particular instance of the <code class="literal">module</code>.
					</p><p>
						Since accounts have multiple services, you must specify which ones are handled. The rest of the configuration revolves around how to configure services.
					</p><p>
						The <code class="literal">services</code> field is required. It is an array that must contain at least one service to be useful.
					</p><pre class="programlisting language-yaml">apiVersion: extensions.istio.io/v1alpha1
kind: WasmPlugin
metadata:
  name: &lt;threescale_wasm_plugin_name&gt;
spec:
  pluginConfig:
    ...
    services:
    - id: "2555417834789"
      token: service_token
      authorities:
        - "*.app"
        - 0.0.0.0
        - "0.0.0.0:8443"
      credentials: &lt;object&gt;
      mapping_rules: &lt;object&gt;
    ...</pre><p>
						Each element in the <code class="literal">services</code> array represents a 3scale service.
					</p><div class="table" id="idm140663647453136"><p class="title"><strong>Table 1.25. <code class="literal">services</code> object fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663647447056" scope="col">Name</th><th align="left" valign="top" id="idm140663647445968" scope="col">Description</th><th align="left" valign="top" id="idm140663647444880" scope="col">Required</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663647447056"> <p>
										<code class="literal">ID</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663647445968"> <p>
										An identifier for this 3scale service, currently not referenced elsewhere.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647444880"> <p>
										Yes
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663647447056"> <p>
										<code class="literal">token</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663647445968"> <p>
										This <code class="literal">token</code> can be found in the proxy configuration for your service in System or you can retrieve the it from System with following <code class="literal">curl</code> command:
									</p>
									 <p>
										<code class="literal">curl https://&lt;system_host&gt;/admin/api/services/&lt;service_id&gt;/proxy/configs/production/latest.json?access_token=&lt;access_token&gt;" | jq '.proxy_config.content.backend_authentication_value</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663647444880"> <p>
										Optional
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663647447056"> <p>
										<code class="literal">authorities</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663647445968"> <p>
										An array of strings, each one representing the <span class="emphasis"><em>Authority</em></span> of a <span class="emphasis"><em>URL</em></span> to match. These strings accept glob patterns supporting the asterisk (<span class="emphasis"><em>*</em></span>), plus sign (<span class="emphasis"><em>+</em></span>), and question mark (<span class="emphasis"><em>?</em></span>) matchers.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647444880"> <p>
										Yes
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663647447056"> <p>
										<code class="literal">credentials</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663647445968"> <p>
										An object defining which kind of credentials to look for and where.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647444880"> <p>
										Yes
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663647447056"> <p>
										<code class="literal">mapping_rules</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663647445968"> <p>
										An array of objects representing mapping rules and 3scale methods to hit.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647444880"> <p>
										Optional
									</p>
									 </td></tr></tbody></table></div></div></section><section class="section" id="ossm-threescale-webassembly-module-credentials-object_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.6.7. The 3scale WebAssembly module credentials object</h4></div></div></div><p>
						The <code class="literal">credentials</code> object is a component of the <code class="literal">service</code> object. <code class="literal">credentials</code> specifies which kind of credentials to be looked up and the steps to perform this action.
					</p><p>
						All fields are optional, but you must specify at least one, <code class="literal">user_key</code> or <code class="literal">app_id</code>. The order in which you specify each credential is irrelevant because it is pre-established by the module. Only specify one instance of each credential.
					</p><pre class="programlisting language-yaml">apiVersion: extensions.istio.io/v1alpha1
kind: WasmPlugin
metadata:
  name: &lt;threescale_wasm_plugin_name&gt;
spec:
  pluginConfig:
    ...
    services:
    - credentials:
        user_key: &lt;array_of_lookup_queries&gt;
        app_id: &lt;array_of_lookup_queries&gt;
        app_key: &lt;array_of_lookup_queries&gt;
    ...</pre><div class="table" id="idm140663647559936"><p class="title"><strong>Table 1.26. <code class="literal">credentials</code> object fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663647553856" scope="col">Name</th><th align="left" valign="top" id="idm140663647552768" scope="col">Description</th><th align="left" valign="top" id="idm140663647551680" scope="col">Required</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663647553856"> <p>
										<code class="literal">user_key</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663647552768"> <p>
										This is an array of lookup queries that defines a 3scale user key. A user key is commonly known as an API key.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647551680"> <p>
										Optional
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663647553856"> <p>
										<code class="literal">app_id</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663647552768"> <p>
										This is an array of lookup queries that define a 3scale application identifier. Application identifiers are provided by 3scale or by using an identity provider like <a class="link" href="https://access.redhat.com/products/red-hat-single-sign-on">Red Hat Single Sign-On (RH-SS0)</a>, or OpenID Connect (OIDC). The resolution of the lookup queries specified here, whenever it is successful and resolves to two values, it sets up the <code class="literal">app_id</code> and the <code class="literal">app_key</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647551680"> <p>
										Optional
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663647553856"> <p>
										<code class="literal">app_key</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663647552768"> <p>
										This is an array of lookup queries that define a 3scale application key. Application keys without a resolved <code class="literal">app_id</code> are useless, so only specify this field when <code class="literal">app_id</code> has been specified.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647551680"> <p>
										Optional
									</p>
									 </td></tr></tbody></table></div></div></section><section class="section" id="ossm-threescale-webassembly-module-lookup-queries_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.6.8. The 3scale WebAssembly module lookup queries</h4></div></div></div><p>
						The <code class="literal">lookup query</code> object is part of any of the fields in the <code class="literal">credentials</code> object. It specifies how a given credential field should be found and processed. When evaluated, a successful resolution means that one or more values were found. A failed resolution means that no values were found.
					</p><p>
						Arrays of <code class="literal">lookup queries</code> describe a short-circuit or relationship: a successful resolution of one of the queries stops the evaluation of any remaining queries and assigns the value or values to the specified credential-type. Each query in the array is independent of each other.
					</p><p>
						A <code class="literal">lookup query</code> is made up of a single field, a source object, which can be one of a number of source types. See the following example:
					</p><pre class="programlisting language-yaml">apiVersion: extensions.istio.io/v1alpha1
kind: WasmPlugin
metadata:
  name: &lt;threescale_wasm_plugin_name&gt;
spec:
  pluginConfig:
    ...
    services:
    - credentials:
        user_key:
          - &lt;source_type&gt;: &lt;object&gt;
          - &lt;source_type&gt;: &lt;object&gt;
          ...
        app_id:
          - &lt;source_type&gt;: &lt;object&gt;
          ...
        app_key:
          - &lt;source_type&gt;: &lt;object&gt;
          ...
    ...</pre></section><section class="section" id="ossm-threescale-webassembly-module-source-object_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.6.9. The 3scale WebAssembly module source object</h4></div></div></div><p>
						A <code class="literal">source</code> object exists as part of an array of sources within any of the <code class="literal">credentials</code> object fields. The object field name, referred to as a <code class="literal">source</code>-type is any one of the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">header</code>: The lookup query receives HTTP request headers as input.
							</li><li class="listitem">
								<code class="literal">query_string</code>: The <code class="literal">lookup query</code> receives the URL query string parameters as input.
							</li><li class="listitem">
								<code class="literal">filter</code>: The <code class="literal">lookup query</code> receives filter metadata as input.
							</li></ul></div><p>
						All <code class="literal">source</code>-type objects have at least the following two fields:
					</p><div class="table" id="idm140663648151072"><p class="title"><strong>Table 1.27. <code class="literal">source</code>-type object fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663648144992" scope="col">Name</th><th align="left" valign="top" id="idm140663648143904" scope="col">Description</th><th align="left" valign="top" id="idm140663648142816" scope="col">Required</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663648144992"> <p>
										<code class="literal">keys</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648143904"> <p>
										An array of strings, each one a <code class="literal">key</code>, referring to entries found in the input data.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648142816"> <p>
										Yes
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648144992"> <p>
										<code class="literal">ops</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648143904"> <p>
										An array of <code class="literal">operations</code> that perform a <code class="literal">key</code> entry match. The array is a pipeline where operations receive inputs and generate outputs on the next operation. An <code class="literal">operation</code> failing to provide an output resolves the <code class="literal">lookup query</code> as failed. The pipeline order of the operations determines the evaluation order.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648142816"> <p>
										Optional
									</p>
									 </td></tr></tbody></table></div></div><p>
						The <code class="literal">filter</code> field name has a required <code class="literal">path</code> entry to show the path in the metadata you use to look up data.
					</p><p>
						When a <code class="literal">key</code> matches the input data, the rest of the keys are not evaluated and the source resolution algorithm jumps to executing the <code class="literal">operations</code> (<code class="literal">ops</code>) specified, if any. If no <code class="literal">ops</code> are specified, the result value of the matching <code class="literal">key</code>, if any, is returned.
					</p><p>
						<code class="literal">Operations</code> provide a way to specify certain conditions and transformations for inputs you have after the first phase looks up a <code class="literal">key</code>. Use <code class="literal">operations</code> when you need to transform, decode, and assert properties, however they do not provide a mature language to deal with all needs and lack <span class="emphasis"><em>Turing-completeness</em></span>.
					</p><p>
						A stack stored the outputs of <code class="literal">operations</code>. When evaluated, the <code class="literal">lookup query</code> finishes by assigning the value or values at the bottom of the stack, depending on how many values the credential consumes.
					</p></section><section class="section" id="ossm-threescale-webassembly-module-operations-object_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.6.10. The 3scale WebAssembly module operations object</h4></div></div></div><p>
						Each element in the <code class="literal">ops</code> array belonging to a specific <code class="literal">source type</code> is an <code class="literal">operation</code> object that either applies transformations to values or performs tests. The field name to use for such an object is the name of the <code class="literal">operation</code> itself, and any values are the parameters to the <code class="literal">operation</code>, which could be structure objects, for example, maps with fields and values, lists, or strings.
					</p><p>
						Most <code class="literal">operations</code> attend to one or more inputs, and produce one or more outputs. When they consume inputs or produce outputs, they work with a stack of values: each value consumed by the operations is popped from the stack of values and initially populated with any <code class="literal">source</code> matches. The values outputted by them are pushed to the stack. Other <code class="literal">operations</code> do not consume or produce outputs other than asserting certain properties, but they inspect a stack of values.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When resolution finishes, the values picked up by the next step, such as assigning the values to be an <code class="literal">app_id</code>, <code class="literal">app_key</code>, or <code class="literal">user_key</code>, are taken from the bottom values of the stack.
						</p></div></div><p>
						There are a few different <code class="literal">operations</code> categories:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">decode</code>: These transform an input value by decoding it to get a different format.
							</li><li class="listitem">
								<code class="literal">string</code>: These take a string value as input and perform transformations and checks on it.
							</li><li class="listitem">
								<code class="literal">stack</code>: These take a set of values in the input and perform multiple stack transformations and selection of specific positions in the stack.
							</li><li class="listitem">
								<code class="literal">check</code>: These assert properties about sets of operations in a side-effect free way.
							</li><li class="listitem">
								<code class="literal">control</code>: These perform operations that allow for modifying the evaluation flow.
							</li><li class="listitem">
								<code class="literal">format</code>: These parse the format-specific structure of input values and look up values in it.
							</li></ul></div><p>
						All operations are specified by the name identifiers as strings.
					</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								Available <a class="link" href="https://github.com/3scale/threescale-wasm-auth/blob/main/docs/operations.md">operations</a>
							</li></ul></div></section><section class="section" id="ossm-threescale-webassembly-module-mapping-rules-object_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.6.11. The 3scale WebAssembly module mapping_rules object</h4></div></div></div><p>
						The <code class="literal">mapping_rules</code> object is part of the <code class="literal">service</code> object. It specifies a set of REST path patterns and related 3scale metrics and count increments to use when the patterns match.
					</p><p>
						You need the value if no dynamic configuration is provided in the <code class="literal">system</code> top-level object. If the object is provided in addition to the <code class="literal">system</code> top-level entry, then the <code class="literal">mapping_rules</code> object is evaluated first.
					</p><p>
						<code class="literal">mapping_rules</code> is an array object. Each element of that array is a <code class="literal">mapping_rule</code> object. The evaluated matching mapping rules on an incoming request provide the set of 3scale <code class="literal">methods</code> for authorization and reporting to the <span class="emphasis"><em>APIManager</em></span>. When multiple matching rules refer to the same <code class="literal">methods</code>, there is a summation of <code class="literal">deltas</code> when calling into 3scale. For example, if two rules increase the <span class="emphasis"><em>Hits</em></span> method twice with <code class="literal">deltas</code> of 1 and 3, a single method entry for Hits reporting to 3scale has a <code class="literal">delta</code> of 4.
					</p></section><section class="section" id="ossm-threescale-webassembly-module-mapping-rule-object_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.6.12. The 3scale WebAssembly module mapping_rule object</h4></div></div></div><p>
						The <code class="literal">mapping_rule</code> object is part of an array in the <code class="literal">mapping_rules</code> object.
					</p><p>
						The <code class="literal">mapping_rule</code> object fields specify the following information:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The <span class="emphasis"><em>HTTP request method</em></span> to match.
							</li><li class="listitem">
								A pattern to match the path against.
							</li><li class="listitem">
								The 3scale methods to report along with the amount to report. The order in which you specify the fields determines the evaluation order.
							</li></ul></div><div class="table" id="idm140663651167616"><p class="title"><strong>Table 1.28. <code class="literal">mapping_rule</code> object fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663651161648" scope="col">Name</th><th align="left" valign="top" id="idm140663651160560" scope="col">Description</th><th align="left" valign="top" id="idm140663651159472" scope="col">Required</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663651161648"> <p>
										<code class="literal">method</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663651160560"> <p>
										Specifies a string representing an HTTP request method, also known as verb. Values accepted match the any one of the accepted HTTP method names, case-insensitive. A special value of any matches any method.
									</p>
									 </td><td align="left" valign="top" headers="idm140663651159472"> <p>
										Yes
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663651161648"> <p>
										<code class="literal">pattern</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663651160560"> <p>
										The pattern to match the HTTP request’s URI path component. This pattern follows the same syntax as documented by 3scale. It allows wildcards (use of the asterisk (*) character) using any sequence of characters between braces such as <code class="literal">{this}</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm140663651159472"> <p>
										Yes
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663651161648"> <p>
										<code class="literal">usages</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663651160560"> <p>
										A list of <code class="literal">usage</code> objects. When the rule matches, all methods with their <code class="literal">deltas</code> are added to the list of methods sent to 3scale for authorization and reporting.
									</p>
									 <p>
										Embed the <code class="literal">usages</code> object with the following required fields:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">name</code>: The <code class="literal">method</code> system name to report.
											</li><li class="listitem">
												<code class="literal">delta</code>: For how much to increase that <code class="literal">method</code> by.
											</li></ul></div>
									 </td><td align="left" valign="top" headers="idm140663651159472"> <p>
										Yes
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663651161648"> <p>
										<code class="literal">last</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663651160560"> <p>
										Whether the successful matching of this rule should stop the evaluation of more mapping rules.
									</p>
									 </td><td align="left" valign="top" headers="idm140663651159472"> <p>
										Optional Boolean. The default is <code class="literal">false</code>
									</p>
									 </td></tr></tbody></table></div></div><p>
						The following example is independent of existing hierarchies between methods in 3scale. That is, anything run on the 3scale side will not affect this. For example, the <span class="emphasis"><em>Hits</em></span> metric might be a parent of them all, so it stores 4 hits due to the sum of all reported methods in the authorized request and calls the 3scale <code class="literal">Authrep</code> API endpoint.
					</p><p>
						The example below uses a <code class="literal">GET</code> request to a path, <code class="literal">/products/1/sold</code>, that matches all the rules.
					</p><div class="formalpara"><p class="title"><strong><code class="literal">mapping_rules</code> <code class="literal">GET</code> request example</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: extensions.istio.io/v1alpha1
kind: WasmPlugin
metadata:
  name: &lt;threescale_wasm_plugin_name&gt;
spec:
  pluginConfig:
    ...
    mapping_rules:
      - method: GET
        pattern: /
        usages:
          - name: hits
            delta: 1
      - method: GET
        pattern: /products/
        usages:
          - name: products
            delta: 1
      - method: ANY
        pattern: /products/{id}/sold
        usages:
          - name: sales
            delta: 1
          - name: products
            delta: 1
    ...</pre>

						</p></div><p>
						All <code class="literal">usages</code> get added to the request the module performs to 3scale with usage data as follows:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Hits: 1
							</li><li class="listitem">
								products: 2
							</li><li class="listitem">
								sales: 1
							</li></ul></div></section></section><section class="section" id="ossm-threescale-webassembly-module-examples-for-credentials-use-cases_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h3 class="title">1.20.7. The 3scale WebAssembly module examples for credentials use cases</h3></div></div></div><p>
					You will spend most of your time applying configuration steps to obtain credentials in the requests to your services.
				</p><p>
					The following are <code class="literal">credentials</code> examples, which you can modify to adapt to specific use cases.
				</p><p>
					You can combine them all, although when you specify multiple source objects with their own <code class="literal">lookup queries</code>, they are evaluated in order until one of them successfully resolves.
				</p><section class="section" id="api-key-in-query-string-parameters_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.7.1. API key (user_key) in query string parameters</h4></div></div></div><p>
						The following example looks up a <code class="literal">user_key</code> in a query string parameter or header of the same name:
					</p><pre class="programlisting language-yaml">credentials:
  user_key:
    - query_string:
        keys:
          - user_key
    - header:
        keys:
          - user_key</pre></section><section class="section" id="application-id-and-key_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.7.2. Application ID and key</h4></div></div></div><p>
						The following example looks up <code class="literal">app_key</code> and <code class="literal">app_id</code> credentials in a query or headers.
					</p><pre class="programlisting language-yaml">credentials:
  app_id:
    - header:
        keys:
          - app_id
    - query_string:
        keys:
          - app_id
  app_key:
    - header:
        keys:
          - app_key
    - query_string:
        keys:
          - app_key</pre></section><section class="section" id="authorization-header_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.7.3. Authorization header</h4></div></div></div><p>
						A request includes an <code class="literal">app_id</code> and <code class="literal">app_key</code> in an <code class="literal">authorization</code> header. If there is at least one or two values outputted at the end, then you can assign the <code class="literal">app_key</code>.
					</p><p>
						The resolution here assigns the <code class="literal">app_key</code> if there is one or two outputted at the end.
					</p><p>
						The <code class="literal">authorization</code> header specifies a value with the type of authorization and its value is encoded as <code class="literal">Base64</code>. This means you can split the value by a space character, take the second output and then split it again using a colon (:) as the separator. For example, if you use this format <code class="literal">app_id:app_key</code>, the header looks like the following example for <code class="literal">credential</code>:
					</p><pre class="screen">aladdin:opensesame:  Authorization: Basic YWxhZGRpbjpvcGVuc2VzYW1l</pre><p>
						You must use lower case header field names as shown in the following example:
					</p><pre class="programlisting language-yaml">credentials:
  app_id:
    - header:
        keys:
          - authorization
        ops:
          - split:
              separator: " "
              max: 2
          - length:
              min: 2
          - drop:
              head: 1
          - base64_urlsafe
          - split:
              max: 2
  app_key:
    - header:
        keys:
          - app_key</pre><p>
						The previous example use case looks at the headers for an <code class="literal">authorization</code>:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								It takes its string value and split it by a space, checking that it generates at least two values of a <code class="literal">credential</code>-type and the <code class="literal">credential</code> itself, then dropping the <code class="literal">credential</code>-type.
							</li><li class="listitem"><p class="simpara">
								It then decodes the second value containing the data it needs, and splits it by using a colon (:) character to have an operations stack including first the <code class="literal">app_id</code>, then the <code class="literal">app_key</code>, if it exists.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										If <code class="literal">app_key</code> does not exist in the authorization header then its specific sources are checked, for example, the header with the key <code class="literal">app_key</code> in this case.
									</li></ol></div></li><li class="listitem">
								To add extra conditions to <code class="literal">credentials</code>, allow <code class="literal">Basic</code> authorizations, where <code class="literal">app_id</code> is either <code class="literal">aladdin</code> or <code class="literal">admin</code>, or any <code class="literal">app_id</code> being at least 8 characters in length.
							</li><li class="listitem"><p class="simpara">
								<code class="literal">app_key</code> must contain a value and have a minimum of 64 characters as shown in the following example:
							</p><pre class="programlisting language-yaml">credentials:
  app_id:
    - header:
        keys:
          - authorization
        ops:
          - split:
              separator: " "
              max: 2
          - length:
              min: 2
          - reverse
          - glob:
            - Basic
          - drop:
              tail: 1
          - base64_urlsafe
          - split:
              max: 2
          - test:
              if:
                length:
                  min: 2
              then:
                - strlen:
                    max: 63
                - or:
                    - strlen:
                        min: 1
                    - drop:
                        tail: 1
          - assert:
            - and:
              - reverse
              - or:
                - strlen:
                    min: 8
                - glob:
                  - aladdin
                  - admin</pre></li><li class="listitem">
								After picking up the <code class="literal">authorization</code> header value, you get a <code class="literal">Basic</code> <code class="literal">credential</code>-type by reversing the stack so that the type is placed on top.
							</li><li class="listitem">
								Run a glob match on it. When it validates, and the credential is decoded and split, you get the <code class="literal">app_id</code> at the bottom of the stack, and potentially the <code class="literal">app_key</code> at the top.
							</li><li class="listitem"><p class="simpara">
								Run a <code class="literal">test:</code> if there are two values in the stack, meaning an <code class="literal">app_key</code> was acquired.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Ensure the string length is between 1 and 63, including <code class="literal">app_id</code> and <code class="literal">app_key</code>. If the key’s length is zero, drop it and continue as if no key exists. If there was only an <code class="literal">app_id</code> and no <code class="literal">app_key</code>, the missing else branch indicates a successful test and evaluation continues.
									</li></ol></div></li></ol></div><p>
						The last operation, <code class="literal">assert</code>, indicates that no side-effects make it into the stack. You can then modify the stack:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Reverse the stack to have the <code class="literal">app_id</code> at the top.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Whether or not an <code class="literal">app_key</code> is present, reversing the stack ensures <code class="literal">app_id</code> is at the top.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Use <code class="literal">and</code> to preserve the contents of the stack across tests.
							</p><p class="simpara">
								Then use one of the following possibilities:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Make sure <code class="literal">app_id</code> has a string length of at least 8.
									</li><li class="listitem">
										Make sure <code class="literal">app_id</code> matches either <code class="literal">aladdin</code> or <code class="literal">admin</code>.
									</li></ul></div></li></ol></div></section><section class="section" id="openid-connect-use-case_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.7.4. OpenID Connect (OIDC) use case</h4></div></div></div><p>
						For Service Mesh and the 3scale Istio adapter, you must deploy a <code class="literal">RequestAuthentication</code> as shown in the following example, filling in your own workload data and <code class="literal">jwtRules</code>:
					</p><pre class="programlisting language-yaml">apiVersion: security.istio.io/v1beta1
kind: RequestAuthentication
metadata:
  name: jwt-example
  namespace: bookinfo
spec:
  selector:
    matchLabels:
      app: productpage
  jwtRules:
  - issuer: &gt;-
      http://keycloak-keycloak.34.242.107.254.nip.io/auth/realms/3scale-keycloak
    jwksUri: &gt;-
      http://keycloak-keycloak.34.242.107.254.nip.io/auth/realms/3scale-keycloak/protocol/openid-connect/certs</pre><p>
						When you apply the <code class="literal">RequestAuthentication</code>, it configures <code class="literal">Envoy</code> with a <a class="link" href="https://www.envoyproxy.io/docs/envoy/v1.19.0/api-v3/extensions/filters/http/jwt_authn/v3/config.proto.html">native plugin</a> to validate <code class="literal">JWT</code> tokens. The proxy validates everything before running the module so any requests that fail do not make it to the 3scale WebAssembly module.
					</p><p>
						When a <code class="literal">JWT</code> token is validated, the proxy stores its contents in an internal metadata object, with an entry whose key depends on the specific configuration of the plugin. This use case gives you the ability to look up structure objects with a single entry containing an unknown key name.
					</p><p>
						The 3scale <code class="literal">app_id</code> for OIDC matches the OAuth <code class="literal">client_id</code>. This is found in the <code class="literal">azp</code> or <code class="literal">aud</code> fields of <code class="literal">JWT</code> tokens.
					</p><p>
						To get <code class="literal">app_id</code> field from Envoy’s native <code class="literal">JWT</code> authentication filter, see the following example:
					</p><pre class="programlisting language-yaml">credentials:
  app_id:
    - filter:
        path:
          - envoy.filters.http.jwt_authn
          - "0"
        keys:
          - azp
          - aud
        ops:
          - take:
              head: 1</pre><p>
						The example instructs the module to use the <code class="literal">filter</code> source type to look up filter metadata for an object from the <code class="literal">Envoy</code>-specific <code class="literal">JWT</code> authentication native plugin. This plugin includes the <code class="literal">JWT</code> token as part of a structure object with a single entry and a pre-configured name. Use <code class="literal">0</code> to specify that you will only access the single entry.
					</p><p>
						The resulting value is a structure for which you will resolve two fields:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">azp</code>: The value where <code class="literal">app_id</code> is found.
							</li><li class="listitem">
								<code class="literal">aud</code>: The value where this information can also be found.
							</li></ul></div><p>
						The operation ensures only one value is held for assignment.
					</p></section><section class="section" id="picking-up-the-jwt-token-from-a-header_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h4 class="title">1.20.7.5. Picking up the JWT token from a header</h4></div></div></div><p>
						Some setups might have validation processes for <code class="literal">JWT</code> tokens where the validated token would reach this module via a header in JSON format.
					</p><p>
						To get the <code class="literal">app_id</code>, see the following example:
					</p><pre class="programlisting language-yaml">credentials:
  app_id:
    - header:
        keys:
          - x-jwt-payload
        ops:
          - base64_urlsafe
          - json:
            - keys:
              - azp
              - aud
          - take:
              head: 1</pre></section></section><section class="section" id="ossm-threescale-webassembly-module-minimal-working-configuration_ossm-threescale-webassembly-module"><div class="titlepage"><div><div><h3 class="title">1.20.8. 3scale WebAssembly module minimal working configuration</h3></div></div></div><p>
					The following is an example of a 3scale WebAssembly module minimal working configuration. You can copy and paste this and edit it to work with your own configuration.
				</p><pre class="programlisting language-yaml">apiVersion: extensions.istio.io/v1alpha1
kind: WasmPlugin
metadata:
  name: &lt;threescale_wasm_plugin_name&gt;
spec:
  url: oci://registry.redhat.io/3scale-amp2/3scale-auth-wasm-rhel8:0.0.3
  imagePullSecret: &lt;optional_pull_secret_resource&gt;
  phase: AUTHZ
  priority: 100
  selector:
    labels:
      app: &lt;product_page&gt;
  pluginConfig:
    api: v1
    system:
      name: &lt;system_name&gt;
      upstream:
        name: outbound|443||multitenant.3scale.net
        url: https://istiodevel-admin.3scale.net/
        timeout: 5000
      token: &lt;token&gt;
    backend:
      name: &lt;backend_name&gt;
      upstream:
        name: outbound|443||su1.3scale.net
        url: https://su1.3scale.net/
        timeout: 5000
      extensions:
      - no_body
    services:
    - id: '2555417834780'
      authorities:
      - "*"
      credentials:
        user_key:
          - query_string:
              keys:
                - &lt;user_key&gt;
          - header:
              keys:
                - &lt;user_key&gt;
        app_id:
          - query_string:
              keys:
                - &lt;app_id&gt;
          - header:
              keys:
                - &lt;app_id&gt;
        app_key:
          - query_string:
              keys:
                - &lt;app_key&gt;
          - header:
              keys:
                - &lt;app_key&gt;</pre></section></section><section class="section" id="threescale-adapter"><div class="titlepage"><div><div><h2 class="title">1.21. Using the 3scale Istio adapter</h2></div></div></div><p>
				The 3scale Istio Adapter is an optional adapter that allows you to label a service running within the Red Hat OpenShift Service Mesh and integrate that service with the 3scale API Management solution. It is not required for Red Hat OpenShift Service Mesh.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					You can only use the 3scale Istio adapter with Red Hat OpenShift Service Mesh versions 2.0 and below. The Mixer component was deprecated in release 2.0 and removed in release 2.1. For Red Hat OpenShift Service Mesh versions 2.1.0 and later you should use the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#3scale-webassembly-for-2.1">3scale WebAssembly module</a>.
				</p><p>
					If you want to enable 3scale backend cache with the 3scale Istio adapter, you must also enable Mixer policy and Mixer telemetry. See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-create-smcp">Deploying the Red Hat OpenShift Service Mesh control plane</a>.
				</p></div></div><section class="section" id="ossm-threescale-integrate_threescale-adapter"><div class="titlepage"><div><div><h3 class="title">1.21.1. Integrate the 3scale adapter with Red Hat OpenShift Service Mesh</h3></div></div></div><p>
					You can use these examples to configure requests to your services using the 3scale Istio Adapter.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites:</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Red Hat OpenShift Service Mesh version 2.x
						</li><li class="listitem">
							A working 3scale account (<a class="link" href="https://www.3scale.net/signup/">SaaS</a> or <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_3scale_api_management/2.9/html/installing_3scale/install-threescale-on-openshift-guide">3scale 2.9 On-Premises</a>)
						</li><li class="listitem">
							Enabling backend cache requires 3scale 2.9 or greater
						</li><li class="listitem">
							Red Hat OpenShift Service Mesh prerequisites
						</li><li class="listitem">
							Ensure Mixer policy enforcement is enabled. Update Mixer policy enforcement section provides instructions to check the current Mixer policy enforcement status and enable policy enforcement.
						</li><li class="listitem"><p class="simpara">
							Mixer policy and telemetry must be enabled if you are using a mixer plugin.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									You will need to properly configure the Service Mesh Control Plane (SMCP) when upgrading.
								</li></ul></div></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						To configure the 3scale Istio Adapter, refer to Red Hat OpenShift Service Mesh custom resources for instructions on adding adapter parameters to the custom resource file.
					</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Pay particular attention to the <code class="literal">kind: handler</code> resource. You must update this with your 3scale account credentials. You can optionally add a <code class="literal">service_id</code> to a handler, but this is kept for backwards compatibility only, since it would render the handler only useful for one service in your 3scale account. If you add <code class="literal">service_id</code> to a handler, enabling 3scale for other services requires you to create more handlers with different <code class="literal">service_ids</code>.
					</p></div></div><p>
					Use a single handler per 3scale account by following the steps below:
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a handler for your 3scale account and specify your account credentials. Omit any service identifier.
						</p><pre class="programlisting language-yaml">  apiVersion: "config.istio.io/v1alpha2"
  kind: handler
  metadata:
   name: threescale
  spec:
   adapter: threescale
   params:
     system_url: "https://&lt;organization&gt;-admin.3scale.net/"
     access_token: "&lt;ACCESS_TOKEN&gt;"
   connection:
     address: "threescale-istio-adapter:3333"</pre><p class="simpara">
							Optionally, you can provide a <code class="literal">backend_url</code> field within the <span class="emphasis"><em>params</em></span> section to override the URL provided by the 3scale configuration. This may be useful if the adapter runs on the same cluster as the 3scale on-premise instance, and you wish to leverage the internal cluster DNS.
						</p></li><li class="listitem"><p class="simpara">
							Edit or patch the Deployment resource of any services belonging to your 3scale account as follows:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Add the <code class="literal">"service-mesh.3scale.net/service-id"</code> label with a value corresponding to a valid <code class="literal">service_id</code>.
								</li><li class="listitem">
									Add the <code class="literal">"service-mesh.3scale.net/credentials"</code> label with its value being the <span class="emphasis"><em>name of the handler resource</em></span> from step 1.
								</li></ol></div></li><li class="listitem">
							Do step 2 to link it to your 3scale account credentials and to its service identifier, whenever you intend to add more services.
						</li><li class="listitem"><p class="simpara">
							Modify the rule configuration with your 3scale configuration to dispatch the rule to the threescale handler.
						</p><div class="formalpara"><p class="title"><strong>Rule configuration example</strong></p><p>
								
<pre class="programlisting language-yaml">  apiVersion: "config.istio.io/v1alpha2"
  kind: rule
  metadata:
    name: threescale
  spec:
    match: destination.labels["service-mesh.3scale.net"] == "true"
    actions:
      - handler: threescale.handler
        instances:
          - threescale-authorization.instance</pre>

							</p></div></li></ol></div><section class="section" id="ossm-threescale-cr_threescale-adapter"><div class="titlepage"><div><div><h4 class="title">1.21.1.1. Generating 3scale custom resources</h4></div></div></div><p>
						The adapter includes a tool that allows you to generate the <code class="literal">handler</code>, <code class="literal">instance</code>, and <code class="literal">rule</code> custom resources.
					</p><div class="table" id="idm140663649361712"><p class="title"><strong>Table 1.29. Usage</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663649355136" scope="col">Option</th><th align="left" valign="top" id="idm140663649354048" scope="col">Description</th><th align="left" valign="top" id="idm140663649352960" scope="col">Required</th><th align="left" valign="top" id="idm140663649351872" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663649355136"> <p>
										<code class="literal">-h, --help</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663649354048"> <p>
										Produces help output for available options
									</p>
									 </td><td align="left" valign="top" headers="idm140663649352960"> <p>
										No
									</p>
									 </td><td align="left" valign="top" headers="idm140663649351872"> </td></tr><tr><td align="left" valign="top" headers="idm140663649355136"> <p>
										<code class="literal">--name</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663649354048"> <p>
										Unique name for this URL, token pair
									</p>
									 </td><td align="left" valign="top" headers="idm140663649352960"> <p>
										Yes
									</p>
									 </td><td align="left" valign="top" headers="idm140663649351872"> </td></tr><tr><td align="left" valign="top" headers="idm140663649355136"> <p>
										<code class="literal">-n, --namespace</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663649354048"> <p>
										Namespace to generate templates
									</p>
									 </td><td align="left" valign="top" headers="idm140663649352960"> <p>
										No
									</p>
									 </td><td align="left" valign="top" headers="idm140663649351872"> <p>
										istio-system
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663649355136"> <p>
										<code class="literal">-t, --token</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663649354048"> <p>
										3scale access token
									</p>
									 </td><td align="left" valign="top" headers="idm140663649352960"> <p>
										Yes
									</p>
									 </td><td align="left" valign="top" headers="idm140663649351872"> </td></tr><tr><td align="left" valign="top" headers="idm140663649355136"> <p>
										<code class="literal">-u, --url</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663649354048"> <p>
										3scale Admin Portal URL
									</p>
									 </td><td align="left" valign="top" headers="idm140663649352960"> <p>
										Yes
									</p>
									 </td><td align="left" valign="top" headers="idm140663649351872"> </td></tr><tr><td align="left" valign="top" headers="idm140663649355136"> <p>
										<code class="literal">--backend-url</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663649354048"> <p>
										3scale backend URL. If set, it overrides the value that is read from system configuration
									</p>
									 </td><td align="left" valign="top" headers="idm140663649352960"> <p>
										No
									</p>
									 </td><td align="left" valign="top" headers="idm140663649351872"> </td></tr><tr><td align="left" valign="top" headers="idm140663649355136"> <p>
										<code class="literal">-s, --service</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663649354048"> <p>
										3scale API/Service ID
									</p>
									 </td><td align="left" valign="top" headers="idm140663649352960"> <p>
										No
									</p>
									 </td><td align="left" valign="top" headers="idm140663649351872"> </td></tr><tr><td align="left" valign="top" headers="idm140663649355136"> <p>
										<code class="literal">--auth</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663649354048"> <p>
										3scale authentication pattern to specify (1=API Key, 2=App Id/App Key, 3=OIDC)
									</p>
									 </td><td align="left" valign="top" headers="idm140663649352960"> <p>
										No
									</p>
									 </td><td align="left" valign="top" headers="idm140663649351872"> <p>
										Hybrid
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663649355136"> <p>
										<code class="literal">-o, --output</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663649354048"> <p>
										File to save produced manifests to
									</p>
									 </td><td align="left" valign="top" headers="idm140663649352960"> <p>
										No
									</p>
									 </td><td align="left" valign="top" headers="idm140663649351872"> <p>
										Standard output
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663649355136"> <p>
										<code class="literal">--version</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663649354048"> <p>
										Outputs the CLI version and exits immediately
									</p>
									 </td><td align="left" valign="top" headers="idm140663649352960"> <p>
										No
									</p>
									 </td><td align="left" valign="top" headers="idm140663649351872"> </td></tr></tbody></table></div></div><section class="section" id="ossm-threescale-templates_threescale-adapter"><div class="titlepage"><div><div><h5 class="title">1.21.1.1.1. Generate templates from URL examples</h5></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Run the following commands via <code class="literal">oc exec</code> from the 3scale adapter container image in <a class="link" href="#ossm-threescale-manifests_threescale-adapter" title="1.21.1.2. Generating manifests from a deployed adapter">Generating manifests from a deployed adapter</a>.
									</li><li class="listitem">
										Use the <code class="literal">3scale-config-gen</code> command to help avoid YAML syntax and indentation errors.
									</li><li class="listitem">
										You can omit the <code class="literal">--service</code> if you use the annotations.
									</li><li class="listitem">
										This command must be invoked from within the container image via <code class="literal">oc exec</code>.
									</li></ul></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Use the <code class="literal">3scale-config-gen</code> command to autogenerate templates files allowing the token, URL pair to be shared by multiple services as a single handler:
								</p><pre class="screen">$ 3scale-config-gen --name=admin-credentials --url="https://&lt;organization&gt;-admin.3scale.net:443" --token="[redacted]"</pre></li><li class="listitem"><p class="simpara">
									The following example generates the templates with the service ID embedded in the handler:
								</p><pre class="screen">$ 3scale-config-gen --url="https://&lt;organization&gt;-admin.3scale.net" --name="my-unique-id" --service="123456789" --token="[redacted]"</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_3scale_api_management/2.10/html-single/admin_portal_guide/index#tokens">Tokens</a>.
								</li></ul></div></section></section><section class="section" id="ossm-threescale-manifests_threescale-adapter"><div class="titlepage"><div><div><h4 class="title">1.21.1.2. Generating manifests from a deployed adapter</h4></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">NAME</code> is an identifier you use to identify with the service you are managing with 3scale.
								</li><li class="listitem">
									The <code class="literal">CREDENTIALS_NAME</code> reference is an identifier that corresponds to the <code class="literal">match</code> section in the rule configuration. This is automatically set to the <code class="literal">NAME</code> identifier if you are using the CLI tool.
								</li><li class="listitem">
									Its value does not need to be anything specific: the label value should just match the contents of the rule. See <a class="link" href="https://github.com/3scale/3scale-istio-adapter/blob/v2.X/README.md#routing-service-traffic-through-the-adapter">Routing service traffic through the adapter</a> for more information.
								</li></ul></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Run this command to generate manifests from a deployed adapter in the <code class="literal">istio-system</code> namespace:
							</p><pre class="screen">$ export NS="istio-system" URL="https://replaceme-admin.3scale.net:443" NAME="name" TOKEN="token"
oc exec -n ${NS} $(oc get po -n ${NS} -o jsonpath='{.items[?(@.metadata.labels.app=="3scale-istio-adapter")].metadata.name}') \
-it -- ./3scale-config-gen \
--url ${URL} --name ${NAME} --token ${TOKEN} -n ${NS}</pre></li><li class="listitem">
								This will produce sample output to the terminal. Edit these samples if required and create the objects using the <code class="literal">oc create</code> command.
							</li><li class="listitem"><p class="simpara">
								When the request reaches the adapter, the adapter needs to know how the service maps to an API on 3scale. You can provide this information in two ways:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Label the workload (recommended)
									</li><li class="listitem">
										Hard code the handler as <code class="literal">service_id</code>
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Update the workload with the required annotations:
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									You only need to update the service ID provided in this example if it is not already embedded in the handler. <span class="strong strong"><strong>The setting in the handler takes precedence</strong></span>.
								</p></div></div><pre class="screen">$ export CREDENTIALS_NAME="replace-me"
export SERVICE_ID="replace-me"
export DEPLOYMENT="replace-me"
patch="$(oc get deployment "${DEPLOYMENT}"
patch="$(oc get deployment "${DEPLOYMENT}" --template='{"spec":{"template":{"metadata":{"labels":{ {{ range $k,$v := .spec.template.metadata.labels }}"{{ $k }}":"{{ $v }}",{{ end }}"service-mesh.3scale.net/service-id":"'"${SERVICE_ID}"'","service-mesh.3scale.net/credentials":"'"${CREDENTIALS_NAME}"'"}}}}}' )"
oc patch deployment "${DEPLOYMENT}" --patch ''"${patch}"''</pre></li></ol></div></section><section class="section" id="ossm-threescale-routing_threescale-adapter"><div class="titlepage"><div><div><h4 class="title">1.21.1.3. Routing service traffic through the adapter</h4></div></div></div><p>
						Follow these steps to drive traffic for your service through the 3scale adapter.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Credentials and service ID from your 3scale administrator.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Match the rule <code class="literal">destination.labels["service-mesh.3scale.net/credentials"] == "threescale"</code> that you previously created in the configuration, in the <code class="literal">kind: rule</code> resource.
							</li><li class="listitem">
								Add the above label to <code class="literal">PodTemplateSpec</code> on the Deployment of the target workload to integrate a service. the value, <code class="literal">threescale</code>, refers to the name of the generated handler. This handler stores the access token required to call 3scale.
							</li><li class="listitem">
								Add the <code class="literal">destination.labels["service-mesh.3scale.net/service-id"] == "replace-me"</code> label to the workload to pass the service ID to the adapter via the instance at request time.
							</li></ol></div></section></section><section class="section" id="ossm-threescale-integration-settings_threescale-adapter"><div class="titlepage"><div><div><h3 class="title">1.21.2. Configure the integration settings in 3scale</h3></div></div></div><p>
					Follow this procedure to configure the 3scale integration settings.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						For 3scale SaaS customers, Red Hat OpenShift Service Mesh is enabled as part of the Early Access program.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to <span class="strong strong"><strong>[your_API_name]</strong></span> → <span class="strong strong"><strong>Integration</strong></span>
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Settings</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Select the <span class="strong strong"><strong>Istio</strong></span> option under <span class="emphasis"><em>Deployment</em></span>.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The <span class="strong strong"><strong>API Key (user_key)</strong></span> option under <span class="emphasis"><em>Authentication</em></span> is selected by default.
								</li></ul></div></li><li class="listitem">
							Click <span class="strong strong"><strong>Update Product</strong></span> to save your selection.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Configuration</strong></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Update Configuration</strong></span>.
						</li></ol></div></section><section class="section" id="ossm-threescale-caching_threescale-adapter"><div class="titlepage"><div><div><h3 class="title">1.21.3. Caching behavior</h3></div></div></div><p>
					Responses from 3scale System APIs are cached by default within the adapter. Entries will be purged from the cache when they become older than the <code class="literal">cacheTTLSeconds</code> value. Also by default, automatic refreshing of cached entries will be attempted seconds before they expire, based on the <code class="literal">cacheRefreshSeconds</code> value. You can disable automatic refreshing by setting this value higher than the <code class="literal">cacheTTLSeconds</code> value.
				</p><p>
					Caching can be disabled entirely by setting <code class="literal">cacheEntriesMax</code> to a non-positive value.
				</p><p>
					By using the refreshing process, cached values whose hosts become unreachable will be retried before eventually being purged when past their expiry.
				</p></section><section class="section" id="ossm-threescale-authentication_threescale-adapter"><div class="titlepage"><div><div><h3 class="title">1.21.4. Authenticating requests</h3></div></div></div><p>
					This release supports the following authentication methods:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Standard API Keys</strong></span>: single randomized strings or hashes acting as an identifier and a secret token.
						</li><li class="listitem">
							<span class="strong strong"><strong>Application identifier and key pairs</strong></span>: immutable identifier and mutable secret key strings.
						</li><li class="listitem">
							<span class="strong strong"><strong>OpenID authentication method</strong></span>: client ID string parsed from the JSON Web Token.
						</li></ul></div><section class="section" id="ossm-threescale-authentication-patterns_threescale-adapter"><div class="titlepage"><div><div><h4 class="title">1.21.4.1. Applying authentication patterns</h4></div></div></div><p>
						Modify the <code class="literal">instance</code> custom resource, as illustrated in the following authentication method examples, to configure authentication behavior. You can accept the authentication credentials from:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Request headers
							</li><li class="listitem">
								Request parameters
							</li><li class="listitem">
								Both request headers and query parameters
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When specifying values from headers, they must be lower case. For example, if you want to send a header as <code class="literal">User-Key</code>, this must be referenced in the configuration as <code class="literal">request.headers["user-key"]</code>.
						</p></div></div><section class="section" id="ossm-threescale-apikey-authentication_threescale-adapter"><div class="titlepage"><div><div><h5 class="title">1.21.4.1.1. API key authentication method</h5></div></div></div><p>
							Service Mesh looks for the API key in query parameters and request headers as specified in the <code class="literal">user</code> option in the <code class="literal">subject</code> custom resource parameter. It checks the values in the order given in the custom resource file. You can restrict the search for the API key to either query parameters or request headers by omitting the unwanted option.
						</p><p>
							In this example, Service Mesh looks for the API key in the <code class="literal">user_key</code> query parameter. If the API key is not in the query parameter, Service Mesh then checks the <code class="literal">user-key</code> header.
						</p><div class="formalpara"><p class="title"><strong>API key authentication method example</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: "config.istio.io/v1alpha2"
kind: instance
metadata:
  name: threescale-authorization
  namespace: istio-system
spec:
  template: authorization
  params:
    subject:
      user: request.query_params["user_key"] | request.headers["user-key"] | ""
    action:
      path: request.url_path
      method: request.method | "get"</pre>

							</p></div><p>
							If you want the adapter to examine a different query parameter or request header, change the name as appropriate. For example, to check for the API key in a query parameter named “key”, change <code class="literal">request.query_params["user_key"]</code> to <code class="literal">request.query_params["key"]</code>.
						</p></section><section class="section" id="ossm-threescale-appidapikey-authentication_threescale-adapter"><div class="titlepage"><div><div><h5 class="title">1.21.4.1.2. Application ID and application key pair authentication method</h5></div></div></div><p>
							Service Mesh looks for the application ID and application key in query parameters and request headers, as specified in the <code class="literal">properties</code> option in the <code class="literal">subject</code> custom resource parameter. The application key is optional. It checks the values in the order given in the custom resource file. You can restrict the search for the credentials to either query parameters or request headers by not including the unwanted option.
						</p><p>
							In this example, Service Mesh looks for the application ID and application key in the query parameters first, moving on to the request headers if needed.
						</p><div class="formalpara"><p class="title"><strong>Application ID and application key pair authentication method example</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: "config.istio.io/v1alpha2"
kind: instance
metadata:
  name: threescale-authorization
  namespace: istio-system
spec:
  template: authorization
  params:
    subject:
        app_id: request.query_params["app_id"] | request.headers["app-id"] | ""
        app_key: request.query_params["app_key"] | request.headers["app-key"] | ""
    action:
      path: request.url_path
      method: request.method | "get"</pre>

							</p></div><p>
							If you want the adapter to examine a different query parameter or request header, change the name as appropriate. For example, to check for the application ID in a query parameter named <code class="literal">identification</code>, change <code class="literal">request.query_params["app_id"]</code> to <code class="literal">request.query_params["identification"]</code>.
						</p></section><section class="section" id="ossm-threescale-openid-authentication_threescale-adapter"><div class="titlepage"><div><div><h5 class="title">1.21.4.1.3. OpenID authentication method</h5></div></div></div><p>
							To use the <span class="emphasis"><em>OpenID Connect (OIDC) authentication method</em></span>, use the <code class="literal">properties</code> value on the <code class="literal">subject</code> field to set <code class="literal">client_id</code>, and optionally <code class="literal">app_key</code>.
						</p><p>
							You can manipulate this object using the methods described previously. In the example configuration shown below, the client identifier (application ID) is parsed from the JSON Web Token (JWT) under the label <span class="emphasis"><em>azp</em></span>. You can modify this as needed.
						</p><div class="formalpara"><p class="title"><strong>OpenID authentication method example</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: "config.istio.io/v1alpha2"
kind: instance
metadata:
  name: threescale-authorization
spec:
  template: threescale-authorization
  params:
    subject:
      properties:
        app_key: request.query_params["app_key"] | request.headers["app-key"] | ""
        client_id: request.auth.claims["azp"] | ""
      action:
        path: request.url_path
        method: request.method | "get"
        service: destination.labels["service-mesh.3scale.net/service-id"] | ""</pre>

							</p></div><p>
							For this integration to work correctly, OIDC must still be done in 3scale for the client to be created in the identity provider (IdP). You should create a <a class="link" href="https://istio.io/latest/docs/tasks/security/authorization/authz-jwt/">Request authorization</a> for the service you want to protect in the same namespace as that service. The JWT is passed in the <code class="literal">Authorization</code> header of the request.
						</p><p>
							In the sample <code class="literal">RequestAuthentication</code> defined below, replace <code class="literal">issuer</code>, <code class="literal">jwksUri</code>, and <code class="literal">selector</code> as appropriate.
						</p><div class="formalpara"><p class="title"><strong>OpenID Policy example</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: security.istio.io/v1beta1
kind: RequestAuthentication
metadata:
  name: jwt-example
  namespace: bookinfo
spec:
  selector:
    matchLabels:
      app: productpage
  jwtRules:
  - issuer: &gt;-
      http://keycloak-keycloak.34.242.107.254.nip.io/auth/realms/3scale-keycloak
    jwksUri: &gt;-
      http://keycloak-keycloak.34.242.107.254.nip.io/auth/realms/3scale-keycloak/protocol/openid-connect/certs</pre>

							</p></div></section><section class="section" id="ossm-threescale-hybrid-authentication_threescale-adapter"><div class="titlepage"><div><div><h5 class="title">1.21.4.1.4. Hybrid authentication method</h5></div></div></div><p>
							You can choose to not enforce a particular authentication method and accept any valid credentials for either method. If both an API key and an application ID/application key pair are provided, Service Mesh uses the API key.
						</p><p>
							In this example, Service Mesh checks for an API key in the query parameters, then the request headers. If there is no API key, it then checks for an application ID and key in the query parameters, then the request headers.
						</p><div class="formalpara"><p class="title"><strong>Hybrid authentication method example</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: "config.istio.io/v1alpha2"
kind: instance
metadata:
  name: threescale-authorization
spec:
  template: authorization
  params:
    subject:
      user: request.query_params["user_key"] | request.headers["user-key"] |
      properties:
        app_id: request.query_params["app_id"] | request.headers["app-id"] | ""
        app_key: request.query_params["app_key"] | request.headers["app-key"] | ""
        client_id: request.auth.claims["azp"] | ""
    action:
      path: request.url_path
      method: request.method | "get"
      service: destination.labels["service-mesh.3scale.net/service-id"] | ""</pre>

							</p></div></section></section></section><section class="section" id="ossm-threescale-metrics_threescale-adapter"><div class="titlepage"><div><div><h3 class="title">1.21.5. 3scale Adapter metrics</h3></div></div></div><p>
					The adapter, by default reports various Prometheus metrics that are exposed on port <code class="literal">8080</code> at the <code class="literal">/metrics</code> endpoint. These metrics provide insight into how the interactions between the adapter and 3scale are performing. The service is labeled to be automatically discovered and scraped by Prometheus.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						There are incompatible changes in the 3scale Istio Adapter metrics since the previous releases in Service Mesh 1.x.
					</p></div></div><p>
					In Prometheus, metrics have been renamed with one addition for the backend cache, so that the following metrics exist as of Service Mesh 2.0:
				</p><div class="table" id="idm140663648519872"><p class="title"><strong>Table 1.30. Prometheus metrics</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663648514112" scope="col">Metric</th><th align="left" valign="top" id="idm140663648513024" scope="col">Type</th><th align="left" valign="top" id="idm140663648511936" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663648514112"> <p>
									<code class="literal">threescale_latency</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663648513024"> <p>
									Histogram
								</p>
								 </td><td align="left" valign="top" headers="idm140663648511936"> <p>
									Request latency between adapter and 3scale.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663648514112"> <p>
									<code class="literal">threescale_http_total</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663648513024"> <p>
									Counter
								</p>
								 </td><td align="left" valign="top" headers="idm140663648511936"> <p>
									HTTP Status response codes for requests to 3scale backend.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663648514112"> <p>
									<code class="literal">threescale_system_cache_hits</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663648513024"> <p>
									Counter
								</p>
								 </td><td align="left" valign="top" headers="idm140663648511936"> <p>
									Total number of requests to the 3scale system fetched from the configuration cache.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663648514112"> <p>
									<code class="literal">threescale_backend_cache_hits</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663648513024"> <p>
									Counter
								</p>
								 </td><td align="left" valign="top" headers="idm140663648511936"> <p>
									Total number of requests to 3scale backend fetched from the backend cache.
								</p>
								 </td></tr></tbody></table></div></div></section><section class="section" id="threescale-backend-cache_threescale-adapter"><div class="titlepage"><div><div><h3 class="title">1.21.6. 3scale backend cache</h3></div></div></div><p>
					The 3scale backend cache provides an authorization and reporting cache for clients of the 3scale Service Management API. This cache is embedded in the adapter to enable lower latencies in responses in certain situations assuming the administrator is willing to accept the trade-offs.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						3scale backend cache is disabled by default. 3scale backend cache functionality trades inaccuracy in rate limiting and potential loss of hits since the last flush was performed for low latency and higher consumption of resources in the processor and memory.
					</p></div></div><section class="section" id="advantages-of-enabling-backend-cache"><div class="titlepage"><div><div><h4 class="title">1.21.6.1. Advantages of enabling backend cache</h4></div></div></div><p>
						The following are advantages to enabling the backend cache:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Enable the backend cache when you find latencies are high while accessing services managed by the 3scale Istio Adapter.
							</li><li class="listitem"><p class="simpara">
								Enabling the backend cache will stop the adapter from continually checking with the 3scale API manager for request authorizations, which will lower the latency.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										This creates an in-memory cache of 3scale authorizations for the 3scale Istio Adapter to store and reuse before attempting to contact the 3scale API manager for authorizations. Authorizations will then take much less time to be granted or denied.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Backend caching is useful in cases when you are hosting the 3scale API manager in another geographical location from the service mesh running the 3scale Istio Adapter.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										This is generally the case with the 3scale Hosted (SaaS) platform, but also if a user hosts their 3scale API manager in another cluster located in a different geographical location, in a different availability zone, or in any case where the network overhead to reach the 3scale API manager is noticeable.
									</li></ul></div></li></ul></div></section><section class="section" id="trade-offs-for-having-lower-latencies"><div class="titlepage"><div><div><h4 class="title">1.21.6.2. Trade-offs for having lower latencies</h4></div></div></div><p>
						The following are trade-offs for having lower latencies:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Each 3scale adapter’s authorization state updates every time a flush happens.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										This means two or more instances of the adapter will introduce more inaccuracy between flushing periods.
									</li><li class="listitem">
										There is a greater chance of too many requests being granted that exceed limits and introduce erratic behavior, which leads to some requests going through and some not, depending on which adapter processes each request.
									</li></ul></div></li><li class="listitem">
								An adapter cache that cannot flush its data and update its authorization information risks shut down or crashing without reporting its information to the API manager.
							</li><li class="listitem">
								A fail open or fail closed policy will be applied when an adapter cache cannot determine whether a request must be granted or denied, possibly due to network connectivity issues in contacting the API manager.
							</li><li class="listitem">
								When cache misses occur, typically right after booting the adapter or after a long period of no connectivity, latencies will grow in order to query the API manager.
							</li><li class="listitem">
								An adapter cache must do much more work on computing authorizations than it would without an enabled cache, which will tax processor resources.
							</li><li class="listitem">
								Memory requirements will grow proportionally to the combination of the amount of limits, applications, and services managed by the cache.
							</li></ul></div></section><section class="section" id="backend-cache-configuration-settings"><div class="titlepage"><div><div><h4 class="title">1.21.6.3. Backend cache configuration settings</h4></div></div></div><p>
						The following points explain the backend cache configuration settings:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Find the settings to configure the backend cache in the 3scale configuration options.
							</li><li class="listitem"><p class="simpara">
								The last 3 settings control enabling of backend cache:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">PARAM_USE_CACHE_BACKEND</code> - set to true to enable backend cache.
									</li><li class="listitem">
										<code class="literal">PARAM_BACKEND_CACHE_FLUSH_INTERVAL_SECONDS</code> - sets time in seconds between consecutive attempts to flush cache data to the API manager.
									</li><li class="listitem">
										<code class="literal">PARAM_BACKEND_CACHE_POLICY_FAIL_CLOSED</code> - set whether or not to allow/open or deny/close requests to the services when there is not enough cached data and the 3scale API manager cannot be reached.
									</li></ul></div></li></ul></div></section></section><section class="section" id="threescale-istio-adapter-apicast_threescale-adapter"><div class="titlepage"><div><div><h3 class="title">1.21.7. 3scale Istio Adapter APIcast emulation</h3></div></div></div><p>
					The 3scale Istio Adapter performs as APIcast would when the following conditions occur:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							When a request cannot match any mapping rule defined, the returned HTTP code is 404 Not Found. This was previously 403 Forbidden.
						</li><li class="listitem">
							When a request is denied because it goes over limits, the returned HTTP code is 429 Too Many Requests. This was previously 403 Forbidden.
						</li><li class="listitem">
							When generating default templates via the CLI, it will use underscores rather than dashes for the headers, for example: <code class="literal">user_key</code> rather than <code class="literal">user-key</code>.
						</li></ul></div></section><section class="section" id="ossm-threescale-istio-adapter-verification_threescale-adapter"><div class="titlepage"><div><div><h3 class="title">1.21.8. 3scale Istio adapter verification</h3></div></div></div><p>
					You might want to check whether the 3scale Istio adapter is working as expected. If your adapter is not working, use the following steps to help troubleshoot the problem.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Ensure the <span class="emphasis"><em>3scale-adapter</em></span> pod is running in the Service Mesh control plane namespace:
						</p><pre class="programlisting language-terminal">$ oc get pods -n &lt;istio-system&gt;</pre></li><li class="listitem"><p class="simpara">
							Check that the <span class="emphasis"><em>3scale-adapter</em></span> pod has printed out information about itself booting up, such as its version:
						</p><pre class="programlisting language-terminal">$ oc logs &lt;istio-system&gt;</pre></li><li class="listitem">
							When performing requests to the services protected by the 3scale adapter integration, always try requests that lack the right credentials and ensure they fail. Check the 3scale adapter logs to gather additional information.
						</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://docs.openshift.com/container-platform/4.7/support/troubleshooting/investigating-pod-issues.html#inspecting-pod-and-container-logs_investigating-pod-issues">Inspecting pod and container logs</a>.
						</li></ul></div></section><section class="section" id="ossm-threescale-istio-adapter-troubleshooting-checklist_threescale-adapter"><div class="titlepage"><div><div><h3 class="title">1.21.9. 3scale Istio adapter troubleshooting checklist</h3></div></div></div><p>
					As the administrator installing the 3scale Istio adapter, there are a number of scenarios that might be causing your integration to not function properly. Use the following list to troubleshoot your installation:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Incorrect YAML indentation.
						</li><li class="listitem">
							Missing YAML sections.
						</li><li class="listitem">
							Forgot to apply the changes in the YAML to the cluster.
						</li><li class="listitem">
							Forgot to label the service workloads with the <code class="literal">service-mesh.3scale.net/credentials</code> key.
						</li><li class="listitem">
							Forgot to label the service workloads with <code class="literal">service-mesh.3scale.net/service-id</code> when using handlers that do not contain a <code class="literal">service_id</code> so they are reusable per account.
						</li><li class="listitem">
							The <span class="emphasis"><em>Rule</em></span> custom resource points to the wrong handler or instance custom resources, or the references lack the corresponding namespace suffix.
						</li><li class="listitem">
							The <span class="emphasis"><em>Rule</em></span> custom resource <code class="literal">match</code> section cannot possibly match the service you are configuring, or it points to a destination workload that is not currently running or does not exist.
						</li><li class="listitem">
							Wrong access token or URL for the 3scale Admin Portal in the handler.
						</li><li class="listitem">
							The <span class="emphasis"><em>Instance</em></span> custom resource’s <code class="literal">params/subject/properties</code> section fails to list the right parameters for <code class="literal">app_id</code>, <code class="literal">app_key</code>, or <code class="literal">client_id</code>, either because they specify the wrong location such as the query parameters, headers, and authorization claims, or the parameter names do not match the requests used for testing.
						</li><li class="listitem">
							Failing to use the configuration generator without realizing that it actually lives in the adapter container image and needs <code class="literal">oc exec</code> to invoke it.
						</li></ul></div></section></section><section class="section" id="ossm-troubleshooting"><div class="titlepage"><div><div><h2 class="title">1.22. Troubleshooting your service mesh</h2></div></div></div><p>
				This section describes how to identify and resolve common problems in Red Hat OpenShift Service Mesh. Use the following sections to help troubleshoot and debug problems when deploying Red Hat OpenShift Service Mesh on OpenShift Container Platform.
			</p><section class="section" id="ossm-versions_troubleshooting-ossm"><div class="titlepage"><div><div><h3 class="title">1.22.1. Understanding Service Mesh versions</h3></div></div></div><p>
					In order to understand what version of Red Hat OpenShift Service Mesh you have deployed on your system, you need to understand how each of the component versions is managed.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>Operator</strong></span> version - The most current Operator version is 2.4.3. The Operator version number only indicates the version of the currently installed Operator. Because the Red Hat OpenShift Service Mesh Operator supports multiple versions of the Service Mesh control plane, the version of the Operator does not determine the version of your deployed <code class="literal">ServiceMeshControlPlane</code> resources.
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								Upgrading to the latest Operator version automatically applies patch updates, but does not automatically upgrade your Service Mesh control plane to the latest minor version.
							</p></div></div></li><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>ServiceMeshControlPlane</strong></span> version - The <code class="literal">ServiceMeshControlPlane</code> version determines what version of Red Hat OpenShift Service Mesh you are using. The value of the <code class="literal">spec.version</code> field in the <code class="literal">ServiceMeshControlPlane</code> resource controls the architecture and configuration settings that are used to install and deploy Red Hat OpenShift Service Mesh. When you create the Service Mesh control plane you can set the version in one of two ways:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									To configure in the Form View, select the version from the <span class="strong strong"><strong>Control Plane Version</strong></span> menu.
								</li><li class="listitem">
									To configure in the YAML View, set the value for <code class="literal">spec.version</code> in the YAML file.
								</li></ul></div></li></ul></div><p>
					Operator Lifecycle Manager (OLM) does not manage Service Mesh control plane upgrades, so the version number for your Operator and <code class="literal">ServiceMeshControlPlane</code> (SMCP) may not match, unless you have manually upgraded your SMCP.
				</p></section><section class="section" id="troubleshooting-operator-installation"><div class="titlepage"><div><div><h3 class="title">1.22.2. Troubleshooting Operator installation</h3></div></div></div><p>
					In addition to the information in this section, be sure to review the following topics:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#what-are-operators?">What are Operators?</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#concepts-and-resources">Operator Lifecycle Management concepts</a>.
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/support/#troubleshooting-operator-issues-1">OpenShift Operator troubleshooting section</a>.
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/support/#troubleshooting-installations-1">OpenShift installation troubleshooting section</a>.
						</li></ul></div><section class="section" id="ossm-validating-operators_troubleshooting-ossm"><div class="titlepage"><div><div><h4 class="title">1.22.2.1. Validating Operator installation</h4></div></div></div><p>
						When you install the Red Hat OpenShift Service Mesh Operators, OpenShift automatically creates the following objects as part of a successful Operator installation:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								config maps
							</li><li class="listitem">
								custom resource definitions
							</li><li class="listitem">
								deployments
							</li><li class="listitem">
								pods
							</li><li class="listitem">
								replica sets
							</li><li class="listitem">
								roles
							</li><li class="listitem">
								role bindings
							</li><li class="listitem">
								secrets
							</li><li class="listitem">
								service accounts
							</li><li class="listitem">
								services
							</li></ul></div><div class="formalpara"><p class="title"><strong>From the OpenShift Container Platform console</strong></p><p>
							You can verify that the Operator pods are available and running by using the OpenShift Container Platform console.
						</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Navigate to <span class="strong strong"><strong>Workloads</strong></span> → <span class="strong strong"><strong>Pods</strong></span>.
							</li><li class="listitem">
								Select the <code class="literal">openshift-operators</code> namespace.
							</li><li class="listitem"><p class="simpara">
								Verify that the following pods exist and have a status of <code class="literal">running</code>:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">istio-operator</code>
									</li><li class="listitem">
										<code class="literal">jaeger-operator</code>
									</li><li class="listitem">
										<code class="literal">kiali-operator</code>
									</li></ul></div></li><li class="listitem">
								Select the <code class="literal">openshift-operators-redhat</code> namespace.
							</li><li class="listitem">
								Verify that the <code class="literal">elasticsearch-operator</code> pod exists and has a status of <code class="literal">running</code>.
							</li></ol></div><div class="orderedlist"><p class="title"><strong>From the command line</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Verify the Operator pods are available and running in the <code class="literal">openshift-operators</code> namespace with the following command:
							</p><pre class="programlisting language-terminal">$ oc get pods -n openshift-operators</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                               READY   STATUS    RESTARTS   AGE
istio-operator-bb49787db-zgr87     1/1     Running   0          15s
jaeger-operator-7d5c4f57d8-9xphf   1/1     Running   0          2m42s
kiali-operator-f9c8d84f4-7xh2v     1/1     Running   0          64s</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Verify the Elasticsearch operator with the following command:
							</p><pre class="programlisting language-terminal">$ oc get pods -n openshift-operators-redhat</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                      READY   STATUS    RESTARTS   AGE
elasticsearch-operator-d4f59b968-796vq     1/1     Running   0          15s</pre>

								</p></div></li></ol></div></section><section class="section" id="ossm-troubleshooting-operators_troubleshooting-ossm"><div class="titlepage"><div><div><h4 class="title">1.22.2.2. Troubleshooting service mesh Operators</h4></div></div></div><p>
						If you experience Operator issues:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Verify your Operator subscription status.
							</li><li class="listitem">
								Verify that you did not install a community version of the Operator, instead of the supported Red Hat version.
							</li><li class="listitem">
								Verify that you have the <code class="literal">cluster-admin</code> role to install Red Hat OpenShift Service Mesh.
							</li><li class="listitem">
								Check for any errors in the Operator pod logs if the issue is related to installation of Operators.
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You can install Operators only through the OpenShift console, the OperatorHub is not accessible from the command line.
						</p></div></div><section class="section" id="viewing-operator-pod-logs"><div class="titlepage"><div><div><h5 class="title">1.22.2.2.1. Viewing Operator pod logs</h5></div></div></div><p>
							You can view Operator logs by using the <code class="literal">oc logs</code> command. Red Hat may request logs to help resolve support cases.
						</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To view Operator pod logs, enter the command:
								</p><pre class="programlisting language-terminal">$ oc logs -n openshift-operators &lt;podName&gt;</pre><p class="simpara">
									For example,
								</p><pre class="programlisting language-terminal">$ oc logs -n openshift-operators istio-operator-bb49787db-zgr87</pre></li></ul></div></section></section></section><section class="section" id="troubleshooting-the-control-plane"><div class="titlepage"><div><div><h3 class="title">1.22.3. Troubleshooting the control plane</h3></div></div></div><p>
					The Service Mesh <span class="emphasis"><em>control plane</em></span> is composed of Istiod, which consolidates several previous control plane components (Citadel, Galley, Pilot) into a single binary. Deploying the <code class="literal">ServiceMeshControlPlane</code> also creates the other components that make up Red Hat OpenShift Service Mesh as described in the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-architecture_ossm-architecture">architecture</a> topic.
				</p><section class="section" id="ossm-validating-smcp_troubleshooting-ossm"><div class="titlepage"><div><div><h4 class="title">1.22.3.1. Validating the Service Mesh control plane installation</h4></div></div></div><p>
						When you create the Service Mesh control plane, the Service Mesh Operator uses the parameters that you have specified in the <code class="literal">ServiceMeshControlPlane</code> resource file to do the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Creates the Istio components and deploys the following pods:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">istiod</code>
									</li><li class="listitem">
										<code class="literal">istio-ingressgateway</code>
									</li><li class="listitem">
										<code class="literal">istio-egressgateway</code>
									</li><li class="listitem">
										<code class="literal">grafana</code>
									</li><li class="listitem">
										<code class="literal">prometheus</code>
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Calls the Kiali Operator to create Kaili deployment based on configuration in either the SMCP or the Kiali custom resource.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									You view the Kiali components under the Kiali Operator, not the Service Mesh Operator.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Calls the Red Hat OpenShift distributed tracing platform (Jaeger) Operator to create distributed tracing platform (Jaeger) components based on configuration in either the SMCP or the Jaeger custom resource.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									You view the Jaeger components under the Red Hat OpenShift distributed tracing platform (Jaeger) Operator and the Elasticsearch components under the Red Hat Elasticsearch Operator, not the Service Mesh Operator.
								</p></div></div><div class="formalpara"><p class="title"><strong>From the OpenShift Container Platform console</strong></p><p>
									You can verify the Service Mesh control plane installation in the OpenShift Container Platform web console.
								</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
										Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
									</li><li class="listitem">
										Select the <code class="literal">&lt;istio-system&gt;</code> namespace.
									</li><li class="listitem"><p class="simpara">
										Select the Red Hat OpenShift Service Mesh Operator.
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
												Click the <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span> tab.
											</li><li class="listitem">
												Click the name of your control plane, for example <code class="literal">basic</code>.
											</li><li class="listitem">
												To view the resources created by the deployment, click the <span class="strong strong"><strong>Resources</strong></span> tab. You can use the filter to narrow your view, for example, to check that all the <span class="strong strong"><strong>Pods</strong></span> have a status of <code class="literal">running</code>.
											</li><li class="listitem">
												If the SMCP status indicates any problems, check the <code class="literal">status:</code> output in the YAML file for more information.
											</li><li class="listitem">
												Navigate back to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
											</li></ol></div></li><li class="listitem"><p class="simpara">
										Select the OpenShift Elasticsearch Operator.
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
												Click the <span class="strong strong"><strong>Elasticsearch</strong></span> tab.
											</li><li class="listitem">
												Click the name of the deployment, for example <code class="literal">elasticsearch</code>.
											</li><li class="listitem">
												To view the resources created by the deployment, click the <span class="strong strong"><strong>Resources</strong></span> tab. .
											</li><li class="listitem">
												If the <code class="literal">Status</code> column any problems, check the <code class="literal">status:</code> output on the <span class="strong strong"><strong>YAML</strong></span> tab for more information.
											</li><li class="listitem">
												Navigate back to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
											</li></ol></div></li><li class="listitem"><p class="simpara">
										Select the Red Hat OpenShift distributed tracing platform (Jaeger) Operator.
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
												Click the <span class="strong strong"><strong>Jaeger</strong></span> tab.
											</li><li class="listitem">
												Click the name of your deployment, for example <code class="literal">jaeger</code>.
											</li><li class="listitem">
												To view the resources created by the deployment, click the <span class="strong strong"><strong>Resources</strong></span> tab.
											</li><li class="listitem">
												If the <code class="literal">Status</code> column indicates any problems, check the <code class="literal">status:</code> output on the <span class="strong strong"><strong>YAML</strong></span> tab for more information.
											</li><li class="listitem">
												Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
											</li></ol></div></li><li class="listitem"><p class="simpara">
										Select the Kiali Operator.
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
												Click the <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span> tab.
											</li><li class="listitem">
												Click the name of your deployment, for example <code class="literal">kiali</code>.
											</li><li class="listitem">
												To view the resources created by the deployment, click the <span class="strong strong"><strong>Resources</strong></span> tab.
											</li><li class="listitem">
												If the <code class="literal">Status</code> column any problems, check the <code class="literal">status:</code> output on the <span class="strong strong"><strong>YAML</strong></span> tab for more information.
											</li></ol></div></li></ol></div></li></ul></div><div class="orderedlist"><p class="title"><strong>From the command line</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Run the following command to see if the Service Mesh control plane pods are available and running, where <code class="literal">istio-system</code> is the namespace where you installed the SMCP.
							</p><pre class="programlisting language-terminal">$ oc get pods -n istio-system</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                   READY   STATUS    RESTARTS   AGE
grafana-6776785cfc-6fz7t               2/2     Running   0          102s
istio-egressgateway-5f49dd99-l9ppq     1/1     Running   0          103s
istio-ingressgateway-6dc885c48-jjd8r   1/1     Running   0          103s
istiod-basic-6c9cc55998-wg4zq          1/1     Running   0          2m14s
jaeger-6865d5d8bf-zrfss                2/2     Running   0          100s
kiali-579799fbb7-8mwc8                 1/1     Running   0          46s
prometheus-5c579dfb-6qhjk              2/2     Running   0          115s</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Check the status of the Service Mesh control plane deployment by using the following command. Replace <code class="literal">istio-system</code> with the namespace where you deployed the SMCP.
							</p><pre class="programlisting language-terminal">$ oc get smcp -n &lt;istio-system&gt;</pre><p class="simpara">
								The installation has finished successfully when the STATUS column is <code class="literal">ComponentsReady</code>.
							</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME    READY   STATUS            PROFILES      VERSION   AGE
basic   10/10   ComponentsReady   ["default"]   2.1.3     4m2s</pre>

								</p></div><p class="simpara">
								If you have modified and redeployed your Service Mesh control plane, the status should read <code class="literal">UpdateSuccessful</code>.
							</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME            READY     STATUS             TEMPLATE   VERSION   AGE
basic-install   10/10     UpdateSuccessful   default     v1.1     3d16h</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								If the SMCP status indicates anything other than <code class="literal">ComponentsReady</code> check the <code class="literal">status:</code> output in the SCMP resource for more information.
							</p><pre class="programlisting language-terminal">$ oc describe smcp &lt;smcp-name&gt; -n &lt;controlplane-namespace&gt;</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">$ oc describe smcp basic -n istio-system</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Check the status of the Jaeger deployment with the following command, where <code class="literal">istio-system</code> is the namespace where you deployed the SMCP.
							</p><pre class="programlisting language-terminal">$ oc get jaeger -n &lt;istio-system&gt;</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME     STATUS    VERSION   STRATEGY   STORAGE   AGE
jaeger   Running   1.30.0    allinone   memory    15m</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Check the status of the Kiali deployment with the following command, where <code class="literal">istio-system</code> is the namespace where you deployed the SMCP.
							</p><pre class="programlisting language-terminal">$ oc get kiali -n &lt;istio-system&gt;</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME    AGE
kiali   15m</pre>

								</p></div></li></ol></div><section class="section" id="ossm-accessing-kiali-console_troubleshooting-ossm"><div class="titlepage"><div><div><h5 class="title">1.22.3.1.1. Accessing the Kiali console</h5></div></div></div><p>
							You can view your application’s topology, health, and metrics in the Kiali console. If your service is experiencing problems, the Kiali console lets you view the data flow through your service. You can view insights about the mesh components at different levels, including abstract applications, services, and workloads. Kiali also provides an interactive graph view of your namespace in real time.
						</p><p>
							To access the Kiali console you must have Red Hat OpenShift Service Mesh installed, Kiali installed and configured.
						</p><p>
							The installation process creates a route to access the Kiali console.
						</p><p>
							If you know the URL for the Kiali console, you can access it directly. If you do not know the URL, use the following directions.
						</p><div class="orderedlist"><p class="title"><strong>Procedure for administrators</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									Log in to the OpenShift Container Platform web console with an administrator role.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Home</strong></span> → <span class="strong strong"><strong>Projects</strong></span>.
								</li><li class="listitem">
									On the <span class="strong strong"><strong>Projects</strong></span> page, if necessary, use the filter to find the name of your project.
								</li><li class="listitem">
									Click the name of your project, for example, <code class="literal">bookinfo</code>.
								</li><li class="listitem">
									On the <span class="strong strong"><strong>Project details</strong></span> page, in the <span class="strong strong"><strong>Launcher</strong></span> section, click the <span class="strong strong"><strong>Kiali</strong></span> link.
								</li><li class="listitem"><p class="simpara">
									Log in to the Kiali console with the same user name and password that you use to access the OpenShift Container Platform console.
								</p><p class="simpara">
									When you first log in to the Kiali Console, you see the <span class="strong strong"><strong>Overview</strong></span> page which displays all the namespaces in your service mesh that you have permission to view.
								</p><p class="simpara">
									If you are validating the console installation and namespaces have not yet been added to the mesh, there might not be any data to display other than <code class="literal">istio-system</code>.
								</p></li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure for developers</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									Log in to the OpenShift Container Platform web console with a developer role.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Project</strong></span>.
								</li><li class="listitem">
									On the <span class="strong strong"><strong>Project Details</strong></span> page, if necessary, use the filter to find the name of your project.
								</li><li class="listitem">
									Click the name of your project, for example, <code class="literal">bookinfo</code>.
								</li><li class="listitem">
									On the <span class="strong strong"><strong>Project</strong></span> page, in the <span class="strong strong"><strong>Launcher</strong></span> section, click the <span class="strong strong"><strong>Kiali</strong></span> link.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Log In With OpenShift</strong></span>.
								</li></ol></div></section><section class="section" id="ossm-accessing-jaeger-console_troubleshooting-ossm"><div class="titlepage"><div><div><h5 class="title">1.22.3.1.2. Accessing the Jaeger console</h5></div></div></div><p>
							To access the Jaeger console you must have Red Hat OpenShift Service Mesh installed, Red Hat OpenShift distributed tracing platform (Jaeger) installed and configured.
						</p><p>
							The installation process creates a route to access the Jaeger console.
						</p><p>
							If you know the URL for the Jaeger console, you can access it directly. If you do not know the URL, use the following directions.
						</p><div class="orderedlist"><p class="title"><strong>Procedure from OpenShift console</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									Log in to the OpenShift Container Platform web console as a user with cluster-admin rights. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
								</li><li class="listitem">
									Navigate to <span class="strong strong"><strong>Networking</strong></span> → <span class="strong strong"><strong>Routes</strong></span>.
								</li><li class="listitem"><p class="simpara">
									On the <span class="strong strong"><strong>Routes</strong></span> page, select the Service Mesh control plane project, for example <code class="literal">istio-system</code>, from the <span class="strong strong"><strong>Namespace</strong></span> menu.
								</p><p class="simpara">
									The <span class="strong strong"><strong>Location</strong></span> column displays the linked address for each route.
								</p></li><li class="listitem">
									If necessary, use the filter to find the <code class="literal">jaeger</code> route. Click the route <span class="strong strong"><strong>Location</strong></span> to launch the console.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Log In With OpenShift</strong></span>.
								</li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure from Kiali console</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									Launch the Kiali console.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Distributed Tracing</strong></span> in the left navigation pane.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Log In With OpenShift</strong></span>.
								</li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure from the CLI</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Log in to the OpenShift Container Platform CLI as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
								</p><pre class="programlisting language-terminal">$ oc login --username=&lt;NAMEOFUSER&gt; https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
									To query for details of the route using the command line, enter the following command. In this example, <code class="literal">istio-system</code> is the Service Mesh control plane namespace.
								</p><pre class="programlisting language-terminal">$ export JAEGER_URL=$(oc get route -n istio-system jaeger -o jsonpath='{.spec.host}')</pre></li><li class="listitem">
									Launch a browser and navigate to <code class="literal">https://&lt;JAEGER_URL&gt;</code>, where <code class="literal">&lt;JAEGER_URL&gt;</code> is the route that you discovered in the previous step.
								</li><li class="listitem">
									Log in using the same user name and password that you use to access the OpenShift Container Platform console.
								</li><li class="listitem"><p class="simpara">
									If you have added services to the service mesh and have generated traces, you can use the filters and <span class="strong strong"><strong>Find Traces</strong></span> button to search your trace data.
								</p><p class="simpara">
									If you are validating the console installation, there is no trace data to display.
								</p></li></ol></div></section></section><section class="section" id="ossm-troubleshooting-smcp_troubleshooting-ossm"><div class="titlepage"><div><div><h4 class="title">1.22.3.2. Troubleshooting the Service Mesh control plane</h4></div></div></div><p>
						If you are experiencing issues while deploying the Service Mesh control plane,
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Ensure that the <code class="literal">ServiceMeshControlPlane</code> resource is installed in a project that is separate from your services and Operators. This documentation uses the <code class="literal">istio-system</code> project as an example, but you can deploy your control plane in any project as long as it is separate from the project that contains your Operators and services.
							</li><li class="listitem">
								Ensure that the <code class="literal">ServiceMeshControlPlane</code> and <code class="literal">Jaeger</code> custom resources are deployed in the same project. For example, use the <code class="literal">istio-system</code> project for both.
							</li></ul></div></section></section><section class="section" id="troubleshooting-the-data-plane"><div class="titlepage"><div><div><h3 class="title">1.22.4. Troubleshooting the data plane</h3></div></div></div><p>
					The <span class="emphasis"><em>data plane</em></span> is a set of intelligent proxies that intercept and control all inbound and outbound network communications between services in the service mesh.
				</p><p>
					Red Hat OpenShift Service Mesh relies on a proxy sidecar within the application’s pod to provide service mesh capabilities to the application.
				</p><section class="section" id="ossm-troubleshooting-injection_troubleshooting-ossm"><div class="titlepage"><div><div><h4 class="title">1.22.4.1. Troubleshooting sidecar injection</h4></div></div></div><p>
						Red Hat OpenShift Service Mesh does not automatically inject proxy sidecars to pods. You must opt in to sidecar injection.
					</p><section class="section" id="troubleshooting-istio-sidecar-injection"><div class="titlepage"><div><div><h5 class="title">1.22.4.1.1. Troubleshooting Istio sidecar injection</h5></div></div></div><p>
							Check to see if automatic injection is enabled in the Deployment for your application. If automatic injection for the Envoy proxy is enabled, there should be a <code class="literal">sidecar.istio.io/inject:"true"</code> annotation in the <code class="literal">Deployment</code> resource under <code class="literal">spec.template.metadata.annotations</code>.
						</p></section><section class="section" id="troubleshooting-jaeger-agent-sidecar-injection"><div class="titlepage"><div><div><h5 class="title">1.22.4.1.2. Troubleshooting Jaeger agent sidecar injection</h5></div></div></div><p>
							Check to see if automatic injection is enabled in the Deployment for your application. If automatic injection for the Jaeger agent is enabled, there should be a <code class="literal">sidecar.jaegertracing.io/inject:"true"</code> annotation in the <code class="literal">Deployment</code> resource.
						</p><p>
							For more information about sidecar injection, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-automatic-sidecar-injection_deploying-applications-ossm">Enabling automatic injection</a>
						</p></section></section></section></section><section class="section" id="ossm-troubleshooting-proxy_troubleshooting-ossm"><div class="titlepage"><div><div><h2 class="title">1.23. Troubleshooting Envoy proxy</h2></div></div></div><p>
				The Envoy proxy intercepts all inbound and outbound traffic for all services in the service mesh. Envoy also collects and reports telemetry on the service mesh. Envoy is deployed as a sidecar to the relevant service in the same pod.
			</p><section class="section" id="enabling-envoy-access-logs"><div class="titlepage"><div><div><h3 class="title">1.23.1. Enabling Envoy access logs</h3></div></div></div><p>
					Envoy access logs are useful in diagnosing traffic failures and flows, and help with end-to-end traffic flow analysis.
				</p><p>
					To enable access logging for all istio-proxy containers, edit the <code class="literal">ServiceMeshControlPlane</code> (SMCP) object to add a file name for the logging output.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Log in to the OpenShift Container Platform CLI as a user with the cluster-admin role. Enter the following command. Then, enter your username and password when prompted.
						</p><pre class="programlisting language-terminal">$ oc login --username=&lt;NAMEOFUSER&gt; https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
							Change to the project where you installed the Service Mesh control plane, for example <code class="literal">istio-system</code>.
						</p><pre class="programlisting language-terminal">$ oc project istio-system</pre></li><li class="listitem"><p class="simpara">
							Edit the <code class="literal">ServiceMeshControlPlane</code> file.
						</p><pre class="programlisting language-terminal">$ oc edit smcp &lt;smcp_name&gt;</pre></li><li class="listitem"><p class="simpara">
							As show in the following example, use <code class="literal">name</code> to specify the file name for the proxy log. If you do not specify a value for <code class="literal">name</code>, no log entries will be written.
						</p><pre class="programlisting language-yaml">spec:
  proxy:
    accessLogging:
      file:
        name: /dev/stdout     #file name</pre></li></ol></div><p>
					For more information about troubleshooting pod issues, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/support/#investigating-pod-issues-1">Investigating pod issues</a>
				</p></section><section class="section" id="support_troubleshooting-ossm"><div class="titlepage"><div><div><h3 class="title">1.23.2. Getting support</h3></div></div></div><p>
					If you experience difficulty with a procedure described in this documentation, or with OpenShift Container Platform in general, visit the <a class="link" href="http://access.redhat.com">Red Hat Customer Portal</a>. From the Customer Portal, you can:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Search or browse through the Red Hat Knowledgebase of articles and solutions relating to Red Hat products.
						</li><li class="listitem">
							Submit a support case to Red Hat Support.
						</li><li class="listitem">
							Access other product documentation.
						</li></ul></div><p>
					To identify issues with your cluster, you can use Insights in <a class="link" href="https://console.redhat.com/openshift">OpenShift Cluster Manager Hybrid Cloud Console</a>. Insights provides details about issues and, if available, information on how to solve a problem.
				</p><p>
					If you have a suggestion for improving this documentation or have found an error, submit a <a class="link" href="https://issues.redhat.com/secure/CreateIssueDetails!init.jspa?pid=12332330&amp;summary=Documentation_issue&amp;issuetype=1&amp;components=12367614&amp;priority=10200&amp;versions=12391126">Jira issue</a> for the most relevant documentation component. Please provide specific details, such as the section name and OpenShift Container Platform version.
				</p><section class="section" id="support-knowledgebase-about_troubleshooting-ossm"><div class="titlepage"><div><div><h4 class="title">1.23.2.1. About the Red Hat Knowledgebase</h4></div></div></div><p>
						The <a class="link" href="https://access.redhat.com/knowledgebase">Red Hat Knowledgebase</a> provides rich content aimed at helping you make the most of Red Hat’s products and technologies. The Red Hat Knowledgebase consists of articles, product documentation, and videos outlining best practices on installing, configuring, and using Red Hat products. In addition, you can search for solutions to known issues, each providing concise root cause descriptions and remedial steps.
					</p></section><section class="section" id="support-knowledgebase-search_troubleshooting-ossm"><div class="titlepage"><div><div><h4 class="title">1.23.2.2. Searching the Red Hat Knowledgebase</h4></div></div></div><p>
						In the event of an OpenShift Container Platform issue, you can perform an initial search to determine if a solution already exists within the Red Hat Knowledgebase.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have a Red Hat Customer Portal account.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the <a class="link" href="http://access.redhat.com">Red Hat Customer Portal</a>.
							</li><li class="listitem"><p class="simpara">
								In the main Red Hat Customer Portal search field, input keywords and strings relating to the problem, including:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										OpenShift Container Platform components (such as <span class="strong strong"><strong>etcd</strong></span>)
									</li><li class="listitem">
										Related procedure (such as <span class="strong strong"><strong>installation</strong></span>)
									</li><li class="listitem">
										Warnings, error messages, and other outputs related to explicit failures
									</li></ul></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Search</strong></span>.
							</li><li class="listitem">
								Select the <span class="strong strong"><strong>OpenShift Container Platform</strong></span> product filter.
							</li><li class="listitem">
								Select the <span class="strong strong"><strong>Knowledgebase</strong></span> content type filter.
							</li></ol></div></section><section class="section" id="ossm-about-collecting-ossm-data_troubleshooting-ossm"><div class="titlepage"><div><div><h4 class="title">1.23.2.3. About collecting service mesh data</h4></div></div></div><p>
						You can use the <code class="literal">oc adm must-gather</code> CLI command to collect information about your cluster, including features and objects associated with Red Hat OpenShift Service Mesh.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
							</li><li class="listitem">
								The OpenShift Container Platform CLI (<code class="literal">oc</code>) installed.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To collect Red Hat OpenShift Service Mesh data with <code class="literal">must-gather</code>, you must specify the Red Hat OpenShift Service Mesh image.
							</p><pre class="programlisting language-terminal">$ oc adm must-gather --image=registry.redhat.io/openshift-service-mesh/istio-must-gather-rhel8:2.4</pre></li><li class="listitem"><p class="simpara">
								To collect Red Hat OpenShift Service Mesh data for a specific Service Mesh control plane namespace with <code class="literal">must-gather</code>, you must specify the Red Hat OpenShift Service Mesh image and namespace. In this example, after <code class="literal">gather,</code> replace <code class="literal">&lt;namespace&gt;</code> with your Service Mesh control plane namespace, such as <code class="literal">istio-system</code>.
							</p><pre class="programlisting language-terminal">$ oc adm must-gather --image=registry.redhat.io/openshift-service-mesh/istio-must-gather-rhel8:2.4 gather &lt;namespace&gt;</pre><p class="simpara">
								This creates a local directory that contains the following items:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										The Istio Operator namespace and its child objects
									</li><li class="listitem">
										All control plane namespaces and their children objects
									</li><li class="listitem">
										All namespaces and their children objects that belong to any service mesh
									</li><li class="listitem">
										All Istio custom resource definitions (CRD)
									</li><li class="listitem">
										All Istio CRD objectsm such as VirtualServices in a given namespace
									</li><li class="listitem">
										All Istio webhooks
									</li></ul></div></li></ol></div><p>
						For prompt support, supply diagnostic information for both OpenShift Container Platform and Red Hat OpenShift Service Mesh.
					</p></section><section class="section" id="support-submitting-a-case_troubleshooting-ossm"><div class="titlepage"><div><div><h4 class="title">1.23.2.4. Submitting a support case</h4></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
							</li><li class="listitem">
								You have installed the OpenShift CLI (<code class="literal">oc</code>).
							</li><li class="listitem">
								You have a Red Hat Customer Portal account.
							</li><li class="listitem">
								You have a Red Hat standard or premium Subscription.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the <a class="link" href="http://access.redhat.com">Red Hat Customer Portal</a> and select <span class="strong strong"><strong>SUPPORT CASES</strong></span> → <span class="strong strong"><strong>Open a case</strong></span>.
							</li><li class="listitem">
								Select the appropriate category for your issue (such as <span class="strong strong"><strong>Defect / Bug</strong></span>), product (<span class="strong strong"><strong>OpenShift Container Platform</strong></span>), and product version (<span class="strong strong"><strong>4.13</strong></span>, if this is not already autofilled).
							</li><li class="listitem">
								Review the list of suggested Red Hat Knowledgebase solutions for a potential match against the problem that is being reported. If the suggested articles do not address the issue, click <span class="strong strong"><strong>Continue</strong></span>.
							</li><li class="listitem">
								Enter a concise but descriptive problem summary and further details about the symptoms being experienced, as well as your expectations.
							</li><li class="listitem">
								Review the updated list of suggested Red Hat Knowledgebase solutions for a potential match against the problem that is being reported. The list is refined as you provide more information during the case creation process. If the suggested articles do not address the issue, click <span class="strong strong"><strong>Continue</strong></span>.
							</li><li class="listitem">
								Ensure that the account information presented is as expected, and if not, amend accordingly.
							</li><li class="listitem"><p class="simpara">
								Check that the autofilled OpenShift Container Platform Cluster ID is correct. If it is not, manually obtain your cluster ID.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										To manually obtain your cluster ID using the OpenShift Container Platform web console:
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
												Navigate to <span class="strong strong"><strong>Home</strong></span> → <span class="strong strong"><strong>Dashboards</strong></span> → <span class="strong strong"><strong>Overview</strong></span>.
											</li><li class="listitem">
												Find the value in the <span class="strong strong"><strong>Cluster ID</strong></span> field of the <span class="strong strong"><strong>Details</strong></span> section.
											</li></ol></div></li><li class="listitem"><p class="simpara">
										Alternatively, it is possible to open a new support case through the OpenShift Container Platform web console and have your cluster ID autofilled.
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
												From the toolbar, navigate to <span class="strong strong"><strong>(?) Help</strong></span> → <span class="strong strong"><strong>Open Support Case</strong></span>.
											</li><li class="listitem">
												The <span class="strong strong"><strong>Cluster ID</strong></span> value is autofilled.
											</li></ol></div></li><li class="listitem"><p class="simpara">
										To obtain your cluster ID using the OpenShift CLI (<code class="literal">oc</code>), run the following command:
									</p><pre class="programlisting language-terminal">$ oc get clusterversion -o jsonpath='{.items[].spec.clusterID}{"\n"}'</pre></li></ul></div></li><li class="listitem"><p class="simpara">
								Complete the following questions where prompted and then click <span class="strong strong"><strong>Continue</strong></span>:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Where are you experiencing the behavior? What environment?
									</li><li class="listitem">
										When does the behavior occur? Frequency? Repeatedly? At certain times?
									</li><li class="listitem">
										What information can you provide around time-frames and the business impact?
									</li></ul></div></li><li class="listitem">
								Upload relevant diagnostic data files and click <span class="strong strong"><strong>Continue</strong></span>. It is recommended to include data gathered using the <code class="literal">oc adm must-gather</code> command as a starting point, plus any issue specific data that is not collected by that command.
							</li><li class="listitem">
								Input relevant case management details and click <span class="strong strong"><strong>Continue</strong></span>.
							</li><li class="listitem">
								Preview the case details and click <span class="strong strong"><strong>Submit</strong></span>.
							</li></ol></div></section></section></section><section class="section" id="ossm-reference"><div class="titlepage"><div><div><h2 class="title">1.24. Service Mesh control plane configuration reference</h2></div></div></div><p>
				You can customize your Red Hat OpenShift Service Mesh by modifying the default <code class="literal">ServiceMeshControlPlane</code> (SMCP) resource or by creating a completely custom SMCP resource. This reference section documents the configuration options available for the SMCP resource.
			</p><section class="section" id="ossm-cr-example_ossm-reference"><div class="titlepage"><div><div><h3 class="title">1.24.1. Service Mesh Control plane parameters</h3></div></div></div><p>
					The following table lists the top-level parameters for the <code class="literal">ServiceMeshControlPlane</code> resource.
				</p><div class="table" id="idm140663646924512"><p class="title"><strong>Table 1.31. <code class="literal">ServiceMeshControlPlane</code> resource parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663646918432" scope="col">Name</th><th align="left" valign="top" id="idm140663646917344" scope="col">Description</th><th align="left" valign="top" id="idm140663646916256" scope="col">Type</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663646918432"> <p>
									<code class="literal">apiVersion</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663646917344"> <p>
									APIVersion defines the versioned schema of this representation of an object. Servers convert recognized schemas to the latest internal value, and may reject unrecognized values. The value for the <code class="literal">ServiceMeshControlPlane</code> version 2.0 is <code class="literal">maistra.io/v2</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140663646916256"> <p>
									The value for <code class="literal">ServiceMeshControlPlane</code> version 2.0 is <code class="literal">maistra.io/v2</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663646918432"> <p>
									<code class="literal">kind</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663646917344"> <p>
									Kind is a string value that represents the REST resource this object represents.
								</p>
								 </td><td align="left" valign="top" headers="idm140663646916256"> <p>
									<code class="literal">ServiceMeshControlPlane</code> is the only valid value for a ServiceMeshControlPlane.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663646918432"> <p>
									<code class="literal">metadata</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663646917344"> <p>
									Metadata about this <code class="literal">ServiceMeshControlPlane</code> instance. You can provide a name for your Service Mesh control plane installation to keep track of your work, for example, <code class="literal">basic</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140663646916256"> <p>
									string
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663646918432"> <p>
									<code class="literal">spec</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663646917344"> <p>
									The specification of the desired state of this <code class="literal">ServiceMeshControlPlane</code>. This includes the configuration options for all components that comprise the Service Mesh control plane.
								</p>
								 </td><td align="left" valign="top" headers="idm140663646916256"> <p>
									For more information, see Table 2.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663646918432"> <p>
									<code class="literal">status</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663646917344"> <p>
									The current status of this <code class="literal">ServiceMeshControlPlane</code> and the components that comprise the Service Mesh control plane.
								</p>
								 </td><td align="left" valign="top" headers="idm140663646916256"> <p>
									For more information, see Table 3.
								</p>
								 </td></tr></tbody></table></div></div><p>
					The following table lists the specifications for the <code class="literal">ServiceMeshControlPlane</code> resource. Changing these parameters configures Red Hat OpenShift Service Mesh components.
				</p><div class="table" id="idm140663647625168"><p class="title"><strong>Table 1.32. <code class="literal">ServiceMeshControlPlane</code> resource spec</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663647619088" scope="col">Name</th><th align="left" valign="top" id="idm140663647618000" scope="col">Description</th><th align="left" valign="top" id="idm140663647616912" scope="col">Configurable parameters</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663647619088"> <p>
									<code class="literal">addons</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663647618000"> <p>
									The <code class="literal">addons</code> parameter configures additional features beyond core Service Mesh control plane components, such as visualization, or metric storage.
								</p>
								 </td><td align="left" valign="top" headers="idm140663647616912"> <p>
									<code class="literal">3scale</code>, <code class="literal">grafana</code>, <code class="literal">jaeger</code>, <code class="literal">kiali</code>, and <code class="literal">prometheus</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663647619088"> <p>
									<code class="literal">cluster</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663647618000"> <p>
									The <code class="literal">cluster</code> parameter sets the general configuration of the cluster (cluster name, network name, multi-cluster, mesh expansion, etc.)
								</p>
								 </td><td align="left" valign="top" headers="idm140663647616912"> <p>
									<code class="literal">meshExpansion</code>, <code class="literal">multiCluster</code>, <code class="literal">name</code>, and <code class="literal">network</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663647619088"> <p>
									<code class="literal">gateways</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663647618000"> <p>
									You use the <code class="literal">gateways</code> parameter to configure ingress and egress gateways for the mesh.
								</p>
								 </td><td align="left" valign="top" headers="idm140663647616912"> <p>
									<code class="literal">enabled</code>, <code class="literal">additionalEgress</code>, <code class="literal">additionalIngress</code>, <code class="literal">egress</code>, <code class="literal">ingress</code>, and <code class="literal">openshiftRoute</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663647619088"> <p>
									<code class="literal">general</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663647618000"> <p>
									The <code class="literal">general</code> parameter represents general Service Mesh control plane configuration that does not fit anywhere else.
								</p>
								 </td><td align="left" valign="top" headers="idm140663647616912"> <p>
									<code class="literal">logging</code> and <code class="literal">validationMessages</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663647619088"> <p>
									<code class="literal">policy</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663647618000"> <p>
									You use the <code class="literal">policy</code> parameter to configure policy checking for the Service Mesh control plane. Policy checking can be enabled by setting <code class="literal">spec.policy.enabled</code> to <code class="literal">true</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140663647616912"> <p>
									<code class="literal">mixer</code> <code class="literal">remote</code>, or <code class="literal">type</code>. <code class="literal">type</code> can be set to <code class="literal">Istiod</code>, <code class="literal">Mixer</code> or <code class="literal">None</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663647619088"> <p>
									<code class="literal">profiles</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663647618000"> <p>
									You select the <code class="literal">ServiceMeshControlPlane</code> profile to use for default values using the <code class="literal">profiles</code> parameter.
								</p>
								 </td><td align="left" valign="top" headers="idm140663647616912"> <p>
									<code class="literal">default</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663647619088"> <p>
									<code class="literal">proxy</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663647618000"> <p>
									You use the <code class="literal">proxy</code> parameter to configure the default behavior for sidecars.
								</p>
								 </td><td align="left" valign="top" headers="idm140663647616912"> <p>
									<code class="literal">accessLogging</code>, <code class="literal">adminPort</code>, <code class="literal">concurrency</code>, and <code class="literal">envoyMetricsService</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663647619088"> <p>
									<code class="literal">runtime</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663647618000"> <p>
									You use the <code class="literal">runtime</code> parameter to configure the Service Mesh control plane components.
								</p>
								 </td><td align="left" valign="top" headers="idm140663647616912"> <p>
									<code class="literal">components</code>, and <code class="literal">defaults</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663647619088"> <p>
									<code class="literal">security</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663647618000"> <p>
									The <code class="literal">security</code> parameter allows you to configure aspects of security for the Service Mesh control plane.
								</p>
								 </td><td align="left" valign="top" headers="idm140663647616912"> <p>
									<code class="literal">certificateAuthority</code>, <code class="literal">controlPlane</code>, <code class="literal">identity</code>, <code class="literal">dataPlane</code> and <code class="literal">trust</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663647619088"> <p>
									<code class="literal">techPreview</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663647618000"> <p>
									The <code class="literal">techPreview</code> parameter enables early access to features that are in technology preview.
								</p>
								 </td><td align="left" valign="top" headers="idm140663647616912"> <p>
									N/A
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663647619088"> <p>
									<code class="literal">telemetry</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663647618000"> <p>
									If <code class="literal">spec.mixer.telemetry.enabled</code> is set to <code class="literal">true</code>, telemetry is enabled.
								</p>
								 </td><td align="left" valign="top" headers="idm140663647616912"> <p>
									<code class="literal">mixer</code>, <code class="literal">remote</code>, and <code class="literal">type</code>. <code class="literal">type</code> can be set to <code class="literal">Istiod</code>, <code class="literal">Mixer</code> or <code class="literal">None</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663647619088"> <p>
									<code class="literal">tracing</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663647618000"> <p>
									You use the <code class="literal">tracing</code> parameter to enables distributed tracing for the mesh.
								</p>
								 </td><td align="left" valign="top" headers="idm140663647616912"> <p>
									<code class="literal">sampling</code>, <code class="literal">type</code>. <code class="literal">type</code> can be set to <code class="literal">Jaeger</code> or <code class="literal">None</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663647619088"> <p>
									<code class="literal">version</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663647618000"> <p>
									You use the <code class="literal">version</code> parameter to specify what Maistra version of the Service Mesh control plane to install. When creating a <code class="literal">ServiceMeshControlPlane</code> with an empty version, the admission webhook sets the version to the current version. New <code class="literal">ServiceMeshControlPlanes</code> with an empty version are set to <code class="literal">v2.0</code>. Existing <code class="literal">ServiceMeshControlPlanes</code> with an empty version keep their setting.
								</p>
								 </td><td align="left" valign="top" headers="idm140663647616912"> <p>
									string
								</p>
								 </td></tr></tbody></table></div></div><p>
					<code class="literal">ControlPlaneStatus</code> represents the current state of your service mesh.
				</p><div class="table" id="idm140663668294944"><p class="title"><strong>Table 1.33. <code class="literal">ServiceMeshControlPlane</code> resource <code class="literal">ControlPlaneStatus</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663668288544" scope="col">Name</th><th align="left" valign="top" id="idm140663668287456" scope="col">Description</th><th align="left" valign="top" id="idm140663668286368" scope="col">Type</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663668288544"> <p>
									<code class="literal">annotations</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663668287456"> <p>
									The <code class="literal">annotations</code> parameter stores additional, usually redundant status information, such as the number of components deployed by the <code class="literal">ServiceMeshControlPlane</code>. These statuses are used by the command line tool, <code class="literal">oc</code>, which does not yet allow counting objects in JSONPath expressions.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668286368"> <p>
									Not configurable
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663668288544"> <p>
									<code class="literal">conditions</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663668287456"> <p>
									Represents the latest available observations of the object’s current state. <code class="literal">Reconciled</code> indicates whether the operator has finished reconciling the actual state of deployed components with the configuration in the <code class="literal">ServiceMeshControlPlane</code> resource. <code class="literal">Installed</code> indicates whether the Service Mesh control plane has been installed. <code class="literal">Ready</code> indicates whether all Service Mesh control plane components are ready.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668286368"> <p>
									string
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663668288544"> <p>
									<code class="literal">components</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663668287456"> <p>
									Shows the status of each deployed Service Mesh control plane component.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668286368"> <p>
									string
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663668288544"> <p>
									<code class="literal">appliedSpec</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663668287456"> <p>
									The resulting specification of the configuration options after all profiles have been applied.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668286368"> <p>
									<code class="literal">ControlPlaneSpec</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663668288544"> <p>
									<code class="literal">appliedValues</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663668287456"> <p>
									The resulting values.yaml used to generate the charts.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668286368"> <p>
									<code class="literal">ControlPlaneSpec</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663668288544"> <p>
									<code class="literal">chartVersion</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663668287456"> <p>
									The version of the charts that were last processed for this resource.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668286368"> <p>
									string
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663668288544"> <p>
									<code class="literal">observedGeneration</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663668287456"> <p>
									The generation observed by the controller during the most recent reconciliation. The information in the status pertains to this particular generation of the object. The <code class="literal">status.conditions</code> are not up-to-date if the <code class="literal">status.observedGeneration</code> field doesn’t match <code class="literal">metadata.generation</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668286368"> <p>
									integer
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663668288544"> <p>
									<code class="literal">operatorVersion</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663668287456"> <p>
									The version of the operator that last processed this resource.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668286368"> <p>
									string
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663668288544"> <p>
									<code class="literal">readiness</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663668287456"> <p>
									The readiness status of components &amp; owned resources.
								</p>
								 </td><td align="left" valign="top" headers="idm140663668286368"> <p>
									string
								</p>
								 </td></tr></tbody></table></div></div><p>
					This example <code class="literal">ServiceMeshControlPlane</code> definition contains all of the supported parameters.
				</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">ServiceMeshControlPlane</code> resource</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
spec:
  version: v2.4
  proxy:
    runtime:
      container:
        resources:
          requests:
            cpu: 100m
            memory: 128Mi
          limits:
            cpu: 500m
            memory: 128Mi
  tracing:
    type: Jaeger
  gateways:
    ingress: # istio-ingressgateway
      service:
        type: ClusterIP
        ports:
        - name: status-port
          port: 15020
        - name: http2
          port: 80
          targetPort: 8080
        - name: https
          port: 443
          targetPort: 8443
      meshExpansionPorts: []
    egress: # istio-egressgateway
      service:
        type: ClusterIP
        ports:
        - name: status-port
          port: 15020
        - name: http2
          port: 80
          targetPort: 8080
        - name: https
          port: 443
          targetPort: 8443
    additionalIngress:
      some-other-ingress-gateway: {}
    additionalEgress:
      some-other-egress-gateway: {}

  policy:
    type: Mixer
    mixer: # only applies if policy.type: Mixer
      enableChecks: true
      failOpen: false

  telemetry:
    type: Istiod # or Mixer
    mixer: # only applies if telemetry.type: Mixer, for v1 telemetry
      sessionAffinity: false
      batching:
        maxEntries: 100
        maxTime: 1s
      adapters:
        kubernetesenv: true
        stdio:
          enabled: true
          outputAsJSON: true
  addons:
    grafana:
      enabled: true
      install:
        config:
          env: {}
          envSecrets: {}
        persistence:
          enabled: true
          storageClassName: ""
          accessMode: ReadWriteOnce
          capacity:
            requests:
              storage: 5Gi
        service:
          ingress:
            contextPath: /grafana
            tls:
              termination: reencrypt
    kiali:
      name: kiali
      enabled: true
      install: # install kiali CR if not present
        dashboard:
          viewOnly: false
          enableGrafana: true
          enableTracing: true
          enablePrometheus: true
      service:
        ingress:
          contextPath: /kiali
    jaeger:
      name: jaeger
      install:
        storage:
          type: Elasticsearch # or Memory
          memory:
            maxTraces: 100000
          elasticsearch:
            nodeCount: 3
            storage: {}
            redundancyPolicy: SingleRedundancy
            indexCleaner: {}
        ingress: {} # jaeger ingress configuration
  runtime:
    components:
      pilot:
        deployment:
          replicas: 2
        pod:
          affinity: {}
        container:
          resources:
            requests:
              cpu: 100m
              memory: 128Mi
            limits:
              cpu: 500m
              memory: 128Mi
      grafana:
        deployment: {}
        pod: {}
      kiali:
        deployment: {}
        pod: {}</pre>

					</p></div></section><section class="section" id="spec-parameters"><div class="titlepage"><div><div><h3 class="title">1.24.2. spec parameters</h3></div></div></div><section class="section" id="ossm-cr-general_ossm-reference"><div class="titlepage"><div><div><h4 class="title">1.24.2.1. general parameters</h4></div></div></div><p>
						Here is an example that illustrates the <code class="literal">spec.general</code> parameters for the <code class="literal">ServiceMeshControlPlane</code> object and a description of the available parameters with appropriate values.
					</p><div class="formalpara"><p class="title"><strong>Example general parameters</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
spec:
  general:
    logging:
      componentLevels: {}
          # misc: error
      logAsJSON: false
    validationMessages: true</pre>

						</p></div><div class="table" id="idm140663648058112"><p class="title"><strong>Table 1.34. Istio general parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663648051408" scope="col">Parameter</th><th align="left" valign="top" id="idm140663648050320" scope="col">Description</th><th align="left" valign="top" id="idm140663648049232" scope="col">Values</th><th align="left" valign="top" id="idm140663648048144" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663648051408">
<pre class="literallayout">logging:</pre>
									 </td><td align="left" valign="top" headers="idm140663648050320"> <p>
										Use to configure logging for the Service Mesh control plane components.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648049232"> </td><td align="left" valign="top" headers="idm140663648048144"> <p>
										N/A
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648051408">
<pre class="literallayout">logging:
 componentLevels:</pre>
									 </td><td align="left" valign="top" headers="idm140663648050320"> <p>
										Use to specify the component logging level.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648049232"> <p>
										Possible values: <code class="literal">trace</code>, <code class="literal">debug</code>, <code class="literal">info</code>, <code class="literal">warning</code>, <code class="literal">error</code>, <code class="literal">fatal</code>, <code class="literal">panic</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648048144"> <p>
										N/A
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648051408">
<pre class="literallayout">logging:
 logAsJSON:</pre>
									 </td><td align="left" valign="top" headers="idm140663648050320"> <p>
										Use to enable or disable JSON logging.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648049232"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648048144"> <p>
										N/A
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648051408">
<pre class="literallayout">validationMessages:</pre>
									 </td><td align="left" valign="top" headers="idm140663648050320"> <p>
										Use to enable or disable validation messages to the status fields of istio.io resources. This can be useful for detecting configuration errors in resources.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648049232"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648048144"> <p>
										N/A
									</p>
									 </td></tr></tbody></table></div></div></section><section class="section" id="ossm-cr-profiles_ossm-reference"><div class="titlepage"><div><div><h4 class="title">1.24.2.2. profiles parameters</h4></div></div></div><p>
						You can create reusable configurations with <code class="literal">ServiceMeshControlPlane</code> object profiles. If you do not configure the <code class="literal">profile</code> setting, Red Hat OpenShift Service Mesh uses the default profile.
					</p><p>
						Here is an example that illustrates the <code class="literal">spec.profiles</code> parameter for the <code class="literal">ServiceMeshControlPlane</code> object:
					</p><div class="formalpara"><p class="title"><strong>Example profiles parameters</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
spec:
  profiles:
  - YourProfileName</pre>

						</p></div><p>
						For information about creating profiles, see the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-control-plane-profiles_ossm-profiles-users">Creating control plane profiles</a>.
					</p><p>
						For more detailed examples of security configuration, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-security-mtls_ossm-security">Mutual Transport Layer Security (mTLS)</a>.
					</p></section><section class="section" id="ossm-cr-techPreview_ossm-reference"><div class="titlepage"><div><div><h4 class="title">1.24.2.3. techPreview parameters</h4></div></div></div><p>
						The <code class="literal">spec.techPreview</code> parameter enables early access to features that are in Technology Preview.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
						</p><p>
							For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
						</p></div></div></section><section class="section" id="ossm-cr-tracing_ossm-reference"><div class="titlepage"><div><div><h4 class="title">1.24.2.4. tracing parameters</h4></div></div></div><p>
						The following example illustrates the <code class="literal">spec.tracing</code> parameters for the <code class="literal">ServiceMeshControlPlane</code> object, and a description of the available parameters with appropriate values.
					</p><div class="formalpara"><p class="title"><strong>Example tracing parameters</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
spec:
  version: v2.4
  tracing:
    sampling: 100
    type: Jaeger</pre>

						</p></div><div class="table" id="idm140663647636144"><p class="title"><strong>Table 1.35. Istio tracing parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663647629440" scope="col">Parameter</th><th align="left" valign="top" id="idm140663647628352" scope="col">Description</th><th align="left" valign="top" id="idm140663647627264" scope="col">Values</th><th align="left" valign="top" id="idm140663648456416" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663647629440">
<pre class="literallayout">tracing:
 sampling:</pre>
									 </td><td align="left" valign="top" headers="idm140663647628352"> <p>
										The sampling rate determines how often the Envoy proxy generates a trace. You use the sampling rate to control what percentage of requests get reported to your tracing system.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647627264"> <p>
										Integer values between 0 and 10000 representing increments of 0.01% (0 to 100%). For example, setting the value to <code class="literal">10</code> samples 0.1% of requests, setting the value to <code class="literal">100</code> will sample 1% of requests setting the value to <code class="literal">500</code> samples 5% of requests, and a setting of <code class="literal">10000</code> samples 100% of requests.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648456416"> <p>
										<code class="literal">10000</code> (100% of traces)
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663647629440">
<pre class="literallayout">tracing:
 type:</pre>
									 </td><td align="left" valign="top" headers="idm140663647628352"> <p>
										Currently the only tracing type that is supported is <code class="literal">Jaeger</code>. Jaeger is enabled by default. To disable tracing, set the <code class="literal">type</code> parameter to <code class="literal">None</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647627264"> <p>
										<code class="literal">None</code>, <code class="literal">Jaeger</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648456416"> <p>
										<code class="literal">Jaeger</code>
									</p>
									 </td></tr></tbody></table></div></div></section><section class="section" id="ossm-cr-version_ossm-reference"><div class="titlepage"><div><div><h4 class="title">1.24.2.5. version parameter</h4></div></div></div><p>
						The Red Hat OpenShift Service Mesh Operator supports installation of different versions of the <code class="literal">ServiceMeshControlPlane</code>. You use the version parameter to specify what version of the Service Mesh control plane to install. If you do not specify a version parameter when creating your SMCP, the Operator sets the value to the latest version: (2.4). Existing <code class="literal">ServiceMeshControlPlane</code> objects keep their version setting during upgrades of the Operator.
					</p></section><section class="section" id="ossm-cr-threescale_ossm-reference"><div class="titlepage"><div><div><h4 class="title">1.24.2.6. 3scale configuration</h4></div></div></div><p>
						The following table explains the parameters for the 3scale Istio Adapter in the <code class="literal">ServiceMeshControlPlane</code> resource.
					</p><div class="formalpara"><p class="title"><strong>Example 3scale parameters</strong></p><p>
							
<pre class="programlisting language-yaml">spec:
  addons:
    3Scale:
      enabled: false
      PARAM_THREESCALE_LISTEN_ADDR: 3333
      PARAM_THREESCALE_LOG_LEVEL: info
      PARAM_THREESCALE_LOG_JSON: true
      PARAM_THREESCALE_LOG_GRPC: false
      PARAM_THREESCALE_REPORT_METRICS: true
      PARAM_THREESCALE_METRICS_PORT: 8080
      PARAM_THREESCALE_CACHE_TTL_SECONDS: 300
      PARAM_THREESCALE_CACHE_REFRESH_SECONDS: 180
      PARAM_THREESCALE_CACHE_ENTRIES_MAX: 1000
      PARAM_THREESCALE_CACHE_REFRESH_RETRIES: 1
      PARAM_THREESCALE_ALLOW_INSECURE_CONN: false
      PARAM_THREESCALE_CLIENT_TIMEOUT_SECONDS: 10
      PARAM_THREESCALE_GRPC_CONN_MAX_SECONDS: 60
      PARAM_USE_CACHED_BACKEND: false
      PARAM_BACKEND_CACHE_FLUSH_INTERVAL_SECONDS: 15
      PARAM_BACKEND_CACHE_POLICY_FAIL_CLOSED: true</pre>

						</p></div><div class="table" id="idm140663648425216"><p class="title"><strong>Table 1.36. 3scale parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663648418528" scope="col">Parameter</th><th align="left" valign="top" id="idm140663648417440" scope="col">Description</th><th align="left" valign="top" id="idm140663648416352" scope="col">Values</th><th align="left" valign="top" id="idm140663648415264" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">enabled</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										Whether to use the 3scale adapter
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										<code class="literal">false</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">PARAM_THREESCALE_LISTEN_ADDR</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										Sets the listen address for the gRPC server
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										Valid port number
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										<code class="literal">3333</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">PARAM_THREESCALE_LOG_LEVEL</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										Sets the minimum log output level.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										<code class="literal">debug</code>, <code class="literal">info</code>, <code class="literal">warn</code>, <code class="literal">error</code>, or <code class="literal">none</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										<code class="literal">info</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">PARAM_THREESCALE_LOG_JSON</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										Controls whether the log is formatted as JSON
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										<code class="literal">true</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">PARAM_THREESCALE_LOG_GRPC</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										Controls whether the log contains gRPC info
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										<code class="literal">true</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">PARAM_THREESCALE_REPORT_METRICS</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										Controls whether 3scale system and backend metrics are collected and reported to Prometheus
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										<code class="literal">true</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">PARAM_THREESCALE_METRICS_PORT</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										Sets the port that the 3scale <code class="literal">/metrics</code> endpoint can be scrapped from
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										Valid port number
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										<code class="literal">8080</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">PARAM_THREESCALE_CACHE_TTL_SECONDS</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										Time period, in seconds, to wait before purging expired items from the cache
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										Time period in seconds
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										<code class="literal">300</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">PARAM_THREESCALE_CACHE_REFRESH_SECONDS</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										Time period before expiry when cache elements are attempted to be refreshed
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										Time period in seconds
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										<code class="literal">180</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">PARAM_THREESCALE_CACHE_ENTRIES_MAX</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										Max number of items that can be stored in the cache at any time. Set to <code class="literal">0</code> to disable caching
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										Valid number
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										<code class="literal">1000</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">PARAM_THREESCALE_CACHE_REFRESH_RETRIES</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										The number of times unreachable hosts are retried during a cache update loop
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										Valid number
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										<code class="literal">1</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">PARAM_THREESCALE_ALLOW_INSECURE_CONN</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										Allow to skip certificate verification when calling <code class="literal">3scale</code> APIs. Enabling this is not recommended.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										<code class="literal">false</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">PARAM_THREESCALE_CLIENT_TIMEOUT_SECONDS</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										Sets the number of seconds to wait before terminating requests to 3scale System and Backend
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										Time period in seconds
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										<code class="literal">10</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">PARAM_THREESCALE_GRPC_CONN_MAX_SECONDS</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										Sets the maximum amount of seconds (+/-10% jitter) a connection may exist before it is closed
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										Time period in seconds
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										60
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">PARAM_USE_CACHE_BACKEND</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										If true, attempt to create an in-memory apisonator cache for authorization requests
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										<code class="literal">false</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">PARAM_BACKEND_CACHE_FLUSH_INTERVAL_SECONDS</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										If the backend cache is enabled, this sets the interval in seconds for flushing the cache against 3scale
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										Time period in seconds
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										15
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648418528"> <p>
										<code class="literal">PARAM_BACKEND_CACHE_POLICY_FAIL_CLOSED</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648417440"> <p>
										Whenever the backend cache cannot retrieve authorization data, whether to deny (closed) or allow (open) requests
									</p>
									 </td><td align="left" valign="top" headers="idm140663648416352"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663648415264"> <p>
										<code class="literal">true</code>
									</p>
									 </td></tr></tbody></table></div></div></section></section><section class="section" id="ossm-cr-status_ossm-reference"><div class="titlepage"><div><div><h3 class="title">1.24.3. status parameter</h3></div></div></div><p>
					The <code class="literal">status</code> parameter describes the current state of your service mesh. This information is generated by the Operator and is read-only.
				</p><div class="table" id="idm140663646636704"><p class="title"><strong>Table 1.37. Istio status parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663646630944" scope="col">Name</th><th align="left" valign="top" id="idm140663646629856" scope="col">Description</th><th align="left" valign="top" id="idm140663646628768" scope="col">Type</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663646630944"> <p>
									<code class="literal">observedGeneration</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663646629856"> <p>
									The generation observed by the controller during the most recent reconciliation. The information in the status pertains to this particular generation of the object. The <code class="literal">status.conditions</code> are not up-to-date if the <code class="literal">status.observedGeneration</code> field doesn’t match <code class="literal">metadata.generation</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140663646628768"> <p>
									integer
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663646630944"> <p>
									<code class="literal">annotations</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663646629856"> <p>
									The <code class="literal">annotations</code> parameter stores additional, usually redundant status information, such as the number of components deployed by the <code class="literal">ServiceMeshControlPlane</code> object. These statuses are used by the command line tool, <code class="literal">oc</code>, which does not yet allow counting objects in JSONPath expressions.
								</p>
								 </td><td align="left" valign="top" headers="idm140663646628768"> <p>
									Not configurable
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663646630944"> <p>
									<code class="literal">readiness</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663646629856"> <p>
									The readiness status of components and owned resources.
								</p>
								 </td><td align="left" valign="top" headers="idm140663646628768"> <p>
									string
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663646630944"> <p>
									<code class="literal">operatorVersion</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663646629856"> <p>
									The version of the Operator that last processed this resource.
								</p>
								 </td><td align="left" valign="top" headers="idm140663646628768"> <p>
									string
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663646630944"> <p>
									<code class="literal">components</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663646629856"> <p>
									Shows the status of each deployed Service Mesh control plane component.
								</p>
								 </td><td align="left" valign="top" headers="idm140663646628768"> <p>
									string
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663646630944"> <p>
									<code class="literal">appliedSpec</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663646629856"> <p>
									The resulting specification of the configuration options after all profiles have been applied.
								</p>
								 </td><td align="left" valign="top" headers="idm140663646628768"> <p>
									<code class="literal">ControlPlaneSpec</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663646630944"> <p>
									<code class="literal">conditions</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663646629856"> <p>
									Represents the latest available observations of the object’s current state. <code class="literal">Reconciled</code> indicates that the Operator has finished reconciling the actual state of deployed components with the configuration in the <code class="literal">ServiceMeshControlPlane</code> resource. <code class="literal">Installed</code> indicates that the Service Mesh control plane has been installed. <code class="literal">Ready</code> indicates that all Service Mesh control plane components are ready.
								</p>
								 </td><td align="left" valign="top" headers="idm140663646628768"> <p>
									string
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663646630944"> <p>
									<code class="literal">chartVersion</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663646629856"> <p>
									The version of the charts that were last processed for this resource.
								</p>
								 </td><td align="left" valign="top" headers="idm140663646628768"> <p>
									string
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663646630944"> <p>
									<code class="literal">appliedValues</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663646629856"> <p>
									The resulting <code class="literal">values.yaml</code> file that was used to generate the charts.
								</p>
								 </td><td align="left" valign="top" headers="idm140663646628768"> <p>
									<code class="literal">ControlPlaneSpec</code>
								</p>
								 </td></tr></tbody></table></div></div></section><section class="section _additional-resources" id="additional-resources_ossm-reference"><div class="titlepage"><div><div><h3 class="title">1.24.4. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							For more information about how to configure the features in the <code class="literal">ServiceMeshControlPlane</code> resource, see the following links:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-security-mtls_ossm-security">Security</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-routing-bookinfo_traffic-management">Traffic management</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-observability">Metrics and traces</a>
								</li></ul></div></li></ul></div></section></section><section class="section" id="kiali-config-ref"><div class="titlepage"><div><div><h2 class="title">1.25. Kiali configuration reference</h2></div></div></div><p>
				When the Service Mesh Operator creates the <code class="literal">ServiceMeshControlPlane</code> it also processes the Kiali resource. The Kiali Operator then uses this object when creating Kiali instances.
			</p><section class="section" id="ossm-smcp-kiali_kiali-config-ref"><div class="titlepage"><div><div><h3 class="title">1.25.1. Specifying Kiali configuration in the SMCP</h3></div></div></div><p>
					You can configure Kiali under the <code class="literal">addons</code> section of the <code class="literal">ServiceMeshControlPlane</code> resource. Kiali is enabled by default. To disable Kiali, set <code class="literal">spec.addons.kiali.enabled</code> to <code class="literal">false</code>.
				</p><p>
					You can specify your Kiali configuration in either of two ways:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Specify the Kiali configuration in the <code class="literal">ServiceMeshControlPlane</code> resource under <code class="literal">spec.addons.kiali.install</code>. This approach has some limitations, because the complete list of Kiali configurations is not available in the SMCP.
						</li><li class="listitem">
							Configure and deploy a Kiali instance and specify the name of the Kiali resource as the value for <code class="literal">spec.addons.kiali.name</code> in the <code class="literal">ServiceMeshControlPlane</code> resource. You must create the CR in the same namespace as the Service Mesh control plane, for example, <code class="literal">istio-system</code>. If a Kiali resource matching the value of <code class="literal">name</code> exists, the control plane will configure that Kiali resource for use with the control plane. This approach lets you fully customize your Kiali configuration in the Kiali resource. Note that with this approach, various fields in the Kiali resource are overwritten by the Service Mesh Operator, specifically, the <code class="literal">accessible_namespaces</code> list, as well as the endpoints for Grafana, Prometheus, and tracing.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Example SMCP parameters for Kiali</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
spec:
  addons:
    kiali:
      name: kiali
      enabled: true
      install:
        dashboard:
          viewOnly: false
          enableGrafana: true
          enableTracing: true
          enablePrometheus: true
        service:
          ingress:
            contextPath: /kiali</pre>

					</p></div><div class="table" id="idm140663650651312"><p class="title"><strong>Table 1.38. <code class="literal">ServiceMeshControlPlane</code> Kiali parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663650644304" scope="col">Parameter</th><th align="left" valign="top" id="idm140663650643216" scope="col">Description</th><th align="left" valign="top" id="idm140663650642128" scope="col">Values</th><th align="left" valign="top" id="idm140663650641040" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">spec:
  addons:
    kiali:
      name:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Name of Kiali custom resource. If a Kiali CR matching the value of <code class="literal">name</code> exists, the Service Mesh Operator will use that CR for the installation. If no Kiali CR exists, the Operator will create one using this <code class="literal">name</code> and the configuration options specified in the SMCP.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									<code class="literal">kiali</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  enabled:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									This parameter enables or disables Kiali. Kiali is enabled by default.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									<code class="literal">true</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  install:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Install a Kiali resource if the named Kiali resource is not present. The <code class="literal">install</code> section is ignored if <code class="literal">addons.kiali.enabled</code> is set to <code class="literal">false</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> </td><td align="left" valign="top" headers="idm140663650641040"> </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  install:
    dashboard:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Configuration parameters for the dashboards shipped with Kiali.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> </td><td align="left" valign="top" headers="idm140663650641040"> </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  install:
    dashboard:
      viewOnly:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									This parameter enables or disables view-only mode for the Kiali console. When view-only mode is enabled, users cannot use the Kiali console to make changes to the Service Mesh.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									<code class="literal">false</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  install:
    dashboard:
      enableGrafana:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Grafana endpoint configured based on <code class="literal">spec.addons.grafana</code> configuration.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									<code class="literal">true</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  install:
    dashboard:
      enablePrometheus:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Prometheus endpoint configured based on <code class="literal">spec.addons.prometheus</code> configuration.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									<code class="literal">true</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  install:
    dashboard:
      enableTracing:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Tracing endpoint configured based on Jaeger custom resource configuration.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									<code class="literal">true</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  install:
    service:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Configuration parameters for the Kubernetes service associated with the Kiali installation.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> </td><td align="left" valign="top" headers="idm140663650641040"> </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  install:
    service:
      metadata:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Use to specify additional metadata to apply to resources.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> <p>
									N/A
								</p>
								 </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									N/A
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  install:
    service:
      metadata:
        annotations:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Use to specify additional annotations to apply to the component’s service.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									N/A
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  install:
    service:
      metadata:
        labels:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Use to specify additional labels to apply to the component’s service.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									N/A
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  install:
    service:
      ingress:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Use to specify details for accessing the component’s service through an OpenShift Route.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> <p>
									N/A
								</p>
								 </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									N/A
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  install:
    service:
      ingress:
        metadata:
          annotations:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Use to specify additional annotations to apply to the component’s service ingress.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									N/A
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  install:
    service:
      ingress:
        metadata:
          labels:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Use to specify additional labels to apply to the component’s service ingress.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									N/A
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  install:
    service:
      ingress:
        enabled:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Use to customize an OpenShift Route for the service associated with a component.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									<code class="literal">true</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  install:
    service:
      ingress:
        contextPath:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Use to specify the context path to the service.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									N/A
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">install:
  service:
    ingress:
      hosts:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Use to specify a single hostname per OpenShift route. An empty hostname implies a default hostname for the Route.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> <p>
									string
								</p>
								 </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									N/A
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">install:
  service:
    ingress:
      tls:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Use to configure the TLS for the OpenShift route.
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									N/A
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663650644304">
<pre class="literallayout">kiali:
  install:
    service:
      nodePort:</pre>
								 </td><td align="left" valign="top" headers="idm140663650643216"> <p>
									Use to specify the <code class="literal">nodePort</code> for the component’s service <code class="literal">Values.&lt;component&gt;.service.nodePort.port</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663650642128"> <p>
									integer
								</p>
								 </td><td align="left" valign="top" headers="idm140663650641040"> <p>
									N/A
								</p>
								 </td></tr></tbody></table></div></div></section><section class="section" id="ossm-specifying-external-kiali_kiali-config-ref"><div class="titlepage"><div><div><h3 class="title">1.25.2. Specifying Kiali configuration in a Kiali custom resource</h3></div></div></div><p>
					You can fully customize your Kiali deployment by configuring Kiali in the Kiali custom resource (CR) rather than in the <code class="literal">ServiceMeshControlPlane</code> (SMCP) resource. This configuration is sometimes called an "external Kiali" since the configuration is specified outside of the SMCP.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						You must deploy the <code class="literal">ServiceMeshControlPlane</code> and Kiali custom resources in the same namespace. For example, <code class="literal">istio-system</code>.
					</p></div></div><p>
					You can configure and deploy a Kiali instance and then specify the <code class="literal">name</code> of the Kiali resource as the value for <code class="literal">spec.addons.kiali.name</code> in the SMCP resource. If a Kiali CR matching the value of <code class="literal">name</code> exists, the Service Mesh control plane will use the existing installation. This approach lets you fully customize your Kiali configuration.
				</p></section></section><section class="section" id="jaeger-config-ref"><div class="titlepage"><div><div><h2 class="title">1.26. Jaeger configuration reference</h2></div></div></div><p>
				When the Service Mesh Operator deploys the <code class="literal">ServiceMeshControlPlane</code> resource, it can also create the resources for distributed tracing. Service Mesh uses Jaeger for distributed tracing.
			</p><section class="section" id="ossm-enabling-tracing_jaeger-config-reference"><div class="titlepage"><div><div><h3 class="title">1.26.1. Enabling and disabling tracing</h3></div></div></div><p>
					You enable distributed tracing by specifying a tracing type and a sampling rate in the <code class="literal">ServiceMeshControlPlane</code> resource.
				</p><div class="formalpara"><p class="title"><strong>Default <code class="literal">all-in-one</code> Jaeger parameters</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
spec:
  version: v2.4
  tracing:
    sampling: 100
    type: Jaeger</pre>

					</p></div><p>
					Currently, the only tracing type that is supported is <code class="literal">Jaeger</code>.
				</p><p>
					Jaeger is enabled by default. To disable tracing, set <code class="literal">type</code> to <code class="literal">None</code>.
				</p><p>
					The sampling rate determines how often the Envoy proxy generates a trace. You can use the sampling rate option to control what percentage of requests get reported to your tracing system. You can configure this setting based upon your traffic in the mesh and the amount of tracing data you want to collect. You configure <code class="literal">sampling</code> as a scaled integer representing 0.01% increments. For example, setting the value to <code class="literal">10</code> samples 0.1% of traces, setting the value to <code class="literal">500</code> samples 5% of traces, and a setting of <code class="literal">10000</code> samples 100% of traces.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The SMCP sampling configuration option controls the Envoy sampling rate. You configure the Jaeger trace sampling rate in the Jaeger custom resource.
					</p></div></div></section><section class="section" id="ossm-specifying-jaeger-configuration_jaeger-config-reference"><div class="titlepage"><div><div><h3 class="title">1.26.2. Specifying Jaeger configuration in the SMCP</h3></div></div></div><p>
					You configure Jaeger under the <code class="literal">addons</code> section of the <code class="literal">ServiceMeshControlPlane</code> resource. However, there are some limitations to what you can configure in the SMCP.
				</p><p>
					When the SMCP passes configuration information to the Red Hat OpenShift distributed tracing platform (Jaeger) Operator, it triggers one of three deployment strategies: <code class="literal">allInOne</code>, <code class="literal">production</code>, or <code class="literal">streaming</code>.
				</p></section><section class="section" id="ossm-deploying-jaeger_jaeger-config-reference"><div class="titlepage"><div><div><h3 class="title">1.26.3. Deploying the distributed tracing platform</h3></div></div></div><p>
					The distributed tracing platform (Jaeger) has predefined deployment strategies. You specify a deployment strategy in the Jaeger custom resource (CR) file. When you create an instance of the distributed tracing platform (Jaeger), the Red Hat OpenShift distributed tracing platform (Jaeger) Operator uses this configuration file to create the objects necessary for the deployment.
				</p><p>
					The Red Hat OpenShift distributed tracing platform (Jaeger) Operator currently supports the following deployment strategies:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>allInOne</strong></span> (default) - This strategy is intended for development, testing, and demo purposes and it is not for production use. The main back-end components, Agent, Collector, and Query service, are all packaged into a single executable, which is configured (by default) to use in-memory storage. You can configure this deployment strategy in the SMCP.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								In-memory storage is not persistent, which means that if the Jaeger instance shuts down, restarts, or is replaced, your trace data will be lost. And in-memory storage cannot be scaled, since each pod has its own memory. For persistent storage, you must use the <code class="literal">production</code> or <code class="literal">streaming</code> strategies, which use Elasticsearch as the default storage.
							</p></div></div></li><li class="listitem">
							<span class="strong strong"><strong>production</strong></span> - The production strategy is intended for production environments, where long term storage of trace data is important, and a more scalable and highly available architecture is required. Each back-end component is therefore deployed separately. The Agent can be injected as a sidecar on the instrumented application. The Query and Collector services are configured with a supported storage type, which is currently Elasticsearch. Multiple instances of each of these components can be provisioned as required for performance and resilience purposes. You can configure this deployment strategy in the SMCP, but in order to be fully customized, you must specify your configuration in the Jaeger CR and link that to the SMCP.
						</li><li class="listitem">
							<span class="strong strong"><strong>streaming</strong></span> - The streaming strategy is designed to augment the production strategy by providing a streaming capability that sits between the Collector and the Elasticsearch back-end storage. This provides the benefit of reducing the pressure on the back-end storage, under high load situations, and enables other trace post-processing capabilities to tap into the real-time span data directly from the streaming platform (<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_amq/7.6/html/using_amq_streams_on_openshift/index">AMQ Streams</a>/ <a class="link" href="https://kafka.apache.org/documentation/">Kafka</a>). You cannot configure this deployment strategy in the SMCP; you must configure a Jaeger CR and link that to the SMCP.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The streaming strategy requires an additional Red Hat subscription for AMQ Streams.
					</p></div></div><section class="section" id="ossm-deploying-jaeger-default_jaeger-config-reference"><div class="titlepage"><div><div><h4 class="title">1.26.3.1. Default distributed tracing platform (Jaeger) deployment</h4></div></div></div><p>
						If you do not specify Jaeger configuration options, the <code class="literal">ServiceMeshControlPlane</code> resource will use the <code class="literal">allInOne</code> Jaeger deployment strategy by default. When using the default <code class="literal">allInOne</code> deployment strategy, set <code class="literal">spec.addons.jaeger.install.storage.type</code> to <code class="literal">Memory</code>. You can accept the defaults or specify additional configuration options under <code class="literal">install</code>.
					</p><div class="formalpara"><p class="title"><strong>Control plane default Jaeger parameters (Memory)</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
spec:
  version: v2.4
  tracing:
    sampling: 10000
    type: Jaeger
  addons:
    jaeger:
      name: jaeger
      install:
        storage:
          type: Memory</pre>

						</p></div></section><section class="section" id="ossm-deploying-jaeger-production-min_jaeger-config-reference"><div class="titlepage"><div><div><h4 class="title">1.26.3.2. Production distributed tracing platform (Jaeger) deployment (minimal)</h4></div></div></div><p>
						To use the default settings for the <code class="literal">production</code> deployment strategy, set <code class="literal">spec.addons.jaeger.install.storage.type</code> to <code class="literal">Elasticsearch</code> and specify additional configuration options under <code class="literal">install</code>. Note that the SMCP only supports configuring Elasticsearch resources and image name.
					</p><div class="formalpara"><p class="title"><strong>Control plane default Jaeger parameters (Elasticsearch)</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
spec:
  version: v2.4
  tracing:
    sampling: 10000
    type: Jaeger
  addons:
    jaeger:
      name: jaeger  #name of Jaeger CR
      install:
        storage:
          type: Elasticsearch
        ingress:
          enabled: true
  runtime:
    components:
      tracing.jaeger.elasticsearch: # only supports resources and image name
        container:
          resources: {}</pre>

						</p></div></section><section class="section" id="ossm-deploying-jaeger-production_jaeger-config-reference"><div class="titlepage"><div><div><h4 class="title">1.26.3.3. Production distributed tracing platform (Jaeger) deployment (fully customized)</h4></div></div></div><p>
						The SMCP supports only minimal Elasticsearch parameters. To fully customize your production environment and access all of the Elasticsearch configuration parameters, use the Jaeger custom resource (CR) to configure Jaeger.
					</p><p>
						Create and configure your Jaeger instance and set <code class="literal">spec.addons.jaeger.name</code> to the name of the Jaeger instance, in this example: <code class="literal">MyJaegerInstance</code>.
					</p><div class="formalpara"><p class="title"><strong>Control plane with linked Jaeger production CR</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
spec:
  version: v2.4
  tracing:
    sampling: 1000
    type: Jaeger
  addons:
    jaeger:
      name: MyJaegerInstance #name of Jaeger CR
      install:
        storage:
          type: Elasticsearch
        ingress:
          enabled: true</pre>

						</p></div></section><section class="section" id="ossm-deploying-jaeger-streaming_jaeger-config-reference"><div class="titlepage"><div><div><h4 class="title">1.26.3.4. Streaming Jaeger deployment</h4></div></div></div><p>
						To use the <code class="literal">streaming</code> deployment strategy, you create and configure your Jaeger instance first, then set <code class="literal">spec.addons.jaeger.name</code> to the name of the Jaeger instance, in this example: <code class="literal">MyJaegerInstance</code>.
					</p><div class="formalpara"><p class="title"><strong>Control plane with linked Jaeger streaming CR</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
spec:
  version: v2.4
  tracing:
    sampling: 1000
    type: Jaeger
  addons:
    jaeger:
      name: MyJaegerInstance  #name of Jaeger CR</pre>

						</p></div></section></section><section class="section" id="ossm-specifying-external-jaeger_jaeger-config-reference"><div class="titlepage"><div><div><h3 class="title">1.26.4. Specifying Jaeger configuration in a Jaeger custom resource</h3></div></div></div><p>
					You can fully customize your Jaeger deployment by configuring Jaeger in the Jaeger custom resource (CR) rather than in the <code class="literal">ServiceMeshControlPlane</code> (SMCP) resource. This configuration is sometimes referred to as an "external Jaeger" since the configuration is specified outside of the SMCP.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						You must deploy the SMCP and Jaeger CR in the same namespace. For example, <code class="literal">istio-system</code>.
					</p></div></div><p>
					You can configure and deploy a standalone Jaeger instance and then specify the <code class="literal">name</code> of the Jaeger resource as the value for <code class="literal">spec.addons.jaeger.name</code> in the SMCP resource. If a Jaeger CR matching the value of <code class="literal">name</code> exists, the Service Mesh control plane will use the existing installation. This approach lets you fully customize your Jaeger configuration.
				</p><section class="section" id="distr-tracing-deployment-best-practices_jaeger-config-reference"><div class="titlepage"><div><div><h4 class="title">1.26.4.1. Deployment best practices</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Red Hat OpenShift distributed tracing platform instance names must be unique. If you want to have multiple Red Hat OpenShift distributed tracing platform (Jaeger) instances and are using sidecar injected agents, then the Red Hat OpenShift distributed tracing platform (Jaeger) instances should have unique names, and the injection annotation should explicitly specify the Red Hat OpenShift distributed tracing platform (Jaeger) instance name the tracing data should be reported to.
							</li><li class="listitem">
								If you have a multitenant implementation and tenants are separated by namespaces, deploy a Red Hat OpenShift distributed tracing platform (Jaeger) instance to each tenant namespace.
							</li></ul></div><p>
						For information about configuring persistent storage, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/storage/#understanding-persistent-storage-1">Understanding persistent storage</a> and the appropriate configuration topic for your chosen storage option.
					</p></section><section class="section" id="distr-tracing-config-security-ossm_jaeger-config-reference"><div class="titlepage"><div><div><h4 class="title">1.26.4.2. Configuring distributed tracing security for service mesh</h4></div></div></div><p>
						The distributed tracing platform (Jaeger) uses OAuth for default authentication. However Red Hat OpenShift Service Mesh uses a secret called <code class="literal">htpasswd</code> to facilitate communication between dependent services such as Grafana, Kiali, and the distributed tracing platform (Jaeger). When you configure your distributed tracing platform (Jaeger) in the <code class="literal">ServiceMeshControlPlane</code> the Service Mesh automatically configures security settings to use <code class="literal">htpasswd</code>.
					</p><p>
						If you are specifying your distributed tracing platform (Jaeger) configuration in a Jaeger custom resource, you must manually configure the <code class="literal">htpasswd</code> settings and ensure the <code class="literal">htpasswd</code> secret is mounted into your Jaeger instance so that Kiali can communicate with it.
					</p><section class="section" id="distr-tracing-config-security-ossm-web_jaeger-config-reference"><div class="titlepage"><div><div><h5 class="title">1.26.4.2.1. Configuring distributed tracing security for service mesh from the web console</h5></div></div></div><p>
							You can modify the Jaeger resource to configure distributed tracing platform (Jaeger) security for use with Service Mesh in the web console.
						</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
								</li><li class="listitem">
									The Red Hat OpenShift Service Mesh Operator must be installed.
								</li><li class="listitem">
									The <code class="literal">ServiceMeshControlPlane</code> deployed to the cluster.
								</li><li class="listitem">
									You have access to the OpenShift Container Platform web console.
								</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									Log in to the OpenShift Container Platform web console as a user with the <code class="literal">cluster-admin</code> role.
								</li><li class="listitem">
									Navigate to Operators → Installed Operators.
								</li><li class="listitem">
									Click the <span class="strong strong"><strong>Project</strong></span> menu and select the project where your <code class="literal">ServiceMeshControlPlane</code> resource is deployed from the list, for example <code class="literal">istio-system</code>.
								</li><li class="listitem">
									Click the <span class="strong strong"><strong>Red Hat OpenShift distributed tracing platform (Jaeger) Operator</strong></span>.
								</li><li class="listitem">
									On the <span class="strong strong"><strong>Operator Details</strong></span> page, click the <span class="strong strong"><strong>Jaeger</strong></span> tab.
								</li><li class="listitem">
									Click the name of your Jaeger instance.
								</li><li class="listitem">
									On the Jaeger details page, click the <span class="strong strong"><strong>YAML</strong></span> tab to modify your configuration.
								</li><li class="listitem"><p class="simpara">
									Edit the <code class="literal">Jaeger</code> custom resource file to add the <code class="literal">htpasswd</code> configuration as shown in the following example.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<code class="literal">spec.ingress.openshift.htpasswdFile</code>
										</li><li class="listitem">
											<code class="literal">spec.volumes</code>
										</li><li class="listitem"><p class="simpara">
											<code class="literal">spec.volumeMounts</code>
										</p><div class="formalpara"><p class="title"><strong>Example Jaeger resource showing <code class="literal">htpasswd</code> configuration</strong></p><p>
												
<pre class="programlisting language-yaml">apiVersion: jaegertracing.io/v1
kind: Jaeger
spec:
  ingress:
    enabled: true
    openshift:
      htpasswdFile: /etc/proxy/htpasswd/auth
      sar: '{"namespace": "istio-system", "resource": "pods", "verb": "get"}'
    options: {}
    resources: {}
    security: oauth-proxy
  volumes:
    - name: secret-htpasswd
      secret:
        secretName: htpasswd
    - configMap:
        defaultMode: 420
        items:
          - key: ca-bundle.crt
            path: tls-ca-bundle.pem
        name: trusted-ca-bundle
        optional: true
      name: trusted-ca-bundle
  volumeMounts:
    - mountPath: /etc/proxy/htpasswd
      name: secret-htpasswd
    - mountPath: /etc/pki/ca-trust/extracted/pem/
      name: trusted-ca-bundle
      readOnly: true</pre>

											</p></div></li></ul></div></li><li class="listitem">
									Click <span class="strong strong"><strong>Save</strong></span>.
								</li></ol></div></section><section class="section" id="distr-tracing-config-security-ossm-cli_jaeger-config-reference"><div class="titlepage"><div><div><h5 class="title">1.26.4.2.2. Configuring distributed tracing security for service mesh from the command line</h5></div></div></div><p>
							You can modify the Jaeger resource to configure distributed tracing platform (Jaeger) security for use with Service Mesh from the command line by running the OpenShift CLI (<code class="literal">oc</code>).
						</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
								</li><li class="listitem">
									The Red Hat OpenShift Service Mesh Operator must be installed.
								</li><li class="listitem">
									The <code class="literal">ServiceMeshControlPlane</code> deployed to the cluster.
								</li><li class="listitem">
									You have access to the OpenShift CLI (<code class="literal">oc</code>) that matches your OpenShift Container Platform version.
								</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Log in to the OpenShift CLI (<code class="literal">oc</code>) as a user with the <code class="literal">cluster-admin</code> role by running the following command. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
								</p><pre class="programlisting language-terminal">$ oc login https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
									Change to the project where you installed the control plane, for example <code class="literal">istio-system</code>, by entering the following command:
								</p><pre class="programlisting language-terminal">$ oc project istio-system</pre></li><li class="listitem"><p class="simpara">
									Run the following command to edit the Jaeger custom resource file, where <code class="literal">jaeger.yaml</code> is the name of your Jaeger custom resource.
								</p><pre class="programlisting language-terminal">$ oc edit -n tracing-system -f jaeger.yaml</pre></li><li class="listitem"><p class="simpara">
									Edit the <code class="literal">Jaeger</code> custom resource file to add the <code class="literal">htpasswd</code> configuration as shown in the following example.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<code class="literal">spec.ingress.openshift.htpasswdFile</code>
										</li><li class="listitem">
											<code class="literal">spec.volumes</code>
										</li><li class="listitem"><p class="simpara">
											<code class="literal">spec.volumeMounts</code>
										</p><div class="formalpara"><p class="title"><strong>Example Jaeger resource showing <code class="literal">htpasswd</code> configuration</strong></p><p>
												
<pre class="programlisting language-yaml">apiVersion: jaegertracing.io/v1
kind: Jaeger
spec:
  ingress:
    enabled: true
    openshift:
      htpasswdFile: /etc/proxy/htpasswd/auth
      sar: '{"namespace": "istio-system", "resource": "pods", "verb": "get"}'
    options: {}
    resources: {}
    security: oauth-proxy
  volumes:
    - name: secret-htpasswd
      secret:
        secretName: htpasswd
    - configMap:
        defaultMode: 420
        items:
          - key: ca-bundle.crt
            path: tls-ca-bundle.pem
        name: trusted-ca-bundle
        optional: true
      name: trusted-ca-bundle
  volumeMounts:
    - mountPath: /etc/proxy/htpasswd
      name: secret-htpasswd
    - mountPath: /etc/pki/ca-trust/extracted/pem/
      name: trusted-ca-bundle
      readOnly: true</pre>

											</p></div></li></ul></div></li><li class="listitem"><p class="simpara">
									Run the following command to apply your changes, where &lt;jaeger.yaml&gt; is the name of your Jaeger custom resource.
								</p><pre class="programlisting language-terminal">$ oc apply -n tracing-system -f &lt;jaeger.yaml&gt;</pre></li><li class="listitem"><p class="simpara">
									Run the following command to watch the progress of the pod deployment:
								</p><pre class="programlisting language-terminal">$ oc get pods -n tracing-system -w</pre></li></ol></div></section></section><section class="section" id="distr-tracing-config-default_jaeger-config-reference"><div class="titlepage"><div><div><h4 class="title">1.26.4.3. Distributed tracing default configuration options</h4></div></div></div><p>
						The Jaeger custom resource (CR) defines the architecture and settings to be used when creating the distributed tracing platform (Jaeger) resources. You can modify these parameters to customize your distributed tracing platform (Jaeger) implementation to your business needs.
					</p><div class="formalpara"><p class="title"><strong>Generic YAML example of the Jaeger CR</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: jaegertracing.io/v1
kind: Jaeger
metadata:
  name: name
spec:
  strategy: &lt;deployment_strategy&gt;
  allInOne:
    options: {}
    resources: {}
  agent:
    options: {}
    resources: {}
  collector:
    options: {}
    resources: {}
  sampling:
    options: {}
  storage:
    type:
    options: {}
  query:
    options: {}
    resources: {}
  ingester:
    options: {}
    resources: {}
  options: {}</pre>

						</p></div><div class="table" id="idm140663646560256"><p class="title"><strong>Table 1.39. Jaeger parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663646553568" scope="col">Parameter</th><th align="left" valign="top" id="idm140663646552480" scope="col">Description</th><th align="left" valign="top" id="idm140663646551392" scope="col">Values</th><th align="left" valign="top" id="idm140663646550304" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663646553568"> <p>
										<code class="literal">apiVersion:</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646552480"> <p>
										API version to use when creating the object.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646551392"> <p>
										<code class="literal">jaegertracing.io/v1</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646550304"> <p>
										<code class="literal">jaegertracing.io/v1</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663646553568"> <p>
										<code class="literal">kind:</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646552480"> <p>
										Defines the kind of Kubernetes object to create.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646551392"> <p>
										<code class="literal">jaeger</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646550304"> </td></tr><tr><td align="left" valign="top" headers="idm140663646553568"> <p>
										<code class="literal">metadata:</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646552480"> <p>
										Data that helps uniquely identify the object, including a <code class="literal">name</code> string, <code class="literal">UID</code>, and optional <code class="literal">namespace</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646551392"> </td><td align="left" valign="top" headers="idm140663646550304"> <p>
										OpenShift Container Platform automatically generates the <code class="literal">UID</code> and completes the <code class="literal">namespace</code> with the name of the project where the object is created.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663646553568"> <p>
										<code class="literal">name:</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646552480"> <p>
										Name for the object.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646551392"> <p>
										The name of your distributed tracing platform (Jaeger) instance.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646550304"> <p>
										<code class="literal">jaeger-all-in-one-inmemory</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663646553568"> <p>
										<code class="literal">spec:</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646552480"> <p>
										Specification for the object to be created.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646551392"> <p>
										Contains all of the configuration parameters for your distributed tracing platform (Jaeger) instance. When a common definition for all Jaeger components is required, it is defined under the <code class="literal">spec</code> node. When the definition relates to an individual component, it is placed under the <code class="literal">spec/&lt;component&gt;</code> node.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646550304"> <p>
										N/A
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663646553568"> <p>
										<code class="literal">strategy:</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646552480"> <p>
										Jaeger deployment strategy
									</p>
									 </td><td align="left" valign="top" headers="idm140663646551392"> <p>
										<code class="literal">allInOne</code>, <code class="literal">production</code>, or <code class="literal">streaming</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646550304"> <p>
										<code class="literal">allInOne</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663646553568"> <p>
										<code class="literal">allInOne:</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646552480"> <p>
										Because the <code class="literal">allInOne</code> image deploys the Agent, Collector, Query, Ingester, and Jaeger UI in a single pod, configuration for this deployment must nest component configuration under the <code class="literal">allInOne</code> parameter.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646551392"> </td><td align="left" valign="top" headers="idm140663646550304"> </td></tr><tr><td align="left" valign="top" headers="idm140663646553568"> <p>
										<code class="literal">agent:</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646552480"> <p>
										Configuration options that define the Agent.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646551392"> </td><td align="left" valign="top" headers="idm140663646550304"> </td></tr><tr><td align="left" valign="top" headers="idm140663646553568"> <p>
										<code class="literal">collector:</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646552480"> <p>
										Configuration options that define the Jaeger Collector.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646551392"> </td><td align="left" valign="top" headers="idm140663646550304"> </td></tr><tr><td align="left" valign="top" headers="idm140663646553568"> <p>
										<code class="literal">sampling:</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646552480"> <p>
										Configuration options that define the sampling strategies for tracing.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646551392"> </td><td align="left" valign="top" headers="idm140663646550304"> </td></tr><tr><td align="left" valign="top" headers="idm140663646553568"> <p>
										<code class="literal">storage:</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646552480"> <p>
										Configuration options that define the storage. All storage-related options must be placed under <code class="literal">storage</code>, rather than under the <code class="literal">allInOne</code> or other component options.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646551392"> </td><td align="left" valign="top" headers="idm140663646550304"> </td></tr><tr><td align="left" valign="top" headers="idm140663646553568"> <p>
										<code class="literal">query:</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646552480"> <p>
										Configuration options that define the Query service.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646551392"> </td><td align="left" valign="top" headers="idm140663646550304"> </td></tr><tr><td align="left" valign="top" headers="idm140663646553568"> <p>
										<code class="literal">ingester:</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663646552480"> <p>
										Configuration options that define the Ingester service.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646551392"> </td><td align="left" valign="top" headers="idm140663646550304"> </td></tr></tbody></table></div></div><p>
						The following example YAML is the minimum required to create a Red Hat OpenShift distributed tracing platform (Jaeger) deployment using the default settings.
					</p><div class="formalpara"><p class="title"><strong>Example minimum required dist-tracing-all-in-one.yaml</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: jaegertracing.io/v1
kind: Jaeger
metadata:
  name: jaeger-all-in-one-inmemory</pre>

						</p></div></section><section class="section" id="distr-tracing-config-jaeger-collector_jaeger-config-reference"><div class="titlepage"><div><div><h4 class="title">1.26.4.4. Jaeger Collector configuration options</h4></div></div></div><p>
						The Jaeger Collector is the component responsible for receiving the spans that were captured by the tracer and writing them to persistent Elasticsearch storage when using the <code class="literal">production</code> strategy, or to AMQ Streams when using the <code class="literal">streaming</code> strategy.
					</p><p>
						The Collectors are stateless and thus many instances of Jaeger Collector can be run in parallel. Collectors require almost no configuration, except for the location of the Elasticsearch cluster.
					</p><div class="table" id="idm140663648745072"><p class="title"><strong>Table 1.40. Parameters used by the Operator to define the Jaeger Collector</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663648739344" scope="col">Parameter</th><th align="left" valign="top" id="idm140663648738256" scope="col">Description</th><th align="left" valign="top" id="idm140663648737168" scope="col">Values</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663648739344">
<pre class="literallayout">collector:
  replicas:</pre>
									 </td><td align="left" valign="top" headers="idm140663648738256"> <p>
										Specifies the number of Collector replicas to create.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648737168"> <p>
										Integer, for example, <code class="literal">5</code>
									</p>
									 </td></tr></tbody></table></div></div><div class="table" id="idm140663648728912"><p class="title"><strong>Table 1.41. Configuration parameters passed to the Collector</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663648723120" scope="col">Parameter</th><th align="left" valign="top" id="idm140663648722032" scope="col">Description</th><th align="left" valign="top" id="idm140663648720944" scope="col">Values</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663648723120">
<pre class="literallayout">spec:
 collector:
  options: {}</pre>
									 </td><td align="left" valign="top" headers="idm140663648722032"> <p>
										Configuration options that define the Jaeger Collector.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648720944"> </td></tr><tr><td align="left" valign="top" headers="idm140663648723120">
<pre class="literallayout">options:
  collector:
    num-workers:</pre>
									 </td><td align="left" valign="top" headers="idm140663648722032"> <p>
										The number of workers pulling from the queue.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648720944"> <p>
										Integer, for example, <code class="literal">50</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648723120">
<pre class="literallayout">options:
  collector:
    queue-size:</pre>
									 </td><td align="left" valign="top" headers="idm140663648722032"> <p>
										The size of the Collector queue.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648720944"> <p>
										Integer, for example, <code class="literal">2000</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648723120">
<pre class="literallayout">options:
  kafka:
    producer:
      topic: jaeger-spans</pre>
									 </td><td align="left" valign="top" headers="idm140663648722032"> <p>
										The <code class="literal">topic</code> parameter identifies the Kafka configuration used by the Collector to produce the messages, and the Ingester to consume the messages.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648720944"> <p>
										Label for the producer.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648723120">
<pre class="literallayout">options:
  kafka:
    producer:
      brokers: my-cluster-kafka-brokers.kafka:9092</pre>
									 </td><td align="left" valign="top" headers="idm140663648722032"> <p>
										Identifies the Kafka configuration used by the Collector to produce the messages. If brokers are not specified, and you have AMQ Streams 1.4.0+ installed, the Red Hat OpenShift distributed tracing platform (Jaeger) Operator will self-provision Kafka.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648720944"> </td></tr><tr><td align="left" valign="top" headers="idm140663648723120">
<pre class="literallayout">options:
  log-level:</pre>
									 </td><td align="left" valign="top" headers="idm140663648722032"> <p>
										Logging level for the Collector.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648720944"> <p>
										Possible values: <code class="literal">debug</code>, <code class="literal">info</code>, <code class="literal">warn</code>, <code class="literal">error</code>, <code class="literal">fatal</code>, <code class="literal">panic</code>.
									</p>
									 </td></tr></tbody></table></div></div></section><section class="section" id="distr-tracing-config-sampling_jaeger-config-reference"><div class="titlepage"><div><div><h4 class="title">1.26.4.5. Distributed tracing sampling configuration options</h4></div></div></div><p>
						The Red Hat OpenShift distributed tracing platform (Jaeger) Operator can be used to define sampling strategies that will be supplied to tracers that have been configured to use a remote sampler.
					</p><p>
						While all traces are generated, only a few are sampled. Sampling a trace marks the trace for further processing and storage.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							This is not relevant if a trace was started by the Envoy proxy, as the sampling decision is made there. The Jaeger sampling decision is only relevant when the trace is started by an application using the client.
						</p></div></div><p>
						When a service receives a request that contains no trace context, the client starts a new trace, assigns it a random trace ID, and makes a sampling decision based on the currently installed sampling strategy. The sampling decision propagates to all subsequent requests in the trace so that other services are not making the sampling decision again.
					</p><p>
						distributed tracing platform (Jaeger) libraries support the following samplers:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Probabilistic</strong></span> - The sampler makes a random sampling decision with the probability of sampling equal to the value of the <code class="literal">sampling.param</code> property. For example, using <code class="literal">sampling.param=0.1</code> samples approximately 1 in 10 traces.
							</li><li class="listitem">
								<span class="strong strong"><strong>Rate Limiting</strong></span> - The sampler uses a leaky bucket rate limiter to ensure that traces are sampled with a certain constant rate. For example, using <code class="literal">sampling.param=2.0</code> samples requests with the rate of 2 traces per second.
							</li></ul></div><div class="table" id="idm140663646394624"><p class="title"><strong>Table 1.42. Jaeger sampling options</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663646387936" scope="col">Parameter</th><th align="left" valign="top" id="idm140663646386848" scope="col">Description</th><th align="left" valign="top" id="idm140663646385760" scope="col">Values</th><th align="left" valign="top" id="idm140663646384672" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663646387936">
<pre class="literallayout">spec:
 sampling:
  options: {}
    default_strategy:
    service_strategy:</pre>
									 </td><td align="left" valign="top" headers="idm140663646386848"> <p>
										Configuration options that define the sampling strategies for tracing.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646385760"> </td><td align="left" valign="top" headers="idm140663646384672"> <p>
										If you do not provide configuration, the Collectors will return the default probabilistic sampling policy with 0.001 (0.1%) probability for all services.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663646387936">
<pre class="literallayout">default_strategy:
  type:
service_strategy:
  type:</pre>
									 </td><td align="left" valign="top" headers="idm140663646386848"> <p>
										Sampling strategy to use. See descriptions above.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646385760"> <p>
										Valid values are <code class="literal">probabilistic</code>, and <code class="literal">ratelimiting</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646384672"> <p>
										<code class="literal">probabilistic</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663646387936">
<pre class="literallayout">default_strategy:
  param:
service_strategy:
  param:</pre>
									 </td><td align="left" valign="top" headers="idm140663646386848"> <p>
										Parameters for the selected sampling strategy.
									</p>
									 </td><td align="left" valign="top" headers="idm140663646385760"> <p>
										Decimal and integer values (0, .1, 1, 10)
									</p>
									 </td><td align="left" valign="top" headers="idm140663646384672"> <p>
										1
									</p>
									 </td></tr></tbody></table></div></div><p>
						This example defines a default sampling strategy that is probabilistic, with a 50% chance of the trace instances being sampled.
					</p><div class="formalpara"><p class="title"><strong>Probabilistic sampling example</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: jaegertracing.io/v1
kind: Jaeger
metadata:
  name: with-sampling
spec:
  sampling:
    options:
      default_strategy:
        type: probabilistic
        param: 0.5
      service_strategies:
        - service: alpha
          type: probabilistic
          param: 0.8
          operation_strategies:
            - operation: op1
              type: probabilistic
              param: 0.2
            - operation: op2
              type: probabilistic
              param: 0.4
        - service: beta
          type: ratelimiting
          param: 5</pre>

						</p></div><p>
						If there are no user-supplied configurations, the distributed tracing platform (Jaeger) uses the following settings:
					</p><div class="formalpara"><p class="title"><strong>Default sampling</strong></p><p>
							
<pre class="programlisting language-yaml">spec:
  sampling:
    options:
      default_strategy:
        type: probabilistic
        param: 1</pre>

						</p></div></section><section class="section" id="distr-tracing-config-storage_jaeger-config-reference"><div class="titlepage"><div><div><h4 class="title">1.26.4.6. Distributed tracing storage configuration options</h4></div></div></div><p>
						You configure storage for the Collector, Ingester, and Query services under <code class="literal">spec.storage</code>. Multiple instances of each of these components can be provisioned as required for performance and resilience purposes.
					</p><div class="table" id="idm140663648195936"><p class="title"><strong>Table 1.43. General storage parameters used by the Red Hat OpenShift distributed tracing platform (Jaeger) Operator to define distributed tracing storage</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663648189120" scope="col">Parameter</th><th align="left" valign="top" id="idm140663648188032" scope="col">Description</th><th align="left" valign="top" id="idm140663648186944" scope="col">Values</th><th align="left" valign="top" id="idm140663648185856" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663648189120">
<pre class="literallayout">spec:
  storage:
    type:</pre>
									 </td><td align="left" valign="top" headers="idm140663648188032"> <p>
										Type of storage to use for the deployment.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648186944"> <p>
										<code class="literal">memory</code> or <code class="literal">elasticsearch</code>. Memory storage is only appropriate for development, testing, demonstrations, and proof of concept environments as the data does not persist if the pod is shut down. For production environments distributed tracing platform (Jaeger) supports Elasticsearch for persistent storage.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648185856"> <p>
										<code class="literal">memory</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648189120">
<pre class="literallayout">storage:
  secretname:</pre>
									 </td><td align="left" valign="top" headers="idm140663648188032"> <p>
										Name of the secret, for example <code class="literal">tracing-secret</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648186944"> </td><td align="left" valign="top" headers="idm140663648185856"> <p>
										N/A
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663648189120">
<pre class="literallayout">storage:
  options: {}</pre>
									 </td><td align="left" valign="top" headers="idm140663648188032"> <p>
										Configuration options that define the storage.
									</p>
									 </td><td align="left" valign="top" headers="idm140663648186944"> </td><td align="left" valign="top" headers="idm140663648185856"> </td></tr></tbody></table></div></div><div class="table" id="idm140663648162048"><p class="title"><strong>Table 1.44. Elasticsearch index cleaner parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663649733808" scope="col">Parameter</th><th align="left" valign="top" id="idm140663649732720" scope="col">Description</th><th align="left" valign="top" id="idm140663649731632" scope="col">Values</th><th align="left" valign="top" id="idm140663649730544" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663649733808">
<pre class="literallayout">storage:
  esIndexCleaner:
    enabled:</pre>
									 </td><td align="left" valign="top" headers="idm140663649732720"> <p>
										When using Elasticsearch storage, by default a job is created to clean old traces from the index. This parameter enables or disables the index cleaner job.
									</p>
									 </td><td align="left" valign="top" headers="idm140663649731632"> <p>
										<code class="literal">true</code>/ <code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663649730544"> <p>
										<code class="literal">true</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663649733808">
<pre class="literallayout">storage:
  esIndexCleaner:
    numberOfDays:</pre>
									 </td><td align="left" valign="top" headers="idm140663649732720"> <p>
										Number of days to wait before deleting an index.
									</p>
									 </td><td align="left" valign="top" headers="idm140663649731632"> <p>
										Integer value
									</p>
									 </td><td align="left" valign="top" headers="idm140663649730544"> <p>
										<code class="literal">7</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663649733808">
<pre class="literallayout">storage:
  esIndexCleaner:
    schedule:</pre>
									 </td><td align="left" valign="top" headers="idm140663649732720"> <p>
										Defines the schedule for how often to clean the Elasticsearch index.
									</p>
									 </td><td align="left" valign="top" headers="idm140663649731632"> <p>
										Cron expression
									</p>
									 </td><td align="left" valign="top" headers="idm140663649730544"> <p>
										"55 23 * * *"
									</p>
									 </td></tr></tbody></table></div></div><section class="section" id="distributed-tracing-config-auto-provisioning-es_jaeger-config-reference"><div class="titlepage"><div><div><h5 class="title">1.26.4.6.1. Auto-provisioning an Elasticsearch instance</h5></div></div></div><p>
							When you deploy a Jaeger custom resource, the Red Hat OpenShift distributed tracing platform (Jaeger) Operator uses the OpenShift Elasticsearch Operator to create an Elasticsearch cluster based on the configuration provided in the <code class="literal">storage</code> section of the custom resource file. The Red Hat OpenShift distributed tracing platform (Jaeger) Operator will provision Elasticsearch if the following configurations are set:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">spec.storage:type</code> is set to <code class="literal">elasticsearch</code>
								</li><li class="listitem">
									<code class="literal">spec.storage.elasticsearch.doNotProvision</code> set to <code class="literal">false</code>
								</li><li class="listitem">
									<code class="literal">spec.storage.options.es.server-urls</code> is not defined, that is, there is no connection to an Elasticsearch instance that was not provisioned by the Red Hat Elasticsearch Operator.
								</li></ul></div><p>
							When provisioning Elasticsearch, the Red Hat OpenShift distributed tracing platform (Jaeger) Operator sets the Elasticsearch custom resource <code class="literal">name</code> to the value of <code class="literal">spec.storage.elasticsearch.name</code> from the Jaeger custom resource. If you do not specify a value for <code class="literal">spec.storage.elasticsearch.name</code>, the Operator uses <code class="literal">elasticsearch</code>.
						</p><div class="itemizedlist"><p class="title"><strong>Restrictions</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									You can have only one distributed tracing platform (Jaeger) with self-provisioned Elasticsearch instance per namespace. The Elasticsearch cluster is meant to be dedicated for a single distributed tracing platform (Jaeger) instance.
								</li><li class="listitem">
									There can be only one Elasticsearch per namespace.
								</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								If you already have installed Elasticsearch as part of OpenShift Logging, the Red Hat OpenShift distributed tracing platform (Jaeger) Operator can use the installed OpenShift Elasticsearch Operator to provision storage.
							</p></div></div><p>
							The following configuration parameters are for a <span class="emphasis"><em>self-provisioned</em></span> Elasticsearch instance, that is an instance created by the Red Hat OpenShift distributed tracing platform (Jaeger) Operator using the OpenShift Elasticsearch Operator. You specify configuration options for self-provisioned Elasticsearch under <code class="literal">spec:storage:elasticsearch</code> in your configuration file.
						</p><div class="table" id="idm140663649687376"><p class="title"><strong>Table 1.45. Elasticsearch resource configuration parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663649680656" scope="col">Parameter</th><th align="left" valign="top" id="idm140663649679568" scope="col">Description</th><th align="left" valign="top" id="idm140663649678480" scope="col">Values</th><th align="left" valign="top" id="idm140663649677392" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663649680656">
<pre class="literallayout">elasticsearch:
  properties:
    doNotProvision:</pre>
										 </td><td align="left" valign="top" headers="idm140663649679568"> <p>
											Use to specify whether or not an Elasticsearch instance should be provisioned by the Red Hat OpenShift distributed tracing platform (Jaeger) Operator.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649678480"> <p>
											<code class="literal">true</code>/<code class="literal">false</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663649677392"> <p>
											<code class="literal">true</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649680656">
<pre class="literallayout">elasticsearch:
  properties:
    name:</pre>
										 </td><td align="left" valign="top" headers="idm140663649679568"> <p>
											Name of the Elasticsearch instance. The Red Hat OpenShift distributed tracing platform (Jaeger) Operator uses the Elasticsearch instance specified in this parameter to connect to Elasticsearch.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649678480"> <p>
											string
										</p>
										 </td><td align="left" valign="top" headers="idm140663649677392"> <p>
											<code class="literal">elasticsearch</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649680656">
<pre class="literallayout">elasticsearch:
  nodeCount:</pre>
										 </td><td align="left" valign="top" headers="idm140663649679568"> <p>
											Number of Elasticsearch nodes. For high availability use at least 3 nodes. Do not use 2 nodes as “split brain” problem can happen.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649678480"> <p>
											Integer value. For example, Proof of concept = 1, Minimum deployment =3
										</p>
										 </td><td align="left" valign="top" headers="idm140663649677392"> <p>
											3
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649680656">
<pre class="literallayout">elasticsearch:
  resources:
    requests:
      cpu:</pre>
										 </td><td align="left" valign="top" headers="idm140663649679568"> <p>
											Number of central processing units for requests, based on your environment’s configuration.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649678480"> <p>
											Specified in cores or millicores, for example, 200m, 0.5, 1. For example, Proof of concept = 500m, Minimum deployment =1
										</p>
										 </td><td align="left" valign="top" headers="idm140663649677392"> <p>
											1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649680656">
<pre class="literallayout">elasticsearch:
  resources:
    requests:
      memory:</pre>
										 </td><td align="left" valign="top" headers="idm140663649679568"> <p>
											Available memory for requests, based on your environment’s configuration.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649678480"> <p>
											Specified in bytes, for example, 200Ki, 50Mi, 5Gi. For example, Proof of concept = 1Gi, Minimum deployment = 16Gi*
										</p>
										 </td><td align="left" valign="top" headers="idm140663649677392"> <p>
											16Gi
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649680656">
<pre class="literallayout">elasticsearch:
  resources:
    limits:
      cpu:</pre>
										 </td><td align="left" valign="top" headers="idm140663649679568"> <p>
											Limit on number of central processing units, based on your environment’s configuration.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649678480"> <p>
											Specified in cores or millicores, for example, 200m, 0.5, 1. For example, Proof of concept = 500m, Minimum deployment =1
										</p>
										 </td><td align="left" valign="top" headers="idm140663649677392"> </td></tr><tr><td align="left" valign="top" headers="idm140663649680656">
<pre class="literallayout">elasticsearch:
  resources:
    limits:
      memory:</pre>
										 </td><td align="left" valign="top" headers="idm140663649679568"> <p>
											Available memory limit based on your environment’s configuration.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649678480"> <p>
											Specified in bytes, for example, 200Ki, 50Mi, 5Gi. For example, Proof of concept = 1Gi, Minimum deployment = 16Gi*
										</p>
										 </td><td align="left" valign="top" headers="idm140663649677392"> </td></tr><tr><td align="left" valign="top" headers="idm140663649680656">
<pre class="literallayout">elasticsearch:
  redundancyPolicy:</pre>
										 </td><td align="left" valign="top" headers="idm140663649679568"> <p>
											Data replication policy defines how Elasticsearch shards are replicated across data nodes in the cluster. If not specified, the Red Hat OpenShift distributed tracing platform (Jaeger) Operator automatically determines the most appropriate replication based on number of nodes.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649678480"> <p>
											<code class="literal">ZeroRedundancy</code>(no replica shards), <code class="literal">SingleRedundancy</code>(one replica shard), <code class="literal">MultipleRedundancy</code>(each index is spread over half of the Data nodes), <code class="literal">FullRedundancy</code> (each index is fully replicated on every Data node in the cluster).
										</p>
										 </td><td align="left" valign="top" headers="idm140663649677392"> </td></tr><tr><td align="left" valign="top" headers="idm140663649680656">
<pre class="literallayout">elasticsearch:
  useCertManagement:</pre>
										 </td><td align="left" valign="top" headers="idm140663649679568"> <p>
											Use to specify whether or not distributed tracing platform (Jaeger) should use the certificate management feature of the Red Hat Elasticsearch Operator. This feature was added to logging subsystem for Red Hat OpenShift 5.2 in OpenShift Container Platform 4.7 and is the preferred setting for new Jaeger deployments.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649678480"> <p>
											<code class="literal">true</code>/<code class="literal">false</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663649677392"> <p>
											<code class="literal">true</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649680656">
<pre class="literallayout"><!--Empty--></pre>
										 </td><td colspan="3" align="left" valign="top" headers="idm140663649679568 idm140663649680656 idm140663649677392"> <p>
											*Each Elasticsearch node can operate with a lower memory setting though this is NOT recommended for production deployments. For production use, you should have no less than 16Gi allocated to each pod by default, but preferably allocate as much as you can, up to 64Gi per pod.
										</p>
										 </td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Production storage example</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: jaegertracing.io/v1
kind: Jaeger
metadata:
  name: simple-prod
spec:
  strategy: production
  storage:
    type: elasticsearch
    elasticsearch:
      nodeCount: 3
      resources:
        requests:
          cpu: 1
          memory: 16Gi
        limits:
          memory: 16Gi</pre>

							</p></div><div class="formalpara"><p class="title"><strong>Storage example with persistent storage:</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: jaegertracing.io/v1
kind: Jaeger
metadata:
  name: simple-prod
spec:
  strategy: production
  storage:
    type: elasticsearch
    elasticsearch:
      nodeCount: 1
      storage: <span id="CO21-1"><!--Empty--></span><span class="callout">1</span>
        storageClassName: gp2
        size: 5Gi
      resources:
        requests:
          cpu: 200m
          memory: 4Gi
        limits:
          memory: 4Gi
      redundancyPolicy: ZeroRedundancy</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO21-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Persistent storage configuration. In this case AWS <code class="literal">gp2</code> with <code class="literal">5Gi</code> size. When no value is specified, distributed tracing platform (Jaeger) uses <code class="literal">emptyDir</code>. The OpenShift Elasticsearch Operator provisions <code class="literal">PersistentVolumeClaim</code> and <code class="literal">PersistentVolume</code> which are not removed with distributed tracing platform (Jaeger) instance. You can mount the same volumes if you create a distributed tracing platform (Jaeger) instance with the same name and namespace.
								</div></dd></dl></div></section><section class="section" id="distributed-tracing-config-external-es_jaeger-config-reference"><div class="titlepage"><div><div><h5 class="title">1.26.4.6.2. Connecting to an existing Elasticsearch instance</h5></div></div></div><p>
							You can use an existing Elasticsearch cluster for storage with distributed tracing platform. An existing Elasticsearch cluster, also known as an <span class="emphasis"><em>external</em></span> Elasticsearch instance, is an instance that was not installed by the Red Hat OpenShift distributed tracing platform (Jaeger) Operator or by the Red Hat Elasticsearch Operator.
						</p><p>
							When you deploy a Jaeger custom resource, the Red Hat OpenShift distributed tracing platform (Jaeger) Operator will not provision Elasticsearch if the following configurations are set:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">spec.storage.elasticsearch.doNotProvision</code> set to <code class="literal">true</code>
								</li><li class="listitem">
									<code class="literal">spec.storage.options.es.server-urls</code> has a value
								</li><li class="listitem">
									<code class="literal">spec.storage.elasticsearch.name</code> has a value, or if the Elasticsearch instance name is <code class="literal">elasticsearch</code>.
								</li></ul></div><p>
							The Red Hat OpenShift distributed tracing platform (Jaeger) Operator uses the Elasticsearch instance specified in <code class="literal">spec.storage.elasticsearch.name</code> to connect to Elasticsearch.
						</p><div class="itemizedlist"><p class="title"><strong>Restrictions</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									You cannot share or reuse a OpenShift Container Platform logging Elasticsearch instance with distributed tracing platform (Jaeger). The Elasticsearch cluster is meant to be dedicated for a single distributed tracing platform (Jaeger) instance.
								</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Red Hat does not provide support for your external Elasticsearch instance. You can review the tested integrations matrix on the <a class="link" href="https://access.redhat.com/articles/5381021">Customer Portal</a>.
							</p></div></div><p>
							The following configuration parameters are for an already existing Elasticsearch instance, also known as an <span class="emphasis"><em>external</em></span> Elasticsearch instance. In this case, you specify configuration options for Elasticsearch under <code class="literal">spec:storage:options:es</code> in your custom resource file.
						</p><div class="table" id="idm140663650401536"><p class="title"><strong>Table 1.46. General ES configuration parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663650394832" scope="col">Parameter</th><th align="left" valign="top" id="idm140663650393744" scope="col">Description</th><th align="left" valign="top" id="idm140663650392656" scope="col">Values</th><th align="left" valign="top" id="idm140663650391568" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663650394832">
<pre class="literallayout">es:
  server-urls:</pre>
										 </td><td align="left" valign="top" headers="idm140663650393744"> <p>
											URL of the Elasticsearch instance.
										</p>
										 </td><td align="left" valign="top" headers="idm140663650392656"> <p>
											The fully-qualified domain name of the Elasticsearch server.
										</p>
										 </td><td align="left" valign="top" headers="idm140663650391568"> <p>
											<code class="literal"><a class="link" href="http://elasticsearch.&lt;namespace&gt;.svc:9200">http://elasticsearch.&lt;namespace&gt;.svc:9200</a></code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663650394832">
<pre class="literallayout">es:
  max-doc-count:</pre>
										 </td><td align="left" valign="top" headers="idm140663650393744"> <p>
											The maximum document count to return from an Elasticsearch query. This will also apply to aggregations. If you set both <code class="literal">es.max-doc-count</code> and <code class="literal">es.max-num-spans</code>, Elasticsearch will use the smaller value of the two.
										</p>
										 </td><td align="left" valign="top" headers="idm140663650392656"> </td><td align="left" valign="top" headers="idm140663650391568"> <p>
											10000
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663650394832">
<pre class="literallayout">es:
  max-num-spans:</pre>
										 </td><td align="left" valign="top" headers="idm140663650393744"> <p>
											[<span class="strong strong"><strong>Deprecated</strong></span> - Will be removed in a future release, use <code class="literal">es.max-doc-count</code> instead.] The maximum number of spans to fetch at a time, per query, in Elasticsearch. If you set both <code class="literal">es.max-num-spans</code> and <code class="literal">es.max-doc-count</code>, Elasticsearch will use the smaller value of the two.
										</p>
										 </td><td align="left" valign="top" headers="idm140663650392656"> </td><td align="left" valign="top" headers="idm140663650391568"> <p>
											10000
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663650394832">
<pre class="literallayout">es:
  max-span-age:</pre>
										 </td><td align="left" valign="top" headers="idm140663650393744"> <p>
											The maximum lookback for spans in Elasticsearch.
										</p>
										 </td><td align="left" valign="top" headers="idm140663650392656"> </td><td align="left" valign="top" headers="idm140663650391568"> <p>
											72h0m0s
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663650394832">
<pre class="literallayout">es:
  sniffer:</pre>
										 </td><td align="left" valign="top" headers="idm140663650393744"> <p>
											The sniffer configuration for Elasticsearch. The client uses the sniffing process to find all nodes automatically. Disabled by default.
										</p>
										 </td><td align="left" valign="top" headers="idm140663650392656"> <p>
											<code class="literal">true</code>/ <code class="literal">false</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663650391568"> <p>
											<code class="literal">false</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663650394832">
<pre class="literallayout">es:
  sniffer-tls-enabled:</pre>
										 </td><td align="left" valign="top" headers="idm140663650393744"> <p>
											Option to enable TLS when sniffing an Elasticsearch Cluster. The client uses the sniffing process to find all nodes automatically. Disabled by default
										</p>
										 </td><td align="left" valign="top" headers="idm140663650392656"> <p>
											<code class="literal">true</code>/ <code class="literal">false</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663650391568"> <p>
											<code class="literal">false</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663650394832">
<pre class="literallayout">es:
  timeout:</pre>
										 </td><td align="left" valign="top" headers="idm140663650393744"> <p>
											Timeout used for queries. When set to zero there is no timeout.
										</p>
										 </td><td align="left" valign="top" headers="idm140663650392656"> </td><td align="left" valign="top" headers="idm140663650391568"> <p>
											0s
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663650394832">
<pre class="literallayout">es:
  username:</pre>
										 </td><td align="left" valign="top" headers="idm140663650393744"> <p>
											The username required by Elasticsearch. The basic authentication also loads CA if it is specified. See also <code class="literal">es.password</code>.
										</p>
										 </td><td align="left" valign="top" headers="idm140663650392656"> </td><td align="left" valign="top" headers="idm140663650391568"> </td></tr><tr><td align="left" valign="top" headers="idm140663650394832">
<pre class="literallayout">es:
  password:</pre>
										 </td><td align="left" valign="top" headers="idm140663650393744"> <p>
											The password required by Elasticsearch. See also, <code class="literal">es.username</code>.
										</p>
										 </td><td align="left" valign="top" headers="idm140663650392656"> </td><td align="left" valign="top" headers="idm140663650391568"> </td></tr><tr><td align="left" valign="top" headers="idm140663650394832">
<pre class="literallayout">es:
  version:</pre>
										 </td><td align="left" valign="top" headers="idm140663650393744"> <p>
											The major Elasticsearch version. If not specified, the value will be auto-detected from Elasticsearch.
										</p>
										 </td><td align="left" valign="top" headers="idm140663650392656"> </td><td align="left" valign="top" headers="idm140663650391568"> <p>
											0
										</p>
										 </td></tr></tbody></table></div></div><div class="table" id="idm140663647310928"><p class="title"><strong>Table 1.47. ES data replication parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663647304224" scope="col">Parameter</th><th align="left" valign="top" id="idm140663647303136" scope="col">Description</th><th align="left" valign="top" id="idm140663647302048" scope="col">Values</th><th align="left" valign="top" id="idm140663647300960" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663647304224">
<pre class="literallayout">es:
  num-replicas:</pre>
										 </td><td align="left" valign="top" headers="idm140663647303136"> <p>
											The number of replicas per index in Elasticsearch.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647302048"> </td><td align="left" valign="top" headers="idm140663647300960"> <p>
											1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647304224">
<pre class="literallayout">es:
  num-shards:</pre>
										 </td><td align="left" valign="top" headers="idm140663647303136"> <p>
											The number of shards per index in Elasticsearch.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647302048"> </td><td align="left" valign="top" headers="idm140663647300960"> <p>
											5
										</p>
										 </td></tr></tbody></table></div></div><div class="table" id="idm140663647285776"><p class="title"><strong>Table 1.48. ES index configuration parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663647279072" scope="col">Parameter</th><th align="left" valign="top" id="idm140663647277984" scope="col">Description</th><th align="left" valign="top" id="idm140663649883856" scope="col">Values</th><th align="left" valign="top" id="idm140663649882768" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663647279072">
<pre class="literallayout">es:
  create-index-templates:</pre>
										 </td><td align="left" valign="top" headers="idm140663647277984"> <p>
											Automatically create index templates at application startup when set to <code class="literal">true</code>. When templates are installed manually, set to <code class="literal">false</code>.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649883856"> <p>
											<code class="literal">true</code>/ <code class="literal">false</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663649882768"> <p>
											<code class="literal">true</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647279072">
<pre class="literallayout">es:
  index-prefix:</pre>
										 </td><td align="left" valign="top" headers="idm140663647277984"> <p>
											Optional prefix for distributed tracing platform (Jaeger) indices. For example, setting this to "production" creates indices named "production-tracing-*".
										</p>
										 </td><td align="left" valign="top" headers="idm140663649883856"> </td><td align="left" valign="top" headers="idm140663649882768"> </td></tr></tbody></table></div></div><div class="table" id="idm140663649865120"><p class="title"><strong>Table 1.49. ES bulk processor configuration parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663649858400" scope="col">Parameter</th><th align="left" valign="top" id="idm140663649857312" scope="col">Description</th><th align="left" valign="top" id="idm140663649856224" scope="col">Values</th><th align="left" valign="top" id="idm140663649855136" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663649858400">
<pre class="literallayout">es:
  bulk:
    actions:</pre>
										 </td><td align="left" valign="top" headers="idm140663649857312"> <p>
											The number of requests that can be added to the queue before the bulk processor decides to commit updates to disk.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649856224"> </td><td align="left" valign="top" headers="idm140663649855136"> <p>
											1000
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649858400">
<pre class="literallayout">es:
  bulk:
    flush-interval:</pre>
										 </td><td align="left" valign="top" headers="idm140663649857312"> <p>
											A <code class="literal">time.Duration</code> after which bulk requests are committed, regardless of other thresholds. To disable the bulk processor flush interval, set this to zero.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649856224"> </td><td align="left" valign="top" headers="idm140663649855136"> <p>
											200ms
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649858400">
<pre class="literallayout">es:
  bulk:
    size:</pre>
										 </td><td align="left" valign="top" headers="idm140663649857312"> <p>
											The number of bytes that the bulk requests can take up before the bulk processor decides to commit updates to disk.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649856224"> </td><td align="left" valign="top" headers="idm140663649855136"> <p>
											5000000
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649858400">
<pre class="literallayout">es:
  bulk:
    workers:</pre>
										 </td><td align="left" valign="top" headers="idm140663649857312"> <p>
											The number of workers that are able to receive and commit bulk requests to Elasticsearch.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649856224"> </td><td align="left" valign="top" headers="idm140663649855136"> <p>
											1
										</p>
										 </td></tr></tbody></table></div></div><div class="table" id="idm140663649826192"><p class="title"><strong>Table 1.50. ES TLS configuration parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663649819488" scope="col">Parameter</th><th align="left" valign="top" id="idm140663649818400" scope="col">Description</th><th align="left" valign="top" id="idm140663649817312" scope="col">Values</th><th align="left" valign="top" id="idm140663649816224" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663649819488">
<pre class="literallayout">es:
  tls:
    ca:</pre>
										 </td><td align="left" valign="top" headers="idm140663649818400"> <p>
											Path to a TLS Certification Authority (CA) file used to verify the remote servers.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649817312"> </td><td align="left" valign="top" headers="idm140663649816224"> <p>
											Will use the system truststore by default.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649819488">
<pre class="literallayout">es:
  tls:
    cert:</pre>
										 </td><td align="left" valign="top" headers="idm140663649818400"> <p>
											Path to a TLS Certificate file, used to identify this process to the remote servers.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649817312"> </td><td align="left" valign="top" headers="idm140663649816224"> </td></tr><tr><td align="left" valign="top" headers="idm140663649819488">
<pre class="literallayout">es:
  tls:
    enabled:</pre>
										 </td><td align="left" valign="top" headers="idm140663649818400"> <p>
											Enable transport layer security (TLS) when talking to the remote servers. Disabled by default.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649817312"> <p>
											<code class="literal">true</code>/ <code class="literal">false</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663649816224"> <p>
											<code class="literal">false</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649819488">
<pre class="literallayout">es:
  tls:
    key:</pre>
										 </td><td align="left" valign="top" headers="idm140663649818400"> <p>
											Path to a TLS Private Key file, used to identify this process to the remote servers.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649817312"> </td><td align="left" valign="top" headers="idm140663649816224"> </td></tr><tr><td align="left" valign="top" headers="idm140663649819488">
<pre class="literallayout">es:
  tls:
    server-name:</pre>
										 </td><td align="left" valign="top" headers="idm140663649818400"> <p>
											Override the expected TLS server name in the certificate of the remote servers.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649817312"> </td><td align="left" valign="top" headers="idm140663649816224"> </td></tr><tr><td align="left" valign="top" headers="idm140663649819488">
<pre class="literallayout">es:
  token-file:</pre>
										 </td><td align="left" valign="top" headers="idm140663649818400"> <p>
											Path to a file containing the bearer token. This flag also loads the Certification Authority (CA) file if it is specified.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649817312"> </td><td align="left" valign="top" headers="idm140663649816224"> </td></tr></tbody></table></div></div><div class="table" id="idm140663647226608"><p class="title"><strong>Table 1.51. ES archive configuration parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663647219904" scope="col">Parameter</th><th align="left" valign="top" id="idm140663647218816" scope="col">Description</th><th align="left" valign="top" id="idm140663647217728" scope="col">Values</th><th align="left" valign="top" id="idm140663647216640" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  bulk:
    actions:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											The number of requests that can be added to the queue before the bulk processor decides to commit updates to disk.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  bulk:
    flush-interval:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											A <code class="literal">time.Duration</code> after which bulk requests are committed, regardless of other thresholds. To disable the bulk processor flush interval, set this to zero.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											0s
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  bulk:
    size:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											The number of bytes that the bulk requests can take up before the bulk processor decides to commit updates to disk.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  bulk:
    workers:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											The number of workers that are able to receive and commit bulk requests to Elasticsearch.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  create-index-templates:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											Automatically create index templates at application startup when set to <code class="literal">true</code>. When templates are installed manually, set to <code class="literal">false</code>.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> <p>
											<code class="literal">true</code>/ <code class="literal">false</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											<code class="literal">false</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  enabled:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											Enable extra storage.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> <p>
											<code class="literal">true</code>/ <code class="literal">false</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											<code class="literal">false</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  index-prefix:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											Optional prefix for distributed tracing platform (Jaeger) indices. For example, setting this to "production" creates indices named "production-tracing-*".
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  max-doc-count:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											The maximum document count to return from an Elasticsearch query. This will also apply to aggregations.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  max-num-spans:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											[<span class="strong strong"><strong>Deprecated</strong></span> - Will be removed in a future release, use <code class="literal">es-archive.max-doc-count</code> instead.] The maximum number of spans to fetch at a time, per query, in Elasticsearch.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  max-span-age:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											The maximum lookback for spans in Elasticsearch.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											0s
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  num-replicas:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											The number of replicas per index in Elasticsearch.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  num-shards:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											The number of shards per index in Elasticsearch.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  password:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											The password required by Elasticsearch. See also, <code class="literal">es.username</code>.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  server-urls:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											The comma-separated list of Elasticsearch servers. Must be specified as fully qualified URLs, for example, <code class="literal">http://localhost:9200</code>.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  sniffer:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											The sniffer configuration for Elasticsearch. The client uses the sniffing process to find all nodes automatically. Disabled by default.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> <p>
											<code class="literal">true</code>/ <code class="literal">false</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											<code class="literal">false</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  sniffer-tls-enabled:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											Option to enable TLS when sniffing an Elasticsearch Cluster. The client uses the sniffing process to find all nodes automatically. Disabled by default.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> <p>
											<code class="literal">true</code>/ <code class="literal">false</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											<code class="literal">false</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  timeout:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											Timeout used for queries. When set to zero there is no timeout.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											0s
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  tls:
    ca:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											Path to a TLS Certification Authority (CA) file used to verify the remote servers.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											Will use the system truststore by default.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  tls:
    cert:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											Path to a TLS Certificate file, used to identify this process to the remote servers.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  tls:
    enabled:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											Enable transport layer security (TLS) when talking to the remote servers. Disabled by default.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> <p>
											<code class="literal">true</code>/ <code class="literal">false</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											<code class="literal">false</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  tls:
    key:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											Path to a TLS Private Key file, used to identify this process to the remote servers.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  tls:
    server-name:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											Override the expected TLS server name in the certificate of the remote servers.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  token-file:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											Path to a file containing the bearer token. This flag also loads the Certification Authority (CA) file if it is specified.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  username:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											The username required by Elasticsearch. The basic authentication also loads CA if it is specified. See also <code class="literal">es-archive.password</code>.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> </td></tr><tr><td align="left" valign="top" headers="idm140663647219904">
<pre class="literallayout">es-archive:
  version:</pre>
										 </td><td align="left" valign="top" headers="idm140663647218816"> <p>
											The major Elasticsearch version. If not specified, the value will be auto-detected from Elasticsearch.
										</p>
										 </td><td align="left" valign="top" headers="idm140663647217728"> </td><td align="left" valign="top" headers="idm140663647216640"> <p>
											0
										</p>
										 </td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Storage example with volume mounts</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: jaegertracing.io/v1
kind: Jaeger
metadata:
  name: simple-prod
spec:
  strategy: production
  storage:
    type: elasticsearch
    options:
      es:
        server-urls: https://quickstart-es-http.default.svc:9200
        index-prefix: my-prefix
        tls:
          ca: /es/certificates/ca.crt
    secretName: tracing-secret
  volumeMounts:
    - name: certificates
      mountPath: /es/certificates/
      readOnly: true
  volumes:
    - name: certificates
      secret:
        secretName: quickstart-es-http-certs-public</pre>

							</p></div><p>
							The following example shows a Jaeger CR using an external Elasticsearch cluster with TLS CA certificate mounted from a volume and user/password stored in a secret.
						</p><div class="formalpara"><p class="title"><strong>External Elasticsearch example</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: jaegertracing.io/v1
kind: Jaeger
metadata:
  name: simple-prod
spec:
  strategy: production
  storage:
    type: elasticsearch
    options:
      es:
        server-urls: https://quickstart-es-http.default.svc:9200 <span id="CO22-1"><!--Empty--></span><span class="callout">1</span>
        index-prefix: my-prefix
        tls: <span id="CO22-2"><!--Empty--></span><span class="callout">2</span>
          ca: /es/certificates/ca.crt
    secretName: tracing-secret <span id="CO22-3"><!--Empty--></span><span class="callout">3</span>
  volumeMounts: <span id="CO22-4"><!--Empty--></span><span class="callout">4</span>
    - name: certificates
      mountPath: /es/certificates/
      readOnly: true
  volumes:
    - name: certificates
      secret:
        secretName: quickstart-es-http-certs-public</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO22-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									URL to Elasticsearch service running in default namespace.
								</div></dd><dt><a href="#CO22-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									TLS configuration. In this case only CA certificate, but it can also contain es.tls.key and es.tls.cert when using mutual TLS.
								</div></dd><dt><a href="#CO22-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Secret which defines environment variables ES_PASSWORD and ES_USERNAME. Created by kubectl create secret generic tracing-secret --from-literal=ES_PASSWORD=changeme --from-literal=ES_USERNAME=elastic
								</div></dd><dt><a href="#CO22-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									Volume mounts and volumes which are mounted into all storage components.
								</div></dd></dl></div></section></section><section class="section" id="distr-tracing-manage-es-certificates_jaeger-config-reference"><div class="titlepage"><div><div><h4 class="title">1.26.4.7. Managing certificates with Elasticsearch</h4></div></div></div><p>
						You can create and manage certificates using the Red Hat Elasticsearch Operator. Managing certificates using the Red Hat Elasticsearch Operator also lets you use a single Elasticsearch cluster with multiple Jaeger Collectors.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Managing certificates with Elasticsearch is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
						</p><p>
							For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
						</p></div></div><p>
						Starting with version 2.4, the Red Hat OpenShift distributed tracing platform (Jaeger) Operator delegates certificate creation to the Red Hat Elasticsearch Operator by using the following annotations in the Elasticsearch custom resource:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">logging.openshift.io/elasticsearch-cert-management: "true"</code>
							</li><li class="listitem">
								<code class="literal">logging.openshift.io/elasticsearch-cert.jaeger-&lt;shared-es-node-name&gt;: "user.jaeger"</code>
							</li><li class="listitem">
								<code class="literal">logging.openshift.io/elasticsearch-cert.curator-&lt;shared-es-node-name&gt;: "system.logging.curator"</code>
							</li></ul></div><p>
						Where the <code class="literal">&lt;shared-es-node-name&gt;</code> is the name of the Elasticsearch node. For example, if you create an Elasticsearch node named <code class="literal">custom-es</code>, your custom resource might look like the following example.
					</p><div class="formalpara"><p class="title"><strong>Example Elasticsearch CR showing annotations</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: logging.openshift.io/v1
kind: Elasticsearch
metadata:
  annotations:
    logging.openshift.io/elasticsearch-cert-management: "true"
    logging.openshift.io/elasticsearch-cert.jaeger-custom-es: "user.jaeger"
    logging.openshift.io/elasticsearch-cert.curator-custom-es: "system.logging.curator"
  name: custom-es
spec:
  managementState: Managed
  nodeSpec:
    resources:
      limits:
        memory: 16Gi
      requests:
        cpu: 1
        memory: 16Gi
  nodes:
    - nodeCount: 3
      proxyResources: {}
      resources: {}
      roles:
        - master
        - client
        - data
      storage: {}
  redundancyPolicy: ZeroRedundancy</pre>

						</p></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								OpenShift Container Platform 4.7
							</li><li class="listitem">
								logging subsystem for Red Hat OpenShift 5.2
							</li><li class="listitem">
								The Elasticsearch node and the Jaeger instances must be deployed in the same namespace. For example, <code class="literal">tracing-system</code>.
							</li></ul></div><p>
						You enable certificate management by setting <code class="literal">spec.storage.elasticsearch.useCertManagement</code> to <code class="literal">true</code> in the Jaeger custom resource.
					</p><div class="formalpara"><p class="title"><strong>Example showing <code class="literal">useCertManagement</code></strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: jaegertracing.io/v1
kind: Jaeger
metadata:
  name: jaeger-prod
spec:
  strategy: production
  storage:
    type: elasticsearch
    elasticsearch:
      name: custom-es
      doNotProvision: true
      useCertManagement: true</pre>

						</p></div><p>
						The Red Hat OpenShift distributed tracing platform (Jaeger) Operator sets the Elasticsearch custom resource <code class="literal">name</code> to the value of <code class="literal">spec.storage.elasticsearch.name</code> from the Jaeger custom resource when provisioning Elasticsearch.
					</p><p>
						The certificates are provisioned by the Red Hat Elasticsearch Operator and the Red Hat OpenShift distributed tracing platform (Jaeger) Operator injects the certificates.
					</p><p>
						For more information about configuring Elasticsearch with OpenShift Container Platform, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/logging/#configuring-the-log-store">Configuring the log store</a> or <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/distributed_tracing/#configuration">Configuring and deploying distributed tracing</a>.
					</p></section><section class="section" id="distr-tracing-config-query_jaeger-config-reference"><div class="titlepage"><div><div><h4 class="title">1.26.4.8. Query configuration options</h4></div></div></div><p>
						Query is a service that retrieves traces from storage and hosts the user interface to display them.
					</p><div class="table" id="idm140663647973024"><p class="title"><strong>Table 1.52. Parameters used by the Red Hat OpenShift distributed tracing platform (Jaeger) Operator to define Query</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663647966256" scope="col">Parameter</th><th align="left" valign="top" id="idm140663647965168" scope="col">Description</th><th align="left" valign="top" id="idm140663647964080" scope="col">Values</th><th align="left" valign="top" id="idm140663647962992" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663647966256">
<pre class="literallayout">spec:
  query:
    replicas:</pre>
									 </td><td align="left" valign="top" headers="idm140663647965168"> <p>
										Specifies the number of Query replicas to create.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647964080"> <p>
										Integer, for example, <code class="literal">2</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663647962992"> </td></tr></tbody></table></div></div><div class="table" id="idm140663647953808"><p class="title"><strong>Table 1.53. Configuration parameters passed to Query</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663647947152" scope="col">Parameter</th><th align="left" valign="top" id="idm140663647946064" scope="col">Description</th><th align="left" valign="top" id="idm140663647944976" scope="col">Values</th><th align="left" valign="top" id="idm140663647943888" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663647947152">
<pre class="literallayout">spec:
  query:
    options: {}</pre>
									 </td><td align="left" valign="top" headers="idm140663647946064"> <p>
										Configuration options that define the Query service.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647944976"> </td><td align="left" valign="top" headers="idm140663647943888"> </td></tr><tr><td align="left" valign="top" headers="idm140663647947152">
<pre class="literallayout">options:
  log-level:</pre>
									 </td><td align="left" valign="top" headers="idm140663647946064"> <p>
										Logging level for Query.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647944976"> <p>
										Possible values: <code class="literal">debug</code>, <code class="literal">info</code>, <code class="literal">warn</code>, <code class="literal">error</code>, <code class="literal">fatal</code>, <code class="literal">panic</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647943888"> </td></tr><tr><td align="left" valign="top" headers="idm140663647947152">
<pre class="literallayout">options:
  query:
    base-path:</pre>
									 </td><td align="left" valign="top" headers="idm140663647946064"> <p>
										The base path for all jaeger-query HTTP routes can be set to a non-root value, for example, <code class="literal">/jaeger</code> would cause all UI URLs to start with <code class="literal">/jaeger</code>. This can be useful when running jaeger-query behind a reverse proxy.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647944976"> <p>
										/&lt;path&gt;
									</p>
									 </td><td align="left" valign="top" headers="idm140663647943888"> </td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Sample Query configuration</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: jaegertracing.io/v1
kind: "Jaeger"
metadata:
  name: "my-jaeger"
spec:
  strategy: allInOne
  allInOne:
    options:
      log-level: debug
      query:
        base-path: /jaeger</pre>

						</p></div></section><section class="section" id="distr-tracing-config-ingester_jaeger-config-reference"><div class="titlepage"><div><div><h4 class="title">1.26.4.9. Ingester configuration options</h4></div></div></div><p>
						Ingester is a service that reads from a Kafka topic and writes to the Elasticsearch storage backend. If you are using the <code class="literal">allInOne</code> or <code class="literal">production</code> deployment strategies, you do not need to configure the Ingester service.
					</p><div class="table" id="idm140663647803312"><p class="title"><strong>Table 1.54. Jaeger parameters passed to the Ingester</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663647797584" scope="col">Parameter</th><th align="left" valign="top" id="idm140663647796496" scope="col">Description</th><th align="left" valign="top" id="idm140663647795408" scope="col">Values</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663647797584">
<pre class="literallayout">spec:
  ingester:
    options: {}</pre>
									 </td><td align="left" valign="top" headers="idm140663647796496"> <p>
										Configuration options that define the Ingester service.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647795408"> </td></tr><tr><td align="left" valign="top" headers="idm140663647797584">
<pre class="literallayout">options:
  deadlockInterval:</pre>
									 </td><td align="left" valign="top" headers="idm140663647796496"> <p>
										Specifies the interval, in seconds or minutes, that the Ingester must wait for a message before terminating. The deadlock interval is disabled by default (set to <code class="literal">0</code>), to avoid terminating the Ingester when no messages arrive during system initialization.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647795408"> <p>
										Minutes and seconds, for example, <code class="literal">1m0s</code>. Default value is <code class="literal">0</code>.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663647797584">
<pre class="literallayout">options:
  kafka:
    consumer:
      topic:</pre>
									 </td><td align="left" valign="top" headers="idm140663647796496"> <p>
										The <code class="literal">topic</code> parameter identifies the Kafka configuration used by the collector to produce the messages, and the Ingester to consume the messages.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647795408"> <p>
										Label for the consumer. For example, <code class="literal">jaeger-spans</code>.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663647797584">
<pre class="literallayout">options:
  kafka:
    consumer:
      brokers:</pre>
									 </td><td align="left" valign="top" headers="idm140663647796496"> <p>
										Identifies the Kafka configuration used by the Ingester to consume the messages.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647795408"> <p>
										Label for the broker, for example, <code class="literal">my-cluster-kafka-brokers.kafka:9092</code>.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663647797584">
<pre class="literallayout">options:
  log-level:</pre>
									 </td><td align="left" valign="top" headers="idm140663647796496"> <p>
										Logging level for the Ingester.
									</p>
									 </td><td align="left" valign="top" headers="idm140663647795408"> <p>
										Possible values: <code class="literal">debug</code>, <code class="literal">info</code>, <code class="literal">warn</code>, <code class="literal">error</code>, <code class="literal">fatal</code>, <code class="literal">dpanic</code>, <code class="literal">panic</code>.
									</p>
									 </td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Streaming Collector and Ingester example</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: jaegertracing.io/v1
kind: Jaeger
metadata:
  name: simple-streaming
spec:
  strategy: streaming
  collector:
    options:
      kafka:
        producer:
          topic: jaeger-spans
          brokers: my-cluster-kafka-brokers.kafka:9092
  ingester:
    options:
      kafka:
        consumer:
          topic: jaeger-spans
          brokers: my-cluster-kafka-brokers.kafka:9092
      ingester:
        deadlockInterval: 5
  storage:
    type: elasticsearch
    options:
      es:
        server-urls: http://elasticsearch:9200</pre>

						</p></div></section></section></section><section class="section" id="removing-ossm"><div class="titlepage"><div><div><h2 class="title">1.27. Uninstalling Service Mesh</h2></div></div></div><p>
				To uninstall Red Hat OpenShift Service Mesh from an existing OpenShift Container Platform instance and remove its resources, you must delete the control plane, delete the Operators, and run commands to manually remove some resources.
			</p><section class="section" id="ossm-control-plane-remove_removing-ossm"><div class="titlepage"><div><div><h3 class="title">1.27.1. Removing the Red Hat OpenShift Service Mesh control plane</h3></div></div></div><p>
					To uninstall Service Mesh from an existing OpenShift Container Platform instance, first you delete the Service Mesh control plane and the Operators. Then, you run commands to remove residual resources.
				</p><section class="section" id="ossm-control-plane-remove-operatorhub_removing-ossm"><div class="titlepage"><div><div><h4 class="title">1.27.1.1. Removing the Service Mesh control plane using the web console</h4></div></div></div><p>
						You can remove the Red Hat OpenShift Service Mesh control plane by using the web console.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Project</strong></span> menu and select the project where you installed the Service Mesh control plane, for example <span class="strong strong"><strong>istio-system</strong></span>.
							</li><li class="listitem">
								Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Service Mesh Control Plane</strong></span> under <span class="strong strong"><strong>Provided APIs</strong></span>.
							</li><li class="listitem">
								Click the <code class="literal">ServiceMeshControlPlane</code> menu 
								<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
								 .
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Delete Service Mesh Control Plane</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Delete</strong></span> on the confirmation dialog window to remove the <code class="literal">ServiceMeshControlPlane</code>.
							</li></ol></div></section><section class="section" id="ossm-control-plane-remove-cli_removing-ossm"><div class="titlepage"><div><div><h4 class="title">1.27.1.2. Removing the Service Mesh control plane using the CLI</h4></div></div></div><p>
						You can remove the Red Hat OpenShift Service Mesh control plane by using the CLI. In this example, <code class="literal">istio-system</code> is the name of the control plane project.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform CLI.
							</li><li class="listitem"><p class="simpara">
								Run the following command to delete the <code class="literal">ServiceMeshMemberRoll</code> resource.
							</p><pre class="programlisting language-terminal">$ oc delete smmr -n istio-system default</pre></li><li class="listitem"><p class="simpara">
								Run this command to retrieve the name of the installed <code class="literal">ServiceMeshControlPlane</code>:
							</p><pre class="programlisting language-terminal">$ oc get smcp -n istio-system</pre></li><li class="listitem"><p class="simpara">
								Replace <code class="literal">&lt;name_of_custom_resource&gt;</code> with the output from the previous command, and run this command to remove the custom resource:
							</p><pre class="programlisting language-terminal">$ oc delete smcp -n istio-system &lt;name_of_custom_resource&gt;</pre></li></ol></div></section></section><section class="section" id="ossm-operatorhub-remove-operators_removing-ossm"><div class="titlepage"><div><div><h3 class="title">1.27.2. Removing the installed Operators</h3></div></div></div><p>
					You must remove the Operators to successfully remove Red Hat OpenShift Service Mesh. After you remove the Red Hat OpenShift Service Mesh Operator, you must remove the Kiali Operator, the Red Hat OpenShift distributed tracing platform (Jaeger) Operator, and the OpenShift Elasticsearch Operator.
				</p><section class="section" id="ossm-remove-operator-servicemesh_removing-ossm"><div class="titlepage"><div><div><h4 class="title">1.27.2.1. Removing the Operators</h4></div></div></div><p>
						Follow this procedure to remove the Operators that make up Red Hat OpenShift Service Mesh. Repeat the steps for each of the following Operators.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Red Hat OpenShift Service Mesh
							</li><li class="listitem">
								Kiali
							</li><li class="listitem">
								Red Hat OpenShift distributed tracing platform (Jaeger)
							</li><li class="listitem">
								OpenShift Elasticsearch
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console.
							</li><li class="listitem">
								From the <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> page, scroll or type a keyword into the <span class="strong strong"><strong>Filter by name</strong></span> to find each Operator. Then, click the Operator name.
							</li><li class="listitem">
								On the <span class="strong strong"><strong>Operator Details</strong></span> page, select <span class="strong strong"><strong>Uninstall Operator</strong></span> from the <span class="strong strong"><strong>Actions</strong></span> menu. Follow the prompts to uninstall each Operator.
							</li></ol></div></section></section><section class="section" id="ossm-remove-cleanup_removing-ossm"><div class="titlepage"><div><div><h3 class="title">1.27.3. Clean up Operator resources</h3></div></div></div><p>
					You can manually remove resources left behind after removing the Red Hat OpenShift Service Mesh Operator using the OpenShift Container Platform web console.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							An account with cluster administration access. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
						</li><li class="listitem">
							Access to the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform CLI as a cluster administrator.
						</li><li class="listitem"><p class="simpara">
							Run the following commands to clean up resources after uninstalling the Operators. If you intend to keep using distributed tracing platform (Jaeger) as a stand-alone service without service mesh, do not delete the Jaeger resources.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The OpenShift Elasticsearch Operator is installed in <code class="literal">openshift-operators-redhat</code> by default. The other Operators are installed in the <code class="literal">openshift-operators</code> namespace by default. If you installed the Operators in another namespace, replace <code class="literal">openshift-operators</code> with the name of the project where the Red Hat OpenShift Service Mesh Operator was installed.
							</p></div></div><pre class="programlisting language-terminal">$ oc delete validatingwebhookconfiguration/openshift-operators.servicemesh-resources.maistra.io</pre><pre class="programlisting language-terminal">$ oc delete mutatingwebhookconfiguration/openshift-operators.servicemesh-resources.maistra.io</pre><pre class="programlisting language-terminal">$ oc delete svc maistra-admission-controller -n openshift-operators</pre><pre class="programlisting language-terminal">$ oc -n openshift-operators delete ds -lmaistra-version</pre><pre class="programlisting language-terminal">$ oc delete clusterrole/istio-admin clusterrole/istio-cni clusterrolebinding/istio-cni</pre><pre class="programlisting language-terminal">$ oc delete clusterrole istio-view istio-edit</pre><pre class="programlisting language-terminal">$ oc delete clusterrole jaegers.jaegertracing.io-v1-admin jaegers.jaegertracing.io-v1-crdview jaegers.jaegertracing.io-v1-edit jaegers.jaegertracing.io-v1-view</pre><pre class="programlisting language-terminal">$ oc get crds -o name | grep '.*\.istio\.io' | xargs -r -n 1 oc delete</pre><pre class="programlisting language-terminal">$ oc get crds -o name | grep '.*\.maistra\.io' | xargs -r -n 1 oc delete</pre><pre class="programlisting language-terminal">$ oc get crds -o name | grep '.*\.kiali\.io' | xargs -r -n 1 oc delete</pre><pre class="programlisting language-terminal">$ oc delete crds jaegers.jaegertracing.io</pre><pre class="programlisting language-terminal">$ oc delete cm -n openshift-operators maistra-operator-cabundle</pre><pre class="programlisting language-terminal">$ oc delete cm -n openshift-operators istio-cni-config istio-cni-config-v2-3</pre><pre class="programlisting language-terminal">$ oc delete sa -n openshift-operators istio-cni</pre></li></ol></div></section></section></section><section class="chapter" id="service-mesh-1-x"><div class="titlepage"><div><div><h1 class="title">Chapter 2. Service Mesh 1.x</h1></div></div></div><section class="section" id="service-mesh-release-notes-v1x"><div class="titlepage"><div><div><h2 class="title">2.1. Service Mesh Release Notes</h2></div></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					<span class="strong strong"><strong>You are viewing documentation for a Red Hat OpenShift Service Mesh release that is no longer supported.</strong></span>
				</p><p>
					Service Mesh version 1.0 and 1.1 control planes are no longer supported. For information about upgrading your service mesh control plane, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-versions_ossm-upgrade">Upgrading Service Mesh</a>.
				</p><p>
					For information about the support status of a particular Red Hat OpenShift Service Mesh release, see the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ossm">Product lifecycle page</a>.
				</p></div></div><section class="section" id="making-open-source-more-inclusive"><div class="titlepage"><div><div><h3 class="title">2.1.1. Making open source more inclusive</h3></div></div></div><p>
					Red Hat is committed to replacing problematic language in our code, documentation, and web properties. We are beginning with these four terms: master, slave, blacklist, and whitelist. Because of the enormity of this endeavor, these changes will be implemented gradually over several upcoming releases. For more details, see <a class="link" href="https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language">our CTO Chris Wright’s message</a>.
				</p></section><section class="section" id="ossm-servicemesh-overview_ossm-release-notes-v1x"><div class="titlepage"><div><div><h3 class="title">2.1.2. Introduction to Red Hat OpenShift Service Mesh</h3></div></div></div><p>
					Red Hat OpenShift Service Mesh addresses a variety of problems in a microservice architecture by creating a centralized point of control in an application. It adds a transparent layer on existing distributed applications without requiring any changes to the application code.
				</p><p>
					Microservice architectures split the work of enterprise applications into modular services, which can make scaling and maintenance easier. However, as an enterprise application built on a microservice architecture grows in size and complexity, it becomes difficult to understand and manage. Service Mesh can address those architecture problems by capturing or intercepting traffic between services and can modify, redirect, or create new requests to other services.
				</p><p>
					Service Mesh, which is based on the open source <a class="link" href="https://istio.io/">Istio project</a>, provides an easy way to create a network of deployed services that provides discovery, load balancing, service-to-service authentication, failure recovery, metrics, and monitoring. A service mesh also provides more complex operational functionality, including A/B testing, canary releases, access control, and end-to-end authentication.
				</p></section><section class="section" id="support_ossm-release-notes-v1x"><div class="titlepage"><div><div><h3 class="title">2.1.3. Getting support</h3></div></div></div><p>
					If you experience difficulty with a procedure described in this documentation, or with OpenShift Container Platform in general, visit the <a class="link" href="http://access.redhat.com">Red Hat Customer Portal</a>. From the Customer Portal, you can:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Search or browse through the Red Hat Knowledgebase of articles and solutions relating to Red Hat products.
						</li><li class="listitem">
							Submit a support case to Red Hat Support.
						</li><li class="listitem">
							Access other product documentation.
						</li></ul></div><p>
					To identify issues with your cluster, you can use Insights in <a class="link" href="https://console.redhat.com/openshift">OpenShift Cluster Manager Hybrid Cloud Console</a>. Insights provides details about issues and, if available, information on how to solve a problem.
				</p><p>
					If you have a suggestion for improving this documentation or have found an error, submit a <a class="link" href="https://issues.redhat.com/secure/CreateIssueDetails!init.jspa?pid=12332330&amp;summary=Documentation_issue&amp;issuetype=1&amp;components=12367614&amp;priority=10200&amp;versions=12391126">Jira issue</a> for the most relevant documentation component. Please provide specific details, such as the section name and OpenShift Container Platform version.
				</p><p>
					When opening a support case, it is helpful to provide debugging information about your cluster to Red Hat Support.
				</p><p>
					The <code class="literal">must-gather</code> tool enables you to collect diagnostic information about your OpenShift Container Platform cluster, including virtual machines and other data related to Red Hat OpenShift Service Mesh.
				</p><p>
					For prompt support, supply diagnostic information for both OpenShift Container Platform and Red Hat OpenShift Service Mesh.
				</p><section class="section" id="about-must-gather_ossm-release-notes-v1x"><div class="titlepage"><div><div><h4 class="title">2.1.3.1. About the must-gather tool</h4></div></div></div><p>
						The <code class="literal">oc adm must-gather</code> CLI command collects the information from your cluster that is most likely needed for debugging issues, including:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Resource definitions
							</li><li class="listitem">
								Service logs
							</li></ul></div><p>
						By default, the <code class="literal">oc adm must-gather</code> command uses the default plugin image and writes into <code class="literal">./must-gather.local</code>.
					</p><p>
						Alternatively, you can collect specific information by running the command with the appropriate arguments as described in the following sections:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To collect data related to one or more specific features, use the <code class="literal">--image</code> argument with an image, as listed in a following section.
							</p><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc adm must-gather \
  --image=registry.redhat.io/container-native-virtualization/cnv-must-gather-rhel9:v4.13.4</pre></li><li class="listitem"><p class="simpara">
								To collect the audit logs, use the <code class="literal">-- /usr/bin/gather_audit_logs</code> argument, as described in a following section.
							</p><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc adm must-gather -- /usr/bin/gather_audit_logs</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Audit logs are not collected as part of the default set of information to reduce the size of the files.
								</p></div></div></li></ul></div><p>
						When you run <code class="literal">oc adm must-gather</code>, a new pod with a random name is created in a new project on the cluster. The data is collected on that pod and saved in a new directory that starts with <code class="literal">must-gather.local</code>. This directory is created in the current working directory.
					</p><p>
						For example:
					</p><pre class="programlisting language-terminal">NAMESPACE                      NAME                 READY   STATUS      RESTARTS      AGE
...
openshift-must-gather-5drcj    must-gather-bklx4    2/2     Running     0             72s
openshift-must-gather-5drcj    must-gather-s8sdh    2/2     Running     0             72s
...</pre><p>
						Optionally, you can run the <code class="literal">oc adm must-gather</code> command in a specific namespace by using the <code class="literal">--run-namespace</code> option.
					</p><p>
						For example:
					</p><pre class="programlisting language-terminal">$ oc adm must-gather --run-namespace &lt;namespace&gt; \
  --image=registry.redhat.io/container-native-virtualization/cnv-must-gather-rhel9:v4.13.4</pre></section><section class="section" id="prerequisites-3"><div class="titlepage"><div><div><h4 class="title">2.1.3.2. Prerequisites</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
							</li><li class="listitem">
								The OpenShift Container Platform CLI (<code class="literal">oc</code>) installed.
							</li></ul></div></section><section class="section" id="ossm-about-collecting-ossm-data_ossm-release-notes-v1x"><div class="titlepage"><div><div><h4 class="title">2.1.3.3. About collecting service mesh data</h4></div></div></div><p>
						You can use the <code class="literal">oc adm must-gather</code> CLI command to collect information about your cluster, including features and objects associated with Red Hat OpenShift Service Mesh.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
							</li><li class="listitem">
								The OpenShift Container Platform CLI (<code class="literal">oc</code>) installed.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To collect Red Hat OpenShift Service Mesh data with <code class="literal">must-gather</code>, you must specify the Red Hat OpenShift Service Mesh image.
							</p><pre class="programlisting language-terminal">$ oc adm must-gather --image=registry.redhat.io/openshift-service-mesh/istio-must-gather-rhel8:2.4</pre></li><li class="listitem"><p class="simpara">
								To collect Red Hat OpenShift Service Mesh data for a specific Service Mesh control plane namespace with <code class="literal">must-gather</code>, you must specify the Red Hat OpenShift Service Mesh image and namespace. In this example, after <code class="literal">gather,</code> replace <code class="literal">&lt;namespace&gt;</code> with your Service Mesh control plane namespace, such as <code class="literal">istio-system</code>.
							</p><pre class="programlisting language-terminal">$ oc adm must-gather --image=registry.redhat.io/openshift-service-mesh/istio-must-gather-rhel8:2.4 gather &lt;namespace&gt;</pre><p class="simpara">
								This creates a local directory that contains the following items:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										The Istio Operator namespace and its child objects
									</li><li class="listitem">
										All control plane namespaces and their children objects
									</li><li class="listitem">
										All namespaces and their children objects that belong to any service mesh
									</li><li class="listitem">
										All Istio custom resource definitions (CRD)
									</li><li class="listitem">
										All Istio CRD objectsm such as VirtualServices in a given namespace
									</li><li class="listitem">
										All Istio webhooks
									</li></ul></div></li></ol></div></section></section><section class="section" id="ossm-supported-configurations-v1x_ossm-release-notes-v1x"><div class="titlepage"><div><div><h3 class="title">2.1.4. Red Hat OpenShift Service Mesh supported configurations</h3></div></div></div><p>
					The following are the only supported configurations for the Red Hat OpenShift Service Mesh:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							OpenShift Container Platform version 4.6 or later.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						OpenShift Online and Red Hat OpenShift Dedicated are not supported for Red Hat OpenShift Service Mesh.
					</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The deployment must be contained within a single OpenShift Container Platform cluster that is not federated.
						</li><li class="listitem">
							This release of Red Hat OpenShift Service Mesh is only available on OpenShift Container Platform x86_64.
						</li><li class="listitem">
							This release only supports configurations where all Service Mesh components are contained in the OpenShift Container Platform cluster in which it operates. It does not support management of microservices that reside outside of the cluster, or in a multi-cluster scenario.
						</li><li class="listitem">
							This release only supports configurations that do not integrate external services such as virtual machines.
						</li></ul></div><p>
					For additional information about Red Hat OpenShift Service Mesh lifecycle and supported configurations, refer to the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ossm">Support Policy</a>.
				</p><section class="section" id="ossm-supported-configurations-kiali_ossm-release-notes-v1x"><div class="titlepage"><div><div><h4 class="title">2.1.4.1. Supported configurations for Kiali on Red Hat OpenShift Service Mesh</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The Kiali observability console is only supported on the two most recent releases of the Chrome, Edge, Firefox, or Safari browsers.
							</li></ul></div></section><section class="section" id="ossm-supported-configurations-adapters_ossm-release-notes-v1x"><div class="titlepage"><div><div><h4 class="title">2.1.4.2. Supported Mixer adapters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								This release only supports the following Mixer adapter:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										3scale Istio Adapter
									</li></ul></div></li></ul></div></section></section><section class="section" id="ossm-rn-new-features-1x_ossm-release-notes-v1x"><div class="titlepage"><div><div><h3 class="title">2.1.5. New Features</h3></div></div></div><p>
					Red Hat OpenShift Service Mesh provides a number of key capabilities uniformly across a network of services:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Traffic Management</strong></span> - Control the flow of traffic and API calls between services, make calls more reliable, and make the network more robust in the face of adverse conditions.
						</li><li class="listitem">
							<span class="strong strong"><strong>Service Identity and Security</strong></span> - Provide services in the mesh with a verifiable identity and provide the ability to protect service traffic as it flows over networks of varying degrees of trustworthiness.
						</li><li class="listitem">
							<span class="strong strong"><strong>Policy Enforcement</strong></span> - Apply organizational policy to the interaction between services, ensure access policies are enforced and resources are fairly distributed among consumers. Policy changes are made by configuring the mesh, not by changing application code.
						</li><li class="listitem">
							<span class="strong strong"><strong>Telemetry</strong></span> - Gain understanding of the dependencies between services and the nature and flow of traffic between them, providing the ability to quickly identify issues.
						</li></ul></div><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-18-2"><div class="titlepage"><div><div><h4 class="title">2.1.5.1. New features Red Hat OpenShift Service Mesh 1.1.18.2</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs).
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-1-1-18-2"><div class="titlepage"><div><div><h5 class="title">2.1.5.1.1. Component versions included in Red Hat OpenShift Service Mesh version 1.1.18.2</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663649248048" scope="col">Component</th><th align="left" valign="top" id="idm140663649246960" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663649248048"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663649246960"> <p>
											1.4.10
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649248048"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663649246960"> <p>
											1.30.2
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649248048"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663649246960"> <p>
											1.12.21.1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649248048"> <p>
											3scale Istio Adapter
										</p>
										 </td><td align="left" valign="top" headers="idm140663649246960"> <p>
											1.0.0
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-18-1"><div class="titlepage"><div><div><h4 class="title">2.1.5.2. New features Red Hat OpenShift Service Mesh 1.1.18.1</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs).
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-1-1-18-1"><div class="titlepage"><div><div><h5 class="title">2.1.5.2.1. Component versions included in Red Hat OpenShift Service Mesh version 1.1.18.1</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663649221216" scope="col">Component</th><th align="left" valign="top" id="idm140663649220128" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663649221216"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663649220128"> <p>
											1.4.10
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649221216"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663649220128"> <p>
											1.30.2
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649221216"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663649220128"> <p>
											1.12.20.1
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649221216"> <p>
											3scale Istio Adapter
										</p>
										 </td><td align="left" valign="top" headers="idm140663649220128"> <p>
											1.0.0
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-18"><div class="titlepage"><div><div><h4 class="title">2.1.5.3. New features Red Hat OpenShift Service Mesh 1.1.18</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs).
					</p><section class="section" id="component-versions-included-in-red-hat-openshift-service-mesh-version-1-1-18"><div class="titlepage"><div><div><h5 class="title">2.1.5.3.1. Component versions included in Red Hat OpenShift Service Mesh version 1.1.18</h5></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663649194448" scope="col">Component</th><th align="left" valign="top" id="idm140663649193360" scope="col">Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663649194448"> <p>
											Istio
										</p>
										 </td><td align="left" valign="top" headers="idm140663649193360"> <p>
											1.4.10
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649194448"> <p>
											Jaeger
										</p>
										 </td><td align="left" valign="top" headers="idm140663649193360"> <p>
											1.24.0
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649194448"> <p>
											Kiali
										</p>
										 </td><td align="left" valign="top" headers="idm140663649193360"> <p>
											1.12.18
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649194448"> <p>
											3scale Istio Adapter
										</p>
										 </td><td align="left" valign="top" headers="idm140663649193360"> <p>
											1.0.0
										</p>
										 </td></tr></tbody></table></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-17-1"><div class="titlepage"><div><div><h4 class="title">2.1.5.4. New features Red Hat OpenShift Service Mesh 1.1.17.1</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs).
					</p><section class="section" id="change-in-how-red-hat-openshift-service-mesh-handles-uri-fragments-2"><div class="titlepage"><div><div><h5 class="title">2.1.5.4.1. Change in how Red Hat OpenShift Service Mesh handles URI fragments</h5></div></div></div><p>
							Red Hat OpenShift Service Mesh contains a remotely exploitable vulnerability, <a class="link" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-39156">CVE-2021-39156</a>, where an HTTP request with a fragment (a section in the end of a URI that begins with a # character) in the URI path could bypass the Istio URI path-based authorization policies. For instance, an Istio authorization policy denies requests sent to the URI path <code class="literal">/user/profile</code>. In the vulnerable versions, a request with URI path <code class="literal">/user/profile#section1</code> bypasses the deny policy and routes to the backend (with the normalized URI <code class="literal">path /user/profile%23section1</code>), possibly leading to a security incident.
						</p><p>
							You are impacted by this vulnerability if you use authorization policies with DENY actions and <code class="literal">operation.paths</code>, or ALLOW actions and <code class="literal">operation.notPaths</code>.
						</p><p>
							With the mitigation, the fragment part of the request’s URI is removed before the authorization and routing. This prevents a request with a fragment in its URI from bypassing authorization policies which are based on the URI without the fragment part.
						</p></section><section class="section" id="required-update-for-authorization-policies-2"><div class="titlepage"><div><div><h5 class="title">2.1.5.4.2. Required update for authorization policies</h5></div></div></div><p>
							Istio generates hostnames for both the hostname itself and all matching ports. For instance, a virtual service or Gateway for a host of "httpbin.foo" generates a config matching "httpbin.foo and httpbin.foo:*". However, exact match authorization policies only match the exact string given for the <code class="literal">hosts</code> or <code class="literal">notHosts</code> fields.
						</p><p>
							Your cluster is impacted if you have <code class="literal">AuthorizationPolicy</code> resources using exact string comparison for the rule to determine <a class="link" href="https://istio.io/latest/docs/reference/config/security/authorization-policy/#Operation">hosts or notHosts</a>.
						</p><p>
							You must update your authorization policy <a class="link" href="https://istio.io/latest/docs/reference/config/security/authorization-policy/#Rule">rules</a> to use prefix match instead of exact match. For example, replacing <code class="literal">hosts: ["httpbin.com"]</code> with <code class="literal">hosts: ["httpbin.com:*"]</code> in the first <code class="literal">AuthorizationPolicy</code> example.
						</p><div class="formalpara"><p class="title"><strong>First example AuthorizationPolicy using prefix match</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: httpbin
  namespace: foo
spec:
  action: DENY
  rules:
  - from:
    - source:
        namespaces: ["dev"]
    to:
    - operation:
        hosts: [“httpbin.com”,"httpbin.com:*"]</pre>

							</p></div><div class="formalpara"><p class="title"><strong>Second example AuthorizationPolicy using prefix match</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: httpbin
  namespace: default
spec:
  action: DENY
  rules:
  - to:
    - operation:
        hosts: ["httpbin.example.com:*"]</pre>

							</p></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-17"><div class="titlepage"><div><div><h4 class="title">2.1.5.5. New features Red Hat OpenShift Service Mesh 1.1.17</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-16"><div class="titlepage"><div><div><h4 class="title">2.1.5.6. New features Red Hat OpenShift Service Mesh 1.1.16</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-15"><div class="titlepage"><div><div><h4 class="title">2.1.5.7. New features Red Hat OpenShift Service Mesh 1.1.15</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-14"><div class="titlepage"><div><div><h4 class="title">2.1.5.8. New features Red Hat OpenShift Service Mesh 1.1.14</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							There are manual steps that must be completed to address CVE-2021-29492 and CVE-2021-31920.
						</p></div></div><section class="section" id="manual-updates-cve-2021-29492_ossm-release-notes-v1x"><div class="titlepage"><div><div><h5 class="title">2.1.5.8.1. Manual updates required by CVE-2021-29492 and CVE-2021-31920</h5></div></div></div><p>
							Istio contains a remotely exploitable vulnerability where an HTTP request path with multiple slashes or escaped slash characters (<code class="literal">%2F` or </code>%5C`) could potentially bypass an Istio authorization policy when path-based authorization rules are used.
						</p><p>
							For example, assume an Istio cluster administrator defines an authorization DENY policy to reject the request at path <code class="literal">/admin</code>. A request sent to the URL path <code class="literal">//admin</code> will NOT be rejected by the authorization policy.
						</p><p>
							According to <a class="link" href="https://tools.ietf.org/html/rfc3986#section-6">RFC 3986</a>, the path <code class="literal">//admin</code> with multiple slashes should technically be treated as a different path from the <code class="literal">/admin</code>. However, some backend services choose to normalize the URL paths by merging multiple slashes into a single slash. This can result in a bypass of the authorization policy (<code class="literal">//admin</code> does not match <code class="literal">/admin</code>), and a user can access the resource at path <code class="literal">/admin</code> in the backend; this would represent a security incident.
						</p><p>
							Your cluster is impacted by this vulnerability if you have authorization policies using <code class="literal">ALLOW action + notPaths</code> field or <code class="literal">DENY action + paths field</code> patterns. These patterns are vulnerable to unexpected policy bypasses.
						</p><p>
							Your cluster is NOT impacted by this vulnerability if:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									You don’t have authorization policies.
								</li><li class="listitem">
									Your authorization policies don’t define <code class="literal">paths</code> or <code class="literal">notPaths</code> fields.
								</li><li class="listitem">
									Your authorization policies use <code class="literal">ALLOW action + paths</code> field or <code class="literal">DENY action + notPaths</code> field patterns. These patterns could only cause unexpected rejection instead of policy bypasses. The upgrade is optional for these cases.
								</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The Red Hat OpenShift Service Mesh configuration location for path normalization is different from the Istio configuration.
							</p></div></div></section><section class="section" id="updating-the-path-normalization-configuration-2"><div class="titlepage"><div><div><h5 class="title">2.1.5.8.2. Updating the path normalization configuration</h5></div></div></div><p>
							Istio authorization policies can be based on the URL paths in the HTTP request. <a class="link" href="https://en.wikipedia.org/wiki/URI_normalization">Path normalization</a>, also known as URI normalization, modifies and standardizes the incoming requests' paths so that the normalized paths can be processed in a standard way. Syntactically different paths may be equivalent after path normalization.
						</p><p>
							Istio supports the following normalization schemes on the request paths before evaluating against the authorization policies and routing the requests:
						</p><div class="table" id="idm140663649094688"><p class="title"><strong>Table 2.1. Normalization schemes</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663649088000" scope="col">Option</th><th align="left" valign="top" id="idm140663649086912" scope="col">Description</th><th align="left" valign="top" id="idm140663649085824" scope="col">Example</th><th align="left" valign="top" id="idm140663649084736" scope="col">Notes</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663649088000"> <p>
											<code class="literal">NONE</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663649086912"> <p>
											No normalization is done. Anything received by Envoy will be forwarded exactly as-is to any backend service.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649085824"> <p>
											<code class="literal">../%2Fa../b</code> is evaluated by the authorization policies and sent to your service.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649084736"> <p>
											This setting is vulnerable to CVE-2021-31920.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649088000"> <p>
											<code class="literal">BASE</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663649086912"> <p>
											This is currently the option used in the <span class="strong strong"><strong>default</strong></span> installation of Istio. This applies the <a class="link" href="https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-normalize-path"><code class="literal">normalize_path</code></a> option on Envoy proxies, which follows <a class="link" href="https://tools.ietf.org/html/rfc3986">RFC 3986</a> with extra normalization to convert backslashes to forward slashes.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649085824"> <p>
											<code class="literal">/a/../b</code> is normalized to <code class="literal">/b</code>. <code class="literal">\da</code> is normalized to <code class="literal">/da</code>.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649084736"> <p>
											This setting is vulnerable to CVE-2021-31920.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649088000"> <p>
											<code class="literal">MERGE_SLASHES</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663649086912"> <p>
											Slashes are merged after the <span class="emphasis"><em>BASE</em></span> normalization.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649085824"> <p>
											<code class="literal">/a//b</code> is normalized to <code class="literal">/a/b</code>.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649084736"> <p>
											Update to this setting to mitigate CVE-2021-31920.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649088000"> <p>
											<code class="literal">DECODE_AND_MERGE_SLASHES</code>
										</p>
										 </td><td align="left" valign="top" headers="idm140663649086912"> <p>
											The strictest setting when you allow all traffic by default. This setting is recommended, with the caveat that you must thoroughly test your authorization policies routes. <a class="link" href="https://tools.ietf.org/html/rfc3986#section-2.1">Percent-encoded</a> slash and backslash characters (<code class="literal">%2F</code>, <code class="literal">%2f</code>, <code class="literal">%5C</code> and <code class="literal">%5c</code>) are decoded to <code class="literal">/</code> or <code class="literal">\</code>, before the <code class="literal">MERGE_SLASHES</code> normalization.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649085824"> <p>
											<code class="literal">/a%2fb</code> is normalized to <code class="literal">/a/b</code>.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649084736"> <p>
											Update to this setting to mitigate CVE-2021-31920. This setting is more secure, but also has the potential to break applications. Test your applications before deploying to production.
										</p>
										 </td></tr></tbody></table></div></div><p>
							The normalization algorithms are conducted in the following order:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
									Percent-decode <code class="literal">%2F</code>, <code class="literal">%2f</code>, <code class="literal">%5C</code> and <code class="literal">%5c</code>.
								</li><li class="listitem">
									The <a class="link" href="https://tools.ietf.org/html/rfc3986">RFC 3986</a> and other normalization implemented by the <a class="link" href="https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-normalize-path"><code class="literal">normalize_path</code></a> option in Envoy.
								</li><li class="listitem">
									Merge slashes.
								</li></ol></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								While these normalization options represent recommendations from HTTP standards and common industry practices, applications may interpret a URL in any way it chooses to. When using denial policies, ensure that you understand how your application behaves.
							</p></div></div></section><section class="section" id="path-normalization-configuration-examples-2"><div class="titlepage"><div><div><h5 class="title">2.1.5.8.3. Path normalization configuration examples</h5></div></div></div><p>
							Ensuring Envoy normalizes request paths to match your backend services' expectations is critical to the security of your system. The following examples can be used as a reference for you to configure your system. The normalized URL paths, or the original URL paths if <code class="literal">NONE</code> is selected, will be:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
									Used to check against the authorization policies.
								</li><li class="listitem">
									Forwarded to the backend application.
								</li></ol></div><div class="table" id="idm140663649025568"><p class="title"><strong>Table 2.2. Configuration examples</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663649020736" scope="col">If your application…​</th><th align="left" valign="top" id="idm140663649019616" scope="col">Choose…​</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663649020736"> <p>
											Relies on the proxy to do normalization
										</p>
										 </td><td align="left" valign="top" headers="idm140663649019616"> <p>
											<code class="literal">BASE</code>, <code class="literal">MERGE_SLASHES</code> or <code class="literal">DECODE_AND_MERGE_SLASHES</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649020736"> <p>
											Normalizes request paths based on <a class="link" href="https://tools.ietf.org/html/rfc3986">RFC 3986</a> and does not merge slashes.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649019616"> <p>
											<code class="literal">BASE</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649020736"> <p>
											Normalizes request paths based on <a class="link" href="https://tools.ietf.org/html/rfc3986">RFC 3986</a> and merges slashes, but does not decode <a class="link" href="https://tools.ietf.org/html/rfc3986#section-2.1">percent-encoded</a> slashes.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649019616"> <p>
											<code class="literal">MERGE_SLASHES</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649020736"> <p>
											Normalizes request paths based on <a class="link" href="https://tools.ietf.org/html/rfc3986">RFC 3986</a>, decodes <a class="link" href="https://tools.ietf.org/html/rfc3986#section-2.1">percent-encoded</a> slashes, and merges slashes.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649019616"> <p>
											<code class="literal">DECODE_AND_MERGE_SLASHES</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140663649020736"> <p>
											Processes request paths in a way that is incompatible with <a class="link" href="https://tools.ietf.org/html/rfc3986">RFC 3986</a>.
										</p>
										 </td><td align="left" valign="top" headers="idm140663649019616"> <p>
											<code class="literal">NONE</code>
										</p>
										 </td></tr></tbody></table></div></div></section><section class="section" id="configuring-your-smcp-for-path-normalization-2"><div class="titlepage"><div><div><h5 class="title">2.1.5.8.4. Configuring your SMCP for path normalization</h5></div></div></div><p>
							To configure path normalization for Red Hat OpenShift Service Mesh, specify the following in your <code class="literal">ServiceMeshControlPlane</code>. Use the configuration examples to help determine the settings for your system.
						</p><div class="formalpara"><p class="title"><strong>SMCP v1 pathNormalization</strong></p><p>
								
<pre class="programlisting language-yaml">spec:
  global:
    pathNormalization: &lt;option&gt;</pre>

							</p></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-13"><div class="titlepage"><div><div><h4 class="title">2.1.5.9. New features Red Hat OpenShift Service Mesh 1.1.13</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-12"><div class="titlepage"><div><div><h4 class="title">2.1.5.10. New features Red Hat OpenShift Service Mesh 1.1.12</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-11"><div class="titlepage"><div><div><h4 class="title">2.1.5.11. New features Red Hat OpenShift Service Mesh 1.1.11</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-10"><div class="titlepage"><div><div><h4 class="title">2.1.5.12. New features Red Hat OpenShift Service Mesh 1.1.10</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-9"><div class="titlepage"><div><div><h4 class="title">2.1.5.13. New features Red Hat OpenShift Service Mesh 1.1.9</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-8"><div class="titlepage"><div><div><h4 class="title">2.1.5.14. New features Red Hat OpenShift Service Mesh 1.1.8</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-7"><div class="titlepage"><div><div><h4 class="title">2.1.5.15. New features Red Hat OpenShift Service Mesh 1.1.7</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-6"><div class="titlepage"><div><div><h4 class="title">2.1.5.16. New features Red Hat OpenShift Service Mesh 1.1.6</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-5"><div class="titlepage"><div><div><h4 class="title">2.1.5.17. New features Red Hat OpenShift Service Mesh 1.1.5</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p><p>
						This release also added support for configuring cipher suites.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-4"><div class="titlepage"><div><div><h4 class="title">2.1.5.18. New features Red Hat OpenShift Service Mesh 1.1.4</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							There are manual steps that must be completed to address CVE-2020-8663.
						</p></div></div><section class="section" id="manual-updates-cve-2020-8663_ossm-release-notes-v1x"><div class="titlepage"><div><div><h5 class="title">2.1.5.18.1. Manual updates required by CVE-2020-8663</h5></div></div></div><p>
							The fix for <a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=1844254">CVE-2020-8663</a><code class="literal">: envoy: Resource exhaustion when accepting too many connections</code> added a configurable limit on downstream connections. The configuration option for this limit must be configured to mitigate this vulnerability.
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								These manual steps are required to mitigate this CVE whether you are using the 1.1 version or the 1.0 version of Red Hat OpenShift Service Mesh.
							</p></div></div><p>
							This new configuration option is called <code class="literal">overload.global_downstream_max_connections</code>, and it is configurable as a proxy <code class="literal">runtime</code> setting. Perform the following steps to configure limits at the Ingress Gateway.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Create a file named <code class="literal">bootstrap-override.json</code> with the following text to force the proxy to override the bootstrap template and load runtime configuration from disk:
								</p><pre class="literallayout">  {
    "runtime": {
      "symlink_root": "/var/lib/istio/envoy/runtime"
    }
  }</pre></li><li class="listitem"><p class="simpara">
									Create a secret from the <code class="literal">bootstrap-override.json</code> file, replacing &lt;SMCPnamespace&gt; with the namespace where you created the service mesh control plane (SMCP):
								</p><pre class="programlisting language-terminal">$  oc create secret generic -n &lt;SMCPnamespace&gt; gateway-bootstrap --from-file=bootstrap-override.json</pre></li><li class="listitem"><p class="simpara">
									Update the SMCP configuration to activate the override.
								</p><div class="formalpara"><p class="title"><strong>Updated SMCP configuration example #1</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshControlPlane
spec:
  istio:
    gateways:
      istio-ingressgateway:
        env:
          ISTIO_BOOTSTRAP_OVERRIDE: /var/lib/istio/envoy/custom-bootstrap/bootstrap-override.json
        secretVolumes:
        - mountPath: /var/lib/istio/envoy/custom-bootstrap
          name: custom-bootstrap
          secretName: gateway-bootstrap</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									To set the new configuration option, create a secret that has the desired value for the <code class="literal">overload.global_downstream_max_connections</code> setting. The following example uses a value of <code class="literal">10000</code>:
								</p><pre class="programlisting language-terminal">$  oc create secret generic -n &lt;SMCPnamespace&gt; gateway-settings --from-literal=overload.global_downstream_max_connections=10000</pre></li><li class="listitem">
									Update the SMCP again to mount the secret in the location where Envoy is looking for runtime configuration:
								</li></ol></div><div class="formalpara"><p class="title"><strong>Updated SMCP configuration example #2</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshControlPlane
spec:
  template: default
#Change the version to "v1.0" if you are on the 1.0 stream.
  version: v1.1
  istio:
    gateways:
      istio-ingressgateway:
        env:
          ISTIO_BOOTSTRAP_OVERRIDE: /var/lib/istio/envoy/custom-bootstrap/bootstrap-override.json
        secretVolumes:
        - mountPath: /var/lib/istio/envoy/custom-bootstrap
          name: custom-bootstrap
          secretName: gateway-bootstrap
        # below is the new secret mount
        - mountPath: /var/lib/istio/envoy/runtime
          name: gateway-settings
          secretName: gateway-settings</pre>

							</p></div></section><section class="section" id="upgrading_es5_es6_ossm-release-notes-v1x"><div class="titlepage"><div><div><h5 class="title">2.1.5.18.2. Upgrading from Elasticsearch 5 to Elasticsearch 6</h5></div></div></div><p>
							When updating from Elasticsearch 5 to Elasticsearch 6, you must delete your Jaeger instance, then recreate the Jaeger instance because of an issue with certificates. Re-creating the Jaeger instance triggers creating a new set of certificates. If you are using persistent storage the same volumes can be mounted for the new Jaeger instance as long as the Jaeger name and namespace for the new Jaeger instance are the same as the deleted Jaeger instance.
						</p><div class="orderedlist"><p class="title"><strong>Procedure if Jaeger is installed as part of Red Hat Service Mesh</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Determine the name of your Jaeger custom resource file:
								</p><pre class="programlisting language-terminal">$ oc get jaeger -n istio-system</pre><p class="simpara">
									You should see something like the following:
								</p><pre class="programlisting language-terminal">NAME     AGE
jaeger   3d21h</pre></li><li class="listitem"><p class="simpara">
									Copy the generated custom resource file into a temporary directory:
								</p><pre class="programlisting language-terminal">$ oc get jaeger jaeger -oyaml -n istio-system &gt; /tmp/jaeger-cr.yaml</pre></li><li class="listitem"><p class="simpara">
									Delete the Jaeger instance:
								</p><pre class="programlisting language-terminal">$ oc delete jaeger jaeger -n istio-system</pre></li><li class="listitem"><p class="simpara">
									Recreate the Jaeger instance from your copy of the custom resource file:
								</p><pre class="programlisting language-terminal">$ oc create -f /tmp/jaeger-cr.yaml -n istio-system</pre></li><li class="listitem"><p class="simpara">
									Delete the copy of the generated custom resource file:
								</p><pre class="programlisting language-terminal">$ rm /tmp/jaeger-cr.yaml</pre></li></ol></div><div class="formalpara"><p class="title"><strong>Procedure if Jaeger not installed as part of Red Hat Service Mesh</strong></p><p>
								Before you begin, create a copy of your Jaeger custom resource file.
							</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Delete the Jaeger instance by deleting the custom resource file:
								</p><pre class="programlisting language-terminal">$ oc delete -f &lt;jaeger-cr-file&gt;</pre><p class="simpara">
									For example:
								</p><pre class="programlisting language-terminal">$ oc delete -f jaeger-prod-elasticsearch.yaml</pre></li><li class="listitem"><p class="simpara">
									Recreate your Jaeger instance from the backup copy of your custom resource file:
								</p><pre class="programlisting language-terminal">$ oc create -f &lt;jaeger-cr-file&gt;</pre></li><li class="listitem"><p class="simpara">
									Validate that your Pods have restarted:
								</p><pre class="programlisting language-terminal">$ oc get pods -n jaeger-system -w</pre></li></ol></div></section></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-3"><div class="titlepage"><div><div><h4 class="title">2.1.5.19. New features Red Hat OpenShift Service Mesh 1.1.3</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses Common Vulnerabilities and Exposures (CVEs) and bug fixes.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-2"><div class="titlepage"><div><div><h4 class="title">2.1.5.20. New features Red Hat OpenShift Service Mesh 1.1.2</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh addresses a security vulnerability.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-1"><div class="titlepage"><div><div><h4 class="title">2.1.5.21. New features Red Hat OpenShift Service Mesh 1.1.1</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh adds support for a disconnected installation.
					</p></section><section class="section" id="new-features-red-hat-openshift-service-mesh-1-1-0"><div class="titlepage"><div><div><h4 class="title">2.1.5.22. New features Red Hat OpenShift Service Mesh 1.1.0</h4></div></div></div><p>
						This release of Red Hat OpenShift Service Mesh adds support for Istio 1.4.6 and Jaeger 1.17.1.
					</p><section class="section" id="ossm-manual-updates-1.0-1.1_ossm-release-notes-v1x"><div class="titlepage"><div><div><h5 class="title">2.1.5.22.1. Manual updates from 1.0 to 1.1</h5></div></div></div><p>
							If you are updating from Red Hat OpenShift Service Mesh 1.0 to 1.1, you must update the <code class="literal">ServiceMeshControlPlane</code> resource to update the control plane components to the new version.
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
									In the web console, click the Red Hat OpenShift Service Mesh Operator.
								</li><li class="listitem">
									Click the <span class="strong strong"><strong>Project</strong></span> menu and choose the project where your <code class="literal">ServiceMeshControlPlane</code> is deployed from the list, for example <code class="literal">istio-system</code>.
								</li><li class="listitem">
									Click the name of your control plane, for example <code class="literal">basic-install</code>.
								</li><li class="listitem">
									Click YAML and add a version field to the <code class="literal">spec:</code> of your <code class="literal">ServiceMeshControlPlane</code> resource. For example, to update to Red Hat OpenShift Service Mesh 1.1.0, add <code class="literal">version: v1.1</code>.
								</li></ol></div><pre class="screen">spec:
  version: v1.1
  ...</pre><p>
							The version field specifies the version of Service Mesh to install and defaults to the latest available version.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Note that support for Red Hat OpenShift Service Mesh v1.0 ended in October, 2020. You must upgrade to either v1.1 or v2.0.
							</p></div></div></section></section></section><section class="section" id="ossm-deprecated-features-1x_ossm-release-notes-v1x"><div class="titlepage"><div><div><h3 class="title">2.1.6. Deprecated features</h3></div></div></div><p>
					Some features available in previous releases have been deprecated or removed.
				</p><p>
					Deprecated functionality is still included in OpenShift Container Platform and continues to be supported; however, it will be removed in a future release of this product and is not recommended for new deployments.
				</p><section class="section" id="deprecated-features-red-hat-openshift-service-mesh-1-1-5"><div class="titlepage"><div><div><h4 class="title">2.1.6.1. Deprecated features Red Hat OpenShift Service Mesh 1.1.5</h4></div></div></div><p>
						The following custom resources were deprecated in release 1.1.5 and were removed in release 1.1.12
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">Policy</code> - The <code class="literal">Policy</code> resource is deprecated and will be replaced by the <code class="literal">PeerAuthentication</code> resource in a future release.
							</li><li class="listitem">
								<code class="literal">MeshPolicy</code> - The <code class="literal">MeshPolicy</code> resource is deprecated and will be replaced by the <code class="literal">PeerAuthentication</code> resource in a future release.
							</li><li class="listitem"><p class="simpara">
								<code class="literal">v1alpha1</code> RBAC API -The v1alpha1 RBAC policy is deprecated by the v1beta1 <code class="literal">AuthorizationPolicy</code>. RBAC (Role Based Access Control) defines <code class="literal">ServiceRole</code> and <code class="literal">ServiceRoleBinding</code> objects.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">ServiceRole</code>
									</li><li class="listitem">
										<code class="literal">ServiceRoleBinding</code>
									</li></ul></div></li><li class="listitem"><p class="simpara">
								<code class="literal">RbacConfig</code> - <code class="literal">RbacConfig</code> implements the Custom Resource Definition for controlling Istio RBAC behavior.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">ClusterRbacConfig</code>(versions prior to Red Hat OpenShift Service Mesh 1.0)
									</li><li class="listitem">
										<code class="literal">ServiceMeshRbacConfig</code> (Red Hat OpenShift Service Mesh version 1.0 and later)
									</li></ul></div></li><li class="listitem">
								In Kiali, the <code class="literal">login</code> and <code class="literal">LDAP</code> strategies are deprecated. A future version will introduce authentication using OpenID providers.
							</li></ul></div><p>
						The following components are also deprecated in this release and will be replaced by the <span class="strong strong"><strong>Istiod</strong></span> component in a future release.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Mixer</strong></span> - access control and usage policies
							</li><li class="listitem">
								<span class="strong strong"><strong>Pilot</strong></span> - service discovery and proxy configuration
							</li><li class="listitem">
								<span class="strong strong"><strong>Citadel</strong></span> - certificate generation
							</li><li class="listitem">
								<span class="strong strong"><strong>Galley</strong></span> - configuration validation and distribution
							</li></ul></div></section></section><section class="section" id="ossm-rn-known-issues-1x_ossm-release-notes-v1x"><div class="titlepage"><div><div><h3 class="title">2.1.7. Known issues</h3></div></div></div><p>
					These limitations exist in Red Hat OpenShift Service Mesh:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://github.com/istio/old_issues_repo/issues/115">Red Hat OpenShift Service Mesh does not support IPv6</a>, as it is not supported by the upstream Istio project, nor fully supported by OpenShift Container Platform.
						</li><li class="listitem">
							Graph layout - The layout for the Kiali graph can render differently, depending on your application architecture and the data to display (number of graph nodes and their interactions). Because it is difficult if not impossible to create a single layout that renders nicely for every situation, Kiali offers a choice of several different layouts. To choose a different layout, you can choose a different <span class="strong strong"><strong>Layout Schema</strong></span> from the <span class="strong strong"><strong>Graph Settings</strong></span> menu.
						</li><li class="listitem">
							The first time you access related services such as Jaeger and Grafana, from the Kiali console, you must accept the certificate and re-authenticate using your OpenShift Container Platform login credentials. This happens due to an issue with how the framework displays embedded pages in the console.
						</li></ul></div><section class="section" id="ossm-rn-known-issues-ossm_ossm-release-notes-v1x"><div class="titlepage"><div><div><h4 class="title">2.1.7.1. Service Mesh known issues</h4></div></div></div><p>
						These are the known issues in Red Hat OpenShift Service Mesh:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<a class="link" href="https://access.redhat.com/solutions/4970771">Jaeger/Kiali Operator upgrade blocked with operator pending</a> When upgrading the Jaeger or Kiali Operators with Service Mesh 1.0.x installed, the operator status shows as Pending.
							</p><p class="simpara">
								Workaround: See the linked Knowledge Base article for more information.
							</p></li><li class="listitem">
								<a class="link" href="https://github.com/istio/istio/issues/14743">Istio-14743</a> Due to limitations in the version of Istio that this release of Red Hat OpenShift Service Mesh is based on, there are several applications that are currently incompatible with Service Mesh. See the linked community issue for details.
							</li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-858">MAISTRA-858</a> The following Envoy log messages describing <a class="link" href="https://www.envoyproxy.io/docs/envoy/latest/intro/deprecated">deprecated options and configurations associated with Istio 1.1.x</a> are expected:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										[2019-06-03 07:03:28.943][19][warning][misc] [external/envoy/source/common/protobuf/utility.cc:129] Using deprecated option 'envoy.api.v2.listener.Filter.config'. This configuration will be removed from Envoy soon.
									</li><li class="listitem">
										[2019-08-12 22:12:59.001][13][warning][misc] [external/envoy/source/common/protobuf/utility.cc:174] Using deprecated option 'envoy.api.v2.Listener.use_original_dst' from file lds.proto. This configuration will be removed from Envoy soon.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-806">MAISTRA-806</a> Evicted Istio Operator Pod causes mesh and CNI not to deploy.
							</p><p class="simpara">
								Workaround: If the <code class="literal">istio-operator</code> pod is evicted while deploying the control pane, delete the evicted <code class="literal">istio-operator</code> pod.
							</p></li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-681">MAISTRA-681</a> When the control plane has many namespaces, it can lead to performance issues.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-465">MAISTRA-465</a> The Maistra Operator fails to create a service for operator metrics.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-453">MAISTRA-453</a> If you create a new project and deploy pods immediately, sidecar injection does not occur. The operator fails to add the <code class="literal">maistra.io/member-of</code> before the pods are created, therefore the pods must be deleted and recreated for sidecar injection to occur.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-158">MAISTRA-158</a> Applying multiple gateways referencing the same hostname will cause all gateways to stop functioning.
							</li></ul></div></section><section class="section" id="ossm-rn-known-issues-kiali_ossm-release-notes-v1x"><div class="titlepage"><div><div><h4 class="title">2.1.7.2. Kiali known issues</h4></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							New issues for Kiali should be created in the <a class="link" href="https://issues.redhat.com/projects/OSSM/">OpenShift Service Mesh</a> project with the <code class="literal">Component</code> set to <code class="literal">Kiali</code>.
						</p></div></div><p>
						These are the known issues in Kiali:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/KIALI-2206">KIALI-2206</a> When you are accessing the Kiali console for the first time, and there is no cached browser data for Kiali, the “View in Grafana” link on the Metrics tab of the Kiali Service Details page redirects to the wrong location. The only way you would encounter this issue is if you are accessing Kiali for the first time.
							</li><li class="listitem">
								<a class="link" href="https://github.com/kiali/kiali/issues/507">KIALI-507</a> Kiali does not support Internet Explorer 11. This is because the underlying frameworks do not support Internet Explorer. To access the Kiali console, use one of the two most recent versions of the Chrome, Edge, Firefox or Safari browser.
							</li></ul></div></section></section><section class="section" id="ossm-rn-fixed-issues-1x_ossm-release-notes-v1x"><div class="titlepage"><div><div><h3 class="title">2.1.8. Fixed issues</h3></div></div></div><p>
					The following issues been resolved in the current release:
				</p><section class="section" id="ossm-rn-fixed-issues-ossm_ossm-release-notes-v1x"><div class="titlepage"><div><div><h4 class="title">2.1.8.1. Service Mesh fixed issues</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-2371">MAISTRA-2371</a> Handle tombstones in listerInformer. The updated cache codebase was not handling tombstones when translating the events from the namespace caches to the aggregated cache, leading to a panic in the go routine.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/OSSM-542">OSSM-542</a> Galley is not using the new certificate after rotation.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/OSSM-99">OSSM-99</a> Workloads generated from direct pod without labels may crash Kiali.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/OSSM-93">OSSM-93</a> IstioConfigList can’t filter by two or more names.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/OSSM-92">OSSM-92</a> Cancelling unsaved changes on the VS/DR YAML edit page does not cancel the changes.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/OSSM-90">OSSM-90</a> Traces not available on the service details page.
							</li></ul></div><div class="itemizedlist" id="ossm-rn-fixed-issues-maistra_ossm-release-notes-v1x"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://issues.redhat.com/projects/MAISTRA/issues/MAISTRA-1649">MAISTRA-1649</a> Headless services conflict when in different namespaces. When deploying headless services within different namespaces the endpoint configuration is merged and results in invalid Envoy configurations being pushed to the sidecars.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-1541">MAISTRA-1541</a> Panic in kubernetesenv when the controller is not set on owner reference. If a pod has an ownerReference which does not specify the controller, this will cause a panic within the <code class="literal">kubernetesenv cache.go</code> code.
							</li><li class="listitem">
								<a class="link" href="https://issues.redhat.com/browse/MAISTRA-1352">MAISTRA-1352</a> Cert-manager Custom Resource Definitions (CRD) from the control plane installation have been removed for this release and future releases. If you have already installed Red Hat OpenShift Service Mesh, the CRDs must be removed manually if cert-manager is not being used.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-1001">MAISTRA-1001</a> Closing HTTP/2 connections could lead to segmentation faults in <code class="literal">istio-proxy</code>.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-932">MAISTRA-932</a> Added the <code class="literal">requires</code> metadata to add dependency relationship between Jaeger Operator and OpenShift Elasticsearch Operator. Ensures that when the Jaeger Operator is installed, it automatically deploys the OpenShift Elasticsearch Operator if it is not available.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-862">MAISTRA-862</a> Galley dropped watches and stopped providing configuration to other components after many namespace deletions and re-creations.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-833">MAISTRA-833</a> Pilot stopped delivering configuration after many namespace deletions and re-creations.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-684">MAISTRA-684</a> The default Jaeger version in the <code class="literal">istio-operator</code> is 1.12.0, which does not match Jaeger version 1.13.1 that shipped in Red Hat OpenShift Service Mesh 0.12.TechPreview.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-622">MAISTRA-622</a> In Maistra 0.12.0/TP12, permissive mode does not work. The user has the option to use Plain text mode or Mutual TLS mode, but not permissive.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-572">MAISTRA-572</a> Jaeger cannot be used with Kiali. In this release Jaeger is configured to use the OAuth proxy, but is also only configured to work through a browser and does not allow service access. Kiali cannot properly communicate with the Jaeger endpoint and it considers Jaeger to be disabled. See also <a class="link" href="https://issues.jboss.org/browse/TRACING-591">TRACING-591</a>.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-357">MAISTRA-357</a> In OpenShift 4 Beta on AWS, it is not possible, by default, to access a TCP or HTTPS service through the ingress gateway on a port other than port 80. The AWS load balancer has a health check that verifies if port 80 on the service endpoint is active. Without a service running on port 80, the load balancer health check fails.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-348">MAISTRA-348</a> OpenShift 4 Beta on AWS does not support ingress gateway traffic on ports other than 80 or 443. If you configure your ingress gateway to handle TCP traffic with a port number other than 80 or 443, you have to use the service hostname provided by the AWS load balancer rather than the OpenShift router as a workaround.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/MAISTRA-193">MAISTRA-193</a> Unexpected console info messages are visible when health checking is enabled for citadel.
							</li><li class="listitem">
								<a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=1821432">Bug 1821432</a> Toggle controls in OpenShift Container Platform Control Resource details page do not update the CR correctly. UI Toggle controls in the Service Mesh Control Plane (SMCP) Overview page in the OpenShift Container Platform web console sometimes update the wrong field in the resource. To update a ServiceMeshControlPlane resource, edit the YAML content directly or update the resource from the command line instead of clicking the toggle controls.
							</li></ul></div></section><section class="section" id="ossm-rn-fixed-issues-kiali_ossm-release-notes-v1x"><div class="titlepage"><div><div><h4 class="title">2.1.8.2. Kiali fixed issues</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/KIALI-3239">KIALI-3239</a> If a Kiali Operator pod has failed with a status of “Evicted” it blocks the Kiali operator from deploying. The workaround is to delete the Evicted pod and redeploy the Kiali operator.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/KIALI-3118">KIALI-3118</a> After changes to the ServiceMeshMemberRoll, for example adding or removing projects, the Kiali pod restarts and then displays errors on the Graph page while the Kiali pod is restarting.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/KIALI-3096">KIALI-3096</a> Runtime metrics fail in Service Mesh. There is an OAuth filter between the Service Mesh and Prometheus, requiring a bearer token to be passed to Prometheus before access is granted. Kiali has been updated to use this token when communicating to the Prometheus server, but the application metrics are currently failing with 403 errors.
							</li><li class="listitem">
								<a class="link" href="https://issues.jboss.org/browse/KIALI-3070">KIALI-3070</a> This bug only affects custom dashboards, not the default dashboards. When you select labels in metrics settings and refresh the page, your selections are retained in the menu but your selections are not displayed on the charts.
							</li><li class="listitem">
								<a class="link" href="https://github.com/kiali/kiali/issues/1603">KIALI-2686</a> When the control plane has many namespaces, it can lead to performance issues.
							</li></ul></div></section></section></section><section class="section" id="ossm-architecture-v1x"><div class="titlepage"><div><div><h2 class="title">2.2. Understanding Service Mesh</h2></div></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					<span class="strong strong"><strong>You are viewing documentation for a Red Hat OpenShift Service Mesh release that is no longer supported.</strong></span>
				</p><p>
					Service Mesh version 1.0 and 1.1 control planes are no longer supported. For information about upgrading your service mesh control plane, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-versions_ossm-upgrade">Upgrading Service Mesh</a>.
				</p><p>
					For information about the support status of a particular Red Hat OpenShift Service Mesh release, see the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ossm">Product lifecycle page</a>.
				</p></div></div><p>
				Red Hat OpenShift Service Mesh provides a platform for behavioral insight and operational control over your networked microservices in a service mesh. With Red Hat OpenShift Service Mesh, you can connect, secure, and monitor microservices in your OpenShift Container Platform environment.
			</p><section class="section" id="ossm-understanding-service-mesh_ossm-architecture-v1x"><div class="titlepage"><div><div><h3 class="title">2.2.1. Understanding service mesh</h3></div></div></div><p>
					A <span class="emphasis"><em>service mesh</em></span> is the network of microservices that make up applications in a distributed microservice architecture and the interactions between those microservices. When a Service Mesh grows in size and complexity, it can become harder to understand and manage.
				</p><p>
					Based on the open source <a class="link" href="https://istio.io/">Istio</a> project, Red Hat OpenShift Service Mesh adds a transparent layer on existing distributed applications without requiring any changes to the service code. You add Red Hat OpenShift Service Mesh support to services by deploying a special sidecar proxy to relevant services in the mesh that intercepts all network communication between microservices. You configure and manage the Service Mesh using the Service Mesh control plane features.
				</p><p>
					Red Hat OpenShift Service Mesh gives you an easy way to create a network of deployed services that provide:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Discovery
						</li><li class="listitem">
							Load balancing
						</li><li class="listitem">
							Service-to-service authentication
						</li><li class="listitem">
							Failure recovery
						</li><li class="listitem">
							Metrics
						</li><li class="listitem">
							Monitoring
						</li></ul></div><p>
					Red Hat OpenShift Service Mesh also provides more complex operational functions including:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A/B testing
						</li><li class="listitem">
							Canary releases
						</li><li class="listitem">
							Access control
						</li><li class="listitem">
							End-to-end authentication
						</li></ul></div></section><section class="section" id="ossm-architecture-1x_ossm-architecture-v1x"><div class="titlepage"><div><div><h3 class="title">2.2.2. Red Hat OpenShift Service Mesh Architecture</h3></div></div></div><p>
					Red Hat OpenShift Service Mesh is logically split into a data plane and a control plane:
				</p><p>
					The <span class="strong strong"><strong>data plane</strong></span> is a set of intelligent proxies deployed as sidecars. These proxies intercept and control all inbound and outbound network communication between microservices in the service mesh. Sidecar proxies also communicate with Mixer, the general-purpose policy and telemetry hub.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Envoy proxy</strong></span> intercepts all inbound and outbound traffic for all services in the service mesh. Envoy is deployed as a sidecar to the relevant service in the same pod.
						</li></ul></div><p>
					The <span class="strong strong"><strong>control plane</strong></span> manages and configures proxies to route traffic, and configures Mixers to enforce policies and collect telemetry.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Mixer</strong></span> enforces access control and usage policies (such as authorization, rate limits, quotas, authentication, and request tracing) and collects telemetry data from the Envoy proxy and other services.
						</li><li class="listitem">
							<span class="strong strong"><strong>Pilot</strong></span> configures the proxies at runtime. Pilot provides service discovery for the Envoy sidecars, traffic management capabilities for intelligent routing (for example, A/B tests or canary deployments), and resiliency (timeouts, retries, and circuit breakers).
						</li><li class="listitem">
							<span class="strong strong"><strong>Citadel</strong></span> issues and rotates certificates. Citadel provides strong service-to-service and end-user authentication with built-in identity and credential management. You can use Citadel to upgrade unencrypted traffic in the service mesh. Operators can enforce policies based on service identity rather than on network controls using Citadel.
						</li><li class="listitem">
							<span class="strong strong"><strong>Galley</strong></span> ingests the service mesh configuration, then validates, processes, and distributes the configuration. Galley protects the other service mesh components from obtaining user configuration details from OpenShift Container Platform.
						</li></ul></div><p>
					Red Hat OpenShift Service Mesh also uses the <span class="strong strong"><strong>istio-operator</strong></span> to manage the installation of the control plane. An <span class="emphasis"><em>Operator</em></span> is a piece of software that enables you to implement and automate common activities in your OpenShift Container Platform cluster. It acts as a controller, allowing you to set or change the desired state of objects in your cluster.
				</p></section><section class="section" id="understanding-kiali-2"><div class="titlepage"><div><div><h3 class="title">2.2.3. Understanding Kiali</h3></div></div></div><p>
					Kiali provides visibility into your service mesh by showing you the microservices in your service mesh, and how they are connected.
				</p><section class="section" id="ossm-kiali-overview_ossm-architecture-v1x"><div class="titlepage"><div><div><h4 class="title">2.2.3.1. Kiali overview</h4></div></div></div><p>
						Kiali provides observability into the Service Mesh running on OpenShift Container Platform. Kiali helps you define, validate, and observe your Istio service mesh. It helps you to understand the structure of your service mesh by inferring the topology, and also provides information about the health of your service mesh.
					</p><p>
						Kiali provides an interactive graph view of your namespace in real time that provides visibility into features like circuit breakers, request rates, latency, and even graphs of traffic flows. Kiali offers insights about components at different levels, from Applications to Services and Workloads, and can display the interactions with contextual information and charts on the selected graph node or edge. Kiali also provides the ability to validate your Istio configurations, such as gateways, destination rules, virtual services, mesh policies, and more. Kiali provides detailed metrics, and a basic Grafana integration is available for advanced queries. Distributed tracing is provided by integrating Jaeger into the Kiali console.
					</p><p>
						Kiali is installed by default as part of the Red Hat OpenShift Service Mesh.
					</p></section><section class="section" id="ossm-kiali-architecture_ossm-architecture-v1x"><div class="titlepage"><div><div><h4 class="title">2.2.3.2. Kiali architecture</h4></div></div></div><p>
						Kiali is based on the open source <a class="link" href="https://kiali.io/">Kiali project</a>. Kiali is composed of two components: the Kiali application and the Kiali console.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Kiali application</strong></span> (back end) – This component runs in the container application platform and communicates with the service mesh components, retrieves and processes data, and exposes this data to the console. The Kiali application does not need storage. When deploying the application to a cluster, configurations are set in ConfigMaps and secrets.
							</li><li class="listitem">
								<span class="strong strong"><strong>Kiali console</strong></span> (front end) – The Kiali console is a web application. The Kiali application serves the Kiali console, which then queries the back end for data to present it to the user.
							</li></ul></div><p>
						In addition, Kiali depends on external services and components provided by the container application platform and Istio.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Red Hat Service Mesh</strong></span> (Istio) - Istio is a Kiali requirement. Istio is the component that provides and controls the service mesh. Although Kiali and Istio can be installed separately, Kiali depends on Istio and will not work if it is not present. Kiali needs to retrieve Istio data and configurations, which are exposed through Prometheus and the cluster API.
							</li><li class="listitem">
								<span class="strong strong"><strong>Prometheus</strong></span> - A dedicated Prometheus instance is included as part of the Red Hat OpenShift Service Mesh installation. When Istio telemetry is enabled, metrics data are stored in Prometheus. Kiali uses this Prometheus data to determine the mesh topology, display metrics, calculate health, show possible problems, and so on. Kiali communicates directly with Prometheus and assumes the data schema used by Istio Telemetry. Prometheus is an Istio dependency and a hard dependency for Kiali, and many of Kiali’s features will not work without Prometheus.
							</li><li class="listitem">
								<span class="strong strong"><strong>Cluster API</strong></span> - Kiali uses the API of the OpenShift Container Platform (cluster API) to fetch and resolve service mesh configurations. Kiali queries the cluster API to retrieve, for example, definitions for namespaces, services, deployments, pods, and other entities. Kiali also makes queries to resolve relationships between the different cluster entities. The cluster API is also queried to retrieve Istio configurations like virtual services, destination rules, route rules, gateways, quotas, and so on.
							</li><li class="listitem">
								<span class="strong strong"><strong>Jaeger</strong></span> - Jaeger is optional, but is installed by default as part of the Red Hat OpenShift Service Mesh installation. When you install the distributed tracing platform (Jaeger) as part of the default Red Hat OpenShift Service Mesh installation, the Kiali console includes a tab to display distributed tracing data. Note that tracing data will not be available if you disable Istio’s distributed tracing feature. Also note that user must have access to the namespace where the Service Mesh control plane is installed to view tracing data.
							</li><li class="listitem">
								<span class="strong strong"><strong>Grafana</strong></span> - Grafana is optional, but is installed by default as part of the Red Hat OpenShift Service Mesh installation. When available, the metrics pages of Kiali display links to direct the user to the same metric in Grafana. Note that user must have access to the namespace where the Service Mesh control plane is installed to view links to the Grafana dashboard and view Grafana data.
							</li></ul></div></section><section class="section" id="ossm-kiali-features_ossm-architecture-v1x"><div class="titlepage"><div><div><h4 class="title">2.2.3.3. Kiali features</h4></div></div></div><p>
						The Kiali console is integrated with Red Hat Service Mesh and provides the following capabilities:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Health</strong></span> – Quickly identify issues with applications, services, or workloads.
							</li><li class="listitem">
								<span class="strong strong"><strong>Topology</strong></span> – Visualize how your applications, services, or workloads communicate via the Kiali graph.
							</li><li class="listitem">
								<span class="strong strong"><strong>Metrics</strong></span> – Predefined metrics dashboards let you chart service mesh and application performance for Go, Node.js. Quarkus, Spring Boot, Thorntail and Vert.x. You can also create your own custom dashboards.
							</li><li class="listitem">
								<span class="strong strong"><strong>Tracing</strong></span> – Integration with Jaeger lets you follow the path of a request through various microservices that make up an application.
							</li><li class="listitem">
								<span class="strong strong"><strong>Validations</strong></span> – Perform advanced validations on the most common Istio objects (Destination Rules, Service Entries, Virtual Services, and so on).
							</li><li class="listitem">
								<span class="strong strong"><strong>Configuration</strong></span> – Optional ability to create, update and delete Istio routing configuration using wizards or directly in the YAML editor in the Kiali Console.
							</li></ul></div></section></section><section class="section" id="understanding-jaeger"><div class="titlepage"><div><div><h3 class="title">2.2.4. Understanding Jaeger</h3></div></div></div><p>
					Every time a user takes an action in an application, a request is executed by the architecture that may require dozens of different services to participate to produce a response. The path of this request is a distributed transaction. Jaeger lets you perform distributed tracing, which follows the path of a request through various microservices that make up an application.
				</p><p>
					<span class="strong strong"><strong>Distributed tracing</strong></span> is a technique that is used to tie the information about different units of work together—usually executed in different processes or hosts—to understand a whole chain of events in a distributed transaction. Distributed tracing lets developers visualize call flows in large service oriented architectures. It can be invaluable in understanding serialization, parallelism, and sources of latency.
				</p><p>
					Jaeger records the execution of individual requests across the whole stack of microservices, and presents them as traces. A <span class="strong strong"><strong>trace</strong></span> is a data/execution path through the system. An end-to-end trace is comprised of one or more spans.
				</p><p>
					A <span class="strong strong"><strong>span</strong></span> represents a logical unit of work in Jaeger that has an operation name, the start time of the operation, and the duration. Spans may be nested and ordered to model causal relationships.
				</p><section class="section" id="distr-tracing-product-overview_ossm-architecture-v1x"><div class="titlepage"><div><div><h4 class="title">2.2.4.1. Distributed tracing overview</h4></div></div></div><p>
						As a service owner, you can use distributed tracing to instrument your services to gather insights into your service architecture. You can use the Red Hat OpenShift distributed tracing platform for monitoring, network profiling, and troubleshooting the interaction between components in modern, cloud-native, microservices-based applications.
					</p><p>
						With the distributed tracing platform, you can perform the following functions:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Monitor distributed transactions
							</li><li class="listitem">
								Optimize performance and latency
							</li><li class="listitem">
								Perform root cause analysis
							</li></ul></div><p>
						The distributed tracing platform consists of three components:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Red Hat OpenShift distributed tracing platform (Jaeger)</strong></span>, which is based on the open source <a class="link" href="https://www.jaegertracing.io/">Jaeger project</a>.
							</li><li class="listitem">
								<span class="strong strong"><strong>Red Hat OpenShift distributed tracing platform (Tempo)</strong></span>, which is based on the open source <a class="link" href="https://grafana.com/oss/tempo/">Grafana Tempo project</a>.
							</li><li class="listitem">
								<span class="strong strong"><strong>Red Hat OpenShift distributed tracing data collection</strong></span>, which is based on the open source <a class="link" href="https://opentelemetry.io/">OpenTelemetry project</a>.
							</li></ul></div></section><section class="section" id="jaeger-architecture_ossm-architecture-v1x"><div class="titlepage"><div><div><h4 class="title">2.2.4.2. Distributed tracing architecture</h4></div></div></div><p>
						The distributed tracing platform (Jaeger) is based on the open source <a class="link" href="https://www.jaegertracing.io/">Jaeger project</a>. The distributed tracing platform (Jaeger) is made up of several components that work together to collect, store, and display tracing data.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Jaeger Client</strong></span> (Tracer, Reporter, instrumented application, client libraries)- Jaeger clients are language specific implementations of the OpenTracing API. They can be used to instrument applications for distributed tracing either manually or with a variety of existing open source frameworks, such as Camel (Fuse), Spring Boot (RHOAR), MicroProfile (RHOAR/Thorntail), Wildfly (EAP), and many more, that are already integrated with OpenTracing.
							</li><li class="listitem">
								<span class="strong strong"><strong>Jaeger Agent</strong></span> (Server Queue, Processor Workers) - The Jaeger agent is a network daemon that listens for spans sent over User Datagram Protocol (UDP), which it batches and sends to the collector. The agent is meant to be placed on the same host as the instrumented application. This is typically accomplished by having a sidecar in container environments like Kubernetes.
							</li><li class="listitem">
								<span class="strong strong"><strong>Jaeger Collector</strong></span> (Queue, Workers) - Similar to the Agent, the Collector is able to receive spans and place them in an internal queue for processing. This allows the collector to return immediately to the client/agent instead of waiting for the span to make its way to the storage.
							</li><li class="listitem">
								<span class="strong strong"><strong>Storage</strong></span> (Data Store) - Collectors require a persistent storage backend. Jaeger has a pluggable mechanism for span storage. Note that for this release, the only supported storage is Elasticsearch.
							</li><li class="listitem">
								<span class="strong strong"><strong>Query</strong></span> (Query Service) - Query is a service that retrieves traces from storage.
							</li><li class="listitem">
								<span class="strong strong"><strong>Ingester</strong></span> (Ingester Service) - Jaeger can use Apache Kafka as a buffer between the collector and the actual backing storage (Elasticsearch). Ingester is a service that reads data from Kafka and writes to another storage backend (Elasticsearch).
							</li><li class="listitem">
								<span class="strong strong"><strong>Jaeger Console</strong></span> – Jaeger provides a user interface that lets you visualize your distributed tracing data. On the Search page, you can find traces and explore details of the spans that make up an individual trace.
							</li></ul></div></section><section class="section" id="distr-tracing-features_ossm-architecture-v1x"><div class="titlepage"><div><div><h4 class="title">2.2.4.3. Red Hat OpenShift distributed tracing platform features</h4></div></div></div><p>
						Red Hat OpenShift distributed tracing platform provides the following capabilities:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Integration with Kiali – When properly configured, you can view distributed tracing platform data from the Kiali console.
							</li><li class="listitem">
								High scalability – The distributed tracing platform back end is designed to have no single points of failure and to scale with the business needs.
							</li><li class="listitem">
								Distributed Context Propagation – Enables you to connect data from different components together to create a complete end-to-end trace.
							</li><li class="listitem">
								Backwards compatibility with Zipkin – Red Hat OpenShift distributed tracing platform has APIs that enable it to be used as a drop-in replacement for Zipkin, but Red Hat is not supporting Zipkin compatibility in this release.
							</li></ul></div></section></section><section class="section" id="next-steps-7"><div class="titlepage"><div><div><h3 class="title">2.2.5. Next steps</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#preparing-ossm-installation-v1x">Prepare to install Red Hat OpenShift Service Mesh</a> in your OpenShift Container Platform environment.
						</li></ul></div></section></section><section class="section" id="ossm-vs-community-v1x"><div class="titlepage"><div><div><h2 class="title">2.3. Service Mesh and Istio differences</h2></div></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					<span class="strong strong"><strong>You are viewing documentation for a Red Hat OpenShift Service Mesh release that is no longer supported.</strong></span>
				</p><p>
					Service Mesh version 1.0 and 1.1 control planes are no longer supported. For information about upgrading your service mesh control plane, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-versions_ossm-upgrade">Upgrading Service Mesh</a>.
				</p><p>
					For information about the support status of a particular Red Hat OpenShift Service Mesh release, see the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ossm">Product lifecycle page</a>.
				</p></div></div><p>
				An installation of Red Hat OpenShift Service Mesh differs from upstream Istio community installations in multiple ways. The modifications to Red Hat OpenShift Service Mesh are sometimes necessary to resolve issues, provide additional features, or to handle differences when deploying on OpenShift Container Platform.
			</p><p>
				The current release of Red Hat OpenShift Service Mesh differs from the current upstream Istio community release in the following ways:
			</p><section class="section" id="ossm-multitenant-install_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h3 class="title">2.3.1. Multitenant installations</h3></div></div></div><p>
					Whereas upstream Istio takes a single tenant approach, Red Hat OpenShift Service Mesh supports multiple independent control planes within the cluster. Red Hat OpenShift Service Mesh uses a multitenant operator to manage the control plane lifecycle.
				</p><p>
					Red Hat OpenShift Service Mesh installs a multitenant control plane by default. You specify the projects that can access the Service Mesh, and isolate the Service Mesh from other control plane instances.
				</p><section class="section" id="ossm-mt-vs-clusterwide_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h4 class="title">2.3.1.1. Multitenancy versus cluster-wide installations</h4></div></div></div><p>
						The main difference between a multitenant installation and a cluster-wide installation is the scope of privileges used by istod. The components no longer use cluster-scoped Role Based Access Control (RBAC) resource <code class="literal">ClusterRoleBinding</code>.
					</p><p>
						Every project in the <code class="literal">ServiceMeshMemberRoll</code> <code class="literal">members</code> list will have a <code class="literal">RoleBinding</code> for each service account associated with the control plane deployment and each control plane deployment will only watch those member projects. Each member project has a <code class="literal">maistra.io/member-of</code> label added to it, where the <code class="literal">member-of</code> value is the project containing the control plane installation.
					</p><p>
						Red Hat OpenShift Service Mesh configures each member project to ensure network access between itself, the control plane, and other member projects. The exact configuration differs depending on how OpenShift Container Platform software-defined networking (SDN) is configured. See About OpenShift SDN for additional details.
					</p><p>
						If the OpenShift Container Platform cluster is configured to use the SDN plugin:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong><code class="literal">NetworkPolicy</code></strong></span>: Red Hat OpenShift Service Mesh creates a <code class="literal">NetworkPolicy</code> resource in each member project allowing ingress to all pods from the other members and the control plane. If you remove a member from Service Mesh, this <code class="literal">NetworkPolicy</code> resource is deleted from the project.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									This also restricts ingress to only member projects. If you require ingress from non-member projects, you need to create a <code class="literal">NetworkPolicy</code> to allow that traffic through.
								</p></div></div></li><li class="listitem">
								<span class="strong strong"><strong>Multitenant</strong></span>: Red Hat OpenShift Service Mesh joins the <code class="literal">NetNamespace</code> for each member project to the <code class="literal">NetNamespace</code> of the control plane project (the equivalent of running <code class="literal">oc adm pod-network join-projects --to control-plane-project member-project</code>). If you remove a member from the Service Mesh, its <code class="literal">NetNamespace</code> is isolated from the control plane (the equivalent of running <code class="literal">oc adm pod-network isolate-projects member-project</code>).
							</li><li class="listitem">
								<span class="strong strong"><strong>Subnet</strong></span>: No additional configuration is performed.
							</li></ul></div></section><section class="section" id="ossm-cluster-scoped-resources_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h4 class="title">2.3.1.2. Cluster scoped resources</h4></div></div></div><p>
						Upstream Istio has two cluster scoped resources that it relies on. The <code class="literal">MeshPolicy</code> and the <code class="literal">ClusterRbacConfig</code>. These are not compatible with a multitenant cluster and have been replaced as described below.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="emphasis"><em>ServiceMeshPolicy</em></span> replaces MeshPolicy for configuration of control-plane-wide authentication policies. This must be created in the same project as the control plane.
							</li><li class="listitem">
								<span class="emphasis"><em>ServicemeshRbacConfig</em></span> replaces ClusterRbacConfig for configuration of control-plane-wide role based access control. This must be created in the same project as the control plane.
							</li></ul></div></section></section><section class="section" id="ossm-vs-istio_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h3 class="title">2.3.2. Differences between Istio and Red Hat OpenShift Service Mesh</h3></div></div></div><p>
					An installation of Red Hat OpenShift Service Mesh differs from an installation of Istio in multiple ways. The modifications to Red Hat OpenShift Service Mesh are sometimes necessary to resolve issues, provide additional features, or to handle differences when deploying on OpenShift Container Platform.
				</p><section class="section" id="ossm-cli-tool_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h4 class="title">2.3.2.1. Command line tool</h4></div></div></div><p>
						The command line tool for Red Hat OpenShift Service Mesh is oc.  Red Hat OpenShift Service Mesh  does not support istioctl.
					</p></section><section class="section" id="ossm-automatic-injection_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h4 class="title">2.3.2.2. Automatic injection</h4></div></div></div><p>
						The upstream Istio community installation automatically injects the sidecar into pods within the projects you have labeled.
					</p><p>
						Red Hat OpenShift Service Mesh does not automatically inject the sidecar to any pods, but requires you to opt in to injection using an annotation without labeling projects. This method requires fewer privileges and does not conflict with other OpenShift capabilities such as builder pods. To enable automatic injection you specify the <code class="literal">sidecar.istio.io/inject</code> annotation as described in the Automatic sidecar injection section.
					</p></section><section class="section" id="ossm-rbac_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h4 class="title">2.3.2.3. Istio Role Based Access Control features</h4></div></div></div><p>
						Istio Role Based Access Control (RBAC) provides a mechanism you can use to control access to a service. You can identify subjects by user name or by specifying a set of properties and apply access controls accordingly.
					</p><p>
						The upstream Istio community installation includes options to perform exact header matches, match wildcards in headers, or check for a header containing a specific prefix or suffix.
					</p><p>
						Red Hat OpenShift Service Mesh extends the ability to match request headers by using a regular expression. Specify a property key of <code class="literal">request.regex.headers</code> with a regular expression.
					</p><div class="formalpara"><p class="title"><strong>Upstream Istio community matching request headers example</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: "rbac.istio.io/v1alpha1"
kind: ServiceRoleBinding
metadata:
  name: httpbin-client-binding
  namespace: httpbin
spec:
  subjects:
  - user: "cluster.local/ns/istio-system/sa/istio-ingressgateway-service-account"
    properties:
      request.headers[&lt;header&gt;]: "value"</pre>

						</p></div><div class="formalpara"><p class="title"><strong>Red Hat OpenShift Service Mesh matching request headers by using regular expressions</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: "rbac.istio.io/v1alpha1"
kind: ServiceRoleBinding
metadata:
  name: httpbin-client-binding
  namespace: httpbin
spec:
  subjects:
  - user: "cluster.local/ns/istio-system/sa/istio-ingressgateway-service-account"
    properties:
      request.regex.headers[&lt;header&gt;]: "&lt;regular expression&gt;"</pre>

						</p></div></section><section class="section" id="ossm-openssl_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h4 class="title">2.3.2.4. OpenSSL</h4></div></div></div><p>
						Red Hat OpenShift Service Mesh replaces BoringSSL with OpenSSL. OpenSSL is a software library that contains an open source implementation of the Secure Sockets Layer (SSL) and Transport Layer Security (TLS) protocols. The Red Hat OpenShift Service Mesh Proxy binary dynamically links the OpenSSL libraries (libssl and libcrypto) from the underlying Red Hat Enterprise Linux operating system.
					</p></section><section class="section" id="ossm-component-modifications_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h4 class="title">2.3.2.5. Component modifications</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A <span class="emphasis"><em>maistra-version</em></span> label has been added to all resources.
							</li><li class="listitem">
								All Ingress resources have been converted to OpenShift Route resources.
							</li><li class="listitem">
								Grafana, Tracing (Jaeger), and Kiali are enabled by default and exposed through OpenShift routes.
							</li><li class="listitem">
								Godebug has been removed from all templates
							</li><li class="listitem">
								The <code class="literal">istio-multi</code> ServiceAccount and ClusterRoleBinding have been removed, as well as the <code class="literal">istio-reader</code> ClusterRole.
							</li></ul></div></section><section class="section" id="ossm-envoy-sds-ca_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h4 class="title">2.3.2.6. Envoy, Secret Discovery Service, and certificates</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Red Hat OpenShift Service Mesh does not support QUIC-based services.
							</li><li class="listitem">
								Deployment of TLS certificates using the Secret Discovery Service (SDS) functionality of Istio is not currently supported in Red Hat OpenShift Service Mesh. The Istio implementation depends on a nodeagent container that uses hostPath mounts.
							</li></ul></div></section><section class="section" id="ossm-cni_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h4 class="title">2.3.2.7. Istio Container Network Interface (CNI) plugin</h4></div></div></div><p>
						Red Hat OpenShift Service Mesh includes CNI plugin, which provides you with an alternate way to configure application pod networking. The CNI plugin replaces the <code class="literal">init-container</code> network configuration eliminating the need to grant service accounts and projects access to Security Context Constraints (SCCs) with elevated privileges.
					</p></section><section class="section" id="ossm-routes-gateways_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h4 class="title">2.3.2.8. Routes for Istio Gateways</h4></div></div></div><p>
						OpenShift routes for Istio Gateways are automatically managed in Red Hat OpenShift Service Mesh. Every time an Istio Gateway is created, updated or deleted inside the service mesh, an OpenShift route is created, updated or deleted.
					</p><p>
						A Red Hat OpenShift Service Mesh control plane component called Istio OpenShift Routing (IOR) synchronizes the gateway route. For more information, see Automatic route creation.
					</p><section class="section" id="ossm-catch-all-domains_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h5 class="title">2.3.2.8.1. Catch-all domains</h5></div></div></div><p>
							Catch-all domains ("*") are not supported. If one is found in the Gateway definition, Red Hat OpenShift Service Mesh <span class="emphasis"><em>will</em></span> create the route, but will rely on OpenShift to create a default hostname. This means that the newly created route will <span class="emphasis"><em>not</em></span> be a catch all ("*") route, instead it will have a hostname in the form <code class="literal">&lt;route-name&gt;[-&lt;project&gt;].&lt;suffix&gt;</code>. See the OpenShift documentation for more information about how default hostnames work and how a cluster administrator can customize it.
						</p></section><section class="section" id="ossm-subdomains_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h5 class="title">2.3.2.8.2. Subdomains</h5></div></div></div><p>
							Subdomains (e.g.: "*.domain.com") are supported. However this ability doesn’t come enabled by default in OpenShift Container Platform. This means that Red Hat OpenShift Service Mesh <span class="emphasis"><em>will</em></span> create the route with the subdomain, but it will only be in effect if OpenShift Container Platform is configured to enable it.
						</p></section><section class="section" id="ossm-tls_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h5 class="title">2.3.2.8.3. Transport layer security</h5></div></div></div><p>
							Transport Layer Security (TLS) is supported. This means that, if the Gateway contains a <code class="literal">tls</code> section, the OpenShift Route will be configured to support TLS.
						</p><h6 id="additional-resources_ossm-vs-istio-v1x">Additional resources</h6><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-auto-route-1x_routing-traffic-v1x">Automatic route creation</a>
								</li></ul></div></section></section></section><section class="section" id="ossm-kiali-service-mesh_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h3 class="title">2.3.3. Kiali and service mesh</h3></div></div></div><p>
					Installing Kiali via the Service Mesh on OpenShift Container Platform differs from community Kiali installations in multiple ways. These modifications are sometimes necessary to resolve issues, provide additional features, or to handle differences when deploying on OpenShift Container Platform.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Kiali has been enabled by default.
						</li><li class="listitem">
							Ingress has been enabled by default.
						</li><li class="listitem">
							Updates have been made to the Kiali ConfigMap.
						</li><li class="listitem">
							Updates have been made to the ClusterRole settings for Kiali.
						</li><li class="listitem">
							Do not edit the ConfigMap, because your changes might be overwritten by the Service Mesh or Kiali Operators. Files that the Kiali Operator manages have a <code class="literal">kiali.io/</code> label or annotation. Updating the Operator files should be restricted to those users with <code class="literal">cluster-admin</code> privileges. If you use Red Hat OpenShift Dedicated, updating the Operator files should be restricted to those users with <code class="literal">dedicated-admin</code> privileges.
						</li></ul></div></section><section class="section" id="ossm-jaeger-service-mesh_ossm-vs-istio-v1x"><div class="titlepage"><div><div><h3 class="title">2.3.4. Distributed tracing and service mesh</h3></div></div></div><p>
					Installing the distributed tracing platform (Jaeger) with the Service Mesh on OpenShift Container Platform differs from community Jaeger installations in multiple ways. These modifications are sometimes necessary to resolve issues, provide additional features, or to handle differences when deploying on OpenShift Container Platform.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Distributed tracing has been enabled by default for Service Mesh.
						</li><li class="listitem">
							Ingress has been enabled by default for Service Mesh.
						</li><li class="listitem">
							The name for the Zipkin port name has changed to <code class="literal">jaeger-collector-zipkin</code> (from <code class="literal">http</code>)
						</li><li class="listitem">
							Jaeger uses Elasticsearch for storage by default when you select either the <code class="literal">production</code> or <code class="literal">streaming</code> deployment option.
						</li><li class="listitem">
							The community version of Istio provides a generic "tracing" route. Red Hat OpenShift Service Mesh uses a "jaeger" route that is installed by the Red Hat OpenShift distributed tracing platform (Jaeger) Operator and is already protected by OAuth.
						</li><li class="listitem">
							Red Hat OpenShift Service Mesh uses a sidecar for the Envoy proxy, and Jaeger also uses a sidecar, for the Jaeger agent. These two sidecars are configured separately and should not be confused with each other. The proxy sidecar creates spans related to the pod’s ingress and egress traffic. The agent sidecar receives the spans emitted by the application and sends them to the Jaeger Collector.
						</li></ul></div></section></section><section class="section" id="preparing-ossm-installation-v1x"><div class="titlepage"><div><div><h2 class="title">2.4. Preparing to install Service Mesh</h2></div></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					<span class="strong strong"><strong>You are viewing documentation for a Red Hat OpenShift Service Mesh release that is no longer supported.</strong></span>
				</p><p>
					Service Mesh version 1.0 and 1.1 control planes are no longer supported. For information about upgrading your service mesh control plane, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-versions_ossm-upgrade">Upgrading Service Mesh</a>.
				</p><p>
					For information about the support status of a particular Red Hat OpenShift Service Mesh release, see the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ossm">Product lifecycle page</a>.
				</p></div></div><p>
				Before you can install Red Hat OpenShift Service Mesh, review the installation activities, ensure that you meet the prerequisites:
			</p><section class="section" id="prerequisites-4"><div class="titlepage"><div><div><h3 class="title">2.4.1. Prerequisites</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Possess an active OpenShift Container Platform subscription on your Red Hat account. If you do not have a subscription, contact your sales representative for more information.
						</li><li class="listitem">
							Review the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/architecture/#installation-overview_architecture-installation">OpenShift Container Platform 4.13 overview</a>.
						</li><li class="listitem"><p class="simpara">
							Install OpenShift Container Platform 4.13.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-aws-account">Install OpenShift Container Platform 4.13 on AWS</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-aws-user-infra">Install OpenShift Container Platform 4.13 on user-provisioned AWS</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-bare-metal">Install OpenShift Container Platform 4.13 on bare metal</a>
								</li><li class="listitem"><p class="simpara">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-vsphere">Install OpenShift Container Platform 4.13 on vSphere</a>
								</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										If you are installing Red Hat OpenShift Service Mesh on a <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#supported-installation-methods-for-different-platforms">restricted network</a>, follow the instructions for your chosen OpenShift Container Platform infrastructure.
									</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Install the version of the OpenShift Container Platform command line utility (the <code class="literal">oc</code> client tool) that matches your OpenShift Container Platform version and add it to your path.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									If you are using OpenShift Container Platform 4.13, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cli_tools/#cli-about-cli_cli-developer-commands">About the OpenShift CLI</a>.
								</li></ul></div></li></ul></div></section><section class="section" id="ossm-supported-configurations-v1x_preparing-ossm-installation-v1x"><div class="titlepage"><div><div><h3 class="title">2.4.2. Red Hat OpenShift Service Mesh supported configurations</h3></div></div></div><p>
					The following are the only supported configurations for the Red Hat OpenShift Service Mesh:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							OpenShift Container Platform version 4.6 or later.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						OpenShift Online and Red Hat OpenShift Dedicated are not supported for Red Hat OpenShift Service Mesh.
					</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The deployment must be contained within a single OpenShift Container Platform cluster that is not federated.
						</li><li class="listitem">
							This release of Red Hat OpenShift Service Mesh is only available on OpenShift Container Platform x86_64.
						</li><li class="listitem">
							This release only supports configurations where all Service Mesh components are contained in the OpenShift Container Platform cluster in which it operates. It does not support management of microservices that reside outside of the cluster, or in a multi-cluster scenario.
						</li><li class="listitem">
							This release only supports configurations that do not integrate external services such as virtual machines.
						</li></ul></div><p>
					For additional information about Red Hat OpenShift Service Mesh lifecycle and supported configurations, refer to the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ossm">Support Policy</a>.
				</p><section class="section" id="ossm-supported-configurations-kiali_preparing-ossm-installation-v1x"><div class="titlepage"><div><div><h4 class="title">2.4.2.1. Supported configurations for Kiali on Red Hat OpenShift Service Mesh</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The Kiali observability console is only supported on the two most recent releases of the Chrome, Edge, Firefox, or Safari browsers.
							</li></ul></div></section><section class="section" id="ossm-supported-configurations-adapters_preparing-ossm-installation-v1x"><div class="titlepage"><div><div><h4 class="title">2.4.2.2. Supported Mixer adapters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								This release only supports the following Mixer adapter:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										3scale Istio Adapter
									</li></ul></div></li></ul></div></section></section><section class="section" id="ossm-installation-activities_preparing-ossm-installation-v1x"><div class="titlepage"><div><div><h3 class="title">2.4.3. Operator overview</h3></div></div></div><p>
					Red Hat OpenShift Service Mesh requires the following four Operators:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>OpenShift Elasticsearch</strong></span> - (Optional) Provides database storage for tracing and logging with the distributed tracing platform (Jaeger). It is based on the open source <a class="link" href="https://www.elastic.co/">Elasticsearch</a> project.
						</li><li class="listitem">
							<span class="strong strong"><strong>Red Hat OpenShift distributed tracing platform (Jaeger)</strong></span> - Provides distributed tracing to monitor and troubleshoot transactions in complex distributed systems. It is based on the open source <a class="link" href="https://www.jaegertracing.io/">Jaeger</a> project.
						</li><li class="listitem">
							<span class="strong strong"><strong>Kiali Operator provided by Red Hat</strong></span> - Provides observability for your service mesh. You can view configurations, monitor traffic, and analyze traces in a single console. It is based on the open source <a class="link" href="https://www.kiali.io/">Kiali</a> project.
						</li><li class="listitem">
							<span class="strong strong"><strong>Red Hat OpenShift Service Mesh</strong></span> - Allows you to connect, secure, control, and observe the microservices that comprise your applications. The Service Mesh Operator defines and monitors the <code class="literal">ServiceMeshControlPlane</code> resources that manage the deployment, updating, and deletion of the Service Mesh components. It is based on the open source <a class="link" href="https://istio.io/">Istio</a> project.
						</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/logging/#configuring-the-log-store">Configuring the log store</a> for details on configuring the default Jaeger parameters for Elasticsearch in a production environment.
					</p></div></div></section><section class="section" id="next-steps-8"><div class="titlepage"><div><div><h3 class="title">2.4.4. Next steps</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#installing-ossm-v1x">Install Red Hat OpenShift Service Mesh</a> in your OpenShift Container Platform environment.
						</li></ul></div></section></section><section class="section" id="installing-ossm-v1x"><div class="titlepage"><div><div><h2 class="title">2.5. Installing Service Mesh</h2></div></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					<span class="strong strong"><strong>You are viewing documentation for a Red Hat OpenShift Service Mesh release that is no longer supported.</strong></span>
				</p><p>
					Service Mesh version 1.0 and 1.1 control planes are no longer supported. For information about upgrading your service mesh control plane, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-versions_ossm-upgrade">Upgrading Service Mesh</a>.
				</p><p>
					For information about the support status of a particular Red Hat OpenShift Service Mesh release, see the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ossm">Product lifecycle page</a>.
				</p></div></div><p>
				Installing the Service Mesh involves installing the OpenShift Elasticsearch, Jaeger, Kiali and Service Mesh Operators, creating and managing a <code class="literal">ServiceMeshControlPlane</code> resource to deploy the control plane, and creating a <code class="literal">ServiceMeshMemberRoll</code> resource to specify the namespaces associated with the Service Mesh.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Mixer’s policy enforcement is disabled by default. You must enable it to run policy tasks. See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-mixer-policy-1x_deploying-applications-ossm-v1x">Update Mixer policy enforcement</a> for instructions on enabling Mixer policy enforcement.
				</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Multi-tenant control plane installations are the default configuration.
				</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The Service Mesh documentation uses <code class="literal">istio-system</code> as the example project, but you can deploy the service mesh to any project.
				</p></div></div><section class="section" id="prerequisites-5"><div class="titlepage"><div><div><h3 class="title">2.5.1. Prerequisites</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Follow the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#preparing-ossm-installation-v1x">Preparing to install Red Hat OpenShift Service Mesh</a> process.
						</li><li class="listitem">
							An account with the <code class="literal">cluster-admin</code> role.
						</li></ul></div><p>
					The Service Mesh installation process uses the <a class="link" href="https://operatorhub.io/">OperatorHub</a> to install the <code class="literal">ServiceMeshControlPlane</code> custom resource definition within the <code class="literal">openshift-operators</code> project. The Red Hat OpenShift Service Mesh defines and monitors the <code class="literal">ServiceMeshControlPlane</code> related to the deployment, update, and deletion of the control plane.
				</p><p>
					Starting with Red Hat OpenShift Service Mesh 1.1.18.2, you must install the OpenShift Elasticsearch Operator, the Jaeger Operator, and the Kiali Operator before the Red Hat OpenShift Service Mesh Operator can install the control plane.
				</p></section><section class="section" id="distr-tracing-operator-install-elasticsearch_installing-ossm-v1x"><div class="titlepage"><div><div><h3 class="title">2.5.2. Installing the OpenShift Elasticsearch Operator</h3></div></div></div><p>
					The default Red Hat OpenShift distributed tracing platform (Jaeger) deployment uses in-memory storage because it is designed to be installed quickly for those evaluating Red Hat OpenShift distributed tracing platform, giving demonstrations, or using Red Hat OpenShift distributed tracing platform (Jaeger) in a test environment. If you plan to use Red Hat OpenShift distributed tracing platform (Jaeger) in production, you must install and configure a persistent storage option, in this case, Elasticsearch.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the OpenShift Container Platform web console.
						</li><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
						</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Do not install Community versions of the Operators. Community Operators are not supported.
					</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you have already installed the OpenShift Elasticsearch Operator as part of OpenShift Logging, you do not need to install the OpenShift Elasticsearch Operator again. The Red Hat OpenShift distributed tracing platform (Jaeger) Operator creates the Elasticsearch instance using the installed OpenShift Elasticsearch Operator.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform web console as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
						</li><li class="listitem">
							Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span>.
						</li><li class="listitem">
							Type <span class="strong strong"><strong>Elasticsearch</strong></span> into the filter box to locate the OpenShift Elasticsearch Operator.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>OpenShift Elasticsearch Operator</strong></span> provided by Red Hat to display information about the Operator.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Install</strong></span>.
						</li><li class="listitem">
							On the <span class="strong strong"><strong>Install Operator</strong></span> page, select the <span class="strong strong"><strong>stable</strong></span> Update Channel. This automatically updates your Operator as new versions are released.
						</li><li class="listitem"><p class="simpara">
							Accept the default <span class="strong strong"><strong>All namespaces on the cluster (default)</strong></span>. This installs the Operator in the default <code class="literal">openshift-operators-redhat</code> project and makes the Operator available to all projects in the cluster.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The Elasticsearch installation requires the <span class="strong strong"><strong>openshift-operators-redhat</strong></span> namespace for the OpenShift Elasticsearch Operator. The other Red Hat OpenShift distributed tracing platform Operators are installed in the <code class="literal">openshift-operators</code> namespace.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Accept the default <span class="strong strong"><strong>Automatic</strong></span> approval strategy. By accepting the default, when a new version of this Operator is available, Operator Lifecycle Manager (OLM) automatically upgrades the running instance of your Operator without human intervention. If you select <span class="strong strong"><strong>Manual</strong></span> updates, when a newer version of an Operator is available, OLM creates an update request. As a cluster administrator, you must then manually approve that update request to have the Operator updated to the new version.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The <span class="strong strong"><strong>Manual</strong></span> approval strategy requires a user with appropriate credentials to approve the Operator install and subscription process.
							</p></div></div></li><li class="listitem">
							Click <span class="strong strong"><strong>Install</strong></span>.
						</li><li class="listitem">
							On the <span class="strong strong"><strong>Installed Operators</strong></span> page, select the <code class="literal">openshift-operators-redhat</code> project. Wait until you see that the OpenShift Elasticsearch Operator shows a status of "InstallSucceeded" before continuing.
						</li></ol></div></section><section class="section" id="distr-tracing-jaeger-operator-install_installing-ossm-v1x"><div class="titlepage"><div><div><h3 class="title">2.5.3. Installing the Red Hat OpenShift distributed tracing platform (Jaeger) Operator</h3></div></div></div><p>
					To install Red Hat OpenShift distributed tracing platform (Jaeger), you use the <a class="link" href="https://operatorhub.io/">OperatorHub</a> to install the Red Hat OpenShift distributed tracing platform (Jaeger) Operator.
				</p><p>
					By default, the Operator is installed in the <code class="literal">openshift-operators</code> project.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the OpenShift Container Platform web console.
						</li><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
						</li><li class="listitem">
							If you require persistent storage, you must also install the OpenShift Elasticsearch Operator before installing the Red Hat OpenShift distributed tracing platform (Jaeger) Operator.
						</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Do not install Community versions of the Operators. Community Operators are not supported.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform web console as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
						</li><li class="listitem">
							Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span>.
						</li><li class="listitem">
							Type <span class="strong strong"><strong>distributed tracing platform</strong></span> into the filter to locate the Red Hat OpenShift distributed tracing platform (Jaeger) Operator.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Red Hat OpenShift distributed tracing platform (Jaeger) Operator</strong></span> provided by Red Hat to display information about the Operator.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Install</strong></span>.
						</li><li class="listitem">
							On the <span class="strong strong"><strong>Install Operator</strong></span> page, select the <span class="strong strong"><strong>stable</strong></span> Update Channel. This automatically updates your Operator as new versions are released.
						</li><li class="listitem"><p class="simpara">
							Accept the default <span class="strong strong"><strong>All namespaces on the cluster (default)</strong></span>. This installs the Operator in the default <code class="literal">openshift-operators</code> project and makes the Operator available to all projects in the cluster.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Accept the default <span class="strong strong"><strong>Automatic</strong></span> approval strategy. By accepting the default, when a new version of this Operator is available, Operator Lifecycle Manager (OLM) automatically upgrades the running instance of your Operator without human intervention. If you select <span class="strong strong"><strong>Manual</strong></span> updates, when a newer version of an Operator is available, OLM creates an update request. As a cluster administrator, you must then manually approve that update request to have the Operator updated to the new version.
								</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										The <span class="strong strong"><strong>Manual</strong></span> approval strategy requires a user with appropriate credentials to approve the Operator install and subscription process.
									</p></div></div></li></ul></div></li><li class="listitem">
							Click <span class="strong strong"><strong>Install</strong></span>.
						</li><li class="listitem">
							Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
						</li><li class="listitem">
							On the <span class="strong strong"><strong>Installed Operators</strong></span> page, select the <code class="literal">openshift-operators</code> project. Wait until you see that the Red Hat OpenShift distributed tracing platform (Jaeger) Operator shows a status of "Succeeded" before continuing.
						</li></ol></div></section><section class="section" id="ossm-install-kiali_installing-ossm-v1x"><div class="titlepage"><div><div><h3 class="title">2.5.4. Installing the Kiali Operator</h3></div></div></div><p>
					You must install the Kiali Operator for the Red Hat OpenShift Service Mesh Operator to install the Service Mesh control plane.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Do not install Community versions of the Operators. Community Operators are not supported.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Access to the OpenShift Container Platform web console.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform web console.
						</li><li class="listitem">
							Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span>.
						</li><li class="listitem">
							Type <span class="strong strong"><strong>Kiali</strong></span> into the filter box to find the Kiali Operator.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Kiali Operator</strong></span> provided by Red Hat to display information about the Operator.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Install</strong></span>.
						</li><li class="listitem">
							On the <span class="strong strong"><strong>Operator Installation</strong></span> page, select the <span class="strong strong"><strong>stable</strong></span> Update Channel.
						</li><li class="listitem">
							Select <span class="strong strong"><strong>All namespaces on the cluster (default)</strong></span>. This installs the Operator in the default <code class="literal">openshift-operators</code> project and makes the Operator available to all projects in the cluster.
						</li><li class="listitem"><p class="simpara">
							Select the <span class="strong strong"><strong>Automatic</strong></span> Approval Strategy.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The Manual approval strategy requires a user with appropriate credentials to approve the Operator install and subscription process.
							</p></div></div></li><li class="listitem">
							Click <span class="strong strong"><strong>Install</strong></span>.
						</li><li class="listitem">
							The <span class="strong strong"><strong>Installed Operators</strong></span> page displays the Kiali Operator’s installation progress.
						</li></ol></div></section><section class="section" id="ossm-install-ossm-operator_installing-ossm-v1x"><div class="titlepage"><div><div><h3 class="title">2.5.5. Installing the Operators</h3></div></div></div><p>
					To install Red Hat OpenShift Service Mesh, install the following Operators in this order. Repeat the procedure for each Operator.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							OpenShift Elasticsearch
						</li><li class="listitem">
							Red Hat OpenShift distributed tracing platform (Jaeger)
						</li><li class="listitem">
							Kiali Operator provided by Red Hat
						</li><li class="listitem">
							Red Hat OpenShift Service Mesh
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you have already installed the OpenShift Elasticsearch Operator as part of OpenShift Logging, you do not need to install the OpenShift Elasticsearch Operator again. The Red Hat OpenShift distributed tracing platform (Jaeger) Operator will create the Elasticsearch instance using the installed OpenShift Elasticsearch Operator.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform web console as a user with the <code class="literal">cluster-admin</code> role. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
						</li><li class="listitem">
							In the OpenShift Container Platform web console, click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span>.
						</li><li class="listitem">
							Type the name of the Operator into the filter box and select the Red Hat version of the Operator. Community versions of the Operators are not supported.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Install</strong></span>.
						</li><li class="listitem">
							On the <span class="strong strong"><strong>Install Operator</strong></span> page for each Operator, accept the default settings.
						</li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Install</strong></span>. Wait until the Operator has installed before repeating the steps for the next Operator in the list.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The OpenShift Elasticsearch Operator is installed in the <code class="literal">openshift-operators-redhat</code> namespace and is available for all namespaces in the cluster.
								</li><li class="listitem">
									The Red Hat OpenShift distributed tracing platform (Jaeger) is installed in the <code class="literal">openshift-distributed-tracing</code> namespace and is available for all namespaces in the cluster.
								</li><li class="listitem">
									The Kiali Operator provided by Red Hat and the Red Hat OpenShift Service Mesh Operator are installed in the <code class="literal">openshift-operators</code> namespace and are available for all namespaces in the cluster.
								</li></ul></div></li><li class="listitem">
							After all you have installed all four Operators, click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> to verify that your Operators installed.
						</li></ol></div></section><section class="section" id="ossm-control-plane-deploy-1x_installing-ossm-v1x"><div class="titlepage"><div><div><h3 class="title">2.5.6. Deploying the Red Hat OpenShift Service Mesh control plane</h3></div></div></div><p>
					The <code class="literal">ServiceMeshControlPlane</code> resource defines the configuration to be used during installation. You can deploy the default configuration provided by Red Hat or customize the <code class="literal">ServiceMeshControlPlane</code> file to fit your business needs.
				</p><p>
					You can deploy the Service Mesh control plane by using the OpenShift Container Platform web console or from the command line using the <code class="literal">oc</code> client tool.
				</p><section class="section" id="ossm-control-plane-deploy-operatorhub_installing-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.5.6.1. Deploying the control plane from the web console</h4></div></div></div><p>
						Follow this procedure to deploy the Red Hat OpenShift Service Mesh control plane by using the web console. In this example, <code class="literal">istio-system</code> is the name of the control plane project.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The Red Hat OpenShift Service Mesh Operator must be installed.
							</li><li class="listitem">
								Review the instructions for how to customize the Red Hat OpenShift Service Mesh installation.
							</li><li class="listitem">
								An account with the <code class="literal">cluster-admin</code> role.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console as a user with the <code class="literal">cluster-admin</code> role.
							</li><li class="listitem"><p class="simpara">
								Create a project named <code class="literal">istio-system</code>.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Navigate to <span class="strong strong"><strong>Home</strong></span> → <span class="strong strong"><strong>Projects</strong></span>.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Create Project</strong></span>.
									</li><li class="listitem">
										Enter <code class="literal">istio-system</code> in the <span class="strong strong"><strong>Name</strong></span> field.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Create</strong></span>.
									</li></ol></div></li><li class="listitem">
								Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								If necessary, select <code class="literal">istio-system</code> from the Project menu. You may have to wait a few moments for the Operators to be copied to the new project.
							</li><li class="listitem"><p class="simpara">
								Click the Red Hat OpenShift Service Mesh Operator. Under <span class="strong strong"><strong>Provided APIs</strong></span>, the Operator provides links to create two resource types:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										A <code class="literal">ServiceMeshControlPlane</code> resource
									</li><li class="listitem">
										A <code class="literal">ServiceMeshMemberRoll</code> resource
									</li></ul></div></li><li class="listitem">
								Under <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span> click <span class="strong strong"><strong>Create ServiceMeshControlPlane</strong></span>.
							</li><li class="listitem"><p class="simpara">
								On the <span class="strong strong"><strong>Create Service Mesh Control Plane</strong></span> page, modify the YAML for the default <code class="literal">ServiceMeshControlPlane</code> template as needed.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									For additional information about customizing the control plane, see customizing the Red Hat OpenShift Service Mesh installation. For production, you <span class="emphasis"><em>must</em></span> change the default Jaeger template.
								</p></div></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Create</strong></span> to create the control plane. The Operator creates pods, services, and Service Mesh control plane components based on your configuration parameters.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span> tab.
							</li><li class="listitem">
								Click the name of the new control plane.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Resources</strong></span> tab to see the Red Hat OpenShift Service Mesh control plane resources the Operator created and configured.
							</li></ol></div></section><section class="section" id="ossm-control-plane-deploy-cli_installing-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.5.6.2. Deploying the control plane from the CLI</h4></div></div></div><p>
						Follow this procedure to deploy the Red Hat OpenShift Service Mesh control plane the command line.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The Red Hat OpenShift Service Mesh Operator must be installed.
							</li><li class="listitem">
								Review the instructions for how to customize the Red Hat OpenShift Service Mesh installation.
							</li><li class="listitem">
								An account with the <code class="literal">cluster-admin</code> role.
							</li><li class="listitem">
								Access to the OpenShift CLI (<code class="literal">oc</code>).
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Log in to the OpenShift Container Platform CLI as a user with the <code class="literal">cluster-admin</code> role.
							</p><pre class="programlisting language-terminal">$ oc login --username=&lt;NAMEOFUSER&gt; https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
								Create a project named <code class="literal">istio-system</code>.
							</p><pre class="programlisting language-terminal">$ oc new-project istio-system</pre></li><li class="listitem">
								Create a <code class="literal">ServiceMeshControlPlane</code> file named <code class="literal">istio-installation.yaml</code> using the example found in "Customize the Red Hat OpenShift Service Mesh installation". You can customize the values as needed to match your use case. For production deployments you <span class="emphasis"><em>must</em></span> change the default Jaeger template.
							</li><li class="listitem"><p class="simpara">
								Run the following command to deploy the control plane:
							</p><pre class="programlisting language-terminal">$ oc create -n istio-system -f istio-installation.yaml</pre></li><li class="listitem"><p class="simpara">
								Execute the following command to see the status of the control plane installation.
							</p><pre class="programlisting language-terminal">$ oc get smcp -n istio-system</pre><p class="simpara">
								The installation has finished successfully when the STATUS column is <code class="literal">ComponentsReady</code>.
							</p><pre class="screen">NAME            READY   STATUS            PROFILES      VERSION   AGE
basic-install   11/11   ComponentsReady   ["default"]   v1.1.18   4m25s</pre></li><li class="listitem"><p class="simpara">
								Run the following command to watch the progress of the Pods during the installation process:
							</p><pre class="screen">$ oc get pods -n istio-system -w</pre><p class="simpara">
								You should see output similar to the following:
							</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                     READY   STATUS             RESTARTS   AGE
grafana-7bf5764d9d-2b2f6                 2/2     Running            0          28h
istio-citadel-576b9c5bbd-z84z4           1/1     Running            0          28h
istio-egressgateway-5476bc4656-r4zdv     1/1     Running            0          28h
istio-galley-7d57b47bb7-lqdxv            1/1     Running            0          28h
istio-ingressgateway-dbb8f7f46-ct6n5     1/1     Running            0          28h
istio-pilot-546bf69578-ccg5x             2/2     Running            0          28h
istio-policy-77fd498655-7pvjw            2/2     Running            0          28h
istio-sidecar-injector-df45bd899-ctxdt   1/1     Running            0          28h
istio-telemetry-66f697d6d5-cj28l         2/2     Running            0          28h
jaeger-896945cbc-7lqrr                   2/2     Running            0          11h
kiali-78d9c5b87c-snjzh                   1/1     Running            0          22h
prometheus-6dff867c97-gr2n5              2/2     Running            0          28h</pre>

								</p></div></li></ol></div><p>
						For a multitenant installation, Red Hat OpenShift Service Mesh supports multiple independent control planes within the cluster. You can create reusable configurations with <code class="literal">ServiceMeshControlPlane</code> templates. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-control-plane-templates-1x_deploying-applications-ossm-v1x">Creating control plane templates</a>.
					</p></section></section><section class="section" id="ossm-member-roll-create_installing-ossm-v1x"><div class="titlepage"><div><div><h3 class="title">2.5.7. Creating the Red Hat OpenShift Service Mesh member roll</h3></div></div></div><p>
					The <code class="literal">ServiceMeshMemberRoll</code> lists the projects that belong to the Service Mesh control plane. Only projects listed in the <code class="literal">ServiceMeshMemberRoll</code> are affected by the control plane. A project does not belong to a service mesh until you add it to the member roll for a particular control plane deployment.
				</p><p>
					You must create a <code class="literal">ServiceMeshMemberRoll</code> resource named <code class="literal">default</code> in the same project as the <code class="literal">ServiceMeshControlPlane</code>, for example <code class="literal">istio-system</code>.
				</p><section class="section" id="ossm-member-roll-create-console_installing-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.5.7.1. Creating the member roll from the web console</h4></div></div></div><p>
						You can add one or more projects to the Service Mesh member roll from the web console. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								An installed, verified Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								List of existing projects to add to the service mesh.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console.
							</li><li class="listitem"><p class="simpara">
								If you do not already have services for your mesh, or you are starting from scratch, create a project for your applications. It must be different from the project where you installed the Service Mesh control plane.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Navigate to <span class="strong strong"><strong>Home</strong></span> → <span class="strong strong"><strong>Projects</strong></span>.
									</li><li class="listitem">
										Enter a name in the <span class="strong strong"><strong>Name</strong></span> field.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Create</strong></span>.
									</li></ol></div></li><li class="listitem">
								Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Project</strong></span> menu and choose the project where your <code class="literal">ServiceMeshControlPlane</code> resource is deployed from the list, for example <code class="literal">istio-system</code>.
							</li><li class="listitem">
								Click the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Istio Service Mesh Member Roll</strong></span> tab.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Create ServiceMeshMemberRoll</strong></span>
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Members</strong></span>, then enter the name of your project in the <span class="strong strong"><strong>Value</strong></span> field. You can add any number of projects, but a project can only belong to <span class="strong strong"><strong>one</strong></span> <code class="literal">ServiceMeshMemberRoll</code> resource.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Create</strong></span>.
							</li></ol></div></section><section class="section" id="ossm-member-roll-create-cli_installing-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.5.7.2. Creating the member roll from the CLI</h4></div></div></div><p>
						You can add a project to the <code class="literal">ServiceMeshMemberRoll</code> from the command line.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								An installed, verified Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								List of projects to add to the service mesh.
							</li><li class="listitem">
								Access to the OpenShift CLI (<code class="literal">oc</code>).
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Log in to the OpenShift Container Platform CLI.
							</p><pre class="programlisting language-terminal">$ oc login --username=&lt;NAMEOFUSER&gt; https://&lt;HOSTNAME&gt;:6443</pre></li><li class="listitem"><p class="simpara">
								If you do not already have services for your mesh, or you are starting from scratch, create a project for your applications. It must be different from the project where you installed the Service Mesh control plane.
							</p><pre class="programlisting language-terminal">$ oc new-project &lt;your-project&gt;</pre></li><li class="listitem"><p class="simpara">
								To add your projects as members, modify the following example YAML. You can add any number of projects, but a project can only belong to <span class="strong strong"><strong>one</strong></span> <code class="literal">ServiceMeshMemberRoll</code> resource. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
							</p><div class="formalpara"><p class="title"><strong>Example servicemeshmemberroll-default.yaml</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshMemberRoll
metadata:
  name: default
  namespace: istio-system
spec:
  members:
    # a list of projects joined into the service mesh
    - your-project-name
    - another-project-name</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Run the following command to upload and create the <code class="literal">ServiceMeshMemberRoll</code> resource in the <code class="literal">istio-system</code> namespace.
							</p><pre class="programlisting language-terminal">$ oc create -n istio-system -f servicemeshmemberroll-default.yaml</pre></li><li class="listitem"><p class="simpara">
								Run the following command to verify the <code class="literal">ServiceMeshMemberRoll</code> was created successfully.
							</p><pre class="programlisting language-terminal">$ oc get smmr -n istio-system default</pre><p class="simpara">
								The installation has finished successfully when the <code class="literal">STATUS</code> column is <code class="literal">Configured</code>.
							</p></li></ol></div></section></section><section class="section" id="ossm-member-roll-modify_installing-ossm-v1x"><div class="titlepage"><div><div><h3 class="title">2.5.8. Adding or removing projects from the service mesh</h3></div></div></div><p>
					You can add or remove projects from an existing Service Mesh <code class="literal">ServiceMeshMemberRoll</code> resource using the web console.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							You can add any number of projects, but a project can only belong to <span class="strong strong"><strong>one</strong></span> <code class="literal">ServiceMeshMemberRoll</code> resource.
						</li><li class="listitem">
							The <code class="literal">ServiceMeshMemberRoll</code> resource is deleted when its corresponding <code class="literal">ServiceMeshControlPlane</code> resource is deleted.
						</li></ul></div><section class="section" id="ossm-member-roll-modify-console_installing-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.5.8.1. Adding or removing projects from the member roll using the web console</h4></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								An installed, verified Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								An existing <code class="literal">ServiceMeshMemberRoll</code> resource.
							</li><li class="listitem">
								Name of the project with the <code class="literal">ServiceMeshMemberRoll</code> resource.
							</li><li class="listitem">
								Names of the projects you want to add or remove from the mesh.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console.
							</li><li class="listitem">
								Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Project</strong></span> menu and choose the project where your <code class="literal">ServiceMeshControlPlane</code> resource is deployed from the list, for example <code class="literal">istio-system</code>.
							</li><li class="listitem">
								Click the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Istio Service Mesh Member Roll</strong></span> tab.
							</li><li class="listitem">
								Click the <code class="literal">default</code> link.
							</li><li class="listitem">
								Click the YAML tab.
							</li><li class="listitem">
								Modify the YAML to add or remove projects as members. You can add any number of projects, but a project can only belong to <span class="strong strong"><strong>one</strong></span> <code class="literal">ServiceMeshMemberRoll</code> resource.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Reload</strong></span>.
							</li></ol></div></section><section class="section" id="ossm-member-roll-modify-cli_installing-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.5.8.2. Adding or removing projects from the member roll using the CLI</h4></div></div></div><p>
						You can modify an existing Service Mesh member roll using the command line.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								An installed, verified Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								An existing <code class="literal">ServiceMeshMemberRoll</code> resource.
							</li><li class="listitem">
								Name of the project with the <code class="literal">ServiceMeshMemberRoll</code> resource.
							</li><li class="listitem">
								Names of the projects you want to add or remove from the mesh.
							</li><li class="listitem">
								Access to the OpenShift CLI (<code class="literal">oc</code>).
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform CLI.
							</li><li class="listitem"><p class="simpara">
								Edit the <code class="literal">ServiceMeshMemberRoll</code> resource.
							</p><pre class="programlisting language-terminal">$ oc edit smmr -n &lt;controlplane-namespace&gt;</pre></li><li class="listitem"><p class="simpara">
								Modify the YAML to add or remove projects as members. You can add any number of projects, but a project can only belong to <span class="strong strong"><strong>one</strong></span> <code class="literal">ServiceMeshMemberRoll</code> resource.
							</p><div class="formalpara"><p class="title"><strong>Example servicemeshmemberroll-default.yaml</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshMemberRoll
metadata:
  name: default
  namespace: istio-system #control plane project
spec:
  members:
    # a list of projects joined into the service mesh
    - your-project-name
    - another-project-name</pre>

								</p></div></li></ol></div></section></section><section class="section" id="manual-updates"><div class="titlepage"><div><div><h3 class="title">2.5.9. Manual updates</h3></div></div></div><p>
					If you choose to update manually, the Operator Lifecycle Manager (OLM) controls the installation, upgrade, and role-based access control (RBAC) of Operators in a cluster. OLM runs by default in OpenShift Container Platform. OLM uses CatalogSources, which use the Operator Registry API, to query for available Operators as well as upgrades for installed Operators.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							For more information about how OpenShift Container Platform handled upgrades, refer to the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-overview_olm-understanding-olm">Operator Lifecycle Manager</a> documentation.
						</li></ul></div><section class="section" id="ossm-update-app-sidecar_installing-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.5.9.1. Updating sidecar proxies</h4></div></div></div><p>
						In order to update the configuration for sidecar proxies the application administrator must restart the application pods.
					</p><p>
						If your deployment uses automatic sidecar injection, you can update the pod template in the deployment by adding or modifying an annotation. Run the following command to redeploy the pods:
					</p><pre class="programlisting language-terminal">$ oc patch deployment/&lt;deployment&gt; -p '{"spec":{"template":{"metadata":{"annotations":{"kubectl.kubernetes.io/restartedAt": "'`date -Iseconds`'"}}}}}'</pre><p>
						If your deployment does not use automatic sidecar injection, you must manually update the sidecars by modifying the sidecar container image specified in the deployment or pod, and then restart the pods.
					</p></section></section><section class="section" id="next-steps-9"><div class="titlepage"><div><div><h3 class="title">2.5.10. Next steps</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#deploying-applications-ossm-v1x">Prepare to deploy applications</a> on Red Hat OpenShift Service Mesh.
						</li></ul></div></section></section><section class="section" id="ossm-security-v1x"><div class="titlepage"><div><div><h2 class="title">2.6. Customizing security in a Service Mesh</h2></div></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					<span class="strong strong"><strong>You are viewing documentation for a Red Hat OpenShift Service Mesh release that is no longer supported.</strong></span>
				</p><p>
					Service Mesh version 1.0 and 1.1 control planes are no longer supported. For information about upgrading your service mesh control plane, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-versions_ossm-upgrade">Upgrading Service Mesh</a>.
				</p><p>
					For information about the support status of a particular Red Hat OpenShift Service Mesh release, see the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ossm">Product lifecycle page</a>.
				</p></div></div><p>
				If your service mesh application is constructed with a complex array of microservices, you can use Red Hat OpenShift Service Mesh to customize the security of the communication between those services. The infrastructure of OpenShift Container Platform along with the traffic management features of Service Mesh can help you manage the complexity of your applications and provide service and identity security for microservices.
			</p><section class="section" id="ossm-security-mtls_ossm-security-v1x"><div class="titlepage"><div><div><h3 class="title">2.6.1. Enabling mutual Transport Layer Security (mTLS)</h3></div></div></div><p>
					Mutual Transport Layer Security (mTLS) is a protocol where two parties authenticate each other. It is the default mode of authentication in some protocols (IKE, SSH) and optional in others (TLS).
				</p><p>
					mTLS can be used without changes to the application or service code. The TLS is handled entirely by the service mesh infrastructure and between the two sidecar proxies.
				</p><p>
					By default, Red Hat OpenShift Service Mesh is set to permissive mode, where the sidecars in Service Mesh accept both plain-text traffic and connections that are encrypted using mTLS. If a service in your mesh is communicating with a service outside the mesh, strict mTLS could break communication between those services. Use permissive mode while you migrate your workloads to Service Mesh.
				</p><section class="section" id="ossm-security-enabling-strict-mtls_ossm-security-v1x"><div class="titlepage"><div><div><h4 class="title">2.6.1.1. Enabling strict mTLS across the mesh</h4></div></div></div><p>
						If your workloads do not communicate with services outside your mesh and communication will not be interrupted by only accepting encrypted connections, you can enable mTLS across your mesh quickly. Set <code class="literal">spec.istio.global.mtls.enabled</code> to <code class="literal">true</code> in your <code class="literal">ServiceMeshControlPlane</code> resource. The operator creates the required resources.
					</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshControlPlane
spec:
  istio:
    global:
      mtls:
        enabled: true</pre><section class="section" id="ossm-security-mtls-sidecars-incoming-services_ossm-security-v1x"><div class="titlepage"><div><div><h5 class="title">2.6.1.1.1. Configuring sidecars for incoming connections for specific services</h5></div></div></div><p>
							You can also configure mTLS for individual services or namespaces by creating a policy.
						</p><pre class="programlisting language-yaml">apiVersion: "authentication.istio.io/v1alpha1"
kind: "Policy"
metadata:
  name: default
  namespace: &lt;NAMESPACE&gt;
spec:
  peers:
    - mtls: {}</pre></section></section><section class="section" id="ossm-security-mtls-sidecars-outgoing_ossm-security-v1x"><div class="titlepage"><div><div><h4 class="title">2.6.1.2. Configuring sidecars for outgoing connections</h4></div></div></div><p>
						Create a destination rule to configure Service Mesh to use mTLS when sending requests to other services in the mesh.
					</p><pre class="programlisting language-yaml">apiVersion: "networking.istio.io/v1alpha3"
kind: "DestinationRule"
metadata:
  name: "default"
  namespace: &lt;CONTROL_PLANE_NAMESPACE&gt;&gt;
spec:
  host: "*.local"
  trafficPolicy:
    tls:
      mode: ISTIO_MUTUAL</pre></section><section class="section" id="ossm-security-min-max-tls_ossm-security-v1x"><div class="titlepage"><div><div><h4 class="title">2.6.1.3. Setting the minimum and maximum protocol versions</h4></div></div></div><p>
						If your environment has specific requirements for encrypted traffic in your service mesh, you can control the cryptographic functions that are allowed by setting the <code class="literal">spec.security.controlPlane.tls.minProtocolVersion</code> or <code class="literal">spec.security.controlPlane.tls.maxProtocolVersion</code> in your <code class="literal">ServiceMeshControlPlane</code> resource. Those values, configured in your control plane resource, define the minimum and maximum TLS version used by mesh components when communicating securely over TLS.
					</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshControlPlane
spec:
  istio:
    global:
      tls:
        minProtocolVersion: TLSv1_2
        maxProtocolVersion: TLSv1_3</pre><p>
						The default is <code class="literal">TLS_AUTO</code> and does not specify a version of TLS.
					</p><div class="table" id="idm140663651704352"><p class="title"><strong>Table 2.3. Valid values</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663651699520" scope="col">Value</th><th align="left" valign="top" id="idm140663651698432" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663651699520"> <p>
										<code class="literal">TLS_AUTO</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663651698432"> <p>
										default
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663651699520"> <p>
										<code class="literal">TLSv1_0</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663651698432"> <p>
										TLS version 1.0
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663651699520"> <p>
										<code class="literal">TLSv1_1</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663651698432"> <p>
										TLS version 1.1
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663651699520"> <p>
										<code class="literal">TLSv1_2</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663651698432"> <p>
										TLS version 1.2
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663651699520"> <p>
										<code class="literal">TLSv1_3</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663651698432"> <p>
										TLS version 1.3
									</p>
									 </td></tr></tbody></table></div></div></section></section><section class="section" id="ossm-security-cipher-1x_ossm-security-v1x"><div class="titlepage"><div><div><h3 class="title">2.6.2. Configuring cipher suites and ECDH curves</h3></div></div></div><p>
					Cipher suites and Elliptic-curve Diffie–Hellman (ECDH curves) can help you secure your service mesh. You can define a comma separated list of cipher suites using <code class="literal">spec.istio.global.tls.cipherSuites</code> and ECDH curves using <code class="literal">spec.istio.global.tls.ecdhCurves</code> in your <code class="literal">ServiceMeshControlPlane</code> resource. If either of these attributes are empty, then the default values are used.
				</p><p>
					The <code class="literal">cipherSuites</code> setting is effective if your service mesh uses TLS 1.2 or earlier. It has no effect when negotiating with TLS 1.3.
				</p><p>
					Set your cipher suites in the comma separated list in order of priority. For example, <code class="literal">ecdhCurves: CurveP256, CurveP384</code> sets <code class="literal">CurveP256</code> as a higher priority than <code class="literal">CurveP384</code>.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						You must include either <code class="literal">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</code> or <code class="literal">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</code> when you configure the cipher suite. HTTP/2 support requires at least one of these cipher suites.
					</p></div></div><p>
					The supported cipher suites are:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256
						</li><li class="listitem">
							TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256
						</li><li class="listitem">
							TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
						</li><li class="listitem">
							TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
						</li><li class="listitem">
							TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
						</li><li class="listitem">
							TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
						</li><li class="listitem">
							TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256
						</li><li class="listitem">
							TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA
						</li><li class="listitem">
							TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256
						</li><li class="listitem">
							TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA
						</li><li class="listitem">
							TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA
						</li><li class="listitem">
							TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA
						</li><li class="listitem">
							TLS_RSA_WITH_AES_128_GCM_SHA256
						</li><li class="listitem">
							TLS_RSA_WITH_AES_256_GCM_SHA384
						</li><li class="listitem">
							TLS_RSA_WITH_AES_128_CBC_SHA256
						</li><li class="listitem">
							TLS_RSA_WITH_AES_128_CBC_SHA
						</li><li class="listitem">
							TLS_RSA_WITH_AES_256_CBC_SHA
						</li><li class="listitem">
							TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA
						</li><li class="listitem">
							TLS_RSA_WITH_3DES_EDE_CBC_SHA
						</li></ul></div><p>
					The supported ECDH Curves are:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							CurveP256
						</li><li class="listitem">
							CurveP384
						</li><li class="listitem">
							CurveP521
						</li><li class="listitem">
							X25519
						</li></ul></div></section><section class="section" id="ossm-cert-manage-1x_ossm-security-v1x"><div class="titlepage"><div><div><h3 class="title">2.6.3. Adding an external certificate authority key and certificate</h3></div></div></div><p>
					By default, Red Hat OpenShift Service Mesh generates self-signed root certificate and key, and uses them to sign the workload certificates. You can also use the user-defined certificate and key to sign workload certificates, with user-defined root certificate. This task demonstrates an example to plug certificates and key into Service Mesh.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You must have installed Red Hat OpenShift Service Mesh with mutual TLS enabled to configure certificates.
						</li><li class="listitem">
							This example uses the certificates from the <a class="link" href="https://github.com/maistra/istio/tree/maistra-2.0/samples/certs">Maistra repository</a>. For production, use your own certificates from your certificate authority.
						</li><li class="listitem">
							You must deploy the Bookinfo sample application to verify the results with these instructions.
						</li></ul></div><section class="section" id="ossm-cert-manage-add-cert-key-1x_ossm-security-v1x"><div class="titlepage"><div><div><h4 class="title">2.6.3.1. Adding an existing certificate and key</h4></div></div></div><p>
						To use an existing signing (CA) certificate and key, you must create a chain of trust file that includes the CA certificate, key, and root certificate. You must use the following exact file names for each of the corresponding certificates. The CA certificate is called <code class="literal">ca-cert.pem</code>, the key is <code class="literal">ca-key.pem</code>, and the root certificate, which signs <code class="literal">ca-cert.pem</code>, is called <code class="literal">root-cert.pem</code>. If your workload uses intermediate certificates, you must specify them in a <code class="literal">cert-chain.pem</code> file.
					</p><p>
						Add the certificates to Service Mesh by following these steps. Save the example certificates from the <a class="link" href="https://github.com/maistra/istio/tree/maistra-1.1/samples/certs">Maistra repo</a> locally and replace <code class="literal">&lt;path&gt;</code> with the path to your certificates.
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a secret <code class="literal">cacert</code> that includes the input files <code class="literal">ca-cert.pem</code>, <code class="literal">ca-key.pem</code>, <code class="literal">root-cert.pem</code> and <code class="literal">cert-chain.pem</code>.
							</p><pre class="programlisting language-terminal">$ oc create secret generic cacerts -n istio-system --from-file=&lt;path&gt;/ca-cert.pem \
    --from-file=&lt;path&gt;/ca-key.pem --from-file=&lt;path&gt;/root-cert.pem \
    --from-file=&lt;path&gt;/cert-chain.pem</pre></li><li class="listitem"><p class="simpara">
								In the <code class="literal">ServiceMeshControlPlane</code> resource set <code class="literal">global.mtls.enabled</code> to <code class="literal">true</code> and <code class="literal">security.selfSigned</code> set to <code class="literal">false</code>. Service Mesh reads the certificates and key from the secret-mount files.
							</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshControlPlane
spec:
  istio:
    global:
      mtls:
        enabled: true
    security:
      selfSigned: false</pre></li><li class="listitem"><p class="simpara">
								To make sure the workloads add the new certificates promptly, delete the secrets generated by Service Mesh, named <code class="literal">istio.*</code>. In this example, <code class="literal">istio.default</code>. Service Mesh issues new certificates for the workloads.
							</p><pre class="programlisting language-terminal">$ oc delete secret istio.default</pre></li></ol></div></section><section class="section" id="ossm-cert-manage-verify-cert-1x_ossm-security-v1x"><div class="titlepage"><div><div><h4 class="title">2.6.3.2. Verifying your certificates</h4></div></div></div><p>
						Use the Bookinfo sample application to verify your certificates are mounted correctly. First, retrieve the mounted certificates. Then, verify the certificates mounted on the pod.
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Store the pod name in the variable <code class="literal">RATINGSPOD</code>.
							</p><pre class="programlisting language-terminal">$ RATINGSPOD=`oc get pods -l app=ratings -o jsonpath='{.items[0].metadata.name}'`</pre></li><li class="listitem"><p class="simpara">
								Run the following commands to retrieve the certificates mounted on the proxy.
							</p><pre class="programlisting language-terminal">$ oc exec -it $RATINGSPOD -c istio-proxy -- /bin/cat /etc/certs/root-cert.pem &gt; /tmp/pod-root-cert.pem</pre><p class="simpara">
								The file <code class="literal">/tmp/pod-root-cert.pem</code> contains the root certificate propagated to the pod.
							</p><pre class="programlisting language-terminal">$ oc exec -it $RATINGSPOD -c istio-proxy -- /bin/cat /etc/certs/cert-chain.pem &gt; /tmp/pod-cert-chain.pem</pre><p class="simpara">
								The file <code class="literal">/tmp/pod-cert-chain.pem</code> contains the workload certificate and the CA certificate propagated to the pod.
							</p></li><li class="listitem"><p class="simpara">
								Verify the root certificate is the same as the one specified by the Operator. Replace <code class="literal">&lt;path&gt;</code> with the path to your certificates.
							</p><pre class="programlisting language-terminal">$ openssl x509 -in &lt;path&gt;/root-cert.pem -text -noout &gt; /tmp/root-cert.crt.txt</pre><pre class="programlisting language-terminal">$ openssl x509 -in /tmp/pod-root-cert.pem -text -noout &gt; /tmp/pod-root-cert.crt.txt</pre><pre class="programlisting language-terminal">$ diff /tmp/root-cert.crt.txt /tmp/pod-root-cert.crt.txt</pre><p class="simpara">
								Expect the output to be empty.
							</p></li><li class="listitem"><p class="simpara">
								Verify the CA certificate is the same as the one specified by Operator. Replace <code class="literal">&lt;path&gt;</code> with the path to your certificates.
							</p><pre class="programlisting language-terminal">$ sed '0,/^-----END CERTIFICATE-----/d' /tmp/pod-cert-chain.pem &gt; /tmp/pod-cert-chain-ca.pem</pre><pre class="programlisting language-terminal">$ openssl x509 -in &lt;path&gt;/ca-cert.pem -text -noout &gt; /tmp/ca-cert.crt.txt</pre><pre class="programlisting language-terminal">$ openssl x509 -in /tmp/pod-cert-chain-ca.pem -text -noout &gt; /tmp/pod-cert-chain-ca.crt.txt</pre><pre class="programlisting language-terminal">$ diff /tmp/ca-cert.crt.txt /tmp/pod-cert-chain-ca.crt.txt</pre><p class="simpara">
								Expect the output to be empty.
							</p></li><li class="listitem"><p class="simpara">
								Verify the certificate chain from the root certificate to the workload certificate. Replace <code class="literal">&lt;path&gt;</code> with the path to your certificates.
							</p><pre class="programlisting language-terminal">$ head -n 21 /tmp/pod-cert-chain.pem &gt; /tmp/pod-cert-chain-workload.pem</pre><pre class="programlisting language-terminal">$ openssl verify -CAfile &lt;(cat &lt;path&gt;/ca-cert.pem &lt;path&gt;/root-cert.pem) /tmp/pod-cert-chain-workload.pem</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">/tmp/pod-cert-chain-workload.pem: OK</pre>

								</p></div></li></ol></div></section><section class="section" id="ossm-cert-cleanup-1x_ossm-security-v1x"><div class="titlepage"><div><div><h4 class="title">2.6.3.3. Removing the certificates</h4></div></div></div><p>
						To remove the certificates you added, follow these steps.
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Remove the secret <code class="literal">cacerts</code>.
							</p><pre class="programlisting language-terminal">$ oc delete secret cacerts -n istio-system</pre></li><li class="listitem"><p class="simpara">
								Redeploy Service Mesh with a self-signed root certificate in the <code class="literal">ServiceMeshControlPlane</code> resource.
							</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshControlPlane
spec:
  istio:
    global:
      mtls:
        enabled: true
    security:
      selfSigned: true</pre></li></ol></div></section></section></section><section class="section" id="ossm-routing-traffic-v1x"><div class="titlepage"><div><div><h2 class="title">2.7. Traffic management</h2></div></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					<span class="strong strong"><strong>You are viewing documentation for a Red Hat OpenShift Service Mesh release that is no longer supported.</strong></span>
				</p><p>
					Service Mesh version 1.0 and 1.1 control planes are no longer supported. For information about upgrading your service mesh control plane, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-versions_ossm-upgrade">Upgrading Service Mesh</a>.
				</p><p>
					For information about the support status of a particular Red Hat OpenShift Service Mesh release, see the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ossm">Product lifecycle page</a>.
				</p></div></div><p>
				You can control the flow of traffic and API calls between services in Red Hat OpenShift Service Mesh. For example, some services in your service mesh may need to communicate within the mesh and others may need to be hidden. Manage the traffic to hide specific backend services, expose services, create testing or versioning deployments, or add a security layer on a set of services.
			</p><section class="section" id="ossm-gateways_routing-traffic-v1x"><div class="titlepage"><div><div><h3 class="title">2.7.1. Using gateways</h3></div></div></div><p>
					You can use a gateway to manage inbound and outbound traffic for your mesh to specify which traffic you want to enter or leave the mesh. Gateway configurations are applied to standalone Envoy proxies that are running at the edge of the mesh, rather than sidecar Envoy proxies running alongside your service workloads.
				</p><p>
					Unlike other mechanisms for controlling traffic entering your systems, such as the Kubernetes Ingress APIs, Red Hat OpenShift Service Mesh gateways use the full power and flexibility of traffic routing.
				</p><p>
					The Red Hat OpenShift Service Mesh gateway resource can use layer 4-6 load balancing properties, such as ports, to expose and configure Red Hat OpenShift Service Mesh TLS settings. Instead of adding application-layer traffic routing (L7) to the same API resource, you can bind a regular Red Hat OpenShift Service Mesh virtual service to the gateway and manage gateway traffic like any other data plane traffic in a service mesh.
				</p><p>
					Gateways are primarily used to manage ingress traffic, but you can also configure egress gateways. An egress gateway lets you configure a dedicated exit node for the traffic leaving the mesh. This enables you to limit which services have access to external networks, which adds security control to your service mesh. You can also use a gateway to configure a purely internal proxy.
				</p><div class="formalpara"><p class="title"><strong>Gateway example</strong></p><p>
						A gateway resource describes a load balancer operating at the edge of the mesh receiving incoming or outgoing HTTP/TCP connections. The specification describes a set of ports that should be exposed, the type of protocol to use, SNI configuration for the load balancer, and so on.
					</p></div><p>
					The following example shows a sample gateway configuration for external HTTPS ingress traffic:
				</p><pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: Gateway
metadata:
  name: ext-host-gwy
spec:
  selector:
    istio: ingressgateway # use istio default controller
  servers:
  - port:
      number: 443
      name: https
      protocol: HTTPS
    hosts:
    - ext-host.example.com
    tls:
      mode: SIMPLE
      serverCertificate: /tmp/tls.crt
      privateKey: /tmp/tls.key</pre><p>
					This gateway configuration lets HTTPS traffic from <code class="literal">ext-host.example.com</code> into the mesh on port 443, but doesn’t specify any routing for the traffic.
				</p><p>
					To specify routing and for the gateway to work as intended, you must also bind the gateway to a virtual service. You do this using the virtual service’s gateways field, as shown in the following example:
				</p><pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: virtual-svc
spec:
  hosts:
  - ext-host.example.com
  gateways:
    - ext-host-gwy</pre><p>
					You can then configure the virtual service with routing rules for the external traffic.
				</p></section><section class="section" id="ossm-routing-ingress-gateway_routing-traffic-v1x"><div class="titlepage"><div><div><h3 class="title">2.7.2. Configuring an ingress gateway</h3></div></div></div><p>
					An ingress gateway is a load balancer operating at the edge of the mesh that receives incoming HTTP/TCP connections. It configures exposed ports and protocols but does not include any traffic routing configuration. Traffic routing for ingress traffic is instead configured with routing rules, the same way as for internal service requests.
				</p><p>
					The following steps show how to create a gateway and configure a <code class="literal">VirtualService</code> to expose a service in the Bookinfo sample application to outside traffic for paths <code class="literal">/productpage</code> and <code class="literal">/login</code>.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a gateway to accept traffic.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create a YAML file, and copy the following YAML into it.
								</p><div class="formalpara"><p class="title"><strong>Gateway example gateway.yaml</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: Gateway
metadata:
  name: bookinfo-gateway
spec:
  selector:
    istio: ingressgateway
  servers:
  - port:
      number: 80
      name: http
      protocol: HTTP
    hosts:
    - "*"</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Apply the YAML file.
								</p><pre class="programlisting language-terminal">$ oc apply -f gateway.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">VirtualService</code> object to rewrite the host header.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create a YAML file, and copy the following YAML into it.
								</p><div class="formalpara"><p class="title"><strong>Virtual service example</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: bookinfo
spec:
  hosts:
  - "*"
  gateways:
  - bookinfo-gateway
  http:
  - match:
    - uri:
        exact: /productpage
    - uri:
        prefix: /static
    - uri:
        exact: /login
    - uri:
        exact: /logout
    - uri:
        prefix: /api/v1/products
    route:
    - destination:
        host: productpage
        port:
          number: 9080</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Apply the YAML file.
								</p><pre class="programlisting language-terminal">$ oc apply -f vs.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Test that the gateway and VirtualService have been set correctly.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Set the Gateway URL.
								</p><pre class="programlisting language-terminal">export GATEWAY_URL=$(oc -n istio-system get route istio-ingressgateway -o jsonpath='{.spec.host}')</pre></li><li class="listitem"><p class="simpara">
									Set the port number. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
								</p><pre class="programlisting language-terminal">export TARGET_PORT=$(oc -n istio-system get route istio-ingressgateway -o jsonpath='{.spec.port.targetPort}')</pre></li><li class="listitem"><p class="simpara">
									Test a page that has been explicitly exposed.
								</p><pre class="programlisting language-terminal">curl -s -I "$GATEWAY_URL/productpage"</pre><p class="simpara">
									The expected result is <code class="literal">200</code>.
								</p></li></ol></div></li></ol></div></section><section class="section" id="ossm-routing-ingress_routing-traffic-v1x"><div class="titlepage"><div><div><h3 class="title">2.7.3. Managing ingress traffic</h3></div></div></div><p>
					In Red Hat OpenShift Service Mesh, the Ingress Gateway enables features such as monitoring, security, and route rules to apply to traffic that enters the cluster. Use a Service Mesh gateway to expose a service outside of the service mesh.
				</p><section class="section" id="ossm-routing-determine-ingress_routing-traffic-v1x"><div class="titlepage"><div><div><h4 class="title">2.7.3.1. Determining the ingress IP and ports</h4></div></div></div><p>
						Ingress configuration differs depending on if your environment supports an external load balancer. An external load balancer is set in the ingress IP and ports for the cluster. To determine if your cluster’s IP and ports are configured for external load balancers, run the following command. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
					</p><pre class="programlisting language-terminal">$ oc get svc istio-ingressgateway -n istio-system</pre><p>
						That command returns the <code class="literal">NAME</code>, <code class="literal">TYPE</code>, <code class="literal">CLUSTER-IP</code>, <code class="literal">EXTERNAL-IP</code>, <code class="literal">PORT(S)</code>, and <code class="literal">AGE</code> of each item in your namespace.
					</p><p>
						If the <code class="literal">EXTERNAL-IP</code> value is set, your environment has an external load balancer that you can use for the ingress gateway.
					</p><p>
						If the <code class="literal">EXTERNAL-IP</code> value is <code class="literal">&lt;none&gt;</code>, or perpetually <code class="literal">&lt;pending&gt;</code>, your environment does not provide an external load balancer for the ingress gateway. You can access the gateway using the service’s <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#configuring-the-node-port-service-range">node port</a>.
					</p><section class="section" id="ossm-routing-config-ig-lb_routing-traffic-v1x"><div class="titlepage"><div><div><h5 class="title">2.7.3.1.1. Determining ingress ports with a load balancer</h5></div></div></div><p>
							Follow these instructions if your environment has an external load balancer.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Run the following command to set the ingress IP and ports. This command sets a variable in your terminal.
								</p><pre class="programlisting language-terminal">$ export INGRESS_HOST=$(oc -n istio-system get service istio-ingressgateway -o jsonpath='{.status.loadBalancer.ingress[0].ip}')</pre></li><li class="listitem"><p class="simpara">
									Run the following command to set the ingress port.
								</p><pre class="programlisting language-terminal">$ export INGRESS_PORT=$(oc -n istio-system get service istio-ingressgateway -o jsonpath='{.spec.ports[?(@.name=="http2")].port}')</pre></li><li class="listitem"><p class="simpara">
									Run the following command to set the secure ingress port.
								</p><pre class="programlisting language-terminal">$ export SECURE_INGRESS_PORT=$(oc -n istio-system get service istio-ingressgateway -o jsonpath='{.spec.ports[?(@.name=="https")].port}')</pre></li><li class="listitem"><p class="simpara">
									Run the following command to set the TCP ingress port.
								</p><pre class="programlisting language-terminal">$ export TCP_INGRESS_PORT=$(kubectl -n istio-system get service istio-ingressgateway -o jsonpath='{.spec.ports[?(@.name=="tcp")].port}')</pre></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								In some environments, the load balancer may be exposed using a hostname instead of an IP address. For that case, the ingress gateway’s <code class="literal">EXTERNAL-IP</code> value is not an IP address. Instead, it’s a hostname, and the previous command fails to set the <code class="literal">INGRESS_HOST</code> environment variable.
							</p><p>
								In that case, use the following command to correct the <code class="literal">INGRESS_HOST</code> value:
							</p></div></div><pre class="programlisting language-terminal">$ export INGRESS_HOST=$(oc -n istio-system get service istio-ingressgateway -o jsonpath='{.status.loadBalancer.ingress[0].hostname}')</pre></section><section class="section" id="ossm-routing-config-ig-no-lb_routing-traffic-v1x"><div class="titlepage"><div><div><h5 class="title">2.7.3.1.2. Determining ingress ports without a load balancer</h5></div></div></div><p>
							If your environment does not have an external load balancer, determine the ingress ports and use a node port instead.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Set the ingress ports.
								</p><pre class="programlisting language-terminal">$ export INGRESS_PORT=$(oc -n istio-system get service istio-ingressgateway -o jsonpath='{.spec.ports[?(@.name=="http2")].nodePort}')</pre></li><li class="listitem"><p class="simpara">
									Run the following command to set the secure ingress port.
								</p><pre class="programlisting language-terminal">$ export SECURE_INGRESS_PORT=$(oc -n istio-system get service istio-ingressgateway -o jsonpath='{.spec.ports[?(@.name=="https")].nodePort}')</pre></li><li class="listitem"><p class="simpara">
									Run the following command to set the TCP ingress port.
								</p><pre class="programlisting language-terminal">$ export TCP_INGRESS_PORT=$(kubectl -n istio-system get service istio-ingressgateway -o jsonpath='{.spec.ports[?(@.name=="tcp")].nodePort}')</pre></li></ol></div></section></section></section><section class="section" id="ossm-auto-route-1x_routing-traffic-v1x"><div class="titlepage"><div><div><h3 class="title">2.7.4. Automatic route creation</h3></div></div></div><p>
					OpenShift routes for Istio Gateways are automatically managed in Red Hat OpenShift Service Mesh. Every time an Istio Gateway is created, updated or deleted inside the service mesh, an OpenShift route is created, updated or deleted.
				</p><section class="section" id="ossm-auto-route-enable_routing-traffic-v1x"><div class="titlepage"><div><div><h4 class="title">2.7.4.1. Enabling Automatic Route Creation</h4></div></div></div><p>
						A Red Hat OpenShift Service Mesh control plane component called Istio OpenShift Routing (IOR) synchronizes the gateway route. Enable IOR as part of the control plane deployment.
					</p><p>
						If the Gateway contains a TLS section, the OpenShift Route will be configured to support TLS.
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								In the <code class="literal">ServiceMeshControlPlane</code> resource, add the <code class="literal">ior_enabled</code> parameter and set it to <code class="literal">true</code>. For example, see the following resource snippet:
							</li></ol></div><pre class="programlisting language-yaml">spec:
  istio:
    gateways:
     istio-egressgateway:
       autoscaleEnabled: false
       autoscaleMin: 1
       autoscaleMax: 5
     istio-ingressgateway:
       autoscaleEnabled: false
       autoscaleMin: 1
       autoscaleMax: 5
       ior_enabled: true</pre></section><section class="section" id="ossm-auto-route-subdomains_routing-traffic-v1x"><div class="titlepage"><div><div><h4 class="title">2.7.4.2. Subdomains</h4></div></div></div><p>
						Red Hat OpenShift Service Mesh creates the route with the subdomain, but OpenShift Container Platform must be configured to enable it. Subdomains, for example <code class="literal">*.domain.com</code>, are supported but not by default. Configure an OpenShift Container Platform wildcard policy before configuring a wildcard host Gateway. For more information, see the "Links" section.
					</p><p>
						If the following gateway is created:
					</p><pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: Gateway
metadata:
  name: gateway1
spec:
  selector:
    istio: ingressgateway
  servers:
  - port:
      number: 80
      name: http
      protocol: HTTP
    hosts:
    - www.bookinfo.com
    - bookinfo.example.com</pre><p>
						Then, the following OpenShift Routes are created automatically. You can check that the routes are created with the following command.
					</p><pre class="programlisting language-terminal">$ oc -n &lt;control_plane_namespace&gt; get routes</pre><div class="formalpara"><p class="title"><strong>Expected output</strong></p><p>
							
<pre class="programlisting language-terminal">NAME           HOST/PORT             PATH  SERVICES               PORT  TERMINATION   WILDCARD
gateway1-lvlfn bookinfo.example.com        istio-ingressgateway   &lt;all&gt;               None
gateway1-scqhv www.bookinfo.com            istio-ingressgateway   &lt;all&gt;               None</pre>

						</p></div><p>
						If the gateway is deleted, Red Hat OpenShift Service Mesh deletes the routes. However, routes created manually are never modified by Red Hat OpenShift Service Mesh.
					</p></section></section><section class="section" id="ossm-routing-service-entries_routing-traffic-v1x"><div class="titlepage"><div><div><h3 class="title">2.7.5. Understanding service entries</h3></div></div></div><p>
					A service entry adds an entry to the service registry that Red Hat OpenShift Service Mesh maintains internally. After you add the service entry, the Envoy proxies send traffic to the service as if it is a service in your mesh. Service entries allow you to do the following:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Manage traffic for services that run outside of the service mesh.
						</li><li class="listitem">
							Redirect and forward traffic for external destinations (such as, APIs consumed from the web) or traffic to services in legacy infrastructure.
						</li><li class="listitem">
							Define retry, timeout, and fault injection policies for external destinations.
						</li><li class="listitem">
							Run a mesh service in a Virtual Machine (VM) by adding VMs to your mesh.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Add services from a different cluster to the mesh to configure a multicluster Red Hat OpenShift Service Mesh mesh on Kubernetes.
					</p></div></div><div class="formalpara"><p class="title"><strong>Service entry examples</strong></p><p>
						The following example is a mesh-external service entry that adds the <code class="literal">ext-resource</code> external dependency to the Red Hat OpenShift Service Mesh service registry:
					</p></div><pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: ServiceEntry
metadata:
  name: svc-entry
spec:
  hosts:
  - ext-svc.example.com
  ports:
  - number: 443
    name: https
    protocol: HTTPS
  location: MESH_EXTERNAL
  resolution: DNS</pre><p>
					Specify the external resource using the <code class="literal">hosts</code> field. You can qualify it fully or use a wildcard prefixed domain name.
				</p><p>
					You can configure virtual services and destination rules to control traffic to a service entry in the same way you configure traffic for any other service in the mesh. For example, the following destination rule configures the traffic route to use mutual TLS to secure the connection to the <code class="literal">ext-svc.example.com</code> external service that is configured using the service entry:
				</p><pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: DestinationRule
metadata:
  name: ext-res-dr
spec:
  host: ext-svc.example.com
  trafficPolicy:
    tls:
      mode: MUTUAL
      clientCertificate: /etc/certs/myclientcert.pem
      privateKey: /etc/certs/client_private_key.pem
      caCertificates: /etc/certs/rootcacerts.pem</pre></section><section class="section" id="ossm-routing-virtual-services_routing-traffic-v1x"><div class="titlepage"><div><div><h3 class="title">2.7.6. Using VirtualServices</h3></div></div></div><p>
					You can route requests dynamically to multiple versions of a microservice through Red Hat OpenShift Service Mesh with a virtual service. With virtual services, you can:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Address multiple application services through a single virtual service. If your mesh uses Kubernetes, for example, you can configure a virtual service to handle all services in a specific namespace. A virtual service enables you to turn a monolithic application into a service consisting of distinct microservices with a seamless consumer experience.
						</li><li class="listitem">
							Configure traffic rules in combination with gateways to control ingress and egress traffic.
						</li></ul></div><section class="section" id="ossm-routing-vs_routing-traffic-v1x"><div class="titlepage"><div><div><h4 class="title">2.7.6.1. Configuring VirtualServices</h4></div></div></div><p>
						Requests are routed to services within a service mesh with virtual services. Each virtual service consists of a set of routing rules that are evaluated in order. Red Hat OpenShift Service Mesh matches each given request to the virtual service to a specific real destination within the mesh.
					</p><p>
						Without virtual services, Red Hat OpenShift Service Mesh distributes traffic using least requests load balancing between all service instances. With a virtual service, you can specify traffic behavior for one or more hostnames. Routing rules in the virtual service tell Red Hat OpenShift Service Mesh how to send the traffic for the virtual service to appropriate destinations. Route destinations can be versions of the same service or entirely different services.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a YAML file using the following example to route requests to different versions of the Bookinfo sample application service depending on which user connects to the application.
							</p><div class="formalpara"><p class="title"><strong>Example VirtualService.yaml</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: reviews
spec:
  hosts:
  - reviews
  http:
  - match:
    - headers:
        end-user:
          exact: jason
    route:
    - destination:
        host: reviews
        subset: v2
  - route:
    - destination:
        host: reviews
        subset: v3</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Run the following command to apply <code class="literal">VirtualService.yaml</code>, where <code class="literal">VirtualService.yaml</code> is the path to the file.
							</p><pre class="programlisting language-terminal">$ oc apply -f &lt;VirtualService.yaml&gt;</pre></li></ol></div></section><section class="section" id="virtualservice-configuration-reference-2"><div class="titlepage"><div><div><h4 class="title">2.7.6.2. VirtualService configuration reference</h4></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663651426624" scope="col">Parameter</th><th align="left" valign="top" id="idm140663651425536" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663651426624">
<pre class="literallayout">spec:
  hosts:</pre>
									 </td><td align="left" valign="top" headers="idm140663651425536"> <p>
										The <code class="literal">hosts</code> field lists the virtual service’s destination address to which the routing rules apply. This is the address(es) that are used to send requests to the service. The virtual service hostname can be an IP address, a DNS name, or a short name that resolves to a fully qualified domain name.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663651426624">
<pre class="literallayout">spec:
  http:
  - match:</pre>
									 </td><td align="left" valign="top" headers="idm140663651425536"> <p>
										The <code class="literal">http</code> section contains the virtual service’s routing rules which describe match conditions and actions for routing HTTP/1.1, HTTP2, and gRPC traffic sent to the destination as specified in the hosts field. A routing rule consists of the destination where you want the traffic to go and any specified match conditions. The first routing rule in the example has a condition that begins with the match field. In this example, this routing applies to all requests from the user <code class="literal">jason</code>. Add the <code class="literal">headers</code>, <code class="literal">end-user</code>, and <code class="literal">exact</code> fields to select the appropriate requests.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663651426624">
<pre class="literallayout">spec:
  http:
  - match:
    - destination:</pre>
									 </td><td align="left" valign="top" headers="idm140663651425536"> <p>
										The <code class="literal">destination</code> field in the route section specifies the actual destination for traffic that matches this condition. Unlike the virtual service’s host, the destination’s host must be a real destination that exists in the Red Hat OpenShift Service Mesh service registry. This can be a mesh service with proxies or a non-mesh service added using a service entry. In this example, the hostname is a Kubernetes service name:
									</p>
									 </td></tr></tbody></table></div></section></section><section class="section" id="ossm-routing-destination-rules_routing-traffic-v1x"><div class="titlepage"><div><div><h3 class="title">2.7.7. Understanding destination rules</h3></div></div></div><p>
					Destination rules are applied after virtual service routing rules are evaluated, so they apply to the traffic’s real destination. Virtual services route traffic to a destination. Destination rules configure what happens to traffic at that destination.
				</p><p>
					By default, Red Hat OpenShift Service Mesh uses a least requests load balancing policy, where the service instance in the pool with the least number of active connections receives the request. Red Hat OpenShift Service Mesh also supports the following models, which you can specify in destination rules for requests to a particular service or service subset.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Random: Requests are forwarded at random to instances in the pool.
						</li><li class="listitem">
							Weighted: Requests are forwarded to instances in the pool according to a specific percentage.
						</li><li class="listitem">
							Least requests: Requests are forwarded to instances with the least number of requests.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Destination rule example</strong></p><p>
						The following example destination rule configures three different subsets for the <code class="literal">my-svc</code> destination service, with different load balancing policies:
					</p></div><pre class="programlisting language-yaml">apiVersion: networking.istio.io/v1alpha3
kind: DestinationRule
metadata:
  name: my-destination-rule
spec:
  host: my-svc
  trafficPolicy:
    loadBalancer:
      simple: RANDOM
  subsets:
  - name: v1
    labels:
      version: v1
  - name: v2
    labels:
      version: v2
    trafficPolicy:
      loadBalancer:
        simple: ROUND_ROBIN
  - name: v3
    labels:
      version: v3</pre><p>
					This guide references the Bookinfo sample application to provide examples of routing in an example application. Install the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-tutorial-bookinfo-overview_deploying-applications-ossm-v1x">Bookinfo application</a> to learn how these routing examples work.
				</p></section><section class="section" id="ossm-routing-bookinfo_routing-traffic-v1x"><div class="titlepage"><div><div><h3 class="title">2.7.8. Bookinfo routing tutorial</h3></div></div></div><p>
					The Service Mesh Bookinfo sample application consists of four separate microservices, each with multiple versions. After installing the Bookinfo sample application, three different versions of the <code class="literal">reviews</code> microservice run concurrently.
				</p><p>
					When you access the Bookinfo app <code class="literal">/product</code> page in a browser and refresh several times, sometimes the book review output contains star ratings and other times it does not. Without an explicit default service version to route to, Service Mesh routes requests to all available versions one after the other.
				</p><p>
					This tutorial helps you apply rules that route all traffic to <code class="literal">v1</code> (version 1) of the microservices. Later, you can apply a rule to route traffic based on the value of an HTTP request header.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites:</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Deploy the Bookinfo sample application to work with the following examples.
						</li></ul></div><section class="section" id="ossm-routing-bookinfo-applying_routing-traffic-v1x"><div class="titlepage"><div><div><h4 class="title">2.7.8.1. Applying a virtual service</h4></div></div></div><p>
						In the following procedure, the virtual service routes all traffic to <code class="literal">v1</code> of each micro-service by applying virtual services that set the default version for the micro-services.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Apply the virtual services.
							</p><pre class="programlisting language-bash">$ oc apply -f https://raw.githubusercontent.com/Maistra/istio/maistra-2.4/samples/bookinfo/networking/virtual-service-all-v1.yaml</pre></li><li class="listitem"><p class="simpara">
								To verify that you applied the virtual services, display the defined routes with the following command:
							</p><pre class="programlisting language-terminal">$ oc get virtualservices -o yaml</pre><p class="simpara">
								That command returns a resource of <code class="literal">kind: VirtualService</code> in YAML format.
							</p></li></ol></div><p>
						You have configured Service Mesh to route to the <code class="literal">v1</code> version of the Bookinfo microservices including the <code class="literal">reviews</code> service version 1.
					</p></section><section class="section" id="ossm-routing-bookinfo-test_routing-traffic-v1x"><div class="titlepage"><div><div><h4 class="title">2.7.8.2. Testing the new route configuration</h4></div></div></div><p>
						Test the new configuration by refreshing the <code class="literal">/productpage</code> of the Bookinfo application.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Set the value for the <code class="literal">GATEWAY_URL</code> parameter. You can use this variable to find the URL for your Bookinfo product page later. In this example, istio-system is the name of the control plane project.
							</p><pre class="programlisting language-terminal">export GATEWAY_URL=$(oc -n istio-system get route istio-ingressgateway -o jsonpath='{.spec.host}')</pre></li><li class="listitem"><p class="simpara">
								Run the following command to retrieve the URL for the product page.
							</p><pre class="programlisting language-terminal">echo "http://$GATEWAY_URL/productpage"</pre></li><li class="listitem">
								Open the Bookinfo site in your browser.
							</li></ol></div><p>
						The reviews part of the page displays with no rating stars, no matter how many times you refresh. This is because you configured Service Mesh to route all traffic for the reviews service to the version <code class="literal">reviews:v1</code> and this version of the service does not access the star ratings service.
					</p><p>
						Your service mesh now routes traffic to one version of a service.
					</p></section><section class="section" id="ossm-routing-bookinfo-route_routing-traffic-v1x"><div class="titlepage"><div><div><h4 class="title">2.7.8.3. Route based on user identity</h4></div></div></div><p>
						Change the route configuration so that all traffic from a specific user is routed to a specific service version. In this case, all traffic from a user named <code class="literal">jason</code> will be routed to the service <code class="literal">reviews:v2</code>.
					</p><p>
						Service Mesh does not have any special, built-in understanding of user identity. This example is enabled by the fact that the <code class="literal">productpage</code> service adds a custom <code class="literal">end-user</code> header to all outbound HTTP requests to the reviews service.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Run the following command to enable user-based routing in the Bookinfo sample application.
							</p><pre class="programlisting language-bash">$ oc apply -f https://raw.githubusercontent.com/Maistra/istio/maistra-2.4/samples/bookinfo/networking/virtual-service-reviews-test-v2.yaml</pre></li><li class="listitem"><p class="simpara">
								Run the following command to confirm the rule is created. This command returns all resources of <code class="literal">kind: VirtualService</code> in YAML format.
							</p><pre class="programlisting language-terminal">$ oc get virtualservice reviews -o yaml</pre></li><li class="listitem">
								On the <code class="literal">/productpage</code> of the Bookinfo app, log in as user <code class="literal">jason</code> with no password.
							</li><li class="listitem">
								Refresh the browser. The star ratings appear next to each review.
							</li><li class="listitem">
								Log in as another user (pick any name you want). Refresh the browser. Now the stars are gone. Traffic is now routed to <code class="literal">reviews:v1</code> for all users except Jason.
							</li></ol></div><p>
						You have successfully configured the Bookinfo sample application to route traffic based on user identity.
					</p></section></section><section class="section _additional-resources-traffic-management" id="additional-resources-2"><div class="titlepage"><div><div><h3 class="title">2.7.9. Additional resources</h3></div></div></div><p>
					For more information about configuring an OpenShift Container Platform wildcard policy, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#using-wildcard-routes_configuring-ingress">Using wildcard routes</a>.
				</p></section></section><section class="section" id="deploying-applications-ossm-v1x"><div class="titlepage"><div><div><h2 class="title">2.8. Deploying applications on Service Mesh</h2></div></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					<span class="strong strong"><strong>You are viewing documentation for a Red Hat OpenShift Service Mesh release that is no longer supported.</strong></span>
				</p><p>
					Service Mesh version 1.0 and 1.1 control planes are no longer supported. For information about upgrading your service mesh control plane, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-versions_ossm-upgrade">Upgrading Service Mesh</a>.
				</p><p>
					For information about the support status of a particular Red Hat OpenShift Service Mesh release, see the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ossm">Product lifecycle page</a>.
				</p></div></div><p>
				When you deploy an application into the Service Mesh, there are several differences between the behavior of applications in the upstream community version of Istio and the behavior of applications within a Red Hat OpenShift Service Mesh installation.
			</p><section class="section" id="prerequisites-6"><div class="titlepage"><div><div><h3 class="title">2.8.1. Prerequisites</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Review <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-vs-community-v1x">Comparing Red Hat OpenShift Service Mesh and upstream Istio community installations</a>
						</li><li class="listitem">
							Review <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#installing-ossm-v1x">Installing Red Hat OpenShift Service Mesh</a>
						</li></ul></div></section><section class="section" id="ossm-control-plane-templates-1x_deploying-applications-ossm-v1x"><div class="titlepage"><div><div><h3 class="title">2.8.2. Creating control plane templates</h3></div></div></div><p>
					You can create reusable configurations with <code class="literal">ServiceMeshControlPlane</code> templates. Individual users can extend the templates they create with their own configurations. Templates can also inherit configuration information from other templates. For example, you can create an accounting control plane for the accounting team and a marketing control plane for the marketing team. If you create a development template and a production template, members of the marketing team and the accounting team can extend the development and production templates with team specific customization.
				</p><p>
					When you configure control plane templates, which follow the same syntax as the <code class="literal">ServiceMeshControlPlane</code>, users inherit settings in a hierarchical fashion. The Operator is delivered with a <code class="literal">default</code> template with default settings for Red Hat OpenShift Service Mesh. To add custom templates you must create a ConfigMap named <code class="literal">smcp-templates</code> in the <code class="literal">openshift-operators</code> project and mount the ConfigMap in the Operator container at <code class="literal">/usr/local/share/istio-operator/templates</code>.
				</p><section class="section" id="ossm-create-configmap_deploying-applications-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.8.2.1. Creating the ConfigMap</h4></div></div></div><p>
						Follow this procedure to create the ConfigMap.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								An installed, verified Service Mesh Operator.
							</li><li class="listitem">
								An account with the <code class="literal">cluster-admin</code> role.
							</li><li class="listitem">
								Location of the Operator deployment.
							</li><li class="listitem">
								Access to the OpenShift CLI (<code class="literal">oc</code>).
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform CLI as a cluster administrator.
							</li><li class="listitem"><p class="simpara">
								From the CLI, run this command to create the ConfigMap named <code class="literal">smcp-templates</code> in the <code class="literal">openshift-operators</code> project and replace <code class="literal">&lt;templates-directory&gt;</code> with the location of the <code class="literal">ServiceMeshControlPlane</code> files on your local disk:
							</p><pre class="programlisting language-terminal">$ oc create configmap --from-file=&lt;templates-directory&gt; smcp-templates -n openshift-operators</pre></li><li class="listitem"><p class="simpara">
								Locate the Operator ClusterServiceVersion name.
							</p><pre class="programlisting language-terminal">$ oc get clusterserviceversion -n openshift-operators | grep 'Service Mesh'</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">maistra.v1.0.0            Red Hat OpenShift Service Mesh   1.0.0                Succeeded</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Edit the Operator cluster service version to instruct the Operator to use the <code class="literal">smcp-templates</code> ConfigMap.
							</p><pre class="programlisting language-terminal">$ oc edit clusterserviceversion -n openshift-operators maistra.v1.0.0</pre></li><li class="listitem"><p class="simpara">
								Add a volume mount and volume to the Operator deployment.
							</p><pre class="programlisting language-yaml">deployments:
  - name: istio-operator
    spec:
      template:
        spec:
          containers:
            volumeMounts:
              - name: discovery-cache
                mountPath: /home/istio-operator/.kube/cache/discovery
              - name: smcp-templates
                mountPath: /usr/local/share/istio-operator/templates/
          volumes:
            - name: discovery-cache
              emptyDir:
                medium: Memory
            - name: smcp-templates
              configMap:
                name: smcp-templates
...</pre></li><li class="listitem">
								Save your changes and exit the editor.
							</li><li class="listitem"><p class="simpara">
								You can now use the <code class="literal">template</code> parameter in the <code class="literal">ServiceMeshControlPlane</code> to specify a template.
							</p><pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshControlPlane
metadata:
  name: minimal-install
spec:
  template: default</pre></li></ol></div></section></section><section class="section" id="ossm-automatic-sidecar-injection_deploying-applications-ossm-v1x"><div class="titlepage"><div><div><h3 class="title">2.8.3. Enabling automatic sidecar injection</h3></div></div></div><p>
					When deploying an application, you must opt-in to injection by configuring the annotation <code class="literal">sidecar.istio.io/inject</code> in <code class="literal">spec.template.metadata.annotations</code> to <code class="literal">true</code> in the <code class="literal">deployment</code> object. Opting in ensures that the sidecar injection does not interfere with other OpenShift Container Platform features such as builder pods used by numerous frameworks within the OpenShift Container Platform ecosystem.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Identify the namespaces that are part of your service mesh and the deployments that need automatic sidecar injection.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To find your deployments use the <code class="literal">oc get</code> command.
						</p><pre class="programlisting language-terminal">$ oc get deployment -n &lt;namespace&gt;</pre><p class="simpara">
							For example, to view the deployment file for the 'ratings-v1' microservice in the <code class="literal">bookinfo</code> namespace, use the following command to see the resource in YAML format.
						</p><pre class="programlisting language-terminal">oc get deployment -n bookinfo ratings-v1 -o yaml</pre></li><li class="listitem">
							Open the application’s deployment configuration YAML file in an editor.
						</li><li class="listitem"><p class="simpara">
							Add <code class="literal">spec.template.metadata.annotations.sidecar.istio/inject</code> to your Deployment YAML and set <code class="literal">sidecar.istio.io/inject</code> to <code class="literal">true</code> as shown in the following example.
						</p><div class="formalpara"><p class="title"><strong>Example snippet from bookinfo deployment-ratings-v1.yaml</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: ratings-v1
  namespace: bookinfo
  labels:
    app: ratings
    version: v1
spec:
  template:
    metadata:
      annotations:
        sidecar.istio.io/inject: 'true'</pre>

							</p></div></li><li class="listitem">
							Save the Deployment configuration file.
						</li><li class="listitem"><p class="simpara">
							Add the file back to the project that contains your app.
						</p><pre class="programlisting language-terminal">$ oc apply -n &lt;namespace&gt; -f deployment.yaml</pre><p class="simpara">
							In this example, <code class="literal">bookinfo</code> is the name of the project that contains the <code class="literal">ratings-v1</code> app and <code class="literal">deployment-ratings-v1.yaml</code> is the file you edited.
						</p><pre class="programlisting language-terminal">$ oc apply -n bookinfo -f deployment-ratings-v1.yaml</pre></li><li class="listitem"><p class="simpara">
							To verify that the resource uploaded successfully, run the following command.
						</p><pre class="programlisting language-terminal">$ oc get deployment -n &lt;namespace&gt; &lt;deploymentName&gt; -o yaml</pre><p class="simpara">
							For example,
						</p><pre class="programlisting language-terminal">$ oc get deployment -n bookinfo ratings-v1 -o yaml</pre></li></ol></div></section><section class="section" id="ossm-sidecar-injection-env-var_deploying-applications-ossm-v1x"><div class="titlepage"><div><div><h3 class="title">2.8.4. Setting proxy environment variables through annotations</h3></div></div></div><p>
					Configuration for the Envoy sidecar proxies is managed by the <code class="literal">ServiceMeshControlPlane</code>.
				</p><p>
					You can set environment variables for the sidecar proxy for applications by adding pod annotations to the deployment in the <code class="literal">injection-template.yaml</code> file. The environment variables are injected to the sidecar.
				</p><div class="formalpara"><p class="title"><strong>Example injection-template.yaml</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: resource
spec:
  replicas: 7
  selector:
    matchLabels:
      app: resource
  template:
    metadata:
      annotations:
        sidecar.maistra.io/proxyEnv: "{ \"maistra_test_env\": \"env_value\", \"maistra_test_env_2\": \"env_value_2\" }"</pre>

					</p></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						You should never include <code class="literal">maistra.io/</code> labels and annotations when creating your own custom resources. These labels and annotations indicate that the resources are generated and managed by the Operator. If you are copying content from an Operator-generated resource when creating your own resources, do not include labels or annotations that start with <code class="literal">maistra.io/</code>. Resources that include these labels or annotations will be overwritten or deleted by the Operator during the next reconciliation.
					</p></div></div></section><section class="section" id="ossm-mixer-policy-1x_deploying-applications-ossm-v1x"><div class="titlepage"><div><div><h3 class="title">2.8.5. Updating Mixer policy enforcement</h3></div></div></div><p>
					In previous versions of Red Hat OpenShift Service Mesh, Mixer’s policy enforcement was enabled by default. Mixer policy enforcement is now disabled by default. You must enable it before running policy tasks.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Access to the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The examples use <code class="literal">&lt;istio-system&gt;</code> as the control plane namespace. Replace this value with the namespace where you deployed the Service Mesh Control Plane (SMCP).
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the OpenShift Container Platform CLI.
						</li><li class="listitem"><p class="simpara">
							Run this command to check the current Mixer policy enforcement status:
						</p><pre class="programlisting language-terminal">$ oc get cm -n &lt;istio-system&gt; istio -o jsonpath='{.data.mesh}' | grep disablePolicyChecks</pre></li><li class="listitem"><p class="simpara">
							If <code class="literal">disablePolicyChecks: true</code>, edit the Service Mesh ConfigMap:
						</p><pre class="programlisting language-terminal">$ oc edit cm -n &lt;istio-system&gt; istio</pre></li><li class="listitem">
							Locate <code class="literal">disablePolicyChecks: true</code> within the ConfigMap and change the value to <code class="literal">false</code>.
						</li><li class="listitem">
							Save the configuration and exit the editor.
						</li><li class="listitem">
							Re-check the Mixer policy enforcement status to ensure it is set to <code class="literal">false</code>.
						</li></ol></div><section class="section" id="ossm-config-network-policy_deploying-applications-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.8.5.1. Setting the correct network policy</h4></div></div></div><p>
						Service Mesh creates network policies in the Service Mesh control plane and member namespaces to allow traffic between them. Before you deploy, consider the following conditions to ensure the services in your service mesh that were previously exposed through an OpenShift Container Platform route.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Traffic into the service mesh must always go through the ingress-gateway for Istio to work properly.
							</li><li class="listitem">
								Deploy services external to the service mesh in separate namespaces that are not in any service mesh.
							</li><li class="listitem">
								Non-mesh services that need to be deployed within a service mesh enlisted namespace should label their deployments <code class="literal">maistra.io/expose-route: "true"</code>, which ensures OpenShift Container Platform routes to these services still work.
							</li></ul></div></section></section><section class="section" id="ossm-tutorial-bookinfo-overview_deploying-applications-ossm-v1x"><div class="titlepage"><div><div><h3 class="title">2.8.6. Bookinfo example application</h3></div></div></div><p>
					The Bookinfo example application allows you to test your Red Hat OpenShift Service Mesh 2.4.3 installation on OpenShift Container Platform.
				</p><p>
					The Bookinfo application displays information about a book, similar to a single catalog entry of an online book store. The application displays a page that describes the book, book details (ISBN, number of pages, and other information), and book reviews.
				</p><p>
					The Bookinfo application consists of these microservices:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">productpage</code> microservice calls the <code class="literal">details</code> and <code class="literal">reviews</code> microservices to populate the page.
						</li><li class="listitem">
							The <code class="literal">details</code> microservice contains book information.
						</li><li class="listitem">
							The <code class="literal">reviews</code> microservice contains book reviews. It also calls the <code class="literal">ratings</code> microservice.
						</li><li class="listitem">
							The <code class="literal">ratings</code> microservice contains book ranking information that accompanies a book review.
						</li></ul></div><p>
					There are three versions of the reviews microservice:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Version v1 does not call the <code class="literal">ratings</code> Service.
						</li><li class="listitem">
							Version v2 calls the <code class="literal">ratings</code> Service and displays each rating as one to five black stars.
						</li><li class="listitem">
							Version v3 calls the <code class="literal">ratings</code> Service and displays each rating as one to five red stars.
						</li></ul></div><section class="section" id="ossm-tutorial-bookinfo-install_deploying-applications-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.8.6.1. Installing the Bookinfo application</h4></div></div></div><p>
						This tutorial walks you through how to create a sample application by creating a project, deploying the Bookinfo application to that project, and viewing the running application in Service Mesh.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites:</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								OpenShift Container Platform 4.1 or higher installed.
							</li><li class="listitem">
								Red Hat OpenShift Service Mesh 2.4.3 installed.
							</li><li class="listitem">
								Access to the OpenShift CLI (<code class="literal">oc</code>).
							</li><li class="listitem">
								An account with the <code class="literal">cluster-admin</code> role.
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The Bookinfo sample application cannot be installed on IBM Z and IBM Power.
						</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The commands in this section assume the Service Mesh control plane project is <code class="literal">istio-system</code>. If you installed the control plane in another namespace, edit each command before you run it.
						</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console as a user with cluster-admin rights. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Home</strong></span> → <span class="strong strong"><strong>Projects</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Create Project</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Enter <code class="literal">bookinfo</code> as the <span class="strong strong"><strong>Project Name</strong></span>, enter a <span class="strong strong"><strong>Display Name</strong></span>, and enter a <span class="strong strong"><strong>Description</strong></span>, then click <span class="strong strong"><strong>Create</strong></span>.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Alternatively, you can run this command from the CLI to create the <code class="literal">bookinfo</code> project.
									</p><pre class="programlisting language-terminal">$ oc new-project bookinfo</pre></li></ul></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Project</strong></span> menu and use the Service Mesh control plane namespace. In this example, use <code class="literal">istio-system</code>.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Red Hat OpenShift Service Mesh</strong></span> Operator.
							</li><li class="listitem"><p class="simpara">
								Click the <span class="strong strong"><strong>Istio Service Mesh Member Roll</strong></span> tab.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										If you have already created a Istio Service Mesh Member Roll, click the name, then click the YAML tab to open the YAML editor.
									</li><li class="listitem">
										If you have not created a <code class="literal">ServiceMeshMemberRoll</code>, click <span class="strong strong"><strong>Create ServiceMeshMemberRoll</strong></span>.
									</li></ol></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Members</strong></span>, then enter the name of your project in the <span class="strong strong"><strong>Value</strong></span> field.
							</li><li class="listitem"><p class="simpara">
								Click <span class="strong strong"><strong>Create</strong></span> to save the updated Service Mesh Member Roll.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Or, save the following example to a YAML file.
									</p><div class="formalpara"><p class="title"><strong>Bookinfo ServiceMeshMemberRoll example servicemeshmemberroll-default.yaml</strong></p><p>
											
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshMemberRoll
metadata:
  name: default
spec:
  members:
  - bookinfo</pre>

										</p></div></li><li class="listitem"><p class="simpara">
										Run the following command to upload that file and create the <code class="literal">ServiceMeshMemberRoll</code> resource in the <code class="literal">istio-system</code> namespace. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
									</p><pre class="programlisting language-terminal">$ oc create -n istio-system -f servicemeshmemberroll-default.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								Run the following command to verify the <code class="literal">ServiceMeshMemberRoll</code> was created successfully.
							</p><pre class="programlisting language-terminal">$ oc get smmr -n istio-system -o wide</pre><p class="simpara">
								The installation has finished successfully when the <code class="literal">STATUS</code> column is <code class="literal">Configured</code>.
							</p><pre class="programlisting language-terminal">NAME      READY   STATUS       AGE   MEMBERS
default   1/1     Configured   70s   ["bookinfo"]</pre></li><li class="listitem"><p class="simpara">
								From the CLI, deploy the Bookinfo application in the <span class="emphasis"><em>`bookinfo`</em></span> project by applying the <code class="literal">bookinfo.yaml</code> file:
							</p><pre class="programlisting language-bash">$ oc apply -n bookinfo -f https://raw.githubusercontent.com/Maistra/istio/maistra-2.4/samples/bookinfo/platform/kube/bookinfo.yaml</pre><p class="simpara">
								You should see output similar to the following:
							</p><pre class="programlisting language-terminal">service/details created
serviceaccount/bookinfo-details created
deployment.apps/details-v1 created
service/ratings created
serviceaccount/bookinfo-ratings created
deployment.apps/ratings-v1 created
service/reviews created
serviceaccount/bookinfo-reviews created
deployment.apps/reviews-v1 created
deployment.apps/reviews-v2 created
deployment.apps/reviews-v3 created
service/productpage created
serviceaccount/bookinfo-productpage created
deployment.apps/productpage-v1 created</pre></li><li class="listitem"><p class="simpara">
								Create the ingress gateway by applying the <code class="literal">bookinfo-gateway.yaml</code> file:
							</p><pre class="programlisting language-bash">$ oc apply -n bookinfo -f https://raw.githubusercontent.com/Maistra/istio/maistra-2.4/samples/bookinfo/networking/bookinfo-gateway.yaml</pre><p class="simpara">
								You should see output similar to the following:
							</p><pre class="programlisting language-terminal">gateway.networking.istio.io/bookinfo-gateway created
virtualservice.networking.istio.io/bookinfo created</pre></li><li class="listitem"><p class="simpara">
								Set the value for the <code class="literal">GATEWAY_URL</code> parameter:
							</p><pre class="programlisting language-terminal">$ export GATEWAY_URL=$(oc -n istio-system get route istio-ingressgateway -o jsonpath='{.spec.host}')</pre></li></ol></div></section><section class="section" id="ossm-tutorial-bookinfo-adding-destination-rules_deploying-applications-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.8.6.2. Adding default destination rules</h4></div></div></div><p>
						Before you can use the Bookinfo application, you must first add default destination rules. There are two preconfigured YAML files, depending on whether or not you enabled mutual transport layer security (TLS) authentication.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To add destination rules, run one of the following commands:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										If you did not enable mutual TLS:
									</p><pre class="programlisting language-bash">$ oc apply -n bookinfo -f https://raw.githubusercontent.com/Maistra/istio/maistra-2.4/samples/bookinfo/networking/destination-rule-all.yaml</pre></li><li class="listitem"><p class="simpara">
										If you enabled mutual TLS:
									</p><pre class="programlisting language-bash">$ oc apply -n bookinfo -f https://raw.githubusercontent.com/Maistra/istio/maistra-2.4/samples/bookinfo/networking/destination-rule-all-mtls.yaml</pre><p class="simpara">
										You should see output similar to the following:
									</p><pre class="programlisting language-terminal">destinationrule.networking.istio.io/productpage created
destinationrule.networking.istio.io/reviews created
destinationrule.networking.istio.io/ratings created
destinationrule.networking.istio.io/details created</pre></li></ul></div></li></ol></div></section><section class="section" id="ossm-tutorial-bookinfo-verify-install_deploying-applications-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.8.6.3. Verifying the Bookinfo installation</h4></div></div></div><p>
						To confirm that the sample Bookinfo application was successfully deployed, perform the following steps.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Red Hat OpenShift Service Mesh installed.
							</li><li class="listitem">
								Complete the steps for installing the Bookinfo sample app.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure from CLI</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform CLI.
							</li><li class="listitem"><p class="simpara">
								Verify that all pods are ready with this command:
							</p><pre class="programlisting language-terminal">$ oc get pods -n bookinfo</pre><p class="simpara">
								All pods should have a status of <code class="literal">Running</code>. You should see output similar to the following:
							</p><pre class="programlisting language-terminal">NAME                              READY   STATUS    RESTARTS   AGE
details-v1-55b869668-jh7hb        2/2     Running   0          12m
productpage-v1-6fc77ff794-nsl8r   2/2     Running   0          12m
ratings-v1-7d7d8d8b56-55scn       2/2     Running   0          12m
reviews-v1-868597db96-bdxgq       2/2     Running   0          12m
reviews-v2-5b64f47978-cvssp       2/2     Running   0          12m
reviews-v3-6dfd49b55b-vcwpf       2/2     Running   0          12m</pre></li><li class="listitem"><p class="simpara">
								Run the following command to retrieve the URL for the product page:
							</p><pre class="programlisting language-terminal">echo "http://$GATEWAY_URL/productpage"</pre></li><li class="listitem">
								Copy and paste the output in a web browser to verify the Bookinfo product page is deployed.
							</li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure from Kiali web console</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Obtain the address for the Kiali web console.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Log in to the OpenShift Container Platform web console as a user with <code class="literal">cluster-admin</code> rights. If you use Red Hat OpenShift Dedicated, you must have an account with the <code class="literal">dedicated-admin</code> role.
									</li><li class="listitem">
										Navigate to <span class="strong strong"><strong>Networking</strong></span> → <span class="strong strong"><strong>Routes</strong></span>.
									</li><li class="listitem"><p class="simpara">
										On the <span class="strong strong"><strong>Routes</strong></span> page, select the Service Mesh control plane project, for example <code class="literal">istio-system</code>, from the <span class="strong strong"><strong>Namespace</strong></span> menu.
									</p><p class="simpara">
										The <span class="strong strong"><strong>Location</strong></span> column displays the linked address for each route.
									</p></li><li class="listitem">
										Click the link in the <span class="strong strong"><strong>Location</strong></span> column for Kiali.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Log In With OpenShift</strong></span>. The Kiali <span class="strong strong"><strong>Overview</strong></span> screen presents tiles for each project namespace.
									</li></ol></div></li><li class="listitem">
								In Kiali, click <span class="strong strong"><strong>Graph</strong></span>.
							</li><li class="listitem">
								Select bookinfo from the <span class="strong strong"><strong>Namespace</strong></span> list, and App graph from the <span class="strong strong"><strong>Graph Type</strong></span> list.
							</li><li class="listitem"><p class="simpara">
								Click <span class="strong strong"><strong>Display idle nodes</strong></span> from the <span class="strong strong"><strong>Display</strong></span> menu.
							</p><p class="simpara">
								This displays nodes that are defined but have not received or sent requests. It can confirm that an application is properly defined, but that no request traffic has been reported.
							</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/3b5cf079c8338b3554382168075fffb3/ossm-kiali-graph-bookinfo.png" alt="Kiali displaying bookinfo application"/></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Use the <span class="strong strong"><strong>Duration</strong></span> menu to increase the time period to help ensure older traffic is captured.
									</li><li class="listitem">
										Use the <span class="strong strong"><strong>Refresh Rate</strong></span> menu to refresh traffic more or less often, or not at all.
									</li></ul></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Services</strong></span>, <span class="strong strong"><strong>Workloads</strong></span> or <span class="strong strong"><strong>Istio Config</strong></span> to see list views of bookinfo components, and confirm that they are healthy.
							</li></ol></div></section><section class="section" id="ossm-tutorial-bookinfo-removing_deploying-applications-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.8.6.4. Removing the Bookinfo application</h4></div></div></div><p>
						Follow these steps to remove the Bookinfo application.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								OpenShift Container Platform 4.1 or higher installed.
							</li><li class="listitem">
								Red Hat OpenShift Service Mesh 2.4.3 installed.
							</li><li class="listitem">
								Access to the OpenShift CLI (<code class="literal">oc</code>).
							</li></ul></div><section class="section" id="ossm-delete-bookinfo-project_deploying-applications-ossm-v1x"><div class="titlepage"><div><div><h5 class="title">2.8.6.4.1. Delete the Bookinfo project</h5></div></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									Log in to the OpenShift Container Platform web console.
								</li><li class="listitem">
									Click to <span class="strong strong"><strong>Home</strong></span> → <span class="strong strong"><strong>Projects</strong></span>.
								</li><li class="listitem">
									Click the <code class="literal">bookinfo</code> menu 
									<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
									 , and then click <span class="strong strong"><strong>Delete Project</strong></span>.
								</li><li class="listitem"><p class="simpara">
									Type <code class="literal">bookinfo</code> in the confirmation dialog box, and then click <span class="strong strong"><strong>Delete</strong></span>.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
											Alternatively, you can run this command using the CLI to create the <code class="literal">bookinfo</code> project.
										</p><pre class="programlisting language-terminal">$ oc delete project bookinfo</pre></li></ul></div></li></ol></div></section><section class="section" id="ossm-remove-bookinfo-smmr_deploying-applications-ossm-v1x"><div class="titlepage"><div><div><h5 class="title">2.8.6.4.2. Remove the Bookinfo project from the Service Mesh member roll</h5></div></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									Log in to the OpenShift Container Platform web console.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
								</li><li class="listitem">
									Click the <span class="strong strong"><strong>Project</strong></span> menu and choose <code class="literal">istio-system</code> from the list.
								</li><li class="listitem">
									Click the <span class="strong strong"><strong>Istio Service Mesh Member Roll</strong></span> link under <span class="strong strong"><strong>Provided APIS</strong></span> for the <span class="strong strong"><strong>Red Hat OpenShift Service Mesh</strong></span> Operator.
								</li><li class="listitem">
									Click the <code class="literal">ServiceMeshMemberRoll</code> menu 
									<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
									 and select <span class="strong strong"><strong>Edit Service Mesh Member Roll</strong></span>.
								</li><li class="listitem"><p class="simpara">
									Edit the default Service Mesh Member Roll YAML and remove <code class="literal">bookinfo</code> from the <span class="strong strong"><strong>members</strong></span> list.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
											Alternatively, you can run this command using the CLI to remove the <code class="literal">bookinfo</code> project from the <code class="literal">ServiceMeshMemberRoll</code>. In this example, <code class="literal">istio-system</code> is the name of the Service Mesh control plane project.
										</p><pre class="programlisting language-terminal">$ oc -n istio-system patch --type='json' smmr default -p '[{"op": "remove", "path": "/spec/members", "value":["'"bookinfo"'"]}]'</pre></li></ul></div></li><li class="listitem">
									Click <span class="strong strong"><strong>Save</strong></span> to update Service Mesh Member Roll.
								</li></ol></div></section></section></section><section class="section" id="generating-sample-traces-analyzing-trace-data_deploying-applications-ossm-v1x"><div class="titlepage"><div><div><h3 class="title">2.8.7. Generating example traces and analyzing trace data</h3></div></div></div><p>
					Jaeger is an open source distributed tracing system. With Jaeger, you can perform a trace that follows the path of a request through various microservices which make up an application. Jaeger is installed by default as part of the Service Mesh.
				</p><p>
					This tutorial uses Service Mesh and the Bookinfo sample application to demonstrate how you can use Jaeger to perform distributed tracing.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites:</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							OpenShift Container Platform 4.1 or higher installed.
						</li><li class="listitem">
							Red Hat OpenShift Service Mesh 2.4.3 installed.
						</li><li class="listitem">
							Jaeger enabled during the installation.
						</li><li class="listitem">
							Bookinfo example application installed.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							After installing the Bookinfo sample application, send traffic to the mesh. Enter the following command several times.
						</p><pre class="programlisting language-terminal">$ curl "http://$GATEWAY_URL/productpage"</pre><p class="simpara">
							This command simulates a user visiting the <code class="literal">productpage</code> microservice of the application.
						</p></li><li class="listitem"><p class="simpara">
							In the OpenShift Container Platform console, navigate to <span class="strong strong"><strong>Networking</strong></span> → <span class="strong strong"><strong>Routes</strong></span> and search for the Jaeger route, which is the URL listed under <span class="strong strong"><strong>Location</strong></span>.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Alternatively, use the CLI to query for details of the route. In this example, <code class="literal">istio-system</code> is the Service Mesh control plane namespace:
								</p><pre class="programlisting language-terminal">$ export JAEGER_URL=$(oc get route -n istio-system jaeger -o jsonpath='{.spec.host}')</pre><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Enter the following command to reveal the URL for the Jaeger console. Paste the result in a browser and navigate to that URL.
										</p><pre class="programlisting language-terminal">echo $JAEGER_URL</pre></li></ol></div></li></ul></div></li><li class="listitem">
							Log in using the same user name and password as you use to access the OpenShift Container Platform console.
						</li><li class="listitem">
							In the left pane of the Jaeger dashboard, from the <span class="strong strong"><strong>Service</strong></span> menu, select <span class="strong strong"><strong>productpage.bookinfo</strong></span> and click <span class="strong strong"><strong>Find Traces</strong></span> at the bottom of the pane. A list of traces is displayed.
						</li><li class="listitem">
							Click one of the traces in the list to open a detailed view of that trace. If you click the first one in the list, which is the most recent trace, you see the details that correspond to the latest refresh of the <code class="literal">/productpage</code>.
						</li></ol></div></section></section><section class="section" id="ossm-observability-v1x"><div class="titlepage"><div><div><h2 class="title">2.9. Data visualization and observability</h2></div></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					<span class="strong strong"><strong>You are viewing documentation for a Red Hat OpenShift Service Mesh release that is no longer supported.</strong></span>
				</p><p>
					Service Mesh version 1.0 and 1.1 control planes are no longer supported. For information about upgrading your service mesh control plane, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-versions_ossm-upgrade">Upgrading Service Mesh</a>.
				</p><p>
					For information about the support status of a particular Red Hat OpenShift Service Mesh release, see the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ossm">Product lifecycle page</a>.
				</p></div></div><p>
				You can view your application’s topology, health and metrics in the Kiali console. If your service is having issues, the Kiali console offers ways to visualize the data flow through your service. You can view insights about the mesh components at different levels, including abstract applications, services, and workloads. It also provides an interactive graph view of your namespace in real time.
			</p><div class="formalpara"><p class="title"><strong>Before you begin</strong></p><p>
					You can observe the data flow through your application if you have an application installed. If you don’t have your own application installed, you can see how observability works in Red Hat OpenShift Service Mesh by installing the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-tutorial-bookinfo-overview_deploying-applications-ossm-v1x">Bookinfo sample application</a>.
				</p></div><section class="section" id="ossm-observability-access-console_observability-v1x"><div class="titlepage"><div><div><h3 class="title">2.9.1. Viewing service mesh data</h3></div></div></div><p>
					The Kiali operator works with the telemetry data gathered in Red Hat OpenShift Service Mesh to provide graphs and real-time network diagrams of the applications, services, and workloads in your namespace.
				</p><p>
					To access the Kiali console you must have Red Hat OpenShift Service Mesh installed and projects configured for the service mesh.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Use the perspective switcher to switch to the <span class="strong strong"><strong>Administrator</strong></span> perspective.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Home</strong></span> → <span class="strong strong"><strong>Projects</strong></span>.
						</li><li class="listitem">
							Click the name of your project. For example, click <code class="literal">bookinfo</code>.
						</li><li class="listitem">
							In the <span class="strong strong"><strong>Launcher</strong></span> section, click <span class="strong strong"><strong>Kiali</strong></span>.
						</li><li class="listitem">
							Log in to the Kiali console with the same user name and password that you use to access the OpenShift Container Platform console.
						</li></ol></div><p>
					When you first log in to the Kiali Console, you see the <span class="strong strong"><strong>Overview</strong></span> page which displays all the namespaces in your service mesh that you have permission to view.
				</p><p>
					If you are validating the console installation, there might not be any data to display.
				</p></section><section class="section" id="ossm-observability-visual_observability-v1x"><div class="titlepage"><div><div><h3 class="title">2.9.2. Viewing service mesh data in the Kiali console</h3></div></div></div><p>
					The Kiali Graph offers a powerful visualization of your mesh traffic. The topology combines real-time request traffic with your Istio configuration information to present immediate insight into the behavior of your service mesh, letting you quickly pinpoint issues. Multiple Graph Types let you visualize traffic as a high-level service topology, a low-level workload topology, or as an application-level topology.
				</p><p>
					There are several graphs to choose from:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The <span class="strong strong"><strong>App graph</strong></span> shows an aggregate workload for all applications that are labeled the same.
						</li><li class="listitem">
							The <span class="strong strong"><strong>Service graph</strong></span> shows a node for each service in your mesh but excludes all applications and workloads from the graph. It provides a high level view and aggregates all traffic for defined services.
						</li><li class="listitem">
							The <span class="strong strong"><strong>Versioned App graph</strong></span> shows a node for each version of an application. All versions of an application are grouped together.
						</li><li class="listitem">
							The <span class="strong strong"><strong>Workload graph</strong></span> shows a node for each workload in your service mesh. This graph does not require you to use the application and version labels. If your application does not use version labels, use this the graph.
						</li></ul></div><p>
					Graph nodes are decorated with a variety of information, pointing out various route routing options like virtual services and service entries, as well as special configuration like fault-injection and circuit breakers. It can identify mTLS issues, latency issues, error traffic and more. The Graph is highly configurable, can show traffic animation, and has powerful Find and Hide abilities.
				</p><p>
					Click the <span class="strong strong"><strong>Legend</strong></span> button to view information about the shapes, colors, arrows, and badges displayed in the graph.
				</p><p>
					To view a summary of metrics, select any node or edge in the graph to display its metric details in the summary details panel.
				</p><section class="section" id="ossm-observability-topology_observability-v1x"><div class="titlepage"><div><div><h4 class="title">2.9.2.1. Changing graph layouts in Kiali</h4></div></div></div><p>
						The layout for the Kiali graph can render differently depending on your application architecture and the data to display. For example, the number of graph nodes and their interactions can determine how the Kiali graph is rendered. Because it is not possible to create a single layout that renders nicely for every situation, Kiali offers a choice of several different layouts.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								If you do not have your own application installed, install the Bookinfo sample application. Then generate traffic for the Bookinfo application by entering the following command several times.
							</p><pre class="programlisting language-terminal">$ curl "http://$GATEWAY_URL/productpage"</pre><p class="simpara">
								This command simulates a user visiting the <code class="literal">productpage</code> microservice of the application.
							</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Launch the Kiali console.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Log In With OpenShift</strong></span>.
							</li><li class="listitem">
								In Kiali console, click <span class="strong strong"><strong>Graph</strong></span> to view a namespace graph.
							</li><li class="listitem">
								From the <span class="strong strong"><strong>Namespace</strong></span> menu, select your application namespace, for example, <code class="literal">bookinfo</code>.
							</li><li class="listitem"><p class="simpara">
								To choose a different graph layout, do either or both of the following:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Select different graph data groupings from the menu at the top of the graph.
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												App graph
											</li><li class="listitem">
												Service graph
											</li><li class="listitem">
												Versioned App graph (default)
											</li><li class="listitem">
												Workload graph
											</li></ul></div></li><li class="listitem"><p class="simpara">
										Select a different graph layout from the Legend at the bottom of the graph.
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												Layout default dagre
											</li><li class="listitem">
												Layout 1 cose-bilkent
											</li><li class="listitem">
												Layout 2 cola
											</li></ul></div></li></ul></div></li></ol></div></section></section></section><section class="section" id="ossm-custom-resources-v1x"><div class="titlepage"><div><div><h2 class="title">2.10. Custom resources</h2></div></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					<span class="strong strong"><strong>You are viewing documentation for a Red Hat OpenShift Service Mesh release that is no longer supported.</strong></span>
				</p><p>
					Service Mesh version 1.0 and 1.1 control planes are no longer supported. For information about upgrading your service mesh control plane, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-versions_ossm-upgrade">Upgrading Service Mesh</a>.
				</p><p>
					For information about the support status of a particular Red Hat OpenShift Service Mesh release, see the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ossm">Product lifecycle page</a>.
				</p></div></div><p>
				You can customize your Red Hat OpenShift Service Mesh by modifying the default Service Mesh custom resource or by creating a new custom resource.
			</p><section class="section" id="prerequisites-7"><div class="titlepage"><div><div><h3 class="title">2.10.1. Prerequisites</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							An account with the <code class="literal">cluster-admin</code> role.
						</li><li class="listitem">
							Completed the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#preparing-ossm-installation-v1x">Preparing to install Red Hat OpenShift Service Mesh</a> process.
						</li><li class="listitem">
							Have installed the operators.
						</li></ul></div></section><section class="section" id="ossm-cr-example-1x_ossm-controler-items-v1x"><div class="titlepage"><div><div><h3 class="title">2.10.2. Red Hat OpenShift Service Mesh custom resources</h3></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The <code class="literal">istio-system</code> project is used as an example throughout the Service Mesh documentation, but you can use other projects as necessary.
					</p></div></div><p>
					A <span class="emphasis"><em>custom resource</em></span> allows you to extend the API in an Red Hat OpenShift Service Mesh project or cluster. When you deploy Service Mesh it creates a default <code class="literal">ServiceMeshControlPlane</code> that you can modify to change the project parameters.
				</p><p>
					The Service Mesh operator extends the API by adding the <code class="literal">ServiceMeshControlPlane</code> resource type, which enables you to create <code class="literal">ServiceMeshControlPlane</code> objects within projects. By creating a <code class="literal">ServiceMeshControlPlane</code> object, you instruct the Operator to install a Service Mesh control plane into the project, configured with the parameters you set in the <code class="literal">ServiceMeshControlPlane</code> object.
				</p><p>
					This example <code class="literal">ServiceMeshControlPlane</code> definition contains all of the supported parameters and deploys Red Hat OpenShift Service Mesh 1.1.18.2 images based on Red Hat Enterprise Linux (RHEL).
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The 3scale Istio Adapter is deployed and configured in the custom resource file. It also requires a working 3scale account (<a class="link" href="https://www.3scale.net/signup/">SaaS</a> or <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_3scale_api_management/2.4/html/infrastructure/onpremises-installation">On-Premises</a>).
					</p></div></div><div class="formalpara"><p class="title"><strong>Example istio-installation.yaml</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshControlPlane
metadata:
  name: basic-install
spec:

  istio:
    global:
      proxy:
        resources:
          requests:
            cpu: 100m
            memory: 128Mi
          limits:
            cpu: 500m
            memory: 128Mi

    gateways:
      istio-egressgateway:
        autoscaleEnabled: false
      istio-ingressgateway:
        autoscaleEnabled: false
        ior_enabled: false

    mixer:
      policy:
        autoscaleEnabled: false

      telemetry:
        autoscaleEnabled: false
        resources:
          requests:
            cpu: 100m
            memory: 1G
          limits:
            cpu: 500m
            memory: 4G

    pilot:
      autoscaleEnabled: false
      traceSampling: 100

    kiali:
      enabled: true

    grafana:
      enabled: true

    tracing:
      enabled: true
      jaeger:
        template: all-in-one</pre>

					</p></div></section><section class="section" id="ossm-cr-parameters_ossm-controler-items-v1x"><div class="titlepage"><div><div><h3 class="title">2.10.3. ServiceMeshControlPlane parameters</h3></div></div></div><p>
					The following examples illustrate use of the <code class="literal">ServiceMeshControlPlane</code> parameters and the tables provide additional information about supported parameters.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The resources you configure for Red Hat OpenShift Service Mesh with these parameters, including CPUs, memory, and the number of pods, are based on the configuration of your OpenShift Container Platform cluster. Configure these parameters based on the available resources in your current cluster configuration.
					</p></div></div><section class="section" id="ossm-cr-istio-global_ossm-controler-items-v1x"><div class="titlepage"><div><div><h4 class="title">2.10.3.1. Istio global example</h4></div></div></div><p>
						Here is an example that illustrates the Istio global parameters for the <code class="literal">ServiceMeshControlPlane</code> and a description of the available parameters with appropriate values.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							In order for the 3scale Istio Adapter to work, <code class="literal">disablePolicyChecks</code> must be <code class="literal">false</code>.
						</p></div></div><div class="formalpara"><p class="title"><strong>Example global parameters</strong></p><p>
							
<pre class="programlisting language-yaml">  istio:
    global:
      tag: 1.1.0
      hub: registry.redhat.io/openshift-service-mesh/
      proxy:
        resources:
          requests:
            cpu: 10m
            memory: 128Mi
          limits:
      mtls:
        enabled: false
      disablePolicyChecks: true
      policyCheckFailOpen: false
      imagePullSecrets:
        - MyPullSecret</pre>

						</p></div><div class="table" id="idm140663661874688"><p class="title"><strong>Table 2.4. Global parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663661868000" scope="col">Parameter</th><th align="left" valign="top" id="idm140663661866912" scope="col">Description</th><th align="left" valign="top" id="idm140663661865824" scope="col">Values</th><th align="left" valign="top" id="idm140663661864736" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663661868000"> <p>
										<code class="literal">disablePolicyChecks</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661866912"> <p>
										This parameter enables/disables policy checks.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661865824"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661864736"> <p>
										<code class="literal">true</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661868000"> <p>
										<code class="literal">policyCheckFailOpen</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661866912"> <p>
										This parameter indicates whether traffic is allowed to pass through to the Envoy sidecar when the Mixer policy service cannot be reached.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661865824"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661864736"> <p>
										<code class="literal">false</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661868000"> <p>
										<code class="literal">tag</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661866912"> <p>
										The tag that the Operator uses to pull the Istio images.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661865824"> <p>
										A valid container image tag.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661864736"> <p>
										<code class="literal">1.1.0</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661868000"> <p>
										<code class="literal">hub</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661866912"> <p>
										The hub that the Operator uses to pull Istio images.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661865824"> <p>
										A valid image repository.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661864736"> <p>
										<code class="literal">maistra/</code> or <code class="literal">registry.redhat.io/openshift-service-mesh/</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661868000"> <p>
										<code class="literal">mtls</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661866912"> <p>
										This parameter controls whether to enable/disable Mutual Transport Layer Security (mTLS) between services by default.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661865824"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661864736"> <p>
										<code class="literal">false</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661868000"> <p>
										<code class="literal">imagePullSecrets</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661866912"> <p>
										If access to the registry providing the Istio images is secure, list an <a class="link" href="https://kubernetes.io/docs/concepts/containers/images/#specifying-imagepullsecrets-on-a-pod">imagePullSecret</a> here.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661865824"> <p>
										redhat-registry-pullsecret OR quay-pullsecret
									</p>
									 </td><td align="left" valign="top" headers="idm140663661864736"> <p>
										None
									</p>
									 </td></tr></tbody></table></div></div><p>
						These parameters are specific to the proxy subset of global parameters.
					</p><div class="table" id="idm140663661811296"><p class="title"><strong>Table 2.5. Proxy parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 20%; " class="col_2"><!--Empty--></col><col style="width: 20%; " class="col_3"><!--Empty--></col><col style="width: 20%; " class="col_4"><!--Empty--></col><col style="width: 20%; " class="col_5"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663661803680" scope="col">Type</th><th align="left" valign="top" id="idm140663661802592" scope="col">Parameter</th><th align="left" valign="top" id="idm140663661801504" scope="col">Description</th><th align="left" valign="top" id="idm140663661800416" scope="col">Values</th><th align="left" valign="top" id="idm140663661799328" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663661803680"> <p>
										<code class="literal">requests</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661802592"> <p>
										<code class="literal">cpu</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661801504"> <p>
										The amount of CPU resources requested for Envoy proxy.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661800416"> <p>
										CPU resources, specified in cores or millicores (for example, 200m, 0.5, 1) based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661799328"> <p>
										<code class="literal">10m</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661803680"> </td><td align="left" valign="top" headers="idm140663661802592"> <p>
										<code class="literal">memory</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661801504"> <p>
										The amount of memory requested for Envoy proxy
									</p>
									 </td><td align="left" valign="top" headers="idm140663661800416"> <p>
										Available memory in bytes(for example, 200Ki, 50Mi, 5Gi) based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661799328"> <p>
										<code class="literal">128Mi</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661803680"> <p>
										<code class="literal">limits</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661802592"> <p>
										<code class="literal">cpu</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661801504"> <p>
										The maximum amount of CPU resources requested for Envoy proxy.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661800416"> <p>
										CPU resources, specified in cores or millicores (for example, 200m, 0.5, 1) based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661799328"> <p>
										<code class="literal">2000m</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661803680"> </td><td align="left" valign="top" headers="idm140663661802592"> <p>
										<code class="literal">memory</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661801504"> <p>
										The maximum amount of memory Envoy proxy is permitted to use.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661800416"> <p>
										Available memory in bytes (for example, 200Ki, 50Mi, 5Gi) based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661799328"> <p>
										<code class="literal">1024Mi</code>
									</p>
									 </td></tr></tbody></table></div></div></section><section class="section" id="ossm-cr-gateway_ossm-controler-items-v1x"><div class="titlepage"><div><div><h4 class="title">2.10.3.2. Istio gateway configuration</h4></div></div></div><p>
						Here is an example that illustrates the Istio gateway parameters for the <code class="literal">ServiceMeshControlPlane</code> and a description of the available parameters with appropriate values.
					</p><div class="formalpara"><p class="title"><strong>Example gateway parameters</strong></p><p>
							
<pre class="programlisting language-yaml">  gateways:
    egress:
      enabled: true
      runtime:
        deployment:
          autoScaling:
            enabled: true
            maxReplicas: 5
            minReplicas: 1
    enabled: true
    ingress:
      enabled: true
      runtime:
        deployment:
          autoScaling:
            enabled: true
            maxReplicas: 5
            minReplicas: 1</pre>

						</p></div><div class="table" id="idm140663661753472"><p class="title"><strong>Table 2.6. Istio Gateway parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663661746768" scope="col">Parameter</th><th align="left" valign="top" id="idm140663661745680" scope="col">Description</th><th align="left" valign="top" id="idm140663661744592" scope="col">Values</th><th align="left" valign="top" id="idm140663661743504" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663661746768"> <p>
										<code class="literal">gateways.egress.runtime.deployment.autoScaling.enabled</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661745680"> <p>
										This parameter enables/disables autoscaling.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661744592"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661743504"> <p>
										<code class="literal">true</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661746768"> <p>
										<code class="literal">gateways.egress.runtime.deployment.autoScaling.minReplicas</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661745680"> <p>
										The minimum number of pods to deploy for the egress gateway based on the <code class="literal">autoscaleEnabled</code> setting.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661744592"> <p>
										A valid number of allocatable pods based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661743504"> <p>
										<code class="literal">1</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661746768"> <p>
										<code class="literal">gateways.egress.runtime.deployment.autoScaling.maxReplicas</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661745680"> <p>
										The maximum number of pods to deploy for the egress gateway based on the <code class="literal">autoscaleEnabled</code> setting.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661744592"> <p>
										A valid number of allocatable pods based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661743504"> <p>
										<code class="literal">5</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661746768"> <p>
										<code class="literal">gateways.ingress.runtime.deployment.autoScaling.enabled</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661745680"> <p>
										This parameter enables/disables autoscaling.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661744592"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661743504"> <p>
										<code class="literal">true</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661746768"> <p>
										<code class="literal">gateways.ingress.runtime.deployment.autoScaling.minReplicas</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661745680"> <p>
										The minimum number of pods to deploy for the ingress gateway based on the <code class="literal">autoscaleEnabled</code> setting.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661744592"> <p>
										A valid number of allocatable pods based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661743504"> <p>
										<code class="literal">1</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661746768"> <p>
										<code class="literal">gateways.ingress.runtime.deployment.autoScaling.maxReplicas</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661745680"> <p>
										The maximum number of pods to deploy for the ingress gateway based on the <code class="literal">autoscaleEnabled</code> setting.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661744592"> <p>
										A valid number of allocatable pods based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661743504"> <p>
										<code class="literal">5</code>
									</p>
									 </td></tr></tbody></table></div></div><p>
						Cluster administrators can refer to <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#using-wildcard-routes_configuring-ingress">Using wildcard routes</a> for instructions on how to enable subdomains.
					</p></section><section class="section" id="ossm-cr-mixer_ossm-controler-items-v1x"><div class="titlepage"><div><div><h4 class="title">2.10.3.3. Istio Mixer configuration</h4></div></div></div><p>
						Here is an example that illustrates the Mixer parameters for the <code class="literal">ServiceMeshControlPlane</code> and a description of the available parameters with appropriate values.
					</p><div class="formalpara"><p class="title"><strong>Example mixer parameters</strong></p><p>
							
<pre class="programlisting language-yaml">mixer:
  enabled: true
  policy:
    autoscaleEnabled: false
  telemetry:
    autoscaleEnabled: false
    resources:
    requests:
      cpu: 10m
      memory: 128Mi
      limits:</pre>

						</p></div><div class="table" id="idm140663661683104"><p class="title"><strong>Table 2.7. Istio Mixer policy parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663661676400" scope="col">Parameter</th><th align="left" valign="top" id="idm140663661675312" scope="col">Description</th><th align="left" valign="top" id="idm140663661674224" scope="col">Values</th><th align="left" valign="top" id="idm140663661673136" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663661676400"> <p>
										<code class="literal">enabled</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661675312"> <p>
										This parameter enables/disables Mixer.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661674224"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661673136"> <p>
										<code class="literal">true</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661676400"> <p>
										<code class="literal">autoscaleEnabled</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661675312"> <p>
										This parameter enables/disables autoscaling. Disable this for small environments.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661674224"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661673136"> <p>
										<code class="literal">true</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661676400"> <p>
										<code class="literal">autoscaleMin</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661675312"> <p>
										The minimum number of pods to deploy based on the <code class="literal">autoscaleEnabled</code> setting.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661674224"> <p>
										A valid number of allocatable pods based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661673136"> <p>
										<code class="literal">1</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661676400"> <p>
										<code class="literal">autoscaleMax</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661675312"> <p>
										The maximum number of pods to deploy based on the <code class="literal">autoscaleEnabled</code> setting.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661674224"> <p>
										A valid number of allocatable pods based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661673136"> <p>
										<code class="literal">5</code>
									</p>
									 </td></tr></tbody></table></div></div><div class="table" id="idm140663661636592"><p class="title"><strong>Table 2.8. Istio Mixer telemetry parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 20%; " class="col_2"><!--Empty--></col><col style="width: 20%; " class="col_3"><!--Empty--></col><col style="width: 20%; " class="col_4"><!--Empty--></col><col style="width: 20%; " class="col_5"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663661628960" scope="col">Type</th><th align="left" valign="top" id="idm140663661627872" scope="col">Parameter</th><th align="left" valign="top" id="idm140663661626784" scope="col">Description</th><th align="left" valign="top" id="idm140663661625696" scope="col">Values</th><th align="left" valign="top" id="idm140663661624608" scope="col">Default</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663661628960"> <p>
										<code class="literal">requests</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661627872"> <p>
										<code class="literal">cpu</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661626784"> <p>
										The percentage of CPU resources requested for Mixer telemetry.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661625696"> <p>
										CPU resources in millicores based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661624608"> <p>
										<code class="literal">10m</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661628960"> </td><td align="left" valign="top" headers="idm140663661627872"> <p>
										<code class="literal">memory</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661626784"> <p>
										The amount of memory requested for Mixer telemetry.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661625696"> <p>
										Available memory in bytes (for example, 200Ki, 50Mi, 5Gi) based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661624608"> <p>
										<code class="literal">128Mi</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661628960"> <p>
										<code class="literal">limits</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661627872"> <p>
										<code class="literal">cpu</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661626784"> <p>
										The maximum percentage of CPU resources Mixer telemetry is permitted to use.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661625696"> <p>
										CPU resources in millicores based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661624608"> <p>
										<code class="literal">4800m</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661628960"> </td><td align="left" valign="top" headers="idm140663661627872"> <p>
										<code class="literal">memory</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661626784"> <p>
										The maximum amount of memory Mixer telemetry is permitted to use.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661625696"> <p>
										Available memory in bytes (for example, 200Ki, 50Mi, 5Gi) based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661624608"> <p>
										<code class="literal">4G</code>
									</p>
									 </td></tr></tbody></table></div></div></section><section class="section" id="ossm-cr-pilot_ossm-controler-items-v1x"><div class="titlepage"><div><div><h4 class="title">2.10.3.4. Istio Pilot configuration</h4></div></div></div><p>
						You can configure Pilot to schedule or set limits on resource allocation. The following example illustrates the Pilot parameters for the <code class="literal">ServiceMeshControlPlane</code> and a description of the available parameters with appropriate values.
					</p><div class="formalpara"><p class="title"><strong>Example pilot parameters</strong></p><p>
							
<pre class="programlisting language-yaml">spec:
  runtime:
    components:
      pilot:
        deployment:
          autoScaling:
            enabled: true
            minReplicas: 1
            maxReplicas: 5
            targetCPUUtilizationPercentage: 85
        pod:
          tolerations:
          - key: node.kubernetes.io/unreachable
            operator: Exists
            effect: NoExecute
            tolerationSeconds: 60
          affinity:
            podAntiAffinity:
              requiredDuringScheduling:
              - key: istio
                topologyKey: kubernetes.io/hostname
                operator: In
                values:
                - pilot
        container:
          resources:
            limits:
              cpu: 100m
              memory: 128M</pre>

						</p></div><div class="table" id="idm140663661578576"><p class="title"><strong>Table 2.9. Istio Pilot parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663661571888" scope="col">Parameter</th><th align="left" valign="top" id="idm140663661570800" scope="col">Description</th><th align="left" valign="top" id="idm140663661569712" scope="col">Values</th><th align="left" valign="top" id="idm140663661568624" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663661571888"> <p>
										<code class="literal">cpu</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661570800"> <p>
										The percentage of CPU resources requested for Pilot.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661569712"> <p>
										CPU resources in millicores based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661568624"> <p>
										<code class="literal">10m</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661571888"> <p>
										<code class="literal">memory</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661570800"> <p>
										The amount of memory requested for Pilot.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661569712"> <p>
										Available memory in bytes (for example, 200Ki, 50Mi, 5Gi) based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661568624"> <p>
										<code class="literal">128Mi</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661571888"> <p>
										<code class="literal">autoscaleEnabled</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661570800"> <p>
										This parameter enables/disables autoscaling. Disable this for small environments.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661569712"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661568624"> <p>
										<code class="literal">true</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661571888"> <p>
										<code class="literal">traceSampling</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661570800"> <p>
										This value controls how often random sampling occurs. <span class="strong strong"><strong>Note:</strong></span> Increase for development or testing.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661569712"> <p>
										A valid percentage.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661568624"> <p>
										<code class="literal">1.0</code>
									</p>
									 </td></tr></tbody></table></div></div></section></section><section class="section" id="configuring-kiali_ossm-controler-items-v1x"><div class="titlepage"><div><div><h3 class="title">2.10.4. Configuring Kiali</h3></div></div></div><p>
					When the Service Mesh Operator creates the <code class="literal">ServiceMeshControlPlane</code> it also processes the Kiali resource. The Kiali Operator then uses this object when creating Kiali instances.
				</p><p>
					The default Kiali parameters specified in the <code class="literal">ServiceMeshControlPlane</code> are as follows:
				</p><div class="formalpara"><p class="title"><strong>Example Kiali parameters</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshControlPlane
spec:
    kiali:
      enabled: true
      dashboard:
        viewOnlyMode: false
      ingress:
        enabled: true</pre>

					</p></div><div class="table" id="idm140663661526624"><p class="title"><strong>Table 2.10. Kiali parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663661519936" scope="col">Parameter</th><th align="left" valign="top" id="idm140663661518848" scope="col">Description</th><th align="left" valign="top" id="idm140663661517760" scope="col">Values</th><th align="left" valign="top" id="idm140663661516672" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663661519936">
<pre class="literallayout">enabled</pre>
								 </td><td align="left" valign="top" headers="idm140663661518848"> <p>
									This parameter enables/disables Kiali. Kiali is enabled by default.
								</p>
								 </td><td align="left" valign="top" headers="idm140663661517760"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663661516672"> <p>
									<code class="literal">true</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663661519936">
<pre class="literallayout">dashboard
   viewOnlyMode</pre>
								 </td><td align="left" valign="top" headers="idm140663661518848"> <p>
									This parameter enables/disables view-only mode for the Kiali console. When view-only mode is enabled, users cannot use the console to make changes to the Service Mesh.
								</p>
								 </td><td align="left" valign="top" headers="idm140663661517760"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663661516672"> <p>
									<code class="literal">false</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663661519936">
<pre class="literallayout">ingress
   enabled</pre>
								 </td><td align="left" valign="top" headers="idm140663661518848"> <p>
									This parameter enables/disables ingress for Kiali.
								</p>
								 </td><td align="left" valign="top" headers="idm140663661517760"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663661516672"> <p>
									<code class="literal">true</code>
								</p>
								 </td></tr></tbody></table></div></div><section class="section" id="configuring-kiali-grafana_ossm-controler-items-v1x"><div class="titlepage"><div><div><h4 class="title">2.10.4.1. Configuring Kiali for Grafana</h4></div></div></div><p>
						When you install Kiali and Grafana as part of Red Hat OpenShift Service Mesh the Operator configures the following by default:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Grafana is enabled as an external service for Kiali
							</li><li class="listitem">
								Grafana authorization for the Kiali console
							</li><li class="listitem">
								Grafana URL for the Kiali console
							</li></ul></div><p>
						Kiali can automatically detect the Grafana URL. However if you have a custom Grafana installation that is not easily auto-detectable by Kiali, you must update the URL value in the <code class="literal">ServiceMeshControlPlane</code> resource.
					</p><div class="formalpara"><p class="title"><strong>Additional Grafana parameters</strong></p><p>
							
<pre class="programlisting language-yaml">spec:
  kiali:
    enabled: true
    dashboard:
      viewOnlyMode: false
      grafanaURL:  "https://grafana-istio-system.127.0.0.1.nip.io"
    ingress:
      enabled: true</pre>

						</p></div></section><section class="section" id="configuring-kiali-jaeger_ossm-controler-items-v1x"><div class="titlepage"><div><div><h4 class="title">2.10.4.2. Configuring Kiali for Jaeger</h4></div></div></div><p>
						When you install Kiali and Jaeger as part of Red Hat OpenShift Service Mesh the Operator configures the following by default:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Jaeger is enabled as an external service for Kiali
							</li><li class="listitem">
								Jaeger authorization for the Kiali console
							</li><li class="listitem">
								Jaeger URL for the Kiali console
							</li></ul></div><p>
						Kiali can automatically detect the Jaeger URL. However if you have a custom Jaeger installation that is not easily auto-detectable by Kiali, you must update the URL value in the <code class="literal">ServiceMeshControlPlane</code> resource.
					</p><div class="formalpara"><p class="title"><strong>Additional Jaeger parameters</strong></p><p>
							
<pre class="programlisting language-yaml">spec:
  kiali:
    enabled: true
    dashboard:
      viewOnlyMode: false
      jaegerURL: "http://jaeger-query-istio-system.127.0.0.1.nip.io"
    ingress:
      enabled: true</pre>

						</p></div></section></section><section class="section" id="ossm-configuring-jaeger_ossm-controler-items-v1x"><div class="titlepage"><div><div><h3 class="title">2.10.5. Configuring Jaeger</h3></div></div></div><p>
					When the Service Mesh Operator creates the <code class="literal">ServiceMeshControlPlane</code> resource it can also create the resources for distributed tracing. Service Mesh uses Jaeger for distributed tracing.
				</p><p>
					You can specify your Jaeger configuration in either of two ways:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Configure Jaeger in the <code class="literal">ServiceMeshControlPlane</code> resource. There are some limitations with this approach.
						</li><li class="listitem">
							Configure Jaeger in a custom <code class="literal">Jaeger</code> resource and then reference that Jaeger instance in the <code class="literal">ServiceMeshControlPlane</code> resource. If a Jaeger resource matching the value of <code class="literal">name</code> exists, the control plane will use the existing installation. This approach lets you fully customize your Jaeger configuration.
						</li></ul></div><p>
					The default Jaeger parameters specified in the <code class="literal">ServiceMeshControlPlane</code> are as follows:
				</p><div class="formalpara"><p class="title"><strong>Default <code class="literal">all-in-one</code> Jaeger parameters</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshControlPlane
spec:
  version: v1.1
  istio:
    tracing:
      enabled: true
      jaeger:
        template: all-in-one</pre>

					</p></div><div class="table" id="idm140663661457728"><p class="title"><strong>Table 2.11. Jaeger parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663661451040" scope="col">Parameter</th><th align="left" valign="top" id="idm140663661449952" scope="col">Description</th><th align="left" valign="top" id="idm140663661448864" scope="col">Values</th><th align="left" valign="top" id="idm140663661447776" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663661451040">
<pre class="literallayout">tracing:
   enabled:</pre>
								 </td><td align="left" valign="top" headers="idm140663661449952"> <p>
									This parameter enables/disables installing and deploying tracing by the Service Mesh Operator. Installing Jaeger is enabled by default. To use an existing Jaeger deployment, set this value to <code class="literal">false</code>.
								</p>
								 </td><td align="left" valign="top" headers="idm140663661448864"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663661447776"> <p>
									<code class="literal">true</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663661451040">
<pre class="literallayout">jaeger:
   template:</pre>
								 </td><td align="left" valign="top" headers="idm140663661449952"> <p>
									This parameter specifies which Jaeger deployment strategy to use.
								</p>
								 </td><td align="left" valign="top" headers="idm140663661448864"> <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<code class="literal">all-in-one</code>- For development, testing, demonstrations, and proof of concept.
										</li><li class="listitem">
											<code class="literal">production-elasticsearch</code> - For production use.
										</li></ul></div>
								 </td><td align="left" valign="top" headers="idm140663661447776"> <p>
									<code class="literal">all-in-one</code>
								</p>
								 </td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The default template in the <code class="literal">ServiceMeshControlPlane</code> resource is the <code class="literal">all-in-one</code> deployment strategy which uses in-memory storage. For production, the only supported storage option is Elasticsearch, therefore you must configure the <code class="literal">ServiceMeshControlPlane</code> to request the <code class="literal">production-elasticsearch</code> template when you deploy Service Mesh within a production environment.
					</p></div></div><section class="section" id="ossm-configuring-jaeger-elasticsearch_ossm-controler-items-v1x"><div class="titlepage"><div><div><h4 class="title">2.10.5.1. Configuring Elasticsearch</h4></div></div></div><p>
						The default Jaeger deployment strategy uses the <code class="literal">all-in-one</code> template so that the installation can be completed using minimal resources. However, because the <code class="literal">all-in-one</code> template uses in-memory storage, it is only recommended for development, demo, or testing purposes and should NOT be used for production environments.
					</p><p>
						If you are deploying Service Mesh and Jaeger in a production environment you must change the template to the <code class="literal">production-elasticsearch</code> template, which uses Elasticsearch for Jaeger’s storage needs.
					</p><p>
						Elasticsearch is a memory intensive application. The initial set of nodes specified in the default OpenShift Container Platform installation may not be large enough to support the Elasticsearch cluster. You should modify the default Elasticsearch configuration to match your use case and the resources you have requested for your OpenShift Container Platform installation. You can adjust both the CPU and memory limits for each component by modifying the resources block with valid CPU and memory values. Additional nodes must be added to the cluster if you want to run with the recommended amount (or more) of memory. Ensure that you do not exceed the resources requested for your OpenShift Container Platform installation.
					</p><div class="formalpara"><p class="title"><strong>Default "production" Jaeger parameters with Elasticsearch</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshControlPlane
spec:
  istio:
    tracing:
    enabled: true
    ingress:
      enabled: true
    jaeger:
      template: production-elasticsearch
      elasticsearch:
        nodeCount: 3
        redundancyPolicy:
        resources:
          requests:
            cpu: "1"
            memory: "16Gi"
          limits:
            cpu: "1"
            memory: "16Gi"</pre>

						</p></div><div class="table" id="idm140663661413440"><p class="title"><strong>Table 2.12. Elasticsearch parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 20%; " class="col_2"><!--Empty--></col><col style="width: 20%; " class="col_3"><!--Empty--></col><col style="width: 20%; " class="col_4"><!--Empty--></col><col style="width: 20%; " class="col_5"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663661405808" scope="col">Parameter</th><th align="left" valign="top" id="idm140663661404720" scope="col">Description</th><th align="left" valign="top" id="idm140663661403632" scope="col">Values</th><th align="left" valign="top" id="idm140663661402544" scope="col">Default Value</th><th align="left" valign="top" id="idm140663661401456" scope="col">Examples</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663661405808">
<pre class="literallayout">tracing:
  enabled:</pre>
									 </td><td align="left" valign="top" headers="idm140663661404720"> <p>
										This parameter enables/disables tracing in Service Mesh. Jaeger is installed by default.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661403632"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661402544"> <p>
										<code class="literal">true</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661401456"> </td></tr><tr><td align="left" valign="top" headers="idm140663661405808">
<pre class="literallayout">ingress:
  enabled:</pre>
									 </td><td align="left" valign="top" headers="idm140663661404720"> <p>
										This parameter enables/disables ingress for Jaeger.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661403632"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661402544"> <p>
										<code class="literal">true</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661401456"> </td></tr><tr><td align="left" valign="top" headers="idm140663661405808">
<pre class="literallayout">jaeger:
   template:</pre>
									 </td><td align="left" valign="top" headers="idm140663661404720"> <p>
										This parameter specifies which Jaeger deployment strategy to use.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661403632"> <p>
										<code class="literal">all-in-one</code>/<code class="literal">production-elasticsearch</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661402544"> <p>
										<code class="literal">all-in-one</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661401456"> </td></tr><tr><td align="left" valign="top" headers="idm140663661405808">
<pre class="literallayout">elasticsearch:
  nodeCount:</pre>
									 </td><td align="left" valign="top" headers="idm140663661404720"> <p>
										Number of Elasticsearch nodes to create.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661403632"> <p>
										Integer value.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661402544"> <p>
										1
									</p>
									 </td><td align="left" valign="top" headers="idm140663661401456"> <p>
										Proof of concept = 1, Minimum deployment =3
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661405808">
<pre class="literallayout">requests:
  cpu:</pre>
									 </td><td align="left" valign="top" headers="idm140663661404720"> <p>
										Number of central processing units for requests, based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661403632"> <p>
										Specified in cores or millicores (for example, 200m, 0.5, 1).
									</p>
									 </td><td align="left" valign="top" headers="idm140663661402544"> <p>
										1Gi
									</p>
									 </td><td align="left" valign="top" headers="idm140663661401456"> <p>
										Proof of concept = 500m, Minimum deployment =1
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661405808">
<pre class="literallayout">requests:
  memory:</pre>
									 </td><td align="left" valign="top" headers="idm140663661404720"> <p>
										Available memory for requests, based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661403632"> <p>
										Specified in bytes (for example, 200Ki, 50Mi, 5Gi).
									</p>
									 </td><td align="left" valign="top" headers="idm140663661402544"> <p>
										500m
									</p>
									 </td><td align="left" valign="top" headers="idm140663661401456"> <p>
										Proof of concept = 1Gi, Minimum deployment = 16Gi*
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661405808">
<pre class="literallayout">limits:
  cpu:</pre>
									 </td><td align="left" valign="top" headers="idm140663661404720"> <p>
										Limit on number of central processing units, based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661403632"> <p>
										Specified in cores or millicores (for example, 200m, 0.5, 1).
									</p>
									 </td><td align="left" valign="top" headers="idm140663661402544"> </td><td align="left" valign="top" headers="idm140663661401456"> <p>
										Proof of concept = 500m, Minimum deployment =1
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661405808">
<pre class="literallayout">limits:
  memory:</pre>
									 </td><td align="left" valign="top" headers="idm140663661404720"> <p>
										Available memory limit based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661403632"> <p>
										Specified in bytes (for example, 200Ki, 50Mi, 5Gi).
									</p>
									 </td><td align="left" valign="top" headers="idm140663661402544"> </td><td align="left" valign="top" headers="idm140663661401456"> <p>
										Proof of concept = 1Gi, Minimum deployment = 16Gi*
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661405808">
<pre class="literallayout"><!--Empty--></pre>
									 </td><td colspan="4" align="left" valign="top" headers="idm140663661404720 idm140663661405808 idm140663661401456"> <p>
										* Each Elasticsearch node can operate with a lower memory setting though this is <span class="strong strong"><strong>not</strong></span> recommended for production deployments. For production use, you should have no less than 16Gi allocated to each pod by default, but preferably allocate as much as you can, up to 64Gi per pod.
									</p>
									 </td></tr></tbody></table></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console as a user with the <code class="literal">cluster-admin</code> role.
							</li><li class="listitem">
								Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span> tab.
							</li><li class="listitem">
								Click the name of your control plane file, for example, <code class="literal">basic-install</code>.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>YAML</strong></span> tab.
							</li><li class="listitem">
								Edit the Jaeger parameters, replacing the default <code class="literal">all-in-one</code> template with parameters for the <code class="literal">production-elasticsearch</code> template, modified for your use case. Ensure that the indentation is correct.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Reload</strong></span>. OpenShift Container Platform redeploys Jaeger and creates the Elasticsearch resources based on the specified parameters.
							</li></ol></div></section><section class="section" id="ossm-configuring-jaeger-existing-v1x_ossm-controler-items-v1x"><div class="titlepage"><div><div><h4 class="title">2.10.5.2. Connecting to an existing Jaeger instance</h4></div></div></div><p>
						In order for the SMCP to connect to an existing Jaeger instance, the following must be true:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The Jaeger instance is deployed in the same namespace as the control plane, for example, into the <code class="literal">istio-system</code> namespace.
							</li><li class="listitem">
								To enable secure communication between services, you should enable the oauth-proxy, which secures communication to your Jaeger instance, and make sure the secret is mounted into your Jaeger instance so Kiali can communicate with it.
							</li><li class="listitem">
								To use a custom or already existing Jaeger instance, set <code class="literal">spec.istio.tracing.enabled</code> to "false" to disable the deployment of a Jaeger instance.
							</li><li class="listitem">
								Supply the correct jaeger-collector endpoint to Mixer by setting <code class="literal">spec.istio.global.tracer.zipkin.address</code> to the hostname and port of your jaeger-collector service. The hostname of the service is usually <code class="literal">&lt;jaeger-instance-name&gt;-collector.&lt;namespace&gt;.svc.cluster.local</code>.
							</li><li class="listitem">
								Supply the correct jaeger-query endpoint to Kiali for gathering traces by setting <code class="literal">spec.istio.kiali.jaegerInClusterURL</code> to the hostname of your jaeger-query service - the port is normally not required, as it uses 443 by default. The hostname of the service is usually <code class="literal">&lt;jaeger-instance-name&gt;-query.&lt;namespace&gt;.svc.cluster.local</code>.
							</li><li class="listitem"><p class="simpara">
								Supply the dashboard URL of your Jaeger instance to Kiali to enable accessing Jaeger through the Kiali console. You can retrieve the URL from the OpenShift route that is created by the Jaeger Operator. If your Jaeger resource is called <code class="literal">external-jaeger</code> and resides in the <code class="literal">istio-system</code> project, you can retrieve the route using the following command:
							</p><pre class="programlisting language-terminal">$ oc get route -n istio-system external-jaeger</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                   HOST/PORT                                     PATH   SERVICES               [...]
external-jaeger        external-jaeger-istio-system.apps.test        external-jaeger-query  [...]</pre>

								</p></div><p class="simpara">
								The value under <code class="literal">HOST/PORT</code> is the externally accessible URL of the Jaeger dashboard.
							</p></li></ul></div><div class="formalpara"><p class="title"><strong>Example Jaeger resource</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: jaegertracing.io/v1
kind: "Jaeger"
metadata:
  name: "external-jaeger"
  # Deploy to the Control Plane Namespace
  namespace: istio-system
spec:
  # Set Up Authentication
  ingress:
    enabled: true
    security: oauth-proxy
    openshift:
      # This limits user access to the Jaeger instance to users who have access
      # to the control plane namespace. Make sure to set the correct namespace here
      sar: '{"namespace": "istio-system", "resource": "pods", "verb": "get"}'
      htpasswdFile: /etc/proxy/htpasswd/auth

  volumeMounts:
  - name: secret-htpasswd
    mountPath: /etc/proxy/htpasswd
  volumes:
  - name: secret-htpasswd
    secret:
      secretName: htpasswd</pre>

						</p></div><p>
						The following <code class="literal">ServiceMeshControlPlane</code> example assumes that you have deployed Jaeger using the Jaeger Operator and the example Jaeger resource.
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">ServiceMeshControlPlane</code> with external Jaeger</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshControlPlane
metadata:
  name: external-jaeger
  namespace: istio-system
spec:
  version: v1.1
  istio:
    tracing:
      # Disable Jaeger deployment by service mesh operator
      enabled: false
    global:
      tracer:
        zipkin:
          # Set Endpoint for Trace Collection
          address: external-jaeger-collector.istio-system.svc.cluster.local:9411
    kiali:
      # Set Jaeger dashboard URL
      dashboard:
        jaegerURL: https://external-jaeger-istio-system.apps.test
      # Set Endpoint for Trace Querying
      jaegerInClusterURL: external-jaeger-query.istio-system.svc.cluster.local</pre>

						</p></div></section><section class="section" id="ossm-jaeger-config-elasticsearch-v1x_ossm-controler-items-v1x"><div class="titlepage"><div><div><h4 class="title">2.10.5.3. Configuring Elasticsearch</h4></div></div></div><p>
						The default Jaeger deployment strategy uses the <code class="literal">all-in-one</code> template so that the installation can be completed using minimal resources. However, because the <code class="literal">all-in-one</code> template uses in-memory storage, it is only recommended for development, demo, or testing purposes and should NOT be used for production environments.
					</p><p>
						If you are deploying Service Mesh and Jaeger in a production environment you must change the template to the <code class="literal">production-elasticsearch</code> template, which uses Elasticsearch for Jaeger’s storage needs.
					</p><p>
						Elasticsearch is a memory intensive application. The initial set of nodes specified in the default OpenShift Container Platform installation may not be large enough to support the Elasticsearch cluster. You should modify the default Elasticsearch configuration to match your use case and the resources you have requested for your OpenShift Container Platform installation. You can adjust both the CPU and memory limits for each component by modifying the resources block with valid CPU and memory values. Additional nodes must be added to the cluster if you want to run with the recommended amount (or more) of memory. Ensure that you do not exceed the resources requested for your OpenShift Container Platform installation.
					</p><div class="formalpara"><p class="title"><strong>Default "production" Jaeger parameters with Elasticsearch</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: maistra.io/v1
kind: ServiceMeshControlPlane
spec:
  istio:
    tracing:
    enabled: true
    ingress:
      enabled: true
    jaeger:
      template: production-elasticsearch
      elasticsearch:
        nodeCount: 3
        redundancyPolicy:
        resources:
          requests:
            cpu: "1"
            memory: "16Gi"
          limits:
            cpu: "1"
            memory: "16Gi"</pre>

						</p></div><div class="table" id="idm140663661269360"><p class="title"><strong>Table 2.13. Elasticsearch parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 20%; " class="col_2"><!--Empty--></col><col style="width: 20%; " class="col_3"><!--Empty--></col><col style="width: 20%; " class="col_4"><!--Empty--></col><col style="width: 20%; " class="col_5"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663661261728" scope="col">Parameter</th><th align="left" valign="top" id="idm140663661260640" scope="col">Description</th><th align="left" valign="top" id="idm140663661259552" scope="col">Values</th><th align="left" valign="top" id="idm140663661258464" scope="col">Default Value</th><th align="left" valign="top" id="idm140663661257376" scope="col">Examples</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663661261728">
<pre class="literallayout">tracing:
  enabled:</pre>
									 </td><td align="left" valign="top" headers="idm140663661260640"> <p>
										This parameter enables/disables tracing in Service Mesh. Jaeger is installed by default.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661259552"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661258464"> <p>
										<code class="literal">true</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661257376"> </td></tr><tr><td align="left" valign="top" headers="idm140663661261728">
<pre class="literallayout">ingress:
  enabled:</pre>
									 </td><td align="left" valign="top" headers="idm140663661260640"> <p>
										This parameter enables/disables ingress for Jaeger.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661259552"> <p>
										<code class="literal">true</code>/<code class="literal">false</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661258464"> <p>
										<code class="literal">true</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661257376"> </td></tr><tr><td align="left" valign="top" headers="idm140663661261728">
<pre class="literallayout">jaeger:
   template:</pre>
									 </td><td align="left" valign="top" headers="idm140663661260640"> <p>
										This parameter specifies which Jaeger deployment strategy to use.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661259552"> <p>
										<code class="literal">all-in-one</code>/<code class="literal">production-elasticsearch</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661258464"> <p>
										<code class="literal">all-in-one</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663661257376"> </td></tr><tr><td align="left" valign="top" headers="idm140663661261728">
<pre class="literallayout">elasticsearch:
  nodeCount:</pre>
									 </td><td align="left" valign="top" headers="idm140663661260640"> <p>
										Number of Elasticsearch nodes to create.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661259552"> <p>
										Integer value.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661258464"> <p>
										1
									</p>
									 </td><td align="left" valign="top" headers="idm140663661257376"> <p>
										Proof of concept = 1, Minimum deployment =3
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661261728">
<pre class="literallayout">requests:
  cpu:</pre>
									 </td><td align="left" valign="top" headers="idm140663661260640"> <p>
										Number of central processing units for requests, based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661259552"> <p>
										Specified in cores or millicores (for example, 200m, 0.5, 1).
									</p>
									 </td><td align="left" valign="top" headers="idm140663661258464"> <p>
										1Gi
									</p>
									 </td><td align="left" valign="top" headers="idm140663661257376"> <p>
										Proof of concept = 500m, Minimum deployment =1
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661261728">
<pre class="literallayout">requests:
  memory:</pre>
									 </td><td align="left" valign="top" headers="idm140663661260640"> <p>
										Available memory for requests, based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661259552"> <p>
										Specified in bytes (for example, 200Ki, 50Mi, 5Gi).
									</p>
									 </td><td align="left" valign="top" headers="idm140663661258464"> <p>
										500m
									</p>
									 </td><td align="left" valign="top" headers="idm140663661257376"> <p>
										Proof of concept = 1Gi, Minimum deployment = 16Gi*
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661261728">
<pre class="literallayout">limits:
  cpu:</pre>
									 </td><td align="left" valign="top" headers="idm140663661260640"> <p>
										Limit on number of central processing units, based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661259552"> <p>
										Specified in cores or millicores (for example, 200m, 0.5, 1).
									</p>
									 </td><td align="left" valign="top" headers="idm140663661258464"> </td><td align="left" valign="top" headers="idm140663661257376"> <p>
										Proof of concept = 500m, Minimum deployment =1
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661261728">
<pre class="literallayout">limits:
  memory:</pre>
									 </td><td align="left" valign="top" headers="idm140663661260640"> <p>
										Available memory limit based on your environment’s configuration.
									</p>
									 </td><td align="left" valign="top" headers="idm140663661259552"> <p>
										Specified in bytes (for example, 200Ki, 50Mi, 5Gi).
									</p>
									 </td><td align="left" valign="top" headers="idm140663661258464"> </td><td align="left" valign="top" headers="idm140663661257376"> <p>
										Proof of concept = 1Gi, Minimum deployment = 16Gi*
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663661261728">
<pre class="literallayout"><!--Empty--></pre>
									 </td><td colspan="4" align="left" valign="top" headers="idm140663661260640 idm140663661261728 idm140663661257376"> <p>
										* Each Elasticsearch node can operate with a lower memory setting though this is <span class="strong strong"><strong>not</strong></span> recommended for production deployments. For production use, you should have no less than 16Gi allocated to each pod by default, but preferably allocate as much as you can, up to 64Gi per pod.
									</p>
									 </td></tr></tbody></table></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console as a user with the <code class="literal">cluster-admin</code> role.
							</li><li class="listitem">
								Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click the Red Hat OpenShift Service Mesh Operator.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Istio Service Mesh Control Plane</strong></span> tab.
							</li><li class="listitem">
								Click the name of your control plane file, for example, <code class="literal">basic-install</code>.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>YAML</strong></span> tab.
							</li><li class="listitem">
								Edit the Jaeger parameters, replacing the default <code class="literal">all-in-one</code> template with parameters for the <code class="literal">production-elasticsearch</code> template, modified for your use case. Ensure that the indentation is correct.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Reload</strong></span>. OpenShift Container Platform redeploys Jaeger and creates the Elasticsearch resources based on the specified parameters.
							</li></ol></div></section><section class="section" id="ossm-jaeger-config-es-cleaner-v1x_ossm-controler-items-v1x"><div class="titlepage"><div><div><h4 class="title">2.10.5.4. Configuring the Elasticsearch index cleaner job</h4></div></div></div><p>
						When the Service Mesh Operator creates the <code class="literal">ServiceMeshControlPlane</code> it also creates the custom resource (CR) for Jaeger. The Red Hat OpenShift distributed tracing platform (Jaeger) Operator then uses this CR when creating Jaeger instances.
					</p><p>
						When using Elasticsearch storage, by default a job is created to clean old traces from it. To configure the options for this job, you edit the Jaeger custom resource (CR), to customize it for your use case. The relevant options are listed below.
					</p><pre class="programlisting language-yaml">  apiVersion: jaegertracing.io/v1
  kind: Jaeger
  spec:
    strategy: production
    storage:
      type: elasticsearch
      esIndexCleaner:
        enabled: false
        numberOfDays: 7
        schedule: "55 23 * * *"</pre><div class="table" id="idm140663645560912"><p class="title"><strong>Table 2.14. Elasticsearch index cleaner parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663645555136" scope="col">Parameter</th><th align="left" valign="top" id="idm140663645554048" scope="col">Values</th><th align="left" valign="top" id="idm140663645552960" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663645555136"> <p>
										enabled:
									</p>
									 </td><td align="left" valign="top" headers="idm140663645554048"> <p>
										true/ false
									</p>
									 </td><td align="left" valign="top" headers="idm140663645552960"> <p>
										Enable or disable the index cleaner job.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663645555136"> <p>
										numberOfDays:
									</p>
									 </td><td align="left" valign="top" headers="idm140663645554048"> <p>
										integer value
									</p>
									 </td><td align="left" valign="top" headers="idm140663645552960"> <p>
										Number of days to wait before deleting an index.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663645555136"> <p>
										schedule:
									</p>
									 </td><td align="left" valign="top" headers="idm140663645554048"> <p>
										"55 23 * * *"
									</p>
									 </td><td align="left" valign="top" headers="idm140663645552960"> <p>
										Cron expression for the job to run
									</p>
									 </td></tr></tbody></table></div></div><p>
						For more information about configuring Elasticsearch with OpenShift Container Platform, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/logging/#configuring-the-log-store">Configuring the log store</a>.
					</p></section></section><section class="section" id="ossm-cr-threescale_ossm-controler-items-v1x"><div class="titlepage"><div><div><h3 class="title">2.10.6. 3scale configuration</h3></div></div></div><p>
					The following table explains the parameters for the 3scale Istio Adapter in the <code class="literal">ServiceMeshControlPlane</code> resource.
				</p><div class="formalpara"><p class="title"><strong>Example 3scale parameters</strong></p><p>
						
<pre class="programlisting language-yaml">spec:
  addons:
    3Scale:
      enabled: false
      PARAM_THREESCALE_LISTEN_ADDR: 3333
      PARAM_THREESCALE_LOG_LEVEL: info
      PARAM_THREESCALE_LOG_JSON: true
      PARAM_THREESCALE_LOG_GRPC: false
      PARAM_THREESCALE_REPORT_METRICS: true
      PARAM_THREESCALE_METRICS_PORT: 8080
      PARAM_THREESCALE_CACHE_TTL_SECONDS: 300
      PARAM_THREESCALE_CACHE_REFRESH_SECONDS: 180
      PARAM_THREESCALE_CACHE_ENTRIES_MAX: 1000
      PARAM_THREESCALE_CACHE_REFRESH_RETRIES: 1
      PARAM_THREESCALE_ALLOW_INSECURE_CONN: false
      PARAM_THREESCALE_CLIENT_TIMEOUT_SECONDS: 10
      PARAM_THREESCALE_GRPC_CONN_MAX_SECONDS: 60
      PARAM_USE_CACHED_BACKEND: false
      PARAM_BACKEND_CACHE_FLUSH_INTERVAL_SECONDS: 15
      PARAM_BACKEND_CACHE_POLICY_FAIL_CLOSED: true</pre>

					</p></div><div class="table" id="idm140663645527488"><p class="title"><strong>Table 2.15. 3scale parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663645520800" scope="col">Parameter</th><th align="left" valign="top" id="idm140663645519712" scope="col">Description</th><th align="left" valign="top" id="idm140663645518624" scope="col">Values</th><th align="left" valign="top" id="idm140663645517536" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">enabled</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									Whether to use the 3scale adapter
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									<code class="literal">false</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">PARAM_THREESCALE_LISTEN_ADDR</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									Sets the listen address for the gRPC server
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									Valid port number
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									<code class="literal">3333</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">PARAM_THREESCALE_LOG_LEVEL</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									Sets the minimum log output level.
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									<code class="literal">debug</code>, <code class="literal">info</code>, <code class="literal">warn</code>, <code class="literal">error</code>, or <code class="literal">none</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									<code class="literal">info</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">PARAM_THREESCALE_LOG_JSON</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									Controls whether the log is formatted as JSON
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									<code class="literal">true</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">PARAM_THREESCALE_LOG_GRPC</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									Controls whether the log contains gRPC info
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									<code class="literal">true</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">PARAM_THREESCALE_REPORT_METRICS</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									Controls whether 3scale system and backend metrics are collected and reported to Prometheus
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									<code class="literal">true</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">PARAM_THREESCALE_METRICS_PORT</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									Sets the port that the 3scale <code class="literal">/metrics</code> endpoint can be scrapped from
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									Valid port number
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									<code class="literal">8080</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">PARAM_THREESCALE_CACHE_TTL_SECONDS</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									Time period, in seconds, to wait before purging expired items from the cache
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									Time period in seconds
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									<code class="literal">300</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">PARAM_THREESCALE_CACHE_REFRESH_SECONDS</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									Time period before expiry when cache elements are attempted to be refreshed
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									Time period in seconds
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									<code class="literal">180</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">PARAM_THREESCALE_CACHE_ENTRIES_MAX</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									Max number of items that can be stored in the cache at any time. Set to <code class="literal">0</code> to disable caching
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									Valid number
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									<code class="literal">1000</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">PARAM_THREESCALE_CACHE_REFRESH_RETRIES</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									The number of times unreachable hosts are retried during a cache update loop
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									Valid number
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									<code class="literal">1</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">PARAM_THREESCALE_ALLOW_INSECURE_CONN</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									Allow to skip certificate verification when calling <code class="literal">3scale</code> APIs. Enabling this is not recommended.
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									<code class="literal">false</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">PARAM_THREESCALE_CLIENT_TIMEOUT_SECONDS</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									Sets the number of seconds to wait before terminating requests to 3scale System and Backend
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									Time period in seconds
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									<code class="literal">10</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">PARAM_THREESCALE_GRPC_CONN_MAX_SECONDS</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									Sets the maximum amount of seconds (+/-10% jitter) a connection may exist before it is closed
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									Time period in seconds
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									60
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">PARAM_USE_CACHE_BACKEND</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									If true, attempt to create an in-memory apisonator cache for authorization requests
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									<code class="literal">false</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">PARAM_BACKEND_CACHE_FLUSH_INTERVAL_SECONDS</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									If the backend cache is enabled, this sets the interval in seconds for flushing the cache against 3scale
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									Time period in seconds
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									15
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140663645520800"> <p>
									<code class="literal">PARAM_BACKEND_CACHE_POLICY_FAIL_CLOSED</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645519712"> <p>
									Whenever the backend cache cannot retrieve authorization data, whether to deny (closed) or allow (open) requests
								</p>
								 </td><td align="left" valign="top" headers="idm140663645518624"> <p>
									<code class="literal">true</code>/<code class="literal">false</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140663645517536"> <p>
									<code class="literal">true</code>
								</p>
								 </td></tr></tbody></table></div></div></section></section><section class="section" id="threescale-adapter-v1x"><div class="titlepage"><div><div><h2 class="title">2.11. Using the 3scale Istio adapter</h2></div></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					<span class="strong strong"><strong>You are viewing documentation for a Red Hat OpenShift Service Mesh release that is no longer supported.</strong></span>
				</p><p>
					Service Mesh version 1.0 and 1.1 control planes are no longer supported. For information about upgrading your service mesh control plane, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-versions_ossm-upgrade">Upgrading Service Mesh</a>.
				</p><p>
					For information about the support status of a particular Red Hat OpenShift Service Mesh release, see the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ossm">Product lifecycle page</a>.
				</p></div></div><p>
				The 3scale Istio Adapter is an optional adapter that allows you to label a service running within the Red Hat OpenShift Service Mesh and integrate that service with the 3scale API Management solution. It is not required for Red Hat OpenShift Service Mesh.
			</p><section class="section" id="ossm-threescale-integrate-1x_threescale-adapter-v1x"><div class="titlepage"><div><div><h3 class="title">2.11.1. Integrate the 3scale adapter with Red Hat OpenShift Service Mesh</h3></div></div></div><p>
					You can use these examples to configure requests to your services using the 3scale Istio Adapter.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites:</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Red Hat OpenShift Service Mesh version 1.x
						</li><li class="listitem">
							A working 3scale account (<a class="link" href="https://www.3scale.net/signup/">SaaS</a> or <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_3scale_api_management/2.5/html/installing_3scale/onpremises-installation">3scale 2.5 On-Premises</a>)
						</li><li class="listitem">
							Enabling backend cache requires 3scale 2.9 or greater
						</li><li class="listitem">
							Red Hat OpenShift Service Mesh prerequisites
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						To configure the 3scale Istio Adapter, refer to Red Hat OpenShift Service Mesh custom resources for instructions on adding adapter parameters to the custom resource file.
					</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Pay particular attention to the <code class="literal">kind: handler</code> resource. You must update this with your 3scale account credentials. You can optionally add a <code class="literal">service_id</code> to a handler, but this is kept for backwards compatibility only, since it would render the handler only useful for one service in your 3scale account. If you add <code class="literal">service_id</code> to a handler, enabling 3scale for other services requires you to create more handlers with different <code class="literal">service_ids</code>.
					</p></div></div><p>
					Use a single handler per 3scale account by following the steps below:
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a handler for your 3scale account and specify your account credentials. Omit any service identifier.
						</p><pre class="programlisting language-yaml">  apiVersion: "config.istio.io/v1alpha2"
  kind: handler
  metadata:
   name: threescale
  spec:
   adapter: threescale
   params:
     system_url: "https://&lt;organization&gt;-admin.3scale.net/"
     access_token: "&lt;ACCESS_TOKEN&gt;"
   connection:
     address: "threescale-istio-adapter:3333"</pre><p class="simpara">
							Optionally, you can provide a <code class="literal">backend_url</code> field within the <span class="emphasis"><em>params</em></span> section to override the URL provided by the 3scale configuration. This may be useful if the adapter runs on the same cluster as the 3scale on-premise instance, and you wish to leverage the internal cluster DNS.
						</p></li><li class="listitem"><p class="simpara">
							Edit or patch the Deployment resource of any services belonging to your 3scale account as follows:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Add the <code class="literal">"service-mesh.3scale.net/service-id"</code> label with a value corresponding to a valid <code class="literal">service_id</code>.
								</li><li class="listitem">
									Add the <code class="literal">"service-mesh.3scale.net/credentials"</code> label with its value being the <span class="emphasis"><em>name of the handler resource</em></span> from step 1.
								</li></ol></div></li><li class="listitem">
							Do step 2 to link it to your 3scale account credentials and to its service identifier, whenever you intend to add more services.
						</li><li class="listitem"><p class="simpara">
							Modify the rule configuration with your 3scale configuration to dispatch the rule to the threescale handler.
						</p><div class="formalpara"><p class="title"><strong>Rule configuration example</strong></p><p>
								
<pre class="programlisting language-yaml">  apiVersion: "config.istio.io/v1alpha2"
  kind: rule
  metadata:
    name: threescale
  spec:
    match: destination.labels["service-mesh.3scale.net"] == "true"
    actions:
      - handler: threescale.handler
        instances:
          - threescale-authorization.instance</pre>

							</p></div></li></ol></div><section class="section" id="ossm-threescale-cr_threescale-adapter-v1x"><div class="titlepage"><div><div><h4 class="title">2.11.1.1. Generating 3scale custom resources</h4></div></div></div><p>
						The adapter includes a tool that allows you to generate the <code class="literal">handler</code>, <code class="literal">instance</code>, and <code class="literal">rule</code> custom resources.
					</p><div class="table" id="idm140663645332800"><p class="title"><strong>Table 2.16. Usage</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140663645326112" scope="col">Option</th><th align="left" valign="top" id="idm140663645325024" scope="col">Description</th><th align="left" valign="top" id="idm140663645323936" scope="col">Required</th><th align="left" valign="top" id="idm140663645322848" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140663645326112"> <p>
										<code class="literal">-h, --help</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663645325024"> <p>
										Produces help output for available options
									</p>
									 </td><td align="left" valign="top" headers="idm140663645323936"> <p>
										No
									</p>
									 </td><td align="left" valign="top" headers="idm140663645322848"> </td></tr><tr><td align="left" valign="top" headers="idm140663645326112"> <p>
										<code class="literal">--name</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663645325024"> <p>
										Unique name for this URL, token pair
									</p>
									 </td><td align="left" valign="top" headers="idm140663645323936"> <p>
										Yes
									</p>
									 </td><td align="left" valign="top" headers="idm140663645322848"> </td></tr><tr><td align="left" valign="top" headers="idm140663645326112"> <p>
										<code class="literal">-n, --namespace</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663645325024"> <p>
										Namespace to generate templates
									</p>
									 </td><td align="left" valign="top" headers="idm140663645323936"> <p>
										No
									</p>
									 </td><td align="left" valign="top" headers="idm140663645322848"> <p>
										istio-system
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663645326112"> <p>
										<code class="literal">-t, --token</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663645325024"> <p>
										3scale access token
									</p>
									 </td><td align="left" valign="top" headers="idm140663645323936"> <p>
										Yes
									</p>
									 </td><td align="left" valign="top" headers="idm140663645322848"> </td></tr><tr><td align="left" valign="top" headers="idm140663645326112"> <p>
										<code class="literal">-u, --url</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663645325024"> <p>
										3scale Admin Portal URL
									</p>
									 </td><td align="left" valign="top" headers="idm140663645323936"> <p>
										Yes
									</p>
									 </td><td align="left" valign="top" headers="idm140663645322848"> </td></tr><tr><td align="left" valign="top" headers="idm140663645326112"> <p>
										<code class="literal">--backend-url</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663645325024"> <p>
										3scale backend URL. If set, it overrides the value that is read from system configuration
									</p>
									 </td><td align="left" valign="top" headers="idm140663645323936"> <p>
										No
									</p>
									 </td><td align="left" valign="top" headers="idm140663645322848"> </td></tr><tr><td align="left" valign="top" headers="idm140663645326112"> <p>
										<code class="literal">-s, --service</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663645325024"> <p>
										3scale API/Service ID
									</p>
									 </td><td align="left" valign="top" headers="idm140663645323936"> <p>
										No
									</p>
									 </td><td align="left" valign="top" headers="idm140663645322848"> </td></tr><tr><td align="left" valign="top" headers="idm140663645326112"> <p>
										<code class="literal">--auth</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663645325024"> <p>
										3scale authentication pattern to specify (1=API Key, 2=App Id/App Key, 3=OIDC)
									</p>
									 </td><td align="left" valign="top" headers="idm140663645323936"> <p>
										No
									</p>
									 </td><td align="left" valign="top" headers="idm140663645322848"> <p>
										Hybrid
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663645326112"> <p>
										<code class="literal">-o, --output</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663645325024"> <p>
										File to save produced manifests to
									</p>
									 </td><td align="left" valign="top" headers="idm140663645323936"> <p>
										No
									</p>
									 </td><td align="left" valign="top" headers="idm140663645322848"> <p>
										Standard output
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140663645326112"> <p>
										<code class="literal">--version</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140663645325024"> <p>
										Outputs the CLI version and exits immediately
									</p>
									 </td><td align="left" valign="top" headers="idm140663645323936"> <p>
										No
									</p>
									 </td><td align="left" valign="top" headers="idm140663645322848"> </td></tr></tbody></table></div></div><section class="section" id="ossm-threescale-templates_threescale-adapter-v1x"><div class="titlepage"><div><div><h5 class="title">2.11.1.1.1. Generate templates from URL examples</h5></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Run the following commands via <code class="literal">oc exec</code> from the 3scale adapter container image in <a class="link" href="#ossm-threescale-manifests_threescale-adapter-v1x" title="2.11.1.2. Generating manifests from a deployed adapter">Generating manifests from a deployed adapter</a>.
									</li><li class="listitem">
										Use the <code class="literal">3scale-config-gen</code> command to help avoid YAML syntax and indentation errors.
									</li><li class="listitem">
										You can omit the <code class="literal">--service</code> if you use the annotations.
									</li><li class="listitem">
										This command must be invoked from within the container image via <code class="literal">oc exec</code>.
									</li></ul></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Use the <code class="literal">3scale-config-gen</code> command to autogenerate templates files allowing the token, URL pair to be shared by multiple services as a single handler:
								</p><pre class="screen">$ 3scale-config-gen --name=admin-credentials --url="https://&lt;organization&gt;-admin.3scale.net:443" --token="[redacted]"</pre></li><li class="listitem"><p class="simpara">
									The following example generates the templates with the service ID embedded in the handler:
								</p><pre class="screen">$ 3scale-config-gen --url="https://&lt;organization&gt;-admin.3scale.net" --name="my-unique-id" --service="123456789" --token="[redacted]"</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_3scale_api_management/2.10/html-single/admin_portal_guide/index#tokens">Tokens</a>.
								</li></ul></div></section></section><section class="section" id="ossm-threescale-manifests_threescale-adapter-v1x"><div class="titlepage"><div><div><h4 class="title">2.11.1.2. Generating manifests from a deployed adapter</h4></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">NAME</code> is an identifier you use to identify with the service you are managing with 3scale.
								</li><li class="listitem">
									The <code class="literal">CREDENTIALS_NAME</code> reference is an identifier that corresponds to the <code class="literal">match</code> section in the rule configuration. This is automatically set to the <code class="literal">NAME</code> identifier if you are using the CLI tool.
								</li><li class="listitem">
									Its value does not need to be anything specific: the label value should just match the contents of the rule. See <a class="link" href="https://github.com/3scale/3scale-istio-adapter/blob/v2.X/README.md#routing-service-traffic-through-the-adapter">Routing service traffic through the adapter</a> for more information.
								</li></ul></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Run this command to generate manifests from a deployed adapter in the <code class="literal">istio-system</code> namespace:
							</p><pre class="screen">$ export NS="istio-system" URL="https://replaceme-admin.3scale.net:443" NAME="name" TOKEN="token"
oc exec -n ${NS} $(oc get po -n ${NS} -o jsonpath='{.items[?(@.metadata.labels.app=="3scale-istio-adapter")].metadata.name}') \
-it -- ./3scale-config-gen \
--url ${URL} --name ${NAME} --token ${TOKEN} -n ${NS}</pre></li><li class="listitem">
								This will produce sample output to the terminal. Edit these samples if required and create the objects using the <code class="literal">oc create</code> command.
							</li><li class="listitem"><p class="simpara">
								When the request reaches the adapter, the adapter needs to know how the service maps to an API on 3scale. You can provide this information in two ways:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Label the workload (recommended)
									</li><li class="listitem">
										Hard code the handler as <code class="literal">service_id</code>
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Update the workload with the required annotations:
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									You only need to update the service ID provided in this example if it is not already embedded in the handler. <span class="strong strong"><strong>The setting in the handler takes precedence</strong></span>.
								</p></div></div><pre class="screen">$ export CREDENTIALS_NAME="replace-me"
export SERVICE_ID="replace-me"
export DEPLOYMENT="replace-me"
patch="$(oc get deployment "${DEPLOYMENT}"
patch="$(oc get deployment "${DEPLOYMENT}" --template='{"spec":{"template":{"metadata":{"labels":{ {{ range $k,$v := .spec.template.metadata.labels }}"{{ $k }}":"{{ $v }}",{{ end }}"service-mesh.3scale.net/service-id":"'"${SERVICE_ID}"'","service-mesh.3scale.net/credentials":"'"${CREDENTIALS_NAME}"'"}}}}}' )"
oc patch deployment "${DEPLOYMENT}" --patch ''"${patch}"''</pre></li></ol></div></section><section class="section" id="ossm-threescale-routing_threescale-adapter-v1x"><div class="titlepage"><div><div><h4 class="title">2.11.1.3. Routing service traffic through the adapter</h4></div></div></div><p>
						Follow these steps to drive traffic for your service through the 3scale adapter.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Credentials and service ID from your 3scale administrator.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Match the rule <code class="literal">destination.labels["service-mesh.3scale.net/credentials"] == "threescale"</code> that you previously created in the configuration, in the <code class="literal">kind: rule</code> resource.
							</li><li class="listitem">
								Add the above label to <code class="literal">PodTemplateSpec</code> on the Deployment of the target workload to integrate a service. the value, <code class="literal">threescale</code>, refers to the name of the generated handler. This handler stores the access token required to call 3scale.
							</li><li class="listitem">
								Add the <code class="literal">destination.labels["service-mesh.3scale.net/service-id"] == "replace-me"</code> label to the workload to pass the service ID to the adapter via the instance at request time.
							</li></ol></div></section></section><section class="section" id="ossm-threescale-integration-settings_threescale-adapter-v1x"><div class="titlepage"><div><div><h3 class="title">2.11.2. Configure the integration settings in 3scale</h3></div></div></div><p>
					Follow this procedure to configure the 3scale integration settings.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						For 3scale SaaS customers, Red Hat OpenShift Service Mesh is enabled as part of the Early Access program.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to <span class="strong strong"><strong>[your_API_name]</strong></span> → <span class="strong strong"><strong>Integration</strong></span>
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Settings</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Select the <span class="strong strong"><strong>Istio</strong></span> option under <span class="emphasis"><em>Deployment</em></span>.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The <span class="strong strong"><strong>API Key (user_key)</strong></span> option under <span class="emphasis"><em>Authentication</em></span> is selected by default.
								</li></ul></div></li><li class="listitem">
							Click <span class="strong strong"><strong>Update Product</strong></span> to save your selection.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Configuration</strong></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Update Configuration</strong></span>.
						</li></ol></div></section><section class="section" id="ossm-threescale-caching_threescale-adapter-v1x"><div class="titlepage"><div><div><h3 class="title">2.11.3. Caching behavior</h3></div></div></div><p>
					Responses from 3scale System APIs are cached by default within the adapter. Entries will be purged from the cache when they become older than the <code class="literal">cacheTTLSeconds</code> value. Also by default, automatic refreshing of cached entries will be attempted seconds before they expire, based on the <code class="literal">cacheRefreshSeconds</code> value. You can disable automatic refreshing by setting this value higher than the <code class="literal">cacheTTLSeconds</code> value.
				</p><p>
					Caching can be disabled entirely by setting <code class="literal">cacheEntriesMax</code> to a non-positive value.
				</p><p>
					By using the refreshing process, cached values whose hosts become unreachable will be retried before eventually being purged when past their expiry.
				</p></section><section class="section" id="ossm-threescale-authentication_threescale-adapter-v1x"><div class="titlepage"><div><div><h3 class="title">2.11.4. Authenticating requests</h3></div></div></div><p>
					This release supports the following authentication methods:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Standard API Keys</strong></span>: single randomized strings or hashes acting as an identifier and a secret token.
						</li><li class="listitem">
							<span class="strong strong"><strong>Application identifier and key pairs</strong></span>: immutable identifier and mutable secret key strings.
						</li><li class="listitem">
							<span class="strong strong"><strong>OpenID authentication method</strong></span>: client ID string parsed from the JSON Web Token.
						</li></ul></div><section class="section" id="ossm-threescale-authentication-patterns_threescale-adapter-v1x"><div class="titlepage"><div><div><h4 class="title">2.11.4.1. Applying authentication patterns</h4></div></div></div><p>
						Modify the <code class="literal">instance</code> custom resource, as illustrated in the following authentication method examples, to configure authentication behavior. You can accept the authentication credentials from:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Request headers
							</li><li class="listitem">
								Request parameters
							</li><li class="listitem">
								Both request headers and query parameters
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When specifying values from headers, they must be lower case. For example, if you want to send a header as <code class="literal">User-Key</code>, this must be referenced in the configuration as <code class="literal">request.headers["user-key"]</code>.
						</p></div></div><section class="section" id="ossm-threescale-apikey-authentication_threescale-adapter-v1x"><div class="titlepage"><div><div><h5 class="title">2.11.4.1.1. API key authentication method</h5></div></div></div><p>
							Service Mesh looks for the API key in query parameters and request headers as specified in the <code class="literal">user</code> option in the <code class="literal">subject</code> custom resource parameter. It checks the values in the order given in the custom resource file. You can restrict the search for the API key to either query parameters or request headers by omitting the unwanted option.
						</p><p>
							In this example, Service Mesh looks for the API key in the <code class="literal">user_key</code> query parameter. If the API key is not in the query parameter, Service Mesh then checks the <code class="literal">user-key</code> header.
						</p><div class="formalpara"><p class="title"><strong>API key authentication method example</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: "config.istio.io/v1alpha2"
kind: instance
metadata:
  name: threescale-authorization
  namespace: istio-system
spec:
  template: authorization
  params:
    subject:
      user: request.query_params["user_key"] | request.headers["user-key"] | ""
    action:
      path: request.url_path
      method: request.method | "get"</pre>

							</p></div><p>
							If you want the adapter to examine a different query parameter or request header, change the name as appropriate. For example, to check for the API key in a query parameter named “key”, change <code class="literal">request.query_params["user_key"]</code> to <code class="literal">request.query_params["key"]</code>.
						</p></section><section class="section" id="ossm-threescale-appidapikey-authentication_threescale-adapter-v1x"><div class="titlepage"><div><div><h5 class="title">2.11.4.1.2. Application ID and application key pair authentication method</h5></div></div></div><p>
							Service Mesh looks for the application ID and application key in query parameters and request headers, as specified in the <code class="literal">properties</code> option in the <code class="literal">subject</code> custom resource parameter. The application key is optional. It checks the values in the order given in the custom resource file. You can restrict the search for the credentials to either query parameters or request headers by not including the unwanted option.
						</p><p>
							In this example, Service Mesh looks for the application ID and application key in the query parameters first, moving on to the request headers if needed.
						</p><div class="formalpara"><p class="title"><strong>Application ID and application key pair authentication method example</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: "config.istio.io/v1alpha2"
kind: instance
metadata:
  name: threescale-authorization
  namespace: istio-system
spec:
  template: authorization
  params:
    subject:
        app_id: request.query_params["app_id"] | request.headers["app-id"] | ""
        app_key: request.query_params["app_key"] | request.headers["app-key"] | ""
    action:
      path: request.url_path
      method: request.method | "get"</pre>

							</p></div><p>
							If you want the adapter to examine a different query parameter or request header, change the name as appropriate. For example, to check for the application ID in a query parameter named <code class="literal">identification</code>, change <code class="literal">request.query_params["app_id"]</code> to <code class="literal">request.query_params["identification"]</code>.
						</p></section><section class="section" id="ossm-threescale-openid-authentication_threescale-adapter-v1x"><div class="titlepage"><div><div><h5 class="title">2.11.4.1.3. OpenID authentication method</h5></div></div></div><p>
							To use the <span class="emphasis"><em>OpenID Connect (OIDC) authentication method</em></span>, use the <code class="literal">properties</code> value on the <code class="literal">subject</code> field to set <code class="literal">client_id</code>, and optionally <code class="literal">app_key</code>.
						</p><p>
							You can manipulate this object using the methods described previously. In the example configuration shown below, the client identifier (application ID) is parsed from the JSON Web Token (JWT) under the label <span class="emphasis"><em>azp</em></span>. You can modify this as needed.
						</p><div class="formalpara"><p class="title"><strong>OpenID authentication method example</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: "config.istio.io/v1alpha2"
kind: instance
metadata:
  name: threescale-authorization
spec:
  template: threescale-authorization
  params:
    subject:
      properties:
        app_key: request.query_params["app_key"] | request.headers["app-key"] | ""
        client_id: request.auth.claims["azp"] | ""
      action:
        path: request.url_path
        method: request.method | "get"
        service: destination.labels["service-mesh.3scale.net/service-id"] | ""</pre>

							</p></div><p>
							For this integration to work correctly, OIDC must still be done in 3scale for the client to be created in the identity provider (IdP). You should create a <a class="link" href="https://istio.io/latest/docs/tasks/security/authorization/authz-jwt/">Request authorization</a> for the service you want to protect in the same namespace as that service. The JWT is passed in the <code class="literal">Authorization</code> header of the request.
						</p><p>
							In the sample <code class="literal">RequestAuthentication</code> defined below, replace <code class="literal">issuer</code>, <code class="literal">jwksUri</code>, and <code class="literal">selector</code> as appropriate.
						</p><div class="formalpara"><p class="title"><strong>OpenID Policy example</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: security.istio.io/v1beta1
kind: RequestAuthentication
metadata:
  name: jwt-example
  namespace: bookinfo
spec:
  selector:
    matchLabels:
      app: productpage
  jwtRules:
  - issuer: &gt;-
      http://keycloak-keycloak.34.242.107.254.nip.io/auth/realms/3scale-keycloak
    jwksUri: &gt;-
      http://keycloak-keycloak.34.242.107.254.nip.io/auth/realms/3scale-keycloak/protocol/openid-connect/certs</pre>

							</p></div></section><section class="section" id="ossm-threescale-hybrid-authentication_threescale-adapter-v1x"><div class="titlepage"><div><div><h5 class="title">2.11.4.1.4. Hybrid authentication method</h5></div></div></div><p>
							You can choose to not enforce a particular authentication method and accept any valid credentials for either method. If both an API key and an application ID/application key pair are provided, Service Mesh uses the API key.
						</p><p>
							In this example, Service Mesh checks for an API key in the query parameters, then the request headers. If there is no API key, it then checks for an application ID and key in the query parameters, then the request headers.
						</p><div class="formalpara"><p class="title"><strong>Hybrid authentication method example</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: "config.istio.io/v1alpha2"
kind: instance
metadata:
  name: threescale-authorization
spec:
  template: authorization
  params:
    subject:
      user: request.query_params["user_key"] | request.headers["user-key"] |
      properties:
        app_id: request.query_params["app_id"] | request.headers["app-id"] | ""
        app_key: request.query_params["app_key"] | request.headers["app-key"] | ""
        client_id: request.auth.claims["azp"] | ""
    action:
      path: request.url_path
      method: request.method | "get"
      service: destination.labels["service-mesh.3scale.net/service-id"] | ""</pre>

							</p></div></section></section></section><section class="section" id="ossm-threescale-metrics-1x_threescale-adapter-v1x"><div class="titlepage"><div><div><h3 class="title">2.11.5. 3scale Adapter metrics</h3></div></div></div><p>
					The adapter, by default reports various Prometheus metrics that are exposed on port <code class="literal">8080</code> at the <code class="literal">/metrics</code> endpoint. These metrics provide insight into how the interactions between the adapter and 3scale are performing. The service is labeled to be automatically discovered and scraped by Prometheus.
				</p></section><section class="section" id="ossm-threescale-istio-adapter-verification_threescale-adapter-v1x"><div class="titlepage"><div><div><h3 class="title">2.11.6. 3scale Istio adapter verification</h3></div></div></div><p>
					You might want to check whether the 3scale Istio adapter is working as expected. If your adapter is not working, use the following steps to help troubleshoot the problem.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Ensure the <span class="emphasis"><em>3scale-adapter</em></span> pod is running in the Service Mesh control plane namespace:
						</p><pre class="programlisting language-terminal">$ oc get pods -n &lt;istio-system&gt;</pre></li><li class="listitem"><p class="simpara">
							Check that the <span class="emphasis"><em>3scale-adapter</em></span> pod has printed out information about itself booting up, such as its version:
						</p><pre class="programlisting language-terminal">$ oc logs &lt;istio-system&gt;</pre></li><li class="listitem">
							When performing requests to the services protected by the 3scale adapter integration, always try requests that lack the right credentials and ensure they fail. Check the 3scale adapter logs to gather additional information.
						</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://docs.openshift.com/container-platform/4.7/support/troubleshooting/investigating-pod-issues.html#inspecting-pod-and-container-logs_investigating-pod-issues">Inspecting pod and container logs</a>.
						</li></ul></div></section><section class="section" id="ossm-threescale-istio-adapter-troubleshooting-checklist_threescale-adapter-v1x"><div class="titlepage"><div><div><h3 class="title">2.11.7. 3scale Istio adapter troubleshooting checklist</h3></div></div></div><p>
					As the administrator installing the 3scale Istio adapter, there are a number of scenarios that might be causing your integration to not function properly. Use the following list to troubleshoot your installation:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Incorrect YAML indentation.
						</li><li class="listitem">
							Missing YAML sections.
						</li><li class="listitem">
							Forgot to apply the changes in the YAML to the cluster.
						</li><li class="listitem">
							Forgot to label the service workloads with the <code class="literal">service-mesh.3scale.net/credentials</code> key.
						</li><li class="listitem">
							Forgot to label the service workloads with <code class="literal">service-mesh.3scale.net/service-id</code> when using handlers that do not contain a <code class="literal">service_id</code> so they are reusable per account.
						</li><li class="listitem">
							The <span class="emphasis"><em>Rule</em></span> custom resource points to the wrong handler or instance custom resources, or the references lack the corresponding namespace suffix.
						</li><li class="listitem">
							The <span class="emphasis"><em>Rule</em></span> custom resource <code class="literal">match</code> section cannot possibly match the service you are configuring, or it points to a destination workload that is not currently running or does not exist.
						</li><li class="listitem">
							Wrong access token or URL for the 3scale Admin Portal in the handler.
						</li><li class="listitem">
							The <span class="emphasis"><em>Instance</em></span> custom resource’s <code class="literal">params/subject/properties</code> section fails to list the right parameters for <code class="literal">app_id</code>, <code class="literal">app_key</code>, or <code class="literal">client_id</code>, either because they specify the wrong location such as the query parameters, headers, and authorization claims, or the parameter names do not match the requests used for testing.
						</li><li class="listitem">
							Failing to use the configuration generator without realizing that it actually lives in the adapter container image and needs <code class="literal">oc exec</code> to invoke it.
						</li></ul></div></section></section><section class="section" id="removing-ossm-v1x"><div class="titlepage"><div><div><h2 class="title">2.12. Removing Service Mesh</h2></div></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					<span class="strong strong"><strong>You are viewing documentation for a Red Hat OpenShift Service Mesh release that is no longer supported.</strong></span>
				</p><p>
					Service Mesh version 1.0 and 1.1 control planes are no longer supported. For information about upgrading your service mesh control plane, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/service_mesh/#ossm-versions_ossm-upgrade">Upgrading Service Mesh</a>.
				</p><p>
					For information about the support status of a particular Red Hat OpenShift Service Mesh release, see the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ossm">Product lifecycle page</a>.
				</p></div></div><p>
				To remove Red Hat OpenShift Service Mesh from an existing OpenShift Container Platform instance, remove the control plane before removing the operators.
			</p><section class="section" id="ossm-control-plane-remove_removing-ossm-v1x"><div class="titlepage"><div><div><h3 class="title">2.12.1. Removing the Red Hat OpenShift Service Mesh control plane</h3></div></div></div><p>
					To uninstall Service Mesh from an existing OpenShift Container Platform instance, first you delete the Service Mesh control plane and the Operators. Then, you run commands to remove residual resources.
				</p><section class="section" id="ossm-control-plane-remove-operatorhub_removing-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.12.1.1. Removing the Service Mesh control plane using the web console</h4></div></div></div><p>
						You can remove the Red Hat OpenShift Service Mesh control plane by using the web console.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Project</strong></span> menu and select the project where you installed the Service Mesh control plane, for example <span class="strong strong"><strong>istio-system</strong></span>.
							</li><li class="listitem">
								Navigate to <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Service Mesh Control Plane</strong></span> under <span class="strong strong"><strong>Provided APIs</strong></span>.
							</li><li class="listitem">
								Click the <code class="literal">ServiceMeshControlPlane</code> menu 
								<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Service_Mesh-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
								 .
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Delete Service Mesh Control Plane</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Delete</strong></span> on the confirmation dialog window to remove the <code class="literal">ServiceMeshControlPlane</code>.
							</li></ol></div></section><section class="section" id="ossm-control-plane-remove-cli_removing-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.12.1.2. Removing the Service Mesh control plane using the CLI</h4></div></div></div><p>
						You can remove the Red Hat OpenShift Service Mesh control plane by using the CLI. In this example, <code class="literal">istio-system</code> is the name of the control plane project.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform CLI.
							</li><li class="listitem"><p class="simpara">
								Run the following command to delete the <code class="literal">ServiceMeshMemberRoll</code> resource.
							</p><pre class="programlisting language-terminal">$ oc delete smmr -n istio-system default</pre></li><li class="listitem"><p class="simpara">
								Run this command to retrieve the name of the installed <code class="literal">ServiceMeshControlPlane</code>:
							</p><pre class="programlisting language-terminal">$ oc get smcp -n istio-system</pre></li><li class="listitem"><p class="simpara">
								Replace <code class="literal">&lt;name_of_custom_resource&gt;</code> with the output from the previous command, and run this command to remove the custom resource:
							</p><pre class="programlisting language-terminal">$ oc delete smcp -n istio-system &lt;name_of_custom_resource&gt;</pre></li></ol></div></section></section><section class="section" id="ossm-operatorhub-remove-operators_removing-ossm-v1x"><div class="titlepage"><div><div><h3 class="title">2.12.2. Removing the installed Operators</h3></div></div></div><p>
					You must remove the Operators to successfully remove Red Hat OpenShift Service Mesh. After you remove the Red Hat OpenShift Service Mesh Operator, you must remove the Kiali Operator, the Red Hat OpenShift distributed tracing platform (Jaeger) Operator, and the OpenShift Elasticsearch Operator.
				</p><section class="section" id="ossm-remove-operator-servicemesh_removing-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.12.2.1. Removing the Operators</h4></div></div></div><p>
						Follow this procedure to remove the Operators that make up Red Hat OpenShift Service Mesh. Repeat the steps for each of the following Operators.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Red Hat OpenShift Service Mesh
							</li><li class="listitem">
								Kiali
							</li><li class="listitem">
								Red Hat OpenShift distributed tracing platform (Jaeger)
							</li><li class="listitem">
								OpenShift Elasticsearch
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform web console.
							</li><li class="listitem">
								From the <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> page, scroll or type a keyword into the <span class="strong strong"><strong>Filter by name</strong></span> to find each Operator. Then, click the Operator name.
							</li><li class="listitem">
								On the <span class="strong strong"><strong>Operator Details</strong></span> page, select <span class="strong strong"><strong>Uninstall Operator</strong></span> from the <span class="strong strong"><strong>Actions</strong></span> menu. Follow the prompts to uninstall each Operator.
							</li></ol></div></section><section class="section" id="ossm-remove-cleanup-1x_removing-ossm-v1x"><div class="titlepage"><div><div><h4 class="title">2.12.2.2. Clean up Operator resources</h4></div></div></div><p>
						Follow this procedure to manually remove resources left behind after removing the Red Hat OpenShift Service Mesh Operator using the OpenShift Container Platform web console.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								An account with cluster administration access.
							</li><li class="listitem">
								Access to the OpenShift CLI (<code class="literal">oc</code>).
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the OpenShift Container Platform CLI as a cluster administrator.
							</li><li class="listitem"><p class="simpara">
								Run the following commands to clean up resources after uninstalling the Operators. If you intend to keep using Jaeger as a stand alone service without service mesh, do not delete the Jaeger resources.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The Operators are installed in the <code class="literal">openshift-operators</code> namespace by default. If you installed the Operators in another namespace, replace <code class="literal">openshift-operators</code> with the name of the project where the Red Hat OpenShift Service Mesh Operator was installed.
								</p></div></div><pre class="programlisting language-terminal">$ oc delete validatingwebhookconfiguration/openshift-operators.servicemesh-resources.maistra.io</pre><pre class="programlisting language-terminal">$ oc delete mutatingwebhookconfiguration/openshift-operators.servicemesh-resources.maistra.io</pre><pre class="programlisting language-terminal">$ oc delete -n openshift-operators daemonset/istio-node</pre><pre class="programlisting language-terminal">$ oc delete clusterrole/istio-admin clusterrole/istio-cni clusterrolebinding/istio-cni</pre><pre class="programlisting language-terminal">$ oc delete clusterrole istio-view istio-edit</pre><pre class="programlisting language-terminal">$ oc delete clusterrole jaegers.jaegertracing.io-v1-admin jaegers.jaegertracing.io-v1-crdview jaegers.jaegertracing.io-v1-edit jaegers.jaegertracing.io-v1-view</pre><pre class="programlisting language-terminal">$ oc get crds -o name | grep '.*\.istio\.io' | xargs -r -n 1 oc delete</pre><pre class="programlisting language-terminal">$ oc get crds -o name | grep '.*\.maistra\.io' | xargs -r -n 1 oc delete</pre><pre class="programlisting language-terminal">$ oc get crds -o name | grep '.*\.kiali\.io' | xargs -r -n 1 oc delete</pre><pre class="programlisting language-terminal">$ oc delete crds jaegers.jaegertracing.io</pre><pre class="programlisting language-terminal">$ oc delete svc admission-controller -n &lt;operator-project&gt;</pre><pre class="programlisting language-terminal">$ oc delete project &lt;istio-system-project&gt;</pre></li></ol></div></section></section></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm140663647075984"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2023 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div>


  <nav class="pvof-doc__book-nav">
  <ol class="book-nav__list">
              </ol>
</nav>


          </div>
              </div>
              <div id="comments-footer" class="book-comments">
          

  

        </div>
          </div>
  </article>
<meta itemscope="" itemref="md1">



    </div>
      <!-- CP_PRIMER_FOOTER -->            </div>
        </main>
    </div>
    <!--googleoff: all-->
    <div id="to-top"><a class="btn_slideto" href="#masthead" aria-label="Back to Top"><span class="web-icon-upload"></span></a></div>
    <footer class="footer-main">
        <div class="footer-top">
            <div class="container">

              <div class="brand">
                <a href="https://redhat.com">
                  <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                    <defs>
                      <style>
                        .rh-logo-hat {
                          fill: #e00;
                        }
                        .rh-logo-type {
                          fill: #fff;
                        }
                      </style>
                    </defs>
                    <title>Red Hat</title>
                    <path
                      class="rh-logo-hat"
                      d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
                      <path class="rh-logo-band"
                      d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
                      <path
                      class="rh-logo-type"
                      d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
                  </svg>
                </a>
              </div>

              <div role="navigation" aria-label="quick">
                  <h3>Quick Links</h3>
                  <ul>
                      <li><a class="download-software" href="https://access.redhat.com/downloads/">Downloads</a></li>
                      <li><a class="manage-subscriptions" href="https://access.redhat.com/management">Subscriptions</a></li>
                      <li><a class="support-cases" href="https://access.redhat.com/support">Support Cases</a></li>
                      <li><a class="customer-service" href="https://access.redhat.com/support/customer-service">Customer Service</a></li>
                      <li><a class="quick-docs" href="https://access.redhat.com/documentation">Product Documentation</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="help">
                  <h3>Help</h3>
                  <ul>
                      <li><a class="contact-us" href="https://access.redhat.com/support/contact/">Contact Us</a></li>
                      <li><a class="cp-faqs" href="https://access.redhat.com/articles/33844">Customer Portal FAQ</a></li>
                      <li><a class="login-problems" href="https://access.redhat.com/help/login_assistance">Log-in Assistance</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="site">
                  <h3>Site Info</h3>
                  <ul>
                      <li><a class="trust-red-hat" href="https://www.redhat.com/en/trust">Trust Red Hat</a></li>
                      <li><a class="browser-support-policy" href="https://www.redhat.com/en/about/browser-support">Browser Support Policy</a></li>
                      <li><a class="accessibility" href="https://www.redhat.com/en/about/digital-accessibility">Accessibility</a></li>
                      <li><a class="recognition" href="https://access.redhat.com/recognition/">Awards and Recognition</a></li>
                      <li><a class="colophon" href="https://access.redhat.com/help/colophon/">Colophon</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="other">
                  <h3>Related Sites</h3>
                  <ul>
                      <li><a href="https://www.redhat.com/" class="red-hat-com">redhat.com</a></li>
                      <li><a href="http://developers.redhat.com/" class="red-hat-developers">developers.redhat.com</a></li>
                      <li><a href="https://connect.redhat.com/" class="partner-connect">connect.redhat.com</a></li>
                      <li><a href="https://cloud.redhat.com/" class="cloud-com">cloud.redhat.com</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="about">
                  <h3>About</h3>
                  <ul>
                      <li><a href="https://access.redhat.com/subscription-value" class="subscription-value">Red Hat Subscription Value</a></li>
                      <li><a href="https://www.redhat.com/about/" class="about-red-hat">About Red Hat</a></li>
                      <li><a href="http://jobs.redhat.com" class="about-jobs">Red Hat Jobs</a></li>
                  </ul>
              </div>

            </div>
        </div>

        <div class="anchor">
            <div class="container">
                <div class="status-legal">
                    <a hidden href="https://status.redhat.com" class="status-page-widget">
                        <span class="status-description"></span>
                        <span class="status-dot shape-circle"></span>
                    </a>
                    <div class="legal-copyright">
                        <div class="copyright">Copyright © 2023 Red Hat, Inc.</div>
                        <div role="navigation" aria-label="legal" class="legal">
                            <ul>
                                <li><a href="http://www.redhat.com/en/about/privacy-policy" class="privacy-policy">Privacy Statement</a></li>
                                <li><a href="https://www.redhat.com/en/about/terms-use" class="terms-of-use">Terms of Use</a></li>
                                <li><a href="http://www.redhat.com/en/about/all-policies-guidelines" class="all-policies">All Policies and Guidelines</a></li>
                                <li><a id="teconsent"></a></li>
                            </ul>
                            <div id="privacy_policy">We've updated our <a href='http://www.redhat.com/en/about/privacy-policy' class='privacy-policy'>Privacy Statement</a> effective September 15, 2023.
                            </div>
                          </div>
                        </div>
                </div>
                <div class="social">
                    <a href="http://www.redhat.com/summit/" class="summit">
                        <img src="https://access.redhat.com/chrome_themes/nimbus/img/rh-summit-red-a.svg" alt="Red Hat Summit" /> <span class="offscreen">Red Hat Summit</span>
                    </a>

                    <div class="social-media">
                        <a href="https://twitter.com/RedHat" class="sm-icon twitter"><span class="nicon-twitter"></span><span class="offscreen">Twitter</span></a>                        
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- TrustArc -->
    <div id="consent_blackbar"></div> 
    <!--googleon: all-->
</div>
<!-- /CP_PRIMER_FOOTER -->


  </div>

    
  </body>
</html>
