<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="og: https://ogp.me/ns#">
  <head>
    <meta charset="utf-8" />
<link rel="canonical" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/index" />
<link rel="shortlink" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/index" />
<meta property="og:site_name" content="Red Hat Customer Portal" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/index" />
<meta property="og:title" content="Operators OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<meta property="og:description" content="This document provides information for working with Operators in OpenShift Container Platform. This includes instructions for cluster administrators on how to install and manage Operators, as well as information for developers on how to create applications from installed Operators. This also contains guidance on building your own Operator using the Operator SDK." />
<meta property="og:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="This document provides information for working with Operators in OpenShift Container Platform. This includes instructions for cluster administrators on how to install and manage Operators, as well as information for developers on how to create applications from installed Operators. This also contains guidance on building your own Operator using the Operator SDK." />
<meta name="twitter:title" content="Operators OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<meta name="twitter:url" content="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/index" />
<meta name="twitter:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="title" content="Operators OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<link rel="alternate" hreflang="en" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/index" />
<link rel="alternate" hreflang="ko" href="https://access.redhat.com/documentation/ko-kr/openshift_container_platform/4.13/html-single/operators/index" />
<link rel="alternate" hreflang="zh-hans" href="https://access.redhat.com/documentation/zh-cn/openshift_container_platform/4.13/html-single/operators/index" />
<link rel="alternate" hreflang="ja" href="https://access.redhat.com/documentation/ja-jp/openshift_container_platform/4.13/html-single/operators/index" />
<link rel="alternate" hreflang="es" href="https://access.redhat.com/documentation/es-es/openshift_container_platform/4.13/html-single/operators/index" />
<link rel="alternate" hreflang="ru" href="https://access.redhat.com/documentation/ru-ru/openshift_container_platform/4.13/html-single/operators/index" />
<link rel="alternate" hreflang="pt-br" href="https://access.redhat.com/documentation/pt-br/openshift_container_platform/4.13/html-single/operators/index" />
<link rel="alternate" hreflang="it" href="https://access.redhat.com/documentation/it-it/openshift_container_platform/4.13/html-single/operators/index" />
<link rel="alternate" hreflang="de" href="https://access.redhat.com/documentation/de-de/openshift_container_platform/4.13/html-single/operators/index" />
<link rel="alternate" hreflang="fr" href="https://access.redhat.com/documentation/fr-fr/openshift_container_platform/4.13/html-single/operators/index" />
<link rel="alternate" hreflang="zh-hant" href="https://access.redhat.com/documentation/zh-tw/openshift_container_platform/4.13/html-single/operators/index" />
<link rel="alternate" hreflang="id" href="https://access.redhat.com/documentation/id-id/openshift_container_platform/4.13/html-single/operators/index" />
<link rel="alternate" hreflang="th" href="https://access.redhat.com/documentation/th-th/openshift_container_platform/4.13/html-single/operators/index" />
<link rel="alternate" hreflang="vi" href="https://access.redhat.com/documentation/vi-vn/openshift_container_platform/4.13/html-single/operators/index" />
<meta name="Generator" content="Drupal 9 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="revision" product="b0738f19-59ac-47eb-9512-8a439cd6dfb0" title="c9549998-eadf-4156-8306-657346d5f002" page="d75b1dc6-a5e3-4cb3-9433-0cec73b56aae" revision="dccd48b1f252cc22dad43e9ae6252b9287d98ca1:en-us" body="20a64d1e310a1d44dccbb5aea7a70246.html" toc="21ed0b7e6c9db82cefcef1a2a75dbc8d.json" />

    <title>Operators OpenShift Container Platform 4.13 | Red Hat Customer Portal</title>
    <link rel="stylesheet" media="all" href="/sites/dxp-docs/files/css/css_87GMcmxT1ib8ziQiU2KUAnTDFtZQV6iP-KGslA9LigM.css" />
<link rel="stylesheet" media="all" href="/sites/dxp-docs/files/css/css__Xq4GfgPDJw9K_yYJFmlRZGJeCENu3R3r4s0K7Tr_9g.css" />

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"documentation\/en-us\/openshift_container_platform\/4.13\/html-single\/operators\/index","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"red_hat_jwt":{"client_id":"customer-portal","cookie_name":"rh_jwt","leeway":"0","realm":"redhat-external","sso_host":"https:\/\/sso.redhat.com\/","user_integration":1,"user_plugin":"drupal_user_auth","use_external_js":0,"use_internal_js":0,"use_in_admin":0},"user":{"uid":0,"permissionsHash":"d8ea0bce2d740dacbdfe0257cf55baa0e33f7fb8468a26d055ce75daaaa2d315"}}</script>
<script src="/sites/dxp-docs/files/js/js_EQWKo9EokWkWS99x_e1oM-NEM0zlKyTkp_83mGdm5Ks.js"></script>

    <!-- CP_PRIMER_HEAD -->  <!-- TrustArc & DTM -->
  <script src="//static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>
  <script src="//www.redhat.com/dtm.js"></script><meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<!--[if IEMobile]><meta http-equiv="cleartype" content="on"><![endif]-->

<!-- metaInclude -->
<meta name="avalon-host-info" content="dxp-kbase-prod-139-77b4fb8768-25dr9" />
<meta name="avalon-version" content="27861f77" />
<meta name="cp-chrome-build-date" content="2023-10-06T19:17:59.039Z" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#000000">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#000000">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-status-bar-style" content="#000000">
<link rel="manifest" href="https://access.redhat.com/webassets/avalon/j/manifest.json">
<!-- Open Search - Tap to search -->
<link rel="search" type="application/opensearchdescription+xml" title="Red Hat Customer Portal" href="https://access.redhat.com/webassets/avalon/j/opensearch.xml" />
<!-- title -->
<title>Red Hat Customer Portal - Access to 24x7 support and knowledge</title>
<!-- /title -->
<script type="text/javascript">
    window.portal = {
        analytics : {},
        host      : "https://access.redhat.com",
        idp_url   : "https://sso.redhat.com",
        lang      : "en", 
        version   : "27861f77",
        builddate : "2023-10-06T19:17:59.039Z",        fetchdate : "2023-10-10T17:45:08-0400",        nrid      : "NOLONGERSUPPORTED",
        nrlk      : "NOLONGERSUPPORTED"
    };
</script>
<script type="text/javascript">
    if (!/\/logout.*/.test(location.pathname) && portal.host === location.origin && document.cookie.indexOf('rh_sso_session') >= 0 && !(document.cookie.indexOf('rh_jwt') >= 0)) window.location = '/login?redirectTo=' + encodeURIComponent(window.location.href);
</script>
<!-- cssInclude -->

<link rel="shortcut icon" href="https://access.redhat.com/webassets/avalon/g/favicon.ico" /><link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/bootstrap.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/bootstrap-grid.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/main.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/components.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/pages.css?v=27861f77" />

<link href="https://access.redhat.com/webassets/avalon/s/chosen.css?v=27861f77" rel="stylesheet" type="text/css" />

<!--[if lte IE 9]>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/ie.css" />
<![endif]--><noscript>
    <style type="text/css" media="screen"> .primary-nav { display: block; } </style>
</noscript>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/webassets/avalon/j/public_modules/node_modules/@cpelements/pfe-navigation/dist/pfe-navigation--lightdom.min.css" />
<!-- /cssInclude -->
<script src="https://access.redhat.com/webassets/avalon/j/public_modules/node_modules/@cpelements/pfe-navigation/dist/ie-polyfills.js?v=27861f77"></script>

<script async>
  if (!HTMLScriptElement.supports || !HTMLScriptElement.supports('importmap')) {
    import("https://www.redhatstatic.com/dx/v1-alpha/es-module-shims@1.7.3.js");
  }
</script>
<script type="importmap">
{
  "imports": {
    "@patternfly/elements/" : "https://www.redhatstatic.com/dx/v1-alpha/@patternfly/elements@2.2.2/",
    "@rhds/elements/":"https://www.redhatstatic.com/dx/v1-alpha/@rhds/elements@1.1.0/elements/",
    "@rhds/elements/lib/":"https://www.redhatstatic.com/dx/v1-alpha/@rhds/elements@1.1.0/lib/",
    "@cpelements/elements/":"https://www.redhatstatic.com/dx/v1-alpha/@cpelements/elements@2.0.0-alpha.7/elements/"
  }
}
</script><script type="text/javascript" src="https://access.redhat.com/webassets/avalon/j/lib/require.js?v=27861f77" data-main="/webassets/avalon/j/"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<script src="https://access.redhat.com/chrome_themes/nimbus/js/ie8.js"></script>
<![endif]-->
<script type="text/javascript" src="https://access.redhat.com/chrome_themes/nimbus/js/new-nav.js?v=27861f77" ></script>
<!-- /CP_PRIMER_HEAD -->

  </head>
  <body>
    
      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
      <!-- CP_PRIMER_HEADER -->
<div id="page-wrap" class="page-wrap">
    <div id="pers-top-page-wrap" class="top-page-wrap pers-loader-bg">

      <div id="hero-bg-top-left" class="summit-bg-shapes"></div>
      <div id="hero-bg-top-right" class="summit-bg-shapes"></div>

        <!--googleoff: all-->
        <header class="masthead" id="masthead">

            <a href="#pfe-navigation" id="global-skip-to-nav" class="skip-link visually-hidden">Skip to navigation</a>
            <a href="#cp-main" class="skip-link visually-hidden">Skip to main content</a>            <nav id="portal-utility-nav" class="utility-navigation utility-navigation--bar hidden-at-mobile" data-analytics-region="utility" aria-labelledby="nav__utility-nav--desktop">
                <h3 id="nav__utility-nav--desktop" class="element-invisible">Utilities
                </h3>
                <ul aria-labelledby="nav__utility-nav--desktop">
                    <li id="nav-subscription" data-portal-tour-1="1">
                        <a class="top-nav-subscriptions" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Subscription" href="https://access.redhat.com/management/" >Subscriptions
                        </a>
                    </li>
                    <li id="nav-downloads" data-portal-tour-1="2">
                        <a class="top-nav-downloads" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Downloads" href="https://access.redhat.com/downloads/" >Downloads
                        </a>
                    </li>
                    <li id="nav-containers">
                        <a class="top-nav-containers" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Containers" href="https://catalog.redhat.com/software/containers/explore/" >Containers
                        </a>
                    </li>
                    <li id="nav-support" data-portal-tour-1="3">
                        <a class="top-nav-support-cases" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Support Cases" href="https://access.redhat.com/support/cases/" >Support Cases
                        </a>
                    </li>
                </ul>
            </nav>

            <pfe-navigation id="pfe-navigation" data-analytics-region="mega menu">
                <div class="pfe-navigation__logo-wrapper" id="pfe-navigation__logo-wrapper">
                    <a href="https://access.redhat.com/" class="pfe-navigation__logo-link" data-analytics-text="logo" data-analytics-category="MM|logo">
                        <img class="pfe-navigation__logo-image" alt="Red Hat Customer Portal" src="https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg" />
                    </a>
                </div>

                <nav class="pfe-navigation" aria-label="Main Navigation" data-analytics-region="main nav">
                    <ul class="pfe-navigation__menu" id="pfe-navigation__menu">                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-subscription--mobile" data-portal-tour-1="1">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Subscription" href="https://access.redhat.com/management/" >Subscriptions
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-downloads--mobile" data-portal-tour-1="2">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Downloads" href="https://access.redhat.com/downloads/" >Downloads
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-containers--mobile">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Containers" href="https://catalog.redhat.com/software/containers/explore/" >Containers
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-support--mobile" data-portal-tour-1="3">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Support Cases" href="https://access.redhat.com/support/cases/" >Support Cases
                            </a>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a href="https://access.redhat.com/products/" class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Products and Services">Products &amp; Services
                            </a>
                            <div class="pfe-navigation__dropdown has-primary-detail">                                <div class="desktop-col-span-2 tablet-col-span-all">
                                    <h3>
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Products" href="https://access.redhat.com/products/">Products
                                        </a>
                                    </h3>
                                    <slot name="main-menu__dropdown--product__product-listing"></slot>
                                </div>                                <div>
                                    <h3 id="nav__products__support">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Support" href="https://access.redhat.com/support">Support
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__support">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Production Support" href="https://access.redhat.com/support/offerings/production/">Production Support
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Development Support" href="https://access.redhat.com/support/offerings/developer/">Development Support
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Product Life Cycles" href="https://access.redhat.com/product-life-cycles/">Product Life Cycles
                                                    </a></li>
                                    </ul>

                                    <h3 id="nav__products__services">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Services" href="https://www.redhat.com/en/services">Services
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__services">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Consulting" href="https://www.redhat.com/en/services/consulting">Consulting
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Technical Account Management" href="https://access.redhat.com/support/offerings/tam/">Technical Account Management
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Training and Certifications" href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications
                                                    </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__products__documentation">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Documentation" href="https://access.redhat.com/documentation">Documentation
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__documentation">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat Enterprise Linux" href="https://access.redhat.com/documentation/en/red_hat_enterprise_linux">Red Hat Enterprise Linux
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat JBoss Enterprise Application Platform" href="https://access.redhat.com/documentation/en/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat OpenStack Platform" href="https://access.redhat.com/documentation/en/red_hat_openstack_platform">Red Hat OpenStack Platform
                                                    </a></li>
                                                    <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat OpenShift Container Platform" href="https://access.redhat.com/documentation/en/openshift_container_platform">Red Hat OpenShift Container Platform
                                                        </a></li>
                                    </ul>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="All Documentation" data-analytics-linkType="cta" href="https://access.redhat.com/documentation">All Documentation
                                        </a>
                                    </pfe-cta>

                                    <h3 id="nav__products__catalog"><a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Ecosystem Catalog" href="https://catalog.redhat.com/">Ecosystem Catalog
                                        </a></h3>
                                        <ul aria-labelledby="nav__products__catalog">
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Ecosystem Catalog" data-analytics-text="Red Hat Partner Ecosystem" href="https://access.redhat.com/ecosystem/">Red Hat Partner Ecosystem
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Ecosystem Catalog" data-analytics-text="Partner Resources" href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources
                                                    </a></li>
                                        </ul>
                                </div>
                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Tools" href="https://access.redhat.com/labs/">Tools
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="nav__tools__tools" data-analytics-level="2" data-analytics-text="Tools" data-analytics-category="Tools">Tools
                                    </h3>
                                    <ul aria-labelledby="nav__tools__tools">
                                        <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Solution Engine" href="https://access.redhat.com/support/cases/#/troubleshoot">Troubleshoot a product issue
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Packages" href="https://access.redhat.com/downloads/content/package-browser">Packages
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Errata" href="https://access.redhat.com/errata/">Errata
                                                    </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__tools__labs">
                                        <a data-analytics-level="2" data-analytics-category="Tools" data-analytics-text="Customer Portal Labs" href="https://access.redhat.com/labs/">Customer Portal Labs
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__tools__labs">
                                        <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Configuration" href="https://access.redhat.com/labs/#!?type=config">Configuration
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Deployment" href="https://access.redhat.com/labs/#!?type=deploy">Deployment
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Security" href="https://access.redhat.com/labs/#!?type=security">Security
                                                    </a></li>                                                    <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Troubleshooting" href="https://access.redhat.com/labs/#!?type=troubleshoot">Troubleshoot
                                                        </a></li>
                                    </ul>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="All Labs" data-analytics-linkType="cta" href="https://access.redhat.com/labs/">All labs
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h4 id="nav__tools__red-hat-insights">
                                        <a data-analytics-level="2" data-analytics-category="Tools" data-analytics-text="Red Hat Insights" href="//www.redhat.com/en/technologies/management/insights">Red Hat Insights
                                        </a>
                                    </h4>
                                    <p>Increase visibility into IT operations to detect and resolve technical issues before they impact your business.</p>
                                    <a data-analytics-level="3" data-analytics-category="Tools|Red Hat Insights" data-analytics-text="Learn more" href="https://www.redhat.com/en/technologies/management/insights">Learn More
                                    </a>
                                    <br>
                                    <a data-analytics-level="3" data-analytics-category="Tools|Red Hat Insights" data-analytics-text="Go to Insights" href="https://cloud.redhat.com/insights">Go to Insights
                                    </a>
                                </div>
                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Security" href="https://access.redhat.com/security/">Security
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="security__security-center">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Red Hat Product Security Center" href="https://access.redhat.com/security">Red Hat Product Security Center
                                        </a>
                                    </h3>
                                    <p>Engage with our Red Hat Product Security team, access security updates, and ensure your environments are not exposed to any known security vulnerabilities.
                                    </p>
                                    <pfe-cta pfe-priority="primary">
                                        <a data-analytics-level="3" data-analytics-category="Security|Red Hat Product Security Center" data-analytics-text="Product Security Center" data-analytics-linkType="cta" href="https://access.redhat.com/security/">Product Security Center
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__security__updates" data-analytics-level="2" data-analytics-text="Security Updates" data-analytics-category="Security">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Security Updates" href="/security">Security Updates
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__security__updates">
                                        <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Security Advisories" href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Red Hat CVE Database" href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Security Labs" href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs
                                                    </a></li>
                                    </ul>
                                    <p class="margin-top-xl">Keep your systems secure with Red Hat&#039;s specialized responses to security vulnerabilities.
                                    </p>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="View Responses" data-analytics-linkType="cta" href="https://access.redhat.com/security/vulnerability">View Responses
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__security__resources">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Resources" href="https://access.redhat.com/security/overview">Resources
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__security__resources">                                            <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Security Blog" href="//redhat.com/en/blog/channel/security">Security Blog
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Security Measurement" href="https://www.redhat.com/security/data/metrics/">Security Measurement
                                                    </a></li>
                                                    <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Severity Ratings" href="https://access.redhat.com/security/updates/classification/">Severity Ratings
                                                        </a></li>
                                                        <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Backporting Policies" href="https://access.redhat.com/security/updates/backporting/">Backporting Policies
                                                            </a></li>
                                                            <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Product Signing (GPG) Keys" href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys
                                                                </a></li>
                                    </ul>
                                </div>

                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a href="https://access.redhat.com/community/" class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Community">Community
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="nav__community__cp-community">
                                        <a href="https://access.redhat.com/community" data-analytics-level="2" data-analytics-text="Customer Portal Community" data-analytics-text="Customer Portal Community" data-analytics-category="Community">Customer Portal Community
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__community__cp-community">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Discussions" href="https://access.redhat.com/discussions">Discussions
                                            </a></li>                                                <li><a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Private Groups" href="https://access.redhat.com/groups/">Private Groups
                                                    </a></li>
                                    </ul>

                                    <pfe-cta pfe-priority="primary">
                                        <a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Community Activity" data-analytics-linkType="cta" href="https://access.redhat.com/community/">Community Activity
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__community__events" data-analytics-level="2" data-analytics-text="Customer Events" data-analytics-category="Community">Customer Events
                                    </h3>
                                    <ul aria-labelledby="nav__community__events">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Customer Events" data-analytics-text="Red Hat Convergence" href="https://access.redhat.com/convergence/">Red Hat Convergence
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Community|Customer Events" data-analytics-text="Red Hat Summit" href="http://www.redhat.com/summit/">Red Hat Summit
                                                </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__community__stories" data-analytics-level="2" data-analytics-text="Stories" data-analytics-category="Community">Stories
                                    </h3>
                                    <ul aria-labelledby="nav__community__stories">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Stories" data-analytics-text="Red Hat Subscription Value" href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-text="You Asked. We Acted." data-analytics-category="Community|Stories" href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Community|Stories" data-analytics-text="Open Source Communities" href="http://www.redhat.com/en/open-source">Open Source Communities
                                                    </a></li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                    </ul>                </nav>                <div id="site-search" slot="search" class="utility-link site-search">
                    <div class="content">
                        <form class="ng-pristine ng-valid topSearchForm" id="topSearchForm" name="topSearchForm" action="/search/browse/search/" method="get" enctype="application/x-www-form-urlencoded">
                            <cp-search-autocomplete class="push-bottom" path="/webassets/avalon/j/data.json"></cp-search-autocomplete>                            <div>Or <a href="/support/cases/#/troubleshoot">troubleshoot an issue</a>.
                            </div>
                        </form>
                    </div>
                </div>


                <div slot="secondary-links" id="localesMenu">
                    <button class="pfe-navigation__secondary-link">
                        <pfe-icon icon="web-icon-globe" size="sm" aria-hidden="true"></pfe-icon>English
                    </button>

                    <pfe-navigation-dropdown dropdown-width="single">
                        <h2 class="utility-header">Select Your Language
                        </h2>
                        <ul class="reset">
                            <li><a href="https://access.redhat.com/changeLanguage?language=en" data-lang="en" id="en" data-analytics-text="English">English</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=ko" data-lang="ko" id="ko" data-analytics-text="Korean">한국어</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=ja"    data-lang="ja"    id="ja" data-analytics-text="Japanese">日本語</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" data-lang="zh_CN" id="zh_CN" data-analytics-text="Chinese">中文 (中国)</a></li>
                        </ul>

                    </pfe-navigation-dropdown>
                </div>                <rh-account-dropdown slot="account"></rh-account-dropdown>                <pfe-primary-detail breakpoint-width="600" class="main-menu__dropdown--product__product-listing" slot="main-menu__dropdown--product__product-listing" consistent-height>
                    <h3 slot="details-nav">Infrastructure and Management                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Enterprise Linux" href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Satellite" href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Subscription Management" href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Insights" href="https://access.redhat.com/products/red-hat-insights/">Red Hat Insights
                                </a>
                            </li>
                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Ansible Automation Platform" href="https://access.redhat.com/products/red-hat-ansible-automation-platform/">Red Hat Ansible Automation Platform
                                </a></li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Cloud Computing                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift" href="https://access.redhat.com/products/openshift">Red Hat OpenShift
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenStack Platform" href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat OpenShift Container Platform" href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat OpenShift Data Science" href="https://access.redhat.com/products/red-hat-openshift-data-science/">Red Hat OpenShift Data Science
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift Dedicated" href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat Advanced Cluster Security for Kubernetes" href="https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/">Red Hat Advanced Cluster Security for Kubernetes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat Advanced Cluster Management for Kubernetes" href="https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/">Red Hat Advanced Cluster Management for Kubernetes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat Quay" href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat CodeReady Workspaces" href="https://access.redhat.com/products/red-hat-codeready-workspaces/">OpenShift Dev Spaces
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift Service on AWS" href="https://access.redhat.com/products/red-hat-openshift-service-aws">Red Hat OpenShift Service on AWS
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Storage                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Gluster Storage" href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Hyperconverged Infrastructure" href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Ceph Storage" href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Openshift Container Storage" href="https://access.redhat.com/products/red-hat-openshift-data-foundation">Red Hat OpenShift Data Foundation
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Runtimes                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Runtimes" href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat JBoss Enterprise Application Platform" href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Data Grid" href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat JBoss Web Server" href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Single Sign On" href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat support for Spring Boot" href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat build of Node.js" href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js
                                </a>
                            </li>                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat build of Quarkus" href="https://access.redhat.com/products/quarkus/">Red Hat build of Quarkus
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Integration and Automation                    </h3>
                    <div slot="details">
                        <ul class="border-bottom" id="portal-menu-border-bottom">
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat Application Foundations" href="https://access.redhat.com/products/red-hat-application-foundations/">Red Hat Application Foundations
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat Fuse" href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat AMQ" href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat 3scale API Management" href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div slot="details-nav--footer">
                        <pfe-cta pfe-priority="primary">
                            <a href="https://access.redhat.com/products/" class="pfe-navigation__menu-link" data-analytics-level="2" data-analytics-text="All Products" data-analytics-category="Products and Services|Products:" data-analytics-linkType="cta">All Products
                            </a>
                        </pfe-cta>
                    </div>
                </pfe-primary-detail>

            </pfe-navigation>

            <div id="scroll-anchor"></div>

            <!--[if IE 8]>
                <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                <span class="icon-warning alert-icon" aria-hidden="true"></span>
                You are using an unsupported web browser. Update to a supported browser for the best experience. <a href="/announcements/2120951">Read the announcement</a>.
                </div>
                </div>
            <![endif]-->
            <!--[if IE 9]>
                <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                <span class="icon-warning alert-icon" aria-hidden="true"></span>As of March 1, 2016, the Red Hat Customer Portal will no longer support Internet Explorer 9. See our new <a href="/help/browsers">browser support policy</a> for more information.
                </div>
                </div>
            <![endif]-->
            <div id="site-section"></div>
        </header>
        <!--googleon: all-->

        <main id="cp-main" class="portal-content-area">
            <div id="cp-content" class="main-content">                            <!-- /CP_PRIMER_HEADER -->

      <div class="container">
        

                                                                                                        <script>breadcrumbs = [["Products & Services","\/products\/"],["Product Documentation","\/documentation"],["OpenShift Container Platform","\/documentation\/en-us\/openshift_container_platform"],["4.13","\/documentation\/en-us\/openshift_container_platform\/4.13"],["Operators","\/documentation\/en-us\/openshift_container_platform\/4.13\/html\/operators"],["Operators","\/documentation\/en-us\/openshift_container_platform\/4.13\/html\/operators\/--single-page-document--"]]</script>

<div data-drupal-messages-fallback class="hidden"></div>


    </div>
        <div class="container">
        

  

  


  <article class="pvof-doc__content-wrapper__outer pvof-doc__content-wrapper__outer--css-not-removed">
    <script>
      'use strict';

            var $outerWrapper = document.querySelector('.pvof-doc__content-wrapper__outer');
      if ($outerWrapper && $outerWrapper.closest) {
        var $containerWrapper = $outerWrapper.closest('.container');
        if ($containerWrapper) {
          $containerWrapper.classList.remove('container');
          $containerWrapper.classList.add('j-chrome-content-container');
        }
      }

            var cssRemoved = false;
      try {
        var $crapCss = document.querySelectorAll(
          'link[href*="/chrome_themes/nimbus/css/pages.css"], link[href*="/chrome_themes/nimbus/css/components.css"]'
        );
        if ($crapCss.length) {
          for (let index = 0; index < $crapCss.length; index++) {
            const $stylesheet = $crapCss[index];
            $stylesheet.remove();
          }
        }
        cssRemoved = true;
      }
      catch (error) {
        console.error('Ran into an issue while trying to retheme page', error);
        cssRemoved = false;
      }

            if (cssRemoved) {
        var $pvofOuterWrapper = document.querySelector('.pvof-doc__content-wrapper__outer--css-not-removed');
        if ($pvofOuterWrapper) {
          $pvofOuterWrapper.classList.remove('pvof-doc__content-wrapper__outer--css-not-removed');
        }
      }
    </script>
    <div itemscope="" itemtype="https://schema.org/TechArticle" itemref="techArticle-md1 techArticle-md2 techArticle-md3"></div>
    <div itemscope="" itemtype="https://schema.org/SoftwareApplication" itemref="softwareApplication-md1 softwareApplication-md2 softwareApplication-md3 softwareApplication-md4"></div>
    <div class="pvof-doc__content-wrapper pvof-doc__content-wrapper--has-sidebar">
                                <div class="pvof-doc__content-wrapper__inner j-superdoc j-superdoc--has-nav">
                            <div class="pvof-sidebar__wrapper j-doc-nav j-superdoc__nav">
            <div class="j-sidebar__menu-container">
              <button class="j-sidebar__menu-trigger content-expander__trigger">
                <span class="j-sidebar__menu-trigger__open-text">Jump To</span>
                <span class="j-sidebar__menu-trigger__close-text">Close</span>
              </button>

              <div class="pvof-sidebar__inner-wrapper j-doc-nav__wrapper content-expander">
                <div class="j-sidebar__menu-details-container">
                  <button class="j-sidebar__menu-details-button j-sidebar__menu-details-button--expand">
                    Expand all
                  </button>
                  <button class="j-sidebar__menu-details-button j-sidebar__menu-details-button--collapse">
                    Collapse all
                  </button>
                </div>
                

  <nav id="pvof-doc__toc" class="pvof-doc__toc">
  <h2 class="j-doc-nav__title" id="j-doc-nav__title">
    Table of contents
  </h2>
  <div class="pvof-doc__toc-inner">
              <ol class="j-doc-nav__list" aria-labelledby="j-doc-nav__title">
                  <li class="j-doc-nav__list-item">
                                    

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators" class="j-doc-nav__link ">
    Operators
  </a>
  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#operators-overview" class="j-doc-nav__link j-doc-nav__link--has-children">
    1. Operators overview
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1. Operators overview"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1. Operators overview"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#operators-overview-developer-tasks" class="j-doc-nav__link ">
    1.1. For developers
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#operators-overview-administrator-tasks" class="j-doc-nav__link ">
    1.2. For administrators
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#operators-overview-next-steps" class="j-doc-nav__link ">
    1.3. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#understanding-operators" class="j-doc-nav__link j-doc-nav__link--has-children">
    2. Understanding Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2. Understanding Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2. Understanding Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-what-operators-are" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1. What are Operators?
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1. What are Operators?"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1. What are Operators?"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-why-use-operators_olm-what-operators-are" class="j-doc-nav__link ">
    2.1.1. Why use Operators?
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operator-framework_olm-what-operators-are" class="j-doc-nav__link ">
    2.1.2. Operator Framework
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-maturity-model_olm-what-operators-are" class="j-doc-nav__link ">
    2.1.3. Operator maturity model
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-packaging-format" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.2. Operator Framework packaging format
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.2. Operator Framework packaging format"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.2. Operator Framework packaging format"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-bundle-format_olm-packaging-format" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.2.1. Bundle format
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.2.1. Bundle format"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.2.1. Bundle format"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-bundle-format-manifests_olm-packaging-format" class="j-doc-nav__link ">
    2.2.1.1. Manifests
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-bundle-format-annotations_olm-packaging-format" class="j-doc-nav__link ">
    2.2.1.2. Annotations
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependencies_olm-packaging-format" class="j-doc-nav__link ">
    2.2.1.3. Dependencies
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-about-opm_olm-packaging-format" class="j-doc-nav__link ">
    2.2.1.4. About the opm CLI
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-file-based-catalogs_olm-packaging-format" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.2.2. File-based catalogs
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.2.2. File-based catalogs"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.2.2. File-based catalogs"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-fb-catalogs-structure_olm-packaging-format" class="j-doc-nav__link ">
    2.2.2.1. Directory structure
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-fb-catalogs-schemas_olm-packaging-format" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.2.2.2. Schemas
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.2.2.2. Schemas"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.2.2.2. Schemas"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-fb-catalogs-package-schema_olm-packaging-format" class="j-doc-nav__link ">
    2.2.2.2.1. olm.package schema
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-fb-catalogs-channel-schema_olm-packaging-format" class="j-doc-nav__link ">
    2.2.2.2.2. olm.channel schema
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-fb-catalogs-olm-bundle_olm-packaging-format" class="j-doc-nav__link ">
    2.2.2.2.3. olm.bundle schema
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-fb-catalogs-prop_olm-packaging-format" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.2.2.3. Properties
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.2.2.3. Properties"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.2.2.3. Properties"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-fb-catalogs-package-prop_olm-packaging-format" class="j-doc-nav__link ">
    2.2.2.3.1. olm.package property
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-fb-catalogs-gvk-prop_olm-packaging-format" class="j-doc-nav__link ">
    2.2.2.3.2. olm.gvk property
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-fb-catalogs-package-reqd-prop_olm-packaging-format" class="j-doc-nav__link ">
    2.2.2.3.3. olm.package.required
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-fb-catalogs-gvk-reqd-prop_olm-packaging-format" class="j-doc-nav__link ">
    2.2.2.3.4. olm.gvk.required
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-fb-catalogs-example_olm-packaging-format" class="j-doc-nav__link ">
    2.2.2.4. Example catalog
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-fb-catalogs-guidelines_olm-packaging-format" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.2.2.5. Guidelines
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.2.2.5. Guidelines"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.2.2.5. Guidelines"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-fb-catalogs-immutable_olm-packaging-format" class="j-doc-nav__link ">
    2.2.2.5.1. Immutable bundles
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-fb-catalogs-source-control_olm-packaging-format" class="j-doc-nav__link ">
    2.2.2.5.2. Source control
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-fb-catalogs-cli" class="j-doc-nav__link ">
    2.2.2.6. CLI usage
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-fb-catalogs-automation_olm-packaging-format" class="j-doc-nav__link ">
    2.2.2.7. Automation
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-rukpak-about_olm-packaging-format" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.2.3. RukPak (Technology Preview)
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.2.3. RukPak (Technology Preview)"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.2.3. RukPak (Technology Preview)"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-rukpak-bundle_olm-packaging-format" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.2.3.1. Bundle
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.2.3.1. Bundle"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.2.3.1. Bundle"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-rukpak-bundle-immutability_olm-packaging-format" class="j-doc-nav__link ">
    2.2.3.1.1. Bundle immutability
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-rukpak-plain-bundle_olm-packaging-format" class="j-doc-nav__link ">
    2.2.3.1.2. Plain bundle spec
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-rukpak-registry-bundle_olm-packaging-format" class="j-doc-nav__link ">
    2.2.3.1.3. Registry bundle spec
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-rukpak-bd_olm-packaging-format" class="j-doc-nav__link ">
    2.2.3.2. BundleDeployment
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-rukpak-provisioner_olm-packaging-format" class="j-doc-nav__link ">
    2.2.3.3. Provisioner
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.3. Operator Framework glossary of common terms
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.3. Operator Framework glossary of common terms"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.3. Operator Framework glossary of common terms"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms-glossary_olm-common-terms" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.3.1. Common Operator Framework terms
  </a>
                              <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.3.1. Common Operator Framework terms"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.3.1. Common Operator Framework terms"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms-bundle_olm-common-terms" class="j-doc-nav__link ">
    2.3.1.1. Bundle
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms-bundle-image_olm-common-terms" class="j-doc-nav__link ">
    2.3.1.2. Bundle image
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms-catalogsource_olm-common-terms" class="j-doc-nav__link ">
    2.3.1.3. Catalog source
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms-channel_olm-common-terms" class="j-doc-nav__link ">
    2.3.1.4. Channel
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms-channel-head_olm-common-terms" class="j-doc-nav__link ">
    2.3.1.5. Channel head
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms-csv_olm-common-terms" class="j-doc-nav__link ">
    2.3.1.6. Cluster service version
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms-dependency_olm-common-terms" class="j-doc-nav__link ">
    2.3.1.7. Dependency
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms-index-image_olm-common-terms" class="j-doc-nav__link ">
    2.3.1.8. Index image
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms-installplan_olm-common-terms" class="j-doc-nav__link ">
    2.3.1.9. Install plan
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms-multitenancy_olm-common-terms" class="j-doc-nav__link ">
    2.3.1.10. Multitenancy
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms-operatorgroup_olm-common-terms" class="j-doc-nav__link ">
    2.3.1.11. Operator group
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms-package_olm-common-terms" class="j-doc-nav__link ">
    2.3.1.12. Package
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms-registry_olm-common-terms" class="j-doc-nav__link ">
    2.3.1.13. Registry
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms-subscription_olm-common-terms" class="j-doc-nav__link ">
    2.3.1.14. Subscription
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-common-terms-update-graph_olm-common-terms" class="j-doc-nav__link ">
    2.3.1.15. Update graph
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#operator-lifecycle-manager-olm" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4. Operator Lifecycle Manager (OLM)
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4. Operator Lifecycle Manager (OLM)"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4. Operator Lifecycle Manager (OLM)"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-understanding-olm" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.1. Operator Lifecycle Manager concepts and resources
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.1. Operator Lifecycle Manager concepts and resources"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.1. Operator Lifecycle Manager concepts and resources"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-overview_olm-understanding-olm" class="j-doc-nav__link ">
    2.4.1.1. What is Operator Lifecycle Manager?
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-resources_olm-understanding-olm" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.1.2. OLM resources
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.1.2. OLM resources"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.1.2. OLM resources"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-csv_olm-understanding-olm" class="j-doc-nav__link ">
    2.4.1.2.1. Cluster service version
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-catalogsource_olm-understanding-olm" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.1.2.2. Catalog source
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.1.2.2. Catalog source"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.1.2.2. Catalog source"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-catalogsource-image-template_olm-understanding-olm" class="j-doc-nav__link ">
    2.4.1.2.2.1. Image template for custom catalog sources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-cs-health_olm-understanding-olm" class="j-doc-nav__link ">
    2.4.1.2.2.2. Catalog health requirements
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-subscription_olm-understanding-olm" class="j-doc-nav__link ">
    2.4.1.2.3. Subscription
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-installplan_olm-understanding-olm" class="j-doc-nav__link ">
    2.4.1.2.4. Install plan
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorgroups-about_olm-understanding-olm" class="j-doc-nav__link ">
    2.4.1.2.5. Operator groups
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-about-operatorconditions_olm-understanding-olm" class="j-doc-nav__link ">
    2.4.1.2.6. Operator conditions
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-arch" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.2. Operator Lifecycle Manager architecture
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.2. Operator Lifecycle Manager architecture"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.2. Operator Lifecycle Manager architecture"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-architecture_olm-arch" class="j-doc-nav__link ">
    2.4.2.1. Component responsibilities
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-arch-olm-operator_olm-arch" class="j-doc-nav__link ">
    2.4.2.2. OLM Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-arch-catalog-operator_olm-arch" class="j-doc-nav__link ">
    2.4.2.3. Catalog Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-arch-catalog-registry_olm-arch" class="j-doc-nav__link ">
    2.4.2.4. Catalog Registry
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-workflow" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.3. Operator Lifecycle Manager workflow
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.3. Operator Lifecycle Manager workflow"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.3. Operator Lifecycle Manager workflow"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-upgrades_olm-workflow" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.3.1. Operator installation and upgrade workflow in OLM
  </a>
                              <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.3.1. Operator installation and upgrade workflow in OLM"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.3.1. Operator installation and upgrade workflow in OLM"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-upgrades-example-upgrade-path_olm-workflow" class="j-doc-nav__link ">
    2.4.3.1.1. Example upgrade path
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-upgrades-skipping_olm-workflow" class="j-doc-nav__link ">
    2.4.3.1.2. Skipping upgrades
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-upgrades-replacing-multiple_olm-workflow" class="j-doc-nav__link ">
    2.4.3.1.3. Replacing multiple Operators
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-upgrades-z-stream_olm-workflow" class="j-doc-nav__link ">
    2.4.3.1.4. Z-stream support
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-understanding-dependency-resolution" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.4. Operator Lifecycle Manager dependency resolution
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.4. Operator Lifecycle Manager dependency resolution"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.4. Operator Lifecycle Manager dependency resolution"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependency-resolution-about_olm-understanding-dependency-resolution" class="j-doc-nav__link ">
    2.4.4.1. About dependency resolution
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-properties_olm-understanding-dependency-resolution" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.4.2. Operator properties
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.4.2. Operator properties"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.4.2. Operator properties"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-arbitrary-properties_olm-understanding-dependency-resolution" class="j-doc-nav__link ">
    2.4.4.2.1. Arbitrary properties
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependencies_olm-understanding-dependency-resolution" class="j-doc-nav__link ">
    2.4.4.3. Operator dependencies
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-generic-constraints_olm-understanding-dependency-resolution" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.4.4. Generic constraints
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.4.4. Generic constraints"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.4.4. Generic constraints"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-cel_olm-understanding-dependency-resolution" class="j-doc-nav__link ">
    2.4.4.4.1. Common Expression Language (CEL) constraints
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-compound-constraints_olm-understanding-dependency-resolution" class="j-doc-nav__link ">
    2.4.4.4.2. Compound constraints (all, any, not)
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-nested-compound_olm-understanding-dependency-resolution" class="j-doc-nav__link ">
    2.4.4.4.3. Nested compound constraints
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependency-resolution-preferences_olm-understanding-dependency-resolution" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.4.5. Dependency preferences
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.4.5. Dependency preferences"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.4.5. Dependency preferences"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependency-catalog-priority_olm-understanding-dependency-resolution" class="j-doc-nav__link ">
    2.4.4.5.1. Catalog priority
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependency-catalog-ordering_olm-understanding-dependency-resolution" class="j-doc-nav__link ">
    2.4.4.5.2. Channel ordering
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependency-order-winthin-channel_olm-understanding-dependency-resolution" class="j-doc-nav__link ">
    2.4.4.5.3. Order within a channel
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependency-preferences-other_olm-understanding-dependency-resolution" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.4.5.4. Other constraints
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.4.5.4. Other constraints"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.4.5.4. Other constraints"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependency-sub-constraint_olm-understanding-dependency-resolution" class="j-doc-nav__link ">
    2.4.4.5.4.1. Subscription constraint
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependency-package-constraint_olm-understanding-dependency-resolution" class="j-doc-nav__link ">
    2.4.4.5.4.2. Package constraint
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#additional-resources_dependency-resolution-preferences" class="j-doc-nav__link ">
    2.4.4.5.5. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependency-resolution-crd-upgrades_olm-understanding-dependency-resolution" class="j-doc-nav__link ">
    2.4.4.6. CRD upgrades
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependency-best-practices_olm-understanding-dependency-resolution" class="j-doc-nav__link ">
    2.4.4.7. Dependency best practices
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependency-caveats_olm-understanding-dependency-resolution" class="j-doc-nav__link ">
    2.4.4.8. Dependency caveats
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependency-resolution-examples_olm-understanding-dependency-resolution" class="j-doc-nav__link ">
    2.4.4.9. Example dependency resolution scenarios
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-understanding-operatorgroups" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.5. Operator groups
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.5. Operator groups"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.5. Operator groups"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorgroups-about_olm-understanding-operatorgroups" class="j-doc-nav__link ">
    2.4.5.1. About Operator groups
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorgroups-membership_olm-understanding-operatorgroups" class="j-doc-nav__link ">
    2.4.5.2. Operator group membership
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorgroups-target-namespace_olm-understanding-operatorgroups" class="j-doc-nav__link ">
    2.4.5.3. Target namespace selection
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorgroups-csv-annotations_olm-understanding-operatorgroups" class="j-doc-nav__link ">
    2.4.5.4. Operator group CSV annotations
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorgroups-provided-apis-annotation_olm-understanding-operatorgroups" class="j-doc-nav__link ">
    2.4.5.5. Provided APIs annotation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorgroups-rbac_olm-understanding-operatorgroups" class="j-doc-nav__link ">
    2.4.5.6. Role-based access control
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorgroups-copied-csvs_olm-understanding-operatorgroups" class="j-doc-nav__link ">
    2.4.5.7. Copied CSVs
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorgroups-static_olm-understanding-operatorgroups" class="j-doc-nav__link ">
    2.4.5.8. Static Operator groups
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorgroups-intersection_olm-understanding-operatorgroups" class="j-doc-nav__link ">
    2.4.5.9. Operator group intersection
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorgroups-limitations" class="j-doc-nav__link ">
    2.4.5.10. Limitations for multitenant Operator management
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorgroups-troubleshooting_olm-understanding-operatorgroups" class="j-doc-nav__link ">
    2.4.5.11. Troubleshooting Operator groups
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-colocation" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.6. Multitenancy and Operator colocation
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.6. Multitenancy and Operator colocation"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.6. Multitenancy and Operator colocation"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-colocation-namespaces_olm-colocation" class="j-doc-nav__link ">
    2.4.6.1. Colocation of Operators in a namespace
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorconditions" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.7. Operator conditions
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.7. Operator conditions"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.7. Operator conditions"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-about-operatorconditions_olm-operatorconditions" class="j-doc-nav__link ">
    2.4.7.1. About Operator conditions
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-supported-operatorconditions_olm-operatorconditions" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.7.2. Supported conditions
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.7.2. Supported conditions"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.7.2. Supported conditions"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-upgradeable-operatorcondition_olm-operatorconditions" class="j-doc-nav__link ">
    2.4.7.2.1. Upgradeable condition
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorconditions-addtl-resources" class="j-doc-nav__link ">
    2.4.7.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-understanding-metrics" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.8. Operator Lifecycle Manager metrics
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.8. Operator Lifecycle Manager metrics"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.8. Operator Lifecycle Manager metrics"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-metrics_olm-understanding-metrics" class="j-doc-nav__link ">
    2.4.8.1. Exposed metrics
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-webhooks" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.4.9. Webhook management in Operator Lifecycle Manager
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.4.9. Webhook management in Operator Lifecycle Manager"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.4.9. Webhook management in Operator Lifecycle Manager"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-webhooks-additional-resources" class="j-doc-nav__link ">
    2.4.9.1. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-understanding-operatorhub" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5. Understanding OperatorHub
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5. Understanding OperatorHub"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5. Understanding OperatorHub"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorhub-overview_olm-understanding-operatorhub" class="j-doc-nav__link ">
    2.5.1. About OperatorHub
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorhub-arch_olm-understanding-operatorhub" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.5.2. OperatorHub architecture
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.5.2. OperatorHub architecture"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.5.2. OperatorHub architecture"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-operatorhub-arch-operatorhub_crd_olm-understanding-operatorhub" class="j-doc-nav__link ">
    2.5.2.1. OperatorHub custom resource
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-understanding-operatorhub-resources" class="j-doc-nav__link ">
    2.5.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-rh-catalogs" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.6. Red Hat-provided Operator catalogs
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.6. Red Hat-provided Operator catalogs"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.6. Red Hat-provided Operator catalogs"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-about-catalogs_olm-rh-catalogs" class="j-doc-nav__link ">
    2.6.1. About Operator catalogs
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-rh-catalogs_olm-rh-catalogs" class="j-doc-nav__link ">
    2.6.2. About Red Hat-provided Operator catalogs
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-multitenancy" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.7. Operators in multitenant clusters
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.7. Operators in multitenant clusters"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.7. Operators in multitenant clusters"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-default-install-modes-behavior_olm-multitenancy" class="j-doc-nav__link ">
    2.7.1. Default Operator install modes and behavior
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-multitenancy-solution_olm-multitenancy" class="j-doc-nav__link ">
    2.7.2. Recommended solution for multitenant clusters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-colocation_olm-multitenancy" class="j-doc-nav__link ">
    2.7.3. Operator colocation and Operator groups
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#crds" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.8. CRDs
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.8. CRDs"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.8. CRDs"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#crd-extending-api-with-crds" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.8.1. Extending the Kubernetes API with custom resource definitions
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.8.1. Extending the Kubernetes API with custom resource definitions"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.8.1. Extending the Kubernetes API with custom resource definitions"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#crd-custom-resource-definitions_crd-extending-api-with-crds" class="j-doc-nav__link ">
    2.8.1.1. Custom resource definitions
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#crd-creating-custom-resources-definition_crd-extending-api-with-crds" class="j-doc-nav__link ">
    2.8.1.2. Creating a custom resource definition
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#crd-creating-aggregated-cluster-role_crd-extending-api-with-crds" class="j-doc-nav__link ">
    2.8.1.3. Creating cluster roles for custom resource definitions
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#crd-creating-custom-resources-from-file_crd-extending-api-with-crds" class="j-doc-nav__link ">
    2.8.1.4. Creating custom resources from a file
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#crd-inspecting-custom-resources_crd-extending-api-with-crds" class="j-doc-nav__link ">
    2.8.1.5. Inspecting custom resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#crd-managing-resources-from-crds" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.8.2. Managing resources from custom resource definitions
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.8.2. Managing resources from custom resource definitions"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.8.2. Managing resources from custom resource definitions"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#crd-custom-resource-definitions_crd-managing-resources-from-crds" class="j-doc-nav__link ">
    2.8.2.1. Custom resource definitions
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#crd-creating-custom-resources-from-file_crd-managing-resources-from-crds" class="j-doc-nav__link ">
    2.8.2.2. Creating custom resources from a file
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#crd-inspecting-custom-resources_crd-managing-resources-from-crds" class="j-doc-nav__link ">
    2.8.2.3. Inspecting custom resources
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#user-tasks" class="j-doc-nav__link j-doc-nav__link--has-children">
    3. User tasks
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "3. User tasks"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "3. User tasks"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-creating-apps-from-installed-operators" class="j-doc-nav__link j-doc-nav__link--has-children">
    3.1. Creating applications from installed Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "3.1. Creating applications from installed Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "3.1. Creating applications from installed Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-creating-etcd-cluster-from-operator_olm-creating-apps-from-installed-operators" class="j-doc-nav__link ">
    3.1.1. Creating an etcd cluster using an Operator
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-installing-operators-in-namespace" class="j-doc-nav__link j-doc-nav__link--has-children">
    3.2. Installing Operators in your namespace
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "3.2. Installing Operators in your namespace"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "3.2. Installing Operators in your namespace"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-installing-operators-in-namespace-prereqs" class="j-doc-nav__link ">
    3.2.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-installing-operators-from-operatorhub_olm-installing-operators-in-namespace" class="j-doc-nav__link ">
    3.2.2. About Operator installation with OperatorHub
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-installing-from-operatorhub-using-web-console_olm-installing-operators-in-namespace" class="j-doc-nav__link ">
    3.2.3. Installing from OperatorHub using the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-installing-operator-from-operatorhub-using-cli_olm-installing-operators-in-namespace" class="j-doc-nav__link ">
    3.2.4. Installing from OperatorHub using the CLI
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-installing-specific-version-cli_olm-installing-operators-in-namespace" class="j-doc-nav__link ">
    3.2.5. Installing a specific version of an Operator
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#administrator-tasks" class="j-doc-nav__link j-doc-nav__link--has-children">
    4. Administrator tasks
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4. Administrator tasks"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4. Administrator tasks"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-adding-operators-to-a-cluster" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.1. Adding Operators to a cluster
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.1. Adding Operators to a cluster"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.1. Adding Operators to a cluster"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-installing-operators-from-operatorhub_olm-adding-operators-to-a-cluster" class="j-doc-nav__link ">
    4.1.1. About Operator installation with OperatorHub
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-installing-from-operatorhub-using-web-console_olm-adding-operators-to-a-cluster" class="j-doc-nav__link ">
    4.1.2. Installing from OperatorHub using the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-installing-operator-from-operatorhub-using-cli_olm-adding-operators-to-a-cluster" class="j-doc-nav__link ">
    4.1.3. Installing from OperatorHub using the CLI
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-installing-specific-version-cli_olm-adding-operators-to-a-cluster" class="j-doc-nav__link ">
    4.1.4. Installing a specific version of an Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-preparing-operators-multitenant_olm-adding-operators-to-a-cluster" class="j-doc-nav__link ">
    4.1.5. Preparing for multiple instances of an Operator for multitenant clusters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-installing-global-namespaces_olm-adding-operators-to-a-cluster" class="j-doc-nav__link ">
    4.1.6. Installing global Operators in custom namespaces
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-pod-placement_olm-adding-operators-to-a-cluster" class="j-doc-nav__link ">
    4.1.7. Pod placement of Operator workloads
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-overriding-operator-pod-affinity_olm-adding-operators-to-a-cluster" class="j-doc-nav__link ">
    4.1.8. Controlling where an Operator is installed
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-upgrading-operators" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.2. Updating installed Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.2. Updating installed Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.2. Updating installed Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-preparing-upgrade_olm-upgrading-operators" class="j-doc-nav__link ">
    4.2.1. Preparing for an Operator update
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-changing-update-channel_olm-upgrading-operators" class="j-doc-nav__link ">
    4.2.2. Changing the update channel for an Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-approving-pending-upgrade_olm-upgrading-operators" class="j-doc-nav__link ">
    4.2.3. Manually approving a pending Operator update
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-deleting-operators-from-a-cluster" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.3. Deleting Operators from a cluster
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.3. Deleting Operators from a cluster"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.3. Deleting Operators from a cluster"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-deleting-operators-from-a-cluster-using-web-console_olm-deleting-operators-from-a-cluster" class="j-doc-nav__link ">
    4.3.1. Deleting Operators from a cluster using the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-deleting-operator-from-a-cluster-using-cli_olm-deleting-operators-from-a-cluster" class="j-doc-nav__link ">
    4.3.2. Deleting Operators from a cluster using the CLI
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-refresh-subs_olm-deleting-operators-from-a-cluster" class="j-doc-nav__link ">
    4.3.3. Refreshing failing subscriptions
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-config" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.4. Configuring Operator Lifecycle Manager features
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.4. Configuring Operator Lifecycle Manager features"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.4. Configuring Operator Lifecycle Manager features"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-disabling-copied-csvs_olm-config" class="j-doc-nav__link ">
    4.4.1. Disabling copied CSVs
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-configuring-proxy-support" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.5. Configuring proxy support in Operator Lifecycle Manager
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.5. Configuring proxy support in Operator Lifecycle Manager"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.5. Configuring proxy support in Operator Lifecycle Manager"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-overriding-proxy-settings_olm-configuring-proxy-support" class="j-doc-nav__link ">
    4.5.1. Overriding proxy settings of an Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-inject-custom-ca_olm-configuring-proxy-support" class="j-doc-nav__link ">
    4.5.2. Injecting a custom CA certificate
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-status" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.6. Viewing Operator status
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.6. Viewing Operator status"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.6. Viewing Operator status"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-status-conditions_olm-status" class="j-doc-nav__link ">
    4.6.1. Operator subscription condition types
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-status-viewing-cli_olm-status" class="j-doc-nav__link ">
    4.6.2. Viewing Operator subscription status by using the CLI
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-cs-status-cli_olm-status" class="j-doc-nav__link ">
    4.6.3. Viewing Operator catalog source status by using the CLI
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-managing-operatorconditions" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.7. Managing Operator conditions
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.7. Managing Operator conditions"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.7. Managing Operator conditions"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-supported-operatorconditions_olm-managing-operatorconditions" class="j-doc-nav__link ">
    4.7.1. Overriding Operator conditions
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-updating-use-operatorconditions_olm-managing-operatorconditions" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.7.2. Updating your Operator to use Operator conditions
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.7.2. Updating your Operator to use Operator conditions"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.7.2. Updating your Operator to use Operator conditions"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-updating-use-operatorconditions-defaults_olm-managing-operatorconditions" class="j-doc-nav__link ">
    4.7.2.1. Setting defaults
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-managing-operatorconditions-addtl-resources" class="j-doc-nav__link ">
    4.7.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-creating-policy" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.8. Allowing non-cluster administrators to install Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.8. Allowing non-cluster administrators to install Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.8. Allowing non-cluster administrators to install Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-policy-understanding_olm-creating-policy" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.8.1. Understanding Operator installation policy
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.8.1. Understanding Operator installation policy"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.8.1. Understanding Operator installation policy"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-policy-scenarios_olm-creating-policy" class="j-doc-nav__link ">
    4.8.1.1. Installation scenarios
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-policy-workflow_olm-creating-policy" class="j-doc-nav__link ">
    4.8.1.2. Installation workflow
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-policy-scoping-operator-install_olm-creating-policy" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.8.2. Scoping Operator installations
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.8.2. Scoping Operator installations"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.8.2. Scoping Operator installations"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-policy-fine-grained-permissions_olm-creating-policy" class="j-doc-nav__link ">
    4.8.2.1. Fine-grained permissions
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-policy-catalog-access_olm-creating-policy" class="j-doc-nav__link ">
    4.8.3. Operator catalog access control
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-policy-troubleshooting_olm-creating-policy" class="j-doc-nav__link ">
    4.8.4. Troubleshooting permission failures
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-managing-custom-catalogs" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.9. Managing custom catalogs
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.9. Managing custom catalogs"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.9. Managing custom catalogs"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-managing-custom-catalogs-bundle-format-prereqs" class="j-doc-nav__link ">
    4.9.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-managing-custom-catalogs-fb" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.9.2. File-based catalogs
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.9.2. File-based catalogs"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.9.2. File-based catalogs"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-creating-fb-catalog-image_olm-managing-custom-catalogs" class="j-doc-nav__link ">
    4.9.2.1. Creating a file-based catalog image
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-filtering-fbc_olm-managing-custom-catalogs" class="j-doc-nav__link ">
    4.9.2.2. Updating or filtering a file-based catalog image
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-managing-custom-catalogs-sqlite" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.9.3. SQLite-based catalogs
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.9.3. SQLite-based catalogs"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.9.3. SQLite-based catalogs"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-creating-index-image_olm-managing-custom-catalogs" class="j-doc-nav__link ">
    4.9.3.1. Creating a SQLite-based index image
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-updating-index-image_olm-managing-custom-catalogs" class="j-doc-nav__link ">
    4.9.3.2. Updating a SQLite-based index image
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-pruning-index-image_olm-managing-custom-catalogs" class="j-doc-nav__link ">
    4.9.3.3. Filtering a SQLite-based index image
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-catalog-sources-and-psa_olm-managing-custom-catalogs" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.9.4. Catalog sources and pod security admission
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.9.4. Catalog sources and pod security admission"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.9.4. Catalog sources and pod security admission"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-migrating-sqlite-catalog-to-fbc_olm-managing-custom-catalogs" class="j-doc-nav__link ">
    4.9.4.1. Migrating SQLite database catalogs to the file-based catalog format
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-updating-sqlite-catalog-to-a-new-opm-version_olm-managing-custom-catalogs" class="j-doc-nav__link ">
    4.9.4.2. Rebuilding SQLite database catalog images
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-sqlite-catalog-elevated-privileges_olm-managing-custom-catalogs" class="j-doc-nav__link ">
    4.9.4.3. Configuring catalogs to run with elevated permissions
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-creating-catalog-from-index_olm-managing-custom-catalogs" class="j-doc-nav__link ">
    4.9.5. Adding a catalog source to a cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-accessing-images-private-registries_olm-managing-custom-catalogs" class="j-doc-nav__link ">
    4.9.6. Accessing images for Operators from private registries
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-restricted-networks-operatorhub_olm-managing-custom-catalogs" class="j-doc-nav__link ">
    4.9.7. Disabling the default OperatorHub catalog sources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-removing-catalogs_olm-managing-custom-catalogs" class="j-doc-nav__link ">
    4.9.8. Removing custom catalogs
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-restricted-networks" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.10. Using Operator Lifecycle Manager on restricted networks
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.10. Using Operator Lifecycle Manager on restricted networks"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.10. Using Operator Lifecycle Manager on restricted networks"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-restricted-network-prereqs" class="j-doc-nav__link ">
    4.10.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-restricted-networks-operatorhub_olm-restricted-networks" class="j-doc-nav__link ">
    4.10.2. Disabling the default OperatorHub catalog sources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-mirror-catalog_olm-restricted-networks" class="j-doc-nav__link ">
    4.10.3. Mirroring an Operator catalog
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-creating-catalog-from-index_olm-restricted-networks" class="j-doc-nav__link ">
    4.10.4. Adding a catalog source to a cluster
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-cs-podsched" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.11. Catalog source pod scheduling
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.11. Catalog source pod scheduling"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.11. Catalog source pod scheduling"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#disabling-catalogsource-objects_olm-cs-podsched" class="j-doc-nav__link ">
    4.11.1. Disabling default CatalogSource objects at a local level
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-node-selector_olm-cs-podsched" class="j-doc-nav__link ">
    4.11.2. Overriding the node selector for catalog source pods
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-priority-class-name_olm-cs-podsched" class="j-doc-nav__link ">
    4.11.3. Overriding the priority class name for catalog source pods
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-tolerations_olm-cs-podsched" class="j-doc-nav__link ">
    4.11.4. Overriding tolerations for catalog source pods
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-managing-po" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.12. Managing platform Operators (Technology Preview)
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.12. Managing platform Operators (Technology Preview)"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.12. Managing platform Operators (Technology Preview)"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#platform-operators_olm-managing-po" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.12.1. About platform Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.12.1. About platform Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.12.1. About platform Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-po-techpreview_olm-managing-po" class="j-doc-nav__link ">
    4.12.1.1. Technology Preview restrictions for platform Operators
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#prerequisites_olm-managing-po" class="j-doc-nav__link ">
    4.12.2. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-installing-po-during_olm-managing-po" class="j-doc-nav__link ">
    4.12.3. Installing platform Operators during cluster creation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-installing-po-after_olm-managing-po" class="j-doc-nav__link ">
    4.12.4. Installing platform Operators after cluster creation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-deleting-po_olm-managing-po" class="j-doc-nav__link ">
    4.12.5. Deleting platform Operators
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#developing-operators" class="j-doc-nav__link j-doc-nav__link--has-children">
    5. Developing Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5. Developing Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5. Developing Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-about" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.1. About the Operator SDK
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.1. About the Operator SDK"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.1. About the Operator SDK"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-about-what-are-operators" class="j-doc-nav__link ">
    5.1.1. What are Operators?
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-workflow_osdk-about" class="j-doc-nav__link ">
    5.1.2. Development workflow
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-about-addtl-resources" class="j-doc-nav__link ">
    5.1.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-installing-cli" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2. Installing the Operator SDK CLI
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2. Installing the Operator SDK CLI"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2. Installing the Operator SDK CLI"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-installing-cli-linux-macos_osdk-installing-cli" class="j-doc-nav__link ">
    5.2.1. Installing the Operator SDK CLI on Linux
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-installing-cli-macos_osdk-installing-cli" class="j-doc-nav__link ">
    5.2.2. Installing the Operator SDK CLI on macOS
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#go-based-operators" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3. Go-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3. Go-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3. Go-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-quickstart" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.1. Getting started with Operator SDK for Go-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.1. Getting started with Operator SDK for Go-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.1. Getting started with Operator SDK for Go-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-common-prereqs_osdk-golang-quickstart" class="j-doc-nav__link ">
    5.3.1.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-quickstart_osdk-golang-quickstart" class="j-doc-nav__link ">
    5.3.1.2. Creating and deploying Go-based Operators
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-quickstart-next-steps" class="j-doc-nav__link ">
    5.3.1.3. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.2. Operator SDK tutorial for Go-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.2. Operator SDK tutorial for Go-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.2. Operator SDK tutorial for Go-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-common-prereqs_osdk-golang-tutorial" class="j-doc-nav__link ">
    5.3.2.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-create-project_osdk-golang-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.2.2. Creating a project
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.2.2. Creating a project"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.2.2. Creating a project"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-project-file_osdk-golang-tutorial" class="j-doc-nav__link ">
    5.3.2.2.1. PROJECT file
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-manager_osdk-golang-tutorial" class="j-doc-nav__link ">
    5.3.2.2.2. About the Manager
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-multi-group-apis_osdk-golang-tutorial" class="j-doc-nav__link ">
    5.3.2.2.3. About multi-group APIs
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-create-api-controller_osdk-golang-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.2.3. Creating an API and controller
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.2.3. Creating an API and controller"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.2.3. Creating an API and controller"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-define-api_osdk-golang-tutorial" class="j-doc-nav__link ">
    5.3.2.3.1. Defining the API
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-generate-crd_osdk-golang-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.2.3.2. Generating CRD manifests
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.2.3.2. Generating CRD manifests"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.2.3.2. Generating CRD manifests"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-about-openapi-validation_osdk-golang-tutorial" class="j-doc-nav__link ">
    5.3.2.3.2.1. About OpenAPI validation
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-implement-controller_osdk-golang-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.2.4. Implementing the controller
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.2.4. Implementing the controller"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.2.4. Implementing the controller"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-controller-resources_osdk-golang-tutorial" class="j-doc-nav__link ">
    5.3.2.4.1. Resources watched by the controller
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-controller-configs_osdk-golang-tutorial" class="j-doc-nav__link ">
    5.3.2.4.2. Controller configurations
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-controller-reconcile-loop_osdk-golang-tutorial" class="j-doc-nav__link ">
    5.3.2.4.3. Reconcile loop
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-controller-rbac-markers_osdk-golang-tutorial" class="j-doc-nav__link ">
    5.3.2.4.4. Permissions and RBAC manifests
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-proxy_osdk-golang-tutorial" class="j-doc-nav__link ">
    5.3.2.5. Enabling proxy support
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-operator_osdk-golang-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.2.6. Running the Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.2.6. Running the Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.2.6. Running the Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-locally_osdk-golang-tutorial" class="j-doc-nav__link ">
    5.3.2.6.1. Running locally outside the cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-deployment_osdk-golang-tutorial" class="j-doc-nav__link ">
    5.3.2.6.2. Running as a deployment on the cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-bundle-deploy-olm_osdk-golang-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.2.6.3. Bundling an Operator and deploying with Operator Lifecycle Manager
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.2.6.3. Bundling an Operator and deploying with Operator Lifecycle Manager"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.2.6.3. Bundling an Operator and deploying with Operator Lifecycle Manager"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-bundle-operator_osdk-golang-tutorial" class="j-doc-nav__link ">
    5.3.2.6.3.1. Bundling an Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-deploy-olm_osdk-golang-tutorial" class="j-doc-nav__link ">
    5.3.2.6.3.2. Deploying an Operator with Operator Lifecycle Manager
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-create-cr_osdk-golang-tutorial" class="j-doc-nav__link ">
    5.3.2.7. Creating a custom resource
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-tutorial-addtl-resources" class="j-doc-nav__link ">
    5.3.2.8. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-project-layout" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.3. Project layout for Go-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.3. Project layout for Go-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.3. Project layout for Go-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-project-layout_osdk-golang-project-layout" class="j-doc-nav__link ">
    5.3.3.1. Go-based project layout
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-golang-updating-projects" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3.4. Updating Go-based Operator projects for newer Operator SDK versions
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3.4. Updating Go-based Operator projects for newer Operator SDK versions"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3.4. Updating Go-based Operator projects for newer Operator SDK versions"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-upgrading-projects_osdk-golang-updating-projects" class="j-doc-nav__link ">
    5.3.4.1. Updating Go-based Operator projects for Operator SDK 1.28.0
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#additional-resources_osdk-upgrading-projects-golang" class="j-doc-nav__link ">
    5.3.4.2. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#ansible-based-operators" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4. Ansible-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4. Ansible-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4. Ansible-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-quickstart" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.1. Getting started with Operator SDK for Ansible-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.1. Getting started with Operator SDK for Ansible-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.1. Getting started with Operator SDK for Ansible-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-common-prereqs_osdk-ansible-quickstart" class="j-doc-nav__link ">
    5.4.1.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-quickstart_osdk-ansible-quickstart" class="j-doc-nav__link ">
    5.4.1.2. Creating and deploying Ansible-based Operators
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-quickstart-next-steps" class="j-doc-nav__link ">
    5.4.1.3. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.2. Operator SDK tutorial for Ansible-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.2. Operator SDK tutorial for Ansible-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.2. Operator SDK tutorial for Ansible-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-common-prereqs_osdk-ansible-tutorial" class="j-doc-nav__link ">
    5.4.2.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-create-project_osdk-ansible-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.2.2. Creating a project
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.2.2. Creating a project"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.2.2. Creating a project"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-project-file_osdk-ansible-tutorial" class="j-doc-nav__link ">
    5.4.2.2.1. PROJECT file
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-create-api-controller_osdk-ansible-tutorial" class="j-doc-nav__link ">
    5.4.2.3. Creating an API
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-modify-manager_osdk-ansible-tutorial" class="j-doc-nav__link ">
    5.4.2.4. Modifying the manager
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-proxy_osdk-ansible-tutorial" class="j-doc-nav__link ">
    5.4.2.5. Enabling proxy support
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-operator_osdk-ansible-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.2.6. Running the Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.2.6. Running the Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.2.6. Running the Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-locally_osdk-ansible-tutorial" class="j-doc-nav__link ">
    5.4.2.6.1. Running locally outside the cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-deployment_osdk-ansible-tutorial" class="j-doc-nav__link ">
    5.4.2.6.2. Running as a deployment on the cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-bundle-deploy-olm_osdk-ansible-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.2.6.3. Bundling an Operator and deploying with Operator Lifecycle Manager
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.2.6.3. Bundling an Operator and deploying with Operator Lifecycle Manager"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.2.6.3. Bundling an Operator and deploying with Operator Lifecycle Manager"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-bundle-operator_osdk-ansible-tutorial" class="j-doc-nav__link ">
    5.4.2.6.3.1. Bundling an Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-deploy-olm_osdk-ansible-tutorial" class="j-doc-nav__link ">
    5.4.2.6.3.2. Deploying an Operator with Operator Lifecycle Manager
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-create-cr_osdk-ansible-tutorial" class="j-doc-nav__link ">
    5.4.2.7. Creating a custom resource
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-tutorial-addtl-resources" class="j-doc-nav__link ">
    5.4.2.8. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-project-layout" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.3. Project layout for Ansible-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.3. Project layout for Ansible-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.3. Project layout for Ansible-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-project-layout_osdk-ansible-project-layout" class="j-doc-nav__link ">
    5.4.3.1. Ansible-based project layout
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-updating-projects" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.4. Updating projects for newer Operator SDK versions
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.4. Updating projects for newer Operator SDK versions"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.4. Updating projects for newer Operator SDK versions"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-upgrading-projects_osdk-ansible-updating-projects" class="j-doc-nav__link ">
    5.4.4.1. Updating Ansible-based Operator projects for Operator SDK 1.28.0
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#additional-resources_osdk-ansible-upgrading-projects" class="j-doc-nav__link ">
    5.4.4.2. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-support" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.5. Ansible support in Operator SDK
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.5. Ansible support in Operator SDK"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.5. Ansible support in Operator SDK"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-custom-resource-files_osdk-ansible-support" class="j-doc-nav__link ">
    5.4.5.1. Custom resource files
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-watches-file_osdk-ansible-support" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.5.2. watches.yaml file
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.5.2. watches.yaml file"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.5.2. watches.yaml file"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-watches-file-advanced_osdk-ansible-support" class="j-doc-nav__link ">
    5.4.5.2.1. Advanced options
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-extra-variables_osdk-ansible-support" class="j-doc-nav__link ">
    5.4.5.3. Extra variables sent to Ansible
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-runner-directory_osdk-ansible-support" class="j-doc-nav__link ">
    5.4.5.4. Ansible Runner directory
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-k8s-collection" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.6. Kubernetes Collection for Ansible
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.6. Kubernetes Collection for Ansible"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.6. Kubernetes Collection for Ansible"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-installing-k8s-collection_osdk-ansible-k8s-collection" class="j-doc-nav__link ">
    5.4.6.1. Installing the Kubernetes Collection for Ansible
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-k8s-local_osdk-ansible-k8s-collection" class="j-doc-nav__link ">
    5.4.6.2. Testing the Kubernetes Collection locally
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-k8s-collection-next-steps" class="j-doc-nav__link ">
    5.4.6.3. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-inside-operator" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.7. Using Ansible inside an Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.7. Using Ansible inside an Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.7. Using Ansible inside an Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-custom-resource-files_osdk-ansible-inside-operator" class="j-doc-nav__link ">
    5.4.7.1. Custom resource files
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-inside-operator-local_osdk-ansible-inside-operator" class="j-doc-nav__link ">
    5.4.7.2. Testing an Ansible-based Operator locally
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-deployment_osdk-ansible-inside-operator" class="j-doc-nav__link ">
    5.4.7.3. Testing an Ansible-based Operator on the cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-inside-operator-logs_osdk-ansible-inside-operator" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.7.4. Ansible logs
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.7.4. Ansible logs"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.7.4. Ansible logs"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-inside-operator-logs-view_osdk-ansible-inside-operator" class="j-doc-nav__link ">
    5.4.7.4.1. Viewing Ansible logs
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-inside-operator-logs-full-result_osdk-ansible-inside-operator" class="j-doc-nav__link ">
    5.4.7.4.2. Enabling full Ansible results in logs
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-inside-operator-logs-verbose_osdk-ansible-inside-operator" class="j-doc-nav__link ">
    5.4.7.4.3. Enabling verbose debugging in logs
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-cr-status" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.8. Custom resource status management
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.8. Custom resource status management"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.8. Custom resource status management"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-cr-status-about_osdk-ansible-cr-mgmt" class="j-doc-nav__link ">
    5.4.8.1. About custom resource status in Ansible-based Operators
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-cr-status-manual_osdk-ansible-cr-mgmt" class="j-doc-nav__link ">
    5.4.8.2. Tracking custom resource status manually
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#helm-based-operators" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5. Helm-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5. Helm-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5. Helm-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-helm-quickstart" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.1. Getting started with Operator SDK for Helm-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.1. Getting started with Operator SDK for Helm-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.1. Getting started with Operator SDK for Helm-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-common-prereqs_osdk-helm-quickstart" class="j-doc-nav__link ">
    5.5.1.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-quickstart_osdk-helm-quickstart" class="j-doc-nav__link ">
    5.5.1.2. Creating and deploying Helm-based Operators
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-helm-quickstart-next-steps" class="j-doc-nav__link ">
    5.5.1.3. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-helm-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.2. Operator SDK tutorial for Helm-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.2. Operator SDK tutorial for Helm-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.2. Operator SDK tutorial for Helm-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-common-prereqs_osdk-helm-tutorial" class="j-doc-nav__link ">
    5.5.2.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-create-project_osdk-helm-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.2.2. Creating a project
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.2.2. Creating a project"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.2.2. Creating a project"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-helm-existing-chart_osdk-helm-tutorial" class="j-doc-nav__link ">
    5.5.2.2.1. Existing Helm charts
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-project-file_osdk-helm-tutorial" class="j-doc-nav__link ">
    5.5.2.2.2. PROJECT file
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-helm-logic_osdk-helm-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.2.3. Understanding the Operator logic
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.2.3. Understanding the Operator logic"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.2.3. Understanding the Operator logic"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-helm-sample-chart_osdk-helm-tutorial" class="j-doc-nav__link ">
    5.5.2.3.1. Sample Helm chart
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-helm-modify-cr_osdk-helm-tutorial" class="j-doc-nav__link ">
    5.5.2.3.2. Modifying the custom resource spec
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-proxy_osdk-helm-tutorial" class="j-doc-nav__link ">
    5.5.2.4. Enabling proxy support
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-operator_osdk-helm-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.2.5. Running the Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.2.5. Running the Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.2.5. Running the Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-locally_osdk-helm-tutorial" class="j-doc-nav__link ">
    5.5.2.5.1. Running locally outside the cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-deployment_osdk-helm-tutorial" class="j-doc-nav__link ">
    5.5.2.5.2. Running as a deployment on the cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-bundle-deploy-olm_osdk-helm-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.2.5.3. Bundling an Operator and deploying with Operator Lifecycle Manager
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.2.5.3. Bundling an Operator and deploying with Operator Lifecycle Manager"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.2.5.3. Bundling an Operator and deploying with Operator Lifecycle Manager"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-bundle-operator_osdk-helm-tutorial" class="j-doc-nav__link ">
    5.5.2.5.3.1. Bundling an Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-deploy-olm_osdk-helm-tutorial" class="j-doc-nav__link ">
    5.5.2.5.3.2. Deploying an Operator with Operator Lifecycle Manager
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-create-cr_osdk-helm-tutorial" class="j-doc-nav__link ">
    5.5.2.6. Creating a custom resource
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-helm-tutorial-addtl-resources" class="j-doc-nav__link ">
    5.5.2.7. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-helm-project-layout" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.3. Project layout for Helm-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.3. Project layout for Helm-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.3. Project layout for Helm-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-helm-project-layout_osdk-helm-project-layout" class="j-doc-nav__link ">
    5.5.3.1. Helm-based project layout
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-helm-updating-projects" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.4. Updating Helm-based projects for newer Operator SDK versions
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.4. Updating Helm-based projects for newer Operator SDK versions"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.4. Updating Helm-based projects for newer Operator SDK versions"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-upgrading-projects_osdk-helm-updating-projects" class="j-doc-nav__link ">
    5.5.4.1. Updating Helm-based Operator projects for Operator SDK 1.28.0
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#additional-resources_osdk-helm-upgrading-projects" class="j-doc-nav__link ">
    5.5.4.2. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-helm-support" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.5. Helm support in Operator SDK
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.5. Helm support in Operator SDK"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.5. Helm support in Operator SDK"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-helm-charts_osdk-helm-support" class="j-doc-nav__link ">
    5.5.5.1. Helm charts
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-hybrid-helm" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.6. Operator SDK tutorial for Hybrid Helm Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.6. Operator SDK tutorial for Hybrid Helm Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.6. Operator SDK tutorial for Hybrid Helm Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-common-prereqs_osdk-hybrid-helm" class="j-doc-nav__link ">
    5.5.6.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-hh-create-project_osdk-hybrid-helm" class="j-doc-nav__link ">
    5.5.6.2. Creating a project
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-hh-create-helm-api_osdk-hybrid-helm" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.6.3. Creating a Helm API
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.6.3. Creating a Helm API"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.6.3. Creating a Helm API"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-hh-helm-api-logic_osdk-hybrid-helm" class="j-doc-nav__link ">
    5.5.6.3.1. Operator logic for the Helm API
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-hh-helm-reconciler_osdk-hybrid-helm" class="j-doc-nav__link ">
    5.5.6.3.2. Custom Helm reconciler configurations using provided library APIs
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-hh-create-go-api_osdk-hybrid-helm" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.6.4. Creating a Go API
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.6.4. Creating a Go API"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.6.4. Creating a Go API"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-hh-defining-go-api_osdk-hybrid-helm" class="j-doc-nav__link ">
    5.5.6.4.1. Defining the API
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-hh-implement-controller_osdk-hybrid-helm" class="j-doc-nav__link ">
    5.5.6.4.2. Controller implementation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-hh-main-go_osdk-hybrid-helm" class="j-doc-nav__link ">
    5.5.6.4.3. Differences in main.go
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-hh-rbac_osdk-hybrid-helm" class="j-doc-nav__link ">
    5.5.6.4.4. Permissions and RBAC manifests
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-locally_osdk-hybrid-helm" class="j-doc-nav__link ">
    5.5.6.5. Running locally outside the cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-deployment_osdk-hybrid-helm" class="j-doc-nav__link ">
    5.5.6.6. Running as a deployment on the cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-hh-create-cr_osdk-hybrid-helm" class="j-doc-nav__link ">
    5.5.6.7. Creating custom resources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-hh-project-layout_osdk-hybrid-helm" class="j-doc-nav__link ">
    5.5.6.8. Project layout
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-hybrid-helm-updating-projects" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.5.7. Updating Hybrid Helm-based projects for newer Operator SDK versions
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.5.7. Updating Hybrid Helm-based projects for newer Operator SDK versions"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.5.7. Updating Hybrid Helm-based projects for newer Operator SDK versions"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-upgrading-projects_osdk-hybrid-helm-updating-projects" class="j-doc-nav__link ">
    5.5.7.1. Updating Hybrid Helm-based Operator projects for Operator SDK 1.28.0
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#additional-resources_osdk-hybrid-helm-upgrading-projects" class="j-doc-nav__link ">
    5.5.7.2. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#java-based-operators" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.6. Java-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.6. Java-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.6. Java-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-java-quickstart" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.6.1. Getting started with Operator SDK for Java-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.6.1. Getting started with Operator SDK for Java-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.6.1. Getting started with Operator SDK for Java-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-common-prereqs_osdk-java-quickstart" class="j-doc-nav__link ">
    5.6.1.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-quickstart_osdk-java-quickstart" class="j-doc-nav__link ">
    5.6.1.2. Creating and deploying Java-based Operators
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#next-steps_osdk-java-quickstart" class="j-doc-nav__link ">
    5.6.1.3. Next steps
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-java-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.6.2. Operator SDK tutorial for Java-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.6.2. Operator SDK tutorial for Java-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.6.2. Operator SDK tutorial for Java-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-common-prereqs_osdk-java-tutorial" class="j-doc-nav__link ">
    5.6.2.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-create-project_osdk-java-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.6.2.2. Creating a project
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.6.2.2. Creating a project"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.6.2.2. Creating a project"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-project-file_osdk-java-tutorial" class="j-doc-nav__link ">
    5.6.2.2.1. PROJECT file
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-java-create-api-controller_osdk-java-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.6.2.3. Creating an API and controller
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.6.2.3. Creating an API and controller"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.6.2.3. Creating an API and controller"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-java-define-api_osdk-java-tutorial" class="j-doc-nav__link ">
    5.6.2.3.1. Defining the API
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-java-generate-crd_osdk-java-tutorial" class="j-doc-nav__link ">
    5.6.2.3.2. Generating CRD manifests
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-java-create-cr_osdk-java-tutorial" class="j-doc-nav__link ">
    5.6.2.3.3. Creating a Custom Resource
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-java-implement-controller_osdk-java-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.6.2.4. Implementing the controller
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.6.2.4. Implementing the controller"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.6.2.4. Implementing the controller"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-java-controller-reconcile-loop_osdk-java-tutorial" class="j-doc-nav__link ">
    5.6.2.4.1. Reconcile loop
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-java-controller-labels-memcached_osdk-java-tutorial" class="j-doc-nav__link ">
    5.6.2.4.2. Defining labelsForMemcached
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-java-controller-memcached-deployment_osdk-java-tutorial" class="j-doc-nav__link ">
    5.6.2.4.3. Define the createMemcachedDeployment
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-operator_osdk-java-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.6.2.5. Running the Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.6.2.5. Running the Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.6.2.5. Running the Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-locally_osdk-java-tutorial" class="j-doc-nav__link ">
    5.6.2.5.1. Running locally outside the cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-run-deployment_osdk-java-tutorial" class="j-doc-nav__link ">
    5.6.2.5.2. Running as a deployment on the cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-bundle-deploy-olm_osdk-java-tutorial" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.6.2.5.3. Bundling an Operator and deploying with Operator Lifecycle Manager
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.6.2.5.3. Bundling an Operator and deploying with Operator Lifecycle Manager"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.6.2.5.3. Bundling an Operator and deploying with Operator Lifecycle Manager"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-bundle-operator_osdk-java-tutorial" class="j-doc-nav__link ">
    5.6.2.5.3.1. Bundling an Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-deploy-olm_osdk-java-tutorial" class="j-doc-nav__link ">
    5.6.2.5.3.2. Deploying an Operator with Operator Lifecycle Manager
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#additional-resources_osdk-java-tutorial" class="j-doc-nav__link ">
    5.6.2.6. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-java-project-layout" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.6.3. Project layout for Java-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.6.3. Project layout for Java-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.6.3. Project layout for Java-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-java-project-layout_osdk-java-project-layout" class="j-doc-nav__link ">
    5.6.3.1. Java-based project layout
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-java-updating-projects" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.6.4. Updating projects for newer Operator SDK versions
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.6.4. Updating projects for newer Operator SDK versions"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.6.4. Updating projects for newer Operator SDK versions"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-upgrading-projects_osdk-java-updating-projects" class="j-doc-nav__link ">
    5.6.4.1. Updating Java-based Operator projects for Operator SDK 1.28.0
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#additional-resources_osdk-java-upgrading-projects" class="j-doc-nav__link ">
    5.6.4.2. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-generating-csvs" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.7. Defining cluster service versions (CSVs)
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.7. Defining cluster service versions (CSVs)"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.7. Defining cluster service versions (CSVs)"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-how-csv-gen-works_osdk-generating-csvs" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.7.1. How CSV generation works
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.7.1. How CSV generation works"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.7.1. How CSV generation works"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-csv-bundle-files_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.1.1. Generated files and resources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-csv-ver_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.1.2. Version management
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-manually-defined-csv-fields_osdk-generating-csvs" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.7.2. Manually-defined CSV fields
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.7.2. Manually-defined CSV fields"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.7.2. Manually-defined CSV fields"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-csv-manual-annotations_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.2.1. Operator metadata annotations
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-enabling-operator-for-restricted-network_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.3. Enabling your Operator for restricted network environments
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-enabling-operator-for-multi-arch_osdk-generating-csvs" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.7.4. Enabling your Operator for multiple architectures and operating systems
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.7.4. Enabling your Operator for multiple architectures and operating systems"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.7.4. Enabling your Operator for multiple architectures and operating systems"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-arch-os-support_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.4.1. Architecture and operating system support for Operators
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-suggested-namespace_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.5. Setting a suggested namespace
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-suggested-namespace-default-node_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.6. Setting a suggested namespace with default node selector
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-operatorconditions_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.7. Enabling Operator conditions
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-defining-csv-webhook_osdk-generating-csvs" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.7.8. Defining webhooks
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.7.8. Defining webhooks"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.7.8. Defining webhooks"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-webhook-considerations_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.8.1. Webhook considerations for OLM
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-crds_osdk-generating-csvs" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.7.9. Understanding your custom resource definitions (CRDs)
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.7.9. Understanding your custom resource definitions (CRDs)"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.7.9. Understanding your custom resource definitions (CRDs)"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-crds-owned_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.9.1. Owned CRDs
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-crds-required_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.9.2. Required CRDs
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependency-resolution-crd-upgrades_osdk-generating-csvs" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.7.9.3. CRD upgrades
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.7.9.3. CRD upgrades"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.7.9.3. CRD upgrades"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependency-resolution-adding-new-crd-version_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.9.3.1. Adding a new CRD version
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#olm-dependency-resolution-removing-crd-version_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.9.3.2. Deprecating or removing a CRD version
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-crds-templates_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.9.4. CRD templates
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-hiding-internal-objects_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.9.5. Hiding internal objects
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-init-resource_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.9.6. Initializing required custom resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-apiservices_osdk-generating-csvs" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.7.10. Understanding your API services
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.7.10. Understanding your API services"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.7.10. Understanding your API services"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-apiservices-owned_osdk-generating-csvs" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.7.10.1. Owned API services
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.7.10.1. Owned API services"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.7.10.1. Owned API services"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-apiservices-resource-creation_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.10.1.1. API service resource creation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-apiservices-service-certs_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.10.1.2. API service serving certificates
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-apiservice-required_osdk-generating-csvs" class="j-doc-nav__link ">
    5.7.10.2. Required API services
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-working-bundle-images" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.8. Working with bundle images
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.8. Working with bundle images"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.8. Working with bundle images"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-bundle-operator_osdk-working-bundle-images" class="j-doc-nav__link ">
    5.8.1. Bundling an Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-deploy-olm_osdk-working-bundle-images" class="j-doc-nav__link ">
    5.8.2. Deploying an Operator with Operator Lifecycle Manager
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-publish-catalog_osdk-working-bundle-images" class="j-doc-nav__link ">
    5.8.3. Publishing a catalog containing a bundled Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-bundle-upgrade-olm_osdk-working-bundle-images" class="j-doc-nav__link ">
    5.8.4. Testing an Operator upgrade on Operator Lifecycle Manager
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-control-compat_osdk-working-bundle-images" class="j-doc-nav__link ">
    5.8.5. Controlling Operator compatibility with OpenShift Container Platform versions
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-working-bundle-images-additional-resources" class="j-doc-nav__link ">
    5.8.6. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-complying-with-psa" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.9. Complying with pod security admission
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.9. Complying with pod security admission"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.9. Complying with pod security admission"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#security-context-constraints-psa-synchronization_osdk-complying-with-psa" class="j-doc-nav__link ">
    5.9.1. Security context constraint synchronization with pod security standards
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ensuring-operator-workloads-run-restricted-psa_osdk-complying-with-psa" class="j-doc-nav__link ">
    5.9.2. Ensuring Operator workloads run in namespaces set to the restricted pod security level
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-managing-psa-for-operators-with-escalated-permissions_osdk-complying-with-psa" class="j-doc-nav__link ">
    5.9.3. Managing pod security admission for Operator workloads that require escalated permissions
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-complying-with-psa-additional-resources" class="j-doc-nav__link ">
    5.9.4. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-scorecard" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.10. Validating Operators using the scorecard tool
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.10. Validating Operators using the scorecard tool"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.10. Validating Operators using the scorecard tool"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-about-scorecard_osdk-scorecard" class="j-doc-nav__link ">
    5.10.1. About the scorecard tool
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-scorecard-config_osdk-scorecard" class="j-doc-nav__link ">
    5.10.2. Scorecard configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-scorecard-tests_osdk-scorecard" class="j-doc-nav__link ">
    5.10.3. Built-in scorecard tests
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-scorecard-run_osdk-scorecard" class="j-doc-nav__link ">
    5.10.4. Running the scorecard tool
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-scorecard-output_osdk-scorecard" class="j-doc-nav__link ">
    5.10.5. Scorecard output
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-scorecard-select-tests_osdk-scorecard" class="j-doc-nav__link ">
    5.10.6. Selecting tests
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-scorecard-parallel_osdk-scorecard" class="j-doc-nav__link ">
    5.10.7. Enabling parallel testing
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-scorecard-custom-tests_osdk-scorecard" class="j-doc-nav__link ">
    5.10.8. Custom scorecard tests
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-bundle-validate" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.11. Validating Operator bundles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.11. Validating Operator bundles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.11. Validating Operator bundles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-about-bundle-validate_osdk-bundle-validate" class="j-doc-nav__link ">
    5.11.1. About the bundle validate command
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-bundle-validate-tests_osdk-bundle-validate" class="j-doc-nav__link ">
    5.11.2. Built-in bundle validate tests
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-bundle-validate-run_osdk-bundle-validate" class="j-doc-nav__link ">
    5.11.3. Running the bundle validate command
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ha-sno" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.12. High-availability or single-node cluster detection and support
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.12. High-availability or single-node cluster detection and support"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.12. High-availability or single-node cluster detection and support"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ha-sno-api_osdk-ha-sno" class="j-doc-nav__link ">
    5.12.1. About the cluster high-availability mode API
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ha-sno-api-examples_osdk-ha-sno" class="j-doc-nav__link ">
    5.12.2. Example API usage in Operator projects
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-monitoring-prometheus" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.13. Configuring built-in monitoring with Prometheus
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.13. Configuring built-in monitoring with Prometheus"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.13. Configuring built-in monitoring with Prometheus"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-monitoring-prometheus-operator-support_osdk-monitoring-prometheus" class="j-doc-nav__link ">
    5.13.1. Prometheus Operator support
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-monitoring-custom-metrics_osdk-monitoring-prometheus" class="j-doc-nav__link ">
    5.13.2. Exposing custom metrics for Go-based Operators
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-ansible-metrics_osdk-monitoring-prometheus" class="j-doc-nav__link ">
    5.13.3. Exposing custom metrics for Ansible-based Operators
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-leader-election" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.14. Configuring leader election
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.14. Configuring leader election"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.14. Configuring leader election"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-leader-election-types_osdk-leader-election" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.14.1. Operator leader election examples
  </a>
                              <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.14.1. Operator leader election examples"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.14.1. Operator leader election examples"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-leader-for-life-election_osdk-leader-election" class="j-doc-nav__link ">
    5.14.1.1. Leader-for-life election
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-leader-with-lease-election_osdk-leader-election" class="j-doc-nav__link ">
    5.14.1.2. Leader-with-lease election
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-pruning-utility" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.15. Object pruning utility for Go-based Operators
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.15. Object pruning utility for Go-based Operators"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.15. Object pruning utility for Go-based Operators"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-about-pruning-utility_osdk-pruning-utility" class="j-doc-nav__link ">
    5.15.1. About the operator-lib pruning utility
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-pruning-utility-config_osdk-pruning-utility" class="j-doc-nav__link ">
    5.15.2. Pruning utility configuration
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-pkgman-to-bundle" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.16. Migrating package manifest projects to bundle format
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.16. Migrating package manifest projects to bundle format"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.16. Migrating package manifest projects to bundle format"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-about-pkg-format-migration_osdk-pkgman-to-bundle" class="j-doc-nav__link ">
    5.16.1. About packaging format migration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-migrating-pkgman_osdk-pkgman-to-bundle" class="j-doc-nav__link ">
    5.16.2. Migrating a package manifest project to bundle format
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-cli-ref" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.17. Operator SDK CLI reference
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.17. Operator SDK CLI reference"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.17. Operator SDK CLI reference"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-cli-ref-bundle_osdk-cli-ref" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.17.1. bundle
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.17.1. bundle"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.17.1. bundle"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-cli-ref-bundle-validate_osdk-cli-ref" class="j-doc-nav__link ">
    5.17.1.1. validate
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-cli-ref-cleanup_osdk-cli-ref" class="j-doc-nav__link ">
    5.17.2. cleanup
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-cli-ref-completion_osdk-cli-ref" class="j-doc-nav__link ">
    5.17.3. completion
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-cli-ref-create_osdk-cli-ref" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.17.4. create
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.17.4. create"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.17.4. create"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-cli-ref-create-api_osdk-cli-ref" class="j-doc-nav__link ">
    5.17.4.1. api
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-cli-ref-generate_osdk-cli-ref" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.17.5. generate
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.17.5. generate"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.17.5. generate"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-cli-ref-generate-bundle_osdk-cli-ref" class="j-doc-nav__link ">
    5.17.5.1. bundle
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-cli-ref-generate-kustomize_osdk-cli-ref" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.17.5.2. kustomize
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.17.5.2. kustomize"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.17.5.2. kustomize"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-cli-ref-generate-kustomize-manifests_osdk-cli-ref" class="j-doc-nav__link ">
    5.17.5.2.1. manifests
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-cli-ref-init_osdk-cli-ref" class="j-doc-nav__link ">
    5.17.6. init
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-cli-ref-run_osdk-cli-ref" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.17.7. run
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.17.7. run"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.17.7. run"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-cli-ref-run-bundle_osdk-cli-ref" class="j-doc-nav__link ">
    5.17.7.1. bundle
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-cli-ref-run-bundle-upgrade_osdk-cli-ref" class="j-doc-nav__link ">
    5.17.7.2. bundle-upgrade
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#osdk-cli-ref-scorecard_osdk-cli-ref" class="j-doc-nav__link ">
    5.17.8. scorecard
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-operators-ref" class="j-doc-nav__link j-doc-nav__link--has-children">
    6. Cluster Operators reference
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6. Cluster Operators reference"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6. Cluster Operators reference"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-bare-metal-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.1. Cluster Baremetal Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#baremetal-event-relay_cluster-operators-ref" class="j-doc-nav__link ">
    6.2. Bare Metal Event Relay
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cloud-credential-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.3. Cloud Credential Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-authentication-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.4. Cluster Authentication Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-autoscaler-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.5. Cluster Autoscaler Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-cloud-controller-manager-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.6. Cluster Cloud Controller Manager Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-capi-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.7. Cluster CAPI Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-config-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.8. Cluster Config Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-csi-snapshot-controller-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.9. Cluster CSI Snapshot Controller Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-image-registry-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.10. Cluster Image Registry Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-machine-approver-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.11. Cluster Machine Approver Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-monitoring-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.12. Cluster Monitoring Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-network-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.13. Cluster Network Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-samples-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.14. Cluster Samples Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-storage-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.15. Cluster Storage Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-version-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.16. Cluster Version Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#console-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.17. Console Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#control-plane-machine-set-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.18. Control Plane Machine Set Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#dns-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.19. DNS Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#etcd-cluster-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.20. etcd cluster Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#ingress-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.21. Ingress Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#insights-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.22. Insights Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#kube-apiserver-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.23. Kubernetes API Server Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#kube-controller-manager-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.24. Kubernetes Controller Manager Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-kube-scheduler-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.25. Kubernetes Scheduler Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-kube-storage-version-migrator-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.26. Kubernetes Storage Version Migrator Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#machine-api-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.27. Machine API Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#machine-config-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.28. Machine Config Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#marketplace-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.29. Marketplace Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#about-node-tuning-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.30. Node Tuning Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#openshift-apiserver-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.31. OpenShift API Server Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-openshift-controller-manager-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.32. OpenShift Controller Manager Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#cluster-operators-ref-olm" class="j-doc-nav__link ">
    6.33. Operator Lifecycle Manager Operators
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#openshift-service-ca-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.34. OpenShift Service CA Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#vsphere-problem-detector-operator_cluster-operators-ref" class="j-doc-nav__link ">
    6.35. vSphere Problem Detector Operator
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                    

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators#idm139731989895296" class="j-doc-nav__link ">
    Legal Notice
  </a>
  
          </li>
              </ol>
    
  </div>
</nav>


              </div>
            </div>
            <div class="j-options-container j-options-container--mobile">
              <button class="j-sidebar__menu-trigger j-sidebar__menu-trigger--options content-expander__trigger">
                <span class="j-sidebar__menu-trigger__open-headline">
                  Settings
                </span>
                <span class="j-sidebar__menu-trigger__close-text">Close</span>
              </button>
              

  <ul class="j-doc-options__list content-expander">
    <li class="j-doc-options__item">
          <label class="j-doc-option__label j-doc-option__label--language" for="j-doc-language">
        Language:
      </label>
      <select id="j-doc-language" class="j-doc-option__select">
                  <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/operators" selected=''>
            English
          </option>
                  <option value="/documentation/ko-kr/openshift_container_platform/4.13/html-single/operators" >
            한국어
          </option>
                  <option value="/documentation/ja-jp/openshift_container_platform/4.13/html-single/operators" >
            日本語
          </option>
                  <option value="/documentation/zh-cn/openshift_container_platform/4.13/html-single/operators" >
            简体中文
          </option>
              </select>

            <noscript>
        <div class="j-doc-option__label j-doc-option__label--language" id="j-doc-option__label--language--nojs">
          Language:
        </div>
        <ul aria-labelledby="j-doc-option__label--language--nojs" class="j-doc-option__languages-list">
                      <li>
              <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators">English</a>
            </li>
                      <li>
              <a href="/documentation/ko-kr/openshift_container_platform/4.13/html-single/operators">한국어</a>
            </li>
                      <li>
              <a href="/documentation/ja-jp/openshift_container_platform/4.13/html-single/operators">日本語</a>
            </li>
                      <li>
              <a href="/documentation/zh-cn/openshift_container_platform/4.13/html-single/operators">简体中文</a>
            </li>
                  </ul>
      </noscript>

      </li>

    <li class="j-doc-options__item">
    <label for="j-doc-mode" class="j-doc-option__label j-doc-option__label--format">
      Format:
    </label>
    <select id="j-doc-mode" class="j-doc-option__select">
              <option value="/documentation/en-us/openshift_container_platform/4.13/html/operators"  class="j-doc-options__option j-doc-options__option--multi-page">
          Multi-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/operators" selected='' class="j-doc-options__option j-doc-options__option--single-page">
          Single-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/pdf/operators/OpenShift_Container_Platform-4.13-Operators-en-US.pdf"  class="j-doc-options__option j-doc-options__option--pdf">
          PDF
        </option>
          </select>

        <noscript>
      <div class="j-doc-option__label j-doc-option__label--format" id="j-doc-option__label--format--nojs">
        Format:
      </div>
      <ul class="j-doc-option__format-list" aria-labelledby="j-doc-option__label--format--nojs">
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--multi-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html/operators">Multi-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--single-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators">Single-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--pdf"><a href="/documentation/en-us/openshift_container_platform/4.13/pdf/operators/OpenShift_Container_Platform-4.13-Operators-en-US.pdf">PDF</a></li>
              </ul>
    </noscript>
  </li>
</ul>


              </div>
          </div>
                <div class="pvof-doc__tertiary-sidebar j-doc__tertiary-sidebar">
          <div class="pvof-doc__tertiary-sidebar__inner j-doc__tertiary-sidebar__inner">
            <div class="j-doc__doc-options">
              <div class="j-options-container j-options-container--desktop">
                <button class="j-sidebar__menu-trigger j-sidebar__menu-trigger--tablet content-expander__trigger">
                  <span class="j-sidebar__menu-trigger-icon"></span>
                  <h2 class="visually-hidden">Language and Page Formatting Options</h2>
                </button>
                  

  <ul class="j-doc-options__list content-expander">
    <li class="j-doc-options__item">
          <label class="j-doc-option__label j-doc-option__label--language" for="j-doc-language--2">
        Language:
      </label>
      <select id="j-doc-language--2" class="j-doc-option__select">
                  <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/operators" selected=''>
            English
          </option>
                  <option value="/documentation/ko-kr/openshift_container_platform/4.13/html-single/operators" >
            한국어
          </option>
                  <option value="/documentation/ja-jp/openshift_container_platform/4.13/html-single/operators" >
            日本語
          </option>
                  <option value="/documentation/zh-cn/openshift_container_platform/4.13/html-single/operators" >
            简体中文
          </option>
              </select>

            <noscript>
        <div class="j-doc-option__label j-doc-option__label--language" id="j-doc-option__label--language--nojs">
          Language:
        </div>
        <ul aria-labelledby="j-doc-option__label--language--nojs" class="j-doc-option__languages-list">
                      <li>
              <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators">English</a>
            </li>
                      <li>
              <a href="/documentation/ko-kr/openshift_container_platform/4.13/html-single/operators">한국어</a>
            </li>
                      <li>
              <a href="/documentation/ja-jp/openshift_container_platform/4.13/html-single/operators">日本語</a>
            </li>
                      <li>
              <a href="/documentation/zh-cn/openshift_container_platform/4.13/html-single/operators">简体中文</a>
            </li>
                  </ul>
      </noscript>

      </li>

    <li class="j-doc-options__item">
    <label for="j-doc-mode--2" class="j-doc-option__label j-doc-option__label--format">
      Format:
    </label>
    <select id="j-doc-mode--2" class="j-doc-option__select">
              <option value="/documentation/en-us/openshift_container_platform/4.13/html/operators"  class="j-doc-options__option j-doc-options__option--multi-page">
          Multi-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/operators" selected='' class="j-doc-options__option j-doc-options__option--single-page">
          Single-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/pdf/operators/OpenShift_Container_Platform-4.13-Operators-en-US.pdf"  class="j-doc-options__option j-doc-options__option--pdf">
          PDF
        </option>
          </select>

        <noscript>
      <div class="j-doc-option__label j-doc-option__label--format" id="j-doc-option__label--format--nojs">
        Format:
      </div>
      <ul class="j-doc-option__format-list" aria-labelledby="j-doc-option__label--format--nojs">
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--multi-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html/operators">Multi-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--single-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html-single/operators">Single-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--pdf"><a href="/documentation/en-us/openshift_container_platform/4.13/pdf/operators/OpenShift_Container_Platform-4.13-Operators-en-US.pdf">PDF</a></li>
              </ul>
    </noscript>
  </li>
</ul>


                </div>
              </div>
          </div>
        </div>

                  <div class="doc-wrapper pvof-doc__wrapper j-superdoc__content-wrapper" id="doc-wrapper">
            

  <div class="pane-page-title">
    <h1 class="title" itemprop="name">Operators</h1>
  </div>


  <div xml:lang="en-US" class="book" id="idm139732003667328"><div class="titlepage"><div><div class="producttitle"><span class="productname">OpenShift Container Platform</span> <span class="productnumber">4.13</span></div><div><h2 class="subtitle">Working with Operators in OpenShift Container Platform </h2></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat OpenShift Documentation Team</span></div></div><div><a href="#idm139731989895296">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				This document provides information for working with Operators in OpenShift Container Platform. This includes instructions for cluster administrators on how to install and manage Operators, as well as information for developers on how to create applications from installed Operators. This also contains guidance on building your own Operator using the Operator SDK.
			</div></div></div></div><hr/></div><section class="chapter" id="operators-overview"><div class="titlepage"><div><div><h1 class="title">Chapter 1. Operators overview</h1></div></div></div><p>
			Operators are among the most important components of OpenShift Container Platform. Operators are the preferred method of packaging, deploying, and managing services on the control plane. They can also provide advantages to applications that users run.
		</p><p>
			Operators integrate with Kubernetes APIs and CLI tools such as <code class="literal">kubectl</code> and <code class="literal">oc</code> commands. They provide the means of monitoring applications, performing health checks, managing over-the-air (OTA) updates, and ensuring that applications remain in your specified state.
		</p><p>
			While both follow similar Operator concepts and goals, Operators in OpenShift Container Platform are managed by two different systems, depending on their purpose:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Cluster Operators, which are managed by the Cluster Version Operator (CVO), are installed by default to perform cluster functions.
				</li><li class="listitem">
					Optional add-on Operators, which are managed by Operator Lifecycle Manager (OLM), can be made accessible for users to run in their applications.
				</li></ul></div><p>
			With Operators, you can create applications to monitor the running services in the cluster. Operators are designed specifically for your applications. Operators implement and automate the common Day 1 operations such as installation and configuration as well as Day 2 operations such as autoscaling up and down and creating backups. All these activities are in a piece of software running inside your cluster.
		</p><section class="section" id="operators-overview-developer-tasks"><div class="titlepage"><div><div><h2 class="title">1.1. For developers</h2></div></div></div><p>
				As a developer, you can perform the following Operator tasks:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-installing-cli">Install Operator SDK CLI</a>.
					</li><li class="listitem">
						Create <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-golang-quickstart">Go-based Operators</a>, <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-ansible-quickstart">Ansible-based Operators</a>, <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-java-quickstart">Java-based Operators</a>, and <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-helm-quickstart">Helm-based Operators</a>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-about">Use Operator SDK to build, test, and deploy an Operator</a>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-installing-operators-in-namespace">Install and subscribe an Operator to your namespace</a>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-creating-apps-from-installed-operators">Create an application from an installed Operator through the web console</a>.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/machine_management/#machine-lifecycle-hook-deletion-uses_deleting-machine">Machine deletion lifecycle hook examples for Operator developers</a>
					</li></ul></div></section><section class="section" id="operators-overview-administrator-tasks"><div class="titlepage"><div><div><h2 class="title">1.2. For administrators</h2></div></div></div><p>
				As a cluster administrator, you can perform the following Operator tasks:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-managing-custom-catalogs">Manage custom catalogs</a>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-creating-policy">Allow non-cluster administrators to install Operators</a>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-installing-operators-in-namespace">Install an Operator from OperatorHub</a>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-status">View Operator status</a>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-managing-operatorconditions">Manage Operator conditions</a>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-upgrading-operators">Upgrade installed Operators</a>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-deleting-operators-from-a-cluster">Delete installed Operators</a>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-configuring-proxy-support">Configure proxy support</a>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-restricted-networks">Use Operator Lifecycle Manager on restricted networks</a>.
					</li></ul></div><p>
				To know all about the cluster Operators that Red Hat provides, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#cluster-operators-ref">Cluster Operators reference</a>.
			</p></section><section class="section" id="operators-overview-next-steps"><div class="titlepage"><div><div><h2 class="title">1.3. Next steps</h2></div></div></div><p>
				To understand more about Operators, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-what-operators-are">What are Operators?</a>
			</p></section></section><section class="chapter" id="understanding-operators"><div class="titlepage"><div><div><h1 class="title">Chapter 2. Understanding Operators</h1></div></div></div><section class="section" id="olm-what-operators-are"><div class="titlepage"><div><div><h2 class="title">2.1. What are Operators?</h2></div></div></div><p>
				Conceptually, <span class="emphasis"><em>Operators</em></span> take human operational knowledge and encode it into software that is more easily shared with consumers.
			</p><p>
				Operators are pieces of software that ease the operational complexity of running another piece of software. They act like an extension of the software vendor’s engineering team, monitoring a Kubernetes environment (such as OpenShift Container Platform) and using its current state to make decisions in real time. Advanced Operators are designed to handle upgrades seamlessly, react to failures automatically, and not take shortcuts, like skipping a software backup process to save time.
			</p><p>
				More technically, Operators are a method of packaging, deploying, and managing a Kubernetes application.
			</p><p>
				A Kubernetes application is an app that is both deployed on Kubernetes and managed using the Kubernetes APIs and <code class="literal">kubectl</code> or <code class="literal">oc</code> tooling. To be able to make the most of Kubernetes, you require a set of cohesive APIs to extend in order to service and manage your apps that run on Kubernetes. Think of Operators as the runtime that manages this type of app on Kubernetes.
			</p><section class="section" id="olm-why-use-operators_olm-what-operators-are"><div class="titlepage"><div><div><h3 class="title">2.1.1. Why use Operators?</h3></div></div></div><p>
					Operators provide:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Repeatability of installation and upgrade.
						</li><li class="listitem">
							Constant health checks of every system component.
						</li><li class="listitem">
							Over-the-air (OTA) updates for OpenShift components and ISV content.
						</li><li class="listitem">
							A place to encapsulate knowledge from field engineers and spread it to all users, not just one or two.
						</li></ul></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Why deploy on Kubernetes?</span></dt><dd>
								Kubernetes (and by extension, OpenShift Container Platform) contains all of the primitives needed to build complex distributed systems – secret handling, load balancing, service discovery, autoscaling – that work across on-premises and cloud providers.
							</dd><dt><span class="term">Why manage your app with Kubernetes APIs and <code class="literal">kubectl</code> tooling?</span></dt><dd>
								These APIs are feature rich, have clients for all platforms and plug into the cluster’s access control/auditing. An Operator uses the Kubernetes extension mechanism, custom resource definitions (CRDs), so your custom object, <a class="link" href="https://marketplace.redhat.com/en-us/products/mongodb-enterprise-advanced-from-ibm">for example <code class="literal">MongoDB</code></a>, looks and acts just like the built-in, native Kubernetes objects.
							</dd><dt><span class="term">How do Operators compare with service brokers?</span></dt><dd>
								A service broker is a step towards programmatic discovery and deployment of an app. However, because it is not a long running process, it cannot execute Day 2 operations like upgrade, failover, or scaling. Customizations and parameterization of tunables are provided at install time, versus an Operator that is constantly watching the current state of your cluster. Off-cluster services are a good match for a service broker, although Operators exist for these as well.
							</dd></dl></div></section><section class="section" id="olm-operator-framework_olm-what-operators-are"><div class="titlepage"><div><div><h3 class="title">2.1.2. Operator Framework</h3></div></div></div><p>
					The Operator Framework is a family of tools and capabilities to deliver on the customer experience described above. It is not just about writing code; testing, delivering, and updating Operators is just as important. The Operator Framework components consist of open source tools to tackle these problems:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Operator SDK</span></dt><dd>
								The Operator SDK assists Operator authors in bootstrapping, building, testing, and packaging their own Operator based on their expertise without requiring knowledge of Kubernetes API complexities.
							</dd><dt><span class="term">Operator Lifecycle Manager</span></dt><dd>
								Operator Lifecycle Manager (OLM) controls the installation, upgrade, and role-based access control (RBAC) of Operators in a cluster. It is deployed by default in OpenShift Container Platform 4.13.
							</dd><dt><span class="term">Operator Registry</span></dt><dd>
								The Operator Registry stores cluster service versions (CSVs) and custom resource definitions (CRDs) for creation in a cluster and stores Operator metadata about packages and channels. It runs in a Kubernetes or OpenShift cluster to provide this Operator catalog data to OLM.
							</dd><dt><span class="term">OperatorHub</span></dt><dd>
								OperatorHub is a web console for cluster administrators to discover and select Operators to install on their cluster. It is deployed by default in OpenShift Container Platform.
							</dd></dl></div><p>
					These tools are designed to be composable, so you can use any that are useful to you.
				</p></section><section class="section" id="olm-maturity-model_olm-what-operators-are"><div class="titlepage"><div><div><h3 class="title">2.1.3. Operator maturity model</h3></div></div></div><p>
					The level of sophistication of the management logic encapsulated within an Operator can vary. This logic is also in general highly dependent on the type of the service represented by the Operator.
				</p><p>
					One can however generalize the scale of the maturity of the encapsulated operations of an Operator for certain set of capabilities that most Operators can include. To this end, the following Operator maturity model defines five phases of maturity for generic Day 2 operations of an Operator:
				</p><div class="figure" id="idm139732006340576"><p class="title"><strong>Figure 2.1. Operator maturity model</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Operators-en-US/images/e38967efb4c184f997b0d177edfb868f/operator-maturity-model.png" alt="operator maturity model"/></div></div></div><p>
					The above model also shows how these capabilities can best be developed through the Helm, Go, and Ansible capabilities of the Operator SDK.
				</p></section></section><section class="section" id="olm-packaging-format"><div class="titlepage"><div><div><h2 class="title">2.2. Operator Framework packaging format</h2></div></div></div><p>
				This guide outlines the packaging format for Operators supported by Operator Lifecycle Manager (OLM) in OpenShift Container Platform.
			</p><section class="section" id="olm-bundle-format_olm-packaging-format"><div class="titlepage"><div><div><h3 class="title">2.2.1. Bundle format</h3></div></div></div><p>
					The <span class="emphasis"><em>bundle format</em></span> for Operators is a packaging format introduced by the Operator Framework. To improve scalability and to better enable upstream users hosting their own catalogs, the bundle format specification simplifies the distribution of Operator metadata.
				</p><p>
					An Operator bundle represents a single version of an Operator. On-disk <span class="emphasis"><em>bundle manifests</em></span> are containerized and shipped as a <span class="emphasis"><em>bundle image</em></span>, which is a non-runnable container image that stores the Kubernetes manifests and Operator metadata. Storage and distribution of the bundle image is then managed using existing container tools like <code class="literal">podman</code> and <code class="literal">docker</code> and container registries such as Quay.
				</p><p>
					Operator metadata can include:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Information that identifies the Operator, for example its name and version.
						</li><li class="listitem">
							Additional information that drives the UI, for example its icon and some example custom resources (CRs).
						</li><li class="listitem">
							Required and provided APIs.
						</li><li class="listitem">
							Related images.
						</li></ul></div><p>
					When loading manifests into the Operator Registry database, the following requirements are validated:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The bundle must have at least one channel defined in the annotations.
						</li><li class="listitem">
							Every bundle has exactly one cluster service version (CSV).
						</li><li class="listitem">
							If a CSV owns a custom resource definition (CRD), that CRD must exist in the bundle.
						</li></ul></div><section class="section" id="olm-bundle-format-manifests_olm-packaging-format"><div class="titlepage"><div><div><h4 class="title">2.2.1.1. Manifests</h4></div></div></div><p>
						Bundle manifests refer to a set of Kubernetes manifests that define the deployment and RBAC model of the Operator.
					</p><p>
						A bundle includes one CSV per directory and typically the CRDs that define the owned APIs of the CSV in its <code class="literal">/manifests</code> directory.
					</p><div class="formalpara"><p class="title"><strong>Example bundle format layout</strong></p><p>
							
<pre class="programlisting language-terminal">etcd
├── manifests
│   ├── etcdcluster.crd.yaml
│   └── etcdoperator.clusterserviceversion.yaml
│   └── secret.yaml
│   └── configmap.yaml
└── metadata
    └── annotations.yaml
    └── dependencies.yaml</pre>

						</p></div><h6 id="olm-bundle-format-manifests-optional_olm-packaging-format">Additionally supported objects</h6><p>
						The following object types can also be optionally included in the <code class="literal">/manifests</code> directory of a bundle:
					</p><div class="itemizedlist small"><p class="title"><strong>Supported optional object types</strong></p><ul class="itemizedlist small" type="disc"><li class="listitem">
								<code class="literal">ClusterRole</code>
							</li><li class="listitem">
								<code class="literal">ClusterRoleBinding</code>
							</li><li class="listitem">
								<code class="literal">ConfigMap</code>
							</li><li class="listitem">
								<code class="literal">ConsoleCLIDownload</code>
							</li><li class="listitem">
								<code class="literal">ConsoleLink</code>
							</li><li class="listitem">
								<code class="literal">ConsoleQuickStart</code>
							</li><li class="listitem">
								<code class="literal">ConsoleYamlSample</code>
							</li><li class="listitem">
								<code class="literal">PodDisruptionBudget</code>
							</li><li class="listitem">
								<code class="literal">PriorityClass</code>
							</li><li class="listitem">
								<code class="literal">PrometheusRule</code>
							</li><li class="listitem">
								<code class="literal">Role</code>
							</li><li class="listitem">
								<code class="literal">RoleBinding</code>
							</li><li class="listitem">
								<code class="literal">Secret</code>
							</li><li class="listitem">
								<code class="literal">Service</code>
							</li><li class="listitem">
								<code class="literal">ServiceAccount</code>
							</li><li class="listitem">
								<code class="literal">ServiceMonitor</code>
							</li><li class="listitem">
								<code class="literal">VerticalPodAutoscaler</code>
							</li></ul></div><p>
						When these optional objects are included in a bundle, Operator Lifecycle Manager (OLM) can create them from the bundle and manage their lifecycle along with the CSV:
					</p><div class="itemizedlist"><p class="title"><strong>Lifecycle for optional objects</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								When the CSV is deleted, OLM deletes the optional object.
							</li><li class="listitem"><p class="simpara">
								When the CSV is upgraded:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										If the name of the optional object is the same, OLM updates it in place.
									</li><li class="listitem">
										If the name of the optional object has changed between versions, OLM deletes and recreates it.
									</li></ul></div></li></ul></div></section><section class="section" id="olm-bundle-format-annotations_olm-packaging-format"><div class="titlepage"><div><div><h4 class="title">2.2.1.2. Annotations</h4></div></div></div><p>
						A bundle also includes an <code class="literal">annotations.yaml</code> file in its <code class="literal">/metadata</code> directory. This file defines higher level aggregate data that helps describe the format and package information about how the bundle should be added into an index of bundles:
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">annotations.yaml</code></strong></p><p>
							
<pre class="programlisting language-yaml">annotations:
  operators.operatorframework.io.bundle.mediatype.v1: "registry+v1" <span id="CO1-1"><!--Empty--></span><span class="callout">1</span>
  operators.operatorframework.io.bundle.manifests.v1: "manifests/" <span id="CO1-2"><!--Empty--></span><span class="callout">2</span>
  operators.operatorframework.io.bundle.metadata.v1: "metadata/" <span id="CO1-3"><!--Empty--></span><span class="callout">3</span>
  operators.operatorframework.io.bundle.package.v1: "test-operator" <span id="CO1-4"><!--Empty--></span><span class="callout">4</span>
  operators.operatorframework.io.bundle.channels.v1: "beta,stable" <span id="CO1-5"><!--Empty--></span><span class="callout">5</span>
  operators.operatorframework.io.bundle.channel.default.v1: "stable" <span id="CO1-6"><!--Empty--></span><span class="callout">6</span></pre>

						</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO1-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								The media type or format of the Operator bundle. The <code class="literal">registry+v1</code> format means it contains a CSV and its associated Kubernetes objects.
							</div></dd><dt><a href="#CO1-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								The path in the image to the directory that contains the Operator manifests. This label is reserved for future use and currently defaults to <code class="literal">manifests/</code>. The value <code class="literal">manifests.v1</code> implies that the bundle contains Operator manifests.
							</div></dd><dt><a href="#CO1-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								The path in the image to the directory that contains metadata files about the bundle. This label is reserved for future use and currently defaults to <code class="literal">metadata/</code>. The value <code class="literal">metadata.v1</code> implies that this bundle has Operator metadata.
							</div></dd><dt><a href="#CO1-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								The package name of the bundle.
							</div></dd><dt><a href="#CO1-5"><span class="callout">5</span></a> </dt><dd><div class="para">
								The list of channels the bundle is subscribing to when added into an Operator Registry.
							</div></dd><dt><a href="#CO1-6"><span class="callout">6</span></a> </dt><dd><div class="para">
								The default channel an Operator should be subscribed to when installed from a registry.
							</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							In case of a mismatch, the <code class="literal">annotations.yaml</code> file is authoritative because the on-cluster Operator Registry that relies on these annotations only has access to this file.
						</p></div></div></section><section class="section" id="olm-dependencies_olm-packaging-format"><div class="titlepage"><div><div><h4 class="title">2.2.1.3. Dependencies</h4></div></div></div><p>
						The dependencies of an Operator are listed in a <code class="literal">dependencies.yaml</code> file in the <code class="literal">metadata/</code> folder of a bundle. This file is optional and currently only used to specify explicit Operator-version dependencies.
					</p><p>
						The dependency list contains a <code class="literal">type</code> field for each item to specify what kind of dependency this is. The following types of Operator dependencies are supported:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">olm.package</code></span></dt><dd>
									This type indicates a dependency for a specific Operator version. The dependency information must include the package name and the version of the package in semver format. For example, you can specify an exact version such as <code class="literal">0.5.2</code> or a range of versions such as <code class="literal">&gt;0.5.1</code>.
								</dd><dt><span class="term"><code class="literal">olm.gvk</code></span></dt><dd>
									With this type, the author can specify a dependency with group/version/kind (GVK) information, similar to existing CRD and API-based usage in a CSV. This is a path to enable Operator authors to consolidate all dependencies, API or explicit versions, to be in the same place.
								</dd><dt><span class="term"><code class="literal">olm.constraint</code></span></dt><dd>
									This type declares generic constraints on arbitrary Operator properties.
								</dd></dl></div><p>
						In the following example, dependencies are specified for a Prometheus Operator and etcd CRDs:
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">dependencies.yaml</code> file</strong></p><p>
							
<pre class="programlisting language-yaml">dependencies:
  - type: olm.package
    value:
      packageName: prometheus
      version: "&gt;0.27.0"
  - type: olm.gvk
    value:
      group: etcd.database.coreos.com
      kind: EtcdCluster
      version: v1beta2</pre>

						</p></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-understanding-dependency-resolution">Operator Lifecycle Manager dependency resolution</a>
							</li></ul></div></section><section class="section" id="olm-about-opm_olm-packaging-format"><div class="titlepage"><div><div><h4 class="title">2.2.1.4. About the opm CLI</h4></div></div></div><p>
						The <code class="literal">opm</code> CLI tool is provided by the Operator Framework for use with the Operator bundle format. This tool allows you to create and maintain catalogs of Operators from a list of Operator bundles that are similar to software repositories. The result is a container image which can be stored in a container registry and then installed on a cluster.
					</p><p>
						A catalog contains a database of pointers to Operator manifest content that can be queried through an included API that is served when the container image is run. On OpenShift Container Platform, Operator Lifecycle Manager (OLM) can reference the image in a catalog source, defined by a <code class="literal">CatalogSource</code> object, which polls the image at regular intervals to enable frequent updates to installed Operators on the cluster.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cli_tools/#cli-opm-install">CLI tools</a> for steps on installing the <code class="literal">opm</code> CLI.
							</li></ul></div></section></section><section class="section" id="olm-file-based-catalogs_olm-packaging-format"><div class="titlepage"><div><div><h3 class="title">2.2.2. File-based catalogs</h3></div></div></div><p>
					<span class="emphasis"><em>File-based catalogs</em></span> are the latest iteration of the catalog format in Operator Lifecycle Manager (OLM). It is a plain text-based (JSON or YAML) and declarative config evolution of the earlier SQLite database format, and it is fully backwards compatible. The goal of this format is to enable Operator catalog editing, composability, and extensibility.
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Editing</span></dt><dd><p class="simpara">
								With file-based catalogs, users interacting with the contents of a catalog are able to make direct changes to the format and verify that their changes are valid. Because this format is plain text JSON or YAML, catalog maintainers can easily manipulate catalog metadata by hand or with widely known and supported JSON or YAML tooling, such as the <code class="literal">jq</code> CLI.
							</p><p class="simpara">
								This editability enables the following features and user-defined extensions:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Promoting an existing bundle to a new channel
									</li><li class="listitem">
										Changing the default channel of a package
									</li><li class="listitem">
										Custom algorithms for adding, updating, and removing upgrade edges
									</li></ul></div></dd><dt><span class="term">Composability</span></dt><dd><p class="simpara">
								File-based catalogs are stored in an arbitrary directory hierarchy, which enables catalog composition. For example, consider two separate file-based catalog directories: <code class="literal">catalogA</code> and <code class="literal">catalogB</code>. A catalog maintainer can create a new combined catalog by making a new directory <code class="literal">catalogC</code> and copying <code class="literal">catalogA</code> and <code class="literal">catalogB</code> into it.
							</p><p class="simpara">
								This composability enables decentralized catalogs. The format permits Operator authors to maintain Operator-specific catalogs, and it permits maintainers to trivially build a catalog composed of individual Operator catalogs. File-based catalogs can be composed by combining multiple other catalogs, by extracting subsets of one catalog, or a combination of both of these.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Duplicate packages and duplicate bundles within a package are not permitted. The <code class="literal">opm validate</code> command returns an error if any duplicates are found.
								</p></div></div><p class="simpara">
								Because Operator authors are most familiar with their Operator, its dependencies, and its upgrade compatibility, they are able to maintain their own Operator-specific catalog and have direct control over its contents. With file-based catalogs, Operator authors own the task of building and maintaining their packages in a catalog. Composite catalog maintainers, however, only own the task of curating the packages in their catalog and publishing the catalog to users.
							</p></dd><dt><span class="term">Extensibility</span></dt><dd><p class="simpara">
								The file-based catalog specification is a low-level representation of a catalog. While it can be maintained directly in its low-level form, catalog maintainers can build interesting extensions on top that can be used by their own custom tooling to make any number of mutations.
							</p><p class="simpara">
								For example, a tool could translate a high-level API, such as <code class="literal">(mode=semver)</code>, down to the low-level, file-based catalog format for upgrade edges. Or a catalog maintainer might need to customize all of the bundle metadata by adding a new property to bundles that meet a certain criteria.
							</p><p class="simpara">
								While this extensibility allows for additional official tooling to be developed on top of the low-level APIs for future OpenShift Container Platform releases, the major benefit is that catalog maintainers have this capability as well.
							</p></dd></dl></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						As of OpenShift Container Platform 4.11, the default Red Hat-provided Operator catalog releases in the file-based catalog format. The default Red Hat-provided Operator catalogs for OpenShift Container Platform 4.6 through 4.10 released in the deprecated SQLite database format.
					</p><p>
						The <code class="literal">opm</code> subcommands, flags, and functionality related to the SQLite database format are also deprecated and will be removed in a future release. The features are still supported and must be used for catalogs that use the deprecated SQLite database format.
					</p><p>
						Many of the <code class="literal">opm</code> subcommands and flags for working with the SQLite database format, such as <code class="literal">opm index prune</code>, do not work with the file-based catalog format. For more information about working with file-based catalogs, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-managing-custom-catalogs-fb">Managing custom catalogs</a> and <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-mirroring-disconnected">Mirroring images for a disconnected installation using the oc-mirror plugin</a>.
					</p></div></div><section class="section" id="olm-fb-catalogs-structure_olm-packaging-format"><div class="titlepage"><div><div><h4 class="title">2.2.2.1. Directory structure</h4></div></div></div><p>
						File-based catalogs can be stored and loaded from directory-based file systems. The <code class="literal">opm</code> CLI loads the catalog by walking the root directory and recursing into subdirectories. The CLI attempts to load every file it finds and fails if any errors occur.
					</p><p>
						Non-catalog files can be ignored using <code class="literal">.indexignore</code> files, which have the same rules for patterns and precedence as <code class="literal">.gitignore</code> files.
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">.indexignore</code> file</strong></p><p>
							
<pre class="programlisting language-terminal"># Ignore everything except non-object .json and .yaml files
**/*
!*.json
!*.yaml
**/objects/*.json
**/objects/*.yaml</pre>

						</p></div><p>
						Catalog maintainers have the flexibility to choose their desired layout, but it is recommended to store each package’s file-based catalog blobs in separate subdirectories. Each individual file can be either JSON or YAML; it is not necessary for every file in a catalog to use the same format.
					</p><div class="formalpara"><p class="title"><strong>Basic recommended structure</strong></p><p>
							
<pre class="programlisting language-terminal">catalog
├── packageA
│   └── index.yaml
├── packageB
│   ├── .indexignore
│   ├── index.yaml
│   └── objects
│       └── packageB.v0.1.0.clusterserviceversion.yaml
└── packageC
    └── index.json</pre>

						</p></div><p>
						This recommended structure has the property that each subdirectory in the directory hierarchy is a self-contained catalog, which makes catalog composition, discovery, and navigation trivial file system operations. The catalog could also be included in a parent catalog by copying it into the parent catalog’s root directory.
					</p></section><section class="section" id="olm-fb-catalogs-schemas_olm-packaging-format"><div class="titlepage"><div><div><h4 class="title">2.2.2.2. Schemas</h4></div></div></div><p>
						File-based catalogs use a format, based on the <a class="link" href="https://cuelang.org/docs/references/spec/">CUE language specification</a>, that can be extended with arbitrary schemas. The following <code class="literal">_Meta</code> CUE schema defines the format that all file-based catalog blobs must adhere to:
					</p><div class="formalpara"><p class="title"><strong><code class="literal">_Meta</code> schema</strong></p><p>
							
<pre class="programlisting language-go">_Meta: {
  // schema is required and must be a non-empty string
  schema: string &amp; !=""

  // package is optional, but if it's defined, it must be a non-empty string
  package?: string &amp; !=""

  // properties is optional, but if it's defined, it must be a list of 0 or more properties
  properties?: [... #Property]
}

#Property: {
  // type is required
  type: string &amp; !=""

  // value is required, and it must not be null
  value: !=null
}</pre>

						</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							No CUE schemas listed in this specification should be considered exhaustive. The <code class="literal">opm validate</code> command has additional validations that are difficult or impossible to express concisely in CUE.
						</p></div></div><p>
						An Operator Lifecycle Manager (OLM) catalog currently uses three schemas (<code class="literal">olm.package</code>, <code class="literal">olm.channel</code>, and <code class="literal">olm.bundle</code>), which correspond to OLM’s existing package and bundle concepts.
					</p><p>
						Each Operator package in a catalog requires exactly one <code class="literal">olm.package</code> blob, at least one <code class="literal">olm.channel</code> blob, and one or more <code class="literal">olm.bundle</code> blobs.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							All <code class="literal">olm.*</code> schemas are reserved for OLM-defined schemas. Custom schemas must use a unique prefix, such as a domain that you own.
						</p></div></div><section class="section" id="olm-fb-catalogs-package-schema_olm-packaging-format"><div class="titlepage"><div><div><h5 class="title">2.2.2.2.1. olm.package schema</h5></div></div></div><p>
							The <code class="literal">olm.package</code> schema defines package-level metadata for an Operator. This includes its name, description, default channel, and icon.
						</p><div class="example" id="idm139731995933520"><p class="title"><strong>Example 2.1. <code class="literal">olm.package</code> schema</strong></p><div class="example-contents"><pre class="programlisting language-go">#Package: {
  schema: "olm.package"

  // Package name
  name: string &amp; !=""

  // A description of the package
  description?: string

  // The package's default channel
  defaultChannel: string &amp; !=""

  // An optional icon
  icon?: {
    base64data: string
    mediatype:  string
  }
}</pre></div></div></section><section class="section" id="olm-fb-catalogs-channel-schema_olm-packaging-format"><div class="titlepage"><div><div><h5 class="title">2.2.2.2.2. olm.channel schema</h5></div></div></div><p>
							The <code class="literal">olm.channel</code> schema defines a channel within a package, the bundle entries that are members of the channel, and the upgrade edges for those bundles.
						</p><p>
							A bundle can included as an entry in multiple <code class="literal">olm.channel</code> blobs, but it can have only one entry per channel.
						</p><p>
							It is valid for an entry’s replaces value to reference another bundle name that cannot be found in this catalog or another catalog. However, all other channel invariants must hold true, such as a channel not having multiple heads.
						</p><div class="example" id="idm139731989037936"><p class="title"><strong>Example 2.2. <code class="literal">olm.channel</code> schema</strong></p><div class="example-contents"><pre class="programlisting language-go">#Channel: {
  schema: "olm.channel"
  package: string &amp; !=""
  name: string &amp; !=""
  entries: [...#ChannelEntry]
}

#ChannelEntry: {
  // name is required. It is the name of an `olm.bundle` that
  // is present in the channel.
  name: string &amp; !=""

  // replaces is optional. It is the name of bundle that is replaced
  // by this entry. It does not have to be present in the entry list.
  replaces?: string &amp; !=""

  // skips is optional. It is a list of bundle names that are skipped by
  // this entry. The skipped bundles do not have to be present in the
  // entry list.
  skips?: [...string &amp; !=""]

  // skipRange is optional. It is the semver range of bundle versions
  // that are skipped by this entry.
  skipRange?: string &amp; !=""
}</pre></div></div></section><section class="section" id="olm-fb-catalogs-olm-bundle_olm-packaging-format"><div class="titlepage"><div><div><h5 class="title">2.2.2.2.3. olm.bundle schema</h5></div></div></div><div class="example" id="idm139732004692720"><p class="title"><strong>Example 2.3. <code class="literal">olm.bundle</code> schema</strong></p><div class="example-contents"><pre class="programlisting language-go">#Bundle: {
  schema: "olm.bundle"
  package: string &amp; !=""
  name: string &amp; !=""
  image: string &amp; !=""
  properties: [...#Property]
  relatedImages?: [...#RelatedImage]
}

#Property: {
  // type is required
  type: string &amp; !=""

  // value is required, and it must not be null
  value: !=null
}

#RelatedImage: {
  // image is the image reference
  image: string &amp; !=""

  // name is an optional descriptive name for an image that
  // helps identify its purpose in the context of the bundle
  name?: string &amp; !=""
}</pre></div></div></section></section><section class="section" id="olm-fb-catalogs-prop_olm-packaging-format"><div class="titlepage"><div><div><h4 class="title">2.2.2.3. Properties</h4></div></div></div><p>
						Properties are arbitrary pieces of metadata that can be attached to file-based catalog schemas. The <code class="literal">type</code> field is a string that effectively specifies the semantic and syntactic meaning of the <code class="literal">value</code> field. The value can be any arbitrary JSON or YAML.
					</p><p>
						OLM defines a handful of property types, again using the reserved <code class="literal">olm.*</code> prefix.
					</p><section class="section" id="olm-fb-catalogs-package-prop_olm-packaging-format"><div class="titlepage"><div><div><h5 class="title">2.2.2.3.1. olm.package property</h5></div></div></div><p>
							The <code class="literal">olm.package</code> property defines the package name and version. This is a required property on bundles, and there must be exactly one of these properties. The <code class="literal">packageName</code> field must match the bundle’s first-class <code class="literal">package</code> field, and the <code class="literal">version</code> field must be a valid semantic version.
						</p><div class="example" id="idm139731994921760"><p class="title"><strong>Example 2.4. <code class="literal">olm.package</code> property</strong></p><div class="example-contents"><pre class="programlisting language-go">#PropertyPackage: {
  type: "olm.package"
  value: {
    packageName: string &amp; !=""
    version: string &amp; !=""
  }
}</pre></div></div></section><section class="section" id="olm-fb-catalogs-gvk-prop_olm-packaging-format"><div class="titlepage"><div><div><h5 class="title">2.2.2.3.2. olm.gvk property</h5></div></div></div><p>
							The <code class="literal">olm.gvk</code> property defines the group/version/kind (GVK) of a Kubernetes API that is provided by this bundle. This property is used by OLM to resolve a bundle with this property as a dependency for other bundles that list the same GVK as a required API. The GVK must adhere to Kubernetes GVK validations.
						</p><div class="example" id="idm139731997871024"><p class="title"><strong>Example 2.5. <code class="literal">olm.gvk</code> property</strong></p><div class="example-contents"><pre class="programlisting language-go">#PropertyGVK: {
  type: "olm.gvk"
  value: {
    group: string &amp; !=""
    version: string &amp; !=""
    kind: string &amp; !=""
  }
}</pre></div></div></section><section class="section" id="olm-fb-catalogs-package-reqd-prop_olm-packaging-format"><div class="titlepage"><div><div><h5 class="title">2.2.2.3.3. olm.package.required</h5></div></div></div><p>
							The <code class="literal">olm.package.required</code> property defines the package name and version range of another package that this bundle requires. For every required package property a bundle lists, OLM ensures there is an Operator installed on the cluster for the listed package and in the required version range. The <code class="literal">versionRange</code> field must be a valid semantic version (semver) range.
						</p><div class="example" id="idm139731999123968"><p class="title"><strong>Example 2.6. <code class="literal">olm.package.required</code> property</strong></p><div class="example-contents"><pre class="programlisting language-go">#PropertyPackageRequired: {
  type: "olm.package.required"
  value: {
    packageName: string &amp; !=""
    versionRange: string &amp; !=""
  }
}</pre></div></div></section><section class="section" id="olm-fb-catalogs-gvk-reqd-prop_olm-packaging-format"><div class="titlepage"><div><div><h5 class="title">2.2.2.3.4. olm.gvk.required</h5></div></div></div><p>
							The <code class="literal">olm.gvk.required</code> property defines the group/version/kind (GVK) of a Kubernetes API that this bundle requires. For every required GVK property a bundle lists, OLM ensures there is an Operator installed on the cluster that provides it. The GVK must adhere to Kubernetes GVK validations.
						</p><div class="example" id="idm139731999118976"><p class="title"><strong>Example 2.7. <code class="literal">olm.gvk.required</code> property</strong></p><div class="example-contents"><pre class="programlisting language-terminal">#PropertyGVKRequired: {
  type: "olm.gvk.required"
  value: {
    group: string &amp; !=""
    version: string &amp; !=""
    kind: string &amp; !=""
  }
}</pre></div></div></section></section><section class="section" id="olm-fb-catalogs-example_olm-packaging-format"><div class="titlepage"><div><div><h4 class="title">2.2.2.4. Example catalog</h4></div></div></div><p>
						With file-based catalogs, catalog maintainers can focus on Operator curation and compatibility. Because Operator authors have already produced Operator-specific catalogs for their Operators, catalog maintainers can build their catalog by rendering each Operator catalog into a subdirectory of the catalog’s root directory.
					</p><p>
						There are many possible ways to build a file-based catalog; the following steps outline a simple approach:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Maintain a single configuration file for the catalog, containing image references for each Operator in the catalog:
							</p><div class="formalpara"><p class="title"><strong>Example catalog configuration file</strong></p><p>
									
<pre class="programlisting language-yaml">name: community-operators
repo: quay.io/community-operators/catalog
tag: latest
references:
- name: etcd-operator
  image: quay.io/etcd-operator/index@sha256:5891b5b522d5df086d0ff0b110fbd9d21bb4fc7163af34d08286a2e846f6be03
- name: prometheus-operator
  image: quay.io/prometheus-operator/index@sha256:e258d248fda94c63753607f7c4494ee0fcbe92f1a76bfdac795c9d84101eb317</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Run a script that parses the configuration file and creates a new catalog from its references:
							</p><div class="formalpara"><p class="title"><strong>Example script</strong></p><p>
									
<pre class="programlisting language-sh">name=$(yq eval '.name' catalog.yaml)
mkdir "$name"
yq eval '.name + "/" + .references[].name' catalog.yaml | xargs mkdir
for l in $(yq e '.name as $catalog | .references[] | .image + "|" + $catalog + "/" + .name + "/index.yaml"' catalog.yaml); do
  image=$(echo $l | cut -d'|' -f1)
  file=$(echo $l | cut -d'|' -f2)
  opm render "$image" &gt; "$file"
done
opm alpha generate dockerfile "$name"
indexImage=$(yq eval '.repo + ":" + .tag' catalog.yaml)
docker build -t "$indexImage" -f "$name.Dockerfile" .
docker push "$indexImage"</pre>

								</p></div></li></ol></div></section><section class="section" id="olm-fb-catalogs-guidelines_olm-packaging-format"><div class="titlepage"><div><div><h4 class="title">2.2.2.5. Guidelines</h4></div></div></div><p>
						Consider the following guidelines when maintaining file-based catalogs.
					</p><section class="section" id="olm-fb-catalogs-immutable_olm-packaging-format"><div class="titlepage"><div><div><h5 class="title">2.2.2.5.1. Immutable bundles</h5></div></div></div><p>
							The general advice with Operator Lifecycle Manager (OLM) is that bundle images and their metadata should be treated as immutable.
						</p><p>
							If a broken bundle has been pushed to a catalog, you must assume that at least one of your users has upgraded to that bundle. Based on that assumption, you must release another bundle with an upgrade edge from the broken bundle to ensure users with the broken bundle installed receive an upgrade. OLM will not reinstall an installed bundle if the contents of that bundle are updated in the catalog.
						</p><p>
							However, there are some cases where a change in the catalog metadata is preferred:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Channel promotion: If you already released a bundle and later decide that you would like to add it to another channel, you can add an entry for your bundle in another <code class="literal">olm.channel</code> blob.
								</li><li class="listitem">
									New upgrade edges: If you release a new <code class="literal">1.2.z</code> bundle version, for example <code class="literal">1.2.4</code>, but <code class="literal">1.3.0</code> is already released, you can update the catalog metadata for <code class="literal">1.3.0</code> to skip <code class="literal">1.2.4</code>.
								</li></ul></div></section><section class="section" id="olm-fb-catalogs-source-control_olm-packaging-format"><div class="titlepage"><div><div><h5 class="title">2.2.2.5.2. Source control</h5></div></div></div><p>
							Catalog metadata should be stored in source control and treated as the source of truth. Updates to catalog images should include the following steps:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
									Update the source-controlled catalog directory with a new commit.
								</li><li class="listitem">
									Build and push the catalog image. Use a consistent tagging taxonomy, such as <code class="literal">:latest</code> or <code class="literal">:&lt;target_cluster_version&gt;</code>, so that users can receive updates to a catalog as they become available.
								</li></ol></div></section></section><section class="section" id="olm-fb-catalogs-cli"><div class="titlepage"><div><div><h4 class="title">2.2.2.6. CLI usage</h4></div></div></div><p>
						For instructions about creating file-based catalogs by using the <code class="literal">opm</code> CLI, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-creating-fb-catalog-image_olm-managing-custom-catalogs">Managing custom catalogs</a>.
					</p><p>
						For reference documentation about the <code class="literal">opm</code> CLI commands related to managing file-based catalogs, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cli_tools/#cli-opm-ref">CLI tools</a>.
					</p></section><section class="section" id="olm-fb-catalogs-automation_olm-packaging-format"><div class="titlepage"><div><div><h4 class="title">2.2.2.7. Automation</h4></div></div></div><p>
						Operator authors and catalog maintainers are encouraged to automate their catalog maintenance with CI/CD workflows. Catalog maintainers can further improve on this by building GitOps automation to accomplish the following tasks:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Check that pull request (PR) authors are permitted to make the requested changes, for example by updating their package’s image reference.
							</li><li class="listitem">
								Check that the catalog updates pass the <code class="literal">opm validate</code> command.
							</li><li class="listitem">
								Check that the updated bundle or catalog image references exist, the catalog images run successfully in a cluster, and Operators from that package can be successfully installed.
							</li><li class="listitem">
								Automatically merge PRs that pass the previous checks.
							</li><li class="listitem">
								Automatically rebuild and republish the catalog image.
							</li></ul></div></section></section><section class="section" id="olm-rukpak-about_olm-packaging-format"><div class="titlepage"><div><div><h3 class="title">2.2.3. RukPak (Technology Preview)</h3></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						RukPak is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
					</p><p>
						For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
					</p></div></div><p>
					OpenShift Container Platform 4.12 introduces the <span class="emphasis"><em>platform Operator</em></span> type as a Technology Preview feature. The platform Operator mechanism relies on the RukPak component, also introduced in OpenShift Container Platform 4.12, and its resources to manage content.
				</p><p>
					RukPak consists of a series of controllers, known as <span class="emphasis"><em>provisioners</em></span>, that install and manage content on a Kubernetes cluster. RukPak also provides two primary APIs: <code class="literal">Bundle</code> and <code class="literal">BundleDeployment</code>. These components work together to bring content onto the cluster and install it, generating resources within the cluster.
				</p><p>
					A provisioner places a watch on both <code class="literal">Bundle</code> and <code class="literal">BundleDeployment</code> resources that refer to the provisioner explicitly. For a given bundle, the provisioner unpacks the contents of the <code class="literal">Bundle</code> resource onto the cluster. Then, given a <code class="literal">BundleDeployment</code> resource referring to that bundle, the provisioner installs the bundle contents and is responsible for managing the lifecycle of those resources.
				</p><p>
					Two provisioners are currently implemented and bundled with RukPak: the <span class="emphasis"><em>plain provisioner</em></span> that sources and unpacks <code class="literal">plain+v0</code> bundles, and the <span class="emphasis"><em>registry provisioner</em></span> that sources and unpacks Operator Lifecycle Manager (OLM) <code class="literal">registry+v1</code> bundles.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-managing-po">Managing platform Operators</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-po-techpreview_olm-managing-po">Technology Preview restrictions for platform Operators</a>
						</li></ul></div><section class="section" id="olm-rukpak-bundle_olm-packaging-format"><div class="titlepage"><div><div><h4 class="title">2.2.3.1. Bundle</h4></div></div></div><p>
						A RukPak <code class="literal">Bundle</code> object represents content to make available to other consumers in the cluster. Much like the contents of a container image must be pulled and unpacked in order for pod to start using them, <code class="literal">Bundle</code> objects are used to reference content that might need to be pulled and unpacked. In this sense, a bundle is a generalization of the image concept and can be used to represent any type of content.
					</p><p>
						Bundles cannot do anything on their own; they require a provisioner to unpack and make their content available in the cluster. They can be unpacked to any arbitrary storage medium, such as a <code class="literal">tar.gz</code> file in a directory mounted into the provisioner pods. Each <code class="literal">Bundle</code> object has an associated <code class="literal">spec.provisionerClassName</code> field that indicates the <code class="literal">Provisioner</code> object that watches and unpacks that particular bundle type.
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">Bundle</code> object configured to work with the plain provisioner</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: core.rukpak.io/v1alpha1
kind: Bundle
metadata:
  name: my-bundle
spec:
  source:
    type: image
    image:
      ref: my-bundle@sha256:xyz123
  provisionerClassName: core-rukpak-io-plain</pre>

						</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Bundles are considered immutable after they are created.
						</p></div></div><section class="section" id="olm-rukpak-bundle-immutability_olm-packaging-format"><div class="titlepage"><div><div><h5 class="title">2.2.3.1.1. Bundle immutability</h5></div></div></div><p>
							After a <code class="literal">Bundle</code> object is accepted by the API server, the bundle is considered an immutable artifact by the rest of the RukPak system. This behavior enforces the notion that a bundle represents some unique, static piece of content to source onto the cluster. A user can have confidence that a particular bundle is pointing to a specific set of manifests and cannot be updated without creating a new bundle. This property is true for both standalone bundles and dynamic bundles created by an embedded <code class="literal">BundleTemplate</code> object.
						</p><p>
							Bundle immutability is enforced by the core RukPak webhook. This webhook watches <code class="literal">Bundle</code> object events and, for any update to a bundle, checks whether the <code class="literal">spec</code> field of the existing bundle is semantically equal to that in the proposed updated bundle. If they are not equal, the update is rejected by the webhook. Other <code class="literal">Bundle</code> object fields, such as <code class="literal">metadata</code> or <code class="literal">status</code>, are updated during the bundle’s lifecycle; it is only the <code class="literal">spec</code> field that is considered immutable.
						</p><p>
							Applying a <code class="literal">Bundle</code> object and then attempting to update its spec should fail. For example, the following example creates a bundle:
						</p><pre class="programlisting language-terminal">$ oc apply -f -&lt;&lt;EOF
apiVersion: core.rukpak.io/v1alpha1
kind: Bundle
metadata:
  name: combo-tag-ref
spec:
  source:
    type: git
    git:
      ref:
        tag: v0.0.2
      repository: https://github.com/operator-framework/combo
  provisionerClassName: core-rukpak-io-plain
EOF</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">bundle.core.rukpak.io/combo-tag-ref created</pre>

							</p></div><p>
							Then, patching the bundle to point to a newer tag returns an error:
						</p><pre class="programlisting language-terminal">$ oc patch bundle combo-tag-ref --type='merge' -p '{"spec":{"source":{"git":{"ref":{"tag":"v0.0.3"}}}}}'</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Error from server (bundle.spec is immutable): admission webhook "vbundles.core.rukpak.io" denied the request: bundle.spec is immutable</pre>

							</p></div><p>
							The core RukPak admission webhook rejected the patch because the spec of the bundle is immutable. The recommended method to change the content of a bundle is by creating a new <code class="literal">Bundle</code> object instead of updating it in-place.
						</p><h6 id="olm-rukpak-bundle-immutability-considerations_olm-packaging-format">Further immutability considerations</h6><p>
							While the <code class="literal">spec</code> field of the <code class="literal">Bundle</code> object is immutable, it is still possible for a <code class="literal">BundleDeployment</code> object to pivot to a newer version of bundle content without changing the underlying <code class="literal">spec</code> field. This unintentional pivoting could occur in the following scenario:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
									A user sets an image tag, a Git branch, or a Git tag in the <code class="literal">spec.source</code> field of the <code class="literal">Bundle</code> object.
								</li><li class="listitem">
									The image tag moves to a new digest, a user pushes changes to a Git branch, or a user deletes and re-pushes a Git tag on a different commit.
								</li><li class="listitem">
									A user does something to cause the bundle unpack pod to be re-created, such as deleting the unpack pod.
								</li></ol></div><p>
							If this scenario occurs, the new content from step 2 is unpacked as a result of step 3. The bundle deployment detects the changes and pivots to the newer version of the content.
						</p><p>
							This is similar to pod behavior, where one of the pod’s container images uses a tag, the tag is moved to a different digest, and then at some point in the future the existing pod is rescheduled on a different node. At that point, the node pulls the new image at the new digest and runs something different without the user explicitly asking for it.
						</p><p>
							To be confident that the underlying <code class="literal">Bundle</code> spec content does not change, use a digest-based image or a Git commit reference when creating the bundle.
						</p></section><section class="section" id="olm-rukpak-plain-bundle_olm-packaging-format"><div class="titlepage"><div><div><h5 class="title">2.2.3.1.2. Plain bundle spec</h5></div></div></div><p>
							A plain bundle in RukPak is a collection of static, arbitrary, Kubernetes YAML manifests in a given directory.
						</p><p>
							The currently implemented plain bundle format is the <code class="literal">plain+v0</code> format. The name of the bundle format, <code class="literal">plain+v0</code>, combines the type of bundle (<code class="literal">plain</code>) with the current schema version (<code class="literal">v0</code>).
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The <code class="literal">plain+v0</code> bundle format is at schema version <code class="literal">v0</code>, which means it is an experimental format that is subject to change.
							</p></div></div><p>
							For example, the following shows the file tree in a <code class="literal">plain+v0</code> bundle. It must have a <code class="literal">manifests/</code> directory containing the Kubernetes resources required to deploy an application.
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">plain+v0</code> bundle file tree</strong></p><p>
								
<pre class="programlisting language-terminal">manifests
├── namespace.yaml
├── cluster_role.yaml
├── role.yaml
├── serviceaccount.yaml
├── cluster_role_binding.yaml
├── role_binding.yaml
└── deployment.yaml</pre>

							</p></div><p>
							The static manifests must be located in the <code class="literal">manifests/</code> directory with at least one resource in it for the bundle to be a valid <code class="literal">plain+v0</code> bundle that the provisioner can unpack. The <code class="literal">manifests/</code> directory must also be flat; all manifests must be at the top-level with no subdirectories.
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								Do not include any content in the <code class="literal">manifests/</code> directory of a plain bundle that are not static manifests. Otherwise, a failure will occur when creating content on-cluster from that bundle. Any file that would not successfully apply with the <code class="literal">oc apply</code> command will result in an error. Multi-object YAML or JSON files are valid, as well.
							</p></div></div></section><section class="section" id="olm-rukpak-registry-bundle_olm-packaging-format"><div class="titlepage"><div><div><h5 class="title">2.2.3.1.3. Registry bundle spec</h5></div></div></div><p>
							A registry bundle, or <code class="literal">registry+v1</code> bundle, contains a set of static Kubernetes YAML manifests organized in the legacy Operator Lifecycle Manager (OLM) bundle format.
						</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-bundle-format_olm-packaging-format">Legacy OLM bundle format</a>
								</li></ul></div></section></section><section class="section" id="olm-rukpak-bd_olm-packaging-format"><div class="titlepage"><div><div><h4 class="title">2.2.3.2. BundleDeployment</h4></div></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							A <code class="literal">BundleDeployment</code> object changes the state of a Kubernetes cluster by installing and removing objects. It is important to verify and trust the content that is being installed and limit access, by using RBAC, to the <code class="literal">BundleDeployment</code> API to only those who require those permissions.
						</p></div></div><p>
						The RukPak <code class="literal">BundleDeployment</code> API points to a <code class="literal">Bundle</code> object and indicates that it should be active. This includes pivoting from older versions of an active bundle. A <code class="literal">BundleDeployment</code> object might also include an embedded spec for a desired bundle.
					</p><p>
						Much like pods generate instances of container images, a bundle deployment generates a deployed version of a bundle. A bundle deployment can be seen as a generalization of the pod concept.
					</p><p>
						The specifics of how a bundle deployment makes changes to a cluster based on a referenced bundle is defined by the provisioner that is configured to watch that bundle deployment.
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">BundleDeployment</code> object configured to work with the plain provisioner</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: core.rukpak.io/v1alpha1
kind: BundleDeployment
metadata:
  name: my-bundle-deployment
spec:
  provisionerClassName: core-rukpak-io-plain
  template:
    metadata:
      labels:
        app: my-bundle
    spec:
      source:
        type: image
        image:
          ref: my-bundle@sha256:xyz123
      provisionerClassName: core-rukpak-io-plain</pre>

						</p></div></section><section class="section" id="olm-rukpak-provisioner_olm-packaging-format"><div class="titlepage"><div><div><h4 class="title">2.2.3.3. Provisioner</h4></div></div></div><p>
						A RukPak provisioner is a controller that understands the <code class="literal">BundleDeployment</code> and <code class="literal">Bundle</code> APIs and can take action. Each provisioner is assigned a unique ID and is responsible for reconciling <code class="literal">Bundle</code> and <code class="literal">BundleDeployment</code> objects with a <code class="literal">spec.provisionerClassName</code> field that matches that particular ID.
					</p><p>
						For example, the plain provisioner is able to unpack a given <code class="literal">plain+v0</code> bundle onto a cluster and then instantiate it, making the content of the bundle available in the cluster.
					</p></section></section></section><section class="section" id="olm-common-terms"><div class="titlepage"><div><div><h2 class="title">2.3. Operator Framework glossary of common terms</h2></div></div></div><p>
				This topic provides a glossary of common terms related to the Operator Framework, including Operator Lifecycle Manager (OLM) and the Operator SDK.
			</p><section class="section" id="olm-common-terms-glossary_olm-common-terms"><div class="titlepage"><div><div><h3 class="title">2.3.1. Common Operator Framework terms</h3></div></div></div><section class="section" id="olm-common-terms-bundle_olm-common-terms"><div class="titlepage"><div><div><h4 class="title">2.3.1.1. Bundle</h4></div></div></div><p>
						In the bundle format, a <span class="emphasis"><em>bundle</em></span> is a collection of an Operator CSV, manifests, and metadata. Together, they form a unique version of an Operator that can be installed onto the cluster.
					</p></section><section class="section" id="olm-common-terms-bundle-image_olm-common-terms"><div class="titlepage"><div><div><h4 class="title">2.3.1.2. Bundle image</h4></div></div></div><p>
						In the bundle format, a <span class="emphasis"><em>bundle image</em></span> is a container image that is built from Operator manifests and that contains one bundle. Bundle images are stored and distributed by Open Container Initiative (OCI) spec container registries, such as Quay.io or DockerHub.
					</p></section><section class="section" id="olm-common-terms-catalogsource_olm-common-terms"><div class="titlepage"><div><div><h4 class="title">2.3.1.3. Catalog source</h4></div></div></div><p>
						A <span class="emphasis"><em>catalog source</em></span> represents a store of metadata that OLM can query to discover and install Operators and their dependencies.
					</p></section><section class="section" id="olm-common-terms-channel_olm-common-terms"><div class="titlepage"><div><div><h4 class="title">2.3.1.4. Channel</h4></div></div></div><p>
						A <span class="emphasis"><em>channel</em></span> defines a stream of updates for an Operator and is used to roll out updates for subscribers. The head points to the latest version of that channel. For example, a <code class="literal">stable</code> channel would have all stable versions of an Operator arranged from the earliest to the latest.
					</p><p>
						An Operator can have several channels, and a subscription binding to a certain channel would only look for updates in that channel.
					</p></section><section class="section" id="olm-common-terms-channel-head_olm-common-terms"><div class="titlepage"><div><div><h4 class="title">2.3.1.5. Channel head</h4></div></div></div><p>
						A <span class="emphasis"><em>channel head</em></span> refers to the latest known update in a particular channel.
					</p></section><section class="section" id="olm-common-terms-csv_olm-common-terms"><div class="titlepage"><div><div><h4 class="title">2.3.1.6. Cluster service version</h4></div></div></div><p>
						A <span class="emphasis"><em>cluster service version (CSV)</em></span> is a YAML manifest created from Operator metadata that assists OLM in running the Operator in a cluster. It is the metadata that accompanies an Operator container image, used to populate user interfaces with information such as its logo, description, and version.
					</p><p>
						It is also a source of technical information that is required to run the Operator, like the RBAC rules it requires and which custom resources (CRs) it manages or depends on.
					</p></section><section class="section" id="olm-common-terms-dependency_olm-common-terms"><div class="titlepage"><div><div><h4 class="title">2.3.1.7. Dependency</h4></div></div></div><p>
						An Operator may have a <span class="emphasis"><em>dependency</em></span> on another Operator being present in the cluster. For example, the Vault Operator has a dependency on the etcd Operator for its data persistence layer.
					</p><p>
						OLM resolves dependencies by ensuring that all specified versions of Operators and CRDs are installed on the cluster during the installation phase. This dependency is resolved by finding and installing an Operator in a catalog that satisfies the required CRD API, and is not related to packages or bundles.
					</p></section><section class="section" id="olm-common-terms-index-image_olm-common-terms"><div class="titlepage"><div><div><h4 class="title">2.3.1.8. Index image</h4></div></div></div><p>
						In the bundle format, an <span class="emphasis"><em>index image</em></span> refers to an image of a database (a database snapshot) that contains information about Operator bundles including CSVs and CRDs of all versions. This index can host a history of Operators on a cluster and be maintained by adding or removing Operators using the <code class="literal">opm</code> CLI tool.
					</p></section><section class="section" id="olm-common-terms-installplan_olm-common-terms"><div class="titlepage"><div><div><h4 class="title">2.3.1.9. Install plan</h4></div></div></div><p>
						An <span class="emphasis"><em>install plan</em></span> is a calculated list of resources to be created to automatically install or upgrade a CSV.
					</p></section><section class="section" id="olm-common-terms-multitenancy_olm-common-terms"><div class="titlepage"><div><div><h4 class="title">2.3.1.10. Multitenancy</h4></div></div></div><p>
						A <span class="emphasis"><em>tenant</em></span> in OpenShift Container Platform is a user or group of users that share common access and privileges for a set of deployed workloads, typically represented by a namespace or project. You can use tenants to provide a level of isolation between different groups or teams.
					</p><p>
						When a cluster is shared by multiple users or groups, it is considered a <span class="emphasis"><em>multitenant</em></span> cluster.
					</p></section><section class="section" id="olm-common-terms-operatorgroup_olm-common-terms"><div class="titlepage"><div><div><h4 class="title">2.3.1.11. Operator group</h4></div></div></div><p>
						An <span class="emphasis"><em>Operator group</em></span> configures all Operators deployed in the same namespace as the <code class="literal">OperatorGroup</code> object to watch for their CR in a list of namespaces or cluster-wide.
					</p></section><section class="section" id="olm-common-terms-package_olm-common-terms"><div class="titlepage"><div><div><h4 class="title">2.3.1.12. Package</h4></div></div></div><p>
						In the bundle format, a <span class="emphasis"><em>package</em></span> is a directory that encloses all released history of an Operator with each version. A released version of an Operator is described in a CSV manifest alongside the CRDs.
					</p></section><section class="section" id="olm-common-terms-registry_olm-common-terms"><div class="titlepage"><div><div><h4 class="title">2.3.1.13. Registry</h4></div></div></div><p>
						A <span class="emphasis"><em>registry</em></span> is a database that stores bundle images of Operators, each with all of its latest and historical versions in all channels.
					</p></section><section class="section" id="olm-common-terms-subscription_olm-common-terms"><div class="titlepage"><div><div><h4 class="title">2.3.1.14. Subscription</h4></div></div></div><p>
						A <span class="emphasis"><em>subscription</em></span> keeps CSVs up to date by tracking a channel in a package.
					</p></section><section class="section" id="olm-common-terms-update-graph_olm-common-terms"><div class="titlepage"><div><div><h4 class="title">2.3.1.15. Update graph</h4></div></div></div><p>
						An <span class="emphasis"><em>update graph</em></span> links versions of CSVs together, similar to the update graph of any other packaged software. Operators can be installed sequentially, or certain versions can be skipped. The update graph is expected to grow only at the head with newer versions being added.
					</p></section></section></section><section class="section" id="operator-lifecycle-manager-olm"><div class="titlepage"><div><div><h2 class="title">2.4. Operator Lifecycle Manager (OLM)</h2></div></div></div><section class="section" id="olm-understanding-olm"><div class="titlepage"><div><div><h3 class="title">2.4.1. Operator Lifecycle Manager concepts and resources</h3></div></div></div><p>
					This guide provides an overview of the concepts that drive Operator Lifecycle Manager (OLM) in OpenShift Container Platform.
				</p><section class="section" id="olm-overview_olm-understanding-olm"><div class="titlepage"><div><div><h4 class="title">2.4.1.1. What is Operator Lifecycle Manager?</h4></div></div></div><p>
						<span class="emphasis"><em>Operator Lifecycle Manager</em></span> (OLM) helps users install, update, and manage the lifecycle of Kubernetes native applications (Operators) and their associated services running across their OpenShift Container Platform clusters. It is part of the <a class="link" href="https://operatorframework.io/">Operator Framework</a>, an open source toolkit designed to manage Operators in an effective, automated, and scalable way.
					</p><div class="figure" id="idm139731999968720"><p class="title"><strong>Figure 2.2. Operator Lifecycle Manager workflow</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Operators-en-US/images/c8a00bac5df42a702ff1b826333610d0/olm-workflow.png" alt="olm workflow"/></div></div></div><p>
						OLM runs by default in OpenShift Container Platform 4.13, which aids cluster administrators in installing, upgrading, and granting access to Operators running on their cluster. The OpenShift Container Platform web console provides management screens for cluster administrators to install Operators, as well as grant specific projects access to use the catalog of Operators available on the cluster.
					</p><p>
						For developers, a self-service experience allows provisioning and configuring instances of databases, monitoring, and big data services without having to be subject matter experts, because the Operator has that knowledge baked into it.
					</p></section><section class="section" id="olm-resources_olm-understanding-olm"><div class="titlepage"><div><div><h4 class="title">2.4.1.2. OLM resources</h4></div></div></div><p>
						The following custom resource definitions (CRDs) are defined and managed by Operator Lifecycle Manager (OLM):
					</p><div class="table" id="idm139731976964224"><p class="title"><strong>Table 2.1. CRDs managed by OLM and Catalog Operators</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 17%; " class="col_1"><!--Empty--></col><col style="width: 17%; " class="col_2"><!--Empty--></col><col style="width: 66%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731991603616" scope="col">Resource</th><th align="left" valign="top" id="idm139731991602528" scope="col">Short name</th><th align="left" valign="top" id="idm139731991601440" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731991603616"> <p>
										<code class="literal">ClusterServiceVersion</code> (CSV)
									</p>
									 </td><td align="left" valign="top" headers="idm139731991602528"> <p>
										<code class="literal">csv</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731991601440"> <p>
										Application metadata. For example: name, version, icon, required resources.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731991603616"> <p>
										<code class="literal">CatalogSource</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731991602528"> <p>
										<code class="literal">catsrc</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731991601440"> <p>
										A repository of CSVs, CRDs, and packages that define an application.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731991603616"> <p>
										<code class="literal">Subscription</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731991602528"> <p>
										<code class="literal">sub</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731991601440"> <p>
										Keeps CSVs up to date by tracking a channel in a package.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731991603616"> <p>
										<code class="literal">InstallPlan</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731991602528"> <p>
										<code class="literal">ip</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731991601440"> <p>
										Calculated list of resources to be created to automatically install or upgrade a CSV.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731991603616"> <p>
										<code class="literal">OperatorGroup</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731991602528"> <p>
										<code class="literal">og</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731991601440"> <p>
										Configures all Operators deployed in the same namespace as the <code class="literal">OperatorGroup</code> object to watch for their custom resource (CR) in a list of namespaces or cluster-wide.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731991603616"> <p>
										<code class="literal">OperatorConditions</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731991602528"> <p>
										-
									</p>
									 </td><td align="left" valign="top" headers="idm139731991601440"> <p>
										Creates a communication channel between OLM and an Operator it manages. Operators can write to the <code class="literal">Status.Conditions</code> array to communicate complex states to OLM.
									</p>
									 </td></tr></tbody></table></div></div><section class="section" id="olm-csv_olm-understanding-olm"><div class="titlepage"><div><div><h5 class="title">2.4.1.2.1. Cluster service version</h5></div></div></div><p>
							A <span class="emphasis"><em>cluster service version</em></span> (CSV) represents a specific version of a running Operator on an OpenShift Container Platform cluster. It is a YAML manifest created from Operator metadata that assists Operator Lifecycle Manager (OLM) in running the Operator in the cluster.
						</p><p>
							OLM requires this metadata about an Operator to ensure that it can be kept running safely on a cluster, and to provide information about how updates should be applied as new versions of the Operator are published. This is similar to packaging software for a traditional operating system; think of the packaging step for OLM as the stage at which you make your <code class="literal">rpm</code>, <code class="literal">deb</code>, or <code class="literal">apk</code> bundle.
						</p><p>
							A CSV includes the metadata that accompanies an Operator container image, used to populate user interfaces with information such as its name, version, description, labels, repository link, and logo.
						</p><p>
							A CSV is also a source of technical information required to run the Operator, such as which custom resources (CRs) it manages or depends on, RBAC rules, cluster requirements, and install strategies. This information tells OLM how to create required resources and set up the Operator as a deployment.
						</p></section><section class="section" id="olm-catalogsource_olm-understanding-olm"><div class="titlepage"><div><div><h5 class="title">2.4.1.2.2. Catalog source</h5></div></div></div><p>
							A <span class="emphasis"><em>catalog source</em></span> represents a store of metadata, typically by referencing an <span class="emphasis"><em>index image</em></span> stored in a container registry. Operator Lifecycle Manager (OLM) queries catalog sources to discover and install Operators and their dependencies. OperatorHub in the OpenShift Container Platform web console also displays the Operators provided by catalog sources.
						</p><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
							Cluster administrators can view the full list of Operators provided by an enabled catalog source on a cluster by using the <span class="strong strong"><strong>Administration</strong></span> → <span class="strong strong"><strong>Cluster Settings</strong></span> → <span class="strong strong"><strong>Configuration</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span> page in the web console.
						</p></div></div><p>
							The <code class="literal">spec</code> of a <code class="literal">CatalogSource</code> object indicates how to construct a pod or how to communicate with a service that serves the Operator Registry gRPC API.
						</p><div class="example" id="idm139731994545664"><p class="title"><strong>Example 2.8. Example <code class="literal">CatalogSource</code> object</strong></p><div class="example-contents"><pre class="programlisting language-yaml">﻿apiVersion: operators.coreos.com/v1alpha1
kind: CatalogSource
metadata:
  generation: 1
  name: example-catalog <span id="CO2-1"><!--Empty--></span><span class="callout">1</span>
  namespace: openshift-marketplace <span id="CO2-2"><!--Empty--></span><span class="callout">2</span>
  annotations:
    olm.catalogImageTemplate: <span id="CO2-3"><!--Empty--></span><span class="callout">3</span>
      "quay.io/example-org/example-catalog:v{kube_major_version}.{kube_minor_version}.{kube_patch_version}"
spec:
  displayName: Example Catalog <span id="CO2-4"><!--Empty--></span><span class="callout">4</span>
  image: quay.io/example-org/example-catalog:v1 <span id="CO2-5"><!--Empty--></span><span class="callout">5</span>
  priority: -400 <span id="CO2-6"><!--Empty--></span><span class="callout">6</span>
  publisher: Example Org
  sourceType: grpc <span id="CO2-7"><!--Empty--></span><span class="callout">7</span>
  grpcPodConfig:
    securityContextConfig: &lt;security_mode&gt; <span id="CO2-8"><!--Empty--></span><span class="callout">8</span>
    nodeSelector: <span id="CO2-9"><!--Empty--></span><span class="callout">9</span>
      custom_label: &lt;label&gt;
    priorityClassName: system-cluster-critical <span id="CO2-10"><!--Empty--></span><span class="callout">10</span>
    tolerations: <span id="CO2-11"><!--Empty--></span><span class="callout">11</span>
      - key: "key1"
        operator: "Equal"
        value: "value1"
        effect: "NoSchedule"
  updateStrategy:
    registryPoll: <span id="CO2-12"><!--Empty--></span><span class="callout">12</span>
      interval: 30m0s
status:
  connectionState:
    address: example-catalog.openshift-marketplace.svc:50051
    lastConnect: 2021-08-26T18:14:31Z
    lastObservedState: READY <span id="CO2-13"><!--Empty--></span><span class="callout">13</span>
  latestImageRegistryPoll: 2021-08-26T18:46:25Z <span id="CO2-14"><!--Empty--></span><span class="callout">14</span>
  registryService: <span id="CO2-15"><!--Empty--></span><span class="callout">15</span>
    createdAt: 2021-08-26T16:16:37Z
    port: 50051
    protocol: grpc
    serviceName: example-catalog
    serviceNamespace: openshift-marketplace</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO2-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Name for the <code class="literal">CatalogSource</code> object. This value is also used as part of the name for the related pod that is created in the requested namespace.
									</div></dd><dt><a href="#CO2-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Namespace to create the catalog in. To make the catalog available cluster-wide in all namespaces, set this value to <code class="literal">openshift-marketplace</code>. The default Red Hat-provided catalog sources also use the <code class="literal">openshift-marketplace</code> namespace. Otherwise, set the value to a specific namespace to make the Operator only available in that namespace.
									</div></dd><dt><a href="#CO2-3"><span class="callout">3</span></a> </dt><dd><div class="para">
										Optional: To avoid cluster upgrades potentially leaving Operator installations in an unsupported state or without a continued update path, you can enable automatically changing your Operator catalog’s index image version as part of cluster upgrades.
									</div><p>
										Set the <code class="literal">olm.catalogImageTemplate</code> annotation to your index image name and use one or more of the Kubernetes cluster version variables as shown when constructing the template for the image tag. The annotation overwrites the <code class="literal">spec.image</code> field at run time. See the "Image template for custom catalog sources" section for more details.
									</p></dd><dt><a href="#CO2-4"><span class="callout">4</span></a> </dt><dd><div class="para">
										Display name for the catalog in the web console and CLI.
									</div></dd><dt><a href="#CO2-5"><span class="callout">5</span></a> </dt><dd><div class="para">
										Index image for the catalog. Optionally, can be omitted when using the <code class="literal">olm.catalogImageTemplate</code> annotation, which sets the pull spec at run time.
									</div></dd><dt><a href="#CO2-6"><span class="callout">6</span></a> </dt><dd><div class="para">
										Weight for the catalog source. OLM uses the weight for prioritization during dependency resolution. A higher weight indicates the catalog is preferred over lower-weighted catalogs.
									</div></dd><dt><a href="#CO2-7"><span class="callout">7</span></a> </dt><dd><div class="para">
										Source types include the following:
									</div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">grpc</code> with an <code class="literal">image</code> reference: OLM pulls the image and runs the pod, which is expected to serve a compliant API.
											</li><li class="listitem">
												<code class="literal">grpc</code> with an <code class="literal">address</code> field: OLM attempts to contact the gRPC API at the given address. This should not be used in most cases.
											</li><li class="listitem">
												<code class="literal">configmap</code>: OLM parses config map data and runs a pod that can serve the gRPC API over it.
											</li></ul></div></dd><dt><a href="#CO2-8"><span class="callout">8</span></a> </dt><dd><div class="para">
										Specify the value of <code class="literal">legacy</code> or <code class="literal">restricted</code>. If the field is not set, the default value is <code class="literal">legacy</code>. In a future OpenShift Container Platform release, it is planned that the default value will be <code class="literal">restricted</code>. If your catalog cannot run with <code class="literal">restricted</code> permissions, it is recommended that you manually set this field to <code class="literal">legacy</code>.
									</div></dd><dt><a href="#CO2-9"><span class="callout">9</span></a> </dt><dd><div class="para">
										Optional: For <code class="literal">grpc</code> type catalog sources, overrides the default node selector for the pod serving the content in <code class="literal">spec.image</code>, if defined.
									</div></dd><dt><a href="#CO2-10"><span class="callout">10</span></a> </dt><dd><div class="para">
										Optional: For <code class="literal">grpc</code> type catalog sources, overrides the default priority class name for the pod serving the content in <code class="literal">spec.image</code>, if defined. Kubernetes provides <code class="literal">system-cluster-critical</code> and <code class="literal">system-node-critical</code> priority classes by default. Setting the field to empty (<code class="literal">""</code>) assigns the pod the default priority. Other priority classes can be defined manually.
									</div></dd><dt><a href="#CO2-11"><span class="callout">11</span></a> </dt><dd><div class="para">
										Optional: For <code class="literal">grpc</code> type catalog sources, overrides the default tolerations for the pod serving the content in <code class="literal">spec.image</code>, if defined.
									</div></dd><dt><a href="#CO2-12"><span class="callout">12</span></a> </dt><dd><div class="para">
										Automatically check for new versions at a given interval to stay up-to-date.
									</div></dd><dt><a href="#CO2-13"><span class="callout">13</span></a> </dt><dd><div class="para">
										Last observed state of the catalog connection. For example:
									</div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">READY</code>: A connection is successfully established.
											</li><li class="listitem">
												<code class="literal">CONNECTING</code>: A connection is attempting to establish.
											</li><li class="listitem">
												<code class="literal">TRANSIENT_FAILURE</code>: A temporary problem has occurred while attempting to establish a connection, such as a timeout. The state will eventually switch back to <code class="literal">CONNECTING</code> and try again.
											</li></ul></div><p>
										See <a class="link" href="https://grpc.github.io/grpc/core/md_doc_connectivity-semantics-and-api.html">States of Connectivity</a> in the gRPC documentation for more details.
									</p></dd><dt><a href="#CO2-14"><span class="callout">14</span></a> </dt><dd><div class="para">
										Latest time the container registry storing the catalog image was polled to ensure the image is up-to-date.
									</div></dd><dt><a href="#CO2-15"><span class="callout">15</span></a> </dt><dd><div class="para">
										Status information for the catalog’s Operator Registry service.
									</div></dd></dl></div></div></div><p>
							Referencing the <code class="literal">name</code> of a <code class="literal">CatalogSource</code> object in a subscription instructs OLM where to search to find a requested Operator:
						</p><div class="example" id="idm139731985208256"><p class="title"><strong>Example 2.9. Example <code class="literal">Subscription</code> object referencing a catalog source</strong></p><div class="example-contents"><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: example-operator
  namespace: example-namespace
spec:
  channel: stable
  name: example-operator
  source: example-catalog
  sourceNamespace: openshift-marketplace</pre></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-understanding-operatorhub">Understanding OperatorHub</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-rh-catalogs">Red Hat-provided Operator catalogs</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-creating-catalog-from-index_olm-managing-custom-catalogs">Adding a catalog source to a cluster</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-dependency-catalog-priority_olm-understanding-dependency-resolution">Catalog priority</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-cs-status-cli_olm-status">Viewing Operator catalog source status by using the CLI</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#understanding-and-managing-pod-security-admission">Understanding and managing pod security admission</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-cs-podsched">Catalog source pod scheduling</a>
								</li></ul></div><section class="section" id="olm-catalogsource-image-template_olm-understanding-olm"><div class="titlepage"><div><div><h6 class="title">2.4.1.2.2.1. Image template for custom catalog sources</h6></div></div></div><p>
								Operator compatibility with the underlying cluster can be expressed by a catalog source in various ways. One way, which is used for the default Red Hat-provided catalog sources, is to identify image tags for index images that are specifically created for a particular platform release, for example OpenShift Container Platform 4.13.
							</p><p>
								During a cluster upgrade, the index image tag for the default Red Hat-provided catalog sources are updated automatically by the Cluster Version Operator (CVO) so that Operator Lifecycle Manager (OLM) pulls the updated version of the catalog. For example during an upgrade from OpenShift Container Platform 4.12 to 4.13, the <code class="literal">spec.image</code> field in the <code class="literal">CatalogSource</code> object for the <code class="literal">redhat-operators</code> catalog is updated from:
							</p><pre class="programlisting language-terminal">registry.redhat.io/redhat/redhat-operator-index:v4.12</pre><p>
								to:
							</p><pre class="programlisting language-terminal">registry.redhat.io/redhat/redhat-operator-index:v4.13</pre><p>
								However, the CVO does not automatically update image tags for custom catalogs. To ensure users are left with a compatible and supported Operator installation after a cluster upgrade, custom catalogs should also be kept updated to reference an updated index image.
							</p><p>
								Starting in OpenShift Container Platform 4.9, cluster administrators can add the <code class="literal">olm.catalogImageTemplate</code> annotation in the <code class="literal">CatalogSource</code> object for custom catalogs to an image reference that includes a template. The following Kubernetes version variables are supported for use in the template:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">kube_major_version</code>
									</li><li class="listitem">
										<code class="literal">kube_minor_version</code>
									</li><li class="listitem">
										<code class="literal">kube_patch_version</code>
									</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									You must specify the Kubernetes cluster version and not an OpenShift Container Platform cluster version, as the latter is not currently available for templating.
								</p></div></div><p>
								Provided that you have created and pushed an index image with a tag specifying the updated Kubernetes version, setting this annotation enables the index image versions in custom catalogs to be automatically changed after a cluster upgrade. The annotation value is used to set or update the image reference in the <code class="literal">spec.image</code> field of the <code class="literal">CatalogSource</code> object. This helps avoid cluster upgrades leaving Operator installations in unsupported states or without a continued update path.
							</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									You must ensure that the index image with the updated tag, in whichever registry it is stored in, is accessible by the cluster at the time of the cluster upgrade.
								</p></div></div><div class="example" id="idm139732006193152"><p class="title"><strong>Example 2.10. Example catalog source with an image template</strong></p><div class="example-contents"><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: CatalogSource
metadata:
  generation: 1
  name: example-catalog
  namespace: openshift-marketplace
  annotations:
    olm.catalogImageTemplate:
      "quay.io/example-org/example-catalog:v{kube_major_version}.{kube_minor_version}"
spec:
  displayName: Example Catalog
  image: quay.io/example-org/example-catalog:v1.26
  priority: -400
  publisher: Example Org</pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									If the <code class="literal">spec.image</code> field and the <code class="literal">olm.catalogImageTemplate</code> annotation are both set, the <code class="literal">spec.image</code> field is overwritten by the resolved value from the annotation. If the annotation does not resolve to a usable pull spec, the catalog source falls back to the set <code class="literal">spec.image</code> value.
								</p><p>
									If the <code class="literal">spec.image</code> field is not set and the annotation does not resolve to a usable pull spec, OLM stops reconciliation of the catalog source and sets it into a human-readable error condition.
								</p></div></div><p>
								For an OpenShift Container Platform 4.13 cluster, which uses Kubernetes 1.26, the <code class="literal">olm.catalogImageTemplate</code> annotation in the preceding example resolves to the following image reference:
							</p><pre class="programlisting language-terminal">quay.io/example-org/example-catalog:v1.26</pre><p>
								For future releases of OpenShift Container Platform, you can create updated index images for your custom catalogs that target the later Kubernetes version that is used by the later OpenShift Container Platform version. With the <code class="literal">olm.catalogImageTemplate</code> annotation set before the upgrade, upgrading the cluster to the later OpenShift Container Platform version would then automatically update the catalog’s index image as well.
							</p></section><section class="section" id="olm-cs-health_olm-understanding-olm"><div class="titlepage"><div><div><h6 class="title">2.4.1.2.2.2. Catalog health requirements</h6></div></div></div><p>
								Operator catalogs on a cluster are interchangeable from the perspective of installation resolution; a <code class="literal">Subscription</code> object might reference a specific catalog, but dependencies are resolved using all catalogs on the cluster.
							</p><p>
								For example, if Catalog A is unhealthy, a subscription referencing Catalog A could resolve a dependency in Catalog B, which the cluster administrator might not have been expecting, because B normally had a lower catalog priority than A.
							</p><p>
								As a result, OLM requires that all catalogs with a given global namespace (for example, the default <code class="literal">openshift-marketplace</code> namespace or a custom global namespace) are healthy. When a catalog is unhealthy, all Operator installation or update operations within its shared global namespace will fail with a <code class="literal">CatalogSourcesUnhealthy</code> condition. If these operations were permitted in an unhealthy state, OLM might make resolution and installation decisions that were unexpected to the cluster administrator.
							</p><p>
								As a cluster administrator, if you observe an unhealthy catalog and want to consider the catalog as invalid and resume Operator installations, see the "Removing custom catalogs" or "Disabling the default OperatorHub catalog sources" sections for information about removing the unhealthy catalog.
							</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
										<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-removing-catalogs_olm-managing-custom-catalogs">Removing custom catalogs</a>
									</li><li class="listitem">
										<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-restricted-networks-operatorhub_olm-managing-custom-catalogs">Disabling the default OperatorHub catalog sources</a>
									</li></ul></div></section></section><section class="section" id="olm-subscription_olm-understanding-olm"><div class="titlepage"><div><div><h5 class="title">2.4.1.2.3. Subscription</h5></div></div></div><p>
							A <span class="emphasis"><em>subscription</em></span>, defined by a <code class="literal">Subscription</code> object, represents an intention to install an Operator. It is the custom resource that relates an Operator to a catalog source.
						</p><p>
							Subscriptions describe which channel of an Operator package to subscribe to, and whether to perform updates automatically or manually. If set to automatic, the subscription ensures Operator Lifecycle Manager (OLM) manages and upgrades the Operator to ensure that the latest version is always running in the cluster.
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">Subscription</code> object</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: example-operator
  namespace: example-namespace
spec:
  channel: stable
  name: example-operator
  source: example-catalog
  sourceNamespace: openshift-marketplace</pre>

							</p></div><p>
							This <code class="literal">Subscription</code> object defines the name and namespace of the Operator, as well as the catalog from which the Operator data can be found. The channel, such as <code class="literal">alpha</code>, <code class="literal">beta</code>, or <code class="literal">stable</code>, helps determine which Operator stream should be installed from the catalog source.
						</p><p>
							The names of channels in a subscription can differ between Operators, but the naming scheme should follow a common convention within a given Operator. For example, channel names might follow a minor release update stream for the application provided by the Operator (<code class="literal">1.2</code>, <code class="literal">1.3</code>) or a release frequency (<code class="literal">stable</code>, <code class="literal">fast</code>).
						</p><p>
							In addition to being easily visible from the OpenShift Container Platform web console, it is possible to identify when there is a newer version of an Operator available by inspecting the status of the related subscription. The value associated with the <code class="literal">currentCSV</code> field is the newest version that is known to OLM, and <code class="literal">installedCSV</code> is the version that is installed on the cluster.
						</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-colocation">Multitenancy and Operator colocation</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-status-viewing-cli_olm-status">Viewing Operator subscription status by using the CLI</a>
								</li></ul></div></section><section class="section" id="olm-installplan_olm-understanding-olm"><div class="titlepage"><div><div><h5 class="title">2.4.1.2.4. Install plan</h5></div></div></div><p>
							An <span class="emphasis"><em>install plan</em></span>, defined by an <code class="literal">InstallPlan</code> object, describes a set of resources that Operator Lifecycle Manager (OLM) creates to install or upgrade to a specific version of an Operator. The version is defined by a cluster service version (CSV).
						</p><p>
							To install an Operator, a cluster administrator, or a user who has been granted Operator installation permissions, must first create a <code class="literal">Subscription</code> object. A subscription represents the intent to subscribe to a stream of available versions of an Operator from a catalog source. The subscription then creates an <code class="literal">InstallPlan</code> object to facilitate the installation of the resources for the Operator.
						</p><p>
							The install plan must then be approved according to one of the following approval strategies:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									If the subscription’s <code class="literal">spec.installPlanApproval</code> field is set to <code class="literal">Automatic</code>, the install plan is approved automatically.
								</li><li class="listitem">
									If the subscription’s <code class="literal">spec.installPlanApproval</code> field is set to <code class="literal">Manual</code>, the install plan must be manually approved by a cluster administrator or user with proper permissions.
								</li></ul></div><p>
							After the install plan is approved, OLM creates the specified resources and installs the Operator in the namespace that is specified by the subscription.
						</p><div class="example" id="idm139732003660784"><p class="title"><strong>Example 2.11. Example <code class="literal">InstallPlan</code> object</strong></p><div class="example-contents"><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: InstallPlan
metadata:
  name: install-abcde
  namespace: operators
spec:
  approval: Automatic
  approved: true
  clusterServiceVersionNames:
    - my-operator.v1.0.1
  generation: 1
status:
  ...
  catalogSources: []
  conditions:
    - lastTransitionTime: '2021-01-01T20:17:27Z'
      lastUpdateTime: '2021-01-01T20:17:27Z'
      status: 'True'
      type: Installed
  phase: Complete
  plan:
    - resolving: my-operator.v1.0.1
      resource:
        group: operators.coreos.com
        kind: ClusterServiceVersion
        manifest: &gt;-
        ...
        name: my-operator.v1.0.1
        sourceName: redhat-operators
        sourceNamespace: openshift-marketplace
        version: v1alpha1
      status: Created
    - resolving: my-operator.v1.0.1
      resource:
        group: apiextensions.k8s.io
        kind: CustomResourceDefinition
        manifest: &gt;-
        ...
        name: webservers.web.servers.org
        sourceName: redhat-operators
        sourceNamespace: openshift-marketplace
        version: v1beta1
      status: Created
    - resolving: my-operator.v1.0.1
      resource:
        group: ''
        kind: ServiceAccount
        manifest: &gt;-
        ...
        name: my-operator
        sourceName: redhat-operators
        sourceNamespace: openshift-marketplace
        version: v1
      status: Created
    - resolving: my-operator.v1.0.1
      resource:
        group: rbac.authorization.k8s.io
        kind: Role
        manifest: &gt;-
        ...
        name: my-operator.v1.0.1-my-operator-6d7cbc6f57
        sourceName: redhat-operators
        sourceNamespace: openshift-marketplace
        version: v1
      status: Created
    - resolving: my-operator.v1.0.1
      resource:
        group: rbac.authorization.k8s.io
        kind: RoleBinding
        manifest: &gt;-
        ...
        name: my-operator.v1.0.1-my-operator-6d7cbc6f57
        sourceName: redhat-operators
        sourceNamespace: openshift-marketplace
        version: v1
      status: Created
      ...</pre></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-colocation">Multitenancy and Operator colocation</a>
								</li><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-creating-policy">Allowing non-cluster administrators to install Operators</a>
								</li></ul></div></section><section class="section" id="olm-operatorgroups-about_olm-understanding-olm"><div class="titlepage"><div><div><h5 class="title">2.4.1.2.5. Operator groups</h5></div></div></div><p>
							An <span class="emphasis"><em>Operator group</em></span>, defined by the <code class="literal">OperatorGroup</code> resource, provides multitenant configuration to OLM-installed Operators. An Operator group selects target namespaces in which to generate required RBAC access for its member Operators.
						</p><p>
							The set of target namespaces is provided by a comma-delimited string stored in the <code class="literal">olm.targetNamespaces</code> annotation of a cluster service version (CSV). This annotation is applied to the CSV instances of member Operators and is projected into their deployments.
						</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-understanding-operatorgroups">Operator groups</a>
								</li></ul></div></section><section class="section" id="olm-about-operatorconditions_olm-understanding-olm"><div class="titlepage"><div><div><h5 class="title">2.4.1.2.6. Operator conditions</h5></div></div></div><p>
							As part of its role in managing the lifecycle of an Operator, Operator Lifecycle Manager (OLM) infers the state of an Operator from the state of Kubernetes resources that define the Operator. While this approach provides some level of assurance that an Operator is in a given state, there are many instances where an Operator might need to communicate information to OLM that could not be inferred otherwise. This information can then be used by OLM to better manage the lifecycle of the Operator.
						</p><p>
							OLM provides a custom resource definition (CRD) called <code class="literal">OperatorCondition</code> that allows Operators to communicate conditions to OLM. There are a set of supported conditions that influence management of the Operator by OLM when present in the <code class="literal">Spec.Conditions</code> array of an <code class="literal">OperatorCondition</code> resource.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								By default, the <code class="literal">Spec.Conditions</code> array is not present in an <code class="literal">OperatorCondition</code> object until it is either added by a user or as a result of custom Operator logic.
							</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-operatorconditions">Operator conditions</a>
								</li></ul></div></section></section></section><section class="section" id="olm-arch"><div class="titlepage"><div><div><h3 class="title">2.4.2. Operator Lifecycle Manager architecture</h3></div></div></div><p>
					This guide outlines the component architecture of Operator Lifecycle Manager (OLM) in OpenShift Container Platform.
				</p><section class="section" id="olm-architecture_olm-arch"><div class="titlepage"><div><div><h4 class="title">2.4.2.1. Component responsibilities</h4></div></div></div><p>
						Operator Lifecycle Manager (OLM) is composed of two Operators: the OLM Operator and the Catalog Operator.
					</p><p>
						Each of these Operators is responsible for managing the custom resource definitions (CRDs) that are the basis for the OLM framework:
					</p><div class="table" id="idm139732001049024"><p class="title"><strong>Table 2.2. CRDs managed by OLM and Catalog Operators</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 17%; " class="col_1"><!--Empty--></col><col style="width: 8%; " class="col_2"><!--Empty--></col><col style="width: 8%; " class="col_3"><!--Empty--></col><col style="width: 67%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139732001708576" scope="col">Resource</th><th align="left" valign="top" id="idm139732001707488" scope="col">Short name</th><th align="left" valign="top" id="idm139732005035376" scope="col">Owner</th><th align="left" valign="top" id="idm139732005034288" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139732001708576"> <p>
										<code class="literal">ClusterServiceVersion</code> (CSV)
									</p>
									 </td><td align="left" valign="top" headers="idm139732001707488"> <p>
										<code class="literal">csv</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732005035376"> <p>
										OLM
									</p>
									 </td><td align="left" valign="top" headers="idm139732005034288"> <p>
										Application metadata: name, version, icon, required resources, installation, and so on.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139732001708576"> <p>
										<code class="literal">InstallPlan</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732001707488"> <p>
										<code class="literal">ip</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732005035376"> <p>
										Catalog
									</p>
									 </td><td align="left" valign="top" headers="idm139732005034288"> <p>
										Calculated list of resources to be created to automatically install or upgrade a CSV.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139732001708576"> <p>
										<code class="literal">CatalogSource</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732001707488"> <p>
										<code class="literal">catsrc</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732005035376"> <p>
										Catalog
									</p>
									 </td><td align="left" valign="top" headers="idm139732005034288"> <p>
										A repository of CSVs, CRDs, and packages that define an application.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139732001708576"> <p>
										<code class="literal">Subscription</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732001707488"> <p>
										<code class="literal">sub</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732005035376"> <p>
										Catalog
									</p>
									 </td><td align="left" valign="top" headers="idm139732005034288"> <p>
										Used to keep CSVs up to date by tracking a channel in a package.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139732001708576"> <p>
										<code class="literal">OperatorGroup</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732001707488"> <p>
										<code class="literal">og</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732005035376"> <p>
										OLM
									</p>
									 </td><td align="left" valign="top" headers="idm139732005034288"> <p>
										Configures all Operators deployed in the same namespace as the <code class="literal">OperatorGroup</code> object to watch for their custom resource (CR) in a list of namespaces or cluster-wide.
									</p>
									 </td></tr></tbody></table></div></div><p>
						Each of these Operators is also responsible for creating the following resources:
					</p><div class="table" id="idm139731997787392"><p class="title"><strong>Table 2.3. Resources created by OLM and Catalog Operators</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731985577312" scope="col">Resource</th><th align="left" valign="top" id="idm139731985576224" scope="col">Owner</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731985577312"> <p>
										<code class="literal">Deployments</code>
									</p>
									 </td><td rowspan="4" align="left" valign="middle" headers="idm139731985576224"> <p>
										OLM
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731985577312"> <p>
										<code class="literal">ServiceAccounts</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731985577312"> <p>
										<code class="literal">(Cluster)Roles</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731985577312"> <p>
										<code class="literal">(Cluster)RoleBindings</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731985577312"> <p>
										<code class="literal">CustomResourceDefinitions</code> (CRDs)
									</p>
									 </td><td rowspan="2" align="left" valign="middle" headers="idm139731985576224"> <p>
										Catalog
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731985577312"> <p>
										<code class="literal">ClusterServiceVersions</code>
									</p>
									 </td></tr></tbody></table></div></div></section><section class="section" id="olm-arch-olm-operator_olm-arch"><div class="titlepage"><div><div><h4 class="title">2.4.2.2. OLM Operator</h4></div></div></div><p>
						The OLM Operator is responsible for deploying applications defined by CSV resources after the required resources specified in the CSV are present in the cluster.
					</p><p>
						The OLM Operator is not concerned with the creation of the required resources; you can choose to manually create these resources using the CLI or using the Catalog Operator. This separation of concern allows users incremental buy-in in terms of how much of the OLM framework they choose to leverage for their application.
					</p><p>
						The OLM Operator uses the following workflow:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Watch for cluster service versions (CSVs) in a namespace and check that requirements are met.
							</li><li class="listitem"><p class="simpara">
								If requirements are met, run the install strategy for the CSV.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									A CSV must be an active member of an Operator group for the install strategy to run.
								</p></div></div></li></ol></div></section><section class="section" id="olm-arch-catalog-operator_olm-arch"><div class="titlepage"><div><div><h4 class="title">2.4.2.3. Catalog Operator</h4></div></div></div><p>
						The Catalog Operator is responsible for resolving and installing cluster service versions (CSVs) and the required resources they specify. It is also responsible for watching catalog sources for updates to packages in channels and upgrading them, automatically if desired, to the latest available versions.
					</p><p>
						To track a package in a channel, you can create a <code class="literal">Subscription</code> object configuring the desired package, channel, and the <code class="literal">CatalogSource</code> object you want to use for pulling updates. When updates are found, an appropriate <code class="literal">InstallPlan</code> object is written into the namespace on behalf of the user.
					</p><p>
						The Catalog Operator uses the following workflow:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Connect to each catalog source in the cluster.
							</li><li class="listitem"><p class="simpara">
								Watch for unresolved install plans created by a user, and if found:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Find the CSV matching the name requested and add the CSV as a resolved resource.
									</li><li class="listitem">
										For each managed or required CRD, add the CRD as a resolved resource.
									</li><li class="listitem">
										For each required CRD, find the CSV that manages it.
									</li></ol></div></li><li class="listitem">
								Watch for resolved install plans and create all of the discovered resources for it, if approved by a user or automatically.
							</li><li class="listitem">
								Watch for catalog sources and subscriptions and create install plans based on them.
							</li></ol></div></section><section class="section" id="olm-arch-catalog-registry_olm-arch"><div class="titlepage"><div><div><h4 class="title">2.4.2.4. Catalog Registry</h4></div></div></div><p>
						The Catalog Registry stores CSVs and CRDs for creation in a cluster and stores metadata about packages and channels.
					</p><p>
						A <span class="emphasis"><em>package manifest</em></span> is an entry in the Catalog Registry that associates a package identity with sets of CSVs. Within a package, channels point to a particular CSV. Because CSVs explicitly reference the CSV that they replace, a package manifest provides the Catalog Operator with all of the information that is required to update a CSV to the latest version in a channel, stepping through each intermediate version.
					</p></section></section><section class="section" id="olm-workflow"><div class="titlepage"><div><div><h3 class="title">2.4.3. Operator Lifecycle Manager workflow</h3></div></div></div><p>
					This guide outlines the workflow of Operator Lifecycle Manager (OLM) in OpenShift Container Platform.
				</p><section class="section" id="olm-upgrades_olm-workflow"><div class="titlepage"><div><div><h4 class="title">2.4.3.1. Operator installation and upgrade workflow in OLM</h4></div></div></div><p>
						In the Operator Lifecycle Manager (OLM) ecosystem, the following resources are used to resolve Operator installations and upgrades:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">ClusterServiceVersion</code> (CSV)
							</li><li class="listitem">
								<code class="literal">CatalogSource</code>
							</li><li class="listitem">
								<code class="literal">Subscription</code>
							</li></ul></div><p>
						Operator metadata, defined in CSVs, can be stored in a collection called a catalog source. OLM uses catalog sources, which use the <a class="link" href="https://github.com/operator-framework/operator-registry">Operator Registry API</a>, to query for available Operators as well as upgrades for installed Operators.
					</p><div class="figure" id="idm139731999780080"><p class="title"><strong>Figure 2.3. Catalog source overview</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Operators-en-US/images/a4756a206580a0a1ab0e6a170ddc75e3/olm-catalogsource.png" alt="olm catalogsource"/></div></div></div><p>
						Within a catalog source, Operators are organized into <span class="emphasis"><em>packages</em></span> and streams of updates called <span class="emphasis"><em>channels</em></span>, which should be a familiar update pattern from OpenShift Container Platform or other software on a continuous release cycle like web browsers.
					</p><div class="figure" id="idm139731976600752"><p class="title"><strong>Figure 2.4. Packages and channels in a Catalog source</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Operators-en-US/images/52025648e55a627b8be314426148fb97/olm-channels.png" alt="olm channels"/></div></div></div><p>
						A user indicates a particular package and channel in a particular catalog source in a <span class="emphasis"><em>subscription</em></span>, for example an <code class="literal">etcd</code> package and its <code class="literal">alpha</code> channel. If a subscription is made to a package that has not yet been installed in the namespace, the latest Operator for that package is installed.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							OLM deliberately avoids version comparisons, so the "latest" or "newest" Operator available from a given <span class="emphasis"><em>catalog</em></span> → <span class="emphasis"><em>channel</em></span> → <span class="emphasis"><em>package</em></span> path does not necessarily need to be the highest version number. It should be thought of more as the <span class="emphasis"><em>head</em></span> reference of a channel, similar to a Git repository.
						</p></div></div><p>
						Each CSV has a <code class="literal">replaces</code> parameter that indicates which Operator it replaces. This builds a graph of CSVs that can be queried by OLM, and updates can be shared between channels. Channels can be thought of as entry points into the graph of updates:
					</p><div class="figure" id="idm139732005533168"><p class="title"><strong>Figure 2.5. OLM graph of available channel updates</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Operators-en-US/images/6990efb545ef499e93732227bbe7df68/olm-replaces.png" alt="olm replaces"/></div></div></div><div class="formalpara"><p class="title"><strong>Example channels in a package</strong></p><p>
							
<pre class="programlisting language-yaml">packageName: example
channels:
- name: alpha
  currentCSV: example.v0.1.2
- name: beta
  currentCSV: example.v0.1.3
defaultChannel: alpha</pre>

						</p></div><p>
						For OLM to successfully query for updates, given a catalog source, package, channel, and CSV, a catalog must be able to return, unambiguously and deterministically, a single CSV that <code class="literal">replaces</code> the input CSV.
					</p><section class="section" id="olm-upgrades-example-upgrade-path_olm-workflow"><div class="titlepage"><div><div><h5 class="title">2.4.3.1.1. Example upgrade path</h5></div></div></div><p>
							For an example upgrade scenario, consider an installed Operator corresponding to CSV version <code class="literal">0.1.1</code>. OLM queries the catalog source and detects an upgrade in the subscribed channel with new CSV version <code class="literal">0.1.3</code> that replaces an older but not-installed CSV version <code class="literal">0.1.2</code>, which in turn replaces the older and installed CSV version <code class="literal">0.1.1</code>.
						</p><p>
							OLM walks back from the channel head to previous versions via the <code class="literal">replaces</code> field specified in the CSVs to determine the upgrade path <code class="literal">0.1.3</code> → <code class="literal">0.1.2</code> → <code class="literal">0.1.1</code>; the direction of the arrow indicates that the former replaces the latter. OLM upgrades the Operator one version at the time until it reaches the channel head.
						</p><p>
							For this given scenario, OLM installs Operator version <code class="literal">0.1.2</code> to replace the existing Operator version <code class="literal">0.1.1</code>. Then, it installs Operator version <code class="literal">0.1.3</code> to replace the previously installed Operator version <code class="literal">0.1.2</code>. At this point, the installed operator version <code class="literal">0.1.3</code> matches the channel head and the upgrade is completed.
						</p></section><section class="section" id="olm-upgrades-skipping_olm-workflow"><div class="titlepage"><div><div><h5 class="title">2.4.3.1.2. Skipping upgrades</h5></div></div></div><p>
							The basic path for upgrades in OLM is:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									A catalog source is updated with one or more updates to an Operator.
								</li><li class="listitem">
									OLM traverses every version of the Operator until reaching the latest version the catalog source contains.
								</li></ul></div><p>
							However, sometimes this is not a safe operation to perform. There will be cases where a published version of an Operator should never be installed on a cluster if it has not already, for example because a version introduces a serious vulnerability.
						</p><p>
							In those cases, OLM must consider two cluster states and provide an update graph that supports both:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The "bad" intermediate Operator has been seen by the cluster and installed.
								</li><li class="listitem">
									The "bad" intermediate Operator has not yet been installed onto the cluster.
								</li></ul></div><p>
							By shipping a new catalog and adding a <span class="emphasis"><em>skipped</em></span> release, OLM is ensured that it can always get a single unique update regardless of the cluster state and whether it has seen the bad update yet.
						</p><div class="formalpara"><p class="title"><strong>Example CSV with skipped release</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: ClusterServiceVersion
metadata:
  name: etcdoperator.v0.9.2
  namespace: placeholder
  annotations:
spec:
    displayName: etcd
    description: Etcd Operator
    replaces: etcdoperator.v0.9.0
    skips:
    - etcdoperator.v0.9.1</pre>

							</p></div><p>
							Consider the following example of <span class="strong strong"><strong>Old CatalogSource</strong></span> and <span class="strong strong"><strong>New CatalogSource</strong></span>.
						</p><div class="figure" id="idm139731984881456"><p class="title"><strong>Figure 2.6. Skipping updates</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Operators-en-US/images/da1fe891cee5ba712308b9d0e08b91e0/olm-skipping-updates.png" alt="olm skipping updates"/></div></div></div><p>
							This graph maintains that:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Any Operator found in <span class="strong strong"><strong>Old CatalogSource</strong></span> has a single replacement in <span class="strong strong"><strong>New CatalogSource</strong></span>.
								</li><li class="listitem">
									Any Operator found in <span class="strong strong"><strong>New CatalogSource</strong></span> has a single replacement in <span class="strong strong"><strong>New CatalogSource</strong></span>.
								</li><li class="listitem">
									If the bad update has not yet been installed, it will never be.
								</li></ul></div></section><section class="section" id="olm-upgrades-replacing-multiple_olm-workflow"><div class="titlepage"><div><div><h5 class="title">2.4.3.1.3. Replacing multiple Operators</h5></div></div></div><p>
							Creating <span class="strong strong"><strong>New CatalogSource</strong></span> as described requires publishing CSVs that <code class="literal">replace</code> one Operator, but can <code class="literal">skip</code> several. This can be accomplished using the <code class="literal">skipRange</code> annotation:
						</p><pre class="programlisting language-yaml">olm.skipRange: &lt;semver_range&gt;</pre><p>
							where <code class="literal">&lt;semver_range&gt;</code> has the version range format supported by the <a class="link" href="https://github.com/blang/semver#ranges">semver library</a>.
						</p><p>
							When searching catalogs for updates, if the head of a channel has a <code class="literal">skipRange</code> annotation and the currently installed Operator has a version field that falls in the range, OLM updates to the latest entry in the channel.
						</p><p>
							The order of precedence is:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
									Channel head in the source specified by <code class="literal">sourceName</code> on the subscription, if the other criteria for skipping are met.
								</li><li class="listitem">
									The next Operator that replaces the current one, in the source specified by <code class="literal">sourceName</code>.
								</li><li class="listitem">
									Channel head in another source that is visible to the subscription, if the other criteria for skipping are met.
								</li><li class="listitem">
									The next Operator that replaces the current one in any source visible to the subscription.
								</li></ol></div><div class="formalpara"><p class="title"><strong>Example CSV with <code class="literal">skipRange</code></strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: ClusterServiceVersion
metadata:
    name: elasticsearch-operator.v4.1.2
    namespace: &lt;namespace&gt;
    annotations:
        olm.skipRange: '&gt;=4.1.0 &lt;4.1.2'</pre>

							</p></div></section><section class="section" id="olm-upgrades-z-stream_olm-workflow"><div class="titlepage"><div><div><h5 class="title">2.4.3.1.4. Z-stream support</h5></div></div></div><p>
							A <span class="emphasis"><em>z-stream</em></span>, or patch release, must replace all previous z-stream releases for the same minor version. OLM does not consider major, minor, or patch versions, it just needs to build the correct graph in a catalog.
						</p><p>
							In other words, OLM must be able to take a graph as in <span class="strong strong"><strong>Old CatalogSource</strong></span> and, similar to before, generate a graph as in <span class="strong strong"><strong>New CatalogSource</strong></span>:
						</p><div class="figure" id="idm139732008185056"><p class="title"><strong>Figure 2.7. Replacing several Operators</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Operators-en-US/images/9d8f445a920be612fe82454a3a545e70/olm-z-stream.png" alt="olm z stream"/></div></div></div><p>
							This graph maintains that:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Any Operator found in <span class="strong strong"><strong>Old CatalogSource</strong></span> has a single replacement in <span class="strong strong"><strong>New CatalogSource</strong></span>.
								</li><li class="listitem">
									Any Operator found in <span class="strong strong"><strong>New CatalogSource</strong></span> has a single replacement in <span class="strong strong"><strong>New CatalogSource</strong></span>.
								</li><li class="listitem">
									Any z-stream release in <span class="strong strong"><strong>Old CatalogSource</strong></span> will update to the latest z-stream release in <span class="strong strong"><strong>New CatalogSource</strong></span>.
								</li><li class="listitem">
									Unavailable releases can be considered "virtual" graph nodes; their content does not need to exist, the registry just needs to respond as if the graph looks like this.
								</li></ul></div></section></section></section><section class="section" id="olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h3 class="title">2.4.4. Operator Lifecycle Manager dependency resolution</h3></div></div></div><p>
					This guide outlines dependency resolution and custom resource definition (CRD) upgrade lifecycles with Operator Lifecycle Manager (OLM) in OpenShift Container Platform.
				</p><section class="section" id="olm-dependency-resolution-about_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h4 class="title">2.4.4.1. About dependency resolution</h4></div></div></div><p>
						Operator Lifecycle Manager (OLM) manages the dependency resolution and upgrade lifecycle of running Operators. In many ways, the problems OLM faces are similar to other system or language package managers, such as <code class="literal">yum</code> and <code class="literal">rpm</code>.
					</p><p>
						However, there is one constraint that similar systems do not generally have that OLM does: because Operators are always running, OLM attempts to ensure that you are never left with a set of Operators that do not work with each other.
					</p><p>
						As a result, OLM must never create the following scenarios:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Install a set of Operators that require APIs that cannot be provided
							</li><li class="listitem">
								Update an Operator in a way that breaks another that depends upon it
							</li></ul></div><p>
						This is made possible with two types of data:
					</p><div class="horizontal"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 15%; "><!--Empty--></col><col style="width: 85%; "><!--Empty--></col></colgroup><tbody valign="top"><tr><td valign="top"> <p>
										Properties
									</p>
									 </td><td valign="top"> <p>
										Typed metadata about the Operator that constitutes the public interface for it in the dependency resolver. Examples include the group/version/kind (GVK) of the APIs provided by the Operator and the semantic version (semver) of the Operator.
									</p>
									 </td></tr><tr><td valign="top"> <p>
										Constraints or dependencies
									</p>
									 </td><td valign="top"> <p>
										An Operator’s requirements that should be satisfied by other Operators that might or might not have already been installed on the target cluster. These act as queries or filters over all available Operators and constrain the selection during dependency resolution and installation. Examples include requiring a specific API to be available on the cluster or expecting a particular Operator with a particular version to be installed.
									</p>
									 </td></tr></tbody></table></div><p>
						OLM converts these properties and constraints into a system of Boolean formulas and passes them to a SAT solver, a program that establishes Boolean satisfiability, which does the work of determining what Operators should be installed.
					</p></section><section class="section" id="olm-properties_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h4 class="title">2.4.4.2. Operator properties</h4></div></div></div><p>
						All Operators in a catalog have the following properties:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">olm.package</code></span></dt><dd>
									Includes the name of the package and the version of the Operator
								</dd><dt><span class="term"><code class="literal">olm.gvk</code></span></dt><dd>
									A single property for each provided API from the cluster service version (CSV)
								</dd></dl></div><p>
						Additional properties can also be directly declared by an Operator author by including a <code class="literal">properties.yaml</code> file in the <code class="literal">metadata/</code> directory of the Operator bundle.
					</p><div class="formalpara"><p class="title"><strong>Example arbitrary property</strong></p><p>
							
<pre class="programlisting language-yaml">properties:
- type: olm.kubeversion
  value:
    version: "1.16.0"</pre>

						</p></div><section class="section" id="olm-arbitrary-properties_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h5 class="title">2.4.4.2.1. Arbitrary properties</h5></div></div></div><p>
							Operator authors can declare arbitrary properties in a <code class="literal">properties.yaml</code> file in the <code class="literal">metadata/</code> directory of the Operator bundle. These properties are translated into a map data structure that is used as an input to the Operator Lifecycle Manager (OLM) resolver at runtime.
						</p><p>
							These properties are opaque to the resolver as it does not understand the properties, but it can evaluate the generic constraints against those properties to determine if the constraints can be satisfied given the properties list.
						</p><div class="formalpara"><p class="title"><strong>Example arbitrary properties</strong></p><p>
								
<pre class="programlisting language-yaml">properties:
  - property:
      type: color
      value: red
  - property:
      type: shape
      value: square
  - property:
      type: olm.gvk
      value:
        group: olm.coreos.io
        version: v1alpha1
        kind: myresource</pre>

							</p></div><p>
							This structure can be used to construct a Common Expression Language (CEL) expression for generic constraints.
						</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-cel_olm-understanding-dependency-resolution">Common Expression Language (CEL) constraints</a>
								</li></ul></div></section></section><section class="section" id="olm-dependencies_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h4 class="title">2.4.4.3. Operator dependencies</h4></div></div></div><p>
						The dependencies of an Operator are listed in a <code class="literal">dependencies.yaml</code> file in the <code class="literal">metadata/</code> folder of a bundle. This file is optional and currently only used to specify explicit Operator-version dependencies.
					</p><p>
						The dependency list contains a <code class="literal">type</code> field for each item to specify what kind of dependency this is. The following types of Operator dependencies are supported:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">olm.package</code></span></dt><dd>
									This type indicates a dependency for a specific Operator version. The dependency information must include the package name and the version of the package in semver format. For example, you can specify an exact version such as <code class="literal">0.5.2</code> or a range of versions such as <code class="literal">&gt;0.5.1</code>.
								</dd><dt><span class="term"><code class="literal">olm.gvk</code></span></dt><dd>
									With this type, the author can specify a dependency with group/version/kind (GVK) information, similar to existing CRD and API-based usage in a CSV. This is a path to enable Operator authors to consolidate all dependencies, API or explicit versions, to be in the same place.
								</dd><dt><span class="term"><code class="literal">olm.constraint</code></span></dt><dd>
									This type declares generic constraints on arbitrary Operator properties.
								</dd></dl></div><p>
						In the following example, dependencies are specified for a Prometheus Operator and etcd CRDs:
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">dependencies.yaml</code> file</strong></p><p>
							
<pre class="programlisting language-yaml">dependencies:
  - type: olm.package
    value:
      packageName: prometheus
      version: "&gt;0.27.0"
  - type: olm.gvk
    value:
      group: etcd.database.coreos.com
      kind: EtcdCluster
      version: v1beta2</pre>

						</p></div></section><section class="section" id="olm-generic-constraints_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h4 class="title">2.4.4.4. Generic constraints</h4></div></div></div><p>
						An <code class="literal">olm.constraint</code> property declares a dependency constraint of a particular type, differentiating non-constraint and constraint properties. Its <code class="literal">value</code> field is an object containing a <code class="literal">failureMessage</code> field holding a string-representation of the constraint message. This message is surfaced as an informative comment to users if the constraint is not satisfiable at runtime.
					</p><p>
						The following keys denote the available constraint types:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">gvk</code></span></dt><dd>
									Type whose value and interpretation is identical to the <code class="literal">olm.gvk</code> type
								</dd><dt><span class="term"><code class="literal">package</code></span></dt><dd>
									Type whose value and interpretation is identical to the <code class="literal">olm.package</code> type
								</dd><dt><span class="term"><code class="literal">cel</code></span></dt><dd>
									A Common Expression Language (CEL) expression evaluated at runtime by the Operator Lifecycle Manager (OLM) resolver over arbitrary bundle properties and cluster information
								</dd><dt><span class="term"><code class="literal">all</code>, <code class="literal">any</code>, <code class="literal">not</code></span></dt><dd>
									Conjunction, disjunction, and negation constraints, respectively, containing one or more concrete constraints, such as <code class="literal">gvk</code> or a nested compound constraint
								</dd></dl></div><section class="section" id="olm-cel_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h5 class="title">2.4.4.4.1. Common Expression Language (CEL) constraints</h5></div></div></div><p>
							The <code class="literal">cel</code> constraint type supports <a class="link" href="https://github.com/google/cel-go">Common Expression Language (CEL)</a> as the expression language. The <code class="literal">cel</code> struct has a <code class="literal">rule</code> field which contains the CEL expression string that is evaluated against Operator properties at runtime to determine if the Operator satisfies the constraint.
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">cel</code> constraint</strong></p><p>
								
<pre class="programlisting language-yaml">type: olm.constraint
value:
  failureMessage: 'require to have "certified"'
  cel:
    rule: 'properties.exists(p, p.type == "certified")'</pre>

							</p></div><p>
							The CEL syntax supports a wide range of logical operators, such as <code class="literal">AND</code> and <code class="literal">OR</code>. As a result, a single CEL expression can have multiple rules for multiple conditions that are linked together by these logical operators. These rules are evaluated against a dataset of multiple different properties from a bundle or any given source, and the output is solved into a single bundle or Operator that satisfies all of those rules within a single constraint.
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">cel</code> constraint with multiple rules</strong></p><p>
								
<pre class="programlisting language-yaml">type: olm.constraint
value:
  failureMessage: 'require to have "certified" and "stable" properties'
  cel:
    rule: 'properties.exists(p, p.type == "certified") &amp;&amp; properties.exists(p, p.type == "stable")'</pre>

							</p></div></section><section class="section" id="olm-compound-constraints_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h5 class="title">2.4.4.4.2. Compound constraints (all, any, not)</h5></div></div></div><p>
							Compound constraint types are evaluated following their logical definitions.
						</p><p>
							The following is an example of a conjunctive constraint (<code class="literal">all</code>) of two packages and one GVK. That is, they must all be satisfied by installed bundles:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">all</code> constraint</strong></p><p>
								
<pre class="programlisting language-yaml">schema: olm.bundle
name: red.v1.0.0
properties:
- type: olm.constraint
  value:
    failureMessage: All are required for Red because...
    all:
      constraints:
      - failureMessage: Package blue is needed for...
        package:
          name: blue
          versionRange: '&gt;=1.0.0'
      - failureMessage: GVK Green/v1 is needed for...
        gvk:
          group: greens.example.com
          version: v1
          kind: Green</pre>

							</p></div><p>
							The following is an example of a disjunctive constraint (<code class="literal">any</code>) of three versions of the same GVK. That is, at least one must be satisfied by installed bundles:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">any</code> constraint</strong></p><p>
								
<pre class="programlisting language-yaml">schema: olm.bundle
name: red.v1.0.0
properties:
- type: olm.constraint
  value:
    failureMessage: Any are required for Red because...
    any:
      constraints:
      - gvk:
          group: blues.example.com
          version: v1beta1
          kind: Blue
      - gvk:
          group: blues.example.com
          version: v1beta2
          kind: Blue
      - gvk:
          group: blues.example.com
          version: v1
          kind: Blue</pre>

							</p></div><p>
							The following is an example of a negation constraint (<code class="literal">not</code>) of one version of a GVK. That is, this GVK cannot be provided by any bundle in the result set:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">not</code> constraint</strong></p><p>
								
<pre class="programlisting language-yaml">schema: olm.bundle
name: red.v1.0.0
properties:
- type: olm.constraint
  value:
  all:
    constraints:
    - failureMessage: Package blue is needed for...
      package:
        name: blue
        versionRange: '&gt;=1.0.0'
    - failureMessage: Cannot be required for Red because...
      not:
        constraints:
        - gvk:
            group: greens.example.com
            version: v1alpha1
            kind: greens</pre>

							</p></div><p>
							The negation semantics might appear unclear in the <code class="literal">not</code> constraint context. To clarify, the negation is really instructing the resolver to remove any possible solution that includes a particular GVK, package at a version, or satisfies some child compound constraint from the result set.
						</p><p>
							As a corollary, the <code class="literal">not</code> compound constraint should only be used within <code class="literal">all</code> or <code class="literal">any</code> constraints, because negating without first selecting a possible set of dependencies does not make sense.
						</p></section><section class="section" id="olm-nested-compound_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h5 class="title">2.4.4.4.3. Nested compound constraints</h5></div></div></div><p>
							A nested compound constraint, one that contains at least one child compound constraint along with zero or more simple constraints, is evaluated from the bottom up following the procedures for each previously described constraint type.
						</p><p>
							The following is an example of a disjunction of conjunctions, where one, the other, or both can satisfy the constraint:
						</p><div class="formalpara"><p class="title"><strong>Example nested compound constraint</strong></p><p>
								
<pre class="programlisting language-yaml">schema: olm.bundle
name: red.v1.0.0
properties:
- type: olm.constraint
  value:
    failureMessage: Required for Red because...
    any:
      constraints:
      - all:
          constraints:
          - package:
              name: blue
              versionRange: '&gt;=1.0.0'
          - gvk:
              group: blues.example.com
              version: v1
              kind: Blue
      - all:
          constraints:
          - package:
              name: blue
              versionRange: '&lt;1.0.0'
          - gvk:
              group: blues.example.com
              version: v1beta1
              kind: Blue</pre>

							</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The maximum raw size of an <code class="literal">olm.constraint</code> type is 64KB to limit resource exhaustion attacks.
							</p></div></div></section></section><section class="section" id="olm-dependency-resolution-preferences_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h4 class="title">2.4.4.5. Dependency preferences</h4></div></div></div><p>
						There can be many options that equally satisfy a dependency of an Operator. The dependency resolver in Operator Lifecycle Manager (OLM) determines which option best fits the requirements of the requested Operator. As an Operator author or user, it can be important to understand how these choices are made so that dependency resolution is clear.
					</p><section class="section" id="olm-dependency-catalog-priority_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h5 class="title">2.4.4.5.1. Catalog priority</h5></div></div></div><p>
							On OpenShift Container Platform cluster, OLM reads catalog sources to know which Operators are available for installation.
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">CatalogSource</code> object</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: "operators.coreos.com/v1alpha1"
kind: "CatalogSource"
metadata:
  name: "my-operators"
  namespace: "operators"
spec:
  sourceType: grpc
  grpcPodConfig:
    securityContextConfig: &lt;security_mode&gt; <span id="CO3-1"><!--Empty--></span><span class="callout">1</span>
  image: example.com/my/operator-index:v1
  displayName: "My Operators"
  priority: 100</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO3-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Specify the value of <code class="literal">legacy</code> or <code class="literal">restricted</code>. If the field is not set, the default value is <code class="literal">legacy</code>. In a future OpenShift Container Platform release, it is planned that the default value will be <code class="literal">restricted</code>. If your catalog cannot run with <code class="literal">restricted</code> permissions, it is recommended that you manually set this field to <code class="literal">legacy</code>.
								</div></dd></dl></div><p>
							A <code class="literal">CatalogSource</code> object has a <code class="literal">priority</code> field, which is used by the resolver to know how to prefer options for a dependency.
						</p><p>
							There are two rules that govern catalog preference:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Options in higher-priority catalogs are preferred to options in lower-priority catalogs.
								</li><li class="listitem">
									Options in the same catalog as the dependent are preferred to any other catalogs.
								</li></ul></div></section><section class="section" id="olm-dependency-catalog-ordering_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h5 class="title">2.4.4.5.2. Channel ordering</h5></div></div></div><p>
							An Operator package in a catalog is a collection of update channels that a user can subscribe to in an OpenShift Container Platform cluster. Channels can be used to provide a particular stream of updates for a minor release (<code class="literal">1.2</code>, <code class="literal">1.3</code>) or a release frequency (<code class="literal">stable</code>, <code class="literal">fast</code>).
						</p><p>
							It is likely that a dependency might be satisfied by Operators in the same package, but different channels. For example, version <code class="literal">1.2</code> of an Operator might exist in both the <code class="literal">stable</code> and <code class="literal">fast</code> channels.
						</p><p>
							Each package has a default channel, which is always preferred to non-default channels. If no option in the default channel can satisfy a dependency, options are considered from the remaining channels in lexicographic order of the channel name.
						</p></section><section class="section" id="olm-dependency-order-winthin-channel_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h5 class="title">2.4.4.5.3. Order within a channel</h5></div></div></div><p>
							There are almost always multiple options to satisfy a dependency within a single channel. For example, Operators in one package and channel provide the same set of APIs.
						</p><p>
							When a user creates a subscription, they indicate which channel to receive updates from. This immediately reduces the search to just that one channel. But within the channel, it is likely that many Operators satisfy a dependency.
						</p><p>
							Within a channel, newer Operators that are higher up in the update graph are preferred. If the head of a channel satisfies a dependency, it will be tried first.
						</p></section><section class="section" id="olm-dependency-preferences-other_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h5 class="title">2.4.4.5.4. Other constraints</h5></div></div></div><p>
							In addition to the constraints supplied by package dependencies, OLM includes additional constraints to represent the desired user state and enforce resolution invariants.
						</p><section class="section" id="olm-dependency-sub-constraint_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h6 class="title">2.4.4.5.4.1. Subscription constraint</h6></div></div></div><p>
								A subscription constraint filters the set of Operators that can satisfy a subscription. Subscriptions are user-supplied constraints for the dependency resolver. They declare the intent to either install a new Operator if it is not already on the cluster, or to keep an existing Operator updated.
							</p></section><section class="section" id="olm-dependency-package-constraint_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h6 class="title">2.4.4.5.4.2. Package constraint</h6></div></div></div><p>
								Within a namespace, no two Operators may come from the same package.
							</p></section></section><section class="section _additional-resources" id="additional-resources_dependency-resolution-preferences"><div class="titlepage"><div><div><h5 class="title">2.4.4.5.5. Additional resources</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-cs-health_olm-understanding-olm">Catalog health requirements</a>
								</li></ul></div></section></section><section class="section" id="olm-dependency-resolution-crd-upgrades_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h4 class="title">2.4.4.6. CRD upgrades</h4></div></div></div><p>
						OLM upgrades a custom resource definition (CRD) immediately if it is owned by a singular cluster service version (CSV). If a CRD is owned by multiple CSVs, then the CRD is upgraded when it has satisfied all of the following backward compatible conditions:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								All existing serving versions in the current CRD are present in the new CRD.
							</li><li class="listitem">
								All existing instances, or custom resources, that are associated with the serving versions of the CRD are valid when validated against the validation schema of the new CRD.
							</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-dependency-resolution-adding-new-crd-version_osdk-generating-csvs">Adding a new CRD version</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-dependency-resolution-removing-crd-version_osdk-generating-csvs">Deprecating or removing a CRD version</a>
							</li></ul></div></section><section class="section" id="olm-dependency-best-practices_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h4 class="title">2.4.4.7. Dependency best practices</h4></div></div></div><p>
						When specifying dependencies, there are best practices you should consider.
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Depend on APIs or a specific version range of Operators</span></dt><dd>
									Operators can add or remove APIs at any time; always specify an <code class="literal">olm.gvk</code> dependency on any APIs your Operators requires. The exception to this is if you are specifying <code class="literal">olm.package</code> constraints instead.
								</dd><dt><span class="term">Set a minimum version</span></dt><dd><p class="simpara">
									The Kubernetes documentation on API changes describes what changes are allowed for Kubernetes-style Operators. These versioning conventions allow an Operator to update an API without bumping the API version, as long as the API is backwards-compatible.
								</p><p class="simpara">
									For Operator dependencies, this means that knowing the API version of a dependency might not be enough to ensure the dependent Operator works as intended.
								</p><p class="simpara">
									For example:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											TestOperator v1.0.0 provides v1alpha1 API version of the <code class="literal">MyObject</code> resource.
										</li><li class="listitem">
											TestOperator v1.0.1 adds a new field <code class="literal">spec.newfield</code> to <code class="literal">MyObject</code>, but still at v1alpha1.
										</li></ul></div><p class="simpara">
									Your Operator might require the ability to write <code class="literal">spec.newfield</code> into the <code class="literal">MyObject</code> resource. An <code class="literal">olm.gvk</code> constraint alone is not enough for OLM to determine that you need TestOperator v1.0.1 and not TestOperator v1.0.0.
								</p><p class="simpara">
									Whenever possible, if a specific Operator that provides an API is known ahead of time, specify an additional <code class="literal">olm.package</code> constraint to set a minimum.
								</p></dd><dt><span class="term">Omit a maximum version or allow a very wide range</span></dt><dd><p class="simpara">
									Because Operators provide cluster-scoped resources such as API services and CRDs, an Operator that specifies a small window for a dependency might unnecessarily constrain updates for other consumers of that dependency.
								</p><p class="simpara">
									Whenever possible, do not set a maximum version. Alternatively, set a very wide semantic range to prevent conflicts with other Operators. For example, <code class="literal">&gt;1.0.0 &lt;2.0.0</code>.
								</p><p class="simpara">
									Unlike with conventional package managers, Operator authors explicitly encode that updates are safe through channels in OLM. If an update is available for an existing subscription, it is assumed that the Operator author is indicating that it can update from the previous version. Setting a maximum version for a dependency overrides the update stream of the author by unnecessarily truncating it at a particular upper bound.
								</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Cluster administrators cannot override dependencies set by an Operator author.
									</p></div></div><p class="simpara">
									However, maximum versions can and should be set if there are known incompatibilities that must be avoided. Specific versions can be omitted with the version range syntax, for example <code class="literal">&gt; 1.0.0 !1.2.1</code>.
								</p></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								Kubernetes documentation: <a class="link" href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api_changes.md#readme">Changing the API</a>
							</li></ul></div></section><section class="section" id="olm-dependency-caveats_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h4 class="title">2.4.4.8. Dependency caveats</h4></div></div></div><p>
						When specifying dependencies, there are caveats you should consider.
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">No compound constraints (AND)</span></dt><dd><p class="simpara">
									There is currently no method for specifying an AND relationship between constraints. In other words, there is no way to specify that one Operator depends on another Operator that both provides a given API and has version <code class="literal">&gt;1.1.0</code>.
								</p><p class="simpara">
									This means that when specifying a dependency such as:
								</p><pre class="programlisting language-yaml">dependencies:
- type: olm.package
  value:
    packageName: etcd
    version: "&gt;3.1.0"
- type: olm.gvk
  value:
    group: etcd.database.coreos.com
    kind: EtcdCluster
    version: v1beta2</pre><p class="simpara">
									It would be possible for OLM to satisfy this with two Operators: one that provides EtcdCluster and one that has version <code class="literal">&gt;3.1.0</code>. Whether that happens, or whether an Operator is selected that satisfies both constraints, depends on the ordering that potential options are visited. Dependency preferences and ordering options are well-defined and can be reasoned about, but to exercise caution, Operators should stick to one mechanism or the other.
								</p></dd><dt><span class="term">Cross-namespace compatibility</span></dt><dd>
									OLM performs dependency resolution at the namespace scope. It is possible to get into an update deadlock if updating an Operator in one namespace would be an issue for an Operator in another namespace, and vice-versa.
								</dd></dl></div></section><section class="section" id="olm-dependency-resolution-examples_olm-understanding-dependency-resolution"><div class="titlepage"><div><div><h4 class="title">2.4.4.9. Example dependency resolution scenarios</h4></div></div></div><p>
						In the following examples, a <span class="emphasis"><em>provider</em></span> is an Operator which "owns" a CRD or API service.
					</p><h5 id="example-deprecating-dependent-apis">Example: Deprecating dependent APIs</h5><p>
						A and B are APIs (CRDs):
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The provider of A depends on B.
							</li><li class="listitem">
								The provider of B has a subscription.
							</li><li class="listitem">
								The provider of B updates to provide C but deprecates B.
							</li></ul></div><p>
						This results in:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								B no longer has a provider.
							</li><li class="listitem">
								A no longer works.
							</li></ul></div><p>
						This is a case OLM prevents with its upgrade strategy.
					</p><h5 id="example-version-deadlock">Example: Version deadlock</h5><p>
						A and B are APIs:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The provider of A requires B.
							</li><li class="listitem">
								The provider of B requires A.
							</li><li class="listitem">
								The provider of A updates to (provide A2, require B2) and deprecate A.
							</li><li class="listitem">
								The provider of B updates to (provide B2, require A2) and deprecate B.
							</li></ul></div><p>
						If OLM attempts to update A without simultaneously updating B, or vice-versa, it is unable to progress to new versions of the Operators, even though a new compatible set can be found.
					</p><p>
						This is another case OLM prevents with its upgrade strategy.
					</p></section></section><section class="section" id="olm-understanding-operatorgroups"><div class="titlepage"><div><div><h3 class="title">2.4.5. Operator groups</h3></div></div></div><p>
					This guide outlines the use of Operator groups with Operator Lifecycle Manager (OLM) in OpenShift Container Platform.
				</p><section class="section" id="olm-operatorgroups-about_olm-understanding-operatorgroups"><div class="titlepage"><div><div><h4 class="title">2.4.5.1. About Operator groups</h4></div></div></div><p>
						An <span class="emphasis"><em>Operator group</em></span>, defined by the <code class="literal">OperatorGroup</code> resource, provides multitenant configuration to OLM-installed Operators. An Operator group selects target namespaces in which to generate required RBAC access for its member Operators.
					</p><p>
						The set of target namespaces is provided by a comma-delimited string stored in the <code class="literal">olm.targetNamespaces</code> annotation of a cluster service version (CSV). This annotation is applied to the CSV instances of member Operators and is projected into their deployments.
					</p></section><section class="section" id="olm-operatorgroups-membership_olm-understanding-operatorgroups"><div class="titlepage"><div><div><h4 class="title">2.4.5.2. Operator group membership</h4></div></div></div><p>
						An Operator is considered a <span class="emphasis"><em>member</em></span> of an Operator group if the following conditions are true:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The CSV of the Operator exists in the same namespace as the Operator group.
							</li><li class="listitem">
								The install modes in the CSV of the Operator support the set of namespaces targeted by the Operator group.
							</li></ul></div><p>
						An install mode in a CSV consists of an <code class="literal">InstallModeType</code> field and a boolean <code class="literal">Supported</code> field. The spec of a CSV can contain a set of install modes of four distinct <code class="literal">InstallModeTypes</code>:
					</p><div class="table" id="idm139732005831840"><p class="title"><strong>Table 2.4. Install modes and supported Operator groups</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 67%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731988821424" scope="col">InstallModeType</th><th align="left" valign="top" id="idm139731988820336" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731988821424"> <p>
										<code class="literal">OwnNamespace</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731988820336"> <p>
										The Operator can be a member of an Operator group that selects its own namespace.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731988821424"> <p>
										<code class="literal">SingleNamespace</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731988820336"> <p>
										The Operator can be a member of an Operator group that selects one namespace.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731988821424"> <p>
										<code class="literal">MultiNamespace</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731988820336"> <p>
										The Operator can be a member of an Operator group that selects more than one namespace.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731988821424"> <p>
										<code class="literal">AllNamespaces</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731988820336"> <p>
										The Operator can be a member of an Operator group that selects all namespaces (target namespace set is the empty string <code class="literal">""</code>).
									</p>
									 </td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If the spec of a CSV omits an entry of <code class="literal">InstallModeType</code>, then that type is considered unsupported unless support can be inferred by an existing entry that implicitly supports it.
						</p></div></div></section><section class="section" id="olm-operatorgroups-target-namespace_olm-understanding-operatorgroups"><div class="titlepage"><div><div><h4 class="title">2.4.5.3. Target namespace selection</h4></div></div></div><p>
						You can explicitly name the target namespace for an Operator group using the <code class="literal">spec.targetNamespaces</code> parameter:
					</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: my-group
  namespace: my-namespace
spec:
  targetNamespaces:
  - my-namespace</pre><p>
						You can alternatively specify a namespace using a label selector with the <code class="literal">spec.selector</code> parameter:
					</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: my-group
  namespace: my-namespace
spec:
  selector:
    cool.io/prod: "true"</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Listing multiple namespaces via <code class="literal">spec.targetNamespaces</code> or use of a label selector via <code class="literal">spec.selector</code> is not recommended, as the support for more than one target namespace in an Operator group will likely be removed in a future release.
						</p></div></div><p>
						If both <code class="literal">spec.targetNamespaces</code> and <code class="literal">spec.selector</code> are defined, <code class="literal">spec.selector</code> is ignored. Alternatively, you can omit both <code class="literal">spec.selector</code> and <code class="literal">spec.targetNamespaces</code> to specify a <span class="emphasis"><em>global</em></span> Operator group, which selects all namespaces:
					</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: my-group
  namespace: my-namespace</pre><p>
						The resolved set of selected namespaces is shown in the <code class="literal">status.namespaces</code> parameter of an Opeator group. The <code class="literal">status.namespace</code> of a global Operator group contains the empty string (<code class="literal">""</code>), which signals to a consuming Operator that it should watch all namespaces.
					</p></section><section class="section" id="olm-operatorgroups-csv-annotations_olm-understanding-operatorgroups"><div class="titlepage"><div><div><h4 class="title">2.4.5.4. Operator group CSV annotations</h4></div></div></div><p>
						Member CSVs of an Operator group have the following annotations:
					</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139732005234048" scope="col">Annotation</th><th align="left" valign="top" id="idm139732005232960" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139732005234048"> <p>
										<code class="literal">olm.operatorGroup=&lt;group_name&gt;</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732005232960"> <p>
										Contains the name of the Operator group.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139732005234048"> <p>
										<code class="literal">olm.operatorNamespace=&lt;group_namespace&gt;</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732005232960"> <p>
										Contains the namespace of the Operator group.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139732005234048"> <p>
										<code class="literal">olm.targetNamespaces=&lt;target_namespaces&gt;</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732005232960"> <p>
										Contains a comma-delimited string that lists the target namespace selection of the Operator group.
									</p>
									 </td></tr></tbody></table></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							All annotations except <code class="literal">olm.targetNamespaces</code> are included with copied CSVs. Omitting the <code class="literal">olm.targetNamespaces</code> annotation on copied CSVs prevents the duplication of target namespaces between tenants.
						</p></div></div></section><section class="section" id="olm-operatorgroups-provided-apis-annotation_olm-understanding-operatorgroups"><div class="titlepage"><div><div><h4 class="title">2.4.5.5. Provided APIs annotation</h4></div></div></div><p>
						A <span class="emphasis"><em>group/version/kind (GVK)</em></span> is a unique identifier for a Kubernetes API. Information about what GVKs are provided by an Operator group are shown in an <code class="literal">olm.providedAPIs</code> annotation. The value of the annotation is a string consisting of <code class="literal">&lt;kind&gt;.&lt;version&gt;.&lt;group&gt;</code> delimited with commas. The GVKs of CRDs and API services provided by all active member CSVs of an Operator group are included.
					</p><p>
						Review the following example of an <code class="literal">OperatorGroup</code> object with a single active member CSV that provides the <code class="literal">PackageManifest</code> resource:
					</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  annotations:
    olm.providedAPIs: PackageManifest.v1alpha1.packages.apps.redhat.com
  name: olm-operators
  namespace: local
  ...
spec:
  selector: {}
  serviceAccount:
    metadata:
      creationTimestamp: null
  targetNamespaces:
  - local
status:
  lastUpdated: 2019-02-19T16:18:28Z
  namespaces:
  - local</pre></section><section class="section" id="olm-operatorgroups-rbac_olm-understanding-operatorgroups"><div class="titlepage"><div><div><h4 class="title">2.4.5.6. Role-based access control</h4></div></div></div><p>
						When an Operator group is created, three cluster roles are generated. Each contains a single aggregation rule with a cluster role selector set to match a label, as shown below:
					</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139732006937792" scope="col">Cluster role</th><th align="left" valign="top" id="idm139732006936704" scope="col">Label to match</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139732006937792"> <p>
										<code class="literal">&lt;operatorgroup_name&gt;-admin</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732006936704"> <p>
										<code class="literal">olm.opgroup.permissions/aggregate-to-admin: &lt;operatorgroup_name&gt;</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139732006937792"> <p>
										<code class="literal">&lt;operatorgroup_name&gt;-edit</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732006936704"> <p>
										<code class="literal">olm.opgroup.permissions/aggregate-to-edit: &lt;operatorgroup_name&gt;</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139732006937792"> <p>
										<code class="literal">&lt;operatorgroup_name&gt;-view</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732006936704"> <p>
										<code class="literal">olm.opgroup.permissions/aggregate-to-view: &lt;operatorgroup_name&gt;</code>
									</p>
									 </td></tr></tbody></table></div><p>
						The following RBAC resources are generated when a CSV becomes an active member of an Operator group, as long as the CSV is watching all namespaces with the <code class="literal">AllNamespaces</code> install mode and is not in a failed state with reason <code class="literal">InterOperatorGroupOwnerConflict</code>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Cluster roles for each API resource from a CRD
							</li><li class="listitem">
								Cluster roles for each API resource from an API service
							</li><li class="listitem">
								Additional roles and role bindings
							</li></ul></div><div class="table" id="olm-resources-per-api-resource-crd_olm-understanding-operatorgroups"><p class="title"><strong>Table 2.5. Cluster roles generated for each API resource from a CRD</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139732007548160" scope="col">Cluster role</th><th align="left" valign="top" id="idm139732007547072" scope="col">Settings</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139732007548160"> <p>
										<code class="literal">&lt;kind&gt;.&lt;group&gt;-&lt;version&gt;-admin</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732007547072"> <p>
										Verbs on <code class="literal">&lt;kind&gt;</code>:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">*</code>
											</li></ul></div>
									 <p>
										Aggregation labels:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">rbac.authorization.k8s.io/aggregate-to-admin: true</code>
											</li><li class="listitem">
												<code class="literal">olm.opgroup.permissions/aggregate-to-admin: &lt;operatorgroup_name&gt;</code>
											</li></ul></div>
									 </td></tr><tr><td align="left" valign="top" headers="idm139732007548160"> <p>
										<code class="literal">&lt;kind&gt;.&lt;group&gt;-&lt;version&gt;-edit</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732007547072"> <p>
										Verbs on <code class="literal">&lt;kind&gt;</code>:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">create</code>
											</li><li class="listitem">
												<code class="literal">update</code>
											</li><li class="listitem">
												<code class="literal">patch</code>
											</li><li class="listitem">
												<code class="literal">delete</code>
											</li></ul></div>
									 <p>
										Aggregation labels:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">rbac.authorization.k8s.io/aggregate-to-edit: true</code>
											</li><li class="listitem">
												<code class="literal">olm.opgroup.permissions/aggregate-to-edit: &lt;operatorgroup_name&gt;</code>
											</li></ul></div>
									 </td></tr><tr><td align="left" valign="top" headers="idm139732007548160"> <p>
										<code class="literal">&lt;kind&gt;.&lt;group&gt;-&lt;version&gt;-view</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732007547072"> <p>
										Verbs on <code class="literal">&lt;kind&gt;</code>:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">get</code>
											</li><li class="listitem">
												<code class="literal">list</code>
											</li><li class="listitem">
												<code class="literal">watch</code>
											</li></ul></div>
									 <p>
										Aggregation labels:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">rbac.authorization.k8s.io/aggregate-to-view: true</code>
											</li><li class="listitem">
												<code class="literal">olm.opgroup.permissions/aggregate-to-view: &lt;operatorgroup_name&gt;</code>
											</li></ul></div>
									 </td></tr><tr><td align="left" valign="top" headers="idm139732007548160"> <p>
										<code class="literal">&lt;kind&gt;.&lt;group&gt;-&lt;version&gt;-view-crdview</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732007547072"> <p>
										Verbs on <code class="literal">apiextensions.k8s.io</code> <code class="literal">customresourcedefinitions</code> <code class="literal">&lt;crd-name&gt;</code>:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">get</code>
											</li></ul></div>
									 <p>
										Aggregation labels:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">rbac.authorization.k8s.io/aggregate-to-view: true</code>
											</li><li class="listitem">
												<code class="literal">olm.opgroup.permissions/aggregate-to-view: &lt;operatorgroup_name&gt;</code>
											</li></ul></div>
									 </td></tr></tbody></table></div></div><div class="table" id="olm-resources-per-api-resource-api_olm-understanding-operatorgroups"><p class="title"><strong>Table 2.6. Cluster roles generated for each API resource from an API service</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139732002397120" scope="col">Cluster role</th><th align="left" valign="top" id="idm139732002396032" scope="col">Settings</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139732002397120"> <p>
										<code class="literal">&lt;kind&gt;.&lt;group&gt;-&lt;version&gt;-admin</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732002396032"> <p>
										Verbs on <code class="literal">&lt;kind&gt;</code>:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">*</code>
											</li></ul></div>
									 <p>
										Aggregation labels:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">rbac.authorization.k8s.io/aggregate-to-admin: true</code>
											</li><li class="listitem">
												<code class="literal">olm.opgroup.permissions/aggregate-to-admin: &lt;operatorgroup_name&gt;</code>
											</li></ul></div>
									 </td></tr><tr><td align="left" valign="top" headers="idm139732002397120"> <p>
										<code class="literal">&lt;kind&gt;.&lt;group&gt;-&lt;version&gt;-edit</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732002396032"> <p>
										Verbs on <code class="literal">&lt;kind&gt;</code>:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">create</code>
											</li><li class="listitem">
												<code class="literal">update</code>
											</li><li class="listitem">
												<code class="literal">patch</code>
											</li><li class="listitem">
												<code class="literal">delete</code>
											</li></ul></div>
									 <p>
										Aggregation labels:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">rbac.authorization.k8s.io/aggregate-to-edit: true</code>
											</li><li class="listitem">
												<code class="literal">olm.opgroup.permissions/aggregate-to-edit: &lt;operatorgroup_name&gt;</code>
											</li></ul></div>
									 </td></tr><tr><td align="left" valign="top" headers="idm139732002397120"> <p>
										<code class="literal">&lt;kind&gt;.&lt;group&gt;-&lt;version&gt;-view</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732002396032"> <p>
										Verbs on <code class="literal">&lt;kind&gt;</code>:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">get</code>
											</li><li class="listitem">
												<code class="literal">list</code>
											</li><li class="listitem">
												<code class="literal">watch</code>
											</li></ul></div>
									 <p>
										Aggregation labels:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">rbac.authorization.k8s.io/aggregate-to-view: true</code>
											</li><li class="listitem">
												<code class="literal">olm.opgroup.permissions/aggregate-to-view: &lt;operatorgroup_name&gt;</code>
											</li></ul></div>
									 </td></tr></tbody></table></div></div><div class="itemizedlist" id="olm-resources-additional-roles-rolebindings_olm-understanding-operatorgroups"><p class="title"><strong>Additional roles and role bindings</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								If the CSV defines exactly one target namespace that contains <code class="literal">*</code>, then a cluster role and corresponding cluster role binding are generated for each permission defined in the <code class="literal">permissions</code> field of the CSV. All resources generated are given the <code class="literal">olm.owner: &lt;csv_name&gt;</code> and <code class="literal">olm.owner.namespace: &lt;csv_namespace&gt;</code> labels.
							</li><li class="listitem">
								If the CSV does <span class="emphasis"><em>not</em></span> define exactly one target namespace that contains <code class="literal">*</code>, then all roles and role bindings in the Operator namespace with the <code class="literal">olm.owner: &lt;csv_name&gt;</code> and <code class="literal">olm.owner.namespace: &lt;csv_namespace&gt;</code> labels are copied into the target namespace.
							</li></ul></div></section><section class="section" id="olm-operatorgroups-copied-csvs_olm-understanding-operatorgroups"><div class="titlepage"><div><div><h4 class="title">2.4.5.7. Copied CSVs</h4></div></div></div><p>
						OLM creates copies of all active member CSVs of an Operator group in each of the target namespaces of that Operator group. The purpose of a copied CSV is to tell users of a target namespace that a specific Operator is configured to watch resources created there.
					</p><p>
						Copied CSVs have a status reason <code class="literal">Copied</code> and are updated to match the status of their source CSV. The <code class="literal">olm.targetNamespaces</code> annotation is stripped from copied CSVs before they are created on the cluster. Omitting the target namespace selection avoids the duplication of target namespaces between tenants.
					</p><p>
						Copied CSVs are deleted when their source CSV no longer exists or the Operator group that their source CSV belongs to no longer targets the namespace of the copied CSV.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							By default, the <code class="literal">disableCopiedCSVs</code> field is disabled. After enabling a <code class="literal">disableCopiedCSVs</code> field, the OLM deletes existing copied CSVs on a cluster. When a <code class="literal">disableCopiedCSVs</code> field is disabled, the OLM adds copied CSVs again.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Disable the <code class="literal">disableCopiedCSVs</code> field:
								</p><pre class="programlisting language-yaml">$ cat &lt;&lt; EOF | oc apply -f -
apiVersion: operators.coreos.com/v1
kind: OLMConfig
metadata:
  name: cluster
spec:
  features:
    disableCopiedCSVs: false
EOF</pre></li><li class="listitem"><p class="simpara">
									Enable the <code class="literal">disableCopiedCSVs</code> field:
								</p><pre class="programlisting language-yaml">$ cat &lt;&lt; EOF | oc apply -f -
apiVersion: operators.coreos.com/v1
kind: OLMConfig
metadata:
  name: cluster
spec:
  features:
    disableCopiedCSVs: true
EOF</pre></li></ul></div></div></div></section><section class="section" id="olm-operatorgroups-static_olm-understanding-operatorgroups"><div class="titlepage"><div><div><h4 class="title">2.4.5.8. Static Operator groups</h4></div></div></div><p>
						An Operator group is <span class="emphasis"><em>static</em></span> if its <code class="literal">spec.staticProvidedAPIs</code> field is set to <code class="literal">true</code>. As a result, OLM does not modify the <code class="literal">olm.providedAPIs</code> annotation of an Operator group, which means that it can be set in advance. This is useful when a user wants to use an Operator group to prevent resource contention in a set of namespaces but does not have active member CSVs that provide the APIs for those resources.
					</p><p>
						Below is an example of an Operator group that protects <code class="literal">Prometheus</code> resources in all namespaces with the <code class="literal">something.cool.io/cluster-monitoring: "true"</code> annotation:
					</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: cluster-monitoring
  namespace: cluster-monitoring
  annotations:
    olm.providedAPIs: Alertmanager.v1.monitoring.coreos.com,Prometheus.v1.monitoring.coreos.com,PrometheusRule.v1.monitoring.coreos.com,ServiceMonitor.v1.monitoring.coreos.com
spec:
  staticProvidedAPIs: true
  selector:
    matchLabels:
      something.cool.io/cluster-monitoring: "true"</pre></section><section class="section" id="olm-operatorgroups-intersection_olm-understanding-operatorgroups"><div class="titlepage"><div><div><h4 class="title">2.4.5.9. Operator group intersection</h4></div></div></div><p>
						Two Operator groups are said to have <span class="emphasis"><em>intersecting provided APIs</em></span> if the intersection of their target namespace sets is not an empty set and the intersection of their provided API sets, defined by <code class="literal">olm.providedAPIs</code> annotations, is not an empty set.
					</p><p>
						A potential issue is that Operator groups with intersecting provided APIs can compete for the same resources in the set of intersecting namespaces.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When checking intersection rules, an Operator group namespace is always included as part of its selected target namespaces.
						</p></div></div><h5 id="olm-operatorgroups-intersection-rules_olm-understanding-operatorgroups">Rules for intersection</h5><p>
						Each time an active member CSV synchronizes, OLM queries the cluster for the set of intersecting provided APIs between the Operator group of the CSV and all others. OLM then checks if that set is an empty set:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								If <code class="literal">true</code> and the CSV’s provided APIs are a subset of the Operator group’s:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Continue transitioning.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								If <code class="literal">true</code> and the CSV’s provided APIs are <span class="emphasis"><em>not</em></span> a subset of the Operator group’s:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
										If the Operator group is static:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
												Clean up any deployments that belong to the CSV.
											</li><li class="listitem">
												Transition the CSV to a failed state with status reason <code class="literal">CannotModifyStaticOperatorGroupProvidedAPIs</code>.
											</li></ul></div></li><li class="listitem"><p class="simpara">
										If the Operator group is <span class="emphasis"><em>not</em></span> static:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
												Replace the Operator group’s <code class="literal">olm.providedAPIs</code> annotation with the union of itself and the CSV’s provided APIs.
											</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
								If <code class="literal">false</code> and the CSV’s provided APIs are <span class="emphasis"><em>not</em></span> a subset of the Operator group’s:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Clean up any deployments that belong to the CSV.
									</li><li class="listitem">
										Transition the CSV to a failed state with status reason <code class="literal">InterOperatorGroupOwnerConflict</code>.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								If <code class="literal">false</code> and the CSV’s provided APIs are a subset of the Operator group’s:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
										If the Operator group is static:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
												Clean up any deployments that belong to the CSV.
											</li><li class="listitem">
												Transition the CSV to a failed state with status reason <code class="literal">CannotModifyStaticOperatorGroupProvidedAPIs</code>.
											</li></ul></div></li><li class="listitem"><p class="simpara">
										If the Operator group is <span class="emphasis"><em>not</em></span> static:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
												Replace the Operator group’s <code class="literal">olm.providedAPIs</code> annotation with the difference between itself and the CSV’s provided APIs.
											</li></ul></div></li></ul></div></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Failure states caused by Operator groups are non-terminal.
						</p></div></div><p>
						The following actions are performed each time an Operator group synchronizes:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The set of provided APIs from active member CSVs is calculated from the cluster. Note that copied CSVs are ignored.
							</li><li class="listitem">
								The cluster set is compared to <code class="literal">olm.providedAPIs</code>, and if <code class="literal">olm.providedAPIs</code> contains any extra APIs, then those APIs are pruned.
							</li><li class="listitem">
								All CSVs that provide the same APIs across all namespaces are requeued. This notifies conflicting CSVs in intersecting groups that their conflict has possibly been resolved, either through resizing or through deletion of the conflicting CSV.
							</li></ul></div></section><section class="section" id="olm-operatorgroups-limitations"><div class="titlepage"><div><div><h4 class="title">2.4.5.10. Limitations for multitenant Operator management</h4></div></div></div><p>
						OpenShift Container Platform provides limited support for simultaneously installing different versions of an Operator on the same cluster. Operator Lifecycle Manager (OLM) installs Operators multiple times in different namespaces. One constraint of this is that the Operator’s API versions must be the same.
					</p><p>
						Operators are control plane extensions due to their usage of <code class="literal">CustomResourceDefinition</code> objects (CRDs), which are global resources in Kubernetes. Different major versions of an Operator often have incompatible CRDs. This makes them incompatible to install simultaneously in different namespaces on a cluster.
					</p><p>
						All tenants, or namespaces, share the same control plane of a cluster. Therefore, tenants in a multitenant cluster also share global CRDs, which limits the scenarios in which different instances of the same Operator can be used in parallel on the same cluster.
					</p><p>
						The supported scenarios include the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Operators of different versions that ship the exact same CRD definition (in case of versioned CRDs, the exact same set of versions)
							</li><li class="listitem">
								Operators of different versions that do not ship a CRD, and instead have their CRD available in a separate bundle on the OperatorHub
							</li></ul></div><p>
						All other scenarios are not supported, because the integrity of the cluster data cannot be guaranteed if there are multiple competing or overlapping CRDs from different Operator versions to be reconciled on the same cluster.
					</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-colocation">Operator Lifecycle Manager (OLM) → Multitenancy and Operator colocation</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-multitenancy">Operators in multitenant clusters</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-creating-policy">Allowing non-cluster administrators to install Operators</a>
							</li></ul></div></section><section class="section" id="olm-operatorgroups-troubleshooting_olm-understanding-operatorgroups"><div class="titlepage"><div><div><h4 class="title">2.4.5.11. Troubleshooting Operator groups</h4></div></div></div><h5 id="olm-operatorgroups-troubleshooting-membership_olm-understanding-operatorgroups">Membership</h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								An install plan’s namespace must contain only one Operator group. When attempting to generate a cluster service version (CSV) in a namespace, an install plan considers an Operator group invalid in the following scenarios:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										No Operator groups exist in the install plan’s namespace.
									</li><li class="listitem">
										Multiple Operator groups exist in the install plan’s namespace.
									</li><li class="listitem">
										An incorrect or non-existent service account name is specified in the Operator group.
									</li></ul></div><p class="simpara">
								If an install plan encounters an invalid Operator group, the CSV is not generated and the <code class="literal">InstallPlan</code> resource continues to install with a relevant message. For example, the following message is provided if more than one Operator group exists in the same namespace:
							</p><pre class="programlisting language-terminal">attenuated service account query failed - more than one operator group(s) are managing this namespace count=2</pre><p class="simpara">
								where <code class="literal">count=</code> specifies the number of Operator groups in the namespace.
							</p></li><li class="listitem">
								If the install modes of a CSV do not support the target namespace selection of the Operator group in its namespace, the CSV transitions to a failure state with the reason <code class="literal">UnsupportedOperatorGroup</code>. CSVs in a failed state for this reason transition to pending after either the target namespace selection of the Operator group changes to a supported configuration, or the install modes of the CSV are modified to support the target namespace selection.
							</li></ul></div></section></section><section class="section" id="olm-colocation"><div class="titlepage"><div><div><h3 class="title">2.4.6. Multitenancy and Operator colocation</h3></div></div></div><p>
					This guide outlines multitenancy and Operator colocation in Operator Lifecycle Manager (OLM).
				</p><section class="section" id="olm-colocation-namespaces_olm-colocation"><div class="titlepage"><div><div><h4 class="title">2.4.6.1. Colocation of Operators in a namespace</h4></div></div></div><p>
						Operator Lifecycle Manager (OLM) handles OLM-managed Operators that are installed in the same namespace, meaning their <code class="literal">Subscription</code> resources are colocated in the same namespace, as related Operators. Even if they are not actually related, OLM considers their states, such as their version and update policy, when any one of them is updated.
					</p><p>
						This default behavior manifests in two ways:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">InstallPlan</code> resources of pending updates include <code class="literal">ClusterServiceVersion</code> (CSV) resources of all other Operators that are in the same namespace.
							</li><li class="listitem">
								All Operators in the same namespace share the same update policy. For example, if one Operator is set to manual updates, all other Operators' update policies are also set to manual.
							</li></ul></div><p>
						These scenarios can lead to the following issues:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								It becomes hard to reason about install plans for Operator updates, because there are many more resources defined in them than just the updated Operator.
							</li><li class="listitem">
								It becomes impossible to have some Operators in a namespace update automatically while other are updated manually, which is a common desire for cluster administrators.
							</li></ul></div><p>
						These issues usually surface because, when installing Operators with the OpenShift Container Platform web console, the default behavior installs Operators that support the <span class="strong strong"><strong>All namespaces</strong></span> install mode into the default <code class="literal">openshift-operators</code> global namespace.
					</p><p>
						As a cluster administrator, you can bypass this default behavior manually by using the following workflow:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Create a namespace for the installation of the Operator.
							</li><li class="listitem">
								Create a custom <span class="emphasis"><em>global Operator group</em></span>, which is an Operator group that watches all namespaces. By associating this Operator group with the namespace you just created, it makes the installation namespace a global namespace, which makes Operators installed there available in all namespaces.
							</li><li class="listitem">
								Install the desired Operator in the installation namespace.
							</li></ol></div><p>
						If the Operator has dependencies, the dependencies are automatically installed in the pre-created namespace. As a result, it is then valid for the dependency Operators to have the same update policy and shared install plans. For a detailed procedure, see "Installing global Operators in custom namespaces".
					</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-installing-global-namespaces_olm-adding-operators-to-a-cluster">Installing global Operators in custom namespaces</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-multitenancy">Operators in multitenant clusters</a>
							</li></ul></div></section></section><section class="section" id="olm-operatorconditions"><div class="titlepage"><div><div><h3 class="title">2.4.7. Operator conditions</h3></div></div></div><p>
					This guide outlines how Operator Lifecycle Manager (OLM) uses Operator conditions.
				</p><section class="section" id="olm-about-operatorconditions_olm-operatorconditions"><div class="titlepage"><div><div><h4 class="title">2.4.7.1. About Operator conditions</h4></div></div></div><p>
						As part of its role in managing the lifecycle of an Operator, Operator Lifecycle Manager (OLM) infers the state of an Operator from the state of Kubernetes resources that define the Operator. While this approach provides some level of assurance that an Operator is in a given state, there are many instances where an Operator might need to communicate information to OLM that could not be inferred otherwise. This information can then be used by OLM to better manage the lifecycle of the Operator.
					</p><p>
						OLM provides a custom resource definition (CRD) called <code class="literal">OperatorCondition</code> that allows Operators to communicate conditions to OLM. There are a set of supported conditions that influence management of the Operator by OLM when present in the <code class="literal">Spec.Conditions</code> array of an <code class="literal">OperatorCondition</code> resource.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							By default, the <code class="literal">Spec.Conditions</code> array is not present in an <code class="literal">OperatorCondition</code> object until it is either added by a user or as a result of custom Operator logic.
						</p></div></div></section><section class="section" id="olm-supported-operatorconditions_olm-operatorconditions"><div class="titlepage"><div><div><h4 class="title">2.4.7.2. Supported conditions</h4></div></div></div><p>
						Operator Lifecycle Manager (OLM) supports the following Operator conditions.
					</p><section class="section" id="olm-upgradeable-operatorcondition_olm-operatorconditions"><div class="titlepage"><div><div><h5 class="title">2.4.7.2.1. Upgradeable condition</h5></div></div></div><p>
							The <code class="literal">Upgradeable</code> Operator condition prevents an existing cluster service version (CSV) from being replaced by a newer version of the CSV. This condition is useful when:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									An Operator is about to start a critical process and should not be upgraded until the process is completed.
								</li><li class="listitem">
									An Operator is performing a migration of custom resources (CRs) that must be completed before the Operator is ready to be upgraded.
								</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								Setting the <code class="literal">Upgradeable</code> Operator condition to the <code class="literal">False</code> value does not avoid pod disruption. If you must ensure your pods are not disrupted, see "Using pod disruption budgets to specify the number of pods that must be up" and "Graceful termination" in the "Additional resources" section.
							</p></div></div><div class="formalpara"><p class="title"><strong>Example <code class="literal">Upgradeable</code> Operator condition</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorCondition
metadata:
  name: my-operator
  namespace: operators
spec:
  conditions:
  - type: Upgradeable <span id="CO4-1"><!--Empty--></span><span class="callout">1</span>
    status: "False" <span id="CO4-2"><!--Empty--></span><span class="callout">2</span>
    reason: "migration"
    message: "The Operator is performing a migration."
    lastTransitionTime: "2020-08-24T23:15:55Z"</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO4-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Name of the condition.
								</div></dd><dt><a href="#CO4-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									A <code class="literal">False</code> value indicates the Operator is not ready to be upgraded. OLM prevents a CSV that replaces the existing CSV of the Operator from leaving the <code class="literal">Pending</code> phase. A <code class="literal">False</code> value does not block cluster upgrades.
								</div></dd></dl></div></section></section><section class="section _additional-resources" id="olm-operatorconditions-addtl-resources"><div class="titlepage"><div><div><h4 class="title">2.4.7.3. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-operatorconditions">Managing Operator conditions</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-operatorconditions_osdk-generating-csvs">Enabling Operator conditions</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-pods-configuring-pod-distruption-about_nodes-pods-configuring">Using pod disruption budgets to specify the number of pods that must be up</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/building_applications/#deployments-graceful-termination_route-based-deployment-strategies">Graceful termination</a>
							</li></ul></div></section></section><section class="section" id="olm-understanding-metrics"><div class="titlepage"><div><div><h3 class="title">2.4.8. Operator Lifecycle Manager metrics</h3></div></div></div><section class="section" id="olm-metrics_olm-understanding-metrics"><div class="titlepage"><div><div><h4 class="title">2.4.8.1. Exposed metrics</h4></div></div></div><p>
						Operator Lifecycle Manager (OLM) exposes certain OLM-specific resources for use by the Prometheus-based OpenShift Container Platform cluster monitoring stack.
					</p><div class="table" id="idm139731996518624"><p class="title"><strong>Table 2.7. Metrics exposed by OLM</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 80%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731996513792" scope="col">Name</th><th align="left" valign="top" id="idm139732006977328" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731996513792"> <p>
										<code class="literal">catalog_source_count</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732006977328"> <p>
										Number of catalog sources.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731996513792"> <p>
										<code class="literal">catalogsource_ready</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732006977328"> <p>
										State of a catalog source. The value <code class="literal">1</code> indicates that the catalog source is in a <code class="literal">READY</code> state. The value of <code class="literal">0</code> indicates that the catalog source is not in a <code class="literal">READY</code> state.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731996513792"> <p>
										<code class="literal">csv_abnormal</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732006977328"> <p>
										When reconciling a cluster service version (CSV), present whenever a CSV version is in any state other than <code class="literal">Succeeded</code>, for example when it is not installed. Includes the <code class="literal">name</code>, <code class="literal">namespace</code>, <code class="literal">phase</code>, <code class="literal">reason</code>, and <code class="literal">version</code> labels. A Prometheus alert is created when this metric is present.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731996513792"> <p>
										<code class="literal">csv_count</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732006977328"> <p>
										Number of CSVs successfully registered.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731996513792"> <p>
										<code class="literal">csv_succeeded</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732006977328"> <p>
										When reconciling a CSV, represents whether a CSV version is in a <code class="literal">Succeeded</code> state (value <code class="literal">1</code>) or not (value <code class="literal">0</code>). Includes the <code class="literal">name</code>, <code class="literal">namespace</code>, and <code class="literal">version</code> labels.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731996513792"> <p>
										<code class="literal">csv_upgrade_count</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732006977328"> <p>
										Monotonic count of CSV upgrades.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731996513792"> <p>
										<code class="literal">install_plan_count</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732006977328"> <p>
										Number of install plans.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731996513792"> <p>
										<code class="literal">installplan_warnings_total</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732006977328"> <p>
										Monotonic count of warnings generated by resources, such as deprecated resources, included in an install plan.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731996513792"> <p>
										<code class="literal">olm_resolution_duration_seconds</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732006977328"> <p>
										The duration of a dependency resolution attempt.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731996513792"> <p>
										<code class="literal">subscription_count</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732006977328"> <p>
										Number of subscriptions.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731996513792"> <p>
										<code class="literal">subscription_sync_total</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139732006977328"> <p>
										Monotonic count of subscription syncs. Includes the <code class="literal">channel</code>, <code class="literal">installed</code> CSV, and subscription <code class="literal">name</code> labels.
									</p>
									 </td></tr></tbody></table></div></div></section></section><section class="section" id="olm-webhooks"><div class="titlepage"><div><div><h3 class="title">2.4.9. Webhook management in Operator Lifecycle Manager</h3></div></div></div><p>
					Webhooks allow Operator authors to intercept, modify, and accept or reject resources before they are saved to the object store and handled by the Operator controller. Operator Lifecycle Manager (OLM) can manage the lifecycle of these webhooks when they are shipped alongside your Operator.
				</p><p>
					See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-defining-csv-webhook_osdk-generating-csvs">Defining cluster service versions (CSVs)</a> for details on how an Operator developer can define webhooks for their Operator, as well as considerations when running on OLM.
				</p><section class="section _additional-resources" id="olm-webhooks-additional-resources"><div class="titlepage"><div><div><h4 class="title">2.4.9.1. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/architecture/#admission-webhook-types_admission-plug-ins">Types of webhook admission plugins</a>
							</li><li class="listitem"><p class="simpara">
								Kubernetes documentation:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<a class="link" href="https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#validatingadmissionwebhook">Validating admission webhooks</a>
									</li><li class="listitem">
										<a class="link" href="https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#mutatingadmissionwebhook">Mutating admission webhooks</a>
									</li><li class="listitem">
										<a class="link" href="https://kubernetes.io/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definition-versioning/#webhook-conversion">Conversion webhooks</a>
									</li></ul></div></li></ul></div></section></section></section><section class="section" id="olm-understanding-operatorhub"><div class="titlepage"><div><div><h2 class="title">2.5. Understanding OperatorHub</h2></div></div></div><section class="section" id="olm-operatorhub-overview_olm-understanding-operatorhub"><div class="titlepage"><div><div><h3 class="title">2.5.1. About OperatorHub</h3></div></div></div><p>
					<span class="emphasis"><em>OperatorHub</em></span> is the web console interface in OpenShift Container Platform that cluster administrators use to discover and install Operators. With one click, an Operator can be pulled from its off-cluster source, installed and subscribed on the cluster, and made ready for engineering teams to self-service manage the product across deployment environments using Operator Lifecycle Manager (OLM).
				</p><p>
					Cluster administrators can choose from catalogs grouped into the following categories:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 80%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731995744032" scope="col">Category</th><th align="left" valign="top" id="idm139731995742944" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731995744032"> <p>
									Red Hat Operators
								</p>
								 </td><td align="left" valign="top" headers="idm139731995742944"> <p>
									Red Hat products packaged and shipped by Red Hat. Supported by Red Hat.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731995744032"> <p>
									Certified Operators
								</p>
								 </td><td align="left" valign="top" headers="idm139731995742944"> <p>
									Products from leading independent software vendors (ISVs). Red Hat partners with ISVs to package and ship. Supported by the ISV.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731995744032"> <p>
									Red Hat Marketplace
								</p>
								 </td><td align="left" valign="top" headers="idm139731995742944"> <p>
									Certified software that can be purchased from <a class="link" href="https://marketplace.redhat.com/">Red Hat Marketplace</a>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731995744032"> <p>
									Community Operators
								</p>
								 </td><td align="left" valign="top" headers="idm139731995742944"> <p>
									Optionally-visible software maintained by relevant representatives in the <a class="link" href="https://github.com/redhat-openshift-ecosystem/community-operators-prod/tree/main/operators">redhat-openshift-ecosystem/community-operators-prod/operators</a> GitHub repository. No official support.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731995744032"> <p>
									Custom Operators
								</p>
								 </td><td align="left" valign="top" headers="idm139731995742944"> <p>
									Operators you add to the cluster yourself. If you have not added any custom Operators, the <span class="strong strong"><strong>Custom</strong></span> category does not appear in the web console on your OperatorHub.
								</p>
								 </td></tr></tbody></table></div><p>
					Operators on OperatorHub are packaged to run on OLM. This includes a YAML file called a cluster service version (CSV) containing all of the CRDs, RBAC rules, deployments, and container images required to install and securely run the Operator. It also contains user-visible information like a description of its features and supported Kubernetes versions.
				</p><p>
					The Operator SDK can be used to assist developers packaging their Operators for use on OLM and OperatorHub. If you have a commercial application that you want to make accessible to your customers, get it included using the certification workflow provided on the Red Hat Partner Connect portal at <a class="link" href="https://connect.redhat.com">connect.redhat.com</a>.
				</p></section><section class="section" id="olm-operatorhub-arch_olm-understanding-operatorhub"><div class="titlepage"><div><div><h3 class="title">2.5.2. OperatorHub architecture</h3></div></div></div><p>
					The OperatorHub UI component is driven by the Marketplace Operator by default on OpenShift Container Platform in the <code class="literal">openshift-marketplace</code> namespace.
				</p><section class="section" id="olm-operatorhub-arch-operatorhub_crd_olm-understanding-operatorhub"><div class="titlepage"><div><div><h4 class="title">2.5.2.1. OperatorHub custom resource</h4></div></div></div><p>
						The Marketplace Operator manages an <code class="literal">OperatorHub</code> custom resource (CR) named <code class="literal">cluster</code> that manages the default <code class="literal">CatalogSource</code> objects provided with OperatorHub. You can modify this resource to enable or disable the default catalogs, which is useful when configuring OpenShift Container Platform in restricted network environments.
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">OperatorHub</code> custom resource</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1
kind: OperatorHub
metadata:
  name: cluster
spec:
  disableAllDefaultSources: true <span id="CO5-1"><!--Empty--></span><span class="callout">1</span>
  sources: [ <span id="CO5-2"><!--Empty--></span><span class="callout">2</span>
    {
      name: "community-operators",
      disabled: false
    }
  ]</pre>

						</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO5-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								<code class="literal">disableAllDefaultSources</code> is an override that controls availability of all default catalogs that are configured by default during an OpenShift Container Platform installation.
							</div></dd><dt><a href="#CO5-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Disable default catalogs individually by changing the <code class="literal">disabled</code> parameter value per source.
							</div></dd></dl></div></section></section><section class="section _additional-resources" id="olm-understanding-operatorhub-resources"><div class="titlepage"><div><div><h3 class="title">2.5.3. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-catalogsource_olm-understanding-olm">Catalog source</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-about">About the Operator SDK</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-generating-csvs">Defining cluster service versions (CSVs)</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-upgrades_olm-workflow">Operator installation and upgrade workflow in OLM</a>
						</li><li class="listitem">
							<a class="link" href="https://connect.redhat.com">Red Hat Partner Connect</a>
						</li><li class="listitem">
							<a class="link" href="https://marketplace.redhat.com">Red Hat Marketplace</a>
						</li></ul></div></section></section><section class="section" id="olm-rh-catalogs"><div class="titlepage"><div><div><h2 class="title">2.6. Red Hat-provided Operator catalogs</h2></div></div></div><p>
				Red Hat provides several Operator catalogs that are included with OpenShift Container Platform by default.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					As of OpenShift Container Platform 4.11, the default Red Hat-provided Operator catalog releases in the file-based catalog format. The default Red Hat-provided Operator catalogs for OpenShift Container Platform 4.6 through 4.10 released in the deprecated SQLite database format.
				</p><p>
					The <code class="literal">opm</code> subcommands, flags, and functionality related to the SQLite database format are also deprecated and will be removed in a future release. The features are still supported and must be used for catalogs that use the deprecated SQLite database format.
				</p><p>
					Many of the <code class="literal">opm</code> subcommands and flags for working with the SQLite database format, such as <code class="literal">opm index prune</code>, do not work with the file-based catalog format. For more information about working with file-based catalogs, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-managing-custom-catalogs">Managing custom catalogs</a>, <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-file-based-catalogs_olm-packaging-format">Operator Framework packaging format</a>, and <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-mirroring-disconnected">Mirroring images for a disconnected installation using the oc-mirror plugin</a>.
				</p></div></div><section class="section" id="olm-about-catalogs_olm-rh-catalogs"><div class="titlepage"><div><div><h3 class="title">2.6.1. About Operator catalogs</h3></div></div></div><p>
					An Operator catalog is a repository of metadata that Operator Lifecycle Manager (OLM) can query to discover and install Operators and their dependencies on a cluster. OLM always installs Operators from the latest version of a catalog.
				</p><p>
					An index image, based on the Operator bundle format, is a containerized snapshot of a catalog. It is an immutable artifact that contains the database of pointers to a set of Operator manifest content. A catalog can reference an index image to source its content for OLM on the cluster.
				</p><p>
					As catalogs are updated, the latest versions of Operators change, and older versions may be removed or altered. In addition, when OLM runs on an OpenShift Container Platform cluster in a restricted network environment, it is unable to access the catalogs directly from the internet to pull the latest content.
				</p><p>
					As a cluster administrator, you can create your own custom index image, either based on a Red Hat-provided catalog or from scratch, which can be used to source the catalog content on the cluster. Creating and updating your own index image provides a method for customizing the set of Operators available on the cluster, while also avoiding the aforementioned restricted network environment issues.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Kubernetes periodically deprecates certain APIs that are removed in subsequent releases. As a result, Operators are unable to use removed APIs starting with the version of OpenShift Container Platform that uses the Kubernetes version that removed the API.
					</p><p>
						If your cluster is using custom catalogs, see <a class="link" href="#osdk-control-compat_osdk-working-bundle-images" title="5.8.5. Controlling Operator compatibility with OpenShift Container Platform versions">Controlling Operator compatibility with OpenShift Container Platform versions</a> for more details about how Operator authors can update their projects to help avoid workload issues and prevent incompatible upgrades.
					</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Support for the legacy <span class="emphasis"><em>package manifest format</em></span> for Operators, including custom catalogs that were using the legacy format, is removed in OpenShift Container Platform 4.8 and later.
					</p><p>
						When creating custom catalog images, previous versions of OpenShift Container Platform 4 required using the <code class="literal">oc adm catalog build</code> command, which was deprecated for several releases and is now removed. With the availability of Red Hat-provided index images starting in OpenShift Container Platform 4.6, catalog builders must use the <code class="literal">opm index</code> command to manage index images.
					</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-managing-custom-catalogs">Managing custom catalogs</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-file-based-catalogs_olm-packaging-format">Packaging format</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-restricted-networks">Using Operator Lifecycle Manager on restricted networks</a>
						</li></ul></div></section><section class="section" id="olm-rh-catalogs_olm-rh-catalogs"><div class="titlepage"><div><div><h3 class="title">2.6.2. About Red Hat-provided Operator catalogs</h3></div></div></div><p>
					The Red Hat-provided catalog sources are installed by default in the <code class="literal">openshift-marketplace</code> namespace, which makes the catalogs available cluster-wide in all namespaces.
				</p><p>
					The following Operator catalogs are distributed by Red Hat:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 55%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731989102512" scope="col">Catalog</th><th align="left" valign="top" id="idm139732001346800" scope="col">Index image</th><th align="left" valign="top" id="idm139732001345712" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731989102512"> <p>
									<code class="literal">redhat-operators</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139732001346800"> <p>
									<code class="literal">registry.redhat.io/redhat/redhat-operator-index:v4.13</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139732001345712"> <p>
									Red Hat products packaged and shipped by Red Hat. Supported by Red Hat.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731989102512"> <p>
									<code class="literal">certified-operators</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139732001346800"> <p>
									<code class="literal">registry.redhat.io/redhat/certified-operator-index:v4.13</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139732001345712"> <p>
									Products from leading independent software vendors (ISVs). Red Hat partners with ISVs to package and ship. Supported by the ISV.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731989102512"> <p>
									<code class="literal">redhat-marketplace</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139732001346800"> <p>
									<code class="literal">registry.redhat.io/redhat/redhat-marketplace-index:v4.13</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139732001345712"> <p>
									Certified software that can be purchased from <a class="link" href="https://marketplace.redhat.com/">Red Hat Marketplace</a>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731989102512"> <p>
									<code class="literal">community-operators</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139732001346800"> <p>
									<code class="literal">registry.redhat.io/redhat/community-operator-index:v4.13</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139732001345712"> <p>
									Software maintained by relevant representatives in the <a class="link" href="https://github.com/redhat-openshift-ecosystem/community-operators-prod/tree/main/operators">redhat-openshift-ecosystem/community-operators-prod/operators</a> GitHub repository. No official support.
								</p>
								 </td></tr></tbody></table></div><p>
					During a cluster upgrade, the index image tag for the default Red Hat-provided catalog sources are updated automatically by the Cluster Version Operator (CVO) so that Operator Lifecycle Manager (OLM) pulls the updated version of the catalog. For example during an upgrade from OpenShift Container Platform 4.8 to 4.9, the <code class="literal">spec.image</code> field in the <code class="literal">CatalogSource</code> object for the <code class="literal">redhat-operators</code> catalog is updated from:
				</p><pre class="programlisting language-terminal">registry.redhat.io/redhat/redhat-operator-index:v4.8</pre><p>
					to:
				</p><pre class="programlisting language-terminal">registry.redhat.io/redhat/redhat-operator-index:v4.9</pre></section></section><section class="section" id="olm-multitenancy"><div class="titlepage"><div><div><h2 class="title">2.7. Operators in multitenant clusters</h2></div></div></div><p>
				The default behavior for Operator Lifecycle Manager (OLM) aims to provide simplicity during Operator installation. However, this behavior can lack flexibility, especially in multitenant clusters. In order for multiple tenants on a OpenShift Container Platform cluster to use an Operator, the default behavior of OLM requires that administrators install the Operator in <span class="strong strong"><strong>All namespaces</strong></span> mode, which can be considered to violate the principle of least privilege.
			</p><p>
				Consider the following scenarios to determine which Operator installation workflow works best for your environment and requirements.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-common-terms-multitenancy_olm-common-terms">Common terms: Multitenant</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-operatorgroups-limitations">Limitations for multitenant Operator management</a>
					</li></ul></div><section class="section" id="olm-default-install-modes-behavior_olm-multitenancy"><div class="titlepage"><div><div><h3 class="title">2.7.1. Default Operator install modes and behavior</h3></div></div></div><p>
					When installing Operators with the web console as an administrator, you typically have two choices for the install mode, depending on the Operator’s capabilities:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Single namespace</span></dt><dd>
								Installs the Operator in the chosen single namespace, and makes all permissions that the Operator requests available in that namespace.
							</dd><dt><span class="term">All namespaces</span></dt><dd>
								Installs the Operator in the default <code class="literal">openshift-operators</code> namespace to watch and be made available to all namespaces in the cluster. Makes all permissions that the Operator requests available in all namespaces. In some cases, an Operator author can define metadata to give the user a second option for that Operator’s suggested namespace.
							</dd></dl></div><p>
					This choice also means that users in the affected namespaces get access to the Operators APIs, which can leverage the custom resources (CRs) they own, depending on their role in the namespace:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">namespace-admin</code> and <code class="literal">namespace-edit</code> roles can read/write to the Operator APIs, meaning they can use them.
						</li><li class="listitem">
							The <code class="literal">namespace-view</code> role can read CR objects of that Operator.
						</li></ul></div><p>
					For <span class="strong strong"><strong>Single namespace</strong></span> mode, because the Operator itself installs in the chosen namespace, its pod and service account are also located there. For <span class="strong strong"><strong>All namespaces</strong></span> mode, the Operator’s privileges are all automatically elevated to cluster roles, meaning the Operator has those permissions in all namespaces.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-adding-operators-to-a-cluster">Adding Operators to a cluster</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-operatorgroups-membership_olm-understanding-operatorgroups">Install modes types</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-suggested-namespace_osdk-generating-csvs">Setting a suggested namespace</a>
						</li></ul></div></section><section class="section" id="olm-multitenancy-solution_olm-multitenancy"><div class="titlepage"><div><div><h3 class="title">2.7.2. Recommended solution for multitenant clusters</h3></div></div></div><p>
					While a <span class="strong strong"><strong>Multinamespace</strong></span> install mode does exist, it is supported by very few Operators. As a middle ground solution between the standard <span class="strong strong"><strong>All namespaces</strong></span> and <span class="strong strong"><strong>Single namespace</strong></span> install modes, you can install multiple instances of the same Operator, one for each tenant, by using the following workflow:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Create a namespace for the tenant Operator that is separate from the tenant’s namespace.
						</li><li class="listitem">
							Create an Operator group for the tenant Operator scoped only to the tenant’s namespace.
						</li><li class="listitem">
							Install the Operator in the tenant Operator namespace.
						</li></ol></div><p>
					As a result, the Operator resides in the tenant Operator namespace and watches the tenant namespace, but neither the Operator’s pod nor its service account are visible or usable by the tenant.
				</p><p>
					This solution provides better tenant separation, least privilege principle at the cost of resource usage, and additional orchestration to ensure the constraints are met. For a detailed procedure, see "Preparing for multiple instances of an Operator for multitenant clusters".
				</p><div class="formalpara"><p class="title"><strong>Limitations and considerations</strong></p><p>
						This solution only works when the following constraints are met:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							All instances of the same Operator must be the same version.
						</li><li class="listitem">
							The Operator cannot have dependencies on other Operators.
						</li><li class="listitem">
							The Operator cannot ship a CRD conversion webhook.
						</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						You cannot use different versions of the same Operator on the same cluster. Eventually, the installation of another instance of the Operator would be blocked when it meets the following conditions:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The instance is not the newest version of the Operator.
							</li><li class="listitem">
								The instance ships an older revision of the CRDs that lack information or versions that newer revisions have that are already in use on the cluster.
							</li></ul></div></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						As an administrator, use caution when allowing non-cluster administrators to install Operators self-sufficiently, as explained in "Allowing non-cluster administrators to install Operators". These tenants should only have access to a curated catalog of Operators that are known to not have dependencies. These tenants must also be forced to use the same version line of an Operator, to ensure the CRDs do not change. This requires the use of namespace-scoped catalogs and likely disabling the global default catalogs.
					</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-preparing-operators-multitenant_olm-adding-operators-to-a-cluster">Preparing for multiple instances of an Operator for multitenant clusters</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-creating-policy">Allowing non-cluster administrators to install Operators</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-restricted-networks-operatorhub_olm-managing-custom-catalogs">Disabling the default OperatorHub catalog sources</a>
						</li></ul></div></section><section class="section" id="olm-colocation_olm-multitenancy"><div class="titlepage"><div><div><h3 class="title">2.7.3. Operator colocation and Operator groups</h3></div></div></div><p>
					Operator Lifecycle Manager (OLM) handles OLM-managed Operators that are installed in the same namespace, meaning their <code class="literal">Subscription</code> resources are colocated in the same namespace, as related Operators. Even if they are not actually related, OLM considers their states, such as their version and update policy, when any one of them is updated.
				</p><p>
					For more information on Operator colocation and using Operator groups effectively, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-colocation">Operator Lifecycle Manager (OLM) → Multitenancy and Operator colocation</a>.
				</p></section></section><section class="section" id="crds"><div class="titlepage"><div><div><h2 class="title">2.8. CRDs</h2></div></div></div><section class="section" id="crd-extending-api-with-crds"><div class="titlepage"><div><div><h3 class="title">2.8.1. Extending the Kubernetes API with custom resource definitions</h3></div></div></div><p>
					Operators use the Kubernetes extension mechanism, custom resource definitions (CRDs), so that custom objects managed by the Operator look and act just like the built-in, native Kubernetes objects. This guide describes how cluster administrators can extend their OpenShift Container Platform cluster by creating and managing CRDs.
				</p><section class="section" id="crd-custom-resource-definitions_crd-extending-api-with-crds"><div class="titlepage"><div><div><h4 class="title">2.8.1.1. Custom resource definitions</h4></div></div></div><p>
						In the Kubernetes API, a <span class="emphasis"><em>resource</em></span> is an endpoint that stores a collection of API objects of a certain kind. For example, the built-in <code class="literal">Pods</code> resource contains a collection of <code class="literal">Pod</code> objects.
					</p><p>
						A <span class="emphasis"><em>custom resource definition</em></span> (CRD) object defines a new, unique object type, called a <span class="emphasis"><em>kind</em></span>, in the cluster and lets the Kubernetes API server handle its entire lifecycle.
					</p><p>
						<span class="emphasis"><em>Custom resource</em></span> (CR) objects are created from CRDs that have been added to the cluster by a cluster administrator, allowing all cluster users to add the new resource type into projects.
					</p><p>
						When a cluster administrator adds a new CRD to the cluster, the Kubernetes API server reacts by creating a new RESTful resource path that can be accessed by the entire cluster or a single project (namespace) and begins serving the specified CR.
					</p><p>
						Cluster administrators that want to grant access to the CRD to other users can use cluster role aggregation to grant access to users with the <code class="literal">admin</code>, <code class="literal">edit</code>, or <code class="literal">view</code> default cluster roles. Cluster role aggregation allows the insertion of custom policy rules into these cluster roles. This behavior integrates the new resource into the RBAC policy of the cluster as if it was a built-in resource.
					</p><p>
						Operators in particular make use of CRDs by packaging them with any required RBAC policy and other software-specific logic. Cluster administrators can also add CRDs manually to the cluster outside of the lifecycle of an Operator, making them available to all users.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							While only cluster administrators can create CRDs, developers can create the CR from an existing CRD if they have read and write permission to it.
						</p></div></div></section><section class="section" id="crd-creating-custom-resources-definition_crd-extending-api-with-crds"><div class="titlepage"><div><div><h4 class="title">2.8.1.2. Creating a custom resource definition</h4></div></div></div><p>
						To create custom resource (CR) objects, cluster administrators must first create a custom resource definition (CRD).
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Access to an OpenShift Container Platform cluster with <code class="literal">cluster-admin</code> user privileges.
							</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							To create a CRD:
						</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a YAML file that contains the following field types:
							</p><div class="formalpara"><p class="title"><strong>Example YAML file for a CRD</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: apiextensions.k8s.io/v1 <span id="CO6-1"><!--Empty--></span><span class="callout">1</span>
kind: CustomResourceDefinition
metadata:
  name: crontabs.stable.example.com <span id="CO6-2"><!--Empty--></span><span class="callout">2</span>
spec:
  group: stable.example.com <span id="CO6-3"><!--Empty--></span><span class="callout">3</span>
  versions:
    name: v1 <span id="CO6-4"><!--Empty--></span><span class="callout">4</span>
  scope: Namespaced <span id="CO6-5"><!--Empty--></span><span class="callout">5</span>
  names:
    plural: crontabs <span id="CO6-6"><!--Empty--></span><span class="callout">6</span>
    singular: crontab <span id="CO6-7"><!--Empty--></span><span class="callout">7</span>
    kind: CronTab <span id="CO6-8"><!--Empty--></span><span class="callout">8</span>
    shortNames:
    - ct <span id="CO6-9"><!--Empty--></span><span class="callout">9</span></pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO6-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Use the <code class="literal">apiextensions.k8s.io/v1</code> API.
									</div></dd><dt><a href="#CO6-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Specify a name for the definition. This must be in the <code class="literal">&lt;plural-name&gt;.&lt;group&gt;</code> format using the values from the <code class="literal">group</code> and <code class="literal">plural</code> fields.
									</div></dd><dt><a href="#CO6-3"><span class="callout">3</span></a> </dt><dd><div class="para">
										Specify a group name for the API. An API group is a collection of objects that are logically related. For example, all batch objects like <code class="literal">Job</code> or <code class="literal">ScheduledJob</code> could be in the batch API group (such as <code class="literal">batch.api.example.com</code>). A good practice is to use a fully-qualified-domain name (FQDN) of your organization.
									</div></dd><dt><a href="#CO6-4"><span class="callout">4</span></a> </dt><dd><div class="para">
										Specify a version name to be used in the URL. Each API group can exist in multiple versions, for example <code class="literal">v1alpha</code>, <code class="literal">v1beta</code>, <code class="literal">v1</code>.
									</div></dd><dt><a href="#CO6-5"><span class="callout">5</span></a> </dt><dd><div class="para">
										Specify whether the custom objects are available to a project (<code class="literal">Namespaced</code>) or all projects in the cluster (<code class="literal">Cluster</code>).
									</div></dd><dt><a href="#CO6-6"><span class="callout">6</span></a> </dt><dd><div class="para">
										Specify the plural name to use in the URL. The <code class="literal">plural</code> field is the same as a resource in an API URL.
									</div></dd><dt><a href="#CO6-7"><span class="callout">7</span></a> </dt><dd><div class="para">
										Specify a singular name to use as an alias on the CLI and for display.
									</div></dd><dt><a href="#CO6-8"><span class="callout">8</span></a> </dt><dd><div class="para">
										Specify the kind of objects that can be created. The type can be in CamelCase.
									</div></dd><dt><a href="#CO6-9"><span class="callout">9</span></a> </dt><dd><div class="para">
										Specify a shorter string to match your resource on the CLI.
									</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									By default, a CRD is cluster-scoped and available to all projects.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Create the CRD object:
							</p><pre class="programlisting language-terminal">$ oc create -f &lt;file_name&gt;.yaml</pre><p class="simpara">
								A new RESTful API endpoint is created at:
							</p><pre class="programlisting language-terminal">/apis/&lt;spec:group&gt;/&lt;spec:version&gt;/&lt;scope&gt;/*/&lt;names-plural&gt;/...</pre><p class="simpara">
								For example, using the example file, the following endpoint is created:
							</p><pre class="programlisting language-terminal">/apis/stable.example.com/v1/namespaces/*/crontabs/...</pre><p class="simpara">
								You can now use this endpoint URL to create and manage CRs. The object kind is based on the <code class="literal">spec.kind</code> field of the CRD object you created.
							</p></li></ol></div></section><section class="section" id="crd-creating-aggregated-cluster-role_crd-extending-api-with-crds"><div class="titlepage"><div><div><h4 class="title">2.8.1.3. Creating cluster roles for custom resource definitions</h4></div></div></div><p>
						Cluster administrators can grant permissions to existing cluster-scoped custom resource definitions (CRDs). If you use the <code class="literal">admin</code>, <code class="literal">edit</code>, and <code class="literal">view</code> default cluster roles, you can take advantage of cluster role aggregation for their rules.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							You must explicitly assign permissions to each of these roles. The roles with more permissions do not inherit rules from roles with fewer permissions. If you assign a rule to a role, you must also assign that verb to roles that have more permissions. For example, if you grant the <code class="literal">get crontabs</code> permission to the view role, you must also grant it to the <code class="literal">edit</code> and <code class="literal">admin</code> roles. The <code class="literal">admin</code> or <code class="literal">edit</code> role is usually assigned to the user that created a project through the project template.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Create a CRD.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a cluster role definition file for the CRD. The cluster role definition is a YAML file that contains the rules that apply to each cluster role. An OpenShift Container Platform controller adds the rules that you specify to the default cluster roles.
							</p><div class="formalpara"><p class="title"><strong>Example YAML file for a cluster role definition</strong></p><p>
									
<pre class="programlisting language-yaml">kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1 <span id="CO7-1"><!--Empty--></span><span class="callout">1</span>
metadata:
  name: aggregate-cron-tabs-admin-edit <span id="CO7-2"><!--Empty--></span><span class="callout">2</span>
  labels:
    rbac.authorization.k8s.io/aggregate-to-admin: "true" <span id="CO7-3"><!--Empty--></span><span class="callout">3</span>
    rbac.authorization.k8s.io/aggregate-to-edit: "true" <span id="CO7-4"><!--Empty--></span><span class="callout">4</span>
rules:
- apiGroups: ["stable.example.com"] <span id="CO7-5"><!--Empty--></span><span class="callout">5</span>
  resources: ["crontabs"] <span id="CO7-6"><!--Empty--></span><span class="callout">6</span>
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete", "deletecollection"] <span id="CO7-7"><!--Empty--></span><span class="callout">7</span>
---
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: aggregate-cron-tabs-view <span id="CO7-8"><!--Empty--></span><span class="callout">8</span>
  labels:
    # Add these permissions to the "view" default role.
    rbac.authorization.k8s.io/aggregate-to-view: "true" <span id="CO7-9"><!--Empty--></span><span class="callout">9</span>
    rbac.authorization.k8s.io/aggregate-to-cluster-reader: "true" <span id="CO7-10"><!--Empty--></span><span class="callout">10</span>
rules:
- apiGroups: ["stable.example.com"] <span id="CO7-11"><!--Empty--></span><span class="callout">11</span>
  resources: ["crontabs"] <span id="CO7-12"><!--Empty--></span><span class="callout">12</span>
  verbs: ["get", "list", "watch"] <span id="CO7-13"><!--Empty--></span><span class="callout">13</span></pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO7-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Use the <code class="literal">rbac.authorization.k8s.io/v1</code> API.
									</div></dd><dt><a href="#CO7-2"><span class="callout">2</span></a> <a href="#CO7-8"><span class="callout">8</span></a> </dt><dd><div class="para">
										Specify a name for the definition.
									</div></dd><dt><a href="#CO7-3"><span class="callout">3</span></a> </dt><dd><div class="para">
										Specify this label to grant permissions to the admin default role.
									</div></dd><dt><a href="#CO7-4"><span class="callout">4</span></a> </dt><dd><div class="para">
										Specify this label to grant permissions to the edit default role.
									</div></dd><dt><a href="#CO7-5"><span class="callout">5</span></a> <a href="#CO7-11"><span class="callout">11</span></a> </dt><dd><div class="para">
										Specify the group name of the CRD.
									</div></dd><dt><a href="#CO7-6"><span class="callout">6</span></a> <a href="#CO7-12"><span class="callout">12</span></a> </dt><dd><div class="para">
										Specify the plural name of the CRD that these rules apply to.
									</div></dd><dt><a href="#CO7-7"><span class="callout">7</span></a> <a href="#CO7-13"><span class="callout">13</span></a> </dt><dd><div class="para">
										Specify the verbs that represent the permissions that are granted to the role. For example, apply read and write permissions to the <code class="literal">admin</code> and <code class="literal">edit</code> roles and only read permission to the <code class="literal">view</code> role.
									</div></dd><dt><a href="#CO7-9"><span class="callout">9</span></a> </dt><dd><div class="para">
										Specify this label to grant permissions to the <code class="literal">view</code> default role.
									</div></dd><dt><a href="#CO7-10"><span class="callout">10</span></a> </dt><dd><div class="para">
										Specify this label to grant permissions to the <code class="literal">cluster-reader</code> default role.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Create the cluster role:
							</p><pre class="programlisting language-terminal">$ oc create -f &lt;file_name&gt;.yaml</pre></li></ol></div></section><section class="section" id="crd-creating-custom-resources-from-file_crd-extending-api-with-crds"><div class="titlepage"><div><div><h4 class="title">2.8.1.4. Creating custom resources from a file</h4></div></div></div><p>
						After a custom resource definition (CRD) has been added to the cluster, custom resources (CRs) can be created with the CLI from a file using the CR specification.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								CRD added to the cluster by a cluster administrator.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a YAML file for the CR. In the following example definition, the <code class="literal">cronSpec</code> and <code class="literal">image</code> custom fields are set in a CR of <code class="literal">Kind: CronTab</code>. The <code class="literal">Kind</code> comes from the <code class="literal">spec.kind</code> field of the CRD object:
							</p><div class="formalpara"><p class="title"><strong>Example YAML file for a CR</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: "stable.example.com/v1" <span id="CO8-1"><!--Empty--></span><span class="callout">1</span>
kind: CronTab <span id="CO8-2"><!--Empty--></span><span class="callout">2</span>
metadata:
  name: my-new-cron-object <span id="CO8-3"><!--Empty--></span><span class="callout">3</span>
  finalizers: <span id="CO8-4"><!--Empty--></span><span class="callout">4</span>
  - finalizer.stable.example.com
spec: <span id="CO8-5"><!--Empty--></span><span class="callout">5</span>
  cronSpec: "* * * * /5"
  image: my-awesome-cron-image</pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO8-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Specify the group name and API version (name/version) from the CRD.
									</div></dd><dt><a href="#CO8-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Specify the type in the CRD.
									</div></dd><dt><a href="#CO8-3"><span class="callout">3</span></a> </dt><dd><div class="para">
										Specify a name for the object.
									</div></dd><dt><a href="#CO8-4"><span class="callout">4</span></a> </dt><dd><div class="para">
										Specify the <a class="link" href="https://kubernetes.io/docs/tasks/access-kubernetes-api/extend-api-custom-resource-definitions/#finalizers">finalizers</a> for the object, if any. Finalizers allow controllers to implement conditions that must be completed before the object can be deleted.
									</div></dd><dt><a href="#CO8-5"><span class="callout">5</span></a> </dt><dd><div class="para">
										Specify conditions specific to the type of object.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								After you create the file, create the object:
							</p><pre class="programlisting language-terminal">$ oc create -f &lt;file_name&gt;.yaml</pre></li></ol></div></section><section class="section" id="crd-inspecting-custom-resources_crd-extending-api-with-crds"><div class="titlepage"><div><div><h4 class="title">2.8.1.5. Inspecting custom resources</h4></div></div></div><p>
						You can inspect custom resource (CR) objects that exist in your cluster using the CLI.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								A CR object exists in a namespace to which you have access.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To get information on a specific kind of a CR, run:
							</p><pre class="programlisting language-terminal">$ oc get &lt;kind&gt;</pre><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc get crontab</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                 KIND
my-new-cron-object   CronTab.v1.stable.example.com</pre>

								</p></div><p class="simpara">
								Resource names are not case-sensitive, and you can use either the singular or plural forms defined in the CRD, as well as any short name. For example:
							</p><pre class="programlisting language-terminal">$ oc get crontabs</pre><pre class="programlisting language-terminal">$ oc get crontab</pre><pre class="programlisting language-terminal">$ oc get ct</pre></li><li class="listitem"><p class="simpara">
								You can also view the raw YAML data for a CR:
							</p><pre class="programlisting language-terminal">$ oc get &lt;kind&gt; -o yaml</pre><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc get ct -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">apiVersion: v1
items:
- apiVersion: stable.example.com/v1
  kind: CronTab
  metadata:
    clusterName: ""
    creationTimestamp: 2017-05-31T12:56:35Z
    deletionGracePeriodSeconds: null
    deletionTimestamp: null
    name: my-new-cron-object
    namespace: default
    resourceVersion: "285"
    selfLink: /apis/stable.example.com/v1/namespaces/default/crontabs/my-new-cron-object
    uid: 9423255b-4600-11e7-af6a-28d2447dc82b
  spec:
    cronSpec: '* * * * /5' <span id="CO9-1"><!--Empty--></span><span class="callout">1</span>
    image: my-awesome-cron-image <span id="CO9-2"><!--Empty--></span><span class="callout">2</span></pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO9-1"><span class="callout">1</span></a> <a href="#CO9-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Custom data from the YAML that you used to create the object displays.
									</div></dd></dl></div></li></ol></div></section></section><section class="section" id="crd-managing-resources-from-crds"><div class="titlepage"><div><div><h3 class="title">2.8.2. Managing resources from custom resource definitions</h3></div></div></div><p>
					This guide describes how developers can manage custom resources (CRs) that come from custom resource definitions (CRDs).
				</p><section class="section" id="crd-custom-resource-definitions_crd-managing-resources-from-crds"><div class="titlepage"><div><div><h4 class="title">2.8.2.1. Custom resource definitions</h4></div></div></div><p>
						In the Kubernetes API, a <span class="emphasis"><em>resource</em></span> is an endpoint that stores a collection of API objects of a certain kind. For example, the built-in <code class="literal">Pods</code> resource contains a collection of <code class="literal">Pod</code> objects.
					</p><p>
						A <span class="emphasis"><em>custom resource definition</em></span> (CRD) object defines a new, unique object type, called a <span class="emphasis"><em>kind</em></span>, in the cluster and lets the Kubernetes API server handle its entire lifecycle.
					</p><p>
						<span class="emphasis"><em>Custom resource</em></span> (CR) objects are created from CRDs that have been added to the cluster by a cluster administrator, allowing all cluster users to add the new resource type into projects.
					</p><p>
						Operators in particular make use of CRDs by packaging them with any required RBAC policy and other software-specific logic. Cluster administrators can also add CRDs manually to the cluster outside of the lifecycle of an Operator, making them available to all users.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							While only cluster administrators can create CRDs, developers can create the CR from an existing CRD if they have read and write permission to it.
						</p></div></div></section><section class="section" id="crd-creating-custom-resources-from-file_crd-managing-resources-from-crds"><div class="titlepage"><div><div><h4 class="title">2.8.2.2. Creating custom resources from a file</h4></div></div></div><p>
						After a custom resource definition (CRD) has been added to the cluster, custom resources (CRs) can be created with the CLI from a file using the CR specification.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								CRD added to the cluster by a cluster administrator.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a YAML file for the CR. In the following example definition, the <code class="literal">cronSpec</code> and <code class="literal">image</code> custom fields are set in a CR of <code class="literal">Kind: CronTab</code>. The <code class="literal">Kind</code> comes from the <code class="literal">spec.kind</code> field of the CRD object:
							</p><div class="formalpara"><p class="title"><strong>Example YAML file for a CR</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: "stable.example.com/v1" <span id="CO10-1"><!--Empty--></span><span class="callout">1</span>
kind: CronTab <span id="CO10-2"><!--Empty--></span><span class="callout">2</span>
metadata:
  name: my-new-cron-object <span id="CO10-3"><!--Empty--></span><span class="callout">3</span>
  finalizers: <span id="CO10-4"><!--Empty--></span><span class="callout">4</span>
  - finalizer.stable.example.com
spec: <span id="CO10-5"><!--Empty--></span><span class="callout">5</span>
  cronSpec: "* * * * /5"
  image: my-awesome-cron-image</pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO10-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Specify the group name and API version (name/version) from the CRD.
									</div></dd><dt><a href="#CO10-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Specify the type in the CRD.
									</div></dd><dt><a href="#CO10-3"><span class="callout">3</span></a> </dt><dd><div class="para">
										Specify a name for the object.
									</div></dd><dt><a href="#CO10-4"><span class="callout">4</span></a> </dt><dd><div class="para">
										Specify the <a class="link" href="https://kubernetes.io/docs/tasks/access-kubernetes-api/extend-api-custom-resource-definitions/#finalizers">finalizers</a> for the object, if any. Finalizers allow controllers to implement conditions that must be completed before the object can be deleted.
									</div></dd><dt><a href="#CO10-5"><span class="callout">5</span></a> </dt><dd><div class="para">
										Specify conditions specific to the type of object.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								After you create the file, create the object:
							</p><pre class="programlisting language-terminal">$ oc create -f &lt;file_name&gt;.yaml</pre></li></ol></div></section><section class="section" id="crd-inspecting-custom-resources_crd-managing-resources-from-crds"><div class="titlepage"><div><div><h4 class="title">2.8.2.3. Inspecting custom resources</h4></div></div></div><p>
						You can inspect custom resource (CR) objects that exist in your cluster using the CLI.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								A CR object exists in a namespace to which you have access.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To get information on a specific kind of a CR, run:
							</p><pre class="programlisting language-terminal">$ oc get &lt;kind&gt;</pre><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc get crontab</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                 KIND
my-new-cron-object   CronTab.v1.stable.example.com</pre>

								</p></div><p class="simpara">
								Resource names are not case-sensitive, and you can use either the singular or plural forms defined in the CRD, as well as any short name. For example:
							</p><pre class="programlisting language-terminal">$ oc get crontabs</pre><pre class="programlisting language-terminal">$ oc get crontab</pre><pre class="programlisting language-terminal">$ oc get ct</pre></li><li class="listitem"><p class="simpara">
								You can also view the raw YAML data for a CR:
							</p><pre class="programlisting language-terminal">$ oc get &lt;kind&gt; -o yaml</pre><p class="simpara">
								For example:
							</p><pre class="programlisting language-terminal">$ oc get ct -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">apiVersion: v1
items:
- apiVersion: stable.example.com/v1
  kind: CronTab
  metadata:
    clusterName: ""
    creationTimestamp: 2017-05-31T12:56:35Z
    deletionGracePeriodSeconds: null
    deletionTimestamp: null
    name: my-new-cron-object
    namespace: default
    resourceVersion: "285"
    selfLink: /apis/stable.example.com/v1/namespaces/default/crontabs/my-new-cron-object
    uid: 9423255b-4600-11e7-af6a-28d2447dc82b
  spec:
    cronSpec: '* * * * /5' <span id="CO11-1"><!--Empty--></span><span class="callout">1</span>
    image: my-awesome-cron-image <span id="CO11-2"><!--Empty--></span><span class="callout">2</span></pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO11-1"><span class="callout">1</span></a> <a href="#CO11-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Custom data from the YAML that you used to create the object displays.
									</div></dd></dl></div></li></ol></div></section></section></section></section><section class="chapter" id="user-tasks"><div class="titlepage"><div><div><h1 class="title">Chapter 3. User tasks</h1></div></div></div><section class="section" id="olm-creating-apps-from-installed-operators"><div class="titlepage"><div><div><h2 class="title">3.1. Creating applications from installed Operators</h2></div></div></div><p>
				This guide walks developers through an example of creating applications from an installed Operator using the OpenShift Container Platform web console.
			</p><section class="section" id="olm-creating-etcd-cluster-from-operator_olm-creating-apps-from-installed-operators"><div class="titlepage"><div><div><h3 class="title">3.1.1. Creating an etcd cluster using an Operator</h3></div></div></div><p>
					This procedure walks through creating a new etcd cluster using the etcd Operator, managed by Operator Lifecycle Manager (OLM).
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Access to an OpenShift Container Platform 4.13 cluster.
						</li><li class="listitem">
							The etcd Operator already installed cluster-wide by an administrator.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Create a new project in the OpenShift Container Platform web console for this procedure. This example uses a project called <code class="literal">my-etcd</code>.
						</li><li class="listitem"><p class="simpara">
							Navigate to the <span class="strong strong"><strong>Operators → Installed Operators</strong></span> page. The Operators that have been installed to the cluster by the cluster administrator and are available for use are shown here as a list of cluster service versions (CSVs). CSVs are used to launch and manage the software provided by the Operator.
						</p><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
							You can get this list from the CLI using:
						</p><pre class="programlisting language-terminal">$ oc get csv</pre></div></div></li><li class="listitem"><p class="simpara">
							On the <span class="strong strong"><strong>Installed Operators</strong></span> page, click the etcd Operator to view more details and available actions.
						</p><p class="simpara">
							As shown under <span class="strong strong"><strong>Provided APIs</strong></span>, this Operator makes available three new resource types, including one for an <span class="strong strong"><strong>etcd Cluster</strong></span> (the <code class="literal">EtcdCluster</code> resource). These objects work similar to the built-in native Kubernetes ones, such as <code class="literal">Deployment</code> or <code class="literal">ReplicaSet</code>, but contain logic specific to managing etcd.
						</p></li><li class="listitem"><p class="simpara">
							Create a new etcd cluster:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									In the <span class="strong strong"><strong>etcd Cluster</strong></span> API box, click <span class="strong strong"><strong>Create instance</strong></span>.
								</li><li class="listitem">
									The next page allows you to make any modifications to the minimal starting template of an <code class="literal">EtcdCluster</code> object, such as the size of the cluster. For now, click <span class="strong strong"><strong>Create</strong></span> to finalize. This triggers the Operator to start up the pods, services, and other components of the new etcd cluster.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Click the <span class="strong strong"><strong>example</strong></span> etcd cluster, then click the <span class="strong strong"><strong>Resources</strong></span> tab to see that your project now contains a number of resources created and configured automatically by the Operator.
						</p><p class="simpara">
							Verify that a Kubernetes service has been created that allows you to access the database from other pods in your project.
						</p></li><li class="listitem"><p class="simpara">
							All users with the <code class="literal">edit</code> role in a given project can create, manage, and delete application instances (an etcd cluster, in this example) managed by Operators that have already been created in the project, in a self-service manner, just like a cloud service. If you want to enable additional users with this ability, project administrators can add the role using the following command:
						</p><pre class="programlisting language-terminal">$ oc policy add-role-to-user edit &lt;user&gt; -n &lt;target_project&gt;</pre></li></ol></div><p>
					You now have an etcd cluster that will react to failures and rebalance data as pods become unhealthy or are migrated between nodes in the cluster. Most importantly, cluster administrators or developers with proper access can now easily use the database with their applications.
				</p></section></section><section class="section" id="olm-installing-operators-in-namespace"><div class="titlepage"><div><div><h2 class="title">3.2. Installing Operators in your namespace</h2></div></div></div><p>
				If a cluster administrator has delegated Operator installation permissions to your account, you can install and subscribe an Operator to your namespace in a self-service manner.
			</p><section class="section" id="olm-installing-operators-in-namespace-prereqs"><div class="titlepage"><div><div><h3 class="title">3.2.1. Prerequisites</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A cluster administrator must add certain permissions to your OpenShift Container Platform user account to allow self-service Operator installation to a namespace. See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-creating-policy">Allowing non-cluster administrators to install Operators</a> for details.
						</li></ul></div></section><section class="section" id="olm-installing-operators-from-operatorhub_olm-installing-operators-in-namespace"><div class="titlepage"><div><div><h3 class="title">3.2.2. About Operator installation with OperatorHub</h3></div></div></div><p>
					OperatorHub is a user interface for discovering Operators; it works in conjunction with Operator Lifecycle Manager (OLM), which installs and manages Operators on a cluster.
				</p><p>
					As a user with the proper permissions, you can install an Operator from OperatorHub by using the OpenShift Container Platform web console or CLI.
				</p><p>
					During installation, you must determine the following initial settings for the Operator:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Installation Mode</span></dt><dd>
								Choose a specific namespace in which to install the Operator.
							</dd><dt><span class="term">Update Channel</span></dt><dd>
								If an Operator is available through multiple channels, you can choose which channel you want to subscribe to. For example, to deploy from the <span class="strong strong"><strong>stable</strong></span> channel, if available, select it from the list.
							</dd><dt><span class="term">Approval Strategy</span></dt><dd><p class="simpara">
								You can choose automatic or manual updates.
							</p><p class="simpara">
								If you choose automatic updates for an installed Operator, when a new version of that Operator is available in the selected channel, Operator Lifecycle Manager (OLM) automatically upgrades the running instance of your Operator without human intervention.
							</p><p class="simpara">
								If you select manual updates, when a newer version of an Operator is available, OLM creates an update request. As a cluster administrator, you must then manually approve that update request to have the Operator updated to the new version.
							</p></dd></dl></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-understanding-operatorhub">Understanding OperatorHub</a>
						</li></ul></div></section><section class="section" id="olm-installing-from-operatorhub-using-web-console_olm-installing-operators-in-namespace"><div class="titlepage"><div><div><h3 class="title">3.2.3. Installing from OperatorHub using the web console</h3></div></div></div><p>
					You can install and subscribe to an Operator from OperatorHub by using the OpenShift Container Platform web console.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Access to an OpenShift Container Platform cluster using an account with Operator installation permissions.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Navigate in the web console to the <span class="strong strong"><strong>Operators → OperatorHub</strong></span> page.
						</li><li class="listitem"><p class="simpara">
							Scroll or type a keyword into the <span class="strong strong"><strong>Filter by keyword</strong></span> box to find the Operator you want. For example, type <code class="literal">advanced</code> to find the Advanced Cluster Management for Kubernetes Operator.
						</p><p class="simpara">
							You can also filter options by <span class="strong strong"><strong>Infrastructure Features</strong></span>. For example, select <span class="strong strong"><strong>Disconnected</strong></span> if you want to see Operators that work in disconnected environments, also known as restricted network environments.
						</p></li><li class="listitem"><p class="simpara">
							Select the Operator to display additional information.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Choosing a Community Operator warns that Red Hat does not certify Community Operators; you must acknowledge the warning before continuing.
							</p></div></div></li><li class="listitem">
							Read the information about the Operator and click <span class="strong strong"><strong>Install</strong></span>.
						</li><li class="listitem"><p class="simpara">
							On the <span class="strong strong"><strong>Install Operator</strong></span> page:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Choose a specific, single namespace in which to install the Operator. The Operator will only watch and be made available for use in this single namespace.
								</li><li class="listitem">
									Select an <span class="strong strong"><strong>Update channel</strong></span> (if more than one is available).
								</li><li class="listitem">
									Select <span class="strong strong"><strong>Automatic</strong></span> or <span class="strong strong"><strong>Manual</strong></span> approval strategy, as described earlier.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Install</strong></span> to make the Operator available to the selected namespaces on this OpenShift Container Platform cluster.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									If you selected a <span class="strong strong"><strong>Manual</strong></span> approval strategy, the upgrade status of the subscription remains <span class="strong strong"><strong>Upgrading</strong></span> until you review and approve the install plan.
								</p><p class="simpara">
									After approving on the <span class="strong strong"><strong>Install Plan</strong></span> page, the subscription upgrade status moves to <span class="strong strong"><strong>Up to date</strong></span>.
								</p></li><li class="listitem">
									If you selected an <span class="strong strong"><strong>Automatic</strong></span> approval strategy, the upgrade status should resolve to <span class="strong strong"><strong>Up to date</strong></span> without intervention.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							After the upgrade status of the subscription is <span class="strong strong"><strong>Up to date</strong></span>, select <span class="strong strong"><strong>Operators → Installed Operators</strong></span> to verify that the cluster service version (CSV) of the installed Operator eventually shows up. The <span class="strong strong"><strong>Status</strong></span> should ultimately resolve to <span class="strong strong"><strong>InstallSucceeded</strong></span> in the relevant namespace.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								For the <span class="strong strong"><strong>All namespaces…​</strong></span> installation mode, the status resolves to <span class="strong strong"><strong>InstallSucceeded</strong></span> in the <code class="literal">openshift-operators</code> namespace, but the status is <span class="strong strong"><strong>Copied</strong></span> if you check in other namespaces.
							</p></div></div><p class="simpara">
							If it does not:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Check the logs in any pods in the <code class="literal">openshift-operators</code> project (or other relevant namespace if <span class="strong strong"><strong>A specific namespace…​</strong></span> installation mode was selected) on the <span class="strong strong"><strong>Workloads → Pods</strong></span> page that are reporting issues to troubleshoot further.
								</li></ol></div></li></ol></div></section><section class="section" id="olm-installing-operator-from-operatorhub-using-cli_olm-installing-operators-in-namespace"><div class="titlepage"><div><div><h3 class="title">3.2.4. Installing from OperatorHub using the CLI</h3></div></div></div><p>
					Instead of using the OpenShift Container Platform web console, you can install an Operator from OperatorHub by using the CLI. Use the <code class="literal">oc</code> command to create or update a <code class="literal">Subscription</code> object.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Access to an OpenShift Container Platform cluster using an account with Operator installation permissions.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							View the list of Operators available to the cluster from OperatorHub:
						</p><pre class="programlisting language-terminal">$ oc get packagemanifests -n openshift-marketplace</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                               CATALOG               AGE
3scale-operator                    Red Hat Operators     91m
advanced-cluster-management        Red Hat Operators     91m
amq7-cert-manager                  Red Hat Operators     91m
...
couchbase-enterprise-certified     Certified Operators   91m
crunchy-postgres-operator          Certified Operators   91m
mongodb-enterprise                 Certified Operators   91m
...
etcd                               Community Operators   91m
jaeger                             Community Operators   91m
kubefed                            Community Operators   91m
...</pre>

							</p></div><p class="simpara">
							Note the catalog for your desired Operator.
						</p></li><li class="listitem"><p class="simpara">
							Inspect your desired Operator to verify its supported install modes and available channels:
						</p><pre class="programlisting language-terminal">$ oc describe packagemanifests &lt;operator_name&gt; -n openshift-marketplace</pre></li><li class="listitem"><p class="simpara">
							An Operator group, defined by an <code class="literal">OperatorGroup</code> object, selects target namespaces in which to generate required RBAC access for all Operators in the same namespace as the Operator group.
						</p><p class="simpara">
							The namespace to which you subscribe the Operator must have an Operator group that matches the install mode of the Operator, either the <code class="literal">AllNamespaces</code> or <code class="literal">SingleNamespace</code> mode. If the Operator you intend to install uses the <code class="literal">AllNamespaces</code>, then the <code class="literal">openshift-operators</code> namespace already has an appropriate Operator group in place.
						</p><p class="simpara">
							However, if the Operator uses the <code class="literal">SingleNamespace</code> mode and you do not already have an appropriate Operator group in place, you must create one.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The web console version of this procedure handles the creation of the <code class="literal">OperatorGroup</code> and <code class="literal">Subscription</code> objects automatically behind the scenes for you when choosing <code class="literal">SingleNamespace</code> mode.
							</p></div></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create an <code class="literal">OperatorGroup</code> object YAML file, for example <code class="literal">operatorgroup.yaml</code>:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">OperatorGroup</code> object</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: &lt;operatorgroup_name&gt;
  namespace: &lt;namespace&gt;
spec:
  targetNamespaces:
  - &lt;namespace&gt;</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">OperatorGroup</code> object:
								</p><pre class="programlisting language-terminal">$ oc apply -f operatorgroup.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">Subscription</code> object YAML file to subscribe a namespace to an Operator, for example <code class="literal">sub.yaml</code>:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">Subscription</code> object</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: &lt;subscription_name&gt;
  namespace: openshift-operators <span id="CO12-1"><!--Empty--></span><span class="callout">1</span>
spec:
  channel: &lt;channel_name&gt; <span id="CO12-2"><!--Empty--></span><span class="callout">2</span>
  name: &lt;operator_name&gt; <span id="CO12-3"><!--Empty--></span><span class="callout">3</span>
  source: redhat-operators <span id="CO12-4"><!--Empty--></span><span class="callout">4</span>
  sourceNamespace: openshift-marketplace <span id="CO12-5"><!--Empty--></span><span class="callout">5</span>
  config:
    env: <span id="CO12-6"><!--Empty--></span><span class="callout">6</span>
    - name: ARGS
      value: "-v=10"
    envFrom: <span id="CO12-7"><!--Empty--></span><span class="callout">7</span>
    - secretRef:
        name: license-secret
    volumes: <span id="CO12-8"><!--Empty--></span><span class="callout">8</span>
    - name: &lt;volume_name&gt;
      configMap:
        name: &lt;configmap_name&gt;
    volumeMounts: <span id="CO12-9"><!--Empty--></span><span class="callout">9</span>
    - mountPath: &lt;directory_name&gt;
      name: &lt;volume_name&gt;
    tolerations: <span id="CO12-10"><!--Empty--></span><span class="callout">10</span>
    - operator: "Exists"
    resources: <span id="CO12-11"><!--Empty--></span><span class="callout">11</span>
      requests:
        memory: "64Mi"
        cpu: "250m"
      limits:
        memory: "128Mi"
        cpu: "500m"
    nodeSelector: <span id="CO12-12"><!--Empty--></span><span class="callout">12</span>
      foo: bar</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO12-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									For default <code class="literal">AllNamespaces</code> install mode usage, specify the <code class="literal">openshift-operators</code> namespace. Alternatively, you can specify a custom global namespace, if you have created one. Otherwise, specify the relevant single namespace for <code class="literal">SingleNamespace</code> install mode usage.
								</div></dd><dt><a href="#CO12-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Name of the channel to subscribe to.
								</div></dd><dt><a href="#CO12-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Name of the Operator to subscribe to.
								</div></dd><dt><a href="#CO12-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									Name of the catalog source that provides the Operator.
								</div></dd><dt><a href="#CO12-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									Namespace of the catalog source. Use <code class="literal">openshift-marketplace</code> for the default OperatorHub catalog sources.
								</div></dd><dt><a href="#CO12-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									The <code class="literal">env</code> parameter defines a list of Environment Variables that must exist in all containers in the pod created by OLM.
								</div></dd><dt><a href="#CO12-7"><span class="callout">7</span></a> </dt><dd><div class="para">
									The <code class="literal">envFrom</code> parameter defines a list of sources to populate Environment Variables in the container.
								</div></dd><dt><a href="#CO12-8"><span class="callout">8</span></a> </dt><dd><div class="para">
									The <code class="literal">volumes</code> parameter defines a list of Volumes that must exist on the pod created by OLM.
								</div></dd><dt><a href="#CO12-9"><span class="callout">9</span></a> </dt><dd><div class="para">
									The <code class="literal">volumeMounts</code> parameter defines a list of VolumeMounts that must exist in all containers in the pod created by OLM. If a <code class="literal">volumeMount</code> references a <code class="literal">volume</code> that does not exist, OLM fails to deploy the Operator.
								</div></dd><dt><a href="#CO12-10"><span class="callout">10</span></a> </dt><dd><div class="para">
									The <code class="literal">tolerations</code> parameter defines a list of Tolerations for the pod created by OLM.
								</div></dd><dt><a href="#CO12-11"><span class="callout">11</span></a> </dt><dd><div class="para">
									The <code class="literal">resources</code> parameter defines resource constraints for all the containers in the pod created by OLM.
								</div></dd><dt><a href="#CO12-12"><span class="callout">12</span></a> </dt><dd><div class="para">
									The <code class="literal">nodeSelector</code> parameter defines a <code class="literal">NodeSelector</code> for the pod created by OLM.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">Subscription</code> object:
						</p><pre class="programlisting language-terminal">$ oc apply -f sub.yaml</pre><p class="simpara">
							At this point, OLM is now aware of the selected Operator. A cluster service version (CSV) for the Operator should appear in the target namespace, and APIs provided by the Operator should be available for creation.
						</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-operatorgroups-about_olm-understanding-olm">Operator groups</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-subscription_olm-understanding-olm">Channel names</a>
						</li></ul></div></section><section class="section" id="olm-installing-specific-version-cli_olm-installing-operators-in-namespace"><div class="titlepage"><div><div><h3 class="title">3.2.5. Installing a specific version of an Operator</h3></div></div></div><p>
					You can install a specific version of an Operator by setting the cluster service version (CSV) in a <code class="literal">Subscription</code> object.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Access to an OpenShift Container Platform cluster using an account with Operator installation permissions.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Look up the available versions and channels of the Operator you want to install by running the following command:
						</p><div class="formalpara"><p class="title"><strong>Command syntax</strong></p><p>
								
<pre class="programlisting language-terminal">$ oc describe packagemanifests &lt;operator_name&gt; -n &lt;catalog_namespace&gt;</pre>

							</p></div><p class="simpara">
							For example, the following command prints the available channels and versions of the Red Hat Quay Operator from OperatorHub:
						</p><div class="formalpara"><p class="title"><strong>Example command</strong></p><p>
								
<pre class="programlisting language-terminal">$ oc describe packagemanifests quay-operator -n openshift-marketplace</pre>

							</p></div><div class="example" id="idm139731997146848"><p class="title"><strong>Example 3.1. Example output</strong></p><div class="example-contents"><pre class="programlisting language-text">Name:         quay-operator
Namespace:    operator-marketplace
Labels:       catalog=redhat-operators
              catalog-namespace=openshift-marketplace
              hypershift.openshift.io/managed=true
              operatorframework.io/arch.amd64=supported
              operatorframework.io/os.linux=supported
              provider=Red Hat
              provider-url=
Annotations:  &lt;none&gt;
API Version:  packages.operators.coreos.com/v1
Kind:         PackageManifest
...
    Current CSV:  quay-operator.v3.7.11
...
    Entries:
      Name:       quay-operator.v3.7.11
      Version:    3.7.11
      Name:       quay-operator.v3.7.10
      Version:    3.7.10
      Name:       quay-operator.v3.7.9
      Version:    3.7.9
      Name:       quay-operator.v3.7.8
      Version:    3.7.8
      Name:       quay-operator.v3.7.7
      Version:    3.7.7
      Name:       quay-operator.v3.7.6
      Version:    3.7.6
      Name:       quay-operator.v3.7.5
      Version:    3.7.5
      Name:       quay-operator.v3.7.4
      Version:    3.7.4
      Name:       quay-operator.v3.7.3
      Version:    3.7.3
      Name:       quay-operator.v3.7.2
      Version:    3.7.2
      Name:       quay-operator.v3.7.1
      Version:    3.7.1
      Name:       quay-operator.v3.7.0
      Version:    3.7.0
    Name:         stable-3.7
...
   Current CSV:  quay-operator.v3.8.5
...
   Entries:
      Name:         quay-operator.v3.8.5
      Version:      3.8.5
      Name:         quay-operator.v3.8.4
      Version:      3.8.4
      Name:         quay-operator.v3.8.3
      Version:      3.8.3
      Name:         quay-operator.v3.8.2
      Version:      3.8.2
      Name:         quay-operator.v3.8.1
      Version:      3.8.1
      Name:         quay-operator.v3.8.0
      Version:      3.8.0
    Name:           stable-3.8
  Default Channel:  stable-3.8
  Package Name:     quay-operator</pre></div></div><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
							You can print an Operator’s version and channel information in the YAML format by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get packagemanifests &lt;operator_name&gt; -n &lt;catalog_namespace&gt; -o yaml</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									If more than one catalog is installed in a namespace, run the following command to look up the available versions and channels of an Operator from a specific catalog:
								</p><pre class="programlisting language-terminal">$ oc get packagemanifest \
   --selector=catalog=&lt;catalogsource_name&gt; \
   --field-selector metadata.name=&lt;operator_name&gt; \
   -n &lt;catalog_namespace&gt; -o yaml</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
										If you do not specify the Operator’s catalog, running the <code class="literal">oc get packagemanifest</code> and <code class="literal">oc describe packagemanifest</code> commands might return a package from an unexpected catalog if the following conditions are met:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												Multiple catalogs are installed in the same namespace.
											</li><li class="listitem">
												The catalogs contain the same Operators or Operators with the same name.
											</li></ul></div></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							An Operator group, defined by an <code class="literal">OperatorGroup</code> object, selects target namespaces in which to generate required role-based access control (RBAC) access for all Operators in the same namespace as the Operator group.
						</p><p class="simpara">
							The namespace to which you subscribe the Operator must have an Operator group that matches the install mode of the Operator, either the <code class="literal">AllNamespaces</code> or <code class="literal">SingleNamespace</code> mode. If the Operator you intend to install uses the <code class="literal">AllNamespaces</code> mode, then the <code class="literal">openshift-operators</code> namespace already has an appropriate Operator group in place.
						</p><p class="simpara">
							However, if the Operator uses the <code class="literal">SingleNamespace</code> mode and you do not already have an appropriate Operator group in place, you must create one:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create an <code class="literal">OperatorGroup</code> object YAML file, for example <code class="literal">operatorgroup.yaml</code>:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">OperatorGroup</code> object</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: &lt;operatorgroup_name&gt;
  namespace: &lt;namespace&gt;
spec:
  targetNamespaces:
  - &lt;namespace&gt;</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">OperatorGroup</code> object:
								</p><pre class="programlisting language-terminal">$ oc apply -f operatorgroup.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">Subscription</code> object YAML file that subscribes a namespace to an Operator with a specific version by setting the <code class="literal">startingCSV</code> field. Set the <code class="literal">installPlanApproval</code> field to <code class="literal">Manual</code> to prevent the Operator from automatically upgrading if a later version exists in the catalog.
						</p><p class="simpara">
							For example, the following <code class="literal">sub.yaml</code> file can be used to install the Red Hat Quay Operator specifically to version 3.7.10:
						</p><div class="formalpara"><p class="title"><strong>Subscription with a specific starting Operator version</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: quay-operator
  namespace: quay
spec:
  channel: quay-operator.v3.7.10
  installPlanApproval: Manual <span id="CO13-1"><!--Empty--></span><span class="callout">1</span>
  name: quay-operator
  source: redhat-operators
  sourceNamespace: openshift-marketplace
  startingCSV: quay-operator.v3.7.10 <span id="CO13-2"><!--Empty--></span><span class="callout">2</span></pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO13-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Set the approval strategy to <code class="literal">Manual</code> in case your specified version is superseded by a later version in the catalog. This plan prevents an automatic upgrade to a later version and requires manual approval before the starting CSV can complete the installation.
								</div></dd><dt><a href="#CO13-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Set a specific version of an Operator CSV.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">Subscription</code> object:
						</p><pre class="programlisting language-terminal">$ oc apply -f sub.yaml</pre></li><li class="listitem">
							Manually approve the pending install plan to complete the Operator installation.
						</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-approving-pending-upgrade_olm-upgrading-operators">Manually approving a pending Operator update</a>
						</li></ul></div></section></section></section><section class="chapter" id="administrator-tasks"><div class="titlepage"><div><div><h1 class="title">Chapter 4. Administrator tasks</h1></div></div></div><section class="section" id="olm-adding-operators-to-a-cluster"><div class="titlepage"><div><div><h2 class="title">4.1. Adding Operators to a cluster</h2></div></div></div><p>
				Using Operator Lifecycle Manager (OLM), cluster administrators can install OLM-based Operators to an OpenShift Container Platform cluster.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					For information on how OLM handles updates for installed Operators colocated in the same namespace, as well as an alternative method for installing Operators with custom global Operator groups, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-colocation">Multitenancy and Operator colocation</a>.
				</p></div></div><section class="section" id="olm-installing-operators-from-operatorhub_olm-adding-operators-to-a-cluster"><div class="titlepage"><div><div><h3 class="title">4.1.1. About Operator installation with OperatorHub</h3></div></div></div><p>
					OperatorHub is a user interface for discovering Operators; it works in conjunction with Operator Lifecycle Manager (OLM), which installs and manages Operators on a cluster.
				</p><p>
					As a user with the proper permissions, you can install an Operator from OperatorHub by using the OpenShift Container Platform web console or CLI.
				</p><p>
					During installation, you must determine the following initial settings for the Operator:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Installation Mode</span></dt><dd>
								Choose a specific namespace in which to install the Operator.
							</dd><dt><span class="term">Update Channel</span></dt><dd>
								If an Operator is available through multiple channels, you can choose which channel you want to subscribe to. For example, to deploy from the <span class="strong strong"><strong>stable</strong></span> channel, if available, select it from the list.
							</dd><dt><span class="term">Approval Strategy</span></dt><dd><p class="simpara">
								You can choose automatic or manual updates.
							</p><p class="simpara">
								If you choose automatic updates for an installed Operator, when a new version of that Operator is available in the selected channel, Operator Lifecycle Manager (OLM) automatically upgrades the running instance of your Operator without human intervention.
							</p><p class="simpara">
								If you select manual updates, when a newer version of an Operator is available, OLM creates an update request. As a cluster administrator, you must then manually approve that update request to have the Operator updated to the new version.
							</p></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-understanding-operatorhub">Understanding OperatorHub</a>
						</li></ul></div></section><section class="section" id="olm-installing-from-operatorhub-using-web-console_olm-adding-operators-to-a-cluster"><div class="titlepage"><div><div><h3 class="title">4.1.2. Installing from OperatorHub using the web console</h3></div></div></div><p>
					You can install and subscribe to an Operator from OperatorHub by using the OpenShift Container Platform web console.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Access to an OpenShift Container Platform cluster using an account with <code class="literal">cluster-admin</code> permissions.
						</li><li class="listitem">
							Access to an OpenShift Container Platform cluster using an account with Operator installation permissions.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Navigate in the web console to the <span class="strong strong"><strong>Operators → OperatorHub</strong></span> page.
						</li><li class="listitem"><p class="simpara">
							Scroll or type a keyword into the <span class="strong strong"><strong>Filter by keyword</strong></span> box to find the Operator you want. For example, type <code class="literal">advanced</code> to find the Advanced Cluster Management for Kubernetes Operator.
						</p><p class="simpara">
							You can also filter options by <span class="strong strong"><strong>Infrastructure Features</strong></span>. For example, select <span class="strong strong"><strong>Disconnected</strong></span> if you want to see Operators that work in disconnected environments, also known as restricted network environments.
						</p></li><li class="listitem"><p class="simpara">
							Select the Operator to display additional information.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Choosing a Community Operator warns that Red Hat does not certify Community Operators; you must acknowledge the warning before continuing.
							</p></div></div></li><li class="listitem">
							Read the information about the Operator and click <span class="strong strong"><strong>Install</strong></span>.
						</li><li class="listitem"><p class="simpara">
							On the <span class="strong strong"><strong>Install Operator</strong></span> page:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Select one of the following:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<span class="strong strong"><strong>All namespaces on the cluster (default)</strong></span> installs the Operator in the default <code class="literal">openshift-operators</code> namespace to watch and be made available to all namespaces in the cluster. This option is not always available.
										</li><li class="listitem">
											<span class="strong strong"><strong>A specific namespace on the cluster</strong></span> allows you to choose a specific, single namespace in which to install the Operator. The Operator will only watch and be made available for use in this single namespace.
										</li></ul></div></li><li class="listitem">
									Choose a specific, single namespace in which to install the Operator. The Operator will only watch and be made available for use in this single namespace.
								</li><li class="listitem">
									Select an <span class="strong strong"><strong>Update channel</strong></span> (if more than one is available).
								</li><li class="listitem">
									Select <span class="strong strong"><strong>Automatic</strong></span> or <span class="strong strong"><strong>Manual</strong></span> approval strategy, as described earlier.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Install</strong></span> to make the Operator available to the selected namespaces on this OpenShift Container Platform cluster.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									If you selected a <span class="strong strong"><strong>Manual</strong></span> approval strategy, the upgrade status of the subscription remains <span class="strong strong"><strong>Upgrading</strong></span> until you review and approve the install plan.
								</p><p class="simpara">
									After approving on the <span class="strong strong"><strong>Install Plan</strong></span> page, the subscription upgrade status moves to <span class="strong strong"><strong>Up to date</strong></span>.
								</p></li><li class="listitem">
									If you selected an <span class="strong strong"><strong>Automatic</strong></span> approval strategy, the upgrade status should resolve to <span class="strong strong"><strong>Up to date</strong></span> without intervention.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							After the upgrade status of the subscription is <span class="strong strong"><strong>Up to date</strong></span>, select <span class="strong strong"><strong>Operators → Installed Operators</strong></span> to verify that the cluster service version (CSV) of the installed Operator eventually shows up. The <span class="strong strong"><strong>Status</strong></span> should ultimately resolve to <span class="strong strong"><strong>InstallSucceeded</strong></span> in the relevant namespace.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								For the <span class="strong strong"><strong>All namespaces…​</strong></span> installation mode, the status resolves to <span class="strong strong"><strong>InstallSucceeded</strong></span> in the <code class="literal">openshift-operators</code> namespace, but the status is <span class="strong strong"><strong>Copied</strong></span> if you check in other namespaces.
							</p></div></div><p class="simpara">
							If it does not:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Check the logs in any pods in the <code class="literal">openshift-operators</code> project (or other relevant namespace if <span class="strong strong"><strong>A specific namespace…​</strong></span> installation mode was selected) on the <span class="strong strong"><strong>Workloads → Pods</strong></span> page that are reporting issues to troubleshoot further.
								</li></ol></div></li></ol></div></section><section class="section" id="olm-installing-operator-from-operatorhub-using-cli_olm-adding-operators-to-a-cluster"><div class="titlepage"><div><div><h3 class="title">4.1.3. Installing from OperatorHub using the CLI</h3></div></div></div><p>
					Instead of using the OpenShift Container Platform web console, you can install an Operator from OperatorHub by using the CLI. Use the <code class="literal">oc</code> command to create or update a <code class="literal">Subscription</code> object.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Access to an OpenShift Container Platform cluster using an account with Operator installation permissions.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							View the list of Operators available to the cluster from OperatorHub:
						</p><pre class="programlisting language-terminal">$ oc get packagemanifests -n openshift-marketplace</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                               CATALOG               AGE
3scale-operator                    Red Hat Operators     91m
advanced-cluster-management        Red Hat Operators     91m
amq7-cert-manager                  Red Hat Operators     91m
...
couchbase-enterprise-certified     Certified Operators   91m
crunchy-postgres-operator          Certified Operators   91m
mongodb-enterprise                 Certified Operators   91m
...
etcd                               Community Operators   91m
jaeger                             Community Operators   91m
kubefed                            Community Operators   91m
...</pre>

							</p></div><p class="simpara">
							Note the catalog for your desired Operator.
						</p></li><li class="listitem"><p class="simpara">
							Inspect your desired Operator to verify its supported install modes and available channels:
						</p><pre class="programlisting language-terminal">$ oc describe packagemanifests &lt;operator_name&gt; -n openshift-marketplace</pre></li><li class="listitem"><p class="simpara">
							An Operator group, defined by an <code class="literal">OperatorGroup</code> object, selects target namespaces in which to generate required RBAC access for all Operators in the same namespace as the Operator group.
						</p><p class="simpara">
							The namespace to which you subscribe the Operator must have an Operator group that matches the install mode of the Operator, either the <code class="literal">AllNamespaces</code> or <code class="literal">SingleNamespace</code> mode. If the Operator you intend to install uses the <code class="literal">AllNamespaces</code>, then the <code class="literal">openshift-operators</code> namespace already has an appropriate Operator group in place.
						</p><p class="simpara">
							However, if the Operator uses the <code class="literal">SingleNamespace</code> mode and you do not already have an appropriate Operator group in place, you must create one.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The web console version of this procedure handles the creation of the <code class="literal">OperatorGroup</code> and <code class="literal">Subscription</code> objects automatically behind the scenes for you when choosing <code class="literal">SingleNamespace</code> mode.
							</p></div></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create an <code class="literal">OperatorGroup</code> object YAML file, for example <code class="literal">operatorgroup.yaml</code>:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">OperatorGroup</code> object</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: &lt;operatorgroup_name&gt;
  namespace: &lt;namespace&gt;
spec:
  targetNamespaces:
  - &lt;namespace&gt;</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">OperatorGroup</code> object:
								</p><pre class="programlisting language-terminal">$ oc apply -f operatorgroup.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">Subscription</code> object YAML file to subscribe a namespace to an Operator, for example <code class="literal">sub.yaml</code>:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">Subscription</code> object</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: &lt;subscription_name&gt;
  namespace: openshift-operators <span id="CO14-1"><!--Empty--></span><span class="callout">1</span>
spec:
  channel: &lt;channel_name&gt; <span id="CO14-2"><!--Empty--></span><span class="callout">2</span>
  name: &lt;operator_name&gt; <span id="CO14-3"><!--Empty--></span><span class="callout">3</span>
  source: redhat-operators <span id="CO14-4"><!--Empty--></span><span class="callout">4</span>
  sourceNamespace: openshift-marketplace <span id="CO14-5"><!--Empty--></span><span class="callout">5</span>
  config:
    env: <span id="CO14-6"><!--Empty--></span><span class="callout">6</span>
    - name: ARGS
      value: "-v=10"
    envFrom: <span id="CO14-7"><!--Empty--></span><span class="callout">7</span>
    - secretRef:
        name: license-secret
    volumes: <span id="CO14-8"><!--Empty--></span><span class="callout">8</span>
    - name: &lt;volume_name&gt;
      configMap:
        name: &lt;configmap_name&gt;
    volumeMounts: <span id="CO14-9"><!--Empty--></span><span class="callout">9</span>
    - mountPath: &lt;directory_name&gt;
      name: &lt;volume_name&gt;
    tolerations: <span id="CO14-10"><!--Empty--></span><span class="callout">10</span>
    - operator: "Exists"
    resources: <span id="CO14-11"><!--Empty--></span><span class="callout">11</span>
      requests:
        memory: "64Mi"
        cpu: "250m"
      limits:
        memory: "128Mi"
        cpu: "500m"
    nodeSelector: <span id="CO14-12"><!--Empty--></span><span class="callout">12</span>
      foo: bar</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO14-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									For default <code class="literal">AllNamespaces</code> install mode usage, specify the <code class="literal">openshift-operators</code> namespace. Alternatively, you can specify a custom global namespace, if you have created one. Otherwise, specify the relevant single namespace for <code class="literal">SingleNamespace</code> install mode usage.
								</div></dd><dt><a href="#CO14-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Name of the channel to subscribe to.
								</div></dd><dt><a href="#CO14-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Name of the Operator to subscribe to.
								</div></dd><dt><a href="#CO14-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									Name of the catalog source that provides the Operator.
								</div></dd><dt><a href="#CO14-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									Namespace of the catalog source. Use <code class="literal">openshift-marketplace</code> for the default OperatorHub catalog sources.
								</div></dd><dt><a href="#CO14-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									The <code class="literal">env</code> parameter defines a list of Environment Variables that must exist in all containers in the pod created by OLM.
								</div></dd><dt><a href="#CO14-7"><span class="callout">7</span></a> </dt><dd><div class="para">
									The <code class="literal">envFrom</code> parameter defines a list of sources to populate Environment Variables in the container.
								</div></dd><dt><a href="#CO14-8"><span class="callout">8</span></a> </dt><dd><div class="para">
									The <code class="literal">volumes</code> parameter defines a list of Volumes that must exist on the pod created by OLM.
								</div></dd><dt><a href="#CO14-9"><span class="callout">9</span></a> </dt><dd><div class="para">
									The <code class="literal">volumeMounts</code> parameter defines a list of VolumeMounts that must exist in all containers in the pod created by OLM. If a <code class="literal">volumeMount</code> references a <code class="literal">volume</code> that does not exist, OLM fails to deploy the Operator.
								</div></dd><dt><a href="#CO14-10"><span class="callout">10</span></a> </dt><dd><div class="para">
									The <code class="literal">tolerations</code> parameter defines a list of Tolerations for the pod created by OLM.
								</div></dd><dt><a href="#CO14-11"><span class="callout">11</span></a> </dt><dd><div class="para">
									The <code class="literal">resources</code> parameter defines resource constraints for all the containers in the pod created by OLM.
								</div></dd><dt><a href="#CO14-12"><span class="callout">12</span></a> </dt><dd><div class="para">
									The <code class="literal">nodeSelector</code> parameter defines a <code class="literal">NodeSelector</code> for the pod created by OLM.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">Subscription</code> object:
						</p><pre class="programlisting language-terminal">$ oc apply -f sub.yaml</pre><p class="simpara">
							At this point, OLM is now aware of the selected Operator. A cluster service version (CSV) for the Operator should appear in the target namespace, and APIs provided by the Operator should be available for creation.
						</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-operatorgroups-about_olm-understanding-operatorgroups">About Operator groups</a>
						</li></ul></div></section><section class="section" id="olm-installing-specific-version-cli_olm-adding-operators-to-a-cluster"><div class="titlepage"><div><div><h3 class="title">4.1.4. Installing a specific version of an Operator</h3></div></div></div><p>
					You can install a specific version of an Operator by setting the cluster service version (CSV) in a <code class="literal">Subscription</code> object.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Access to an OpenShift Container Platform cluster using an account with Operator installation permissions.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Look up the available versions and channels of the Operator you want to install by running the following command:
						</p><div class="formalpara"><p class="title"><strong>Command syntax</strong></p><p>
								
<pre class="programlisting language-terminal">$ oc describe packagemanifests &lt;operator_name&gt; -n &lt;catalog_namespace&gt;</pre>

							</p></div><p class="simpara">
							For example, the following command prints the available channels and versions of the Red Hat Quay Operator from OperatorHub:
						</p><div class="formalpara"><p class="title"><strong>Example command</strong></p><p>
								
<pre class="programlisting language-terminal">$ oc describe packagemanifests quay-operator -n openshift-marketplace</pre>

							</p></div><div class="example" id="idm139731978823840"><p class="title"><strong>Example 4.1. Example output</strong></p><div class="example-contents"><pre class="programlisting language-text">Name:         quay-operator
Namespace:    operator-marketplace
Labels:       catalog=redhat-operators
              catalog-namespace=openshift-marketplace
              hypershift.openshift.io/managed=true
              operatorframework.io/arch.amd64=supported
              operatorframework.io/os.linux=supported
              provider=Red Hat
              provider-url=
Annotations:  &lt;none&gt;
API Version:  packages.operators.coreos.com/v1
Kind:         PackageManifest
...
    Current CSV:  quay-operator.v3.7.11
...
    Entries:
      Name:       quay-operator.v3.7.11
      Version:    3.7.11
      Name:       quay-operator.v3.7.10
      Version:    3.7.10
      Name:       quay-operator.v3.7.9
      Version:    3.7.9
      Name:       quay-operator.v3.7.8
      Version:    3.7.8
      Name:       quay-operator.v3.7.7
      Version:    3.7.7
      Name:       quay-operator.v3.7.6
      Version:    3.7.6
      Name:       quay-operator.v3.7.5
      Version:    3.7.5
      Name:       quay-operator.v3.7.4
      Version:    3.7.4
      Name:       quay-operator.v3.7.3
      Version:    3.7.3
      Name:       quay-operator.v3.7.2
      Version:    3.7.2
      Name:       quay-operator.v3.7.1
      Version:    3.7.1
      Name:       quay-operator.v3.7.0
      Version:    3.7.0
    Name:         stable-3.7
...
   Current CSV:  quay-operator.v3.8.5
...
   Entries:
      Name:         quay-operator.v3.8.5
      Version:      3.8.5
      Name:         quay-operator.v3.8.4
      Version:      3.8.4
      Name:         quay-operator.v3.8.3
      Version:      3.8.3
      Name:         quay-operator.v3.8.2
      Version:      3.8.2
      Name:         quay-operator.v3.8.1
      Version:      3.8.1
      Name:         quay-operator.v3.8.0
      Version:      3.8.0
    Name:           stable-3.8
  Default Channel:  stable-3.8
  Package Name:     quay-operator</pre></div></div><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
							You can print an Operator’s version and channel information in the YAML format by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get packagemanifests &lt;operator_name&gt; -n &lt;catalog_namespace&gt; -o yaml</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									If more than one catalog is installed in a namespace, run the following command to look up the available versions and channels of an Operator from a specific catalog:
								</p><pre class="programlisting language-terminal">$ oc get packagemanifest \
   --selector=catalog=&lt;catalogsource_name&gt; \
   --field-selector metadata.name=&lt;operator_name&gt; \
   -n &lt;catalog_namespace&gt; -o yaml</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
										If you do not specify the Operator’s catalog, running the <code class="literal">oc get packagemanifest</code> and <code class="literal">oc describe packagemanifest</code> commands might return a package from an unexpected catalog if the following conditions are met:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												Multiple catalogs are installed in the same namespace.
											</li><li class="listitem">
												The catalogs contain the same Operators or Operators with the same name.
											</li></ul></div></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							An Operator group, defined by an <code class="literal">OperatorGroup</code> object, selects target namespaces in which to generate required role-based access control (RBAC) access for all Operators in the same namespace as the Operator group.
						</p><p class="simpara">
							The namespace to which you subscribe the Operator must have an Operator group that matches the install mode of the Operator, either the <code class="literal">AllNamespaces</code> or <code class="literal">SingleNamespace</code> mode. If the Operator you intend to install uses the <code class="literal">AllNamespaces</code> mode, then the <code class="literal">openshift-operators</code> namespace already has an appropriate Operator group in place.
						</p><p class="simpara">
							However, if the Operator uses the <code class="literal">SingleNamespace</code> mode and you do not already have an appropriate Operator group in place, you must create one:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create an <code class="literal">OperatorGroup</code> object YAML file, for example <code class="literal">operatorgroup.yaml</code>:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">OperatorGroup</code> object</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: &lt;operatorgroup_name&gt;
  namespace: &lt;namespace&gt;
spec:
  targetNamespaces:
  - &lt;namespace&gt;</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Create the <code class="literal">OperatorGroup</code> object:
								</p><pre class="programlisting language-terminal">$ oc apply -f operatorgroup.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">Subscription</code> object YAML file that subscribes a namespace to an Operator with a specific version by setting the <code class="literal">startingCSV</code> field. Set the <code class="literal">installPlanApproval</code> field to <code class="literal">Manual</code> to prevent the Operator from automatically upgrading if a later version exists in the catalog.
						</p><p class="simpara">
							For example, the following <code class="literal">sub.yaml</code> file can be used to install the Red Hat Quay Operator specifically to version 3.7.10:
						</p><div class="formalpara"><p class="title"><strong>Subscription with a specific starting Operator version</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: quay-operator
  namespace: quay
spec:
  channel: quay-operator.v3.7.10
  installPlanApproval: Manual <span id="CO15-1"><!--Empty--></span><span class="callout">1</span>
  name: quay-operator
  source: redhat-operators
  sourceNamespace: openshift-marketplace
  startingCSV: quay-operator.v3.7.10 <span id="CO15-2"><!--Empty--></span><span class="callout">2</span></pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO15-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Set the approval strategy to <code class="literal">Manual</code> in case your specified version is superseded by a later version in the catalog. This plan prevents an automatic upgrade to a later version and requires manual approval before the starting CSV can complete the installation.
								</div></dd><dt><a href="#CO15-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Set a specific version of an Operator CSV.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">Subscription</code> object:
						</p><pre class="programlisting language-terminal">$ oc apply -f sub.yaml</pre></li><li class="listitem">
							Manually approve the pending install plan to complete the Operator installation.
						</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-approving-pending-upgrade_olm-upgrading-operators">Manually approving a pending Operator update</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-installing-global-namespaces_olm-adding-operators-to-a-cluster">Installing global Operators in custom namespaces</a>
						</li></ul></div></section><section class="section" id="olm-preparing-operators-multitenant_olm-adding-operators-to-a-cluster"><div class="titlepage"><div><div><h3 class="title">4.1.5. Preparing for multiple instances of an Operator for multitenant clusters</h3></div></div></div><p>
					As a cluster administrator, you can add multiple instances of an Operator for use in multitenant clusters. This is an alternative solution to either using the standard <span class="strong strong"><strong>All namespaces</strong></span> install mode, which can be considered to violate the principle of least privilege, or the <span class="strong strong"><strong>Multinamespace</strong></span> mode, which is not widely adopted. For more information, see "Operators in multitenant clusters".
				</p><p>
					In the following procedure, the <span class="emphasis"><em>tenant</em></span> is a user or group of users that share common access and privileges for a set of deployed workloads. The <span class="emphasis"><em>tenant Operator</em></span> is the instance of an Operator that is intended for use by only that tenant.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							All instances of the Operator you want to install must be the same version across a given cluster.
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								For more information on this and other limitations, see "Operators in multitenant clusters".
							</p></div></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Before installing the Operator, create a namespace for the tenant Operator that is separate from the tenant’s namespace. For example, if the tenant’s namespace is <code class="literal">team1</code>, you might create a <code class="literal">team1-operator</code> namespace:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Define a <code class="literal">Namespace</code> resource and save the YAML file, for example, <code class="literal">team1-operator.yaml</code>:
								</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Namespace
metadata:
  name: team1-operator</pre></li><li class="listitem"><p class="simpara">
									Create the namespace by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f team1-operator.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create an Operator group for the tenant Operator scoped to the tenant’s namespace, with only that one namespace entry in the <code class="literal">spec.targetNamespaces</code> list:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Define an <code class="literal">OperatorGroup</code> resource and save the YAML file, for example, <code class="literal">team1-operatorgroup.yaml</code>:
								</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: team1-operatorgroup
  namespace: team1-operator
spec:
  targetNamespaces:
  - team1 <span id="CO16-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO16-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Define only the tenant’s namespace in the <code class="literal">spec.targetNamespaces</code> list.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Create the Operator group by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f team1-operatorgroup.yaml</pre></li></ol></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Next steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Install the Operator in the tenant Operator namespace. This task is more easily performed by using the OperatorHub in the web console instead of the CLI; for a detailed procedure, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-installing-from-operatorhub-using-web-console_olm-adding-operators-to-a-cluster">Installing from OperatorHub using the web console</a>.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								After completing the Operator installation, the Operator resides in the tenant Operator namespace and watches the tenant namespace, but neither the Operator’s pod nor its service account are visible or usable by the tenant.
							</p></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-multitenancy">Operators in multitenant clusters</a>
						</li></ul></div></section><section class="section" id="olm-installing-global-namespaces_olm-adding-operators-to-a-cluster"><div class="titlepage"><div><div><h3 class="title">4.1.6. Installing global Operators in custom namespaces</h3></div></div></div><p>
					When installing Operators with the OpenShift Container Platform web console, the default behavior installs Operators that support the <span class="strong strong"><strong>All namespaces</strong></span> install mode into the default <code class="literal">openshift-operators</code> global namespace. This can cause issues related to shared install plans and update policies between all Operators in the namespace. For more details on these limitations, see "Multitenancy and Operator colocation".
				</p><p>
					As a cluster administrator, you can bypass this default behavior manually by creating a custom global namespace and using that namespace to install your individual or scoped set of Operators and their dependencies.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Before installing the Operator, create a namespace for the installation of your desired Operator. This installation namespace will become the custom global namespace:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Define a <code class="literal">Namespace</code> resource and save the YAML file, for example, <code class="literal">global-operators.yaml</code>:
								</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Namespace
metadata:
  name: global-operators</pre></li><li class="listitem"><p class="simpara">
									Create the namespace by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f global-operators.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create a custom <span class="emphasis"><em>global Operator group</em></span>, which is an Operator group that watches all namespaces:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Define an <code class="literal">OperatorGroup</code> resource and save the YAML file, for example, <code class="literal">global-operatorgroup.yaml</code>. Omit both the <code class="literal">spec.selector</code> and <code class="literal">spec.targetNamespaces</code> fields to make it a <span class="emphasis"><em>global Operator group</em></span>, which selects all namespaces:
								</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: global-operatorgroup
  namespace: global-operators</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										The <code class="literal">status.namespaces</code> of a created global Operator group contains the empty string (<code class="literal">""</code>), which signals to a consuming Operator that it should watch all namespaces.
									</p></div></div></li><li class="listitem"><p class="simpara">
									Create the Operator group by running the following command:
								</p><pre class="programlisting language-terminal">$ oc create -f global-operatorgroup.yaml</pre></li></ol></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Next steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Install the desired Operator in your custom global namespace. Because the web console does not populate the <span class="strong strong"><strong>Installed Namespace</strong></span> menu during Operator installation with custom global namespaces, this task can only be performed with the OpenShift CLI (<code class="literal">oc</code>). For a detailed procedure, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-installing-operator-from-operatorhub-using-cli_olm-adding-operators-to-a-cluster">Installing from OperatorHub using the CLI</a>.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								When you initiate the Operator installation, if the Operator has dependencies, the dependencies are also automatically installed in the custom global namespace. As a result, it is then valid for the dependency Operators to have the same update policy and shared install plans.
							</p></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-colocation">Multitenancy and Operator colocation</a>
						</li></ul></div></section><section class="section" id="olm-pod-placement_olm-adding-operators-to-a-cluster"><div class="titlepage"><div><div><h3 class="title">4.1.7. Pod placement of Operator workloads</h3></div></div></div><p>
					By default, Operator Lifecycle Manager (OLM) places pods on arbitrary worker nodes when installing an Operator or deploying Operand workloads. As an administrator, you can use projects with a combination of node selectors, taints, and tolerations to control the placement of Operators and Operands to specific nodes.
				</p><p>
					Controlling pod placement of Operator and Operand workloads has the following prerequisites:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Determine a node or set of nodes to target for the pods per your requirements. If available, note an existing label, such as <code class="literal">node-role.kubernetes.io/app</code>, that identifies the node or nodes. Otherwise, add a label, such as <code class="literal">myoperator</code>, by using a compute machine set or editing the node directly. You will use this label in a later step as the node selector on your project.
						</li><li class="listitem">
							If you want to ensure that only pods with a certain label are allowed to run on the nodes, while steering unrelated workloads to other nodes, add a taint to the node or nodes by using a compute machine set or editing the node directly. Use an effect that ensures that new pods that do not match the taint cannot be scheduled on the nodes. For example, a <code class="literal">myoperator:NoSchedule</code> taint ensures that new pods that do not match the taint are not scheduled onto that node, but existing pods on the node are allowed to remain.
						</li><li class="listitem">
							Create a project that is configured with a default node selector and, if you added a taint, a matching toleration.
						</li></ol></div><p>
					At this point, the project you created can be used to steer pods towards the specified nodes in the following scenarios:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">For Operator pods</span></dt><dd>
								Administrators can create a <code class="literal">Subscription</code> object in the project as described in the following section. As a result, the Operator pods are placed on the specified nodes.
							</dd><dt><span class="term">For Operand pods</span></dt><dd>
								Using an installed Operator, users can create an application in the project, which places the custom resource (CR) owned by the Operator in the project. As a result, the Operand pods are placed on the specified nodes, unless the Operator is deploying cluster-wide objects or resources in other namespaces, in which case this customized pod placement does not apply.
							</dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							Adding taints and tolerations <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-scheduler-taints-tolerations-adding_nodes-scheduler-taints-tolerations">manually to nodes</a> or <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-scheduler-taints-tolerations-adding-machineset_nodes-scheduler-taints-tolerations">with compute machine sets</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-scheduler-node-selectors-project_nodes-scheduler-node-selectors">Creating project-wide node selectors</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-scheduler-taints-tolerations-projects_nodes-scheduler-taints-tolerations">Creating a project with a node selector and toleration</a>
						</li></ul></div></section><section class="section" id="olm-overriding-operator-pod-affinity_olm-adding-operators-to-a-cluster"><div class="titlepage"><div><div><h3 class="title">4.1.8. Controlling where an Operator is installed</h3></div></div></div><p>
					By default, when you install an Operator, OpenShift Container Platform installs the Operator pod to one of your worker nodes randomly. However, there might be situations where you want that pod scheduled on a specific node or set of nodes.
				</p><p>
					The following examples describe situations where you might want to schedule an Operator pod to a specific node or set of nodes:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If an Operator requires a particular platform, such as <code class="literal">amd64</code> or <code class="literal">arm64</code>
						</li><li class="listitem">
							If an Operator requires a particular operating system, such as Linux or Windows
						</li><li class="listitem">
							If you want Operators that work together scheduled on the same host or on hosts located on the same rack
						</li><li class="listitem">
							If you want Operators dispersed throughout the infrastructure to avoid downtime due to network or hardware issues
						</li></ul></div><p>
					You can control where an Operator pod is installed by adding node affinity, pod affinity, or pod anti-affinity constraints to the Operator’s <code class="literal">Subscription</code> object. Node affinity is a set of rules used by the scheduler to determine where a pod can be placed. Pod affinity enables you to ensure that related pods are scheduled to the same node. Pod anti-affinity allows you to prevent a pod from being scheduled on a node.
				</p><p>
					The following examples show how to use node affinity or pod anti-affinity to install an instance of the Custom Metrics Autoscaler Operator to a specific node in the cluster:
				</p><div class="formalpara"><p class="title"><strong>Node affinity example that places the Operator pod on a specific node</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: openshift-custom-metrics-autoscaler-operator
  namespace: openshift-keda
spec:
  name: my-package
  source: my-operators
  sourceNamespace: operator-registries
  config:
    affinity:
      nodeAffinity: <span id="CO17-1"><!--Empty--></span><span class="callout">1</span>
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
          - matchExpressions:
            - key: kubernetes.io/hostname
              operator: In
              values:
              - ip-10-0-163-94.us-west-2.compute.internal
#...</pre>

					</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO17-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							A node affinity that requires the Operator’s pod to be scheduled on a node named <code class="literal">ip-10-0-163-94.us-west-2.compute.internal</code>.
						</div></dd></dl></div><div class="formalpara"><p class="title"><strong>Node affinity example that places the Operator pod on a node with a specific platform</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: openshift-custom-metrics-autoscaler-operator
  namespace: openshift-keda
spec:
  name: my-package
  source: my-operators
  sourceNamespace: operator-registries
  config:
    affinity:
      nodeAffinity: <span id="CO18-1"><!--Empty--></span><span class="callout">1</span>
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
          - matchExpressions:
            - key: kubernetes.io/arch
              operator: In
              values:
              - arm64
            - key: kubernetes.io/os
              operator: In
              values:
              - linux
#...</pre>

					</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO18-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							A node affinity that requires the Operator’s pod to be scheduled on a node with the <code class="literal">kubernetes.io/arch=arm64</code> and <code class="literal">kubernetes.io/os=linux</code> labels.
						</div></dd></dl></div><div class="formalpara"><p class="title"><strong>Pod affinity example that places the Operator pod on one or more specific nodes</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: openshift-custom-metrics-autoscaler-operator
  namespace: openshift-keda
spec:
  name: my-package
  source: my-operators
  sourceNamespace: operator-registries
  config:
    affinity:
      podAffinity: <span id="CO19-1"><!--Empty--></span><span class="callout">1</span>
        requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
            - key: app
              operator: In
              values:
              - test
          topologyKey: kubernetes.io/hostname
#...</pre>

					</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO19-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							A pod affinity that places the Operator’s pod on a node that has pods with the <code class="literal">app=test</code> label.
						</div></dd></dl></div><div class="formalpara"><p class="title"><strong>Pod anti-affinity example that prevents the Operator pod from one or more specific nodes</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: openshift-custom-metrics-autoscaler-operator
  namespace: openshift-keda
spec:
  name: my-package
  source: my-operators
  sourceNamespace: operator-registries
  config:
    affinity:
      podAntiAffinity: <span id="CO20-1"><!--Empty--></span><span class="callout">1</span>
        requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
            - key: cpu
              operator: In
              values:
              - high
          topologyKey: kubernetes.io/hostname
#...</pre>

					</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO20-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							A pod anti-affinity that prevents the Operator’s pod from being scheduled on a node that has pods with the <code class="literal">cpu=high</code> label.
						</div></dd></dl></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						To control the placement of an Operator pod, complete the following steps:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Install the Operator as usual.
						</li><li class="listitem">
							If needed, ensure that your nodes are labeled to properly respond to the affinity.
						</li><li class="listitem"><p class="simpara">
							Edit the Operator <code class="literal">Subscription</code> object to add an affinity:
						</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: openshift-custom-metrics-autoscaler-operator
  namespace: openshift-keda
spec:
  name: my-package
  source: my-operators
  sourceNamespace: operator-registries
  config:
    affinity: <span id="CO21-1"><!--Empty--></span><span class="callout">1</span>
      nodeAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
          - matchExpressions:
            - key: kubernetes.io/hostname
              operator: In
              values:
              - ip-10-0-185-229.ec2.internal
#...</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO21-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Add a <code class="literal">nodeAffinity</code>, <code class="literal">podAffinity</code>, or <code class="literal">podAntiAffinity</code>. See the Additional resources section that follows for information about creating the affinity.
								</div></dd></dl></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To ensure that the pod is deployed on the specific node, run the following command:
						</p><pre class="programlisting language-yaml">$ oc get pods -o wide</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                                                  READY   STATUS    RESTARTS   AGE   IP            NODE                           NOMINATED NODE   READINESS GATES
custom-metrics-autoscaler-operator-5dcc45d656-bhshg   1/1     Running   0          50s   10.131.0.20   ip-10-0-185-229.ec2.internal   &lt;none&gt;           &lt;none&gt;</pre>

							</p></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-scheduler-pod-affinity-about_nodes-scheduler-pod-affinity">Understanding pod affinity</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-scheduler-node-affinity-about_nodes-scheduler-node-affinity">Understanding node affinity</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-nodes-working-updating_nodes-nodes-working">Understanding how to update labels on nodes</a>
						</li></ul></div></section></section><section class="section" id="olm-upgrading-operators"><div class="titlepage"><div><div><h2 class="title">4.2. Updating installed Operators</h2></div></div></div><p>
				As a cluster administrator, you can update Operators that have been previously installed using Operator Lifecycle Manager (OLM) on your OpenShift Container Platform cluster.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					For information on how OLM handles updates for installed Operators colocated in the same namespace, as well as an alternative method for installing Operators with custom global Operator groups, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-colocation">Multitenancy and Operator colocation</a>.
				</p></div></div><section class="section" id="olm-preparing-upgrade_olm-upgrading-operators"><div class="titlepage"><div><div><h3 class="title">4.2.1. Preparing for an Operator update</h3></div></div></div><p>
					The subscription of an installed Operator specifies an update channel that tracks and receives updates for the Operator. You can change the update channel to start tracking and receiving updates from a newer channel.
				</p><p>
					The names of update channels in a subscription can differ between Operators, but the naming scheme typically follows a common convention within a given Operator. For example, channel names might follow a minor release update stream for the application provided by the Operator (<code class="literal">1.2</code>, <code class="literal">1.3</code>) or a release frequency (<code class="literal">stable</code>, <code class="literal">fast</code>).
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						You cannot change installed Operators to a channel that is older than the current channel.
					</p></div></div><p>
					Red Hat Customer Portal Labs include the following application that helps administrators prepare to update their Operators:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/labs/ocpouic/">Red Hat OpenShift Container Platform Operator Update Information Checker</a>
						</li></ul></div><p>
					You can use the application to search for Operator Lifecycle Manager-based Operators and verify the available Operator version per update channel across different versions of OpenShift Container Platform. Cluster Version Operator-based Operators are not included.
				</p></section><section class="section" id="olm-changing-update-channel_olm-upgrading-operators"><div class="titlepage"><div><div><h3 class="title">4.2.2. Changing the update channel for an Operator</h3></div></div></div><p>
					You can change the update channel for an Operator by using the OpenShift Container Platform web console.
				</p><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
					If the approval strategy in the subscription is set to <span class="strong strong"><strong>Automatic</strong></span>, the update process initiates as soon as a new Operator version is available in the selected channel. If the approval strategy is set to <span class="strong strong"><strong>Manual</strong></span>, you must manually approve pending updates.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							An Operator previously installed using Operator Lifecycle Manager (OLM).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the <span class="strong strong"><strong>Administrator</strong></span> perspective of the web console, navigate to <span class="strong strong"><strong>Operators → Installed Operators</strong></span>.
						</li><li class="listitem">
							Click the name of the Operator you want to change the update channel for.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Subscription</strong></span> tab.
						</li><li class="listitem">
							Click the name of the update channel under <span class="strong strong"><strong>Update channel</strong></span>.
						</li><li class="listitem">
							Click the newer update channel that you want to change to, then click <span class="strong strong"><strong>Save</strong></span>.
						</li><li class="listitem"><p class="simpara">
							For subscriptions with an <span class="strong strong"><strong>Automatic</strong></span> approval strategy, the update begins automatically. Navigate back to the <span class="strong strong"><strong>Operators → Installed Operators</strong></span> page to monitor the progress of the update. When complete, the status changes to <span class="strong strong"><strong>Succeeded</strong></span> and <span class="strong strong"><strong>Up to date</strong></span>.
						</p><p class="simpara">
							For subscriptions with a <span class="strong strong"><strong>Manual</strong></span> approval strategy, you can manually approve the update from the <span class="strong strong"><strong>Subscription</strong></span> tab.
						</p></li></ol></div></section><section class="section" id="olm-approving-pending-upgrade_olm-upgrading-operators"><div class="titlepage"><div><div><h3 class="title">4.2.3. Manually approving a pending Operator update</h3></div></div></div><p>
					If an installed Operator has the approval strategy in its subscription set to <span class="strong strong"><strong>Manual</strong></span>, when new updates are released in its current update channel, the update must be manually approved before installation can begin.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							An Operator previously installed using Operator Lifecycle Manager (OLM).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the <span class="strong strong"><strong>Administrator</strong></span> perspective of the OpenShift Container Platform web console, navigate to <span class="strong strong"><strong>Operators → Installed Operators</strong></span>.
						</li><li class="listitem">
							Operators that have a pending update display a status with <span class="strong strong"><strong>Upgrade available</strong></span>. Click the name of the Operator you want to update.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Subscription</strong></span> tab. Any updates requiring approval are displayed next to <span class="strong strong"><strong>Upgrade status</strong></span>. For example, it might display <span class="strong strong"><strong>1 requires approval</strong></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>1 requires approval</strong></span>, then click <span class="strong strong"><strong>Preview Install Plan</strong></span>.
						</li><li class="listitem">
							Review the resources that are listed as available for update. When satisfied, click <span class="strong strong"><strong>Approve</strong></span>.
						</li><li class="listitem">
							Navigate back to the <span class="strong strong"><strong>Operators → Installed Operators</strong></span> page to monitor the progress of the update. When complete, the status changes to <span class="strong strong"><strong>Succeeded</strong></span> and <span class="strong strong"><strong>Up to date</strong></span>.
						</li></ol></div></section></section><section class="section" id="olm-deleting-operators-from-a-cluster"><div class="titlepage"><div><div><h2 class="title">4.3. Deleting Operators from a cluster</h2></div></div></div><p>
				The following describes how to delete, or uninstall, Operators that were previously installed using Operator Lifecycle Manager (OLM) on your OpenShift Container Platform cluster.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					You must successfully and completely uninstall an Operator prior to attempting to reinstall the same Operator. Failure to fully uninstall the Operator properly can leave resources, such as a project or namespace, stuck in a "Terminating" state and cause "error resolving resource" messages to be observed when trying to reinstall the Operator. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/support/#olm-reinstall_troubleshooting-operator-issues">Reinstalling Operators after failed uninstallation</a>.
				</p></div></div><section class="section" id="olm-deleting-operators-from-a-cluster-using-web-console_olm-deleting-operators-from-a-cluster"><div class="titlepage"><div><div><h3 class="title">4.3.1. Deleting Operators from a cluster using the web console</h3></div></div></div><p>
					Cluster administrators can delete installed Operators from a selected namespace by using the web console.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to an OpenShift Container Platform cluster web console using an account with <code class="literal">cluster-admin</code> permissions.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>Installed Operators</strong></span> page.
						</li><li class="listitem">
							Scroll or enter a keyword into the <span class="strong strong"><strong>Filter by name</strong></span> field to find the Operator that you want to remove. Then, click on it.
						</li><li class="listitem"><p class="simpara">
							On the right side of the <span class="strong strong"><strong>Operator Details</strong></span> page, select <span class="strong strong"><strong>Uninstall Operator</strong></span> from the <span class="strong strong"><strong>Actions</strong></span> list.
						</p><p class="simpara">
							An <span class="strong strong"><strong>Uninstall Operator?</strong></span> dialog box is displayed.
						</p></li><li class="listitem"><p class="simpara">
							Select <span class="strong strong"><strong>Uninstall</strong></span> to remove the Operator, Operator deployments, and pods. Following this action, the Operator stops running and no longer receives updates.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								This action does not remove resources managed by the Operator, including custom resource definitions (CRDs) and custom resources (CRs). Dashboards and navigation items enabled by the web console and off-cluster resources that continue to run might need manual clean up. To remove these after uninstalling the Operator, you might need to manually delete the Operator CRDs.
							</p></div></div></li></ol></div></section><section class="section" id="olm-deleting-operator-from-a-cluster-using-cli_olm-deleting-operators-from-a-cluster"><div class="titlepage"><div><div><h3 class="title">4.3.2. Deleting Operators from a cluster using the CLI</h3></div></div></div><p>
					Cluster administrators can delete installed Operators from a selected namespace by using the CLI.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to an OpenShift Container Platform cluster using an account with <code class="literal">cluster-admin</code> permissions.
						</li><li class="listitem">
							The OpenShift CLI (<code class="literal">oc</code>) is installed on your workstation.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Check the current version of the subscribed Operator (for example, <code class="literal">jaeger</code>) in the <code class="literal">currentCSV</code> field:
						</p><pre class="programlisting language-terminal">$ oc get subscription jaeger -n openshift-operators -o yaml | grep currentCSV</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">  currentCSV: jaeger-operator.v1.8.2</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Delete the subscription (for example, <code class="literal">jaeger</code>):
						</p><pre class="programlisting language-terminal">$ oc delete subscription jaeger -n openshift-operators</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">subscription.operators.coreos.com "jaeger" deleted</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Delete the CSV for the Operator in the target namespace using the <code class="literal">currentCSV</code> value from the previous step:
						</p><pre class="programlisting language-terminal">$ oc delete clusterserviceversion jaeger-operator.v1.8.2 -n openshift-operators</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">clusterserviceversion.operators.coreos.com "jaeger-operator.v1.8.2" deleted</pre>

							</p></div></li></ol></div></section><section class="section" id="olm-refresh-subs_olm-deleting-operators-from-a-cluster"><div class="titlepage"><div><div><h3 class="title">4.3.3. Refreshing failing subscriptions</h3></div></div></div><p>
					In Operator Lifecycle Manager (OLM), if you subscribe to an Operator that references images that are not accessible on your network, you can find jobs in the <code class="literal">openshift-marketplace</code> namespace that are failing with the following errors:
				</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">ImagePullBackOff for
Back-off pulling image "example.com/openshift4/ose-elasticsearch-operator-bundle@sha256:6d2587129c846ec28d384540322b40b05833e7e00b25cca584e004af9a1d292e"</pre>

					</p></div><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">rpc error: code = Unknown desc = error pinging docker registry example.com: Get "https://example.com/v2/": dial tcp: lookup example.com on 10.0.0.1:53: no such host</pre>

					</p></div><p>
					As a result, the subscription is stuck in this failing state and the Operator is unable to install or upgrade.
				</p><p>
					You can refresh a failing subscription by deleting the subscription, cluster service version (CSV), and other related objects. After recreating the subscription, OLM then reinstalls the correct version of the Operator.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have a failing subscription that is unable to pull an inaccessible bundle image.
						</li><li class="listitem">
							You have confirmed that the correct bundle image is accessible.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Get the names of the <code class="literal">Subscription</code> and <code class="literal">ClusterServiceVersion</code> objects from the namespace where the Operator is installed:
						</p><pre class="programlisting language-terminal">$ oc get sub,csv -n &lt;namespace&gt;</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                                                       PACKAGE                  SOURCE             CHANNEL
subscription.operators.coreos.com/elasticsearch-operator   elasticsearch-operator   redhat-operators   5.0

NAME                                                                         DISPLAY                            VERSION    REPLACES   PHASE
clusterserviceversion.operators.coreos.com/elasticsearch-operator.5.0.0-65   OpenShift Elasticsearch Operator   5.0.0-65              Succeeded</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Delete the subscription:
						</p><pre class="programlisting language-terminal">$ oc delete subscription &lt;subscription_name&gt; -n &lt;namespace&gt;</pre></li><li class="listitem"><p class="simpara">
							Delete the cluster service version:
						</p><pre class="programlisting language-terminal">$ oc delete csv &lt;csv_name&gt; -n &lt;namespace&gt;</pre></li><li class="listitem"><p class="simpara">
							Get the names of any failing jobs and related config maps in the <code class="literal">openshift-marketplace</code> namespace:
						</p><pre class="programlisting language-terminal">$ oc get job,configmap -n openshift-marketplace</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                                                                        COMPLETIONS   DURATION   AGE
job.batch/1de9443b6324e629ddf31fed0a853a121275806170e34c926d69e53a7fcbccb   1/1           26s        9m30s

NAME                                                                        DATA   AGE
configmap/1de9443b6324e629ddf31fed0a853a121275806170e34c926d69e53a7fcbccb   3      9m30s</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Delete the job:
						</p><pre class="programlisting language-terminal">$ oc delete job &lt;job_name&gt; -n openshift-marketplace</pre><p class="simpara">
							This ensures pods that try to pull the inaccessible image are not recreated.
						</p></li><li class="listitem"><p class="simpara">
							Delete the config map:
						</p><pre class="programlisting language-terminal">$ oc delete configmap &lt;configmap_name&gt; -n openshift-marketplace</pre></li><li class="listitem">
							Reinstall the Operator using OperatorHub in the web console.
						</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Check that the Operator has been reinstalled successfully:
						</p><pre class="programlisting language-terminal">$ oc get sub,csv,installplan -n &lt;namespace&gt;</pre></li></ul></div></section></section><section class="section" id="olm-config"><div class="titlepage"><div><div><h2 class="title">4.4. Configuring Operator Lifecycle Manager features</h2></div></div></div><p>
				The Operator Lifecycle Manager (OLM) controller is configured by an <code class="literal">OLMConfig</code> custom resource (CR) named <code class="literal">cluster</code>. Cluster administrators can modify this resource to enable or disable certain features.
			</p><p>
				This document outlines the features currently supported by OLM that are configured by the <code class="literal">OLMConfig</code> resource.
			</p><section class="section" id="olm-disabling-copied-csvs_olm-config"><div class="titlepage"><div><div><h3 class="title">4.4.1. Disabling copied CSVs</h3></div></div></div><p>
					When an Operator is installed by Operator Lifecycle Manager (OLM), a simplified copy of its cluster service version (CSV) is created by default in every namespace that the Operator is configured to watch. These CSVs are known as <span class="emphasis"><em>copied CSVs</em></span> and communicate to users which controllers are actively reconciling resource events in a given namespace.
				</p><p>
					When an Operator is configured to use the <code class="literal">AllNamespaces</code> install mode, versus targeting a single or specified set of namespaces, a copied CSV for the Operator is created in every namespace on the cluster. On especially large clusters, with namespaces and installed Operators potentially in the hundreds or thousands, copied CSVs consume an untenable amount of resources, such as OLM’s memory usage, cluster etcd limits, and networking.
				</p><p>
					To support these larger clusters, cluster administrators can disable copied CSVs for Operators globally installed with the <code class="literal">AllNamespaces</code> mode.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you disable copied CSVs, an Operator installed in <code class="literal">AllNamespaces</code> mode has their CSV copied only to the <code class="literal">openshift</code> namespace, instead of every namespace on the cluster. In disabled copied CSVs mode, the behavior differs between the web console and CLI:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								In the web console, the default behavior is modified to show copied CSVs from the <code class="literal">openshift</code> namespace in every namespace, even though the CSVs are not actually copied to every namespace. This allows regular users to still be able to view the details of these Operators in their namespaces and create related custom resources (CRs).
							</li><li class="listitem"><p class="simpara">
								In the OpenShift CLI (<code class="literal">oc</code>), regular users can view Operators installed directly in their namespaces by using the <code class="literal">oc get csvs</code> command, but the copied CSVs from the <code class="literal">openshift</code> namespace are not visible in their namespaces. Operators affected by this limitation are still available and continue to reconcile events in the user’s namespace.
							</p><p class="simpara">
								To view a full list of installed global Operators, similar to the web console behavior, all authenticated users can run the following command:
							</p><pre class="programlisting language-terminal">$ oc get csvs -n openshift</pre></li></ul></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">OLMConfig</code> object named <code class="literal">cluster</code> and set the <code class="literal">spec.features.disableCopiedCSVs</code> field to <code class="literal">true</code>:
						</p><pre class="programlisting language-terminal">$ oc apply -f - &lt;&lt;EOF
apiVersion: operators.coreos.com/v1
kind: OLMConfig
metadata:
  name: cluster
spec:
  features:
    disableCopiedCSVs: true <span id="CO22-1"><!--Empty--></span><span class="callout">1</span>
EOF</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO22-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Disabled copied CSVs for <code class="literal">AllNamespaces</code> install mode Operators
								</div></dd></dl></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							When copied CSVs are disabled, OLM captures this information in an event in the Operator’s namespace:
						</p><pre class="programlisting language-terminal">$ oc get events</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">LAST SEEN   TYPE      REASON               OBJECT                                MESSAGE
85s         Warning   DisabledCopiedCSVs   clusterserviceversion/my-csv.v1.0.0   CSV copying disabled for operators/my-csv.v1.0.0</pre>

							</p></div><p class="simpara">
							When the <code class="literal">spec.features.disableCopiedCSVs</code> field is missing or set to <code class="literal">false</code>, OLM recreates the copied CSVs for all Operators installed with the <code class="literal">AllNamespaces</code> mode and deletes the previously mentioned events.
						</p></li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-operatorgroups-membership_olm-understanding-operatorgroups">Install modes</a>
						</li></ul></div></section></section><section class="section" id="olm-configuring-proxy-support"><div class="titlepage"><div><div><h2 class="title">4.5. Configuring proxy support in Operator Lifecycle Manager</h2></div></div></div><p>
				If a global proxy is configured on the OpenShift Container Platform cluster, Operator Lifecycle Manager (OLM) automatically configures Operators that it manages with the cluster-wide proxy. However, you can also configure installed Operators to override the global proxy or inject a custom CA certificate.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#enable-cluster-wide-proxy">Configuring the cluster-wide proxy</a>
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#configuring-a-custom-pki">Configuring a custom PKI</a> (custom CA certificate)
					</li><li class="listitem">
						Developing Operators that support proxy settings for <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-run-proxy_osdk-golang-tutorial">Go</a>, <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-run-proxy_osdk-ansible-tutorial">Ansible</a>, and <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-run-proxy_osdk-helm-tutorial">Helm</a>
					</li></ul></div><section class="section" id="olm-overriding-proxy-settings_olm-configuring-proxy-support"><div class="titlepage"><div><div><h3 class="title">4.5.1. Overriding proxy settings of an Operator</h3></div></div></div><p>
					If a cluster-wide egress proxy is configured, Operators running with Operator Lifecycle Manager (OLM) inherit the cluster-wide proxy settings on their deployments. Cluster administrators can also override these proxy settings by configuring the subscription of an Operator.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Operators must handle setting environment variables for proxy settings in the pods for any managed Operands.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Access to an OpenShift Container Platform cluster using an account with <code class="literal">cluster-admin</code> permissions.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Navigate in the web console to the <span class="strong strong"><strong>Operators → OperatorHub</strong></span> page.
						</li><li class="listitem">
							Select the Operator and click <span class="strong strong"><strong>Install</strong></span>.
						</li><li class="listitem"><p class="simpara">
							On the <span class="strong strong"><strong>Install Operator</strong></span> page, modify the <code class="literal">Subscription</code> object to include one or more of the following environment variables in the <code class="literal">spec</code> section:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">HTTP_PROXY</code>
								</li><li class="listitem">
									<code class="literal">HTTPS_PROXY</code>
								</li><li class="listitem">
									<code class="literal">NO_PROXY</code>
								</li></ul></div><p class="simpara">
							For example:
						</p><div class="formalpara"><p class="title"><strong><code class="literal">Subscription</code> object with proxy setting overrides</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: etcd-config-test
  namespace: openshift-operators
spec:
  config:
    env:
    - name: HTTP_PROXY
      value: test_http
    - name: HTTPS_PROXY
      value: test_https
    - name: NO_PROXY
      value: test
  channel: clusterwide-alpha
  installPlanApproval: Automatic
  name: etcd
  source: community-operators
  sourceNamespace: openshift-marketplace
  startingCSV: etcdoperator.v0.9.4-clusterwide</pre>

							</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								These environment variables can also be unset using an empty value to remove any previously set cluster-wide or custom proxy settings.
							</p></div></div><p class="simpara">
							OLM handles these environment variables as a unit; if at least one of them is set, all three are considered overridden and the cluster-wide defaults are not used for the deployments of the subscribed Operator.
						</p></li><li class="listitem">
							Click <span class="strong strong"><strong>Install</strong></span> to make the Operator available to the selected namespaces.
						</li><li class="listitem"><p class="simpara">
							After the CSV for the Operator appears in the relevant namespace, you can verify that custom proxy environment variables are set in the deployment. For example, using the CLI:
						</p><pre class="programlisting language-terminal">$ oc get deployment -n openshift-operators \
    etcd-operator -o yaml \
    | grep -i "PROXY" -A 2</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">        - name: HTTP_PROXY
          value: test_http
        - name: HTTPS_PROXY
          value: test_https
        - name: NO_PROXY
          value: test
        image: quay.io/coreos/etcd-operator@sha256:66a37fd61a06a43969854ee6d3e21088a98b93838e284a6086b13917f96b0d9c
...</pre>

							</p></div></li></ol></div></section><section class="section" id="olm-inject-custom-ca_olm-configuring-proxy-support"><div class="titlepage"><div><div><h3 class="title">4.5.2. Injecting a custom CA certificate</h3></div></div></div><p>
					When a cluster administrator adds a custom CA certificate to a cluster using a config map, the Cluster Network Operator merges the user-provided certificates and system CA certificates into a single bundle. You can inject this merged bundle into your Operator running on Operator Lifecycle Manager (OLM), which is useful if you have a man-in-the-middle HTTPS proxy.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Access to an OpenShift Container Platform cluster using an account with <code class="literal">cluster-admin</code> permissions.
						</li><li class="listitem">
							Custom CA certificate added to the cluster using a config map.
						</li><li class="listitem">
							Desired Operator installed and running on OLM.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create an empty config map in the namespace where the subscription for your Operator exists and include the following label:
						</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: trusted-ca <span id="CO23-1"><!--Empty--></span><span class="callout">1</span>
  labels:
    config.openshift.io/inject-trusted-cabundle: "true" <span id="CO23-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO23-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Name of the config map.
								</div></dd><dt><a href="#CO23-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Requests the Cluster Network Operator to inject the merged bundle.
								</div></dd></dl></div><p class="simpara">
							After creating this config map, it is immediately populated with the certificate contents of the merged bundle.
						</p></li><li class="listitem"><p class="simpara">
							Update the <code class="literal">Subscription</code> object to include a <code class="literal">spec.config</code> section that mounts the <code class="literal">trusted-ca</code> config map as a volume to each container within a pod that requires a custom CA:
						</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: my-operator
spec:
  package: etcd
  channel: alpha
  config: <span id="CO24-1"><!--Empty--></span><span class="callout">1</span>
    selector:
      matchLabels:
        &lt;labels_for_pods&gt; <span id="CO24-2"><!--Empty--></span><span class="callout">2</span>
    volumes: <span id="CO24-3"><!--Empty--></span><span class="callout">3</span>
    - name: trusted-ca
      configMap:
        name: trusted-ca
        items:
          - key: ca-bundle.crt <span id="CO24-4"><!--Empty--></span><span class="callout">4</span>
            path: tls-ca-bundle.pem <span id="CO24-5"><!--Empty--></span><span class="callout">5</span>
    volumeMounts: <span id="CO24-6"><!--Empty--></span><span class="callout">6</span>
    - name: trusted-ca
      mountPath: /etc/pki/ca-trust/extracted/pem
      readOnly: true</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO24-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Add a <code class="literal">config</code> section if it does not exist.
								</div></dd><dt><a href="#CO24-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Specify labels to match pods that are owned by the Operator.
								</div></dd><dt><a href="#CO24-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Create a <code class="literal">trusted-ca</code> volume.
								</div></dd><dt><a href="#CO24-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									<code class="literal">ca-bundle.crt</code> is required as the config map key.
								</div></dd><dt><a href="#CO24-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									<code class="literal">tls-ca-bundle.pem</code> is required as the config map path.
								</div></dd><dt><a href="#CO24-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									Create a <code class="literal">trusted-ca</code> volume mount.
								</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Deployments of an Operator can fail to validate the authority and display a <code class="literal">x509 certificate signed by unknown authority</code> error. This error can occur even after injecting a custom CA when using the subscription of an Operator. In this case, you can set the <code class="literal">mountPath</code> as <code class="literal">/etc/ssl/certs</code> for trusted-ca by using the subscription of an Operator.
							</p></div></div></li></ol></div></section></section><section class="section" id="olm-status"><div class="titlepage"><div><div><h2 class="title">4.6. Viewing Operator status</h2></div></div></div><p>
				Understanding the state of the system in Operator Lifecycle Manager (OLM) is important for making decisions about and debugging problems with installed Operators. OLM provides insight into subscriptions and related catalog sources regarding their state and actions performed. This helps users better understand the healthiness of their Operators.
			</p><section class="section" id="olm-status-conditions_olm-status"><div class="titlepage"><div><div><h3 class="title">4.6.1. Operator subscription condition types</h3></div></div></div><p>
					Subscriptions can report the following condition types:
				</p><div class="table" id="idm139731985369184"><p class="title"><strong>Table 4.1. Subscription condition types</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 67%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731985609296" scope="col">Condition</th><th align="left" valign="top" id="idm139731991686688" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731985609296"> <p>
									<code class="literal">CatalogSourcesUnhealthy</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731991686688"> <p>
									Some or all of the catalog sources to be used in resolution are unhealthy.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731985609296"> <p>
									<code class="literal">InstallPlanMissing</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731991686688"> <p>
									An install plan for a subscription is missing.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731985609296"> <p>
									<code class="literal">InstallPlanPending</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731991686688"> <p>
									An install plan for a subscription is pending installation.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731985609296"> <p>
									<code class="literal">InstallPlanFailed</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731991686688"> <p>
									An install plan for a subscription has failed.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731985609296"> <p>
									<code class="literal">ResolutionFailed</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731991686688"> <p>
									The dependency resolution for a subscription has failed.
								</p>
								 </td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Default OpenShift Container Platform cluster Operators are managed by the Cluster Version Operator (CVO) and they do not have a <code class="literal">Subscription</code> object. Application Operators are managed by Operator Lifecycle Manager (OLM) and they have a <code class="literal">Subscription</code> object.
					</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-refresh-subs_olm-deleting-operators-from-a-cluster">Refreshing failing subscriptions</a>
						</li></ul></div></section><section class="section" id="olm-status-viewing-cli_olm-status"><div class="titlepage"><div><div><h3 class="title">4.6.2. Viewing Operator subscription status by using the CLI</h3></div></div></div><p>
					You can view Operator subscription status by using the CLI.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							List Operator subscriptions:
						</p><pre class="programlisting language-terminal">$ oc get subs -n &lt;operator_namespace&gt;</pre></li><li class="listitem"><p class="simpara">
							Use the <code class="literal">oc describe</code> command to inspect a <code class="literal">Subscription</code> resource:
						</p><pre class="programlisting language-terminal">$ oc describe sub &lt;subscription_name&gt; -n &lt;operator_namespace&gt;</pre></li><li class="listitem"><p class="simpara">
							In the command output, find the <code class="literal">Conditions</code> section for the status of Operator subscription condition types. In the following example, the <code class="literal">CatalogSourcesUnhealthy</code> condition type has a status of <code class="literal">false</code> because all available catalog sources are healthy:
						</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Conditions:
   Last Transition Time:  2019-07-29T13:42:57Z
   Message:               all available catalogsources are healthy
   Reason:                AllCatalogSourcesHealthy
   Status:                False
   Type:                  CatalogSourcesUnhealthy</pre>

							</p></div></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Default OpenShift Container Platform cluster Operators are managed by the Cluster Version Operator (CVO) and they do not have a <code class="literal">Subscription</code> object. Application Operators are managed by Operator Lifecycle Manager (OLM) and they have a <code class="literal">Subscription</code> object.
					</p></div></div></section><section class="section" id="olm-cs-status-cli_olm-status"><div class="titlepage"><div><div><h3 class="title">4.6.3. Viewing Operator catalog source status by using the CLI</h3></div></div></div><p>
					You can view the status of an Operator catalog source by using the CLI.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							List the catalog sources in a namespace. For example, you can check the <code class="literal">openshift-marketplace</code> namespace, which is used for cluster-wide catalog sources:
						</p><pre class="programlisting language-terminal">$ oc get catalogsources -n openshift-marketplace</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                  DISPLAY               TYPE   PUBLISHER   AGE
certified-operators   Certified Operators   grpc   Red Hat     55m
community-operators   Community Operators   grpc   Red Hat     55m
example-catalog       Example Catalog       grpc   Example Org 2m25s
redhat-marketplace    Red Hat Marketplace   grpc   Red Hat     55m
redhat-operators      Red Hat Operators     grpc   Red Hat     55m</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Use the <code class="literal">oc describe</code> command to get more details and status about a catalog source:
						</p><pre class="programlisting language-terminal">$ oc describe catalogsource example-catalog -n openshift-marketplace</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Name:         example-catalog
Namespace:    openshift-marketplace
...
Status:
  Connection State:
    Address:              example-catalog.openshift-marketplace.svc:50051
    Last Connect:         2021-09-09T17:07:35Z
    Last Observed State:  TRANSIENT_FAILURE
  Registry Service:
    Created At:         2021-09-09T17:05:45Z
    Port:               50051
    Protocol:           grpc
    Service Name:       example-catalog
    Service Namespace:  openshift-marketplace</pre>

							</p></div><p class="simpara">
							In the preceding example output, the last observed state is <code class="literal">TRANSIENT_FAILURE</code>. This state indicates that there is a problem establishing a connection for the catalog source.
						</p></li><li class="listitem"><p class="simpara">
							List the pods in the namespace where your catalog source was created:
						</p><pre class="programlisting language-terminal">$ oc get pods -n openshift-marketplace</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                                    READY   STATUS             RESTARTS   AGE
certified-operators-cv9nn               1/1     Running            0          36m
community-operators-6v8lp               1/1     Running            0          36m
marketplace-operator-86bfc75f9b-jkgbc   1/1     Running            0          42m
example-catalog-bwt8z                   0/1     ImagePullBackOff   0          3m55s
redhat-marketplace-57p8c                1/1     Running            0          36m
redhat-operators-smxx8                  1/1     Running            0          36m</pre>

							</p></div><p class="simpara">
							When a catalog source is created in a namespace, a pod for the catalog source is created in that namespace. In the preceding example output, the status for the <code class="literal">example-catalog-bwt8z</code> pod is <code class="literal">ImagePullBackOff</code>. This status indicates that there is an issue pulling the catalog source’s index image.
						</p></li><li class="listitem"><p class="simpara">
							Use the <code class="literal">oc describe</code> command to inspect a pod for more detailed information:
						</p><pre class="programlisting language-terminal">$ oc describe pod example-catalog-bwt8z -n openshift-marketplace</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Name:         example-catalog-bwt8z
Namespace:    openshift-marketplace
Priority:     0
Node:         ci-ln-jyryyg2-f76d1-ggdbq-worker-b-vsxjd/10.0.128.2
...
Events:
  Type     Reason          Age                From               Message
  ----     ------          ----               ----               -------
  Normal   Scheduled       48s                default-scheduler  Successfully assigned openshift-marketplace/example-catalog-bwt8z to ci-ln-jyryyf2-f76d1-fgdbq-worker-b-vsxjd
  Normal   AddedInterface  47s                multus             Add eth0 [10.131.0.40/23] from openshift-sdn
  Normal   BackOff         20s (x2 over 46s)  kubelet            Back-off pulling image "quay.io/example-org/example-catalog:v1"
  Warning  Failed          20s (x2 over 46s)  kubelet            Error: ImagePullBackOff
  Normal   Pulling         8s (x3 over 47s)   kubelet            Pulling image "quay.io/example-org/example-catalog:v1"
  Warning  Failed          8s (x3 over 47s)   kubelet            Failed to pull image "quay.io/example-org/example-catalog:v1": rpc error: code = Unknown desc = reading manifest v1 in quay.io/example-org/example-catalog: unauthorized: access to the requested resource is not authorized
  Warning  Failed          8s (x3 over 47s)   kubelet            Error: ErrImagePull</pre>

							</p></div><p class="simpara">
							In the preceding example output, the error messages indicate that the catalog source’s index image is failing to pull successfully because of an authorization issue. For example, the index image might be stored in a registry that requires login credentials.
						</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-catalogsource_olm-understanding-olm">Operator Lifecycle Manager concepts and resources → Catalog source</a>
						</li><li class="listitem">
							gRPC documentation: <a class="link" href="https://grpc.github.io/grpc/core/md_doc_connectivity-semantics-and-api.html">States of Connectivity</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-accessing-images-private-registries_olm-managing-custom-catalogs">Accessing images for Operators from private registries</a>
						</li></ul></div></section></section><section class="section" id="olm-managing-operatorconditions"><div class="titlepage"><div><div><h2 class="title">4.7. Managing Operator conditions</h2></div></div></div><p>
				As a cluster administrator, you can manage Operator conditions by using Operator Lifecycle Manager (OLM).
			</p><section class="section" id="olm-supported-operatorconditions_olm-managing-operatorconditions"><div class="titlepage"><div><div><h3 class="title">4.7.1. Overriding Operator conditions</h3></div></div></div><p>
					As a cluster administrator, you might want to ignore a supported Operator condition reported by an Operator. When present, Operator conditions in the <code class="literal">Spec.Overrides</code> array override the conditions in the <code class="literal">Spec.Conditions</code> array, allowing cluster administrators to deal with situations where an Operator is incorrectly reporting a state to Operator Lifecycle Manager (OLM).
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						By default, the <code class="literal">Spec.Overrides</code> array is not present in an <code class="literal">OperatorCondition</code> object until it is added by a cluster administrator . The <code class="literal">Spec.Conditions</code> array is also not present until it is either added by a user or as a result of custom Operator logic.
					</p></div></div><p>
					For example, consider a known version of an Operator that always communicates that it is not upgradeable. In this instance, you might want to upgrade the Operator despite the Operator communicating that it is not upgradeable. This could be accomplished by overriding the Operator condition by adding the condition <code class="literal">type</code> and <code class="literal">status</code> to the <code class="literal">Spec.Overrides</code> array in the <code class="literal">OperatorCondition</code> object.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li><li class="listitem">
							An Operator with an <code class="literal">OperatorCondition</code> object, installed using OLM.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">OperatorCondition</code> object for the Operator:
						</p><pre class="programlisting language-terminal">$ oc edit operatorcondition &lt;name&gt;</pre></li><li class="listitem"><p class="simpara">
							Add a <code class="literal">Spec.Overrides</code> array to the object:
						</p><div class="formalpara"><p class="title"><strong>Example Operator condition override</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorCondition
metadata:
  name: my-operator
  namespace: operators
spec:
  overrides:
  - type: Upgradeable <span id="CO25-1"><!--Empty--></span><span class="callout">1</span>
    status: "True"
    reason: "upgradeIsSafe"
    message: "This is a known issue with the Operator where it always reports that it cannot be upgraded."
  conditions:
  - type: Upgradeable
    status: "False"
    reason: "migration"
    message: "The operator is performing a migration."
    lastTransitionTime: "2020-08-24T23:15:55Z"</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO25-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Allows the cluster administrator to change the upgrade readiness to <code class="literal">True</code>.
								</div></dd></dl></div></li></ol></div></section><section class="section" id="olm-updating-use-operatorconditions_olm-managing-operatorconditions"><div class="titlepage"><div><div><h3 class="title">4.7.2. Updating your Operator to use Operator conditions</h3></div></div></div><p>
					Operator Lifecycle Manager (OLM) automatically creates an <code class="literal">OperatorCondition</code> resource for each <code class="literal">ClusterServiceVersion</code> resource that it reconciles. All service accounts in the CSV are granted the RBAC to interact with the <code class="literal">OperatorCondition</code> owned by the Operator.
				</p><p>
					An Operator author can develop their Operator to use the <code class="literal">operator-lib</code> library such that, after the Operator has been deployed by OLM, it can set its own conditions. For more resources about setting Operator conditions as an Operator author, see the <a class="link" href="https://docs.openshift.com/container-platform/4.12/operators/operator_sdk/osdk-generating-csvs.html#osdk-operatorconditions_osdk-generating-csvs">Enabling Operator conditions</a> page.
				</p><section class="section" id="olm-updating-use-operatorconditions-defaults_olm-managing-operatorconditions"><div class="titlepage"><div><div><h4 class="title">4.7.2.1. Setting defaults</h4></div></div></div><p>
						In an effort to remain backwards compatible, OLM treats the absence of an <code class="literal">OperatorCondition</code> resource as opting out of the condition. Therefore, an Operator that opts in to using Operator conditions should set default conditions before the ready probe for the pod is set to <code class="literal">true</code>. This provides the Operator with a grace period to update the condition to the correct state.
					</p></section></section><section class="section _additional-resources" id="olm-managing-operatorconditions-addtl-resources"><div class="titlepage"><div><div><h3 class="title">4.7.3. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-operatorconditions">Operator conditions</a>
						</li></ul></div></section></section><section class="section" id="olm-creating-policy"><div class="titlepage"><div><div><h2 class="title">4.8. Allowing non-cluster administrators to install Operators</h2></div></div></div><p>
				Cluster administrators can use <span class="emphasis"><em>Operator groups</em></span> to allow regular users to install Operators.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-understanding-operatorgroups">Operator groups</a>
					</li></ul></div><section class="section" id="olm-policy-understanding_olm-creating-policy"><div class="titlepage"><div><div><h3 class="title">4.8.1. Understanding Operator installation policy</h3></div></div></div><p>
					Operators can require wide privileges to run, and the required privileges can change between versions. Operator Lifecycle Manager (OLM) runs with <code class="literal">cluster-admin</code> privileges. By default, Operator authors can specify any set of permissions in the cluster service version (CSV), and OLM consequently grants it to the Operator.
				</p><p>
					To ensure that an Operator cannot achieve cluster-scoped privileges and that users cannot escalate privileges using OLM, Cluster administrators can manually audit Operators before they are added to the cluster. Cluster administrators are also provided tools for determining and constraining which actions are allowed during an Operator installation or upgrade using service accounts.
				</p><p>
					Cluster administrators can associate an Operator group with a service account that has a set of privileges granted to it. The service account sets policy on Operators to ensure they only run within predetermined boundaries by using role-based access control (RBAC) rules. As a result, the Operator is unable to do anything that is not explicitly permitted by those rules.
				</p><p>
					By employing Operator groups, users with enough privileges can install Operators with a limited scope. As a result, more of the Operator Framework tools can safely be made available to more users, providing a richer experience for building applications with Operators.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Role-based access control (RBAC) for <code class="literal">Subscription</code> objects is automatically granted to every user with the <code class="literal">edit</code> or <code class="literal">admin</code> role in a namespace. However, RBAC does not exist on <code class="literal">OperatorGroup</code> objects; this absence is what prevents regular users from installing Operators. Pre-installing Operator groups is effectively what gives installation privileges.
					</p></div></div><p>
					Keep the following points in mind when associating an Operator group with a service account:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">APIService</code> and <code class="literal">CustomResourceDefinition</code> resources are always created by OLM using the <code class="literal">cluster-admin</code> role. A service account associated with an Operator group should never be granted privileges to write these resources.
						</li><li class="listitem">
							Any Operator tied to this Operator group is now confined to the permissions granted to the specified service account. If the Operator asks for permissions that are outside the scope of the service account, the install fails with appropriate errors so the cluster administrator can troubleshoot and resolve the issue.
						</li></ul></div><section class="section" id="olm-policy-scenarios_olm-creating-policy"><div class="titlepage"><div><div><h4 class="title">4.8.1.1. Installation scenarios</h4></div></div></div><p>
						When determining whether an Operator can be installed or upgraded on a cluster, Operator Lifecycle Manager (OLM) considers the following scenarios:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A cluster administrator creates a new Operator group and specifies a service account. All Operator(s) associated with this Operator group are installed and run against the privileges granted to the service account.
							</li><li class="listitem">
								A cluster administrator creates a new Operator group and does not specify any service account. OpenShift Container Platform maintains backward compatibility, so the default behavior remains and Operator installs and upgrades are permitted.
							</li><li class="listitem">
								For existing Operator groups that do not specify a service account, the default behavior remains and Operator installs and upgrades are permitted.
							</li><li class="listitem">
								A cluster administrator updates an existing Operator group and specifies a service account. OLM allows the existing Operator to continue to run with their current privileges. When such an existing Operator is going through an upgrade, it is reinstalled and run against the privileges granted to the service account like any new Operator.
							</li><li class="listitem">
								A service account specified by an Operator group changes by adding or removing permissions, or the existing service account is swapped with a new one. When existing Operators go through an upgrade, it is reinstalled and run against the privileges granted to the updated service account like any new Operator.
							</li><li class="listitem">
								A cluster administrator removes the service account from an Operator group. The default behavior remains and Operator installs and upgrades are permitted.
							</li></ul></div></section><section class="section" id="olm-policy-workflow_olm-creating-policy"><div class="titlepage"><div><div><h4 class="title">4.8.1.2. Installation workflow</h4></div></div></div><p>
						When an Operator group is tied to a service account and an Operator is installed or upgraded, Operator Lifecycle Manager (OLM) uses the following workflow:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								The given <code class="literal">Subscription</code> object is picked up by OLM.
							</li><li class="listitem">
								OLM fetches the Operator group tied to this subscription.
							</li><li class="listitem">
								OLM determines that the Operator group has a service account specified.
							</li><li class="listitem">
								OLM creates a client scoped to the service account and uses the scoped client to install the Operator. This ensures that any permission requested by the Operator is always confined to that of the service account in the Operator group.
							</li><li class="listitem">
								OLM creates a new service account with the set of permissions specified in the CSV and assigns it to the Operator. The Operator runs as the assigned service account.
							</li></ol></div></section></section><section class="section" id="olm-policy-scoping-operator-install_olm-creating-policy"><div class="titlepage"><div><div><h3 class="title">4.8.2. Scoping Operator installations</h3></div></div></div><p>
					To provide scoping rules to Operator installations and upgrades on Operator Lifecycle Manager (OLM), associate a service account with an Operator group.
				</p><p>
					Using this example, a cluster administrator can confine a set of Operators to a designated namespace.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li><li class="listitem">
							You have installed the OpenShift CLI (<code class="literal">oc</code>).
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a new namespace:
						</p><pre class="programlisting language-terminal">$ cat &lt;&lt;EOF | oc create -f -
apiVersion: v1
kind: Namespace
metadata:
  name: scoped
EOF</pre></li><li class="listitem"><p class="simpara">
							Allocate permissions that you want the Operator(s) to be confined to. This involves creating a new service account, relevant role(s), and role binding(s).
						</p><pre class="programlisting language-terminal">$ cat &lt;&lt;EOF | oc create -f -
apiVersion: v1
kind: ServiceAccount
metadata:
  name: scoped
  namespace: scoped
EOF</pre><p class="simpara">
							The following example grants the service account permissions to do anything in the designated namespace for simplicity. In a production environment, you should create a more fine-grained set of permissions:
						</p><pre class="programlisting language-terminal">$ cat &lt;&lt;EOF | oc create -f -
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: scoped
  namespace: scoped
rules:
- apiGroups: ["*"]
  resources: ["*"]
  verbs: ["*"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: scoped-bindings
  namespace: scoped
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: scoped
subjects:
- kind: ServiceAccount
  name: scoped
  namespace: scoped
EOF</pre></li><li class="listitem"><p class="simpara">
							Create an <code class="literal">OperatorGroup</code> object in the designated namespace. This Operator group targets the designated namespace to ensure that its tenancy is confined to it.
						</p><p class="simpara">
							In addition, Operator groups allow a user to specify a service account. Specify the service account created in the previous step:
						</p><pre class="programlisting language-terminal">$ cat &lt;&lt;EOF | oc create -f -
apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: scoped
  namespace: scoped
spec:
  serviceAccountName: scoped
  targetNamespaces:
  - scoped
EOF</pre><p class="simpara">
							Any Operator installed in the designated namespace is tied to this Operator group and therefore to the service account specified.
						</p></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">Subscription</code> object in the designated namespace to install an Operator:
						</p><pre class="programlisting language-terminal">$ cat &lt;&lt;EOF | oc create -f -
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: etcd
  namespace: scoped
spec:
  channel: singlenamespace-alpha
  name: etcd
  source: &lt;catalog_source_name&gt; <span id="CO26-1"><!--Empty--></span><span class="callout">1</span>
  sourceNamespace: &lt;catalog_source_namespace&gt; <span id="CO26-2"><!--Empty--></span><span class="callout">2</span>
EOF</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO26-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Specify a catalog source that already exists in the designated namespace or one that is in the global catalog namespace.
								</div></dd><dt><a href="#CO26-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Specify a namespace where the catalog source was created.
								</div></dd></dl></div><p class="simpara">
							Any Operator tied to this Operator group is confined to the permissions granted to the specified service account. If the Operator requests permissions that are outside the scope of the service account, the installation fails with relevant errors.
						</p></li></ol></div><section class="section" id="olm-policy-fine-grained-permissions_olm-creating-policy"><div class="titlepage"><div><div><h4 class="title">4.8.2.1. Fine-grained permissions</h4></div></div></div><p>
						Operator Lifecycle Manager (OLM) uses the service account specified in an Operator group to create or update the following resources related to the Operator being installed:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">ClusterServiceVersion</code>
							</li><li class="listitem">
								<code class="literal">Subscription</code>
							</li><li class="listitem">
								<code class="literal">Secret</code>
							</li><li class="listitem">
								<code class="literal">ServiceAccount</code>
							</li><li class="listitem">
								<code class="literal">Service</code>
							</li><li class="listitem">
								<code class="literal">ClusterRole</code> and <code class="literal">ClusterRoleBinding</code>
							</li><li class="listitem">
								<code class="literal">Role</code> and <code class="literal">RoleBinding</code>
							</li></ul></div><p>
						To confine Operators to a designated namespace, cluster administrators can start by granting the following permissions to the service account:
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The following role is a generic example and additional rules might be required based on the specific Operator.
						</p></div></div><pre class="programlisting language-yaml">kind: Role
rules:
- apiGroups: ["operators.coreos.com"]
  resources: ["subscriptions", "clusterserviceversions"]
  verbs: ["get", "create", "update", "patch"]
- apiGroups: [""]
  resources: ["services", "serviceaccounts"]
  verbs: ["get", "create", "update", "patch"]
- apiGroups: ["rbac.authorization.k8s.io"]
  resources: ["roles", "rolebindings"]
  verbs: ["get", "create", "update", "patch"]
- apiGroups: ["apps"] <span id="CO27-1"><!--Empty--></span><span class="callout">1</span>
  resources: ["deployments"]
  verbs: ["list", "watch", "get", "create", "update", "patch", "delete"]
- apiGroups: [""] <span id="CO27-2"><!--Empty--></span><span class="callout">2</span>
  resources: ["pods"]
  verbs: ["list", "watch", "get", "create", "update", "patch", "delete"]</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO27-1"><span class="callout">1</span></a> <a href="#CO27-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Add permissions to create other resources, such as deployments and pods shown here.
							</div></dd></dl></div><p>
						In addition, if any Operator specifies a pull secret, the following permissions must also be added:
					</p><pre class="programlisting language-yaml">kind: ClusterRole <span id="CO28-1"><!--Empty--></span><span class="callout">1</span>
rules:
- apiGroups: [""]
  resources: ["secrets"]
  verbs: ["get"]
---
kind: Role
rules:
- apiGroups: [""]
  resources: ["secrets"]
  verbs: ["create", "update", "patch"]</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO28-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Required to get the secret from the OLM namespace.
							</div></dd></dl></div></section></section><section class="section" id="olm-policy-catalog-access_olm-creating-policy"><div class="titlepage"><div><div><h3 class="title">4.8.3. Operator catalog access control</h3></div></div></div><p>
					When an Operator catalog is created in the global catalog namespace <code class="literal">openshift-marketplace</code>, the catalog’s Operators are made available cluster-wide to all namespaces. A catalog created in other namespaces only makes its Operators available in that same namespace of the catalog.
				</p><p>
					On clusters where non-cluster administrator users have been delegated Operator installation privileges, cluster administrators might want to further control or restrict the set of Operators those users are allowed to install. This can be achieved with the following actions:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Disable all of the default global catalogs.
						</li><li class="listitem">
							Enable custom, curated catalogs in the same namespace where the relevant Operator groups have been pre-installed.
						</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-restricted-networks-operatorhub_olm-managing-custom-catalogs">Disabling the default OperatorHub catalog sources</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-creating-catalog-from-index_olm-managing-custom-catalogs">Adding a catalog source to a cluster</a>
						</li></ul></div></section><section class="section" id="olm-policy-troubleshooting_olm-creating-policy"><div class="titlepage"><div><div><h3 class="title">4.8.4. Troubleshooting permission failures</h3></div></div></div><p>
					If an Operator installation fails due to lack of permissions, identify the errors using the following procedure.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Review the <code class="literal">Subscription</code> object. Its status has an object reference <code class="literal">installPlanRef</code> that points to the <code class="literal">InstallPlan</code> object that attempted to create the necessary <code class="literal">[Cluster]Role[Binding]</code> object(s) for the Operator:
						</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: Subscription
metadata:
  name: etcd
  namespace: scoped
status:
  installPlanRef:
    apiVersion: operators.coreos.com/v1
    kind: InstallPlan
    name: install-4plp8
    namespace: scoped
    resourceVersion: "117359"
    uid: 2c1df80e-afea-11e9-bce3-5254009c9c23</pre></li><li class="listitem"><p class="simpara">
							Check the status of the <code class="literal">InstallPlan</code> object for any errors:
						</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: InstallPlan
status:
  conditions:
  - lastTransitionTime: "2019-07-26T21:13:10Z"
    lastUpdateTime: "2019-07-26T21:13:10Z"
    message: 'error creating clusterrole etcdoperator.v0.9.4-clusterwide-dsfx4: clusterroles.rbac.authorization.k8s.io
      is forbidden: User "system:serviceaccount:scoped:scoped" cannot create resource
      "clusterroles" in API group "rbac.authorization.k8s.io" at the cluster scope'
    reason: InstallComponentFailed
    status: "False"
    type: Installed
  phase: Failed</pre><p class="simpara">
							The error message tells you:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The type of resource it failed to create, including the API group of the resource. In this case, it was <code class="literal">clusterroles</code> in the <code class="literal">rbac.authorization.k8s.io</code> group.
								</li><li class="listitem">
									The name of the resource.
								</li><li class="listitem">
									The type of error: <code class="literal">is forbidden</code> tells you that the user does not have enough permission to do the operation.
								</li><li class="listitem">
									The name of the user who attempted to create or update the resource. In this case, it refers to the service account specified in the Operator group.
								</li><li class="listitem"><p class="simpara">
									The scope of the operation: <code class="literal">cluster scope</code> or not.
								</p><p class="simpara">
									The user can add the missing permission to the service account and then iterate.
								</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Operator Lifecycle Manager (OLM) does not currently provide the complete list of errors on the first try.
									</p></div></div></li></ul></div></li></ol></div></section></section><section class="section" id="olm-managing-custom-catalogs"><div class="titlepage"><div><div><h2 class="title">4.9. Managing custom catalogs</h2></div></div></div><p>
				Cluster administrators and Operator catalog maintainers can create and manage custom catalogs packaged using the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-bundle-format_olm-packaging-format">bundle format</a> on Operator Lifecycle Manager (OLM) in OpenShift Container Platform.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Kubernetes periodically deprecates certain APIs that are removed in subsequent releases. As a result, Operators are unable to use removed APIs starting with the version of OpenShift Container Platform that uses the Kubernetes version that removed the API.
				</p><p>
					If your cluster is using custom catalogs, see <a class="link" href="#osdk-control-compat_osdk-working-bundle-images" title="5.8.5. Controlling Operator compatibility with OpenShift Container Platform versions">Controlling Operator compatibility with OpenShift Container Platform versions</a> for more details about how Operator authors can update their projects to help avoid workload issues and prevent incompatible upgrades.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-rh-catalogs">Red Hat-provided Operator catalogs</a>
					</li></ul></div><section class="section" id="olm-managing-custom-catalogs-bundle-format-prereqs"><div class="titlepage"><div><div><h3 class="title">4.9.1. Prerequisites</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cli_tools/#cli-opm-install"><code class="literal">opm</code> CLI</a>.
						</li></ul></div></section><section class="section" id="olm-managing-custom-catalogs-fb"><div class="titlepage"><div><div><h3 class="title">4.9.2. File-based catalogs</h3></div></div></div><p>
					<span class="emphasis"><em>File-based catalogs</em></span> are the latest iteration of the catalog format in Operator Lifecycle Manager (OLM). It is a plain text-based (JSON or YAML) and declarative config evolution of the earlier SQLite database format, and it is fully backwards compatible.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						As of OpenShift Container Platform 4.11, the default Red Hat-provided Operator catalog releases in the file-based catalog format. The default Red Hat-provided Operator catalogs for OpenShift Container Platform 4.6 through 4.10 released in the deprecated SQLite database format.
					</p><p>
						The <code class="literal">opm</code> subcommands, flags, and functionality related to the SQLite database format are also deprecated and will be removed in a future release. The features are still supported and must be used for catalogs that use the deprecated SQLite database format.
					</p><p>
						Many of the <code class="literal">opm</code> subcommands and flags for working with the SQLite database format, such as <code class="literal">opm index prune</code>, do not work with the file-based catalog format. For more information about working with file-based catalogs, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-file-based-catalogs_olm-packaging-format">Operator Framework packaging format</a> and <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-mirroring-disconnected">Mirroring images for a disconnected installation using the oc-mirror plugin</a>.
					</p></div></div><section class="section" id="olm-creating-fb-catalog-image_olm-managing-custom-catalogs"><div class="titlepage"><div><div><h4 class="title">4.9.2.1. Creating a file-based catalog image</h4></div></div></div><p>
						You can use the <code class="literal">opm</code> CLI to create a catalog image that uses the plain text <span class="emphasis"><em>file-based catalog</em></span> format (JSON or YAML), which replaces the deprecated SQLite database format.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have installed the <code class="literal">opm</code> CLI.
							</li><li class="listitem">
								You have <code class="literal">podman</code> version 1.9.3+.
							</li><li class="listitem">
								A bundle image is built and pushed to a registry that supports <a class="link" href="https://docs.docker.com/registry/spec/manifest-v2-2/">Docker v2-2</a>.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Initialize the catalog:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Create a directory for the catalog by running the following command:
									</p><pre class="programlisting language-terminal">$ mkdir &lt;catalog_dir&gt;</pre></li><li class="listitem"><p class="simpara">
										Generate a Dockerfile that can build a catalog image by running the <code class="literal">opm generate dockerfile</code> command:
									</p><pre class="programlisting language-terminal">$ opm generate dockerfile &lt;catalog_dir&gt; \
    -i registry.redhat.io/openshift4/ose-operator-registry:v4.13 <span id="CO29-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO29-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												Specify the official Red Hat base image by using the <code class="literal">-i</code> flag, otherwise the Dockerfile uses the default upstream image.
											</div></dd></dl></div><p class="simpara">
										The Dockerfile must be in the same parent directory as the catalog directory that you created in the previous step:
									</p><div class="formalpara"><p class="title"><strong>Example directory structure</strong></p><p>
											
<pre class="programlisting language-terminal">. <span id="CO30-1"><!--Empty--></span><span class="callout">1</span>
├── &lt;catalog_dir&gt; <span id="CO30-2"><!--Empty--></span><span class="callout">2</span>
└── &lt;catalog_dir&gt;.Dockerfile <span id="CO30-3"><!--Empty--></span><span class="callout">3</span></pre>

										</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO30-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												Parent directory
											</div></dd><dt><a href="#CO30-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												Catalog directory
											</div></dd><dt><a href="#CO30-3"><span class="callout">3</span></a> </dt><dd><div class="para">
												Dockerfile generated by the <code class="literal">opm generate dockerfile</code> command
											</div></dd></dl></div></li><li class="listitem"><p class="simpara">
										Populate the catalog with the package definition for your Operator by running the <code class="literal">opm init</code> command:
									</p><pre class="programlisting language-terminal">$ opm init &lt;operator_name&gt; \ <span id="CO31-1"><!--Empty--></span><span class="callout">1</span>
    --default-channel=preview \ <span id="CO31-2"><!--Empty--></span><span class="callout">2</span>
    --description=./README.md \ <span id="CO31-3"><!--Empty--></span><span class="callout">3</span>
    --icon=./operator-icon.svg \ <span id="CO31-4"><!--Empty--></span><span class="callout">4</span>
    --output yaml \ <span id="CO31-5"><!--Empty--></span><span class="callout">5</span>
    &gt; &lt;catalog_dir&gt;/index.yaml <span id="CO31-6"><!--Empty--></span><span class="callout">6</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO31-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												Operator, or package, name
											</div></dd><dt><a href="#CO31-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												Channel that subscriptions default to if unspecified
											</div></dd><dt><a href="#CO31-3"><span class="callout">3</span></a> </dt><dd><div class="para">
												Path to the Operator’s <code class="literal">README.md</code> or other documentation
											</div></dd><dt><a href="#CO31-4"><span class="callout">4</span></a> </dt><dd><div class="para">
												Path to the Operator’s icon
											</div></dd><dt><a href="#CO31-5"><span class="callout">5</span></a> </dt><dd><div class="para">
												Output format: JSON or YAML
											</div></dd><dt><a href="#CO31-6"><span class="callout">6</span></a> </dt><dd><div class="para">
												Path for creating the catalog configuration file
											</div></dd></dl></div><p class="simpara">
										This command generates an <code class="literal">olm.package</code> declarative config blob in the specified catalog configuration file.
									</p></li></ol></div></li><li class="listitem"><p class="simpara">
								Add a bundle to the catalog by running the <code class="literal">opm render</code> command:
							</p><pre class="programlisting language-terminal">$ opm render &lt;registry&gt;/&lt;namespace&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt; \ <span id="CO32-1"><!--Empty--></span><span class="callout">1</span>
    --output=yaml \
    &gt;&gt; &lt;catalog_dir&gt;/index.yaml <span id="CO32-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO32-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Pull spec for the bundle image
									</div></dd><dt><a href="#CO32-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Path to the catalog configuration file
									</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Channels must contain at least one bundle.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Add a channel entry for the bundle. For example, modify the following example to your specifications, and add it to your <code class="literal">&lt;catalog_dir&gt;/index.yaml</code> file:
							</p><div class="formalpara"><p class="title"><strong>Example channel entry</strong></p><p>
									
<pre class="programlisting language-yaml">---
schema: olm.channel
package: &lt;operator_name&gt;
name: preview
entries:
  - name: &lt;operator_name&gt;.v0.1.0 <span id="CO33-1"><!--Empty--></span><span class="callout">1</span></pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO33-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Ensure that you include the period (<code class="literal">.</code>) after <code class="literal">&lt;operator_name&gt;</code> but before the <code class="literal">v</code> in the version. Otherwise, the entry fails to pass the <code class="literal">opm validate</code> command.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Validate the file-based catalog:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Run the <code class="literal">opm validate</code> command against the catalog directory:
									</p><pre class="programlisting language-terminal">$ opm validate &lt;catalog_dir&gt;</pre></li><li class="listitem"><p class="simpara">
										Check that the error code is <code class="literal">0</code>:
									</p><pre class="programlisting language-terminal">$ echo $?</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-terminal">0</pre>

										</p></div></li></ol></div></li><li class="listitem"><p class="simpara">
								Build the catalog image by running the <code class="literal">podman build</code> command:
							</p><pre class="programlisting language-terminal">$ podman build . \
    -f &lt;catalog_dir&gt;.Dockerfile \
    -t &lt;registry&gt;/&lt;namespace&gt;/&lt;catalog_image_name&gt;:&lt;tag&gt;</pre></li><li class="listitem"><p class="simpara">
								Push the catalog image to a registry:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										If required, authenticate with your target registry by running the <code class="literal">podman login</code> command:
									</p><pre class="programlisting language-terminal">$ podman login &lt;registry&gt;</pre></li><li class="listitem"><p class="simpara">
										Push the catalog image by running the <code class="literal">podman push</code> command:
									</p><pre class="programlisting language-terminal">$ podman push &lt;registry&gt;/&lt;namespace&gt;/&lt;catalog_image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cli_tools/#cli-opm-ref"><code class="literal">opm</code> CLI reference</a>
							</li></ul></div></section><section class="section" id="olm-filtering-fbc_olm-managing-custom-catalogs"><div class="titlepage"><div><div><h4 class="title">4.9.2.2. Updating or filtering a file-based catalog image</h4></div></div></div><p>
						You can use the <code class="literal">opm</code> CLI to update or filter (also known as prune) a catalog image that uses the file-based catalog format. By extracting and modifying the contents of an existing catalog image, you can update, add, or remove one or more Operator package entries from the catalog. You can then rebuild the image as an updated version of the catalog.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Alternatively, if you already have a catalog image on a mirror registry, you can use the oc-mirror CLI plugin to automatically prune any removed images from an updated source version of that catalog image while mirroring it to the target registry.
						</p><p>
							For more information about the oc-mirror plugin and this use case, see the "Keeping your mirror registry content updated" section, and specifically the "Pruning images" subsection, of "Mirroring images for a disconnected installation using the oc-mirror plugin".
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								You have the following on your workstation:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										The <code class="literal">opm</code> CLI.
									</li><li class="listitem">
										<code class="literal">podman</code> version 1.9.3+.
									</li><li class="listitem">
										A file-based catalog image.
									</li><li class="listitem"><p class="simpara">
										A catalog directory structure recently initialized on your workstation related to this catalog.
									</p><p class="simpara">
										If you do not have an initialized catalog directory, create the directory and generate the Dockerfile. For more information, see the "Initialize the catalog" step from the "Creating a file-based catalog image" procedure.
									</p></li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Extract the contents of the catalog image in YAML format to an <code class="literal">index.yaml</code> file in your catalog directory:
							</p><pre class="programlisting language-terminal">$ opm render &lt;registry&gt;/&lt;namespace&gt;/&lt;catalog_image_name&gt;:&lt;tag&gt; \
    -o yaml &gt; &lt;catalog_dir&gt;/index.yaml</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Alternatively, you can use the <code class="literal">-o json</code> flag to output in JSON format.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Modify the contents of the resulting <code class="literal">index.yaml</code> file to your specifications by updating, adding, or removing one or more Operator package entries.
							</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									After a bundle has been published in a catalog, assume that one of your users has installed it. Ensure that all previously published bundles in a catalog have an update path to the current or newer channel head to avoid stranding users that have that version installed.
								</p></div></div><p class="simpara">
								For example, if you wanted to remove an Operator package, the following example lists a set of <code class="literal">olm.package</code>, <code class="literal">olm.channel</code>, and <code class="literal">olm.bundle</code> blobs which must be deleted to remove the package from the catalog:
							</p><div class="example" id="idm139731994522800"><p class="title"><strong>Example 4.2. Example removed entries</strong></p><div class="example-contents"><pre class="programlisting language-yaml">---
defaultChannel: release-2.7
icon:
  base64data: &lt;base64_string&gt;
  mediatype: image/svg+xml
name: example-operator
schema: olm.package
---
entries:
- name: example-operator.v2.7.0
  skipRange: '&gt;=2.6.0 &lt;2.7.0'
- name: example-operator.v2.7.1
  replaces: example-operator.v2.7.0
  skipRange: '&gt;=2.6.0 &lt;2.7.1'
- name: example-operator.v2.7.2
  replaces: example-operator.v2.7.1
  skipRange: '&gt;=2.6.0 &lt;2.7.2'
- name: example-operator.v2.7.3
  replaces: example-operator.v2.7.2
  skipRange: '&gt;=2.6.0 &lt;2.7.3'
- name: example-operator.v2.7.4
  replaces: example-operator.v2.7.3
  skipRange: '&gt;=2.6.0 &lt;2.7.4'
name: release-2.7
package: example-operator
schema: olm.channel
---
image: example.com/example-inc/example-operator-bundle@sha256:&lt;digest&gt;
name: example-operator.v2.7.0
package: example-operator
properties:
- type: olm.gvk
  value:
    group: example-group.example.io
    kind: MyObject
    version: v1alpha1
- type: olm.gvk
  value:
    group: example-group.example.io
    kind: MyOtherObject
    version: v1beta1
- type: olm.package
  value:
    packageName: example-operator
    version: 2.7.0
- type: olm.bundle.object
  value:
    data: &lt;base64_string&gt;
- type: olm.bundle.object
  value:
    data: &lt;base64_string&gt;
relatedImages:
- image: example.com/example-inc/example-related-image@sha256:&lt;digest&gt;
  name: example-related-image
schema: olm.bundle
---</pre></div></div></li><li class="listitem">
								Save your changes to the <code class="literal">index.yaml</code> file.
							</li><li class="listitem"><p class="simpara">
								Validate the catalog:
							</p><pre class="programlisting language-terminal">$ opm validate &lt;catalog_dir&gt;</pre></li><li class="listitem"><p class="simpara">
								Rebuild the catalog:
							</p><pre class="programlisting language-terminal">$ podman build . \
    -f &lt;catalog_dir&gt;.Dockerfile \
    -t &lt;registry&gt;/&lt;namespace&gt;/&lt;catalog_image_name&gt;:&lt;tag&gt;</pre></li><li class="listitem"><p class="simpara">
								Push the updated catalog image to a registry:
							</p><pre class="programlisting language-terminal">$ podman push &lt;registry&gt;/&lt;namespace&gt;/&lt;catalog_image_name&gt;:&lt;tag&gt;</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								In the web console, navigate to the OperatorHub configuration resource in the <span class="strong strong"><strong>Administration</strong></span> → <span class="strong strong"><strong>Cluster Settings</strong></span> → <span class="strong strong"><strong>Configuration</strong></span> page.
							</li><li class="listitem"><p class="simpara">
								Add the catalog source or update the existing catalog source to use the pull spec for your updated catalog image.
							</p><p class="simpara">
								For more information, see "Adding a catalog source to a cluster" in the "Additional resources" of this section.
							</p></li><li class="listitem">
								After the catalog source is in a <span class="strong strong"><strong>READY</strong></span> state, navigate to the <span class="strong strong"><strong>Operators</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span> page and check that the changes you made are reflected in the list of Operators.
							</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#updating-mirror-registry-content">Mirroring images for a disconnected installation using the oc-mirror plugin → Keeping your mirror registry content updated</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-creating-catalog-from-index_olm-restricted-networks">Adding a catalog source to a cluster</a>
							</li></ul></div></section></section><section class="section" id="olm-managing-custom-catalogs-sqlite"><div class="titlepage"><div><div><h3 class="title">4.9.3. SQLite-based catalogs</h3></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The SQLite database format for Operator catalogs is a deprecated feature. Deprecated functionality is still included in OpenShift Container Platform and continues to be supported; however, it will be removed in a future release of this product and is not recommended for new deployments.
					</p><p>
						For the most recent list of major functionality that has been deprecated or removed within OpenShift Container Platform, refer to the <span class="emphasis"><em>Deprecated and removed features</em></span> section of the OpenShift Container Platform release notes.
					</p></div></div><section class="section" id="olm-creating-index-image_olm-managing-custom-catalogs"><div class="titlepage"><div><div><h4 class="title">4.9.3.1. Creating a SQLite-based index image</h4></div></div></div><p>
						You can create an index image based on the SQLite database format by using the <code class="literal">opm</code> CLI.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have installed the <code class="literal">opm</code> CLI.
							</li><li class="listitem">
								You have <code class="literal">podman</code> version 1.9.3+.
							</li><li class="listitem">
								A bundle image is built and pushed to a registry that supports <a class="link" href="https://docs.docker.com/registry/spec/manifest-v2-2/">Docker v2-2</a>.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Start a new index:
							</p><pre class="programlisting language-terminal">$ opm index add \
    --bundles &lt;registry&gt;/&lt;namespace&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt; \<span id="CO34-1"><!--Empty--></span><span class="callout">1</span>
    --tag &lt;registry&gt;/&lt;namespace&gt;/&lt;index_image_name&gt;:&lt;tag&gt; \<span id="CO34-2"><!--Empty--></span><span class="callout">2</span>
    [--binary-image &lt;registry_base_image&gt;] <span id="CO34-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO34-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Comma-separated list of bundle images to add to the index.
									</div></dd><dt><a href="#CO34-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										The image tag that you want the index image to have.
									</div></dd><dt><a href="#CO34-3"><span class="callout">3</span></a> </dt><dd><div class="para">
										Optional: An alternative registry base image to use for serving the catalog.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Push the index image to a registry.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										If required, authenticate with your target registry:
									</p><pre class="programlisting language-terminal">$ podman login &lt;registry&gt;</pre></li><li class="listitem"><p class="simpara">
										Push the index image:
									</p><pre class="programlisting language-terminal">$ podman push &lt;registry&gt;/&lt;namespace&gt;/&lt;index_image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li></ol></div></section><section class="section" id="olm-updating-index-image_olm-managing-custom-catalogs"><div class="titlepage"><div><div><h4 class="title">4.9.3.2. Updating a SQLite-based index image</h4></div></div></div><p>
						After configuring OperatorHub to use a catalog source that references a custom index image, cluster administrators can keep the available Operators on their cluster up-to-date by adding bundle images to the index image.
					</p><p>
						You can update an existing index image using the <code class="literal">opm index add</code> command.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have installed the <code class="literal">opm</code> CLI.
							</li><li class="listitem">
								You have <code class="literal">podman</code> version 1.9.3+.
							</li><li class="listitem">
								An index image is built and pushed to a registry.
							</li><li class="listitem">
								You have an existing catalog source referencing the index image.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Update the existing index by adding bundle images:
							</p><pre class="programlisting language-terminal">$ opm index add \
    --bundles &lt;registry&gt;/&lt;namespace&gt;/&lt;new_bundle_image&gt;@sha256:&lt;digest&gt; \<span id="CO35-1"><!--Empty--></span><span class="callout">1</span>
    --from-index &lt;registry&gt;/&lt;namespace&gt;/&lt;existing_index_image&gt;:&lt;existing_tag&gt; \<span id="CO35-2"><!--Empty--></span><span class="callout">2</span>
    --tag &lt;registry&gt;/&lt;namespace&gt;/&lt;existing_index_image&gt;:&lt;updated_tag&gt; \<span id="CO35-3"><!--Empty--></span><span class="callout">3</span>
    --pull-tool podman <span id="CO35-4"><!--Empty--></span><span class="callout">4</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO35-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										The <code class="literal">--bundles</code> flag specifies a comma-separated list of additional bundle images to add to the index.
									</div></dd><dt><a href="#CO35-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										The <code class="literal">--from-index</code> flag specifies the previously pushed index.
									</div></dd><dt><a href="#CO35-3"><span class="callout">3</span></a> </dt><dd><div class="para">
										The <code class="literal">--tag</code> flag specifies the image tag to apply to the updated index image.
									</div></dd><dt><a href="#CO35-4"><span class="callout">4</span></a> </dt><dd><div class="para">
										The <code class="literal">--pull-tool</code> flag specifies the tool used to pull container images.
									</div></dd></dl></div><p class="simpara">
								where:
							</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">&lt;registry&gt;</code></span></dt><dd>
											Specifies the hostname of the registry, such as <code class="literal">quay.io</code> or <code class="literal">mirror.example.com</code>.
										</dd><dt><span class="term"><code class="literal">&lt;namespace&gt;</code></span></dt><dd>
											Specifies the namespace of the registry, such as <code class="literal">ocs-dev</code> or <code class="literal">abc</code>.
										</dd><dt><span class="term"><code class="literal">&lt;new_bundle_image&gt;</code></span></dt><dd>
											Specifies the new bundle image to add to the registry, such as <code class="literal">ocs-operator</code>.
										</dd><dt><span class="term"><code class="literal">&lt;digest&gt;</code></span></dt><dd>
											Specifies the SHA image ID, or digest, of the bundle image, such as <code class="literal">c7f11097a628f092d8bad148406aa0e0951094a03445fd4bc0775431ef683a41</code>.
										</dd><dt><span class="term"><code class="literal">&lt;existing_index_image&gt;</code></span></dt><dd>
											Specifies the previously pushed image, such as <code class="literal">abc-redhat-operator-index</code>.
										</dd><dt><span class="term"><code class="literal">&lt;existing_tag&gt;</code></span></dt><dd>
											Specifies a previously pushed image tag, such as <code class="literal">4.13</code>.
										</dd><dt><span class="term"><code class="literal">&lt;updated_tag&gt;</code></span></dt><dd>
											Specifies the image tag to apply to the updated index image, such as <code class="literal">4.13.1</code>.
										</dd></dl></div><div class="formalpara"><p class="title"><strong>Example command</strong></p><p>
									
<pre class="programlisting language-terminal">$ opm index add \
    --bundles quay.io/ocs-dev/ocs-operator@sha256:c7f11097a628f092d8bad148406aa0e0951094a03445fd4bc0775431ef683a41 \
    --from-index mirror.example.com/abc/abc-redhat-operator-index:4.13 \
    --tag mirror.example.com/abc/abc-redhat-operator-index:4.13.1 \
    --pull-tool podman</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Push the updated index image:
							</p><pre class="programlisting language-terminal">$ podman push &lt;registry&gt;/&lt;namespace&gt;/&lt;existing_index_image&gt;:&lt;updated_tag&gt;</pre></li><li class="listitem"><p class="simpara">
								After Operator Lifecycle Manager (OLM) automatically polls the index image referenced in the catalog source at its regular interval, verify that the new packages are successfully added:
							</p><pre class="programlisting language-terminal">$ oc get packagemanifests -n openshift-marketplace</pre></li></ol></div></section><section class="section" id="olm-pruning-index-image_olm-managing-custom-catalogs"><div class="titlepage"><div><div><h4 class="title">4.9.3.3. Filtering a SQLite-based index image</h4></div></div></div><p>
						An index image, based on the Operator bundle format, is a containerized snapshot of an Operator catalog. You can filter, or <span class="emphasis"><em>prune</em></span>, an index of all but a specified list of packages, which creates a copy of the source index containing only the Operators that you want.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have <code class="literal">podman</code> version 1.9.3+.
							</li><li class="listitem">
								You have <a class="link" href="https://github.com/fullstorydev/grpcurl"><code class="literal">grpcurl</code></a> (third-party command-line tool).
							</li><li class="listitem">
								You have installed the <code class="literal">opm</code> CLI.
							</li><li class="listitem">
								You have access to a registry that supports <a class="link" href="https://docs.docker.com/registry/spec/manifest-v2-2/">Docker v2-2</a>.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Authenticate with your target registry:
							</p><pre class="programlisting language-terminal">$ podman login &lt;target_registry&gt;</pre></li><li class="listitem"><p class="simpara">
								Determine the list of packages you want to include in your pruned index.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Run the source index image that you want to prune in a container. For example:
									</p><pre class="programlisting language-terminal">$ podman run -p50051:50051 \
    -it registry.redhat.io/redhat/redhat-operator-index:v4.13</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-terminal">Trying to pull registry.redhat.io/redhat/redhat-operator-index:v4.13...
Getting image source signatures
Copying blob ae8a0c23f5b1 done
...
INFO[0000] serving registry                              database=/database/index.db port=50051</pre>

										</p></div></li><li class="listitem"><p class="simpara">
										In a separate terminal session, use the <code class="literal">grpcurl</code> command to get a list of the packages provided by the index:
									</p><pre class="programlisting language-terminal">$ grpcurl -plaintext localhost:50051 api.Registry/ListPackages &gt; packages.out</pre></li><li class="listitem"><p class="simpara">
										Inspect the <code class="literal">packages.out</code> file and identify which package names from this list you want to keep in your pruned index. For example:
									</p><div class="formalpara"><p class="title"><strong>Example snippets of packages list</strong></p><p>
											
<pre class="programlisting language-text">...
{
  "name": "advanced-cluster-management"
}
...
{
  "name": "jaeger-product"
}
...
{
{
  "name": "quay-operator"
}
...</pre>

										</p></div></li><li class="listitem">
										In the terminal session where you executed the <code class="literal">podman run</code> command, press <span class="keycap"><strong>Ctrl</strong></span> and <span class="keycap"><strong>C</strong></span> to stop the container process.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Run the following command to prune the source index of all but the specified packages:
							</p><pre class="programlisting language-text">$ opm index prune \
    -f registry.redhat.io/redhat/redhat-operator-index:v4.13 \<span id="CO36-1"><!--Empty--></span><span class="callout">1</span>
    -p advanced-cluster-management,jaeger-product,quay-operator \<span id="CO36-2"><!--Empty--></span><span class="callout">2</span>
    [-i registry.redhat.io/openshift4/ose-operator-registry:v4.9] \<span id="CO36-3"><!--Empty--></span><span class="callout">3</span>
    -t &lt;target_registry&gt;:&lt;port&gt;/&lt;namespace&gt;/redhat-operator-index:v4.13 <span id="CO36-4"><!--Empty--></span><span class="callout">4</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO36-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Index to prune.
									</div></dd><dt><a href="#CO36-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Comma-separated list of packages to keep.
									</div></dd><dt><a href="#CO36-3"><span class="callout">3</span></a> </dt><dd><div class="para">
										Required only for IBM Power and IBM Z images: Operator Registry base image with the tag that matches the target OpenShift Container Platform cluster major and minor version.
									</div></dd><dt><a href="#CO36-4"><span class="callout">4</span></a> </dt><dd><div class="para">
										Custom tag for new index image being built.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Run the following command to push the new index image to your target registry:
							</p><pre class="programlisting language-text">$ podman push &lt;target_registry&gt;:&lt;port&gt;/&lt;namespace&gt;/redhat-operator-index:v4.13</pre><p class="simpara">
								where <code class="literal">&lt;namespace&gt;</code> is any existing namespace on the registry.
							</p></li></ol></div></section></section><section class="section" id="olm-catalog-sources-and-psa_olm-managing-custom-catalogs"><div class="titlepage"><div><div><h3 class="title">4.9.4. Catalog sources and pod security admission</h3></div></div></div><p>
					<span class="emphasis"><em>Pod security admission</em></span> was introduced in OpenShift Container Platform 4.11 to ensure pod security standards. Catalog sources built using the SQLite-based catalog format and a version of the <code class="literal">opm</code> CLI tool released before OpenShift Container Platform 4.11 cannot run under restricted pod security enforcement.
				</p><p>
					In OpenShift Container Platform 4.13, namespaces do not have restricted pod security enforcement by default and the default catalog source security mode is set to <code class="literal">legacy</code>.
				</p><p>
					Default restricted enforcement for all namespaces is planned for inclusion in a future OpenShift Container Platform release. When restricted enforcement occurs, the security context of the pod specification for catalog source pods must match the restricted pod security standard. If your catalog source image requires a different pod security standard, the pod security admissions label for the namespace must be explicitly set.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you do not want to run your SQLite-based catalog source pods as restricted, you do not need to update your catalog source in OpenShift Container Platform 4.13.
					</p><p>
						However, it is recommended that you take action now to ensure your catalog sources run under restricted pod security enforcement. If you do not take action to ensure your catalog sources run under restricted pod security enforcement, your catalog sources might not run in future OpenShift Container Platform releases.
					</p></div></div><p>
					As a catalog author, you can enable compatibility with restricted pod security enforcement by completing either of the following actions:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Migrate your catalog to the file-based catalog format.
						</li><li class="listitem">
							Update your catalog image with a version of the <code class="literal">opm</code> CLI tool released with OpenShift Container Platform 4.11 or later.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The SQLite database catalog format is deprecated, but still supported by Red Hat. In a future release, the SQLite database format will not be supported, and catalogs will need to migrate to the file-based catalog format. As of OpenShift Container Platform 4.11, the default Red Hat-provided Operator catalog is released in the file-based catalog format. File-based catalogs are compatible with restricted pod security enforcement.
					</p></div></div><p>
					If you do not want to update your SQLite database catalog image or migrate your catalog to the file-based catalog format, you can configure your catalog to run with elevated permissions.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#understanding-and-managing-pod-security-admission">Understanding and managing pod security admission</a>
						</li></ul></div><section class="section" id="olm-migrating-sqlite-catalog-to-fbc_olm-managing-custom-catalogs"><div class="titlepage"><div><div><h4 class="title">4.9.4.1. Migrating SQLite database catalogs to the file-based catalog format</h4></div></div></div><p>
						You can update your deprecated SQLite database format catalogs to the file-based catalog format.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have a SQLite database catalog source.
							</li><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
							</li><li class="listitem">
								You have the latest version of the <code class="literal">opm</code> CLI tool released with OpenShift Container Platform 4.13 on your workstation.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Migrate your SQLite database catalog to a file-based catalog by running the following command:
							</p><pre class="programlisting language-terminal">$ opm migrate &lt;registry_image&gt; &lt;fbc_directory&gt;</pre></li><li class="listitem"><p class="simpara">
								Generate a Dockerfile for your file-based catalog by running the following command:
							</p><pre class="programlisting language-terminal">$ opm generate dockerfile &lt;fbc_directory&gt; \
  --binary-image \
  registry.redhat.io/openshift4/ose-operator-registry:v4.13</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Next steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The generated Dockerfile can be built, tagged, and pushed to your registry.
							</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-creating-catalog-from-index_olm-managing-custom-catalogs">Adding a catalog source to a cluster</a>
							</li></ul></div></section><section class="section" id="olm-updating-sqlite-catalog-to-a-new-opm-version_olm-managing-custom-catalogs"><div class="titlepage"><div><div><h4 class="title">4.9.4.2. Rebuilding SQLite database catalog images</h4></div></div></div><p>
						You can rebuild your SQLite database catalog image with the latest version of the <code class="literal">opm</code> CLI tool that is released with your version of OpenShift Container Platform.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have a SQLite database catalog source.
							</li><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
							</li><li class="listitem">
								You have the latest version of the <code class="literal">opm</code> CLI tool released with OpenShift Container Platform 4.13 on your workstation.
							</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Run the following command to rebuild your catalog with a more recent version of the <code class="literal">opm</code> CLI tool:
							</p><pre class="programlisting language-terminal">$ opm index add --binary-image \
  registry.redhat.io/openshift4/ose-operator-registry:v4.13 \
  --from-index &lt;your_registry_image&gt; \
  --bundles "" -t \&lt;your_registry_image&gt;</pre></li></ul></div></section><section class="section" id="olm-sqlite-catalog-elevated-privileges_olm-managing-custom-catalogs"><div class="titlepage"><div><div><h4 class="title">4.9.4.3. Configuring catalogs to run with elevated permissions</h4></div></div></div><p>
						If you do not want to update your SQLite database catalog image or migrate your catalog to the file-based catalog format, you can perform the following actions to ensure your catalog source runs when the default pod security enforcement changes to restricted:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Manually set the catalog security mode to legacy in your catalog source definition. This action ensures your catalog runs with legacy permissions even if the default catalog security mode changes to restricted.
							</li><li class="listitem">
								Label the catalog source namespace for baseline or privileged pod security enforcement.
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The SQLite database catalog format is deprecated, but still supported by Red Hat. In a future release, the SQLite database format will not be supported, and catalogs will need to migrate to the file-based catalog format. File-based catalogs are compatible with restricted pod security enforcement.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have a SQLite database catalog source.
							</li><li class="listitem">
								You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
							</li><li class="listitem">
								You have a target namespace that supports running pods with the elevated pod security admission standard of <code class="literal">baseline</code> or <code class="literal">privileged</code>.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Edit the <code class="literal">CatalogSource</code> definition by setting the <code class="literal">spec.grpcPodConfig.securityContextConfig</code> label to <code class="literal">legacy</code>, as shown in the following example:
							</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">CatalogSource</code> definition</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: CatalogSource
metadata:
  name: my-catsrc
  namespace: my-ns
spec:
  sourceType: grpc
  grpcPodConfig:
    securityContextConfig: legacy
  image: my-image:latest</pre>

								</p></div><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
								In OpenShift Container Platform 4.13, the <code class="literal">spec.grpcPodConfig.securityContextConfig</code> field is set to <code class="literal">legacy</code> by default. In a future release of OpenShift Container Platform, it is planned that the default setting will change to <code class="literal">restricted</code>. If your catalog cannot run under restricted enforcement, it is recommended that you manually set this field to <code class="literal">legacy</code>.
							</p></div></div></li><li class="listitem"><p class="simpara">
								Edit your <code class="literal">&lt;namespace&gt;.yaml</code> file to add elevated pod security admission standards to your catalog source namespace, as shown in the following example:
							</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">&lt;namespace&gt;.yaml</code> file</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: v1
kind: Namespace
metadata:
...
  labels:
    security.openshift.io/scc.podSecurityLabelSync: "false" <span id="CO37-1"><!--Empty--></span><span class="callout">1</span>
    openshift.io/cluster-monitoring: "true"
    pod-security.kubernetes.io/enforce: baseline <span id="CO37-2"><!--Empty--></span><span class="callout">2</span>
  name: "&lt;namespace_name&gt;"</pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO37-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Turn off pod security label synchronization by adding the <code class="literal">security.openshift.io/scc.podSecurityLabelSync=false</code> label to the namespace.
									</div></dd><dt><a href="#CO37-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Apply the pod security admission <code class="literal">pod-security.kubernetes.io/enforce</code> label. Set the label to <code class="literal">baseline</code> or <code class="literal">privileged</code>. Use the <code class="literal">baseline</code> pod security profile unless other workloads in the namespace require a <code class="literal">privileged</code> profile.
									</div></dd></dl></div></li></ol></div></section></section><section class="section" id="olm-creating-catalog-from-index_olm-managing-custom-catalogs"><div class="titlepage"><div><div><h3 class="title">4.9.5. Adding a catalog source to a cluster</h3></div></div></div><p>
					Adding a catalog source to an OpenShift Container Platform cluster enables the discovery and installation of Operators for users. Cluster administrators can create a <code class="literal">CatalogSource</code> object that references an index image. OperatorHub uses catalog sources to populate the user interface.
				</p><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
					Alternatively, you can use the web console to manage catalog sources. From the <span class="strong strong"><strong>Administration</strong></span> → <span class="strong strong"><strong>Cluster Settings</strong></span> → <span class="strong strong"><strong>Configuration</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span> page, click the <span class="strong strong"><strong>Sources</strong></span> tab, where you can create, update, delete, disable, and enable individual sources.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You built and pushed an index image to a registry.
						</li><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a <code class="literal">CatalogSource</code> object that references your index image.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Modify the following to your specifications and save it as a <code class="literal">catalogSource.yaml</code> file:
								</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: CatalogSource
metadata:
  name: my-operator-catalog
  namespace: openshift-marketplace <span id="CO38-1"><!--Empty--></span><span class="callout">1</span>
  annotations:
    olm.catalogImageTemplate: <span id="CO38-2"><!--Empty--></span><span class="callout">2</span>
      "&lt;registry&gt;/&lt;namespace&gt;/&lt;index_image_name&gt;:v{kube_major_version}.{kube_minor_version}.{kube_patch_version}"
spec:
  sourceType: grpc
  grpcPodConfig:
    securityContextConfig: &lt;security_mode&gt; <span id="CO38-3"><!--Empty--></span><span class="callout">3</span>
  image: &lt;registry&gt;/&lt;namespace&gt;/&lt;index_image_name&gt;:&lt;tag&gt; <span id="CO38-4"><!--Empty--></span><span class="callout">4</span>
  displayName: My Operator Catalog
  publisher: &lt;publisher_name&gt; <span id="CO38-5"><!--Empty--></span><span class="callout">5</span>
  updateStrategy:
    registryPoll: <span id="CO38-6"><!--Empty--></span><span class="callout">6</span>
      interval: 30m</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO38-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											If you want the catalog source to be available globally to users in all namespaces, specify the <code class="literal">openshift-marketplace</code> namespace. Otherwise, you can specify a different namespace for the catalog to be scoped and available only for that namespace.
										</div></dd><dt><a href="#CO38-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Optional: Set the <code class="literal">olm.catalogImageTemplate</code> annotation to your index image name and use one or more of the Kubernetes cluster version variables as shown when constructing the template for the image tag.
										</div></dd><dt><a href="#CO38-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Specify the value of <code class="literal">legacy</code> or <code class="literal">restricted</code>. If the field is not set, the default value is <code class="literal">legacy</code>. In a future OpenShift Container Platform release, it is planned that the default value will be <code class="literal">restricted</code>. If your catalog cannot run with <code class="literal">restricted</code> permissions, it is recommended that you manually set this field to <code class="literal">legacy</code>.
										</div></dd><dt><a href="#CO38-4"><span class="callout">4</span></a> </dt><dd><div class="para">
											Specify your index image. If you specify a tag after the image name, for example <code class="literal">:v4.13</code>, the catalog source pod uses an image pull policy of <code class="literal">Always</code>, meaning the pod always pulls the image prior to starting the container. If you specify a digest, for example <code class="literal">@sha256:&lt;id&gt;</code>, the image pull policy is <code class="literal">IfNotPresent</code>, meaning the pod pulls the image only if it does not already exist on the node.
										</div></dd><dt><a href="#CO38-5"><span class="callout">5</span></a> </dt><dd><div class="para">
											Specify your name or an organization name publishing the catalog.
										</div></dd><dt><a href="#CO38-6"><span class="callout">6</span></a> </dt><dd><div class="para">
											Catalog sources can automatically check for new versions to keep up to date.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Use the file to create the <code class="literal">CatalogSource</code> object:
								</p><pre class="programlisting language-terminal">$ oc apply -f catalogSource.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Verify the following resources are created successfully.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Check the pods:
								</p><pre class="programlisting language-terminal">$ oc get pods -n openshift-marketplace</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME                                    READY   STATUS    RESTARTS  AGE
my-operator-catalog-6njx6               1/1     Running   0         28s
marketplace-operator-d9f549946-96sgr    1/1     Running   0         26h</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Check the catalog source:
								</p><pre class="programlisting language-terminal">$ oc get catalogsource -n openshift-marketplace</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME                  DISPLAY               TYPE PUBLISHER  AGE
my-operator-catalog   My Operator Catalog   grpc            5s</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Check the package manifest:
								</p><pre class="programlisting language-terminal">$ oc get packagemanifest -n openshift-marketplace</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME                          CATALOG               AGE
jaeger-product                My Operator Catalog   93s</pre>

									</p></div></li></ol></div></li></ol></div><p>
					You can now install the Operators from the <span class="strong strong"><strong>OperatorHub</strong></span> page on your OpenShift Container Platform web console.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-catalogsource_olm-understanding-olm">Operator Lifecycle Manager concepts and resources → Catalog source</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-accessing-images-private-registries_olm-managing-custom-catalogs">Accessing images for Operators from private registries</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#image-pull-policy">Image pull policy</a>
						</li></ul></div></section><section class="section" id="olm-accessing-images-private-registries_olm-managing-custom-catalogs"><div class="titlepage"><div><div><h3 class="title">4.9.6. Accessing images for Operators from private registries</h3></div></div></div><p>
					If certain images relevant to Operators managed by Operator Lifecycle Manager (OLM) are hosted in an authenticated container image registry, also known as a private registry, OLM and OperatorHub are unable to pull the images by default. To enable access, you can create a pull secret that contains the authentication credentials for the registry. By referencing one or more pull secrets in a catalog source, OLM can handle placing the secrets in the Operator and catalog namespace to allow installation.
				</p><p>
					Other images required by an Operator or its Operands might require access to private registries as well. OLM does not handle placing the secrets in target tenant namespaces for this scenario, but authentication credentials can be added to the global cluster pull secret or individual namespace service accounts to enable the required access.
				</p><p>
					The following types of images should be considered when determining whether Operators managed by OLM have appropriate pull access:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Index images</span></dt><dd>
								A <code class="literal">CatalogSource</code> object can reference an index image, which use the Operator bundle format and are catalog sources packaged as container images hosted in images registries. If an index image is hosted in a private registry, a secret can be used to enable pull access.
							</dd><dt><span class="term">Bundle images</span></dt><dd>
								Operator bundle images are metadata and manifests packaged as container images that represent a unique version of an Operator. If any bundle images referenced in a catalog source are hosted in one or more private registries, a secret can be used to enable pull access.
							</dd><dt><span class="term">Operator and Operand images</span></dt><dd><p class="simpara">
								If an Operator installed from a catalog source uses a private image, either for the Operator image itself or one of the Operand images it watches, the Operator will fail to install because the deployment will not have access to the required registry authentication. Referencing secrets in a catalog source does not enable OLM to place the secrets in target tenant namespaces in which Operands are installed.
							</p><p class="simpara">
								Instead, the authentication details can be added to the global cluster pull secret in the <code class="literal">openshift-config</code> namespace, which provides access to all namespaces on the cluster. Alternatively, if providing access to the entire cluster is not permissible, the pull secret can be added to the <code class="literal">default</code> service accounts of the target tenant namespaces.
							</p></dd></dl></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							You have at least one of the following hosted in a private registry:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									An index image or catalog image.
								</li><li class="listitem">
									An Operator bundle image.
								</li><li class="listitem">
									An Operator or Operand image.
								</li></ul></div></li><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a secret for each required private registry.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Log in to the private registry to create or update your registry credentials file:
								</p><pre class="programlisting language-terminal">$ podman login &lt;registry&gt;:&lt;port&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										The file path of your registry credentials can be different depending on the container tool used to log in to the registry. For the <code class="literal">podman</code> CLI, the default location is <code class="literal">${XDG_RUNTIME_DIR}/containers/auth.json</code>. For the <code class="literal">docker</code> CLI, the default location is <code class="literal">/root/.docker/config.json</code>.
									</p></div></div></li><li class="listitem"><p class="simpara">
									It is recommended to include credentials for only one registry per secret, and manage credentials for multiple registries in separate secrets. Multiple secrets can be included in a <code class="literal">CatalogSource</code> object in later steps, and OpenShift Container Platform will merge the secrets into a single virtual credentials file for use during an image pull.
								</p><p class="simpara">
									A registry credentials file can, by default, store details for more than one registry or for multiple repositories in one registry. Verify the current contents of your file. For example:
								</p><div class="formalpara"><p class="title"><strong>File storing credentials for multiple registries</strong></p><p>
										
<pre class="programlisting language-json">{
    "auths": {
        "registry.redhat.io": {
            "auth": "FrNHNydQXdzclNqdg=="
        },
        "quay.io": {
            "auth": "fegdsRib21iMQ=="
        },
        "https://quay.io/my-namespace/my-user/my-image": {
            "auth": "eWfjwsDdfsa221=="
        },
        "https://quay.io/my-namespace/my-user": {
            "auth": "feFweDdscw34rR=="
        },
        "https://quay.io/my-namespace": {
            "auth": "frwEews4fescyq=="
        }
    }
}</pre>

									</p></div><p class="simpara">
									Because this file is used to create secrets in later steps, ensure that you are storing details for only one registry per file. This can be accomplished by using either of the following methods:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Use the <code class="literal">podman logout &lt;registry&gt;</code> command to remove credentials for additional registries until only the one registry you want remains.
										</li><li class="listitem"><p class="simpara">
											Edit your registry credentials file and separate the registry details to be stored in multiple files. For example:
										</p><div class="formalpara"><p class="title"><strong>File storing credentials for one registry</strong></p><p>
												
<pre class="programlisting language-json">{
        "auths": {
                "registry.redhat.io": {
                        "auth": "FrNHNydQXdzclNqdg=="
                }
        }
}</pre>

											</p></div><div class="formalpara"><p class="title"><strong>File storing credentials for another registry</strong></p><p>
												
<pre class="programlisting language-json">{
        "auths": {
                "quay.io": {
                        "auth": "Xd2lhdsbnRib21iMQ=="
                }
        }
}</pre>

											</p></div></li></ul></div></li><li class="listitem"><p class="simpara">
									Create a secret in the <code class="literal">openshift-marketplace</code> namespace that contains the authentication credentials for a private registry:
								</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;secret_name&gt; \
    -n openshift-marketplace \
    --from-file=.dockerconfigjson=&lt;path/to/registry/credentials&gt; \
    --type=kubernetes.io/dockerconfigjson</pre><p class="simpara">
									Repeat this step to create additional secrets for any other required private registries, updating the <code class="literal">--from-file</code> flag to specify another registry credentials file path.
								</p></li></ol></div></li><li class="listitem"><p class="simpara">
							Create or update an existing <code class="literal">CatalogSource</code> object to reference one or more secrets:
						</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: CatalogSource
metadata:
  name: my-operator-catalog
  namespace: openshift-marketplace
spec:
  sourceType: grpc
  secrets: <span id="CO39-1"><!--Empty--></span><span class="callout">1</span>
  - "&lt;secret_name_1&gt;"
  - "&lt;secret_name_2&gt;"
  grpcPodConfig:
    securityContextConfig: &lt;security_mode&gt; <span id="CO39-2"><!--Empty--></span><span class="callout">2</span>
  image: &lt;registry&gt;:&lt;port&gt;/&lt;namespace&gt;/&lt;image&gt;:&lt;tag&gt;
  displayName: My Operator Catalog
  publisher: &lt;publisher_name&gt;
  updateStrategy:
    registryPoll:
      interval: 30m</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO39-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Add a <code class="literal">spec.secrets</code> section and specify any required secrets.
								</div></dd><dt><a href="#CO39-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Specify the value of <code class="literal">legacy</code> or <code class="literal">restricted</code>. If the field is not set, the default value is <code class="literal">legacy</code>. In a future OpenShift Container Platform release, it is planned that the default value will be <code class="literal">restricted</code>. If your catalog cannot run with <code class="literal">restricted</code> permissions, it is recommended that you manually set this field to <code class="literal">legacy</code>.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							If any Operator or Operand images that are referenced by a subscribed Operator require access to a private registry, you can either provide access to all namespaces in the cluster, or individual target tenant namespaces.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To provide access to all namespaces in the cluster, add authentication details to the global cluster pull secret in the <code class="literal">openshift-config</code> namespace.
								</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
										Cluster resources must adjust to the new global pull secret, which can temporarily limit the usability of the cluster.
									</p></div></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Extract the <code class="literal">.dockerconfigjson</code> file from the global pull secret:
										</p><pre class="programlisting language-terminal">$ oc extract secret/pull-secret -n openshift-config --confirm</pre></li><li class="listitem"><p class="simpara">
											Update the <code class="literal">.dockerconfigjson</code> file with your authentication credentials for the required private registry or registries and save it as a new file:
										</p><pre class="programlisting language-terminal">$ cat .dockerconfigjson | \
    jq --compact-output '.auths["&lt;registry&gt;:&lt;port&gt;/&lt;namespace&gt;/"] |= . + {"auth":"&lt;token&gt;"}' \<span id="CO40-1"><!--Empty--></span><span class="callout">1</span>
    &gt; new_dockerconfigjson</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO40-1"><span class="callout">1</span></a> </dt><dd><div class="para">
													Replace <code class="literal">&lt;registry&gt;:&lt;port&gt;/&lt;namespace&gt;</code> with the private registry details and <code class="literal">&lt;token&gt;</code> with your authentication credentials.
												</div></dd></dl></div></li><li class="listitem"><p class="simpara">
											Update the global pull secret with the new file:
										</p><pre class="programlisting language-terminal">$ oc set data secret/pull-secret -n openshift-config \
    --from-file=.dockerconfigjson=new_dockerconfigjson</pre></li></ol></div></li><li class="listitem"><p class="simpara">
									To update an individual namespace, add a pull secret to the service account for the Operator that requires access in the target tenant namespace.
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Recreate the secret that you created for the <code class="literal">openshift-marketplace</code> in the tenant namespace:
										</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;secret_name&gt; \
    -n &lt;tenant_namespace&gt; \
    --from-file=.dockerconfigjson=&lt;path/to/registry/credentials&gt; \
    --type=kubernetes.io/dockerconfigjson</pre></li><li class="listitem"><p class="simpara">
											Verify the name of the service account for the Operator by searching the tenant namespace:
										</p><pre class="programlisting language-terminal">$ oc get sa -n &lt;tenant_namespace&gt; <span id="CO41-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO41-1"><span class="callout">1</span></a> </dt><dd><div class="para">
													If the Operator was installed in an individual namespace, search that namespace. If the Operator was installed for all namespaces, search the <code class="literal">openshift-operators</code> namespace.
												</div></dd></dl></div><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
												
<pre class="programlisting language-terminal">NAME            SECRETS   AGE
builder         2         6m1s
default         2         6m1s
deployer        2         6m1s
etcd-operator   2         5m18s <span id="CO42-1"><!--Empty--></span><span class="callout">1</span></pre>

											</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO42-1"><span class="callout">1</span></a> </dt><dd><div class="para">
													Service account for an installed etcd Operator.
												</div></dd></dl></div></li><li class="listitem"><p class="simpara">
											Link the secret to the service account for the Operator:
										</p><pre class="programlisting language-terminal">$ oc secrets link &lt;operator_sa&gt; \
    -n &lt;tenant_namespace&gt; \
     &lt;secret_name&gt; \
    --for=pull</pre></li></ol></div></li></ul></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#builds-secrets-overview_creating-build-inputs">What is a secret?</a> for more information on the types of secrets, including those used for registry credentials.
						</li><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#images-update-global-pull-secret_using-image-pull-secrets">Updating the global cluster pull secret</a> for more details on the impact of changing this secret.
						</li><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#images-allow-pods-to-reference-images-from-secure-registries_using-image-pull-secrets">Allowing pods to reference images from other secured registries</a> for more details on linking pull secrets to service accounts per namespace.
						</li></ul></div></section><section class="section" id="olm-restricted-networks-operatorhub_olm-managing-custom-catalogs"><div class="titlepage"><div><div><h3 class="title">4.9.7. Disabling the default OperatorHub catalog sources</h3></div></div></div><p>
					Operator catalogs that source content provided by Red Hat and community projects are configured for OperatorHub by default during an OpenShift Container Platform installation. As a cluster administrator, you can disable the set of default catalogs.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Disable the sources for the default catalogs by adding <code class="literal">disableAllDefaultSources: true</code> to the <code class="literal">OperatorHub</code> object:
						</p><pre class="programlisting language-terminal">$ oc patch OperatorHub cluster --type json \
    -p '[{"op": "add", "path": "/spec/disableAllDefaultSources", "value": true}]'</pre></li></ul></div><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
					Alternatively, you can use the web console to manage catalog sources. From the <span class="strong strong"><strong>Administration</strong></span> → <span class="strong strong"><strong>Cluster Settings</strong></span> → <span class="strong strong"><strong>Configuration</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span> page, click the <span class="strong strong"><strong>Sources</strong></span> tab, where you can create, update, delete, disable, and enable individual sources.
				</p></div></div></section><section class="section" id="olm-removing-catalogs_olm-managing-custom-catalogs"><div class="titlepage"><div><div><h3 class="title">4.9.8. Removing custom catalogs</h3></div></div></div><p>
					As a cluster administrator, you can remove custom Operator catalogs that have been previously added to your cluster by deleting the related catalog source.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the <span class="strong strong"><strong>Administrator</strong></span> perspective of the web console, navigate to <span class="strong strong"><strong>Administration</strong></span> → <span class="strong strong"><strong>Cluster Settings</strong></span>.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Configuration</strong></span> tab, and then click <span class="strong strong"><strong>OperatorHub</strong></span>.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Sources</strong></span> tab.
						</li><li class="listitem">
							Select the <span class="strong strong"><strong>Options</strong></span> menu 
							<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Operators-en-US/images/f468284ec3cc9bf27e6bd2c83849ca50/kebab.png" alt="kebab"/></span>
							 for the catalog that you want to remove, and then click <span class="strong strong"><strong>Delete CatalogSource</strong></span>.
						</li></ol></div></section></section><section class="section" id="olm-restricted-networks"><div class="titlepage"><div><div><h2 class="title">4.10. Using Operator Lifecycle Manager on restricted networks</h2></div></div></div><p>
				For OpenShift Container Platform clusters that are installed on restricted networks, also known as <span class="emphasis"><em>disconnected clusters</em></span>, Operator Lifecycle Manager (OLM) by default cannot access the Red Hat-provided OperatorHub sources hosted on remote registries because those remote sources require full internet connectivity.
			</p><p>
				However, as a cluster administrator you can still enable your cluster to use OLM in a restricted network if you have a workstation that has full internet access. The workstation, which requires full internet access to pull the remote OperatorHub content, is used to prepare local mirrors of the remote sources, and push the content to a mirror registry.
			</p><p>
				The mirror registry can be located on a bastion host, which requires connectivity to both your workstation and the disconnected cluster, or a completely disconnected, or <span class="emphasis"><em>airgapped</em></span>, host, which requires removable media to physically move the mirrored content to the disconnected environment.
			</p><p>
				This guide describes the following process that is required to enable OLM in restricted networks:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Disable the default remote OperatorHub sources for OLM.
					</li><li class="listitem">
						Use a workstation with full internet access to create and push local mirrors of the OperatorHub content to a mirror registry.
					</li><li class="listitem">
						Configure OLM to install and manage Operators from local sources on the mirror registry instead of the default remote sources.
					</li></ul></div><p>
				After enabling OLM in a restricted network, you can continue to use your unrestricted workstation to keep your local OperatorHub sources updated as newer versions of Operators are released.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					While OLM can manage Operators from local sources, the ability for a given Operator to run successfully in a restricted network still depends on the Operator itself meeting the following criteria:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							List any related images, or other container images that the Operator might require to perform their functions, in the <code class="literal">relatedImages</code> parameter of its <code class="literal">ClusterServiceVersion</code> (CSV) object.
						</li><li class="listitem">
							Reference all specified images by a digest (SHA) and not by a tag.
						</li></ul></div><p>
					You can search software on the <a class="link" href="https://catalog.redhat.com/software/search?p=1&amp;deployed_as=Operator&amp;type=Containerized%20application&amp;badges_and_features=Disconnected">Red Hat Ecosystem Catalog</a> for a list of Red Hat Operators that support running in disconnected mode by filtering with the following selections:
				</p><div class="horizontal"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 15%; "><!--Empty--></col><col style="width: 85%; "><!--Empty--></col></colgroup><tbody style="vertical-align: top; "><tr><td style="vertical-align: top; "> <p>
									Type
								</p>
								 </td><td style="vertical-align: top; "> <p>
									Containerized application
								</p>
								 </td></tr><tr><td style="vertical-align: top; "> <p>
									Deployment method
								</p>
								 </td><td style="vertical-align: top; "> <p>
									Operator
								</p>
								 </td></tr><tr><td style="vertical-align: top; "> <p>
									Infrastructure features
								</p>
								 </td><td style="vertical-align: top; "> <p>
									Disconnected
								</p>
								 </td></tr></tbody></table></div></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-rh-catalogs">Red Hat-provided Operator catalogs</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-enabling-operator-for-restricted-network_osdk-generating-csvs">Enabling your Operator for restricted network environments</a>
					</li></ul></div><section class="section" id="olm-restricted-network-prereqs"><div class="titlepage"><div><div><h3 class="title">4.10.1. Prerequisites</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Log in to your OpenShift Container Platform cluster as a user with <code class="literal">cluster-admin</code> privileges.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are using OLM in a restricted network on IBM Z, you must have at least 12 GB allocated to the directory where you place your registry.
					</p></div></div></section><section class="section" id="olm-restricted-networks-operatorhub_olm-restricted-networks"><div class="titlepage"><div><div><h3 class="title">4.10.2. Disabling the default OperatorHub catalog sources</h3></div></div></div><p>
					Operator catalogs that source content provided by Red Hat and community projects are configured for OperatorHub by default during an OpenShift Container Platform installation. In a restricted network environment, you must disable the default catalogs as a cluster administrator. You can then configure OperatorHub to use local catalog sources.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Disable the sources for the default catalogs by adding <code class="literal">disableAllDefaultSources: true</code> to the <code class="literal">OperatorHub</code> object:
						</p><pre class="programlisting language-terminal">$ oc patch OperatorHub cluster --type json \
    -p '[{"op": "add", "path": "/spec/disableAllDefaultSources", "value": true}]'</pre></li></ul></div><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
					Alternatively, you can use the web console to manage catalog sources. From the <span class="strong strong"><strong>Administration</strong></span> → <span class="strong strong"><strong>Cluster Settings</strong></span> → <span class="strong strong"><strong>Configuration</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span> page, click the <span class="strong strong"><strong>Sources</strong></span> tab, where you can create, update, delete, disable, and enable individual sources.
				</p></div></div></section><section class="section" id="olm-mirror-catalog_olm-restricted-networks"><div class="titlepage"><div><div><h3 class="title">4.10.3. Mirroring an Operator catalog</h3></div></div></div><p>
					For instructions about mirroring Operator catalogs for use with disconnected clusters, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#olm-mirroring-catalog_installing-mirroring-installation-images">Installing → Mirroring images for a disconnected installation</a>.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						As of OpenShift Container Platform 4.11, the default Red Hat-provided Operator catalog releases in the file-based catalog format. The default Red Hat-provided Operator catalogs for OpenShift Container Platform 4.6 through 4.10 released in the deprecated SQLite database format.
					</p><p>
						The <code class="literal">opm</code> subcommands, flags, and functionality related to the SQLite database format are also deprecated and will be removed in a future release. The features are still supported and must be used for catalogs that use the deprecated SQLite database format.
					</p><p>
						Many of the <code class="literal">opm</code> subcommands and flags for working with the SQLite database format, such as <code class="literal">opm index prune</code>, do not work with the file-based catalog format. For more information about working with file-based catalogs, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-file-based-catalogs_olm-packaging-format">Operator Framework packaging format</a>, <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-managing-custom-catalogs-fb">Managing custom catalogs</a>, and <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-mirroring-disconnected">Mirroring images for a disconnected installation using the oc-mirror plugin</a>.
					</p></div></div></section><section class="section" id="olm-creating-catalog-from-index_olm-restricted-networks"><div class="titlepage"><div><div><h3 class="title">4.10.4. Adding a catalog source to a cluster</h3></div></div></div><p>
					Adding a catalog source to an OpenShift Container Platform cluster enables the discovery and installation of Operators for users. Cluster administrators can create a <code class="literal">CatalogSource</code> object that references an index image. OperatorHub uses catalog sources to populate the user interface.
				</p><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
					Alternatively, you can use the web console to manage catalog sources. From the <span class="strong strong"><strong>Administration</strong></span> → <span class="strong strong"><strong>Cluster Settings</strong></span> → <span class="strong strong"><strong>Configuration</strong></span> → <span class="strong strong"><strong>OperatorHub</strong></span> page, click the <span class="strong strong"><strong>Sources</strong></span> tab, where you can create, update, delete, disable, and enable individual sources.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You built and pushed an index image to a registry.
						</li><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a <code class="literal">CatalogSource</code> object that references your index image. If you used the <code class="literal">oc adm catalog mirror</code> command to mirror your catalog to a target registry, you can use the generated <code class="literal">catalogSource.yaml</code> file in your manifests directory as a starting point.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Modify the following to your specifications and save it as a <code class="literal">catalogSource.yaml</code> file:
								</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: CatalogSource
metadata:
  name: my-operator-catalog <span id="CO43-1"><!--Empty--></span><span class="callout">1</span>
  namespace: openshift-marketplace <span id="CO43-2"><!--Empty--></span><span class="callout">2</span>
spec:
  sourceType: grpc
  grpcPodConfig:
    securityContextConfig: &lt;security_mode&gt; <span id="CO43-3"><!--Empty--></span><span class="callout">3</span>
  image: &lt;registry&gt;/&lt;namespace&gt;/redhat-operator-index:v4.13 <span id="CO43-4"><!--Empty--></span><span class="callout">4</span>
  displayName: My Operator Catalog
  publisher: &lt;publisher_name&gt; <span id="CO43-5"><!--Empty--></span><span class="callout">5</span>
  updateStrategy:
    registryPoll: <span id="CO43-6"><!--Empty--></span><span class="callout">6</span>
      interval: 30m</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO43-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											If you mirrored content to local files before uploading to a registry, remove any backslash (<code class="literal">/</code>) characters from the <code class="literal">metadata.name</code> field to avoid an "invalid resource name" error when you create the object.
										</div></dd><dt><a href="#CO43-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											If you want the catalog source to be available globally to users in all namespaces, specify the <code class="literal">openshift-marketplace</code> namespace. Otherwise, you can specify a different namespace for the catalog to be scoped and available only for that namespace.
										</div></dd><dt><a href="#CO43-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Specify the value of <code class="literal">legacy</code> or <code class="literal">restricted</code>. If the field is not set, the default value is <code class="literal">legacy</code>. In a future OpenShift Container Platform release, it is planned that the default value will be <code class="literal">restricted</code>. If your catalog cannot run with <code class="literal">restricted</code> permissions, it is recommended that you manually set this field to <code class="literal">legacy</code>.
										</div></dd><dt><a href="#CO43-4"><span class="callout">4</span></a> </dt><dd><div class="para">
											Specify your index image. If you specify a tag after the image name, for example <code class="literal">:v4.13</code>, the catalog source pod uses an image pull policy of <code class="literal">Always</code>, meaning the pod always pulls the image prior to starting the container. If you specify a digest, for example <code class="literal">@sha256:&lt;id&gt;</code>, the image pull policy is <code class="literal">IfNotPresent</code>, meaning the pod pulls the image only if it does not already exist on the node.
										</div></dd><dt><a href="#CO43-5"><span class="callout">5</span></a> </dt><dd><div class="para">
											Specify your name or an organization name publishing the catalog.
										</div></dd><dt><a href="#CO43-6"><span class="callout">6</span></a> </dt><dd><div class="para">
											Catalog sources can automatically check for new versions to keep up to date.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Use the file to create the <code class="literal">CatalogSource</code> object:
								</p><pre class="programlisting language-terminal">$ oc apply -f catalogSource.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Verify the following resources are created successfully.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Check the pods:
								</p><pre class="programlisting language-terminal">$ oc get pods -n openshift-marketplace</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME                                    READY   STATUS    RESTARTS  AGE
my-operator-catalog-6njx6               1/1     Running   0         28s
marketplace-operator-d9f549946-96sgr    1/1     Running   0         26h</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Check the catalog source:
								</p><pre class="programlisting language-terminal">$ oc get catalogsource -n openshift-marketplace</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME                  DISPLAY               TYPE PUBLISHER  AGE
my-operator-catalog   My Operator Catalog   grpc            5s</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Check the package manifest:
								</p><pre class="programlisting language-terminal">$ oc get packagemanifest -n openshift-marketplace</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME                          CATALOG               AGE
jaeger-product                My Operator Catalog   93s</pre>

									</p></div></li></ol></div></li></ol></div><p>
					You can now install the Operators from the <span class="strong strong"><strong>OperatorHub</strong></span> page on your OpenShift Container Platform web console.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-accessing-images-private-registries_olm-managing-custom-catalogs">Accessing images for Operators from private registries</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-catalogsource-image-template_olm-understanding-olm">Image template for custom catalog sources</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#image-pull-policy">Image pull policy</a>
						</li></ul></div></section></section><section class="section" id="olm-cs-podsched"><div class="titlepage"><div><div><h2 class="title">4.11. Catalog source pod scheduling</h2></div></div></div><p>
				When an Operator Lifecycle Manager (OLM) catalog source of source type <code class="literal">grpc</code> defines a <code class="literal">spec.image</code>, the Catalog Operator creates a pod that serves the defined image content. By default, this pod defines the following in its specification:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Only the <code class="literal">kubernetes.io/os=linux</code> node selector.
					</li><li class="listitem">
						The default priority class name: <code class="literal">system-cluster-critical</code>.
					</li><li class="listitem">
						No tolerations.
					</li></ul></div><p>
				As an administrator, you can override these values by modifying fields in the <code class="literal">CatalogSource</code> object’s optional <code class="literal">spec.grpcPodConfig</code> section.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The Marketplace Operator, <code class="literal">openshift-marketplace</code>, manages the default <code class="literal">OperatorHub</code> custom resource’s (CR). This CR manages <code class="literal">CatalogSource</code> objects. If you attempt to modify fields in the <code class="literal">CatalogSource</code> object’s <code class="literal">spec.grpcPodConfig</code> section, the Marketplace Operator automatically reverts these modifications.By default, if you modify fields in the <code class="literal">spec.grpcPodConfig</code> section of the <code class="literal">CatalogSource</code> object, the Marketplace Operator automatically reverts these changes.
				</p><p>
					To apply persistent changes to <code class="literal">CatalogSource</code> object, you must first disable a default <code class="literal">CatalogSource</code> object.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-catalogsource_olm-understanding-olm">OLM concepts and resources → Catalog source</a>
					</li></ul></div><section class="section" id="disabling-catalogsource-objects_olm-cs-podsched"><div class="titlepage"><div><div><h3 class="title">4.11.1. Disabling default CatalogSource objects at a local level</h3></div></div></div><p>
					You can apply persistent changes to a <code class="literal">CatalogSource</code> object, such as catalog source pods, at a local level, by disabling a default <code class="literal">CatalogSource</code> object. Consider the default configuration in situations where the default <code class="literal">CatalogSource</code> object’s configuration does not meet your organization’s needs. By default, if you modify fields in the <code class="literal">spec.grpcPodConfig</code> section of the <code class="literal">CatalogSource</code> object, the Marketplace Operator automatically reverts these changes.
				</p><p>
					The Marketplace Operator, <code class="literal">openshift-marketplace</code>, manages the default custom resources (CRs) of the <code class="literal">OperatorHub</code>. The <code class="literal">OperatorHub</code> manages <code class="literal">CatalogSource</code> objects.
				</p><p>
					To apply persistent changes to <code class="literal">CatalogSource</code> object, you must first disable a default <code class="literal">CatalogSource</code> object.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To disable all the default <code class="literal">CatalogSource</code> objects at a local level, enter the following command:
						</p><pre class="programlisting language-terminal">$ oc patch operatorhub cluster -p '{"spec": {"disableAllDefaultSources": true}}' --type=merge</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								You can also configure the default <code class="literal">OperatorHub</code> CR to either disable all <code class="literal">CatalogSource</code> objects or disable a specific object.
							</p></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-operatorhub-arch-operatorhub_crd_olm-understanding-operatorhub">OperatorHub custom resource</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-restricted-networks-operatorhub_olm-restricted-networks">Disabling the default OperatorHub catalog sources</a>
						</li></ul></div></section><section class="section" id="olm-node-selector_olm-cs-podsched"><div class="titlepage"><div><div><h3 class="title">4.11.2. Overriding the node selector for catalog source pods</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							A <code class="literal">CatalogSource</code> object of source type <code class="literal">grpc</code> with <code class="literal">spec.image</code> is defined.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">CatalogSource</code> object and add or modify the <code class="literal">spec.grpcPodConfig</code> section to include the following:
						</p><pre class="programlisting language-yaml">  grpcPodConfig:
    nodeSelector:
      custom_label: &lt;label&gt;</pre><p class="simpara">
							where <code class="literal">&lt;label&gt;</code> is the label for the node selector that you want catalog source pods to use for scheduling.
						</p></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-scheduler-node-selectors">Placing pods on specific nodes using node selectors</a>
						</li></ul></div></section><section class="section" id="olm-priority-class-name_olm-cs-podsched"><div class="titlepage"><div><div><h3 class="title">4.11.3. Overriding the priority class name for catalog source pods</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							A <code class="literal">CatalogSource</code> object of source type <code class="literal">grpc</code> with <code class="literal">spec.image</code> is defined.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">CatalogSource</code> object and add or modify the <code class="literal">spec.grpcPodConfig</code> section to include the following:
						</p><pre class="programlisting language-yaml">  grpcPodConfig:
    priorityClassName: &lt;priority_class&gt;</pre><p class="simpara">
							where <code class="literal">&lt;priority_class&gt;</code> is one of the following:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									One of the default priority classes provided by Kubernetes: <code class="literal">system-cluster-critical</code> or <code class="literal">system-node-critical</code>
								</li><li class="listitem">
									An empty set (<code class="literal">""</code>) to assign the default priority
								</li><li class="listitem">
									A pre-existing and custom defined priority class
								</li></ul></div></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Previously, the only pod scheduling parameter that could be overriden was <code class="literal">priorityClassName</code>. This was done by adding the <code class="literal">operatorframework.io/priorityclass</code> annotation to the <code class="literal">CatalogSource</code> object. For example:
					</p><pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: CatalogSource
metadata:
  name: example-catalog
  namespace: namespace: openshift-marketplace
  annotations:
    operatorframework.io/priorityclass: system-cluster-critical</pre><p>
						If a <code class="literal">CatalogSource</code> object defines both the annotation and <code class="literal">spec.grpcPodConfig.priorityClassName</code>, the annotation takes precedence over the configuration parameter.
					</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#admin-guide-priority-preemption-priority-class_nodes-pods-priority">Pod priority classes</a>
						</li></ul></div></section><section class="section" id="olm-tolerations_olm-cs-podsched"><div class="titlepage"><div><div><h3 class="title">4.11.4. Overriding tolerations for catalog source pods</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							A <code class="literal">CatalogSource</code> object of source type <code class="literal">grpc</code> with <code class="literal">spec.image</code> is defined.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">CatalogSource</code> object and add or modify the <code class="literal">spec.grpcPodConfig</code> section to include the following:
						</p><pre class="programlisting language-yaml">  grpcPodConfig:
    tolerations:
      - key: "&lt;key_name&gt;"
        operator: "&lt;operator_type&gt;"
        value: "&lt;value&gt;"
        effect: "&lt;effect&gt;"</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-scheduler-taints-tolerations-about_nodes-scheduler-taints-tolerations">Understanding taints and tolerations</a>
						</li></ul></div></section></section><section class="section" id="olm-managing-po"><div class="titlepage"><div><div><h2 class="title">4.12. Managing platform Operators (Technology Preview)</h2></div></div></div><p>
				A platform Operator is an OLM-based Operator that can be installed during or after an OpenShift Container Platform cluster’s Day 0 operations and participates in the cluster’s lifecycle. As a cluster administrator, you can manage platform Operators by using the <code class="literal">PlatformOperator</code> API.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The platform Operator type is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
				</p><p>
					For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
				</p></div></div><section class="section" id="platform-operators_olm-managing-po"><div class="titlepage"><div><div><h3 class="title">4.12.1. About platform Operators</h3></div></div></div><p>
					Operator Lifecycle Manager (OLM) introduces a new type of Operator called <span class="emphasis"><em>platform Operators</em></span>. A platform Operator is an OLM-based Operator that can be installed during or after an OpenShift Container Platform cluster’s Day 0 operations and participates in the cluster’s lifecycle. As a cluster administrator, you can use platform Operators to further customize your OpenShift Container Platform installation to meet your requirements and use cases.
				</p><p>
					Using the existing cluster capabilities feature in OpenShift Container Platform, cluster administrators can already disable a subset of Cluster Version Operator-based (CVO) components considered non-essential to the initial payload prior to cluster installation. Platform Operators iterate on this model by providing additional customization options. Through the platform Operator mechanism, which relies on resources from the RukPak component, OLM-based Operators can now be installed at cluster installation time and can block cluster rollout if the Operator fails to install successfully.
				</p><p>
					In OpenShift Container Platform 4.12, this Technology Preview release focuses on the basic platform Operator mechanism and builds a foundation for expanding the concept in upcoming releases. You can use the cluster-wide <code class="literal">PlatformOperator</code> API to configure Operators before or after cluster creation on clusters that have enabled the <code class="literal">TechPreviewNoUpgrades</code> feature set.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-rukpak-about_olm-packaging-format">RukPak component and packaging format</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#cluster-capabilities">Cluster capabilities</a>
						</li></ul></div><section class="section" id="olm-po-techpreview_olm-managing-po"><div class="titlepage"><div><div><h4 class="title">4.12.1.1. Technology Preview restrictions for platform Operators</h4></div></div></div><p>
						During the Technology Preview release of the platform Operators feature in OpenShift Container Platform 4.12, the following restrictions determine whether an Operator can be installed through the platform Operators mechanism:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Kubernetes manifests must be packaged using the Operator Lifecycle Manager (OLM) <code class="literal">registry+v1</code> bundle format.
							</li><li class="listitem">
								The Operator cannot declare package or group/version/kind (GVK) dependencies.
							</li><li class="listitem">
								The Operator cannot specify cluster service version (CSV) install modes other than <code class="literal">AllNamespaces</code>
							</li><li class="listitem">
								The Operator cannot specify any <code class="literal">Webhook</code> or <code class="literal">APIService</code> definitions.
							</li><li class="listitem">
								All package bundles must be in the <code class="literal">redhat-operators</code> catalog source.
							</li></ul></div><p>
						After considering these restrictions, the following Operators can be successfully installed:
					</p><div class="table" id="idm139731985480272"><p class="title"><strong>Table 4.2. OLM-based Operators installable as platform Operators</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><tbody><tr><td align="left" valign="top"> <p>
										3scale-operator
									</p>
									 </td><td align="left" valign="top"> <p>
										amq-broker-rhel8
									</p>
									 </td></tr><tr><td align="left" valign="top"> <p>
										amq-online
									</p>
									 </td><td align="left" valign="top"> <p>
										amq-streams
									</p>
									 </td></tr><tr><td align="left" valign="top"> <p>
										ansible-cloud-addons-operator
									</p>
									 </td><td align="left" valign="top"> <p>
										apicast-operator
									</p>
									 </td></tr><tr><td align="left" valign="top"> <p>
										container-security-operator
									</p>
									 </td><td align="left" valign="top"> <p>
										eap
									</p>
									 </td></tr><tr><td align="left" valign="top"> <p>
										file-integrity-operator
									</p>
									 </td><td align="left" valign="top"> <p>
										gatekeeper-operator-product
									</p>
									 </td></tr><tr><td align="left" valign="top"> <p>
										integration-operator
									</p>
									 </td><td align="left" valign="top"> <p>
										jws-operator
									</p>
									 </td></tr><tr><td align="left" valign="top"> <p>
										kiali-ossm
									</p>
									 </td><td align="left" valign="top"> <p>
										node-healthcheck-operator
									</p>
									 </td></tr><tr><td align="left" valign="top"> <p>
										odf-csi-addons-operator
									</p>
									 </td><td align="left" valign="top"> <p>
										odr-hub-operator
									</p>
									 </td></tr><tr><td align="left" valign="top"> <p>
										openshift-custom-metrics-autoscaler-operator
									</p>
									 </td><td align="left" valign="top"> <p>
										openshift-gitops-operator
									</p>
									 </td></tr><tr><td align="left" valign="top"> <p>
										openshift-pipelines-operator-rh
									</p>
									 </td><td align="left" valign="top"> <p>
										quay-operator
									</p>
									 </td></tr><tr><td align="left" valign="top"> <p>
										red-hat-camel-k
									</p>
									 </td><td align="left" valign="top"> <p>
										rhpam-kogito-operator
									</p>
									 </td></tr><tr><td align="left" valign="top"> <p>
										service-registry-operator
									</p>
									 </td><td align="left" valign="top"> <p>
										servicemeshoperator
									</p>
									 </td></tr><tr><td align="left" valign="top"> <p>
										skupper-operator
									</p>
									 </td><td align="left" valign="top"> </td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The following features are not available during this Technology Preview release:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Automatically upgrading platform Operator packages after cluster rollout
								</li><li class="listitem">
									Extending the platform Operator mechanism to support any optional, CVO-based components
								</li></ul></div></div></div></section></section><section class="section" id="prerequisites_olm-managing-po"><div class="titlepage"><div><div><h3 class="title">4.12.2. Prerequisites</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Access to an OpenShift Container Platform cluster using an account with <code class="literal">cluster-admin</code> permissions.
						</li><li class="listitem"><p class="simpara">
							The <code class="literal">TechPreviewNoUpgrades</code> feature set enabled on the cluster.
						</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								Enabling the <code class="literal">TechPreviewNoUpgrade</code> feature set cannot be undone and prevents minor version updates. These feature sets are not recommended on production clusters.
							</p></div></div></li><li class="listitem">
							Only the <code class="literal">redhat-operators</code> catalog source enabled on the cluster. This is a restriction during the Technology Preview release.
						</li><li class="listitem">
							The <code class="literal">oc</code> command installed on your workstation.
						</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/nodes/#nodes-cluster-enabling">Enabling features using feature gates</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-restricted-networks-operatorhub_olm-managing-custom-catalogs">Disabling the default OperatorHub catalog sources</a>
						</li></ul></div></section><section class="section" id="olm-installing-po-during_olm-managing-po"><div class="titlepage"><div><div><h3 class="title">4.12.3. Installing platform Operators during cluster creation</h3></div></div></div><p>
					As a cluster administrator, you can install platform Operators by providing <code class="literal">FeatureGate</code> and <code class="literal">PlatformOperator</code> manifests during cluster creation.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Choose a platform Operator from the supported set of OLM-based Operators. For the list of this set and details on current limitations, see "Technology Preview restrictions for platform Operators".
						</li><li class="listitem">
							Select a cluster installation method and follow the instructions through creating an <code class="literal">install-config.yaml</code> file. For more details on preparing for a cluster installation, see "Selecting a cluster installation method and preparing it for users".
						</li><li class="listitem"><p class="simpara">
							After you have created the <code class="literal">install-config.yaml</code> file and completed any modifications to it, change to the directory that contains the installation program and create the manifests:
						</p><pre class="programlisting language-terminal">$ ./openshift-install create manifests --dir &lt;installation_directory&gt; <span id="CO44-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO44-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									For <code class="literal">&lt;installation_directory&gt;</code>, specify the name of the directory that contains the <code class="literal">install-config.yaml</code> file for your cluster.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">FeatureGate</code> object YAML file in the <code class="literal">&lt;installation_directory&gt;/manifests/</code> directory that enables the <code class="literal">TechPreviewNoUpgrade</code> feature set, for example a <code class="literal">feature-gate.yaml</code> file:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">feature-gate.yaml</code> file</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1
kind: FeatureGate
metadata:
  annotations:
    include.release.openshift.io/self-managed-high-availability: "true"
    include.release.openshift.io/single-node-developer: "true"
    release.openshift.io/create-only: "true"
  name: cluster
spec:
  featureSet: TechPreviewNoUpgrade <span id="CO45-1"><!--Empty--></span><span class="callout">1</span></pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO45-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Enable the <code class="literal">TechPreviewNoUpgrade</code> feature set.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">PlatformOperator</code> object YAML file for your chosen platform Operator in the <code class="literal">&lt;installation_directory&gt;/manifests/</code> directory, for example a <code class="literal">service-mesh-po.yaml</code> file for the Red Hat OpenShift Service Mesh Operator:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">service-mesh-po.yaml</code> file</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: platform.openshift.io/v1alpha1
kind: PlatformOperator
metadata:
  name: service-mesh-po
spec:
  package:
    name: servicemeshoperator</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							When you are ready to complete the cluster install, refer to your chosen installation method and continue through running the <code class="literal">openshift-install create cluster</code> command.
						</p><p class="simpara">
							During cluster creation, your provided manifests are used to enable the <code class="literal">TechPreviewNoUpgrade</code> feature set and install your chosen platform Operator.
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								Failure of the platform Operator to successfully install will block the cluster installation process.
							</p></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Check the status of the <code class="literal">service-mesh-po</code> platform Operator by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get platformoperator service-mesh-po -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-yaml">...
status:
  activeBundleDeployment:
    name: service-mesh-po
  conditions:
  - lastTransitionTime: "2022-10-24T17:24:40Z"
    message: Successfully applied the service-mesh-po BundleDeployment resource
    reason: InstallSuccessful
    status: "True" <span id="CO46-1"><!--Empty--></span><span class="callout">1</span>
    type: Installed</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO46-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Wait until the <code class="literal">Installed</code> status condition reports <code class="literal">True</code>.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Verify that the <code class="literal">platform-operators-aggregated</code> cluster Operator is reporting an <code class="literal">Available=True</code> status:
						</p><pre class="programlisting language-terminal">$ oc get clusteroperator platform-operators-aggregated -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-yaml">...
status:
  conditions:
  - lastTransitionTime: "2022-10-24T17:43:26Z"
    message: All platform operators are in a successful state
    reason: AsExpected
    status: "False"
    type: Progressing
  - lastTransitionTime: "2022-10-24T17:43:26Z"
    status: "False"
    type: Degraded
  - lastTransitionTime: "2022-10-24T17:43:26Z"
    message: All platform operators are in a successful state
    reason: AsExpected
    status: "True"
    type: Available</pre>

							</p></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-preparing">Selecting a cluster installation method and preparing it for users</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-po-techpreview_olm-managing-po">Technology Preview restrictions for platform Operators</a>
						</li></ul></div></section><section class="section" id="olm-installing-po-after_olm-managing-po"><div class="titlepage"><div><div><h3 class="title">4.12.4. Installing platform Operators after cluster creation</h3></div></div></div><p>
					As a cluster administrator, you can install platform Operators after cluster creation on clusters that have enabled the <code class="literal">TechPreviewNoUpgrades</code> feature set by using the cluster-wide <code class="literal">PlatformOperator</code> API.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Choose a platform Operator from the supported set of OLM-based Operators. For the list of this set and details on current limitations, see "Technology Preview restrictions for platform Operators".
						</li><li class="listitem"><p class="simpara">
							Create a <code class="literal">PlatformOperator</code> object YAML file for your chosen platform Operator, for example a <code class="literal">service-mesh-po.yaml</code> file for the Red Hat OpenShift Service Mesh Operator:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">sevice-mesh-po.yaml</code> file</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: platform.openshift.io/v1alpha1
kind: PlatformOperator
metadata:
  name: service-mesh-po
spec:
  package:
    name: servicemeshoperator</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">PlatformOperator</code> object by running the following command:
						</p><pre class="programlisting language-terminal">$ oc apply -f service-mesh-po.yaml</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								If your cluster does not have the <code class="literal">TechPreviewNoUpgrades</code> feature set enabled, the object creation fails with the following message:
							</p><pre class="programlisting language-terminal">error: resource mapping not found for name: "service-mesh-po" namespace: "" from "service-mesh-po.yaml": no matches for kind "PlatformOperator" in version "platform.openshift.io/v1alpha1"
ensure CRDs are installed first</pre></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Check the status of the <code class="literal">service-mesh-po</code> platform Operator by running the following command:
						</p><pre class="programlisting language-terminal">$ oc get platformoperator service-mesh-po -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-yaml">...
status:
  activeBundleDeployment:
    name: service-mesh-po
  conditions:
  - lastTransitionTime: "2022-10-24T17:24:40Z"
    message: Successfully applied the service-mesh-po BundleDeployment resource
    reason: InstallSuccessful
    status: "True" <span id="CO47-1"><!--Empty--></span><span class="callout">1</span>
    type: Installed</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO47-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Wait until the <code class="literal">Installed</code> status condition reports <code class="literal">True</code>.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Verify that the <code class="literal">platform-operators-aggregated</code> cluster Operator is reporting an <code class="literal">Available=True</code> status:
						</p><pre class="programlisting language-terminal">$ oc get clusteroperator platform-operators-aggregated -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-yaml">...
status:
  conditions:
  - lastTransitionTime: "2022-10-24T17:43:26Z"
    message: All platform operators are in a successful state
    reason: AsExpected
    status: "False"
    type: Progressing
  - lastTransitionTime: "2022-10-24T17:43:26Z"
    status: "False"
    type: Degraded
  - lastTransitionTime: "2022-10-24T17:43:26Z"
    message: All platform operators are in a successful state
    reason: AsExpected
    status: "True"
    type: Available</pre>

							</p></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-po-techpreview_olm-managing-po">Technology Preview restrictions for platform Operators</a>
						</li></ul></div></section><section class="section" id="olm-deleting-po_olm-managing-po"><div class="titlepage"><div><div><h3 class="title">4.12.5. Deleting platform Operators</h3></div></div></div><p>
					As a cluster administrator, you can delete existing platform Operators. Operator Lifecycle Manager (OLM) performs a cascading deletion. First, OLM removes the bundle deployment for the platform Operator, which then deletes any objects referenced in the <code class="literal">registry+v1</code> type bundle.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The platform Operator manager and bundle deployment provisioner only manage objects that are referenced in the bundle, but not objects subsequently deployed by any bundle workloads themselves. For example, if a bundle workload creates a namespace and the Operator is not configured to clean it up before the Operator is removed, it is outside of the scope of OLM to remove the namespace during platform Operator deletion.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Get a list of installed platform Operators and find the name for the Operator you want to delete:
						</p><pre class="programlisting language-terminal">$ oc get platformoperator</pre></li><li class="listitem"><p class="simpara">
							Delete the <code class="literal">PlatformOperator</code> resource for the chosen Operator, for example, for the Quay Operator:
						</p><pre class="programlisting language-terminal">$ oc delete platformoperator quay-operator</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">platformoperator.platform.openshift.io "quay-operator" deleted</pre>

							</p></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Verify the namespace for the platform Operator is eventually deleted, for example, for the Quay Operator:
						</p><pre class="programlisting language-terminal">$ oc get ns quay-operator-system</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Error from server (NotFound): namespaces "quay-operator-system" not found</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Verify the <code class="literal">platform-operators-aggregated</code> cluster Operator continues to report an <code class="literal">Available=True</code> status:
						</p><pre class="programlisting language-terminal">$ oc get co platform-operators-aggregated</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                            VERSION     AVAILABLE   PROGRESSING   DEGRADED   SINCE   MESSAGE
platform-operators-aggregated   4.13.0-0    True        False         False      70s</pre>

							</p></div></li></ol></div></section></section></section><section class="chapter" id="developing-operators"><div class="titlepage"><div><div><h1 class="title">Chapter 5. Developing Operators</h1></div></div></div><section class="section" id="osdk-about"><div class="titlepage"><div><div><h2 class="title">5.1. About the Operator SDK</h2></div></div></div><p>
				The <a class="link" href="https://operatorframework.io/">Operator Framework</a> is an open source toolkit to manage Kubernetes native applications, called <span class="emphasis"><em>Operators</em></span>, in an effective, automated, and scalable way. Operators take advantage of Kubernetes extensibility to deliver the automation advantages of cloud services, like provisioning, scaling, and backup and restore, while being able to run anywhere that Kubernetes can run.
			</p><p>
				Operators make it easy to manage complex, stateful applications on top of Kubernetes. However, writing an Operator today can be difficult because of challenges such as using low-level APIs, writing boilerplate, and a lack of modularity, which leads to duplication.
			</p><p>
				The Operator SDK, a component of the Operator Framework, provides a command-line interface (CLI) tool that Operator developers can use to build, test, and deploy an Operator.
			</p><p>
				<span class="strong strong"><strong>Why use the Operator SDK?</strong></span>
			</p><p>
				The Operator SDK simplifies this process of building Kubernetes-native applications, which can require deep, application-specific operational knowledge. The Operator SDK not only lowers that barrier, but it also helps reduce the amount of boilerplate code required for many common management capabilities, such as metering or monitoring.
			</p><p>
				The Operator SDK is a framework that uses the <a class="link" href="https://github.com/kubernetes-sigs/controller-runtime">controller-runtime</a> library to make writing Operators easier by providing the following features:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						High-level APIs and abstractions to write the operational logic more intuitively
					</li><li class="listitem">
						Tools for scaffolding and code generation to quickly bootstrap a new project
					</li><li class="listitem">
						Integration with Operator Lifecycle Manager (OLM) to streamline packaging, installing, and running Operators on a cluster
					</li><li class="listitem">
						Extensions to cover common Operator use cases
					</li><li class="listitem">
						Metrics set up automatically in any generated Go-based Operator for use on clusters where the Prometheus Operator is deployed
					</li></ul></div><p>
				Operator authors with cluster administrator access to a Kubernetes-based cluster (such as OpenShift Container Platform) can use the Operator SDK CLI to develop their own Operators based on Go, Ansible, Java, or Helm. <a class="link" href="https://kubebuilder.io/">Kubebuilder</a> is embedded into the Operator SDK as the scaffolding solution for Go-based Operators, which means existing Kubebuilder projects can be used as is with the Operator SDK and continue to work.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					OpenShift Container Platform 4.13 supports Operator SDK 1.28.0.
				</p></div></div><section class="section" id="osdk-about-what-are-operators"><div class="titlepage"><div><div><h3 class="title">5.1.1. What are Operators?</h3></div></div></div><p>
					For an overview about basic Operator concepts and terminology, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-what-operators-are">Understanding Operators</a>.
				</p></section><section class="section" id="osdk-workflow_osdk-about"><div class="titlepage"><div><div><h3 class="title">5.1.2. Development workflow</h3></div></div></div><p>
					The Operator SDK provides the following workflow to develop a new Operator:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Create an Operator project by using the Operator SDK command-line interface (CLI).
						</li><li class="listitem">
							Define new resource APIs by adding custom resource definitions (CRDs).
						</li><li class="listitem">
							Specify resources to watch by using the Operator SDK API.
						</li><li class="listitem">
							Define the Operator reconciling logic in a designated handler and use the Operator SDK API to interact with resources.
						</li><li class="listitem">
							Use the Operator SDK CLI to build and generate the Operator deployment manifests.
						</li></ol></div><div class="figure" id="idm139731976630992"><p class="title"><strong>Figure 5.1. Operator SDK workflow</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Operators-en-US/images/455883d59723ffcc9b05b9a4d4d0503c/osdk-workflow.png" alt="osdk workflow"/></div></div></div><p>
					At a high level, an Operator that uses the Operator SDK processes events for watched resources in an Operator author-defined handler and takes actions to reconcile the state of the application.
				</p></section><section class="section _additional-resources" id="osdk-about-addtl-resources"><div class="titlepage"><div><div><h3 class="title">5.1.3. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://redhat-connect.gitbook.io/certified-operator-guide/">Certified Operator Build Guide</a>
						</li></ul></div></section></section><section class="section" id="osdk-installing-cli"><div class="titlepage"><div><div><h2 class="title">5.2. Installing the Operator SDK CLI</h2></div></div></div><p>
				The Operator SDK provides a command-line interface (CLI) tool that Operator developers can use to build, test, and deploy an Operator. You can install the Operator SDK CLI on your workstation so that you are prepared to start authoring your own Operators.
			</p><p>
				Operator authors with cluster administrator access to a Kubernetes-based cluster, such as OpenShift Container Platform, can use the Operator SDK CLI to develop their own Operators based on Go, Ansible, Java, or Helm. <a class="link" href="https://kubebuilder.io/">Kubebuilder</a> is embedded into the Operator SDK as the scaffolding solution for Go-based Operators, which means existing Kubebuilder projects can be used as is with the Operator SDK and continue to work.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					OpenShift Container Platform 4.13 supports Operator SDK 1.28.0.
				</p></div></div><section class="section" id="osdk-installing-cli-linux-macos_osdk-installing-cli"><div class="titlepage"><div><div><h3 class="title">5.2.1. Installing the Operator SDK CLI on Linux</h3></div></div></div><p>
					You can install the OpenShift SDK CLI tool on Linux.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://golang.org/dl/">Go</a> v1.19+
						</li><li class="listitem">
							<code class="literal">docker</code> v17.03+, <code class="literal">podman</code> v1.9.3+, or <code class="literal">buildah</code> v1.7+
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <a class="link" href="https://mirror.openshift.com/pub/openshift-v4/x86_64/clients/operator-sdk/">OpenShift mirror site</a>.
						</li><li class="listitem">
							From the latest 4.13 directory, download the latest version of the tarball for Linux.
						</li><li class="listitem"><p class="simpara">
							Unpack the archive:
						</p><pre class="programlisting language-terminal">$ tar xvf operator-sdk-v1.28.0-ocp-linux-x86_64.tar.gz</pre></li><li class="listitem"><p class="simpara">
							Make the file executable:
						</p><pre class="programlisting language-terminal">$ chmod +x operator-sdk</pre></li><li class="listitem"><p class="simpara">
							Move the extracted <code class="literal">operator-sdk</code> binary to a directory that is on your <code class="literal">PATH</code>.
						</p><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
							To check your <code class="literal">PATH</code>:
						</p><pre class="programlisting language-terminal">$ echo $PATH</pre></div></div><pre class="programlisting language-terminal">$ sudo mv ./operator-sdk /usr/local/bin/operator-sdk</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							After you install the Operator SDK CLI, verify that it is available:
						</p><pre class="programlisting language-terminal">$ operator-sdk version</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">operator-sdk version: "v1.28.0-ocp", ...</pre>

							</p></div></li></ul></div></section><section class="section" id="osdk-installing-cli-macos_osdk-installing-cli"><div class="titlepage"><div><div><h3 class="title">5.2.2. Installing the Operator SDK CLI on macOS</h3></div></div></div><p>
					You can install the OpenShift SDK CLI tool on macOS.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://golang.org/dl/">Go</a> v1.19+
						</li><li class="listitem">
							<code class="literal">docker</code> v17.03+, <code class="literal">podman</code> v1.9.3+, or <code class="literal">buildah</code> v1.7+
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							For the <code class="literal">amd64</code> and <code class="literal">arm64</code> architectures, navigate to the <a class="link" href="https://mirror.openshift.com/pub/openshift-v4/x86_64/clients/operator-sdk/">OpenShift mirror site for the <code class="literal">amd64</code> architecture</a> and <a class="link" href="https://mirror.openshift.com/pub/openshift-v4/arm64/clients/operator-sdk/">OpenShift mirror site for the <code class="literal">arm64</code> architecture</a> respectively.
						</li><li class="listitem">
							From the latest 4.13 directory, download the latest version of the tarball for macOS.
						</li><li class="listitem"><p class="simpara">
							Unpack the Operator SDK archive for <code class="literal">amd64</code> architecture by running the following command:
						</p><pre class="programlisting language-terminal">$ tar xvf operator-sdk-v1.28.0-ocp-darwin-x86_64.tar.gz</pre></li><li class="listitem"><p class="simpara">
							Unpack the Operator SDK archive for <code class="literal">arm64</code> architecture by running the following command:
						</p><pre class="programlisting language-terminal">$ tar xvf operator-sdk-v1.28.0-ocp-darwin-aarch64.tar.gz</pre></li><li class="listitem"><p class="simpara">
							Make the file executable by running the following command:
						</p><pre class="programlisting language-terminal">$ chmod +x operator-sdk</pre></li><li class="listitem"><p class="simpara">
							Move the extracted <code class="literal">operator-sdk</code> binary to a directory that is on your <code class="literal">PATH</code> by running the following command:
						</p><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
							Check your <code class="literal">PATH</code> by running the following command:
						</p><pre class="programlisting language-terminal">$ echo $PATH</pre></div></div><pre class="programlisting language-terminal">$ sudo mv ./operator-sdk /usr/local/bin/operator-sdk</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							After you install the Operator SDK CLI, verify that it is available by running the following command::
						</p><pre class="programlisting language-terminal">$ operator-sdk version</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">operator-sdk version: "v1.28.0-ocp", ...</pre>

							</p></div></li></ul></div></section></section><section class="section" id="go-based-operators"><div class="titlepage"><div><div><h2 class="title">5.3. Go-based Operators</h2></div></div></div><section class="section" id="osdk-golang-quickstart"><div class="titlepage"><div><div><h3 class="title">5.3.1. Getting started with Operator SDK for Go-based Operators</h3></div></div></div><p>
					To demonstrate the basics of setting up and running a Go-based Operator using tools and libraries provided by the Operator SDK, Operator developers can build an example Go-based Operator for Memcached, a distributed key-value store, and deploy it to a cluster.
				</p><section class="section" id="osdk-common-prereqs_osdk-golang-quickstart"><div class="titlepage"><div><div><h4 class="title">5.3.1.1. Prerequisites</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Operator SDK CLI installed
							</li><li class="listitem">
								OpenShift CLI (<code class="literal">oc</code>) v4.13+ installed
							</li><li class="listitem">
								<a class="link" href="https://golang.org/dl/">Go</a> v1.19+
							</li><li class="listitem">
								Logged into an OpenShift Container Platform 4.13 cluster with <code class="literal">oc</code> with an account that has <code class="literal">cluster-admin</code> permissions
							</li><li class="listitem">
								To allow the cluster to pull the image, the repository where you push your image must be set as public, or you must configure an image pull secret
							</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-installing-cli">Installing the Operator SDK CLI</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cli_tools/#getting-started-cli">Getting started with the OpenShift CLI</a>
							</li></ul></div></section><section class="section" id="osdk-quickstart_osdk-golang-quickstart"><div class="titlepage"><div><div><h4 class="title">5.3.1.2. Creating and deploying Go-based Operators</h4></div></div></div><p>
						You can build and deploy a simple Go-based Operator for Memcached by using the Operator SDK.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Create a project.</strong></span>
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Create your project directory:
									</p><pre class="programlisting language-terminal">$ mkdir memcached-operator</pre></li><li class="listitem"><p class="simpara">
										Change into the project directory:
									</p><pre class="programlisting language-terminal">$ cd memcached-operator</pre></li><li class="listitem"><p class="simpara">
										Run the <code class="literal">operator-sdk init</code> command to initialize the project:
									</p><pre class="programlisting language-terminal">$ operator-sdk init \
    --domain=example.com \
    --repo=github.com/example-inc/memcached-operator</pre><p class="simpara">
										The command uses the Go plugin by default.
									</p></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Create an API.</strong></span>
							</p><p class="simpara">
								Create a simple Memcached API:
							</p><pre class="programlisting language-terminal">$ operator-sdk create api \
    --resource=true \
    --controller=true \
    --group cache \
    --version v1 \
    --kind Memcached</pre></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Build and push the Operator image.</strong></span>
							</p><p class="simpara">
								Use the default <code class="literal">Makefile</code> targets to build and push your Operator. Set <code class="literal">IMG</code> with a pull spec for your image that uses a registry you can push to:
							</p><pre class="programlisting language-terminal">$ make docker-build docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Run the Operator.</strong></span>
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Install the CRD:
									</p><pre class="programlisting language-terminal">$ make install</pre></li><li class="listitem"><p class="simpara">
										Deploy the project to the cluster. Set <code class="literal">IMG</code> to the image that you pushed:
									</p><pre class="programlisting language-terminal">$ make deploy IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Create a sample custom resource (CR).</strong></span>
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Create a sample CR:
									</p><pre class="programlisting language-terminal">$ oc apply -f config/samples/cache_v1_memcached.yaml \
    -n memcached-operator-system</pre></li><li class="listitem"><p class="simpara">
										Watch for the CR to reconcile the Operator:
									</p><pre class="programlisting language-terminal">$ oc logs deployment.apps/memcached-operator-controller-manager \
    -c manager \
    -n memcached-operator-system</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Delete a CR.</strong></span>
							</p><p class="simpara">
								Delete a CR by running the following command:
							</p><pre class="programlisting language-terminal">$ oc delete -f config/samples/cache_v1_memcached -n memcached-operator-system</pre></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Clean up.</strong></span>
							</p><p class="simpara">
								Run the following command to clean up the resources that have been created as part of this procedure:
							</p><pre class="programlisting language-terminal">$ make undeploy</pre></li></ol></div></section><section class="section" id="osdk-golang-quickstart-next-steps"><div class="titlepage"><div><div><h4 class="title">5.3.1.3. Next steps</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-golang-tutorial">Operator SDK tutorial for Go-based Operators</a> for a more in-depth walkthrough on building a Go-based Operator.
							</li></ul></div></section></section><section class="section" id="osdk-golang-tutorial"><div class="titlepage"><div><div><h3 class="title">5.3.2. Operator SDK tutorial for Go-based Operators</h3></div></div></div><p>
					Operator developers can take advantage of Go programming language support in the Operator SDK to build an example Go-based Operator for Memcached, a distributed key-value store, and manage its lifecycle.
				</p><p>
					This process is accomplished using two centerpieces of the Operator Framework:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Operator SDK</span></dt><dd>
								The <code class="literal">operator-sdk</code> CLI tool and <code class="literal">controller-runtime</code> library API
							</dd><dt><span class="term">Operator Lifecycle Manager (OLM)</span></dt><dd>
								Installation, upgrade, and role-based access control (RBAC) of Operators on a cluster
							</dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						This tutorial goes into greater detail than <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-golang-quickstart">Getting started with Operator SDK for Go-based Operators</a>.
					</p></div></div><section class="section" id="osdk-common-prereqs_osdk-golang-tutorial"><div class="titlepage"><div><div><h4 class="title">5.3.2.1. Prerequisites</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Operator SDK CLI installed
							</li><li class="listitem">
								OpenShift CLI (<code class="literal">oc</code>) v4.13+ installed
							</li><li class="listitem">
								<a class="link" href="https://golang.org/dl/">Go</a> v1.19+
							</li><li class="listitem">
								Logged into an OpenShift Container Platform 4.13 cluster with <code class="literal">oc</code> with an account that has <code class="literal">cluster-admin</code> permissions
							</li><li class="listitem">
								To allow the cluster to pull the image, the repository where you push your image must be set as public, or you must configure an image pull secret
							</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-installing-cli">Installing the Operator SDK CLI</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cli_tools/#getting-started-cli">Getting started with the OpenShift CLI</a>
							</li></ul></div></section><section class="section" id="osdk-create-project_osdk-golang-tutorial"><div class="titlepage"><div><div><h4 class="title">5.3.2.2. Creating a project</h4></div></div></div><p>
						Use the Operator SDK CLI to create a project called <code class="literal">memcached-operator</code>.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a directory for the project:
							</p><pre class="programlisting language-terminal">$ mkdir -p $HOME/projects/memcached-operator</pre></li><li class="listitem"><p class="simpara">
								Change to the directory:
							</p><pre class="programlisting language-terminal">$ cd $HOME/projects/memcached-operator</pre></li><li class="listitem"><p class="simpara">
								Activate support for Go modules:
							</p><pre class="programlisting language-terminal">$ export GO111MODULE=on</pre></li><li class="listitem"><p class="simpara">
								Run the <code class="literal">operator-sdk init</code> command to initialize the project:
							</p><pre class="programlisting language-terminal">$ operator-sdk init \
    --domain=example.com \
    --repo=github.com/example-inc/memcached-operator</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The <code class="literal">operator-sdk init</code> command uses the Go plugin by default.
								</p></div></div><p class="simpara">
								The <code class="literal">operator-sdk init</code> command generates a <code class="literal">go.mod</code> file to be used with <a class="link" href="https://golang.org/ref/mod">Go modules</a>. The <code class="literal">--repo</code> flag is required when creating a project outside of <code class="literal">$GOPATH/src/</code>, because generated files require a valid module path.
							</p></li></ol></div><section class="section" id="osdk-project-file_osdk-golang-tutorial"><div class="titlepage"><div><div><h5 class="title">5.3.2.2.1. PROJECT file</h5></div></div></div><p>
							Among the files generated by the <code class="literal">operator-sdk init</code> command is a Kubebuilder <code class="literal">PROJECT</code> file. Subsequent <code class="literal">operator-sdk</code> commands, as well as <code class="literal">help</code> output, that are run from the project root read this file and are aware that the project type is Go. For example:
						</p><pre class="programlisting language-yaml">domain: example.com
layout:
- go.kubebuilder.io/v3
projectName: memcached-operator
repo: github.com/example-inc/memcached-operator
version: "3"
plugins:
  manifests.sdk.operatorframework.io/v2: {}
  scorecard.sdk.operatorframework.io/v2: {}
  sdk.x-openshift.io/v1: {}</pre></section><section class="section" id="osdk-golang-manager_osdk-golang-tutorial"><div class="titlepage"><div><div><h5 class="title">5.3.2.2.2. About the Manager</h5></div></div></div><p>
							The main program for the Operator is the <code class="literal">main.go</code> file, which initializes and runs the <a class="link" href="https://godoc.org/github.com/kubernetes-sigs/controller-runtime/pkg/manager#Manager">Manager</a>. The Manager automatically registers the Scheme for all custom resource (CR) API definitions and sets up and runs controllers and webhooks.
						</p><p>
							The Manager can restrict the namespace that all controllers watch for resources:
						</p><pre class="programlisting language-go">mgr, err := ctrl.NewManager(cfg, manager.Options{Namespace: namespace})</pre><p>
							By default, the Manager watches the namespace where the Operator runs. To watch all namespaces, you can leave the <code class="literal">namespace</code> option empty:
						</p><pre class="programlisting language-go">mgr, err := ctrl.NewManager(cfg, manager.Options{Namespace: ""})</pre><p>
							You can also use the <a class="link" href="https://godoc.org/github.com/kubernetes-sigs/controller-runtime/pkg/cache#MultiNamespacedCacheBuilder"><code class="literal">MultiNamespacedCacheBuilder</code></a> function to watch a specific set of namespaces:
						</p><pre class="programlisting language-go">var namespaces []string <span id="CO48-1"><!--Empty--></span><span class="callout">1</span>
mgr, err := ctrl.NewManager(cfg, manager.Options{ <span id="CO48-2"><!--Empty--></span><span class="callout">2</span>
   NewCache: cache.MultiNamespacedCacheBuilder(namespaces),
})</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO48-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									List of namespaces.
								</div></dd><dt><a href="#CO48-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Creates a <code class="literal">Cmd</code> struct to provide shared dependencies and start components.
								</div></dd></dl></div></section><section class="section" id="osdk-golang-multi-group-apis_osdk-golang-tutorial"><div class="titlepage"><div><div><h5 class="title">5.3.2.2.3. About multi-group APIs</h5></div></div></div><p>
							Before you create an API and controller, consider whether your Operator requires multiple API groups. This tutorial covers the default case of a single group API, but to change the layout of your project to support multi-group APIs, you can run the following command:
						</p><pre class="programlisting language-terminal">$ operator-sdk edit --multigroup=true</pre><p>
							This command updates the <code class="literal">PROJECT</code> file, which should look like the following example:
						</p><pre class="programlisting language-yaml">domain: example.com
layout: go.kubebuilder.io/v3
multigroup: true
...</pre><p>
							For multi-group projects, the API Go type files are created in the <code class="literal">apis/&lt;group&gt;/&lt;version&gt;/</code> directory, and the controllers are created in the <code class="literal">controllers/&lt;group&gt;/</code> directory. The Dockerfile is then updated accordingly.
						</p><div class="itemizedlist"><p class="title"><strong>Additional resource</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									For more details on migrating to a multi-group project, see the <a class="link" href="https://book.kubebuilder.io/migration/multi-group.html">Kubebuilder documentation</a>.
								</li></ul></div></section></section><section class="section" id="osdk-golang-create-api-controller_osdk-golang-tutorial"><div class="titlepage"><div><div><h4 class="title">5.3.2.3. Creating an API and controller</h4></div></div></div><p>
						Use the Operator SDK CLI to create a custom resource definition (CRD) API and controller.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Run the following command to create an API with group <code class="literal">cache</code>, version, <code class="literal">v1</code>, and kind <code class="literal">Memcached</code>:
							</p><pre class="programlisting language-terminal">$ operator-sdk create api \
    --group=cache \
    --version=v1 \
    --kind=Memcached</pre></li><li class="listitem"><p class="simpara">
								When prompted, enter <code class="literal">y</code> for creating both the resource and controller:
							</p><pre class="programlisting language-terminal">Create Resource [y/n]
y
Create Controller [y/n]
y</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">Writing scaffold for you to edit...
api/v1/memcached_types.go
controllers/memcached_controller.go
...</pre>

								</p></div></li></ol></div><p>
						This process generates the <code class="literal">Memcached</code> resource API at <code class="literal">api/v1/memcached_types.go</code> and the controller at <code class="literal">controllers/memcached_controller.go</code>.
					</p><section class="section" id="osdk-golang-define-api_osdk-golang-tutorial"><div class="titlepage"><div><div><h5 class="title">5.3.2.3.1. Defining the API</h5></div></div></div><p>
							Define the API for the <code class="literal">Memcached</code> custom resource (CR).
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Modify the Go type definitions at <code class="literal">api/v1/memcached_types.go</code> to have the following <code class="literal">spec</code> and <code class="literal">status</code>:
								</p><pre class="programlisting language-go">// MemcachedSpec defines the desired state of Memcached
type MemcachedSpec struct {
	// +kubebuilder:validation:Minimum=0
	// Size is the size of the memcached deployment
	Size int32 `json:"size"`
}

// MemcachedStatus defines the observed state of Memcached
type MemcachedStatus struct {
	// Nodes are the names of the memcached pods
	Nodes []string `json:"nodes"`
}</pre></li><li class="listitem"><p class="simpara">
									Update the generated code for the resource type:
								</p><pre class="programlisting language-terminal">$ make generate</pre><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
									After you modify a <code class="literal">*_types.go</code> file, you must run the <code class="literal">make generate</code> command to update the generated code for that resource type.
								</p></div></div><p class="simpara">
									The above Makefile target invokes the <code class="literal">controller-gen</code> utility to update the <code class="literal">api/v1/zz_generated.deepcopy.go</code> file. This ensures your API Go type definitions implement the <code class="literal">runtime.Object</code> interface that all Kind types must implement.
								</p></li></ol></div></section><section class="section" id="osdk-golang-generate-crd_osdk-golang-tutorial"><div class="titlepage"><div><div><h5 class="title">5.3.2.3.2. Generating CRD manifests</h5></div></div></div><p>
							After the API is defined with <code class="literal">spec</code> and <code class="literal">status</code> fields and custom resource definition (CRD) validation markers, you can generate CRD manifests.
						</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Run the following command to generate and update CRD manifests:
								</p><pre class="programlisting language-terminal">$ make manifests</pre><p class="simpara">
									This Makefile target invokes the <code class="literal">controller-gen</code> utility to generate the CRD manifests in the <code class="literal">config/crd/bases/cache.example.com_memcacheds.yaml</code> file.
								</p></li></ul></div><section class="section" id="osdk-about-openapi-validation_osdk-golang-tutorial"><div class="titlepage"><div><div><h6 class="title">5.3.2.3.2.1. About OpenAPI validation</h6></div></div></div><p>
								OpenAPIv3 schemas are added to CRD manifests in the <code class="literal">spec.validation</code> block when the manifests are generated. This validation block allows Kubernetes to validate the properties in a Memcached custom resource (CR) when it is created or updated.
							</p><p>
								Markers, or annotations, are available to configure validations for your API. These markers always have a <code class="literal">+kubebuilder:validation</code> prefix.
							</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem"><p class="simpara">
										For more details on the usage of markers in API code, see the following Kubebuilder documentation:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												<a class="link" href="https://book.kubebuilder.io/reference/generating-crd.html">CRD generation</a>
											</li><li class="listitem">
												<a class="link" href="https://book.kubebuilder.io/reference/markers.html">Markers</a>
											</li><li class="listitem">
												<a class="link" href="https://book.kubebuilder.io/reference/markers/crd-validation.html">List of OpenAPIv3 validation markers</a>
											</li></ul></div></li><li class="listitem">
										For more details about OpenAPIv3 validation schemas in CRDs, see the <a class="link" href="https://kubernetes.io/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definitions/#specifying-a-structural-schema">Kubernetes documentation</a>.
									</li></ul></div></section></section></section><section class="section" id="osdk-golang-implement-controller_osdk-golang-tutorial"><div class="titlepage"><div><div><h4 class="title">5.3.2.4. Implementing the controller</h4></div></div></div><p>
						After creating a new API and controller, you can implement the controller logic.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								For this example, replace the generated controller file <code class="literal">controllers/memcached_controller.go</code> with following example implementation:
							</p><div class="example" id="idm139731978119840"><p class="title"><strong>Example 5.1. Example <code class="literal">memcached_controller.go</code></strong></p><div class="example-contents"><pre class="programlisting language-golang">/*
Copyright 2020.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

package controllers

import (
        appsv1 "k8s.io/api/apps/v1"
        corev1 "k8s.io/api/core/v1"
        "k8s.io/apimachinery/pkg/api/errors"
        metav1 "k8s.io/apimachinery/pkg/apis/meta/v1"
        "k8s.io/apimachinery/pkg/types"
        "reflect"

        "context"

        "github.com/go-logr/logr"
        "k8s.io/apimachinery/pkg/runtime"
        ctrl "sigs.k8s.io/controller-runtime"
        "sigs.k8s.io/controller-runtime/pkg/client"
        ctrllog "sigs.k8s.io/controller-runtime/pkg/log"

        cachev1 "github.com/example-inc/memcached-operator/api/v1"
)

// MemcachedReconciler reconciles a Memcached object
type MemcachedReconciler struct {
        client.Client
        Log    logr.Logger
        Scheme *runtime.Scheme
}

// +kubebuilder:rbac:groups=cache.example.com,resources=memcacheds,verbs=get;list;watch;create;update;patch;delete
// +kubebuilder:rbac:groups=cache.example.com,resources=memcacheds/status,verbs=get;update;patch
// +kubebuilder:rbac:groups=cache.example.com,resources=memcacheds/finalizers,verbs=update
// +kubebuilder:rbac:groups=apps,resources=deployments,verbs=get;list;watch;create;update;patch;delete
// +kubebuilder:rbac:groups=core,resources=pods,verbs=get;list;

// Reconcile is part of the main kubernetes reconciliation loop which aims to
// move the current state of the cluster closer to the desired state.
// TODO(user): Modify the Reconcile function to compare the state specified by
// the Memcached object against the actual cluster state, and then
// perform operations to make the cluster state reflect the state specified by
// the user.
//
// For more details, check Reconcile and its Result here:
// - https://pkg.go.dev/sigs.k8s.io/controller-runtime@v0.7.0/pkg/reconcile
func (r *MemcachedReconciler) Reconcile(ctx context.Context, req ctrl.Request) (ctrl.Result, error) {
        //log := r.Log.WithValues("memcached", req.NamespacedName)
        log := ctrllog.FromContext(ctx)
        // Fetch the Memcached instance
        memcached := &amp;cachev1.Memcached{}
        err := r.Get(ctx, req.NamespacedName, memcached)
        if err != nil {
                if errors.IsNotFound(err) {
                        // Request object not found, could have been deleted after reconcile request.
                        // Owned objects are automatically garbage collected. For additional cleanup logic use finalizers.
                        // Return and don't requeue
                        log.Info("Memcached resource not found. Ignoring since object must be deleted")
                        return ctrl.Result{}, nil
                }
                // Error reading the object - requeue the request.
                log.Error(err, "Failed to get Memcached")
                return ctrl.Result{}, err
        }

        // Check if the deployment already exists, if not create a new one
        found := &amp;appsv1.Deployment{}
        err = r.Get(ctx, types.NamespacedName{Name: memcached.Name, Namespace: memcached.Namespace}, found)
        if err != nil &amp;&amp; errors.IsNotFound(err) {
                // Define a new deployment
                dep := r.deploymentForMemcached(memcached)
                log.Info("Creating a new Deployment", "Deployment.Namespace", dep.Namespace, "Deployment.Name", dep.Name)
                err = r.Create(ctx, dep)
                if err != nil {
                        log.Error(err, "Failed to create new Deployment", "Deployment.Namespace", dep.Namespace, "Deployment.Name", dep.Name)
                        return ctrl.Result{}, err
                }
                // Deployment created successfully - return and requeue
                return ctrl.Result{Requeue: true}, nil
        } else if err != nil {
                log.Error(err, "Failed to get Deployment")
                return ctrl.Result{}, err
        }

        // Ensure the deployment size is the same as the spec
        size := memcached.Spec.Size
        if *found.Spec.Replicas != size {
                found.Spec.Replicas = &amp;size
                err = r.Update(ctx, found)
                if err != nil {
                        log.Error(err, "Failed to update Deployment", "Deployment.Namespace", found.Namespace, "Deployment.Name", found.Name)
                        return ctrl.Result{}, err
                }
                // Spec updated - return and requeue
                return ctrl.Result{Requeue: true}, nil
        }

        // Update the Memcached status with the pod names
        // List the pods for this memcached's deployment
        podList := &amp;corev1.PodList{}
        listOpts := []client.ListOption{
                client.InNamespace(memcached.Namespace),
                client.MatchingLabels(labelsForMemcached(memcached.Name)),
        }
        if err = r.List(ctx, podList, listOpts...); err != nil {
                log.Error(err, "Failed to list pods", "Memcached.Namespace", memcached.Namespace, "Memcached.Name", memcached.Name)
                return ctrl.Result{}, err
        }
        podNames := getPodNames(podList.Items)

        // Update status.Nodes if needed
        if !reflect.DeepEqual(podNames, memcached.Status.Nodes) {
                memcached.Status.Nodes = podNames
                err := r.Status().Update(ctx, memcached)
                if err != nil {
                        log.Error(err, "Failed to update Memcached status")
                        return ctrl.Result{}, err
                }
        }

        return ctrl.Result{}, nil
}

// deploymentForMemcached returns a memcached Deployment object
func (r *MemcachedReconciler) deploymentForMemcached(m *cachev1.Memcached) *appsv1.Deployment {
        ls := labelsForMemcached(m.Name)
        replicas := m.Spec.Size

        dep := &amp;appsv1.Deployment{
                ObjectMeta: metav1.ObjectMeta{
                        Name:      m.Name,
                        Namespace: m.Namespace,
                },
                Spec: appsv1.DeploymentSpec{
                        Replicas: &amp;replicas,
                        Selector: &amp;metav1.LabelSelector{
                                MatchLabels: ls,
                        },
                        Template: corev1.PodTemplateSpec{
                                ObjectMeta: metav1.ObjectMeta{
                                        Labels: ls,
                                },
                                Spec: corev1.PodSpec{
                                        Containers: []corev1.Container{{
                                                Image:   "memcached:1.4.36-alpine",
                                                Name:    "memcached",
                                                Command: []string{"memcached", "-m=64", "-o", "modern", "-v"},
                                                Ports: []corev1.ContainerPort{{
                                                        ContainerPort: 11211,
                                                        Name:          "memcached",
                                                }},
                                        }},
                                },
                        },
                },
        }
        // Set Memcached instance as the owner and controller
        ctrl.SetControllerReference(m, dep, r.Scheme)
        return dep
}

// labelsForMemcached returns the labels for selecting the resources
// belonging to the given memcached CR name.
func labelsForMemcached(name string) map[string]string {
        return map[string]string{"app": "memcached", "memcached_cr": name}
}

// getPodNames returns the pod names of the array of pods passed in
func getPodNames(pods []corev1.Pod) []string {
        var podNames []string
        for _, pod := range pods {
                podNames = append(podNames, pod.Name)
        }
        return podNames
}

// SetupWithManager sets up the controller with the Manager.
func (r *MemcachedReconciler) SetupWithManager(mgr ctrl.Manager) error {
        return ctrl.NewControllerManagedBy(mgr).
                For(&amp;cachev1.Memcached{}).
                Owns(&amp;appsv1.Deployment{}).
                Complete(r)
}</pre></div></div><p class="simpara">
								The example controller runs the following reconciliation logic for each <code class="literal">Memcached</code> custom resource (CR):
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Create a Memcached deployment if it does not exist.
									</li><li class="listitem">
										Ensure that the deployment size is the same as specified by the <code class="literal">Memcached</code> CR spec.
									</li><li class="listitem">
										Update the <code class="literal">Memcached</code> CR status with the names of the <code class="literal">memcached</code> pods.
									</li></ul></div></li></ul></div><p>
						The next subsections explain how the controller in the example implementation watches resources and how the reconcile loop is triggered. You can skip these subsections to go directly to <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-run-operator_osdk-golang-tutorial">Running the Operator</a>.
					</p><section class="section" id="osdk-golang-controller-resources_osdk-golang-tutorial"><div class="titlepage"><div><div><h5 class="title">5.3.2.4.1. Resources watched by the controller</h5></div></div></div><p>
							The <code class="literal">SetupWithManager()</code> function in <code class="literal">controllers/memcached_controller.go</code> specifies how the controller is built to watch a CR and other resources that are owned and managed by that controller.
						</p><pre class="programlisting language-go">import (
	...
	appsv1 "k8s.io/api/apps/v1"
	...
)

func (r *MemcachedReconciler) SetupWithManager(mgr ctrl.Manager) error {
	return ctrl.NewControllerManagedBy(mgr).
		For(&amp;cachev1.Memcached{}).
		Owns(&amp;appsv1.Deployment{}).
		Complete(r)
}</pre><p>
							<code class="literal">NewControllerManagedBy()</code> provides a controller builder that allows various controller configurations.
						</p><p>
							<code class="literal">For(&amp;cachev1.Memcached{})</code> specifies the <code class="literal">Memcached</code> type as the primary resource to watch. For each Add, Update, or Delete event for a <code class="literal">Memcached</code> type, the reconcile loop is sent a reconcile <code class="literal">Request</code> argument, which consists of a namespace and name key, for that <code class="literal">Memcached</code> object.
						</p><p>
							<code class="literal">Owns(&amp;appsv1.Deployment{})</code> specifies the <code class="literal">Deployment</code> type as the secondary resource to watch. For each <code class="literal">Deployment</code> type Add, Update, or Delete event, the event handler maps each event to a reconcile request for the owner of the deployment. In this case, the owner is the <code class="literal">Memcached</code> object for which the deployment was created.
						</p></section><section class="section" id="osdk-golang-controller-configs_osdk-golang-tutorial"><div class="titlepage"><div><div><h5 class="title">5.3.2.4.2. Controller configurations</h5></div></div></div><p>
							You can initialize a controller by using many other useful configurations. For example:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Set the maximum number of concurrent reconciles for the controller by using the <code class="literal">MaxConcurrentReconciles</code> option, which defaults to <code class="literal">1</code>:
								</p><pre class="programlisting language-go">func (r *MemcachedReconciler) SetupWithManager(mgr ctrl.Manager) error {
    return ctrl.NewControllerManagedBy(mgr).
        For(&amp;cachev1.Memcached{}).
        Owns(&amp;appsv1.Deployment{}).
        WithOptions(controller.Options{
            MaxConcurrentReconciles: 2,
        }).
        Complete(r)
}</pre></li><li class="listitem">
									Filter watch events using predicates.
								</li><li class="listitem">
									Choose the type of <a class="link" href="https://godoc.org/sigs.k8s.io/controller-runtime/pkg/handler#hdr-EventHandlers">EventHandler</a> to change how a watch event translates to reconcile requests for the reconcile loop. For Operator relationships that are more complex than primary and secondary resources, you can use the <code class="literal">EnqueueRequestsFromMapFunc</code> handler to transform a watch event into an arbitrary set of reconcile requests.
								</li></ul></div><p>
							For more details on these and other configurations, see the upstream <a class="link" href="https://godoc.org/github.com/kubernetes-sigs/controller-runtime/pkg/builder#example-Builder">Builder</a> and <a class="link" href="https://godoc.org/github.com/kubernetes-sigs/controller-runtime/pkg/controller">Controller</a> GoDocs.
						</p></section><section class="section" id="osdk-golang-controller-reconcile-loop_osdk-golang-tutorial"><div class="titlepage"><div><div><h5 class="title">5.3.2.4.3. Reconcile loop</h5></div></div></div><p>
							Every controller has a reconciler object with a <code class="literal">Reconcile()</code> method that implements the reconcile loop. The reconcile loop is passed the <code class="literal">Request</code> argument, which is a namespace and name key used to find the primary resource object, <code class="literal">Memcached</code>, from the cache:
						</p><pre class="programlisting language-go">import (
	ctrl "sigs.k8s.io/controller-runtime"

	cachev1 "github.com/example-inc/memcached-operator/api/v1"
	...
)

func (r *MemcachedReconciler) Reconcile(ctx context.Context, req ctrl.Request) (ctrl.Result, error) {
  // Lookup the Memcached instance for this reconcile request
  memcached := &amp;cachev1.Memcached{}
  err := r.Get(ctx, req.NamespacedName, memcached)
  ...
}</pre><p>
							Based on the return values, result, and error, the request might be requeued and the reconcile loop might be triggered again:
						</p><pre class="programlisting language-go">// Reconcile successful - don't requeue
return ctrl.Result{}, nil
// Reconcile failed due to error - requeue
return ctrl.Result{}, err
// Requeue for any reason other than an error
return ctrl.Result{Requeue: true}, nil</pre><p>
							You can set the <code class="literal">Result.RequeueAfter</code> to requeue the request after a grace period as well:
						</p><pre class="programlisting language-go">import "time"

// Reconcile for any reason other than an error after 5 seconds
return ctrl.Result{RequeueAfter: time.Second*5}, nil</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								You can return <code class="literal">Result</code> with <code class="literal">RequeueAfter</code> set to periodically reconcile a CR.
							</p></div></div><p>
							For more on reconcilers, clients, and interacting with resource events, see the <a class="link" href="https://sdk.operatorframework.io/docs/building-operators/golang/references/client/">Controller Runtime Client API</a> documentation.
						</p></section><section class="section" id="osdk-golang-controller-rbac-markers_osdk-golang-tutorial"><div class="titlepage"><div><div><h5 class="title">5.3.2.4.4. Permissions and RBAC manifests</h5></div></div></div><p>
							The controller requires certain RBAC permissions to interact with the resources it manages. These are specified using RBAC markers, such as the following:
						</p><pre class="programlisting language-go">// +kubebuilder:rbac:groups=cache.example.com,resources=memcacheds,verbs=get;list;watch;create;update;patch;delete
// +kubebuilder:rbac:groups=cache.example.com,resources=memcacheds/status,verbs=get;update;patch
// +kubebuilder:rbac:groups=cache.example.com,resources=memcacheds/finalizers,verbs=update
// +kubebuilder:rbac:groups=apps,resources=deployments,verbs=get;list;watch;create;update;patch;delete
// +kubebuilder:rbac:groups=core,resources=pods,verbs=get;list;

func (r *MemcachedReconciler) Reconcile(ctx context.Context, req ctrl.Request) (ctrl.Result, error) {
  ...
}</pre><p>
							The <code class="literal">ClusterRole</code> object manifest at <code class="literal">config/rbac/role.yaml</code> is generated from the previous markers by using the <code class="literal">controller-gen</code> utility whenever the <code class="literal">make manifests</code> command is run.
						</p></section></section><section class="section" id="osdk-run-proxy_osdk-golang-tutorial"><div class="titlepage"><div><div><h4 class="title">5.3.2.5. Enabling proxy support</h4></div></div></div><p>
						Operator authors can develop Operators that support network proxies. Cluster administrators configure proxy support for the environment variables that are handled by Operator Lifecycle Manager (OLM). To support proxied clusters, your Operator must inspect the environment for the following standard proxy variables and pass the values to Operands:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">HTTP_PROXY</code>
							</li><li class="listitem">
								<code class="literal">HTTPS_PROXY</code>
							</li><li class="listitem">
								<code class="literal">NO_PROXY</code>
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							This tutorial uses <code class="literal">HTTP_PROXY</code> as an example environment variable.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								A cluster with cluster-wide egress proxy enabled.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Edit the <code class="literal">controllers/memcached_controller.go</code> file to include the following:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Import the <code class="literal">proxy</code> package from the <a class="link" href="https://github.com/operator-framework/operator-lib/releases/tag/v0.7.0"><code class="literal">operator-lib</code></a> library:
									</p><pre class="programlisting language-golang">import (
  ...
   "github.com/operator-framework/operator-lib/proxy"
)</pre></li><li class="listitem"><p class="simpara">
										Add the <code class="literal">proxy.ReadProxyVarsFromEnv</code> helper function to the reconcile loop and append the results to the Operand environments:
									</p><pre class="programlisting language-golang">for i, container := range dep.Spec.Template.Spec.Containers {
		dep.Spec.Template.Spec.Containers[i].Env = append(container.Env, proxy.ReadProxyVarsFromEnv()...)
}
...</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								Set the environment variable on the Operator deployment by adding the following to the <code class="literal">config/manager/manager.yaml</code> file:
							</p><pre class="programlisting language-yaml">containers:
 - args:
   - --leader-elect
   - --leader-election-id=ansible-proxy-demo
   image: controller:latest
   name: manager
   env:
     - name: "HTTP_PROXY"
       value: "http_proxy_test"</pre></li></ol></div></section><section class="section" id="osdk-run-operator_osdk-golang-tutorial"><div class="titlepage"><div><div><h4 class="title">5.3.2.6. Running the Operator</h4></div></div></div><p>
						There are three ways you can use the Operator SDK CLI to build and run your Operator:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Run locally outside the cluster as a Go program.
							</li><li class="listitem">
								Run as a deployment on the cluster.
							</li><li class="listitem">
								Bundle your Operator and use Operator Lifecycle Manager (OLM) to deploy on the cluster.
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Before running your Go-based Operator as either a deployment on OpenShift Container Platform or as a bundle that uses OLM, ensure that your project has been updated to use supported images.
						</p></div></div><section class="section" id="osdk-run-locally_osdk-golang-tutorial"><div class="titlepage"><div><div><h5 class="title">5.3.2.6.1. Running locally outside the cluster</h5></div></div></div><p>
							You can run your Operator project as a Go program outside of the cluster. This is useful for development purposes to speed up deployment and testing.
						</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Run the following command to install the custom resource definitions (CRDs) in the cluster configured in your <code class="literal">~/.kube/config</code> file and run the Operator locally:
								</p><pre class="programlisting language-terminal">$ make install run</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">...
2021-01-10T21:09:29.016-0700	INFO	controller-runtime.metrics	metrics server is starting to listen	{"addr": ":8080"}
2021-01-10T21:09:29.017-0700	INFO	setup	starting manager
2021-01-10T21:09:29.017-0700	INFO	controller-runtime.manager	starting metrics server	{"path": "/metrics"}
2021-01-10T21:09:29.018-0700	INFO	controller-runtime.manager.controller.memcached	Starting EventSource	{"reconciler group": "cache.example.com", "reconciler kind": "Memcached", "source": "kind source: /, Kind="}
2021-01-10T21:09:29.218-0700	INFO	controller-runtime.manager.controller.memcached	Starting Controller	{"reconciler group": "cache.example.com", "reconciler kind": "Memcached"}
2021-01-10T21:09:29.218-0700	INFO	controller-runtime.manager.controller.memcached	Starting workers	{"reconciler group": "cache.example.com", "reconciler kind": "Memcached", "worker count": 1}</pre>

									</p></div></li></ul></div></section><section class="section" id="osdk-run-deployment_osdk-golang-tutorial"><div class="titlepage"><div><div><h5 class="title">5.3.2.6.2. Running as a deployment on the cluster</h5></div></div></div><p>
							You can run your Operator project as a deployment on your cluster.
						</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									Prepared your Go-based Operator to run on OpenShift Container Platform by updating the project to use supported images
								</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Run the following <code class="literal">make</code> commands to build and push the Operator image. Modify the <code class="literal">IMG</code> argument in the following steps to reference a repository that you have access to. You can obtain an account for storing containers at repository sites such as Quay.io.
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Build the image:
										</p><pre class="programlisting language-terminal">$ make docker-build IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												The Dockerfile generated by the SDK for the Operator explicitly references <code class="literal">GOARCH=amd64</code> for <code class="literal">go build</code>. This can be amended to <code class="literal">GOARCH=$TARGETARCH</code> for non-AMD64 architectures. Docker will automatically set the environment variable to the value specified by <code class="literal">–platform</code>. With Buildah, the <code class="literal">–build-arg</code> will need to be used for the purpose. For more information, see <a class="link" href="https://sdk.operatorframework.io/docs/advanced-topics/multi-arch/#supporting-multiple-architectures">Multiple Architectures</a>.
											</p></div></div></li><li class="listitem"><p class="simpara">
											Push the image to a repository:
										</p><pre class="programlisting language-terminal">$ make docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												The name and tag of the image, for example <code class="literal">IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</code>, in both the commands can also be set in your Makefile. Modify the <code class="literal">IMG ?= controller:latest</code> value to set your default image name.
											</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
									Run the following command to deploy the Operator:
								</p><pre class="programlisting language-terminal">$ make deploy IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><p class="simpara">
									By default, this command creates a namespace with the name of your Operator project in the form <code class="literal">&lt;project_name&gt;-system</code> and is used for the deployment. This command also installs the RBAC manifests from <code class="literal">config/rbac</code>.
								</p></li><li class="listitem"><p class="simpara">
									Run the following command to verify that the Operator is running:
								</p><pre class="programlisting language-terminal">$ oc get deployment -n &lt;project_name&gt;-system</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME                                    READY   UP-TO-DATE   AVAILABLE   AGE
&lt;project_name&gt;-controller-manager       1/1     1            1           8m</pre>

									</p></div></li></ol></div></section><section class="section" id="osdk-bundle-deploy-olm_osdk-golang-tutorial"><div class="titlepage"><div><div><h5 class="title">5.3.2.6.3. Bundling an Operator and deploying with Operator Lifecycle Manager</h5></div></div></div><section class="section" id="osdk-bundle-operator_osdk-golang-tutorial"><div class="titlepage"><div><div><h6 class="title">5.3.2.6.3.1. Bundling an Operator</h6></div></div></div><p>
								The Operator bundle format is the default packaging method for Operator SDK and Operator Lifecycle Manager (OLM). You can get your Operator ready for use on OLM by using the Operator SDK to build and push your Operator project as a bundle image.
							</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
										Operator SDK CLI installed on a development workstation
									</li><li class="listitem">
										OpenShift CLI (<code class="literal">oc</code>) v4.13+ installed
									</li><li class="listitem">
										Operator project initialized by using the Operator SDK
									</li><li class="listitem">
										If your Operator is Go-based, your project must be updated to use supported images for running on OpenShift Container Platform
									</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
										Run the following <code class="literal">make</code> commands in your Operator project directory to build and push your Operator image. Modify the <code class="literal">IMG</code> argument in the following steps to reference a repository that you have access to. You can obtain an account for storing containers at repository sites such as Quay.io.
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
												Build the image:
											</p><pre class="programlisting language-terminal">$ make docker-build IMG=&lt;registry&gt;/&lt;user&gt;/&lt;operator_image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
													The Dockerfile generated by the SDK for the Operator explicitly references <code class="literal">GOARCH=amd64</code> for <code class="literal">go build</code>. This can be amended to <code class="literal">GOARCH=$TARGETARCH</code> for non-AMD64 architectures. Docker will automatically set the environment variable to the value specified by <code class="literal">–platform</code>. With Buildah, the <code class="literal">–build-arg</code> will need to be used for the purpose. For more information, see <a class="link" href="https://sdk.operatorframework.io/docs/advanced-topics/multi-arch/#supporting-multiple-architectures">Multiple Architectures</a>.
												</p></div></div></li><li class="listitem"><p class="simpara">
												Push the image to a repository:
											</p><pre class="programlisting language-terminal">$ make docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;operator_image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li><li class="listitem"><p class="simpara">
										Create your Operator bundle manifest by running the <code class="literal">make bundle</code> command, which invokes several commands, including the Operator SDK <code class="literal">generate bundle</code> and <code class="literal">bundle validate</code> subcommands:
									</p><pre class="programlisting language-terminal">$ make bundle IMG=&lt;registry&gt;/&lt;user&gt;/&lt;operator_image_name&gt;:&lt;tag&gt;</pre><p class="simpara">
										Bundle manifests for an Operator describe how to display, create, and manage an application. The <code class="literal">make bundle</code> command creates the following files and directories in your Operator project:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												A bundle manifests directory named <code class="literal">bundle/manifests</code> that contains a <code class="literal">ClusterServiceVersion</code> object
											</li><li class="listitem">
												A bundle metadata directory named <code class="literal">bundle/metadata</code>
											</li><li class="listitem">
												All custom resource definitions (CRDs) in a <code class="literal">config/crd</code> directory
											</li><li class="listitem">
												A Dockerfile <code class="literal">bundle.Dockerfile</code>
											</li></ul></div><p class="simpara">
										These files are then automatically validated by using <code class="literal">operator-sdk bundle validate</code> to ensure the on-disk bundle representation is correct.
									</p></li><li class="listitem"><p class="simpara">
										Build and push your bundle image by running the following commands. OLM consumes Operator bundles using an index image, which reference one or more bundle images.
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
												Build the bundle image. Set <code class="literal">BUNDLE_IMG</code> with the details for the registry, user namespace, and image tag where you intend to push the image:
											</p><pre class="programlisting language-terminal">$ make bundle-build BUNDLE_IMG=&lt;registry&gt;/&lt;user&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt;</pre></li><li class="listitem"><p class="simpara">
												Push the bundle image:
											</p><pre class="programlisting language-terminal">$ docker push &lt;registry&gt;/&lt;user&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li></ol></div></section><section class="section" id="osdk-deploy-olm_osdk-golang-tutorial"><div class="titlepage"><div><div><h6 class="title">5.3.2.6.3.2. Deploying an Operator with Operator Lifecycle Manager</h6></div></div></div><p>
								Operator Lifecycle Manager (OLM) helps you to install, update, and manage the lifecycle of Operators and their associated services on a Kubernetes cluster. OLM is installed by default on OpenShift Container Platform and runs as a Kubernetes extension so that you can use the web console and the OpenShift CLI (<code class="literal">oc</code>) for all Operator lifecycle management functions without any additional tools.
							</p><p>
								The Operator bundle format is the default packaging method for Operator SDK and OLM. You can use the Operator SDK to quickly run a bundle image on OLM to ensure that it runs properly.
							</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
										Operator SDK CLI installed on a development workstation
									</li><li class="listitem">
										Operator bundle image built and pushed to a registry
									</li><li class="listitem">
										OLM installed on a Kubernetes-based cluster (v1.16.0 or later if you use <code class="literal">apiextensions.k8s.io/v1</code> CRDs, for example OpenShift Container Platform 4.13)
									</li><li class="listitem">
										Logged in to the cluster with <code class="literal">oc</code> using an account with <code class="literal">cluster-admin</code> permissions
									</li><li class="listitem">
										If your Operator is Go-based, your project must be updated to use supported images for running on OpenShift Container Platform
									</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Enter the following command to run the Operator on the cluster:
									</p><pre class="programlisting language-terminal">$ operator-sdk run bundle \<span id="CO49-1"><!--Empty--></span><span class="callout">1</span>
    -n &lt;namespace&gt; \<span id="CO49-2"><!--Empty--></span><span class="callout">2</span>
    &lt;registry&gt;/&lt;user&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt; <span id="CO49-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO49-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												The <code class="literal">run bundle</code> command creates a valid file-based catalog and installs the Operator bundle on your cluster using OLM.
											</div></dd><dt><a href="#CO49-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												Optional: By default, the command installs the Operator in the currently active project in your <code class="literal">~/.kube/config</code> file. You can add the <code class="literal">-n</code> flag to set a different namespace scope for the installation.
											</div></dd><dt><a href="#CO49-3"><span class="callout">3</span></a> </dt><dd><div class="para">
												If you do not specify an image, the command uses <code class="literal">quay.io/operator-framework/opm:latest</code> as the default index image. If you specify an image, the command uses the bundle image itself as the index image.
											</div></dd></dl></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
											As of OpenShift Container Platform 4.11, the <code class="literal">run bundle</code> command supports the file-based catalog format for Operator catalogs by default. The deprecated SQLite database format for Operator catalogs continues to be supported; however, it will be removed in a future release. It is recommended that Operator authors migrate their workflows to the file-based catalog format.
										</p></div></div><p class="simpara">
										This command performs the following actions:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												Create an index image referencing your bundle image. The index image is opaque and ephemeral, but accurately reflects how a bundle would be added to a catalog in production.
											</li><li class="listitem">
												Create a catalog source that points to your new index image, which enables OperatorHub to discover your Operator.
											</li><li class="listitem">
												Deploy your Operator to your cluster by creating an <code class="literal">OperatorGroup</code>, <code class="literal">Subscription</code>, <code class="literal">InstallPlan</code>, and all other required resources, including RBAC.
											</li></ul></div></li></ul></div></section></section></section><section class="section" id="osdk-create-cr_osdk-golang-tutorial"><div class="titlepage"><div><div><h4 class="title">5.3.2.7. Creating a custom resource</h4></div></div></div><p>
						After your Operator is installed, you can test it by creating a custom resource (CR) that is now provided on the cluster by the Operator.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Example Memcached Operator, which provides the <code class="literal">Memcached</code> CR, installed on a cluster
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Change to the namespace where your Operator is installed. For example, if you deployed the Operator using the <code class="literal">make deploy</code> command:
							</p><pre class="programlisting language-terminal">$ oc project memcached-operator-system</pre></li><li class="listitem"><p class="simpara">
								Edit the sample <code class="literal">Memcached</code> CR manifest at <code class="literal">config/samples/cache_v1_memcached.yaml</code> to contain the following specification:
							</p><pre class="programlisting language-yaml">apiVersion: cache.example.com/v1
kind: Memcached
metadata:
  name: memcached-sample
...
spec:
...
  size: 3</pre></li><li class="listitem"><p class="simpara">
								Create the CR:
							</p><pre class="programlisting language-terminal">$ oc apply -f config/samples/cache_v1_memcached.yaml</pre></li><li class="listitem"><p class="simpara">
								Ensure that the <code class="literal">Memcached</code> Operator creates the deployment for the sample CR with the correct size:
							</p><pre class="programlisting language-terminal">$ oc get deployments</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                    READY   UP-TO-DATE   AVAILABLE   AGE
memcached-operator-controller-manager   1/1     1            1           8m
memcached-sample                        3/3     3            3           1m</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Check the pods and CR status to confirm the status is updated with the Memcached pod names.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Check the pods:
									</p><pre class="programlisting language-terminal">$ oc get pods</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-terminal">NAME                                  READY     STATUS    RESTARTS   AGE
memcached-sample-6fd7c98d8-7dqdr      1/1       Running   0          1m
memcached-sample-6fd7c98d8-g5k7v      1/1       Running   0          1m
memcached-sample-6fd7c98d8-m7vn7      1/1       Running   0          1m</pre>

										</p></div></li><li class="listitem"><p class="simpara">
										Check the CR status:
									</p><pre class="programlisting language-terminal">$ oc get memcached/memcached-sample -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-yaml">apiVersion: cache.example.com/v1
kind: Memcached
metadata:
...
  name: memcached-sample
...
spec:
  size: 3
status:
  nodes:
  - memcached-sample-6fd7c98d8-7dqdr
  - memcached-sample-6fd7c98d8-g5k7v
  - memcached-sample-6fd7c98d8-m7vn7</pre>

										</p></div></li></ol></div></li><li class="listitem"><p class="simpara">
								Update the deployment size.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Update <code class="literal">config/samples/cache_v1_memcached.yaml</code> file to change the <code class="literal">spec.size</code> field in the <code class="literal">Memcached</code> CR from <code class="literal">3</code> to <code class="literal">5</code>:
									</p><pre class="programlisting language-terminal">$ oc patch memcached memcached-sample \
    -p '{"spec":{"size": 5}}' \
    --type=merge</pre></li><li class="listitem"><p class="simpara">
										Confirm that the Operator changes the deployment size:
									</p><pre class="programlisting language-terminal">$ oc get deployments</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-terminal">NAME                                    READY   UP-TO-DATE   AVAILABLE   AGE
memcached-operator-controller-manager   1/1     1            1           10m
memcached-sample                        5/5     5            5           3m</pre>

										</p></div></li></ol></div></li><li class="listitem"><p class="simpara">
								Delete the CR by running the following command:
							</p><pre class="programlisting language-terminal">$ oc delete -f config/samples/cache_v1_memcached.yaml</pre></li><li class="listitem"><p class="simpara">
								Clean up the resources that have been created as part of this tutorial.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										If you used the <code class="literal">make deploy</code> command to test the Operator, run the following command:
									</p><pre class="programlisting language-terminal">$ make undeploy</pre></li><li class="listitem"><p class="simpara">
										If you used the <code class="literal">operator-sdk run bundle</code> command to test the Operator, run the following command:
									</p><pre class="programlisting language-terminal">$ operator-sdk cleanup &lt;project_name&gt;</pre></li></ul></div></li></ol></div></section><section class="section _additional-resources" id="osdk-golang-tutorial-addtl-resources"><div class="titlepage"><div><div><h4 class="title">5.3.2.8. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-golang-project-layout">Project layout for Go-based Operators</a> to learn about the directory structures created by the Operator SDK.
							</li><li class="listitem">
								If a <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#enable-cluster-wide-proxy">cluster-wide egress proxy is configured</a>, cluster administrators can <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-configuring-proxy-support">override the proxy settings or inject a custom CA certificate</a> for specific Operators running on Operator Lifecycle Manager (OLM).
							</li></ul></div></section></section><section class="section" id="osdk-golang-project-layout"><div class="titlepage"><div><div><h3 class="title">5.3.3. Project layout for Go-based Operators</h3></div></div></div><p>
					The <code class="literal">operator-sdk</code> CLI can generate, or <span class="emphasis"><em>scaffold</em></span>, a number of packages and files for each Operator project.
				</p><section class="section" id="osdk-golang-project-layout_osdk-golang-project-layout"><div class="titlepage"><div><div><h4 class="title">5.3.3.1. Go-based project layout</h4></div></div></div><p>
						Go-based Operator projects, the default type, generated using the <code class="literal">operator-sdk init</code> command contain the following files and directories:
					</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 80%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731977753136" scope="col">File or directory</th><th align="left" valign="top" id="idm139731977752048" scope="col">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731977753136"> <p>
										<code class="literal">main.go</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977752048"> <p>
										Main program of the Operator. This instantiates a new manager that registers all custom resource definitions (CRDs) in the <code class="literal">apis/</code> directory and starts all controllers in the <code class="literal">controllers/</code> directory.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977753136"> <p>
										<code class="literal">apis/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977752048"> <p>
										Directory tree that defines the APIs of the CRDs. You must edit the <code class="literal">apis/&lt;version&gt;/&lt;kind&gt;_types.go</code> files to define the API for each resource type and import these packages in your controllers to watch for these resource types.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977753136"> <p>
										<code class="literal">controllers/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977752048"> <p>
										Controller implementations. Edit the <code class="literal">controller/&lt;kind&gt;_controller.go</code> files to define the reconcile logic of the controller for handling a resource type of the specified kind.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977753136"> <p>
										<code class="literal">config/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977752048"> <p>
										Kubernetes manifests used to deploy your controller on a cluster, including CRDs, RBAC, and certificates.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977753136"> <p>
										<code class="literal">Makefile</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977752048"> <p>
										Targets used to build and deploy your controller.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977753136"> <p>
										<code class="literal">Dockerfile</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977752048"> <p>
										Instructions used by a container engine to build your Operator.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977753136"> <p>
										<code class="literal">manifests/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977752048"> <p>
										Kubernetes manifests for registering CRDs, setting up RBAC, and deploying the Operator as a deployment.
									</p>
									 </td></tr></tbody></table></div></section></section><section class="section" id="osdk-golang-updating-projects"><div class="titlepage"><div><div><h3 class="title">5.3.4. Updating Go-based Operator projects for newer Operator SDK versions</h3></div></div></div><p>
					OpenShift Container Platform 4.13 supports Operator SDK 1.28.0. If you already have the 1.25.4 CLI installed on your workstation, you can update the CLI to 1.28.0 by <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-installing-cli">installing the latest version</a>.
				</p><p>
					However, to ensure your existing Operator projects maintain compatibility with Operator SDK 1.28.0, update steps are required for the associated breaking changes introduced since 1.25.4. You must perform the update steps manually in any of your Operator projects that were previously created or maintained with 1.25.4.
				</p><section class="section" id="osdk-upgrading-projects_osdk-golang-updating-projects"><div class="titlepage"><div><div><h4 class="title">5.3.4.1. Updating Go-based Operator projects for Operator SDK 1.28.0</h4></div></div></div><p>
						The following procedure updates an existing Go-based Operator project for compatibility with 1.28.0.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Operator SDK 1.28.0 installed
							</li><li class="listitem">
								An Operator project created or maintained with Operator SDK 1.25.4
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Find the <code class="literal">ose-kube-rbac-proxy</code> pull spec in the following files, and update the image tag to <code class="literal">v4.13</code>:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">config/default/manager_auth_proxy_patch.yaml</code>
									</li><li class="listitem">
										<code class="literal">bundle/manifests/memcached-operator.clusterserviceversion.yaml</code>
									</li></ul></div><pre class="programlisting language-yaml">…
      containers:
      - name: kube-rbac-proxy
        image: registry.redhat.io/openshift4/ose-kube-rbac-proxy:v4.13 <span id="CO50-1"><!--Empty--></span><span class="callout">1</span>
…</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO50-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Update the tag version from <code class="literal">v4.12</code> to <code class="literal">v4.13</code>.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Modify your <code class="literal">go.mod</code> file to include the following dependencies and updated versions:
							</p><pre class="programlisting language-go">k8s.io/api v0.26.2
k8s.io/apiextensions-apiserver v0.26.2
k8s.io/apimachinery v0.26.2
k8s.io/cli-runtime v0.26.2
k8s.io/client-go v0.26.2
k8s.io/kubectl v0.26.2
sigs.k8s.io/controller-runtime v0.14.5
sigs.k8s.io/controller-tools v0.11.3
sigs.k8s.io/kubebuilder/v3 v3.9.1</pre></li><li class="listitem"><p class="simpara">
								Download the latest dependencies by running the following command:
							</p><pre class="programlisting language-terminal">$ go mod tidy</pre></li><li class="listitem"><p class="simpara">
								Modify your Makefile with the following changes:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Change the <code class="literal">ENVTEST_K8S_VERSION</code> field from <code class="literal">1.25</code> to <code class="literal">1.26</code>.
									</li><li class="listitem"><p class="simpara">
										Change the <code class="literal">build</code> target from <code class="literal">generate fmt vet</code> to <code class="literal">manifests generate fmt vet</code>:
									</p><pre class="programlisting language-diff">    - build: generate fmt vet ## Build manager binary.
    + build: manifests generate fmt vet ## Build manager binary.</pre></li></ol></div></li></ol></div></section><section class="section _additional-resources" id="additional-resources_osdk-upgrading-projects-golang"><div class="titlepage"><div><div><h4 class="title">5.3.4.2. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-pkgman-to-bundle">Migrating package manifest projects to bundle format</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.10/html-single/operators/index#osdk-upgrading-v1101-to-v1160_osdk-upgrading-projects">Upgrading projects for Operator SDK 1.16.0</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.9/html/operators/developing-operators#osdk-upgrading-v180-to-v1101_osdk-upgrading-projects">Upgrading projects for Operator SDK v1.10.1</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.8/html/operators/developing-operators#osdk-upgrading-v130-to-v180_osdk-upgrading-projects">Upgrading projects for Operator SDK v1.8.0</a>
							</li></ul></div></section></section></section><section class="section" id="ansible-based-operators"><div class="titlepage"><div><div><h2 class="title">5.4. Ansible-based Operators</h2></div></div></div><section class="section" id="osdk-ansible-quickstart"><div class="titlepage"><div><div><h3 class="title">5.4.1. Getting started with Operator SDK for Ansible-based Operators</h3></div></div></div><p>
					The Operator SDK includes options for generating an Operator project that leverages existing Ansible playbooks and modules to deploy Kubernetes resources as a unified application, without having to write any Go code.
				</p><p>
					To demonstrate the basics of setting up and running an <a class="link" href="https://docs.ansible.com/ansible/latest/index.html">Ansible</a>-based Operator using tools and libraries provided by the Operator SDK, Operator developers can build an example Ansible-based Operator for Memcached, a distributed key-value store, and deploy it to a cluster.
				</p><section class="section" id="osdk-common-prereqs_osdk-ansible-quickstart"><div class="titlepage"><div><div><h4 class="title">5.4.1.1. Prerequisites</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Operator SDK CLI installed
							</li><li class="listitem">
								OpenShift CLI (<code class="literal">oc</code>) v4.13+ installed
							</li><li class="listitem">
								<a class="link" href="https://docs.ansible.com/ansible/2.9/index.html">Ansible</a> v2.9.0
							</li><li class="listitem">
								<a class="link" href="https://ansible-runner.readthedocs.io/en/latest/install.html">Ansible Runner</a> v2.0.2+
							</li><li class="listitem">
								<a class="link" href="https://github.com/ansible/ansible-runner-http">Ansible Runner HTTP Event Emitter plugin</a> v1.0.0+
							</li><li class="listitem">
								<a class="link" href="https://www.python.org/downloads/">Python</a> 3.8.6+
							</li><li class="listitem">
								<a class="link" href="https://pypi.org/project/openshift/">OpenShift Python client</a> v0.12.0+
							</li><li class="listitem">
								Logged into an OpenShift Container Platform 4.13 cluster with <code class="literal">oc</code> with an account that has <code class="literal">cluster-admin</code> permissions
							</li><li class="listitem">
								To allow the cluster to pull the image, the repository where you push your image must be set as public, or you must configure an image pull secret
							</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-installing-cli">Installing the Operator SDK CLI</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cli_tools/#getting-started-cli">Getting started with the OpenShift CLI</a>
							</li></ul></div></section><section class="section" id="osdk-quickstart_osdk-ansible-quickstart"><div class="titlepage"><div><div><h4 class="title">5.4.1.2. Creating and deploying Ansible-based Operators</h4></div></div></div><p>
						You can build and deploy a simple Ansible-based Operator for Memcached by using the Operator SDK.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Create a project.</strong></span>
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Create your project directory:
									</p><pre class="programlisting language-terminal">$ mkdir memcached-operator</pre></li><li class="listitem"><p class="simpara">
										Change into the project directory:
									</p><pre class="programlisting language-terminal">$ cd memcached-operator</pre></li><li class="listitem"><p class="simpara">
										Run the <code class="literal">operator-sdk init</code> command with the <code class="literal">ansible</code> plugin to initialize the project:
									</p><pre class="programlisting language-terminal">$ operator-sdk init \
    --plugins=ansible \
    --domain=example.com</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Create an API.</strong></span>
							</p><p class="simpara">
								Create a simple Memcached API:
							</p><pre class="programlisting language-terminal">$ operator-sdk create api \
    --group cache \
    --version v1 \
    --kind Memcached \
    --generate-role <span id="CO51-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO51-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Generates an Ansible role for the API.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Build and push the Operator image.</strong></span>
							</p><p class="simpara">
								Use the default <code class="literal">Makefile</code> targets to build and push your Operator. Set <code class="literal">IMG</code> with a pull spec for your image that uses a registry you can push to:
							</p><pre class="programlisting language-terminal">$ make docker-build docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Run the Operator.</strong></span>
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Install the CRD:
									</p><pre class="programlisting language-terminal">$ make install</pre></li><li class="listitem"><p class="simpara">
										Deploy the project to the cluster. Set <code class="literal">IMG</code> to the image that you pushed:
									</p><pre class="programlisting language-terminal">$ make deploy IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Create a sample custom resource (CR).</strong></span>
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Create a sample CR:
									</p><pre class="programlisting language-terminal">$ oc apply -f config/samples/cache_v1_memcached.yaml \
    -n memcached-operator-system</pre></li><li class="listitem"><p class="simpara">
										Watch for the CR to reconcile the Operator:
									</p><pre class="programlisting language-terminal">$ oc logs deployment.apps/memcached-operator-controller-manager \
    -c manager \
    -n memcached-operator-system</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-terminal">...
I0205 17:48:45.881666       7 leaderelection.go:253] successfully acquired lease memcached-operator-system/memcached-operator
{"level":"info","ts":1612547325.8819902,"logger":"controller-runtime.manager.controller.memcached-controller","msg":"Starting EventSource","source":"kind source: cache.example.com/v1, Kind=Memcached"}
{"level":"info","ts":1612547325.98242,"logger":"controller-runtime.manager.controller.memcached-controller","msg":"Starting Controller"}
{"level":"info","ts":1612547325.9824686,"logger":"controller-runtime.manager.controller.memcached-controller","msg":"Starting workers","worker count":4}
{"level":"info","ts":1612547348.8311093,"logger":"runner","msg":"Ansible-runner exited successfully","job":"4037200794235010051","name":"memcached-sample","namespace":"memcached-operator-system"}</pre>

										</p></div></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Delete a CR.</strong></span>
							</p><p class="simpara">
								Delete a CR by running the following command:
							</p><pre class="programlisting language-terminal">$ oc delete -f config/samples/cache_v1_memcached -n memcached-operator-system</pre></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Clean up.</strong></span>
							</p><p class="simpara">
								Run the following command to clean up the resources that have been created as part of this procedure:
							</p><pre class="programlisting language-terminal">$ make undeploy</pre></li></ol></div></section><section class="section" id="osdk-ansible-quickstart-next-steps"><div class="titlepage"><div><div><h4 class="title">5.4.1.3. Next steps</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-ansible-tutorial">Operator SDK tutorial for Ansible-based Operators</a> for a more in-depth walkthrough on building an Ansible-based Operator.
							</li></ul></div></section></section><section class="section" id="osdk-ansible-tutorial"><div class="titlepage"><div><div><h3 class="title">5.4.2. Operator SDK tutorial for Ansible-based Operators</h3></div></div></div><p>
					Operator developers can take advantage of <a class="link" href="https://docs.ansible.com/ansible/latest/index.html">Ansible</a> support in the Operator SDK to build an example Ansible-based Operator for Memcached, a distributed key-value store, and manage its lifecycle. This tutorial walks through the following process:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Create a Memcached deployment
						</li><li class="listitem">
							Ensure that the deployment size is the same as specified by the <code class="literal">Memcached</code> custom resource (CR) spec
						</li><li class="listitem">
							Update the <code class="literal">Memcached</code> CR status using the status writer with the names of the <code class="literal">memcached</code> pods
						</li></ul></div><p>
					This process is accomplished by using two centerpieces of the Operator Framework:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Operator SDK</span></dt><dd>
								The <code class="literal">operator-sdk</code> CLI tool and <code class="literal">controller-runtime</code> library API
							</dd><dt><span class="term">Operator Lifecycle Manager (OLM)</span></dt><dd>
								Installation, upgrade, and role-based access control (RBAC) of Operators on a cluster
							</dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						This tutorial goes into greater detail than <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-ansible-quickstart">Getting started with Operator SDK for Ansible-based Operators</a>.
					</p></div></div><section class="section" id="osdk-common-prereqs_osdk-ansible-tutorial"><div class="titlepage"><div><div><h4 class="title">5.4.2.1. Prerequisites</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Operator SDK CLI installed
							</li><li class="listitem">
								OpenShift CLI (<code class="literal">oc</code>) v4.13+ installed
							</li><li class="listitem">
								<a class="link" href="https://docs.ansible.com/ansible/2.9/index.html">Ansible</a> v2.9.0
							</li><li class="listitem">
								<a class="link" href="https://ansible-runner.readthedocs.io/en/latest/install.html">Ansible Runner</a> v2.0.2+
							</li><li class="listitem">
								<a class="link" href="https://github.com/ansible/ansible-runner-http">Ansible Runner HTTP Event Emitter plugin</a> v1.0.0+
							</li><li class="listitem">
								<a class="link" href="https://www.python.org/downloads/">Python</a> 3.8.6+
							</li><li class="listitem">
								<a class="link" href="https://pypi.org/project/openshift/">OpenShift Python client</a> v0.12.0+
							</li><li class="listitem">
								Logged into an OpenShift Container Platform 4.13 cluster with <code class="literal">oc</code> with an account that has <code class="literal">cluster-admin</code> permissions
							</li><li class="listitem">
								To allow the cluster to pull the image, the repository where you push your image must be set as public, or you must configure an image pull secret
							</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-installing-cli">Installing the Operator SDK CLI</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cli_tools/#getting-started-cli">Getting started with the OpenShift CLI</a>
							</li></ul></div></section><section class="section" id="osdk-create-project_osdk-ansible-tutorial"><div class="titlepage"><div><div><h4 class="title">5.4.2.2. Creating a project</h4></div></div></div><p>
						Use the Operator SDK CLI to create a project called <code class="literal">memcached-operator</code>.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a directory for the project:
							</p><pre class="programlisting language-terminal">$ mkdir -p $HOME/projects/memcached-operator</pre></li><li class="listitem"><p class="simpara">
								Change to the directory:
							</p><pre class="programlisting language-terminal">$ cd $HOME/projects/memcached-operator</pre></li><li class="listitem"><p class="simpara">
								Run the <code class="literal">operator-sdk init</code> command with the <code class="literal">ansible</code> plugin to initialize the project:
							</p><pre class="programlisting language-terminal">$ operator-sdk init \
    --plugins=ansible \
    --domain=example.com</pre></li></ol></div><section class="section" id="osdk-project-file_osdk-ansible-tutorial"><div class="titlepage"><div><div><h5 class="title">5.4.2.2.1. PROJECT file</h5></div></div></div><p>
							Among the files generated by the <code class="literal">operator-sdk init</code> command is a Kubebuilder <code class="literal">PROJECT</code> file. Subsequent <code class="literal">operator-sdk</code> commands, as well as <code class="literal">help</code> output, that are run from the project root read this file and are aware that the project type is Ansible. For example:
						</p><pre class="programlisting language-yaml">domain: example.com
layout:
- ansible.sdk.operatorframework.io/v1
plugins:
  manifests.sdk.operatorframework.io/v2: {}
  scorecard.sdk.operatorframework.io/v2: {}
  sdk.x-openshift.io/v1: {}
projectName: memcached-operator
version: "3"</pre></section></section><section class="section" id="osdk-ansible-create-api-controller_osdk-ansible-tutorial"><div class="titlepage"><div><div><h4 class="title">5.4.2.3. Creating an API</h4></div></div></div><p>
						Use the Operator SDK CLI to create a Memcached API.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Run the following command to create an API with group <code class="literal">cache</code>, version, <code class="literal">v1</code>, and kind <code class="literal">Memcached</code>:
							</p><pre class="programlisting language-terminal">$ operator-sdk create api \
    --group cache \
    --version v1 \
    --kind Memcached \
    --generate-role <span id="CO52-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO52-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Generates an Ansible role for the API.
									</div></dd></dl></div></li></ul></div><p>
						After creating the API, your Operator project updates with the following structure:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Memcached CRD</span></dt><dd>
									Includes a sample <code class="literal">Memcached</code> resource
								</dd><dt><span class="term">Manager</span></dt><dd><p class="simpara">
									Program that reconciles the state of the cluster to the desired state by using:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											A reconciler, either an Ansible role or playbook
										</li><li class="listitem">
											A <code class="literal">watches.yaml</code> file, which connects the <code class="literal">Memcached</code> resource to the <code class="literal">memcached</code> Ansible role
										</li></ul></div></dd></dl></div></section><section class="section" id="osdk-ansible-modify-manager_osdk-ansible-tutorial"><div class="titlepage"><div><div><h4 class="title">5.4.2.4. Modifying the manager</h4></div></div></div><p>
						Update your Operator project to provide the reconcile logic, in the form of an Ansible role, which runs every time a <code class="literal">Memcached</code> resource is created, updated, or deleted.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Update the <code class="literal">roles/memcached/tasks/main.yml</code> file with the following structure:
							</p><pre class="programlisting language-yaml">---
- name: start memcached
  k8s:
    definition:
      kind: Deployment
      apiVersion: apps/v1
      metadata:
        name: '{{ ansible_operator_meta.name }}-memcached'
        namespace: '{{ ansible_operator_meta.namespace }}'
      spec:
        replicas: "{{size}}"
        selector:
          matchLabels:
            app: memcached
        template:
          metadata:
            labels:
              app: memcached
          spec:
            containers:
            - name: memcached
              command:
              - memcached
              - -m=64
              - -o
              - modern
              - -v
              image: "docker.io/memcached:1.4.36-alpine"
              ports:
                - containerPort: 11211</pre><p class="simpara">
								This <code class="literal">memcached</code> role ensures a <code class="literal">memcached</code> deployment exist and sets the deployment size.
							</p></li><li class="listitem"><p class="simpara">
								Set default values for variables used in your Ansible role by editing the <code class="literal">roles/memcached/defaults/main.yml</code> file:
							</p><pre class="programlisting language-yaml">---
# defaults file for Memcached
size: 1</pre></li><li class="listitem"><p class="simpara">
								Update the <code class="literal">Memcached</code> sample resource in the <code class="literal">config/samples/cache_v1_memcached.yaml</code> file with the following structure:
							</p><pre class="programlisting language-yaml">apiVersion: cache.example.com/v1
kind: Memcached
metadata:
  labels:
    app.kubernetes.io/name: memcached
    app.kubernetes.io/instance: memcached-sample
    app.kubernetes.io/part-of: memcached-operator
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/created-by: memcached-operator
  name: memcached-sample
spec:
  size: 3</pre><p class="simpara">
								The key-value pairs in the custom resource (CR) spec are passed to Ansible as extra variables.
							</p></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The names of all variables in the <code class="literal">spec</code> field are converted to snake case, meaning lowercase with an underscore, by the Operator before running Ansible. For example, <code class="literal">serviceAccount</code> in the spec becomes <code class="literal">service_account</code> in Ansible.
						</p><p>
							You can disable this case conversion by setting the <code class="literal">snakeCaseParameters</code> option to <code class="literal">false</code> in your <code class="literal">watches.yaml</code> file. It is recommended that you perform some type validation in Ansible on the variables to ensure that your application is receiving expected input.
						</p></div></div></section><section class="section" id="osdk-run-proxy_osdk-ansible-tutorial"><div class="titlepage"><div><div><h4 class="title">5.4.2.5. Enabling proxy support</h4></div></div></div><p>
						Operator authors can develop Operators that support network proxies. Cluster administrators configure proxy support for the environment variables that are handled by Operator Lifecycle Manager (OLM). To support proxied clusters, your Operator must inspect the environment for the following standard proxy variables and pass the values to Operands:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">HTTP_PROXY</code>
							</li><li class="listitem">
								<code class="literal">HTTPS_PROXY</code>
							</li><li class="listitem">
								<code class="literal">NO_PROXY</code>
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							This tutorial uses <code class="literal">HTTP_PROXY</code> as an example environment variable.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								A cluster with cluster-wide egress proxy enabled.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Add the environment variables to the deployment by updating the <code class="literal">roles/memcached/tasks/main.yml</code> file with the following:
							</p><pre class="programlisting language-yaml">...
env:
   - name: HTTP_PROXY
     value: '{{ lookup("env", "HTTP_PROXY") | default("", True) }}'
   - name: http_proxy
     value: '{{ lookup("env", "HTTP_PROXY") | default("", True) }}'
...</pre></li><li class="listitem"><p class="simpara">
								Set the environment variable on the Operator deployment by adding the following to the <code class="literal">config/manager/manager.yaml</code> file:
							</p><pre class="programlisting language-yaml">containers:
 - args:
   - --leader-elect
   - --leader-election-id=ansible-proxy-demo
   image: controller:latest
   name: manager
   env:
     - name: "HTTP_PROXY"
       value: "http_proxy_test"</pre></li></ol></div></section><section class="section" id="osdk-run-operator_osdk-ansible-tutorial"><div class="titlepage"><div><div><h4 class="title">5.4.2.6. Running the Operator</h4></div></div></div><p>
						There are three ways you can use the Operator SDK CLI to build and run your Operator:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Run locally outside the cluster as a Go program.
							</li><li class="listitem">
								Run as a deployment on the cluster.
							</li><li class="listitem">
								Bundle your Operator and use Operator Lifecycle Manager (OLM) to deploy on the cluster.
							</li></ul></div><section class="section" id="osdk-run-locally_osdk-ansible-tutorial"><div class="titlepage"><div><div><h5 class="title">5.4.2.6.1. Running locally outside the cluster</h5></div></div></div><p>
							You can run your Operator project as a Go program outside of the cluster. This is useful for development purposes to speed up deployment and testing.
						</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Run the following command to install the custom resource definitions (CRDs) in the cluster configured in your <code class="literal">~/.kube/config</code> file and run the Operator locally:
								</p><pre class="programlisting language-terminal">$ make install run</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">...
{"level":"info","ts":1612589622.7888272,"logger":"ansible-controller","msg":"Watching resource","Options.Group":"cache.example.com","Options.Version":"v1","Options.Kind":"Memcached"}
{"level":"info","ts":1612589622.7897573,"logger":"proxy","msg":"Starting to serve","Address":"127.0.0.1:8888"}
{"level":"info","ts":1612589622.789971,"logger":"controller-runtime.manager","msg":"starting metrics server","path":"/metrics"}
{"level":"info","ts":1612589622.7899997,"logger":"controller-runtime.manager.controller.memcached-controller","msg":"Starting EventSource","source":"kind source: cache.example.com/v1, Kind=Memcached"}
{"level":"info","ts":1612589622.8904517,"logger":"controller-runtime.manager.controller.memcached-controller","msg":"Starting Controller"}
{"level":"info","ts":1612589622.8905244,"logger":"controller-runtime.manager.controller.memcached-controller","msg":"Starting workers","worker count":8}</pre>

									</p></div></li></ul></div></section><section class="section" id="osdk-run-deployment_osdk-ansible-tutorial"><div class="titlepage"><div><div><h5 class="title">5.4.2.6.2. Running as a deployment on the cluster</h5></div></div></div><p>
							You can run your Operator project as a deployment on your cluster.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Run the following <code class="literal">make</code> commands to build and push the Operator image. Modify the <code class="literal">IMG</code> argument in the following steps to reference a repository that you have access to. You can obtain an account for storing containers at repository sites such as Quay.io.
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Build the image:
										</p><pre class="programlisting language-terminal">$ make docker-build IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												The Dockerfile generated by the SDK for the Operator explicitly references <code class="literal">GOARCH=amd64</code> for <code class="literal">go build</code>. This can be amended to <code class="literal">GOARCH=$TARGETARCH</code> for non-AMD64 architectures. Docker will automatically set the environment variable to the value specified by <code class="literal">–platform</code>. With Buildah, the <code class="literal">–build-arg</code> will need to be used for the purpose. For more information, see <a class="link" href="https://sdk.operatorframework.io/docs/advanced-topics/multi-arch/#supporting-multiple-architectures">Multiple Architectures</a>.
											</p></div></div></li><li class="listitem"><p class="simpara">
											Push the image to a repository:
										</p><pre class="programlisting language-terminal">$ make docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												The name and tag of the image, for example <code class="literal">IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</code>, in both the commands can also be set in your Makefile. Modify the <code class="literal">IMG ?= controller:latest</code> value to set your default image name.
											</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
									Run the following command to deploy the Operator:
								</p><pre class="programlisting language-terminal">$ make deploy IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><p class="simpara">
									By default, this command creates a namespace with the name of your Operator project in the form <code class="literal">&lt;project_name&gt;-system</code> and is used for the deployment. This command also installs the RBAC manifests from <code class="literal">config/rbac</code>.
								</p></li><li class="listitem"><p class="simpara">
									Run the following command to verify that the Operator is running:
								</p><pre class="programlisting language-terminal">$ oc get deployment -n &lt;project_name&gt;-system</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME                                    READY   UP-TO-DATE   AVAILABLE   AGE
&lt;project_name&gt;-controller-manager       1/1     1            1           8m</pre>

									</p></div></li></ol></div></section><section class="section" id="osdk-bundle-deploy-olm_osdk-ansible-tutorial"><div class="titlepage"><div><div><h5 class="title">5.4.2.6.3. Bundling an Operator and deploying with Operator Lifecycle Manager</h5></div></div></div><section class="section" id="osdk-bundle-operator_osdk-ansible-tutorial"><div class="titlepage"><div><div><h6 class="title">5.4.2.6.3.1. Bundling an Operator</h6></div></div></div><p>
								The Operator bundle format is the default packaging method for Operator SDK and Operator Lifecycle Manager (OLM). You can get your Operator ready for use on OLM by using the Operator SDK to build and push your Operator project as a bundle image.
							</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
										Operator SDK CLI installed on a development workstation
									</li><li class="listitem">
										OpenShift CLI (<code class="literal">oc</code>) v4.13+ installed
									</li><li class="listitem">
										Operator project initialized by using the Operator SDK
									</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
										Run the following <code class="literal">make</code> commands in your Operator project directory to build and push your Operator image. Modify the <code class="literal">IMG</code> argument in the following steps to reference a repository that you have access to. You can obtain an account for storing containers at repository sites such as Quay.io.
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
												Build the image:
											</p><pre class="programlisting language-terminal">$ make docker-build IMG=&lt;registry&gt;/&lt;user&gt;/&lt;operator_image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
													The Dockerfile generated by the SDK for the Operator explicitly references <code class="literal">GOARCH=amd64</code> for <code class="literal">go build</code>. This can be amended to <code class="literal">GOARCH=$TARGETARCH</code> for non-AMD64 architectures. Docker will automatically set the environment variable to the value specified by <code class="literal">–platform</code>. With Buildah, the <code class="literal">–build-arg</code> will need to be used for the purpose. For more information, see <a class="link" href="https://sdk.operatorframework.io/docs/advanced-topics/multi-arch/#supporting-multiple-architectures">Multiple Architectures</a>.
												</p></div></div></li><li class="listitem"><p class="simpara">
												Push the image to a repository:
											</p><pre class="programlisting language-terminal">$ make docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;operator_image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li><li class="listitem"><p class="simpara">
										Create your Operator bundle manifest by running the <code class="literal">make bundle</code> command, which invokes several commands, including the Operator SDK <code class="literal">generate bundle</code> and <code class="literal">bundle validate</code> subcommands:
									</p><pre class="programlisting language-terminal">$ make bundle IMG=&lt;registry&gt;/&lt;user&gt;/&lt;operator_image_name&gt;:&lt;tag&gt;</pre><p class="simpara">
										Bundle manifests for an Operator describe how to display, create, and manage an application. The <code class="literal">make bundle</code> command creates the following files and directories in your Operator project:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												A bundle manifests directory named <code class="literal">bundle/manifests</code> that contains a <code class="literal">ClusterServiceVersion</code> object
											</li><li class="listitem">
												A bundle metadata directory named <code class="literal">bundle/metadata</code>
											</li><li class="listitem">
												All custom resource definitions (CRDs) in a <code class="literal">config/crd</code> directory
											</li><li class="listitem">
												A Dockerfile <code class="literal">bundle.Dockerfile</code>
											</li></ul></div><p class="simpara">
										These files are then automatically validated by using <code class="literal">operator-sdk bundle validate</code> to ensure the on-disk bundle representation is correct.
									</p></li><li class="listitem"><p class="simpara">
										Build and push your bundle image by running the following commands. OLM consumes Operator bundles using an index image, which reference one or more bundle images.
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
												Build the bundle image. Set <code class="literal">BUNDLE_IMG</code> with the details for the registry, user namespace, and image tag where you intend to push the image:
											</p><pre class="programlisting language-terminal">$ make bundle-build BUNDLE_IMG=&lt;registry&gt;/&lt;user&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt;</pre></li><li class="listitem"><p class="simpara">
												Push the bundle image:
											</p><pre class="programlisting language-terminal">$ docker push &lt;registry&gt;/&lt;user&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li></ol></div></section><section class="section" id="osdk-deploy-olm_osdk-ansible-tutorial"><div class="titlepage"><div><div><h6 class="title">5.4.2.6.3.2. Deploying an Operator with Operator Lifecycle Manager</h6></div></div></div><p>
								Operator Lifecycle Manager (OLM) helps you to install, update, and manage the lifecycle of Operators and their associated services on a Kubernetes cluster. OLM is installed by default on OpenShift Container Platform and runs as a Kubernetes extension so that you can use the web console and the OpenShift CLI (<code class="literal">oc</code>) for all Operator lifecycle management functions without any additional tools.
							</p><p>
								The Operator bundle format is the default packaging method for Operator SDK and OLM. You can use the Operator SDK to quickly run a bundle image on OLM to ensure that it runs properly.
							</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
										Operator SDK CLI installed on a development workstation
									</li><li class="listitem">
										Operator bundle image built and pushed to a registry
									</li><li class="listitem">
										OLM installed on a Kubernetes-based cluster (v1.16.0 or later if you use <code class="literal">apiextensions.k8s.io/v1</code> CRDs, for example OpenShift Container Platform 4.13)
									</li><li class="listitem">
										Logged in to the cluster with <code class="literal">oc</code> using an account with <code class="literal">cluster-admin</code> permissions
									</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Enter the following command to run the Operator on the cluster:
									</p><pre class="programlisting language-terminal">$ operator-sdk run bundle \<span id="CO53-1"><!--Empty--></span><span class="callout">1</span>
    -n &lt;namespace&gt; \<span id="CO53-2"><!--Empty--></span><span class="callout">2</span>
    &lt;registry&gt;/&lt;user&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt; <span id="CO53-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO53-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												The <code class="literal">run bundle</code> command creates a valid file-based catalog and installs the Operator bundle on your cluster using OLM.
											</div></dd><dt><a href="#CO53-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												Optional: By default, the command installs the Operator in the currently active project in your <code class="literal">~/.kube/config</code> file. You can add the <code class="literal">-n</code> flag to set a different namespace scope for the installation.
											</div></dd><dt><a href="#CO53-3"><span class="callout">3</span></a> </dt><dd><div class="para">
												If you do not specify an image, the command uses <code class="literal">quay.io/operator-framework/opm:latest</code> as the default index image. If you specify an image, the command uses the bundle image itself as the index image.
											</div></dd></dl></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
											As of OpenShift Container Platform 4.11, the <code class="literal">run bundle</code> command supports the file-based catalog format for Operator catalogs by default. The deprecated SQLite database format for Operator catalogs continues to be supported; however, it will be removed in a future release. It is recommended that Operator authors migrate their workflows to the file-based catalog format.
										</p></div></div><p class="simpara">
										This command performs the following actions:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												Create an index image referencing your bundle image. The index image is opaque and ephemeral, but accurately reflects how a bundle would be added to a catalog in production.
											</li><li class="listitem">
												Create a catalog source that points to your new index image, which enables OperatorHub to discover your Operator.
											</li><li class="listitem">
												Deploy your Operator to your cluster by creating an <code class="literal">OperatorGroup</code>, <code class="literal">Subscription</code>, <code class="literal">InstallPlan</code>, and all other required resources, including RBAC.
											</li></ul></div></li></ul></div></section></section></section><section class="section" id="osdk-create-cr_osdk-ansible-tutorial"><div class="titlepage"><div><div><h4 class="title">5.4.2.7. Creating a custom resource</h4></div></div></div><p>
						After your Operator is installed, you can test it by creating a custom resource (CR) that is now provided on the cluster by the Operator.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Example Memcached Operator, which provides the <code class="literal">Memcached</code> CR, installed on a cluster
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Change to the namespace where your Operator is installed. For example, if you deployed the Operator using the <code class="literal">make deploy</code> command:
							</p><pre class="programlisting language-terminal">$ oc project memcached-operator-system</pre></li><li class="listitem"><p class="simpara">
								Edit the sample <code class="literal">Memcached</code> CR manifest at <code class="literal">config/samples/cache_v1_memcached.yaml</code> to contain the following specification:
							</p><pre class="programlisting language-yaml">apiVersion: cache.example.com/v1
kind: Memcached
metadata:
  name: memcached-sample
...
spec:
...
  size: 3</pre></li><li class="listitem"><p class="simpara">
								Create the CR:
							</p><pre class="programlisting language-terminal">$ oc apply -f config/samples/cache_v1_memcached.yaml</pre></li><li class="listitem"><p class="simpara">
								Ensure that the <code class="literal">Memcached</code> Operator creates the deployment for the sample CR with the correct size:
							</p><pre class="programlisting language-terminal">$ oc get deployments</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                    READY   UP-TO-DATE   AVAILABLE   AGE
memcached-operator-controller-manager   1/1     1            1           8m
memcached-sample                        3/3     3            3           1m</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Check the pods and CR status to confirm the status is updated with the Memcached pod names.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Check the pods:
									</p><pre class="programlisting language-terminal">$ oc get pods</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-terminal">NAME                                  READY     STATUS    RESTARTS   AGE
memcached-sample-6fd7c98d8-7dqdr      1/1       Running   0          1m
memcached-sample-6fd7c98d8-g5k7v      1/1       Running   0          1m
memcached-sample-6fd7c98d8-m7vn7      1/1       Running   0          1m</pre>

										</p></div></li><li class="listitem"><p class="simpara">
										Check the CR status:
									</p><pre class="programlisting language-terminal">$ oc get memcached/memcached-sample -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-yaml">apiVersion: cache.example.com/v1
kind: Memcached
metadata:
...
  name: memcached-sample
...
spec:
  size: 3
status:
  nodes:
  - memcached-sample-6fd7c98d8-7dqdr
  - memcached-sample-6fd7c98d8-g5k7v
  - memcached-sample-6fd7c98d8-m7vn7</pre>

										</p></div></li></ol></div></li><li class="listitem"><p class="simpara">
								Update the deployment size.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Update <code class="literal">config/samples/cache_v1_memcached.yaml</code> file to change the <code class="literal">spec.size</code> field in the <code class="literal">Memcached</code> CR from <code class="literal">3</code> to <code class="literal">5</code>:
									</p><pre class="programlisting language-terminal">$ oc patch memcached memcached-sample \
    -p '{"spec":{"size": 5}}' \
    --type=merge</pre></li><li class="listitem"><p class="simpara">
										Confirm that the Operator changes the deployment size:
									</p><pre class="programlisting language-terminal">$ oc get deployments</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-terminal">NAME                                    READY   UP-TO-DATE   AVAILABLE   AGE
memcached-operator-controller-manager   1/1     1            1           10m
memcached-sample                        5/5     5            5           3m</pre>

										</p></div></li></ol></div></li><li class="listitem"><p class="simpara">
								Delete the CR by running the following command:
							</p><pre class="programlisting language-terminal">$ oc delete -f config/samples/cache_v1_memcached.yaml</pre></li><li class="listitem"><p class="simpara">
								Clean up the resources that have been created as part of this tutorial.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										If you used the <code class="literal">make deploy</code> command to test the Operator, run the following command:
									</p><pre class="programlisting language-terminal">$ make undeploy</pre></li><li class="listitem"><p class="simpara">
										If you used the <code class="literal">operator-sdk run bundle</code> command to test the Operator, run the following command:
									</p><pre class="programlisting language-terminal">$ operator-sdk cleanup &lt;project_name&gt;</pre></li></ul></div></li></ol></div></section><section class="section _additional-resources" id="osdk-ansible-tutorial-addtl-resources"><div class="titlepage"><div><div><h4 class="title">5.4.2.8. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-ansible-project-layout">Project layout for Ansible-based Operators</a> to learn about the directory structures created by the Operator SDK.
							</li><li class="listitem">
								If a <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#enable-cluster-wide-proxy">cluster-wide egress proxy is configured</a>, cluster administrators can <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-configuring-proxy-support">override the proxy settings or inject a custom CA certificate</a> for specific Operators running on Operator Lifecycle Manager (OLM).
							</li></ul></div></section></section><section class="section" id="osdk-ansible-project-layout"><div class="titlepage"><div><div><h3 class="title">5.4.3. Project layout for Ansible-based Operators</h3></div></div></div><p>
					The <code class="literal">operator-sdk</code> CLI can generate, or <span class="emphasis"><em>scaffold</em></span>, a number of packages and files for each Operator project.
				</p><section class="section" id="osdk-ansible-project-layout_osdk-ansible-project-layout"><div class="titlepage"><div><div><h4 class="title">5.4.3.1. Ansible-based project layout</h4></div></div></div><p>
						Ansible-based Operator projects generated using the <code class="literal">operator-sdk init --plugins ansible</code> command contain the following directories and files:
					</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 80%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731978454160" scope="col">File or directory</th><th align="left" valign="top" id="idm139731978453072" scope="col">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731978454160"> <p>
										<code class="literal">Dockerfile</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978453072"> <p>
										Dockerfile for building the container image for the Operator.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978454160"> <p>
										<code class="literal">Makefile</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978453072"> <p>
										Targets for building, publishing, deploying the container image that wraps the Operator binary, and targets for installing and uninstalling the custom resource definition (CRD).
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978454160"> <p>
										<code class="literal">PROJECT</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978453072"> <p>
										YAML file containing metadata information for the Operator.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978454160"> <p>
										<code class="literal">config/crd</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978453072"> <p>
										Base CRD files and the <code class="literal">kustomization.yaml</code> file settings.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978454160"> <p>
										<code class="literal">config/default</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978453072"> <p>
										Collects all Operator manifests for deployment. Use by the <code class="literal">make deploy</code> command.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978454160"> <p>
										<code class="literal">config/manager</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978453072"> <p>
										Controller manager deployment.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978454160"> <p>
										<code class="literal">config/prometheus</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978453072"> <p>
										<code class="literal">ServiceMonitor</code> resource for monitoring the Operator.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978454160"> <p>
										<code class="literal">config/rbac</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978453072"> <p>
										Role and role binding for leader election and authentication proxy.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978454160"> <p>
										<code class="literal">config/samples</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978453072"> <p>
										Sample resources created for the CRDs.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978454160"> <p>
										<code class="literal">config/testing</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978453072"> <p>
										Sample configurations for testing.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978454160"> <p>
										<code class="literal">playbooks/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978453072"> <p>
										A subdirectory for the playbooks to run.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978454160"> <p>
										<code class="literal">roles/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978453072"> <p>
										Subdirectory for the roles tree to run.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978454160"> <p>
										<code class="literal">watches.yaml</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978453072"> <p>
										Group/version/kind (GVK) of the resources to watch, and the Ansible invocation method. New entries are added by using the <code class="literal">create api</code> command.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978454160"> <p>
										<code class="literal">requirements.yml</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978453072"> <p>
										YAML file containing the Ansible collections and role dependencies to install during a build.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978454160"> <p>
										<code class="literal">molecule/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978453072"> <p>
										Molecule scenarios for end-to-end testing of your role and Operator.
									</p>
									 </td></tr></tbody></table></div></section></section><section class="section" id="osdk-ansible-updating-projects"><div class="titlepage"><div><div><h3 class="title">5.4.4. Updating projects for newer Operator SDK versions</h3></div></div></div><p>
					OpenShift Container Platform 4.13 supports Operator SDK 1.28.0. If you already have the 1.25.4 CLI installed on your workstation, you can update the CLI to 1.28.0 by <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-installing-cli">installing the latest version</a>.
				</p><p>
					However, to ensure your existing Operator projects maintain compatibility with Operator SDK 1.28.0, update steps are required for the associated breaking changes introduced since 1.25.4. You must perform the update steps manually in any of your Operator projects that were previously created or maintained with 1.25.4.
				</p><section class="section" id="osdk-upgrading-projects_osdk-ansible-updating-projects"><div class="titlepage"><div><div><h4 class="title">5.4.4.1. Updating Ansible-based Operator projects for Operator SDK 1.28.0</h4></div></div></div><p>
						The following procedure updates an existing Ansible-based Operator project for compatibility with 1.28.0.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Operator SDK 1.28.0 installed
							</li><li class="listitem">
								An Operator project created or maintained with Operator SDK 1.25.4
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Update the image tag in your Operator’s Dockerfile as shown in the following example:
							</p><div class="formalpara"><p class="title"><strong>Example Dockerfile</strong></p><p>
									
<pre class="programlisting language-docker">FROM registry.redhat.io/openshift4/ose-ansible-operator:v4.13 <span id="CO54-1"><!--Empty--></span><span class="callout">1</span></pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO54-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Update the version tag to <code class="literal">v4.13</code>.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Find the <code class="literal">ose-kube-rbac-proxy</code> pull spec in the following files, and update the image tag to <code class="literal">v4.13</code>:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">config/default/manager_auth_proxy_patch.yaml</code>
									</li><li class="listitem">
										<code class="literal">bundle/manifests/memcached-operator.clusterserviceversion.yaml</code>
									</li></ul></div><pre class="programlisting language-yaml">…
      containers:
      - name: kube-rbac-proxy
        image: registry.redhat.io/openshift4/ose-kube-rbac-proxy:v4.13 <span id="CO55-1"><!--Empty--></span><span class="callout">1</span>
…</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO55-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Update the tag version from <code class="literal">v4.12</code> to <code class="literal">v4.13</code>.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Update your Makefile’s <code class="literal">run</code> target to the following:
							</p><pre class="programlisting language-make">.PHONY: run
ANSIBLE_ROLES_PATH?="$(shell pwd)/roles"
run: ansible-operator ## Run against the configured Kubernetes cluster in ~/.kube/config
    $(ANSIBLE_OPERATOR) run</pre></li><li class="listitem"><p class="simpara">
								To upgrade the <code class="literal">kubernetes.core</code> collection to v2.4.0, replace the following in your project’s <code class="literal">requirements.yaml</code> file:
							</p><pre class="programlisting language-yaml">  - name: kubernetes.core
    version: "2.3.1"</pre><p class="simpara">
								with:
							</p><pre class="programlisting language-yaml">  - name: kubernetes.core
    version: "2.4.0"</pre></li></ol></div></section><section class="section _additional-resources" id="additional-resources_osdk-ansible-upgrading-projects"><div class="titlepage"><div><div><h4 class="title">5.4.4.2. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.12/html-single/operators/index#osdk-upgrading-projects_osdk-ansible-updating-projects">Upgrading projects for Operator SDK v1.25.4</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.11/html-single/operators/index#osdk-upgrading-projects_osdk-ansible-updating-projects">Upgrading projects for Operator SDK v1.22.0</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.10/html-single/operators/index#osdk-upgrading-v1101-to-v1160_osdk-upgrading-projects">Upgrading projects for Operator SDK v1.16.0</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.9/html/operators/developing-operators#osdk-upgrading-v180-to-v1101_osdk-upgrading-projects">Upgrading projects for Operator SDK v1.10.1</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.8/html/operators/developing-operators#osdk-upgrading-v130-to-v180_osdk-upgrading-projects">Upgrading projects for Operator SDK v1.8.0</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-pkgman-to-bundle">Migrating package manifest projects to bundle format</a>
							</li></ul></div></section></section><section class="section" id="osdk-ansible-support"><div class="titlepage"><div><div><h3 class="title">5.4.5. Ansible support in Operator SDK</h3></div></div></div><section class="section" id="osdk-ansible-custom-resource-files_osdk-ansible-support"><div class="titlepage"><div><div><h4 class="title">5.4.5.1. Custom resource files</h4></div></div></div><p>
						Operators use the Kubernetes extension mechanism, custom resource definitions (CRDs), so your custom resource (CR) looks and acts just like the built-in, native Kubernetes objects.
					</p><p>
						The CR file format is a Kubernetes resource file. The object has mandatory and optional fields:
					</p><div class="table" id="idm139731978630784"><p class="title"><strong>Table 5.1. Custom resource fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"><!--Empty--></col><col style="width: 70%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731979049824" scope="col">Field</th><th align="left" valign="top" id="idm139731979048736" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731979049824"> <p>
										<code class="literal">apiVersion</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731979048736"> <p>
										Version of the CR to be created.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731979049824"> <p>
										<code class="literal">kind</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731979048736"> <p>
										Kind of the CR to be created.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731979049824"> <p>
										<code class="literal">metadata</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731979048736"> <p>
										Kubernetes-specific metadata to be created.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731979049824"> <p>
										<code class="literal">spec</code> (optional)
									</p>
									 </td><td align="left" valign="top" headers="idm139731979048736"> <p>
										Key-value list of variables which are passed to Ansible. This field is empty by default.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731979049824"> <p>
										<code class="literal">status</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731979048736"> <p>
										Summarizes the current state of the object. For Ansible-based Operators, the <a class="link" href="https://kubernetes.io/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definitions/#status-subresource"><code class="literal">status</code> subresource</a> is enabled for CRDs and managed by the <code class="literal">operator_sdk.util.k8s_status</code> Ansible module by default, which includes <code class="literal">condition</code> information to the CR <code class="literal">status</code>.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731979049824"> <p>
										<code class="literal">annotations</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731979048736"> <p>
										Kubernetes-specific annotations to be appended to the CR.
									</p>
									 </td></tr></tbody></table></div></div><p>
						The following list of CR annotations modify the behavior of the Operator:
					</p><div class="table" id="idm139731978725664"><p class="title"><strong>Table 5.2. Ansible-based Operator annotations</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"><!--Empty--></col><col style="width: 70%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731978720816" scope="col">Annotation</th><th align="left" valign="top" id="idm139731978719728" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731978720816"> <p>
										<code class="literal">ansible.operator-sdk/reconcile-period</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978719728"> <p>
										Specifies the reconciliation interval for the CR. This value is parsed using the standard Golang package <a class="link" href="https://golang.org/pkg/time/"><code class="literal">time</code></a>. Specifically, <a class="link" href="https://golang.org/pkg/time/#ParseDuration"><code class="literal">ParseDuration</code></a> is used which applies the default suffix of <code class="literal">s</code>, giving the value in seconds.
									</p>
									 </td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example Ansible-based Operator annotation</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: "test1.example.com/v1alpha1"
kind: "Test1"
metadata:
  name: "example"
annotations:
  ansible.operator-sdk/reconcile-period: "30s"</pre>

						</p></div></section><section class="section" id="osdk-ansible-watches-file_osdk-ansible-support"><div class="titlepage"><div><div><h4 class="title">5.4.5.2. watches.yaml file</h4></div></div></div><p>
						A <span class="emphasis"><em>group/version/kind (GVK)</em></span> is a unique identifier for a Kubernetes API. The <code class="literal">watches.yaml</code> file contains a list of mappings from custom resources (CRs), identified by its GVK, to an Ansible role or playbook. The Operator expects this mapping file in a predefined location at <code class="literal">/opt/ansible/watches.yaml</code>.
					</p><div class="table" id="idm139731978704432"><p class="title"><strong>Table 5.3. <code class="literal">watches.yaml</code> file mappings</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"><!--Empty--></col><col style="width: 70%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731977960992" scope="col">Field</th><th align="left" valign="top" id="idm139731977959904" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731977960992"> <p>
										<code class="literal">group</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977959904"> <p>
										Group of CR to watch.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977960992"> <p>
										<code class="literal">version</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977959904"> <p>
										Version of CR to watch.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977960992"> <p>
										<code class="literal">kind</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977959904"> <p>
										Kind of CR to watch
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977960992"> <p>
										<code class="literal">role</code> (default)
									</p>
									 </td><td align="left" valign="top" headers="idm139731977959904"> <p>
										Path to the Ansible role added to the container. For example, if your <code class="literal">roles</code> directory is at <code class="literal">/opt/ansible/roles/</code> and your role is named <code class="literal">busybox</code>, this value would be <code class="literal">/opt/ansible/roles/busybox</code>. This field is mutually exclusive with the <code class="literal">playbook</code> field.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977960992"> <p>
										<code class="literal">playbook</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977959904"> <p>
										Path to the Ansible playbook added to the container. This playbook is expected to be a way to call roles. This field is mutually exclusive with the <code class="literal">role</code> field.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977960992"> <p>
										<code class="literal">reconcilePeriod</code> (optional)
									</p>
									 </td><td align="left" valign="top" headers="idm139731977959904"> <p>
										The reconciliation interval, how often the role or playbook is run, for a given CR.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977960992"> <p>
										<code class="literal">manageStatus</code> (optional)
									</p>
									 </td><td align="left" valign="top" headers="idm139731977959904"> <p>
										When set to <code class="literal">true</code> (default), the Operator manages the status of the CR generically. When set to <code class="literal">false</code>, the status of the CR is managed elsewhere, by the specified role or playbook or in a separate controller.
									</p>
									 </td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example <code class="literal">watches.yaml</code> file</strong></p><p>
							
<pre class="programlisting language-yaml">- version: v1alpha1 <span id="CO56-1"><!--Empty--></span><span class="callout">1</span>
  group: test1.example.com
  kind: Test1
  role: /opt/ansible/roles/Test1

- version: v1alpha1 <span id="CO56-2"><!--Empty--></span><span class="callout">2</span>
  group: test2.example.com
  kind: Test2
  playbook: /opt/ansible/playbook.yml

- version: v1alpha1 <span id="CO56-3"><!--Empty--></span><span class="callout">3</span>
  group: test3.example.com
  kind: Test3
  playbook: /opt/ansible/test3.yml
  reconcilePeriod: 0
  manageStatus: false</pre>

						</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO56-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Simple example mapping <code class="literal">Test1</code> to the <code class="literal">test1</code> role.
							</div></dd><dt><a href="#CO56-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Simple example mapping <code class="literal">Test2</code> to a playbook.
							</div></dd><dt><a href="#CO56-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								More complex example for the <code class="literal">Test3</code> kind. Disables re-queuing and managing the CR status in the playbook.
							</div></dd></dl></div><section class="section" id="osdk-ansible-watches-file-advanced_osdk-ansible-support"><div class="titlepage"><div><div><h5 class="title">5.4.5.2.1. Advanced options</h5></div></div></div><p>
							Advanced features can be enabled by adding them to your <code class="literal">watches.yaml</code> file per GVK. They can go below the <code class="literal">group</code>, <code class="literal">version</code>, <code class="literal">kind</code> and <code class="literal">playbook</code> or <code class="literal">role</code> fields.
						</p><p>
							Some features can be overridden per resource using an annotation on that CR. The options that can be overridden have the annotation specified below.
						</p><div class="table" id="idm139731979790720"><p class="title"><strong>Table 5.4. Advanced watches.yaml file options</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 17%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col><col style="width: 17%; " class="col_4"><!--Empty--></col><col style="width: 8%; " class="col_5"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731977162752" scope="col">Feature</th><th align="left" valign="top" id="idm139731977161664" scope="col">YAML key</th><th align="left" valign="top" id="idm139731977160576" scope="col">Description</th><th align="left" valign="top" id="idm139731977159488" scope="col">Annotation for override</th><th align="left" valign="top" id="idm139731977158400" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731977162752"> <p>
											Reconcile period
										</p>
										 </td><td align="left" valign="top" headers="idm139731977161664"> <p>
											<code class="literal">reconcilePeriod</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731977160576"> <p>
											Time between reconcile runs for a particular CR.
										</p>
										 </td><td align="left" valign="top" headers="idm139731977159488"> <p>
											<code class="literal">ansible.operator-sdk/reconcile-period</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731977158400"> <p>
											<code class="literal">1m</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139731977162752"> <p>
											Manage status
										</p>
										 </td><td align="left" valign="top" headers="idm139731977161664"> <p>
											<code class="literal">manageStatus</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731977160576"> <p>
											Allows the Operator to manage the <code class="literal">conditions</code> section of each CR <code class="literal">status</code> section.
										</p>
										 </td><td align="left" valign="top" headers="idm139731977159488"> </td><td align="left" valign="top" headers="idm139731977158400"> <p>
											<code class="literal">true</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139731977162752"> <p>
											Watch dependent resources
										</p>
										 </td><td align="left" valign="top" headers="idm139731977161664"> <p>
											<code class="literal">watchDependentResources</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731977160576"> <p>
											Allows the Operator to dynamically watch resources that are created by Ansible.
										</p>
										 </td><td align="left" valign="top" headers="idm139731977159488"> </td><td align="left" valign="top" headers="idm139731977158400"> <p>
											<code class="literal">true</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139731977162752"> <p>
											Watch cluster-scoped resources
										</p>
										 </td><td align="left" valign="top" headers="idm139731977161664"> <p>
											<code class="literal">watchClusterScopedResources</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731977160576"> <p>
											Allows the Operator to watch cluster-scoped resources that are created by Ansible.
										</p>
										 </td><td align="left" valign="top" headers="idm139731977159488"> </td><td align="left" valign="top" headers="idm139731977158400"> <p>
											<code class="literal">false</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139731977162752"> <p>
											Max runner artifacts
										</p>
										 </td><td align="left" valign="top" headers="idm139731977161664"> <p>
											<code class="literal">maxRunnerArtifacts</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731977160576"> <p>
											Manages the number of <a class="link" href="https://ansible-runner.readthedocs.io/en/latest/intro.html#runner-artifacts-directory-hierarchy">artifact directories</a> that Ansible Runner keeps in the Operator container for each individual resource.
										</p>
										 </td><td align="left" valign="top" headers="idm139731977159488"> <p>
											<code class="literal">ansible.operator-sdk/max-runner-artifacts</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731977158400"> <p>
											<code class="literal">20</code>
										</p>
										 </td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example watches.yml file with advanced options</strong></p><p>
								
<pre class="programlisting language-yaml">- version: v1alpha1
  group: app.example.com
  kind: AppService
  playbook: /opt/ansible/playbook.yml
  maxRunnerArtifacts: 30
  reconcilePeriod: 5s
  manageStatus: False
  watchDependentResources: False</pre>

							</p></div></section></section><section class="section" id="osdk-ansible-extra-variables_osdk-ansible-support"><div class="titlepage"><div><div><h4 class="title">5.4.5.3. Extra variables sent to Ansible</h4></div></div></div><p>
						Extra variables can be sent to Ansible, which are then managed by the Operator. The <code class="literal">spec</code> section of the custom resource (CR) passes along the key-value pairs as extra variables. This is equivalent to extra variables passed in to the <code class="literal">ansible-playbook</code> command.
					</p><p>
						The Operator also passes along additional variables under the <code class="literal">meta</code> field for the name of the CR and the namespace of the CR.
					</p><p>
						For the following CR example:
					</p><pre class="programlisting language-yaml">apiVersion: "app.example.com/v1alpha1"
kind: "Database"
metadata:
  name: "example"
spec:
  message: "Hello world 2"
  newParameter: "newParam"</pre><p>
						The structure passed to Ansible as extra variables is:
					</p><pre class="programlisting language-json">{ "meta": {
        "name": "&lt;cr_name&gt;",
        "namespace": "&lt;cr_namespace&gt;",
  },
  "message": "Hello world 2",
  "new_parameter": "newParam",
  "_app_example_com_database": {
     &lt;full_crd&gt;
   },
}</pre><p>
						The <code class="literal">message</code> and <code class="literal">newParameter</code> fields are set in the top level as extra variables, and <code class="literal">meta</code> provides the relevant metadata for the CR as defined in the Operator. The <code class="literal">meta</code> fields can be accessed using dot notation in Ansible, for example:
					</p><pre class="programlisting language-yaml">---
- debug:
    msg: "name: {{ ansible_operator_meta.name }}, {{ ansible_operator_meta.namespace }}"</pre></section><section class="section" id="osdk-ansible-runner-directory_osdk-ansible-support"><div class="titlepage"><div><div><h4 class="title">5.4.5.4. Ansible Runner directory</h4></div></div></div><p>
						Ansible Runner keeps information about Ansible runs in the container. This is located at <code class="literal">/tmp/ansible-operator/runner/&lt;group&gt;/&lt;version&gt;/&lt;kind&gt;/&lt;namespace&gt;/&lt;name&gt;</code>.
					</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								To learn more about the <code class="literal">runner</code> directory, see the <a class="link" href="https://ansible-runner.readthedocs.io/en/latest/index.html">Ansible Runner documentation</a>.
							</li></ul></div></section></section><section class="section" id="osdk-ansible-k8s-collection"><div class="titlepage"><div><div><h3 class="title">5.4.6. Kubernetes Collection for Ansible</h3></div></div></div><p>
					To manage the lifecycle of your application on Kubernetes using Ansible, you can use the <a class="link" href="https://galaxy.ansible.com/community/kubernetes">Kubernetes Collection for Ansible</a>. This collection of Ansible modules allows a developer to either leverage their existing Kubernetes resource files written in YAML or express the lifecycle management in native Ansible.
				</p><p>
					One of the biggest benefits of using Ansible in conjunction with existing Kubernetes resource files is the ability to use Jinja templating so that you can customize resources with the simplicity of a few variables in Ansible.
				</p><p>
					This section goes into detail on usage of the Kubernetes Collection. To get started, install the collection on your local workstation and test it using a playbook before moving on to using it within an Operator.
				</p><section class="section" id="osdk-ansible-installing-k8s-collection_osdk-ansible-k8s-collection"><div class="titlepage"><div><div><h4 class="title">5.4.6.1. Installing the Kubernetes Collection for Ansible</h4></div></div></div><p>
						You can install the Kubernetes Collection for Ansible on your local workstation.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Install Ansible 2.9+:
							</p><pre class="programlisting language-terminal">$ sudo dnf install ansible</pre></li><li class="listitem"><p class="simpara">
								Install the <a class="link" href="https://github.com/openshift/openshift-restclient-python">OpenShift python client</a> package:
							</p><pre class="programlisting language-terminal">$ pip3 install openshift</pre></li><li class="listitem"><p class="simpara">
								Install the Kubernetes Collection using one of the following methods:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										You can install the collection directly from Ansible Galaxy:
									</p><pre class="programlisting language-terminal">$ ansible-galaxy collection install community.kubernetes</pre></li><li class="listitem"><p class="simpara">
										If you have already initialized your Operator, you might have a <code class="literal">requirements.yml</code> file at the top level of your project. This file specifies Ansible dependencies that must be installed for your Operator to function. By default, this file installs the <code class="literal">community.kubernetes</code> collection as well as the <code class="literal">operator_sdk.util</code> collection, which provides modules and plugins for Operator-specific fuctions.
									</p><p class="simpara">
										To install the dependent modules from the <code class="literal">requirements.yml</code> file:
									</p><pre class="programlisting language-terminal">$ ansible-galaxy collection install -r requirements.yml</pre></li></ul></div></li></ol></div></section><section class="section" id="osdk-ansible-k8s-local_osdk-ansible-k8s-collection"><div class="titlepage"><div><div><h4 class="title">5.4.6.2. Testing the Kubernetes Collection locally</h4></div></div></div><p>
						Operator developers can run the Ansible code from their local machine as opposed to running and rebuilding the Operator each time.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Initialize an Ansible-based Operator project and create an API that has a generated Ansible role by using the Operator SDK
							</li><li class="listitem">
								Install the Kubernetes Collection for Ansible
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								In your Ansible-based Operator project directory, modify the <code class="literal">roles/&lt;kind&gt;/tasks/main.yml</code> file with the Ansible logic that you want. The <code class="literal">roles/&lt;kind&gt;/</code> directory is created when you use the <code class="literal">--generate-role</code> flag while creating an API. The <code class="literal">&lt;kind&gt;</code> replaceable matches the kind that you specified for the API.
							</p><p class="simpara">
								The following example creates and deletes a config map based on the value of a variable named <code class="literal">state</code>:
							</p><pre class="programlisting language-yaml">---
- name: set ConfigMap example-config to {{ state }}
  community.kubernetes.k8s:
    api_version: v1
    kind: ConfigMap
    name: example-config
    namespace: &lt;operator_namespace&gt; <span id="CO57-1"><!--Empty--></span><span class="callout">1</span>
    state: "{{ state }}"
  ignore_errors: true <span id="CO57-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO57-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Specify the namespace where you want the config map created.
									</div></dd><dt><a href="#CO57-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Setting <code class="literal">ignore_errors: true</code> ensures that deleting a nonexistent config map does not fail.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Modify the <code class="literal">roles/&lt;kind&gt;/defaults/main.yml</code> file to set <code class="literal">state</code> to <code class="literal">present</code> by default:
							</p><pre class="programlisting language-yaml">---
state: present</pre></li><li class="listitem"><p class="simpara">
								Create an Ansible playbook by creating a <code class="literal">playbook.yml</code> file in the top-level of your project directory, and include your <code class="literal">&lt;kind&gt;</code> role:
							</p><pre class="programlisting language-yaml">---
- hosts: localhost
  roles:
    - &lt;kind&gt;</pre></li><li class="listitem"><p class="simpara">
								Run the playbook:
							</p><pre class="programlisting language-terminal">$ ansible-playbook playbook.yml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

PLAY [localhost] ********************************************************************************

TASK [Gathering Facts] ********************************************************************************
ok: [localhost]

TASK [memcached : set ConfigMap example-config to present] ********************************************************************************
changed: [localhost]

PLAY RECAP ********************************************************************************
localhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Verify that the config map was created:
							</p><pre class="programlisting language-terminal">$ oc get configmaps</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME               DATA   AGE
example-config     0      2m1s</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Rerun the playbook setting <code class="literal">state</code> to <code class="literal">absent</code>:
							</p><pre class="programlisting language-terminal">$ ansible-playbook playbook.yml --extra-vars state=absent</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

PLAY [localhost] ********************************************************************************

TASK [Gathering Facts] ********************************************************************************
ok: [localhost]

TASK [memcached : set ConfigMap example-config to absent] ********************************************************************************
changed: [localhost]

PLAY RECAP ********************************************************************************
localhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Verify that the config map was deleted:
							</p><pre class="programlisting language-terminal">$ oc get configmaps</pre></li></ol></div></section><section class="section" id="osdk-ansible-k8s-collection-next-steps"><div class="titlepage"><div><div><h4 class="title">5.4.6.3. Next steps</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-ansible-inside-operator">Using Ansible inside an Operator</a> for details on triggering your custom Ansible logic inside of an Operator when a custom resource (CR) changes.
							</li></ul></div></section></section><section class="section" id="osdk-ansible-inside-operator"><div class="titlepage"><div><div><h3 class="title">5.4.7. Using Ansible inside an Operator</h3></div></div></div><p>
					After you are familiar with <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-ansible-k8s-collection">using the Kubernetes Collection for Ansible locally</a>, you can trigger the same Ansible logic inside of an Operator when a custom resource (CR) changes. This example maps an Ansible role to a specific Kubernetes resource that the Operator watches. This mapping is done in the <code class="literal">watches.yaml</code> file.
				</p><section class="section" id="osdk-ansible-custom-resource-files_osdk-ansible-inside-operator"><div class="titlepage"><div><div><h4 class="title">5.4.7.1. Custom resource files</h4></div></div></div><p>
						Operators use the Kubernetes extension mechanism, custom resource definitions (CRDs), so your custom resource (CR) looks and acts just like the built-in, native Kubernetes objects.
					</p><p>
						The CR file format is a Kubernetes resource file. The object has mandatory and optional fields:
					</p><div class="table" id="idm139731979343888"><p class="title"><strong>Table 5.5. Custom resource fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"><!--Empty--></col><col style="width: 70%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731979339056" scope="col">Field</th><th align="left" valign="top" id="idm139731979337968" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731979339056"> <p>
										<code class="literal">apiVersion</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731979337968"> <p>
										Version of the CR to be created.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731979339056"> <p>
										<code class="literal">kind</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731979337968"> <p>
										Kind of the CR to be created.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731979339056"> <p>
										<code class="literal">metadata</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731979337968"> <p>
										Kubernetes-specific metadata to be created.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731979339056"> <p>
										<code class="literal">spec</code> (optional)
									</p>
									 </td><td align="left" valign="top" headers="idm139731979337968"> <p>
										Key-value list of variables which are passed to Ansible. This field is empty by default.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731979339056"> <p>
										<code class="literal">status</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731979337968"> <p>
										Summarizes the current state of the object. For Ansible-based Operators, the <a class="link" href="https://kubernetes.io/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definitions/#status-subresource"><code class="literal">status</code> subresource</a> is enabled for CRDs and managed by the <code class="literal">operator_sdk.util.k8s_status</code> Ansible module by default, which includes <code class="literal">condition</code> information to the CR <code class="literal">status</code>.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731979339056"> <p>
										<code class="literal">annotations</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731979337968"> <p>
										Kubernetes-specific annotations to be appended to the CR.
									</p>
									 </td></tr></tbody></table></div></div><p>
						The following list of CR annotations modify the behavior of the Operator:
					</p><div class="table" id="idm139731975241408"><p class="title"><strong>Table 5.6. Ansible-based Operator annotations</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"><!--Empty--></col><col style="width: 70%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731975236560" scope="col">Annotation</th><th align="left" valign="top" id="idm139731975235472" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731975236560"> <p>
										<code class="literal">ansible.operator-sdk/reconcile-period</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731975235472"> <p>
										Specifies the reconciliation interval for the CR. This value is parsed using the standard Golang package <a class="link" href="https://golang.org/pkg/time/"><code class="literal">time</code></a>. Specifically, <a class="link" href="https://golang.org/pkg/time/#ParseDuration"><code class="literal">ParseDuration</code></a> is used which applies the default suffix of <code class="literal">s</code>, giving the value in seconds.
									</p>
									 </td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example Ansible-based Operator annotation</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: "test1.example.com/v1alpha1"
kind: "Test1"
metadata:
  name: "example"
annotations:
  ansible.operator-sdk/reconcile-period: "30s"</pre>

						</p></div></section><section class="section" id="osdk-ansible-inside-operator-local_osdk-ansible-inside-operator"><div class="titlepage"><div><div><h4 class="title">5.4.7.2. Testing an Ansible-based Operator locally</h4></div></div></div><p>
						You can test the logic inside of an Ansible-based Operator running locally by using the <code class="literal">make run</code> command from the top-level directory of your Operator project. The <code class="literal">make run</code> Makefile target runs the <code class="literal">ansible-operator</code> binary locally, which reads from the <code class="literal">watches.yaml</code> file and uses your <code class="literal">~/.kube/config</code> file to communicate with a Kubernetes cluster just as the <code class="literal">k8s</code> modules do.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You can customize the roles path by setting the environment variable <code class="literal">ANSIBLE_ROLES_PATH</code> or by using the <code class="literal">ansible-roles-path</code> flag. If the role is not found in the <code class="literal">ANSIBLE_ROLES_PATH</code> value, the Operator looks for it in <code class="literal">{{current directory}}/roles</code>.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://ansible-runner.readthedocs.io/en/latest/install.html">Ansible Runner</a> v2.0.2+
							</li><li class="listitem">
								<a class="link" href="https://github.com/ansible/ansible-runner-http">Ansible Runner HTTP Event Emitter plugin</a> v1.0.0+
							</li><li class="listitem">
								Performed the previous steps for testing the Kubernetes Collection locally
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Install your custom resource definition (CRD) and proper role-based access control (RBAC) definitions for your custom resource (CR):
							</p><pre class="programlisting language-terminal">$ make install</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">/usr/bin/kustomize build config/crd | kubectl apply -f -
customresourcedefinition.apiextensions.k8s.io/memcacheds.cache.example.com created</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Run the <code class="literal">make run</code> command:
							</p><pre class="programlisting language-terminal">$ make run</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">/home/user/memcached-operator/bin/ansible-operator run
{"level":"info","ts":1612739145.2871568,"logger":"cmd","msg":"Version","Go Version":"go1.15.5","GOOS":"linux","GOARCH":"amd64","ansible-operator":"v1.10.1","commit":"1abf57985b43bf6a59dcd18147b3c574fa57d3f6"}
...
{"level":"info","ts":1612739148.347306,"logger":"controller-runtime.metrics","msg":"metrics server is starting to listen","addr":":8080"}
{"level":"info","ts":1612739148.3488882,"logger":"watches","msg":"Environment variable not set; using default value","envVar":"ANSIBLE_VERBOSITY_MEMCACHED_CACHE_EXAMPLE_COM","default":2}
{"level":"info","ts":1612739148.3490262,"logger":"cmd","msg":"Environment variable not set; using default value","Namespace":"","envVar":"ANSIBLE_DEBUG_LOGS","ANSIBLE_DEBUG_LOGS":false}
{"level":"info","ts":1612739148.3490646,"logger":"ansible-controller","msg":"Watching resource","Options.Group":"cache.example.com","Options.Version":"v1","Options.Kind":"Memcached"}
{"level":"info","ts":1612739148.350217,"logger":"proxy","msg":"Starting to serve","Address":"127.0.0.1:8888"}
{"level":"info","ts":1612739148.3506632,"logger":"controller-runtime.manager","msg":"starting metrics server","path":"/metrics"}
{"level":"info","ts":1612739148.350784,"logger":"controller-runtime.manager.controller.memcached-controller","msg":"Starting EventSource","source":"kind source: cache.example.com/v1, Kind=Memcached"}
{"level":"info","ts":1612739148.5511978,"logger":"controller-runtime.manager.controller.memcached-controller","msg":"Starting Controller"}
{"level":"info","ts":1612739148.5512562,"logger":"controller-runtime.manager.controller.memcached-controller","msg":"Starting workers","worker count":8}</pre>

								</p></div><p class="simpara">
								With the Operator now watching your CR for events, the creation of a CR will trigger your Ansible role to run.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Consider an example <code class="literal">config/samples/&lt;gvk&gt;.yaml</code> CR manifest:
								</p><pre class="programlisting language-yaml">apiVersion: &lt;group&gt;.example.com/v1alpha1
kind: &lt;kind&gt;
metadata:
  name: "&lt;kind&gt;-sample"</pre><p>
									Because the <code class="literal">spec</code> field is not set, Ansible is invoked with no extra variables. Passing extra variables from a CR to Ansible is covered in another section. It is important to set reasonable defaults for the Operator.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Create an instance of your CR with the default variable <code class="literal">state</code> set to <code class="literal">present</code>:
							</p><pre class="programlisting language-terminal">$ oc apply -f config/samples/&lt;gvk&gt;.yaml</pre></li><li class="listitem"><p class="simpara">
								Check that the <code class="literal">example-config</code> config map was created:
							</p><pre class="programlisting language-terminal">$ oc get configmaps</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                    STATUS    AGE
example-config          Active    3s</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Modify your <code class="literal">config/samples/&lt;gvk&gt;.yaml</code> file to set the <code class="literal">state</code> field to <code class="literal">absent</code>. For example:
							</p><pre class="programlisting language-yaml">apiVersion: cache.example.com/v1
kind: Memcached
metadata:
  name: memcached-sample
spec:
  state: absent</pre></li><li class="listitem"><p class="simpara">
								Apply the changes:
							</p><pre class="programlisting language-terminal">$ oc apply -f config/samples/&lt;gvk&gt;.yaml</pre></li><li class="listitem"><p class="simpara">
								Confirm that the config map is deleted:
							</p><pre class="programlisting language-terminal">$ oc get configmap</pre></li></ol></div></section><section class="section" id="osdk-run-deployment_osdk-ansible-inside-operator"><div class="titlepage"><div><div><h4 class="title">5.4.7.3. Testing an Ansible-based Operator on the cluster</h4></div></div></div><p>
						After you have tested your custom Ansible logic locally inside of an Operator, you can test the Operator inside of a pod on an OpenShift Container Platform cluster, which is preferred for production use.
					</p><p>
						You can run your Operator project as a deployment on your cluster.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Run the following <code class="literal">make</code> commands to build and push the Operator image. Modify the <code class="literal">IMG</code> argument in the following steps to reference a repository that you have access to. You can obtain an account for storing containers at repository sites such as Quay.io.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Build the image:
									</p><pre class="programlisting language-terminal">$ make docker-build IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											The Dockerfile generated by the SDK for the Operator explicitly references <code class="literal">GOARCH=amd64</code> for <code class="literal">go build</code>. This can be amended to <code class="literal">GOARCH=$TARGETARCH</code> for non-AMD64 architectures. Docker will automatically set the environment variable to the value specified by <code class="literal">–platform</code>. With Buildah, the <code class="literal">–build-arg</code> will need to be used for the purpose. For more information, see <a class="link" href="https://sdk.operatorframework.io/docs/advanced-topics/multi-arch/#supporting-multiple-architectures">Multiple Architectures</a>.
										</p></div></div></li><li class="listitem"><p class="simpara">
										Push the image to a repository:
									</p><pre class="programlisting language-terminal">$ make docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											The name and tag of the image, for example <code class="literal">IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</code>, in both the commands can also be set in your Makefile. Modify the <code class="literal">IMG ?= controller:latest</code> value to set your default image name.
										</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
								Run the following command to deploy the Operator:
							</p><pre class="programlisting language-terminal">$ make deploy IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><p class="simpara">
								By default, this command creates a namespace with the name of your Operator project in the form <code class="literal">&lt;project_name&gt;-system</code> and is used for the deployment. This command also installs the RBAC manifests from <code class="literal">config/rbac</code>.
							</p></li><li class="listitem"><p class="simpara">
								Run the following command to verify that the Operator is running:
							</p><pre class="programlisting language-terminal">$ oc get deployment -n &lt;project_name&gt;-system</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                    READY   UP-TO-DATE   AVAILABLE   AGE
&lt;project_name&gt;-controller-manager       1/1     1            1           8m</pre>

								</p></div></li></ol></div></section><section class="section" id="osdk-ansible-inside-operator-logs_osdk-ansible-inside-operator"><div class="titlepage"><div><div><h4 class="title">5.4.7.4. Ansible logs</h4></div></div></div><p>
						Ansible-based Operators provide logs about the Ansible run, which can be useful for debugging your Ansible tasks. The logs can also contain detailed information about the internals of the Operator and its interactions with Kubernetes.
					</p><section class="section" id="osdk-ansible-inside-operator-logs-view_osdk-ansible-inside-operator"><div class="titlepage"><div><div><h5 class="title">5.4.7.4.1. Viewing Ansible logs</h5></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									Ansible-based Operator running as a deployment on a cluster
								</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To view logs from an Ansible-based Operator, run the following command:
								</p><pre class="programlisting language-terminal">$ oc logs deployment/&lt;project_name&gt;-controller-manager \
    -c manager \<span id="CO58-1"><!--Empty--></span><span class="callout">1</span>
    -n &lt;namespace&gt; <span id="CO58-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO58-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											View logs from the <code class="literal">manager</code> container.
										</div></dd><dt><a href="#CO58-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											If you used the <code class="literal">make deploy</code> command to run the Operator as a deployment, use the <code class="literal">&lt;project_name&gt;-system</code> namespace.
										</div></dd></dl></div><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">{"level":"info","ts":1612732105.0579333,"logger":"cmd","msg":"Version","Go Version":"go1.15.5","GOOS":"linux","GOARCH":"amd64","ansible-operator":"v1.10.1","commit":"1abf57985b43bf6a59dcd18147b3c574fa57d3f6"}
{"level":"info","ts":1612732105.0587437,"logger":"cmd","msg":"WATCH_NAMESPACE environment variable not set. Watching all namespaces.","Namespace":""}
I0207 21:08:26.110949       7 request.go:645] Throttling request took 1.035521578s, request: GET:https://172.30.0.1:443/apis/flowcontrol.apiserver.k8s.io/v1alpha1?timeout=32s
{"level":"info","ts":1612732107.768025,"logger":"controller-runtime.metrics","msg":"metrics server is starting to listen","addr":"127.0.0.1:8080"}
{"level":"info","ts":1612732107.768796,"logger":"watches","msg":"Environment variable not set; using default value","envVar":"ANSIBLE_VERBOSITY_MEMCACHED_CACHE_EXAMPLE_COM","default":2}
{"level":"info","ts":1612732107.7688773,"logger":"cmd","msg":"Environment variable not set; using default value","Namespace":"","envVar":"ANSIBLE_DEBUG_LOGS","ANSIBLE_DEBUG_LOGS":false}
{"level":"info","ts":1612732107.7688901,"logger":"ansible-controller","msg":"Watching resource","Options.Group":"cache.example.com","Options.Version":"v1","Options.Kind":"Memcached"}
{"level":"info","ts":1612732107.770032,"logger":"proxy","msg":"Starting to serve","Address":"127.0.0.1:8888"}
I0207 21:08:27.770185       7 leaderelection.go:243] attempting to acquire leader lease  memcached-operator-system/memcached-operator...
{"level":"info","ts":1612732107.770202,"logger":"controller-runtime.manager","msg":"starting metrics server","path":"/metrics"}
I0207 21:08:27.784854       7 leaderelection.go:253] successfully acquired lease memcached-operator-system/memcached-operator
{"level":"info","ts":1612732107.7850506,"logger":"controller-runtime.manager.controller.memcached-controller","msg":"Starting EventSource","source":"kind source: cache.example.com/v1, Kind=Memcached"}
{"level":"info","ts":1612732107.8853772,"logger":"controller-runtime.manager.controller.memcached-controller","msg":"Starting Controller"}
{"level":"info","ts":1612732107.8854098,"logger":"controller-runtime.manager.controller.memcached-controller","msg":"Starting workers","worker count":4}</pre>

									</p></div></li></ul></div></section><section class="section" id="osdk-ansible-inside-operator-logs-full-result_osdk-ansible-inside-operator"><div class="titlepage"><div><div><h5 class="title">5.4.7.4.2. Enabling full Ansible results in logs</h5></div></div></div><p>
							You can set the environment variable <code class="literal">ANSIBLE_DEBUG_LOGS</code> to <code class="literal">True</code> to enable checking the full Ansible result in logs, which can be helpful when debugging.
						</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Edit the <code class="literal">config/manager/manager.yaml</code> and <code class="literal">config/default/manager_auth_proxy_patch.yaml</code> files to include the following configuration:
								</p><pre class="programlisting language-terminal">      containers:
      - name: manager
        env:
        - name: ANSIBLE_DEBUG_LOGS
          value: "True"</pre></li></ul></div></section><section class="section" id="osdk-ansible-inside-operator-logs-verbose_osdk-ansible-inside-operator"><div class="titlepage"><div><div><h5 class="title">5.4.7.4.3. Enabling verbose debugging in logs</h5></div></div></div><p>
							While developing an Ansible-based Operator, it can be helpful to enable additional debugging in logs.
						</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Add the <code class="literal">ansible.sdk.operatorframework.io/verbosity</code> annotation to your custom resource to enable the verbosity level that you want. For example:
								</p><pre class="programlisting language-terminal">apiVersion: "cache.example.com/v1alpha1"
kind: "Memcached"
metadata:
  name: "example-memcached"
  annotations:
    "ansible.sdk.operatorframework.io/verbosity": "4"
spec:
  size: 4</pre></li></ul></div></section></section></section><section class="section" id="osdk-ansible-cr-status"><div class="titlepage"><div><div><h3 class="title">5.4.8. Custom resource status management</h3></div></div></div><section class="section" id="osdk-ansible-cr-status-about_osdk-ansible-cr-mgmt"><div class="titlepage"><div><div><h4 class="title">5.4.8.1. About custom resource status in Ansible-based Operators</h4></div></div></div><p>
						Ansible-based Operators automatically update custom resource (CR) <a class="link" href="https://kubernetes.io/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definitions/#status-subresource"><code class="literal">status</code> subresources</a> with generic information about the previous Ansible run. This includes the number of successful and failed tasks and relevant error messages as shown:
					</p><pre class="programlisting language-yaml">status:
  conditions:
  - ansibleResult:
      changed: 3
      completion: 2018-12-03T13:45:57.13329
      failures: 1
      ok: 6
      skipped: 0
    lastTransitionTime: 2018-12-03T13:45:57Z
    message: 'Status code was -1 and not [200]: Request failed: &lt;urlopen error [Errno
      113] No route to host&gt;'
    reason: Failed
    status: "True"
    type: Failure
  - lastTransitionTime: 2018-12-03T13:46:13Z
    message: Running reconciliation
    reason: Running
    status: "True"
    type: Running</pre><p>
						Ansible-based Operators also allow Operator authors to supply custom status values with the <code class="literal">k8s_status</code> Ansible module, which is included in the <a class="link" href="https://galaxy.ansible.com/operator_sdk/util"><code class="literal">operator_sdk.util</code> collection</a>. This allows the author to update the <code class="literal">status</code> from within Ansible with any key-value pair as desired.
					</p><p>
						By default, Ansible-based Operators always include the generic Ansible run output as shown above. If you would prefer your application did <span class="emphasis"><em>not</em></span> update the status with Ansible output, you can track the status manually from your application.
					</p></section><section class="section" id="osdk-ansible-cr-status-manual_osdk-ansible-cr-mgmt"><div class="titlepage"><div><div><h4 class="title">5.4.8.2. Tracking custom resource status manually</h4></div></div></div><p>
						You can use the <code class="literal">operator_sdk.util</code> collection to modify your Ansible-based Operator to track custom resource (CR) status manually from your application.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Ansible-based Operator project created by using the Operator SDK
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Update the <code class="literal">watches.yaml</code> file with a <code class="literal">manageStatus</code> field set to <code class="literal">false</code>:
							</p><pre class="programlisting language-yaml">- version: v1
  group: api.example.com
  kind: &lt;kind&gt;
  role: &lt;role&gt;
  manageStatus: false</pre></li><li class="listitem"><p class="simpara">
								Use the <code class="literal">operator_sdk.util.k8s_status</code> Ansible module to update the subresource. For example, to update with key <code class="literal">test</code> and value <code class="literal">data</code>, <code class="literal">operator_sdk.util</code> can be used as shown:
							</p><pre class="programlisting language-yaml">- operator_sdk.util.k8s_status:
    api_version: app.example.com/v1
    kind: &lt;kind&gt;
    name: "{{ ansible_operator_meta.name }}"
    namespace: "{{ ansible_operator_meta.namespace }}"
    status:
      test: data</pre></li><li class="listitem"><p class="simpara">
								You can declare collections in the <code class="literal">meta/main.yml</code> file for the role, which is included for scaffolded Ansible-based Operators:
							</p><pre class="programlisting language-yaml">collections:
  - operator_sdk.util</pre></li><li class="listitem"><p class="simpara">
								After declaring collections in the role meta, you can invoke the <code class="literal">k8s_status</code> module directly:
							</p><pre class="programlisting language-yaml">k8s_status:
  ...
  status:
    key1: value1</pre></li></ol></div></section></section></section><section class="section" id="helm-based-operators"><div class="titlepage"><div><div><h2 class="title">5.5. Helm-based Operators</h2></div></div></div><section class="section" id="osdk-helm-quickstart"><div class="titlepage"><div><div><h3 class="title">5.5.1. Getting started with Operator SDK for Helm-based Operators</h3></div></div></div><p>
					The Operator SDK includes options for generating an Operator project that leverages existing <a class="link" href="https://helm.sh/docs/">Helm</a> charts to deploy Kubernetes resources as a unified application, without having to write any Go code.
				</p><p>
					To demonstrate the basics of setting up and running an <a class="link" href="https://helm.sh/docs/">Helm</a>-based Operator using tools and libraries provided by the Operator SDK, Operator developers can build an example Helm-based Operator for Nginx and deploy it to a cluster.
				</p><section class="section" id="osdk-common-prereqs_osdk-helm-quickstart"><div class="titlepage"><div><div><h4 class="title">5.5.1.1. Prerequisites</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Operator SDK CLI installed
							</li><li class="listitem">
								OpenShift CLI (<code class="literal">oc</code>) v4.13+ installed
							</li><li class="listitem">
								Logged into an OpenShift Container Platform 4.13 cluster with <code class="literal">oc</code> with an account that has <code class="literal">cluster-admin</code> permissions
							</li><li class="listitem">
								To allow the cluster to pull the image, the repository where you push your image must be set as public, or you must configure an image pull secret
							</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-installing-cli">Installing the Operator SDK CLI</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cli_tools/#getting-started-cli">Getting started with the OpenShift CLI</a>
							</li></ul></div></section><section class="section" id="osdk-quickstart_osdk-helm-quickstart"><div class="titlepage"><div><div><h4 class="title">5.5.1.2. Creating and deploying Helm-based Operators</h4></div></div></div><p>
						You can build and deploy a simple Helm-based Operator for Nginx by using the Operator SDK.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Create a project.</strong></span>
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Create your project directory:
									</p><pre class="programlisting language-terminal">$ mkdir nginx-operator</pre></li><li class="listitem"><p class="simpara">
										Change into the project directory:
									</p><pre class="programlisting language-terminal">$ cd nginx-operator</pre></li><li class="listitem"><p class="simpara">
										Run the <code class="literal">operator-sdk init</code> command with the <code class="literal">helm</code> plugin to initialize the project:
									</p><pre class="programlisting language-terminal">$ operator-sdk init \
    --plugins=helm</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Create an API.</strong></span>
							</p><p class="simpara">
								Create a simple Nginx API:
							</p><pre class="programlisting language-terminal">$ operator-sdk create api \
    --group demo \
    --version v1 \
    --kind Nginx</pre><p class="simpara">
								This API uses the built-in Helm chart boilerplate from the <code class="literal">helm create</code> command.
							</p></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Build and push the Operator image.</strong></span>
							</p><p class="simpara">
								Use the default <code class="literal">Makefile</code> targets to build and push your Operator. Set <code class="literal">IMG</code> with a pull spec for your image that uses a registry you can push to:
							</p><pre class="programlisting language-terminal">$ make docker-build docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Run the Operator.</strong></span>
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Install the CRD:
									</p><pre class="programlisting language-terminal">$ make install</pre></li><li class="listitem"><p class="simpara">
										Deploy the project to the cluster. Set <code class="literal">IMG</code> to the image that you pushed:
									</p><pre class="programlisting language-terminal">$ make deploy IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Add a security context constraint (SCC).</strong></span>
							</p><p class="simpara">
								The Nginx service account requires privileged access to run in OpenShift Container Platform. Add the following SCC to the service account for the <code class="literal">nginx-sample</code> pod:
							</p><pre class="programlisting language-terminal">$ oc adm policy add-scc-to-user \
    anyuid system:serviceaccount:nginx-operator-system:nginx-sample</pre></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Create a sample custom resource (CR).</strong></span>
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Create a sample CR:
									</p><pre class="programlisting language-terminal">$ oc apply -f config/samples/demo_v1_nginx.yaml \
    -n nginx-operator-system</pre></li><li class="listitem"><p class="simpara">
										Watch for the CR to reconcile the Operator:
									</p><pre class="programlisting language-terminal">$ oc logs deployment.apps/nginx-operator-controller-manager \
    -c manager \
    -n nginx-operator-system</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Delete a CR.</strong></span>
							</p><p class="simpara">
								Delete a CR by running the following command:
							</p><pre class="programlisting language-terminal">$ oc delete -f config/samples/demo_v1_nginx -n nginx-operator-system</pre></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Clean up.</strong></span>
							</p><p class="simpara">
								Run the following command to clean up the resources that have been created as part of this procedure:
							</p><pre class="programlisting language-terminal">$ make undeploy</pre></li></ol></div></section><section class="section" id="osdk-helm-quickstart-next-steps"><div class="titlepage"><div><div><h4 class="title">5.5.1.3. Next steps</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-helm-tutorial">Operator SDK tutorial for Helm-based Operators</a> for a more in-depth walkthrough on building a Helm-based Operator.
							</li></ul></div></section></section><section class="section" id="osdk-helm-tutorial"><div class="titlepage"><div><div><h3 class="title">5.5.2. Operator SDK tutorial for Helm-based Operators</h3></div></div></div><p>
					Operator developers can take advantage of <a class="link" href="https://helm.sh/docs/">Helm</a> support in the Operator SDK to build an example Helm-based Operator for Nginx and manage its lifecycle. This tutorial walks through the following process:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Create a Nginx deployment
						</li><li class="listitem">
							Ensure that the deployment size is the same as specified by the <code class="literal">Nginx</code> custom resource (CR) spec
						</li><li class="listitem">
							Update the <code class="literal">Nginx</code> CR status using the status writer with the names of the <code class="literal">nginx</code> pods
						</li></ul></div><p>
					This process is accomplished using two centerpieces of the Operator Framework:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Operator SDK</span></dt><dd>
								The <code class="literal">operator-sdk</code> CLI tool and <code class="literal">controller-runtime</code> library API
							</dd><dt><span class="term">Operator Lifecycle Manager (OLM)</span></dt><dd>
								Installation, upgrade, and role-based access control (RBAC) of Operators on a cluster
							</dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						This tutorial goes into greater detail than <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-helm-quickstart">Getting started with Operator SDK for Helm-based Operators</a>.
					</p></div></div><section class="section" id="osdk-common-prereqs_osdk-helm-tutorial"><div class="titlepage"><div><div><h4 class="title">5.5.2.1. Prerequisites</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Operator SDK CLI installed
							</li><li class="listitem">
								OpenShift CLI (<code class="literal">oc</code>) v4.13+ installed
							</li><li class="listitem">
								Logged into an OpenShift Container Platform 4.13 cluster with <code class="literal">oc</code> with an account that has <code class="literal">cluster-admin</code> permissions
							</li><li class="listitem">
								To allow the cluster to pull the image, the repository where you push your image must be set as public, or you must configure an image pull secret
							</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-installing-cli">Installing the Operator SDK CLI</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cli_tools/#getting-started-cli">Getting started with the OpenShift CLI</a>
							</li></ul></div></section><section class="section" id="osdk-create-project_osdk-helm-tutorial"><div class="titlepage"><div><div><h4 class="title">5.5.2.2. Creating a project</h4></div></div></div><p>
						Use the Operator SDK CLI to create a project called <code class="literal">nginx-operator</code>.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a directory for the project:
							</p><pre class="programlisting language-terminal">$ mkdir -p $HOME/projects/nginx-operator</pre></li><li class="listitem"><p class="simpara">
								Change to the directory:
							</p><pre class="programlisting language-terminal">$ cd $HOME/projects/nginx-operator</pre></li><li class="listitem"><p class="simpara">
								Run the <code class="literal">operator-sdk init</code> command with the <code class="literal">helm</code> plugin to initialize the project:
							</p><pre class="programlisting language-terminal">$ operator-sdk init \
    --plugins=helm \
    --domain=example.com \
    --group=demo \
    --version=v1 \
    --kind=Nginx</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									By default, the <code class="literal">helm</code> plugin initializes a project using a boilerplate Helm chart. You can use additional flags, such as the <code class="literal">--helm-chart</code> flag, to initialize a project using an existing Helm chart.
								</p></div></div><p class="simpara">
								The <code class="literal">init</code> command creates the <code class="literal">nginx-operator</code> project specifically for watching a resource with API version <code class="literal">example.com/v1</code> and kind <code class="literal">Nginx</code>.
							</p></li><li class="listitem">
								For Helm-based projects, the <code class="literal">init</code> command generates the RBAC rules in the <code class="literal">config/rbac/role.yaml</code> file based on the resources that would be deployed by the default manifest for the chart. Verify that the rules generated in this file meet the permission requirements of the Operator.
							</li></ol></div><section class="section" id="osdk-helm-existing-chart_osdk-helm-tutorial"><div class="titlepage"><div><div><h5 class="title">5.5.2.2.1. Existing Helm charts</h5></div></div></div><p>
							Instead of creating your project with a boilerplate Helm chart, you can alternatively use an existing chart, either from your local file system or a remote chart repository, by using the following flags:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">--helm-chart</code>
								</li><li class="listitem">
									<code class="literal">--helm-chart-repo</code>
								</li><li class="listitem">
									<code class="literal">--helm-chart-version</code>
								</li></ul></div><p>
							If the <code class="literal">--helm-chart</code> flag is specified, the <code class="literal">--group</code>, <code class="literal">--version</code>, and <code class="literal">--kind</code> flags become optional. If left unset, the following default values are used:
						</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731977732224" scope="col">Flag</th><th align="left" valign="top" id="idm139731977731136" scope="col">Value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731977732224"> <p>
											<code class="literal">--domain</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731977731136"> <p>
											<code class="literal">my.domain</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139731977732224"> <p>
											<code class="literal">--group</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731977731136"> <p>
											<code class="literal">charts</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139731977732224"> <p>
											<code class="literal">--version</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731977731136"> <p>
											<code class="literal">v1</code>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139731977732224"> <p>
											<code class="literal">--kind</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731977731136"> <p>
											Deduced from the specified chart
										</p>
										 </td></tr></tbody></table></div><p>
							If the <code class="literal">--helm-chart</code> flag specifies a local chart archive, for example <code class="literal">example-chart-1.2.0.tgz</code>, or directory, the chart is validated and unpacked or copied into the project. Otherwise, the Operator SDK attempts to fetch the chart from a remote repository.
						</p><p>
							If a custom repository URL is not specified by the <code class="literal">--helm-chart-repo</code> flag, the following chart reference formats are supported:
						</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 80%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731975428608" scope="col">Format</th><th align="left" valign="top" id="idm139731975427520" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731975428608"> <p>
											<code class="literal">&lt;repo_name&gt;/&lt;chart_name&gt;</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731975427520"> <p>
											Fetch the Helm chart named <code class="literal">&lt;chart_name&gt;</code> from the helm chart repository named <code class="literal">&lt;repo_name&gt;</code>, as specified in the <code class="literal">$HELM_HOME/repositories/repositories.yaml</code> file. Use the <code class="literal">helm repo add</code> command to configure this file.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139731975428608"> <p>
											<code class="literal">&lt;url&gt;</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731975427520"> <p>
											Fetch the Helm chart archive at the specified URL.
										</p>
										 </td></tr></tbody></table></div><p>
							If a custom repository URL is specified by <code class="literal">--helm-chart-repo</code>, the following chart reference format is supported:
						</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 80%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731975409696" scope="col">Format</th><th align="left" valign="top" id="idm139731975408608" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731975409696"> <p>
											<code class="literal">&lt;chart_name&gt;</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731975408608"> <p>
											Fetch the Helm chart named <code class="literal">&lt;chart_name&gt;</code> in the Helm chart repository specified by the <code class="literal">--helm-chart-repo</code> URL value.
										</p>
										 </td></tr></tbody></table></div><p>
							If the <code class="literal">--helm-chart-version</code> flag is unset, the Operator SDK fetches the latest available version of the Helm chart. Otherwise, it fetches the specified version. The optional <code class="literal">--helm-chart-version</code> flag is not used when the chart specified with the <code class="literal">--helm-chart</code> flag refers to a specific version, for example when it is a local path or a URL.
						</p><p>
							For more details and examples, run:
						</p><pre class="programlisting language-terminal">$ operator-sdk init --plugins helm --help</pre></section><section class="section" id="osdk-project-file_osdk-helm-tutorial"><div class="titlepage"><div><div><h5 class="title">5.5.2.2.2. PROJECT file</h5></div></div></div><p>
							Among the files generated by the <code class="literal">operator-sdk init</code> command is a Kubebuilder <code class="literal">PROJECT</code> file. Subsequent <code class="literal">operator-sdk</code> commands, as well as <code class="literal">help</code> output, that are run from the project root read this file and are aware that the project type is Helm. For example:
						</p><pre class="programlisting language-yaml">domain: example.com
layout:
- helm.sdk.operatorframework.io/v1
plugins:
  manifests.sdk.operatorframework.io/v2: {}
  scorecard.sdk.operatorframework.io/v2: {}
  sdk.x-openshift.io/v1: {}
projectName: nginx-operator
resources:
- api:
    crdVersion: v1
    namespaced: true
  domain: example.com
  group: demo
  kind: Nginx
  version: v1
version: "3"</pre></section></section><section class="section" id="osdk-helm-logic_osdk-helm-tutorial"><div class="titlepage"><div><div><h4 class="title">5.5.2.3. Understanding the Operator logic</h4></div></div></div><p>
						For this example, the <code class="literal">nginx-operator</code> project executes the following reconciliation logic for each <code class="literal">Nginx</code> custom resource (CR):
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Create an Nginx deployment if it does not exist.
							</li><li class="listitem">
								Create an Nginx service if it does not exist.
							</li><li class="listitem">
								Create an Nginx ingress if it is enabled and does not exist.
							</li><li class="listitem">
								Ensure that the deployment, service, and optional ingress match the desired configuration as specified by the <code class="literal">Nginx</code> CR, for example the replica count, image, and service type.
							</li></ul></div><p>
						By default, the <code class="literal">nginx-operator</code> project watches <code class="literal">Nginx</code> resource events as shown in the <code class="literal">watches.yaml</code> file and executes Helm releases using the specified chart:
					</p><pre class="programlisting language-yaml"># Use the 'create api' subcommand to add watches to this file.
- group: demo
  version: v1
  kind: Nginx
  chart: helm-charts/nginx
# +kubebuilder:scaffold:watch</pre><section class="section" id="osdk-helm-sample-chart_osdk-helm-tutorial"><div class="titlepage"><div><div><h5 class="title">5.5.2.3.1. Sample Helm chart</h5></div></div></div><p>
							When a Helm Operator project is created, the Operator SDK creates a sample Helm chart that contains a set of templates for a simple Nginx release.
						</p><p>
							For this example, templates are available for deployment, service, and ingress resources, along with a <code class="literal">NOTES.txt</code> template, which Helm chart developers use to convey helpful information about a release.
						</p><p>
							If you are not already familiar with Helm charts, review the <a class="link" href="https://docs.helm.sh/developing_charts/">Helm developer documentation</a>.
						</p></section><section class="section" id="osdk-helm-modify-cr_osdk-helm-tutorial"><div class="titlepage"><div><div><h5 class="title">5.5.2.3.2. Modifying the custom resource spec</h5></div></div></div><p>
							Helm uses a concept called <a class="link" href="https://helm.sh/docs/intro/using_helm/#customizing-the-chart-before-installing">values</a> to provide customizations to the defaults of a Helm chart, which are defined in the <code class="literal">values.yaml</code> file.
						</p><p>
							You can override these defaults by setting the desired values in the custom resource (CR) spec. You can use the number of replicas as an example.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									The <code class="literal">helm-charts/nginx/values.yaml</code> file has a value called <code class="literal">replicaCount</code> set to <code class="literal">1</code> by default. To have two Nginx instances in your deployment, your CR spec must contain <code class="literal">replicaCount: 2</code>.
								</p><p class="simpara">
									Edit the <code class="literal">config/samples/demo_v1_nginx.yaml</code> file to set <code class="literal">replicaCount: 2</code>:
								</p><pre class="programlisting language-yaml">apiVersion: demo.example.com/v1
kind: Nginx
metadata:
  name: nginx-sample
...
spec:
...
  replicaCount: 2</pre></li><li class="listitem"><p class="simpara">
									Similarly, the default service port is set to <code class="literal">80</code>. To use <code class="literal">8080</code>, edit the <code class="literal">config/samples/demo_v1_nginx.yaml</code> file to set <code class="literal">spec.port: 8080</code>,which adds the service port override:
								</p><pre class="programlisting language-yaml">apiVersion: demo.example.com/v1
kind: Nginx
metadata:
  name: nginx-sample
spec:
  replicaCount: 2
  service:
    port: 8080</pre></li></ol></div><p>
							The Helm Operator applies the entire spec as if it was the contents of a values file, just like the <code class="literal">helm install -f ./overrides.yaml</code> command.
						</p></section></section><section class="section" id="osdk-run-proxy_osdk-helm-tutorial"><div class="titlepage"><div><div><h4 class="title">5.5.2.4. Enabling proxy support</h4></div></div></div><p>
						Operator authors can develop Operators that support network proxies. Cluster administrators configure proxy support for the environment variables that are handled by Operator Lifecycle Manager (OLM). To support proxied clusters, your Operator must inspect the environment for the following standard proxy variables and pass the values to Operands:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">HTTP_PROXY</code>
							</li><li class="listitem">
								<code class="literal">HTTPS_PROXY</code>
							</li><li class="listitem">
								<code class="literal">NO_PROXY</code>
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							This tutorial uses <code class="literal">HTTP_PROXY</code> as an example environment variable.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								A cluster with cluster-wide egress proxy enabled.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Edit the <code class="literal">watches.yaml</code> file to include overrides based on an environment variable by adding the <code class="literal">overrideValues</code> field:
							</p><pre class="programlisting language-yaml">...
- group: demo.example.com
  version: v1alpha1
  kind: Nginx
  chart: helm-charts/nginx
  overrideValues:
    proxy.http: $HTTP_PROXY
...</pre></li><li class="listitem"><p class="simpara">
								Add the <code class="literal">proxy.http</code> value in the <code class="literal">helm-charts/nginx/values.yaml</code> file:
							</p><pre class="programlisting language-yaml">...
proxy:
  http: ""
  https: ""
  no_proxy: ""</pre></li><li class="listitem"><p class="simpara">
								To make sure the chart template supports using the variables, edit the chart template in the <code class="literal">helm-charts/nginx/templates/deployment.yaml</code> file to contain the following:
							</p><pre class="programlisting language-yaml">containers:
  - name: {{ .Chart.Name }}
    securityContext:
      - toYaml {{ .Values.securityContext | nindent 12 }}
    image: "{{ .Values.image.repository }}:{{ .Values.image.tag | default .Chart.AppVersion }}"
    imagePullPolicy: {{ .Values.image.pullPolicy }}
    env:
      - name: http_proxy
        value: "{{ .Values.proxy.http }}"</pre></li><li class="listitem"><p class="simpara">
								Set the environment variable on the Operator deployment by adding the following to the <code class="literal">config/manager/manager.yaml</code> file:
							</p><pre class="programlisting language-yaml">containers:
 - args:
   - --leader-elect
   - --leader-election-id=ansible-proxy-demo
   image: controller:latest
   name: manager
   env:
     - name: "HTTP_PROXY"
       value: "http_proxy_test"</pre></li></ol></div></section><section class="section" id="osdk-run-operator_osdk-helm-tutorial"><div class="titlepage"><div><div><h4 class="title">5.5.2.5. Running the Operator</h4></div></div></div><p>
						There are three ways you can use the Operator SDK CLI to build and run your Operator:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Run locally outside the cluster as a Go program.
							</li><li class="listitem">
								Run as a deployment on the cluster.
							</li><li class="listitem">
								Bundle your Operator and use Operator Lifecycle Manager (OLM) to deploy on the cluster.
							</li></ul></div><section class="section" id="osdk-run-locally_osdk-helm-tutorial"><div class="titlepage"><div><div><h5 class="title">5.5.2.5.1. Running locally outside the cluster</h5></div></div></div><p>
							You can run your Operator project as a Go program outside of the cluster. This is useful for development purposes to speed up deployment and testing.
						</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Run the following command to install the custom resource definitions (CRDs) in the cluster configured in your <code class="literal">~/.kube/config</code> file and run the Operator locally:
								</p><pre class="programlisting language-terminal">$ make install run</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">...
{"level":"info","ts":1612652419.9289865,"logger":"controller-runtime.metrics","msg":"metrics server is starting to listen","addr":":8080"}
{"level":"info","ts":1612652419.9296563,"logger":"helm.controller","msg":"Watching resource","apiVersion":"demo.example.com/v1","kind":"Nginx","namespace":"","reconcilePeriod":"1m0s"}
{"level":"info","ts":1612652419.929983,"logger":"controller-runtime.manager","msg":"starting metrics server","path":"/metrics"}
{"level":"info","ts":1612652419.930015,"logger":"controller-runtime.manager.controller.nginx-controller","msg":"Starting EventSource","source":"kind source: demo.example.com/v1, Kind=Nginx"}
{"level":"info","ts":1612652420.2307851,"logger":"controller-runtime.manager.controller.nginx-controller","msg":"Starting Controller"}
{"level":"info","ts":1612652420.2309358,"logger":"controller-runtime.manager.controller.nginx-controller","msg":"Starting workers","worker count":8}</pre>

									</p></div></li></ul></div></section><section class="section" id="osdk-run-deployment_osdk-helm-tutorial"><div class="titlepage"><div><div><h5 class="title">5.5.2.5.2. Running as a deployment on the cluster</h5></div></div></div><p>
							You can run your Operator project as a deployment on your cluster.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Run the following <code class="literal">make</code> commands to build and push the Operator image. Modify the <code class="literal">IMG</code> argument in the following steps to reference a repository that you have access to. You can obtain an account for storing containers at repository sites such as Quay.io.
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Build the image:
										</p><pre class="programlisting language-terminal">$ make docker-build IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												The Dockerfile generated by the SDK for the Operator explicitly references <code class="literal">GOARCH=amd64</code> for <code class="literal">go build</code>. This can be amended to <code class="literal">GOARCH=$TARGETARCH</code> for non-AMD64 architectures. Docker will automatically set the environment variable to the value specified by <code class="literal">–platform</code>. With Buildah, the <code class="literal">–build-arg</code> will need to be used for the purpose. For more information, see <a class="link" href="https://sdk.operatorframework.io/docs/advanced-topics/multi-arch/#supporting-multiple-architectures">Multiple Architectures</a>.
											</p></div></div></li><li class="listitem"><p class="simpara">
											Push the image to a repository:
										</p><pre class="programlisting language-terminal">$ make docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												The name and tag of the image, for example <code class="literal">IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</code>, in both the commands can also be set in your Makefile. Modify the <code class="literal">IMG ?= controller:latest</code> value to set your default image name.
											</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
									Run the following command to deploy the Operator:
								</p><pre class="programlisting language-terminal">$ make deploy IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><p class="simpara">
									By default, this command creates a namespace with the name of your Operator project in the form <code class="literal">&lt;project_name&gt;-system</code> and is used for the deployment. This command also installs the RBAC manifests from <code class="literal">config/rbac</code>.
								</p></li><li class="listitem"><p class="simpara">
									Run the following command to verify that the Operator is running:
								</p><pre class="programlisting language-terminal">$ oc get deployment -n &lt;project_name&gt;-system</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME                                    READY   UP-TO-DATE   AVAILABLE   AGE
&lt;project_name&gt;-controller-manager       1/1     1            1           8m</pre>

									</p></div></li></ol></div></section><section class="section" id="osdk-bundle-deploy-olm_osdk-helm-tutorial"><div class="titlepage"><div><div><h5 class="title">5.5.2.5.3. Bundling an Operator and deploying with Operator Lifecycle Manager</h5></div></div></div><section class="section" id="osdk-bundle-operator_osdk-helm-tutorial"><div class="titlepage"><div><div><h6 class="title">5.5.2.5.3.1. Bundling an Operator</h6></div></div></div><p>
								The Operator bundle format is the default packaging method for Operator SDK and Operator Lifecycle Manager (OLM). You can get your Operator ready for use on OLM by using the Operator SDK to build and push your Operator project as a bundle image.
							</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
										Operator SDK CLI installed on a development workstation
									</li><li class="listitem">
										OpenShift CLI (<code class="literal">oc</code>) v4.13+ installed
									</li><li class="listitem">
										Operator project initialized by using the Operator SDK
									</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
										Run the following <code class="literal">make</code> commands in your Operator project directory to build and push your Operator image. Modify the <code class="literal">IMG</code> argument in the following steps to reference a repository that you have access to. You can obtain an account for storing containers at repository sites such as Quay.io.
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
												Build the image:
											</p><pre class="programlisting language-terminal">$ make docker-build IMG=&lt;registry&gt;/&lt;user&gt;/&lt;operator_image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
													The Dockerfile generated by the SDK for the Operator explicitly references <code class="literal">GOARCH=amd64</code> for <code class="literal">go build</code>. This can be amended to <code class="literal">GOARCH=$TARGETARCH</code> for non-AMD64 architectures. Docker will automatically set the environment variable to the value specified by <code class="literal">–platform</code>. With Buildah, the <code class="literal">–build-arg</code> will need to be used for the purpose. For more information, see <a class="link" href="https://sdk.operatorframework.io/docs/advanced-topics/multi-arch/#supporting-multiple-architectures">Multiple Architectures</a>.
												</p></div></div></li><li class="listitem"><p class="simpara">
												Push the image to a repository:
											</p><pre class="programlisting language-terminal">$ make docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;operator_image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li><li class="listitem"><p class="simpara">
										Create your Operator bundle manifest by running the <code class="literal">make bundle</code> command, which invokes several commands, including the Operator SDK <code class="literal">generate bundle</code> and <code class="literal">bundle validate</code> subcommands:
									</p><pre class="programlisting language-terminal">$ make bundle IMG=&lt;registry&gt;/&lt;user&gt;/&lt;operator_image_name&gt;:&lt;tag&gt;</pre><p class="simpara">
										Bundle manifests for an Operator describe how to display, create, and manage an application. The <code class="literal">make bundle</code> command creates the following files and directories in your Operator project:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												A bundle manifests directory named <code class="literal">bundle/manifests</code> that contains a <code class="literal">ClusterServiceVersion</code> object
											</li><li class="listitem">
												A bundle metadata directory named <code class="literal">bundle/metadata</code>
											</li><li class="listitem">
												All custom resource definitions (CRDs) in a <code class="literal">config/crd</code> directory
											</li><li class="listitem">
												A Dockerfile <code class="literal">bundle.Dockerfile</code>
											</li></ul></div><p class="simpara">
										These files are then automatically validated by using <code class="literal">operator-sdk bundle validate</code> to ensure the on-disk bundle representation is correct.
									</p></li><li class="listitem"><p class="simpara">
										Build and push your bundle image by running the following commands. OLM consumes Operator bundles using an index image, which reference one or more bundle images.
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
												Build the bundle image. Set <code class="literal">BUNDLE_IMG</code> with the details for the registry, user namespace, and image tag where you intend to push the image:
											</p><pre class="programlisting language-terminal">$ make bundle-build BUNDLE_IMG=&lt;registry&gt;/&lt;user&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt;</pre></li><li class="listitem"><p class="simpara">
												Push the bundle image:
											</p><pre class="programlisting language-terminal">$ docker push &lt;registry&gt;/&lt;user&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li></ol></div></section><section class="section" id="osdk-deploy-olm_osdk-helm-tutorial"><div class="titlepage"><div><div><h6 class="title">5.5.2.5.3.2. Deploying an Operator with Operator Lifecycle Manager</h6></div></div></div><p>
								Operator Lifecycle Manager (OLM) helps you to install, update, and manage the lifecycle of Operators and their associated services on a Kubernetes cluster. OLM is installed by default on OpenShift Container Platform and runs as a Kubernetes extension so that you can use the web console and the OpenShift CLI (<code class="literal">oc</code>) for all Operator lifecycle management functions without any additional tools.
							</p><p>
								The Operator bundle format is the default packaging method for Operator SDK and OLM. You can use the Operator SDK to quickly run a bundle image on OLM to ensure that it runs properly.
							</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
										Operator SDK CLI installed on a development workstation
									</li><li class="listitem">
										Operator bundle image built and pushed to a registry
									</li><li class="listitem">
										OLM installed on a Kubernetes-based cluster (v1.16.0 or later if you use <code class="literal">apiextensions.k8s.io/v1</code> CRDs, for example OpenShift Container Platform 4.13)
									</li><li class="listitem">
										Logged in to the cluster with <code class="literal">oc</code> using an account with <code class="literal">cluster-admin</code> permissions
									</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Enter the following command to run the Operator on the cluster:
									</p><pre class="programlisting language-terminal">$ operator-sdk run bundle \<span id="CO59-1"><!--Empty--></span><span class="callout">1</span>
    -n &lt;namespace&gt; \<span id="CO59-2"><!--Empty--></span><span class="callout">2</span>
    &lt;registry&gt;/&lt;user&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt; <span id="CO59-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO59-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												The <code class="literal">run bundle</code> command creates a valid file-based catalog and installs the Operator bundle on your cluster using OLM.
											</div></dd><dt><a href="#CO59-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												Optional: By default, the command installs the Operator in the currently active project in your <code class="literal">~/.kube/config</code> file. You can add the <code class="literal">-n</code> flag to set a different namespace scope for the installation.
											</div></dd><dt><a href="#CO59-3"><span class="callout">3</span></a> </dt><dd><div class="para">
												If you do not specify an image, the command uses <code class="literal">quay.io/operator-framework/opm:latest</code> as the default index image. If you specify an image, the command uses the bundle image itself as the index image.
											</div></dd></dl></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
											As of OpenShift Container Platform 4.11, the <code class="literal">run bundle</code> command supports the file-based catalog format for Operator catalogs by default. The deprecated SQLite database format for Operator catalogs continues to be supported; however, it will be removed in a future release. It is recommended that Operator authors migrate their workflows to the file-based catalog format.
										</p></div></div><p class="simpara">
										This command performs the following actions:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												Create an index image referencing your bundle image. The index image is opaque and ephemeral, but accurately reflects how a bundle would be added to a catalog in production.
											</li><li class="listitem">
												Create a catalog source that points to your new index image, which enables OperatorHub to discover your Operator.
											</li><li class="listitem">
												Deploy your Operator to your cluster by creating an <code class="literal">OperatorGroup</code>, <code class="literal">Subscription</code>, <code class="literal">InstallPlan</code>, and all other required resources, including RBAC.
											</li></ul></div></li></ul></div></section></section></section><section class="section" id="osdk-create-cr_osdk-helm-tutorial"><div class="titlepage"><div><div><h4 class="title">5.5.2.6. Creating a custom resource</h4></div></div></div><p>
						After your Operator is installed, you can test it by creating a custom resource (CR) that is now provided on the cluster by the Operator.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Example Nginx Operator, which provides the <code class="literal">Nginx</code> CR, installed on a cluster
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Change to the namespace where your Operator is installed. For example, if you deployed the Operator using the <code class="literal">make deploy</code> command:
							</p><pre class="programlisting language-terminal">$ oc project nginx-operator-system</pre></li><li class="listitem"><p class="simpara">
								Edit the sample <code class="literal">Nginx</code> CR manifest at <code class="literal">config/samples/demo_v1_nginx.yaml</code> to contain the following specification:
							</p><pre class="programlisting language-yaml">apiVersion: demo.example.com/v1
kind: Nginx
metadata:
  name: nginx-sample
...
spec:
...
  replicaCount: 3</pre></li><li class="listitem"><p class="simpara">
								The Nginx service account requires privileged access to run in OpenShift Container Platform. Add the following security context constraint (SCC) to the service account for the <code class="literal">nginx-sample</code> pod:
							</p><pre class="programlisting language-terminal">$ oc adm policy add-scc-to-user \
    anyuid system:serviceaccount:nginx-operator-system:nginx-sample</pre></li><li class="listitem"><p class="simpara">
								Create the CR:
							</p><pre class="programlisting language-terminal">$ oc apply -f config/samples/demo_v1_nginx.yaml</pre></li><li class="listitem"><p class="simpara">
								Ensure that the <code class="literal">Nginx</code> Operator creates the deployment for the sample CR with the correct size:
							</p><pre class="programlisting language-terminal">$ oc get deployments</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                    READY   UP-TO-DATE   AVAILABLE   AGE
nginx-operator-controller-manager       1/1     1            1           8m
nginx-sample                            3/3     3            3           1m</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Check the pods and CR status to confirm the status is updated with the Nginx pod names.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Check the pods:
									</p><pre class="programlisting language-terminal">$ oc get pods</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-terminal">NAME                                  READY     STATUS    RESTARTS   AGE
nginx-sample-6fd7c98d8-7dqdr          1/1       Running   0          1m
nginx-sample-6fd7c98d8-g5k7v          1/1       Running   0          1m
nginx-sample-6fd7c98d8-m7vn7          1/1       Running   0          1m</pre>

										</p></div></li><li class="listitem"><p class="simpara">
										Check the CR status:
									</p><pre class="programlisting language-terminal">$ oc get nginx/nginx-sample -o yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-yaml">apiVersion: demo.example.com/v1
kind: Nginx
metadata:
...
  name: nginx-sample
...
spec:
  replicaCount: 3
status:
  nodes:
  - nginx-sample-6fd7c98d8-7dqdr
  - nginx-sample-6fd7c98d8-g5k7v
  - nginx-sample-6fd7c98d8-m7vn7</pre>

										</p></div></li></ol></div></li><li class="listitem"><p class="simpara">
								Update the deployment size.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Update <code class="literal">config/samples/demo_v1_nginx.yaml</code> file to change the <code class="literal">spec.size</code> field in the <code class="literal">Nginx</code> CR from <code class="literal">3</code> to <code class="literal">5</code>:
									</p><pre class="programlisting language-terminal">$ oc patch nginx nginx-sample \
    -p '{"spec":{"replicaCount": 5}}' \
    --type=merge</pre></li><li class="listitem"><p class="simpara">
										Confirm that the Operator changes the deployment size:
									</p><pre class="programlisting language-terminal">$ oc get deployments</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-terminal">NAME                                    READY   UP-TO-DATE   AVAILABLE   AGE
nginx-operator-controller-manager       1/1     1            1           10m
nginx-sample                            5/5     5            5           3m</pre>

										</p></div></li></ol></div></li><li class="listitem"><p class="simpara">
								Delete the CR by running the following command:
							</p><pre class="programlisting language-terminal">$ oc delete -f config/samples/demo_v1_nginx.yaml</pre></li><li class="listitem"><p class="simpara">
								Clean up the resources that have been created as part of this tutorial.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										If you used the <code class="literal">make deploy</code> command to test the Operator, run the following command:
									</p><pre class="programlisting language-terminal">$ make undeploy</pre></li><li class="listitem"><p class="simpara">
										If you used the <code class="literal">operator-sdk run bundle</code> command to test the Operator, run the following command:
									</p><pre class="programlisting language-terminal">$ operator-sdk cleanup &lt;project_name&gt;</pre></li></ul></div></li></ol></div></section><section class="section _additional-resources" id="osdk-helm-tutorial-addtl-resources"><div class="titlepage"><div><div><h4 class="title">5.5.2.7. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-helm-project-layout">Project layout for Helm-based Operators</a> to learn about the directory structures created by the Operator SDK.
							</li><li class="listitem">
								If a <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#enable-cluster-wide-proxy">cluster-wide egress proxy is configured</a>, cluster administrators can <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-configuring-proxy-support">override the proxy settings or inject a custom CA certificate</a> for specific Operators running on Operator Lifecycle Manager (OLM).
							</li></ul></div></section></section><section class="section" id="osdk-helm-project-layout"><div class="titlepage"><div><div><h3 class="title">5.5.3. Project layout for Helm-based Operators</h3></div></div></div><p>
					The <code class="literal">operator-sdk</code> CLI can generate, or <span class="emphasis"><em>scaffold</em></span>, a number of packages and files for each Operator project.
				</p><section class="section" id="osdk-helm-project-layout_osdk-helm-project-layout"><div class="titlepage"><div><div><h4 class="title">5.5.3.1. Helm-based project layout</h4></div></div></div><p>
						Helm-based Operator projects generated using the <code class="literal">operator-sdk init --plugins helm</code> command contain the following directories and files:
					</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 80%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731977813920" scope="col">File/folders</th><th align="left" valign="top" id="idm139731977812832" scope="col">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731977813920"> <p>
										<code class="literal">config/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977812832"> <p>
										<a class="link" href="https://kustomize.io/">Kustomize</a> manifests for deploying the Operator on a Kubernetes cluster.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977813920"> <p>
										<code class="literal">helm-charts/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977812832"> <p>
										Helm chart initialized with the <code class="literal">operator-sdk create api</code> command.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977813920"> <p>
										<code class="literal">Dockerfile</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977812832"> <p>
										Used to build the Operator image with the <code class="literal">make docker-build</code> command.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977813920"> <p>
										<code class="literal">watches.yaml</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977812832"> <p>
										Group/version/kind (GVK) and Helm chart location.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977813920"> <p>
										<code class="literal">Makefile</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977812832"> <p>
										Targets used to manage the project.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977813920"> <p>
										<code class="literal">PROJECT</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977812832"> <p>
										YAML file containing metadata information for the Operator.
									</p>
									 </td></tr></tbody></table></div></section></section><section class="section" id="osdk-helm-updating-projects"><div class="titlepage"><div><div><h3 class="title">5.5.4. Updating Helm-based projects for newer Operator SDK versions</h3></div></div></div><p>
					OpenShift Container Platform 4.13 supports Operator SDK 1.28.0. If you already have the 1.25.4 CLI installed on your workstation, you can update the CLI to 1.28.0 by <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-installing-cli">installing the latest version</a>.
				</p><p>
					However, to ensure your existing Operator projects maintain compatibility with Operator SDK 1.28.0, update steps are required for the associated breaking changes introduced since 1.25.4. You must perform the update steps manually in any of your Operator projects that were previously created or maintained with 1.25.4.
				</p><section class="section" id="osdk-upgrading-projects_osdk-helm-updating-projects"><div class="titlepage"><div><div><h4 class="title">5.5.4.1. Updating Helm-based Operator projects for Operator SDK 1.28.0</h4></div></div></div><p>
						The following procedure updates an existing Helm-based Operator project for compatibility with 1.28.0.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Operator SDK 1.28.0 installed
							</li><li class="listitem">
								An Operator project created or maintained with Operator SDK 1.25.4
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Update the image tag in your Operator’s Dockerfile as shown in the following example:
							</p><div class="formalpara"><p class="title"><strong>Example Dockerfile</strong></p><p>
									
<pre class="programlisting language-docker">FROM registry.redhat.io/openshift4/ose-helm-operator:v4.13 <span id="CO60-1"><!--Empty--></span><span class="callout">1</span></pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO60-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Update the version tag to <code class="literal">v4.13</code>.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Find the <code class="literal">ose-kube-rbac-proxy</code> pull spec in the following files, and update the image tag to <code class="literal">v4.13</code>:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">config/default/manager_auth_proxy_patch.yaml</code>
									</li><li class="listitem">
										<code class="literal">bundle/manifests/memcached-operator.clusterserviceversion.yaml</code>
									</li></ul></div><pre class="programlisting language-yaml">…
      containers:
      - name: kube-rbac-proxy
        image: registry.redhat.io/openshift4/ose-kube-rbac-proxy:v4.13 <span id="CO61-1"><!--Empty--></span><span class="callout">1</span>
…</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO61-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Update the tag version from <code class="literal">v4.12</code> to <code class="literal">v4.13</code>.
									</div></dd></dl></div></li></ol></div></section><section class="section _additional-resources" id="additional-resources_osdk-helm-upgrading-projects"><div class="titlepage"><div><div><h4 class="title">5.5.4.2. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-pkgman-to-bundle">Migrating package manifest projects to bundle format</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.10/html-single/operators/index#osdk-upgrading-v1101-to-v1160_osdk-upgrading-projects">Upgrading projects for Operator SDK 1.16.0</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.9/html/operators/developing-operators#osdk-upgrading-v180-to-v1101_osdk-upgrading-projects">Upgrading projects for Operator SDK v1.10.1</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.8/html/operators/developing-operators#osdk-upgrading-v130-to-v180_osdk-upgrading-projects">Upgrading projects for Operator SDK v1.8.0</a>
							</li></ul></div></section></section><section class="section" id="osdk-helm-support"><div class="titlepage"><div><div><h3 class="title">5.5.5. Helm support in Operator SDK</h3></div></div></div><section class="section" id="osdk-helm-charts_osdk-helm-support"><div class="titlepage"><div><div><h4 class="title">5.5.5.1. Helm charts</h4></div></div></div><p>
						One of the Operator SDK options for generating an Operator project includes leveraging an existing Helm chart to deploy Kubernetes resources as a unified application, without having to write any Go code. Such Helm-based Operators are designed to excel at stateless applications that require very little logic when rolled out, because changes should be applied to the Kubernetes objects that are generated as part of the chart. This may sound limiting, but can be sufficient for a surprising amount of use-cases as shown by the proliferation of Helm charts built by the Kubernetes community.
					</p><p>
						The main function of an Operator is to read from a custom object that represents your application instance and have its desired state match what is running. In the case of a Helm-based Operator, the <code class="literal">spec</code> field of the object is a list of configuration options that are typically described in the Helm <code class="literal">values.yaml</code> file. Instead of setting these values with flags using the Helm CLI (for example, <code class="literal">helm install -f values.yaml</code>), you can express them within a custom resource (CR), which, as a native Kubernetes object, enables the benefits of RBAC applied to it and an audit trail.
					</p><p>
						For an example of a simple CR called <code class="literal">Tomcat</code>:
					</p><pre class="programlisting language-yaml">apiVersion: apache.org/v1alpha1
kind: Tomcat
metadata:
  name: example-app
spec:
  replicaCount: 2</pre><p>
						The <code class="literal">replicaCount</code> value, <code class="literal">2</code> in this case, is propagated into the template of the chart where the following is used:
					</p><pre class="programlisting language-yaml">{{ .Values.replicaCount }}</pre><p>
						After an Operator is built and deployed, you can deploy a new instance of an app by creating a new instance of a CR, or list the different instances running in all environments using the <code class="literal">oc</code> command:
					</p><pre class="programlisting language-terminal">$ oc get Tomcats --all-namespaces</pre><p>
						There is no requirement use the Helm CLI or install Tiller; Helm-based Operators import code from the Helm project. All you have to do is have an instance of the Operator running and register the CR with a custom resource definition (CRD). Because it obeys RBAC, you can more easily prevent production changes.
					</p></section></section><section class="section" id="osdk-hybrid-helm"><div class="titlepage"><div><div><h3 class="title">5.5.6. Operator SDK tutorial for Hybrid Helm Operators</h3></div></div></div><p>
					The standard Helm-based Operator support in the Operator SDK has limited functionality compared to the Go-based and Ansible-based Operator support that has reached the Auto Pilot capability (level V) in the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-maturity-model_olm-what-operators-are">Operator maturity model</a>.
				</p><p>
					The Hybrid Helm Operator enhances the existing Helm-based support’s abilities through Go APIs. With this hybrid approach of Helm and Go, the Operator SDK enables Operator authors to use the following process:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Generate a default structure for, or <span class="emphasis"><em>scaffold</em></span>, a Go API in the same project as Helm.
						</li><li class="listitem">
							Configure the Helm reconciler in the <code class="literal">main.go</code> file of the project, through the libraries provided by the Hybrid Helm Operator.
						</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The Hybrid Helm Operator is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
					</p><p>
						For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
					</p></div></div><p>
					This tutorial walks through the following process using the Hybrid Helm Operator:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Create a <code class="literal">Memcached</code> deployment through a Helm chart if it does not exist
						</li><li class="listitem">
							Ensure that the deployment size is the same as specified by <code class="literal">Memcached</code> custom resource (CR) spec
						</li><li class="listitem">
							Create a <code class="literal">MemcachedBackup</code> deployment by using the Go API
						</li></ul></div><section class="section" id="osdk-common-prereqs_osdk-hybrid-helm"><div class="titlepage"><div><div><h4 class="title">5.5.6.1. Prerequisites</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Operator SDK CLI installed
							</li><li class="listitem">
								OpenShift CLI (<code class="literal">oc</code>) v4.13+ installed
							</li><li class="listitem">
								Logged into an OpenShift Container Platform 4.13 cluster with <code class="literal">oc</code> with an account that has <code class="literal">cluster-admin</code> permissions
							</li><li class="listitem">
								To allow the cluster to pull the image, the repository where you push your image must be set as public, or you must configure an image pull secret
							</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-installing-cli">Installing the Operator SDK CLI</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cli_tools/#getting-started-cli">Getting started with the OpenShift CLI</a>
							</li></ul></div></section><section class="section" id="osdk-hh-create-project_osdk-hybrid-helm"><div class="titlepage"><div><div><h4 class="title">5.5.6.2. Creating a project</h4></div></div></div><p>
						Use the Operator SDK CLI to create a project called <code class="literal">memcached-operator</code>.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a directory for the project:
							</p><pre class="programlisting language-terminal">$ mkdir -p $HOME/github.com/example/memcached-operator</pre></li><li class="listitem"><p class="simpara">
								Change to the directory:
							</p><pre class="programlisting language-terminal">$ cd $HOME/github.com/example/memcached-operator</pre></li><li class="listitem"><p class="simpara">
								Run the <code class="literal">operator-sdk init</code> command to initialize the project. Use a domain of <code class="literal">example.com</code> so that all API groups are <code class="literal">&lt;group&gt;.example.com</code>:
							</p><pre class="programlisting language-terminal">$ operator-sdk init \
    --plugins=hybrid.helm.sdk.operatorframework.io \
    --project-version="3" \
    --domain example.com \
    --repo=github.com/example/memcached-operator</pre><p class="simpara">
								The <code class="literal">init</code> command generates the RBAC rules in the <code class="literal">config/rbac/role.yaml</code> file based on the resources that would be deployed by the chart’s default manifests. Verify that the rules generated in the <code class="literal">config/rbac/role.yaml</code> file meet your Operator’s permission requirements.
							</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								This procedure creates a project structure that is compatible with both Helm and Go APIs. To learn more about the project directory structure, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-hh-project-layout_osdk-hybrid-helm">Project layout</a>.
							</li></ul></div></section><section class="section" id="osdk-hh-create-helm-api_osdk-hybrid-helm"><div class="titlepage"><div><div><h4 class="title">5.5.6.3. Creating a Helm API</h4></div></div></div><p>
						Use the Operator SDK CLI to create a Helm API.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Run the following command to create a Helm API with group <code class="literal">cache</code>, version <code class="literal">v1</code>, and kind <code class="literal">Memcached</code>:
							</p><pre class="programlisting language-terminal">$ operator-sdk create api \
    --plugins helm.sdk.operatorframework.io/v1 \
    --group cache \
    --version v1 \
    --kind Memcached</pre></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							This procedure also configures your Operator project to watch the <code class="literal">Memcached</code> resource with API version <code class="literal">v1</code> and scaffolds a boilerplate Helm chart. Instead of creating the project from the boilerplate Helm chart scaffolded by the Operator SDK, you can alternatively use an existing chart from your local file system or remote chart repository.
						</p><p>
							For more details and examples for creating Helm API based on existing or new charts, run the following command:
						</p><pre class="programlisting language-terminal">$ operator-sdk create api --plugins helm.sdk.operatorframework.io/v1 --help</pre></div></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-helm-existing-chart_osdk-helm-tutorial">Existing Helm charts</a>
							</li></ul></div><section class="section" id="osdk-hh-helm-api-logic_osdk-hybrid-helm"><div class="titlepage"><div><div><h5 class="title">5.5.6.3.1. Operator logic for the Helm API</h5></div></div></div><p>
							By default, your scaffolded Operator project watches <code class="literal">Memcached</code> resource events as shown in the <code class="literal">watches.yaml</code> file and executes Helm releases using the specified chart.
						</p><div class="example" id="idm139731975999616"><p class="title"><strong>Example 5.2. Example <code class="literal">watches.yaml</code> file</strong></p><div class="example-contents"><pre class="programlisting language-yaml"># Use the 'create api' subcommand to add watches to this file.
- group: cache.my.domain
  version: v1
  kind: Memcached
  chart: helm-charts/memcached
#+kubebuilder:scaffold:watch</pre></div></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									For detailed documentation on customizing the Helm Operator logic through the chart, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-helm-logic_osdk-helm-tutorial">Understanding the Operator logic</a>.
								</li></ul></div></section><section class="section" id="osdk-hh-helm-reconciler_osdk-hybrid-helm"><div class="titlepage"><div><div><h5 class="title">5.5.6.3.2. Custom Helm reconciler configurations using provided library APIs</h5></div></div></div><p>
							A disadvantage of existing Helm-based Operators is the inability to configure the Helm reconciler, because it is abstracted from users. For a Helm-based Operator to reach the Seamless Upgrades capability (level II and later) that reuses an already existing Helm chart, a hybrid between the Go and Helm Operator types adds value.
						</p><p>
							The APIs provided in the <a class="link" href="https://github.com/operator-framework/helm-operator-plugins"><code class="literal">helm-operator-plugins</code></a> library allow Operator authors to make the following configurations:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Customize value mapping based on cluster state
								</li><li class="listitem">
									Execute code in specific events by configuring the reconciler’s event recorder
								</li><li class="listitem">
									Customize the reconciler’s logger
								</li><li class="listitem">
									Setup <code class="literal">Install</code>, <code class="literal">Upgrade</code>, and <code class="literal">Uninstall</code> annotations to enable Helm’s actions to be configured based on the annotations found in custom resources watched by the reconciler
								</li><li class="listitem">
									Configure the reconciler to run with <code class="literal">Pre</code> and <code class="literal">Post</code> hooks
								</li></ul></div><p>
							The above configurations to the reconciler can be done in the <code class="literal">main.go</code> file:
						</p><div class="informalexample"><div class="formalpara"><p class="title"><strong>Example <code class="literal">main.go</code> file</strong></p><p>
								
<pre class="programlisting language-golang">// Operator's main.go
// With the help of helpers provided in the library, the reconciler can be
// configured here before starting the controller with this reconciler.
reconciler := reconciler.New(
 reconciler.WithChart(*chart),
 reconciler.WithGroupVersionKind(gvk),
)

if err := reconciler.SetupWithManager(mgr); err != nil {
 panic(fmt.Sprintf("unable to create reconciler: %s", err))
}</pre>

							</p></div></div></section></section><section class="section" id="osdk-hh-create-go-api_osdk-hybrid-helm"><div class="titlepage"><div><div><h4 class="title">5.5.6.4. Creating a Go API</h4></div></div></div><p>
						Use the Operator SDK CLI to create a Go API.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Run the following command to create a Go API with group <code class="literal">cache</code>, version <code class="literal">v1</code>, and kind <code class="literal">MemcachedBackup</code>:
							</p><pre class="programlisting language-terminal">$ operator-sdk create api \
    --group=cache \
    --version v1 \
    --kind MemcachedBackup \
    --resource \
    --controller \
    --plugins=go/v3</pre></li><li class="listitem"><p class="simpara">
								When prompted, enter <code class="literal">y</code> for creating both resource and controller:
							</p><pre class="programlisting language-terminal">$ Create Resource [y/n]
y
Create Controller [y/n]
y</pre></li></ol></div><p>
						This procedure generates the <code class="literal">MemcachedBackup</code> resource API at <code class="literal">api/v1/memcachedbackup_types.go</code> and the controller at <code class="literal">controllers/memcachedbackup_controller.go</code>.
					</p><section class="section" id="osdk-hh-defining-go-api_osdk-hybrid-helm"><div class="titlepage"><div><div><h5 class="title">5.5.6.4.1. Defining the API</h5></div></div></div><p>
							Define the API for the <code class="literal">MemcachedBackup</code> custom resource (CR).
						</p><p>
							Represent this Go API by defining the <code class="literal">MemcachedBackup</code> type, which will have a <code class="literal">MemcachedBackupSpec.Size</code> field to set the quantity of Memcached backup instances (CRs) to be deployed, and a <code class="literal">MemcachedBackupStatus.Nodes</code> field to store a CR’s pod names.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The <code class="literal">Node</code> field is used to illustrate an example of a <code class="literal">Status</code> field.
							</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Define the API for the <code class="literal">MemcachedBackup</code> CR by modifying the Go type definitions in the <code class="literal">api/v1/memcachedbackup_types.go</code> file to have the following <code class="literal">spec</code> and <code class="literal">status</code>:
								</p><div class="example" id="idm139731975360624"><p class="title"><strong>Example 5.3. Example <code class="literal">api/v1/memcachedbackup_types.go</code> file</strong></p><div class="example-contents"><pre class="programlisting language-golang">// MemcachedBackupSpec defines the desired state of MemcachedBackup
type MemcachedBackupSpec struct {
	// INSERT ADDITIONAL SPEC FIELDS - desired state of cluster
	// Important: Run "make" to regenerate code after modifying this file

	//+kubebuilder:validation:Minimum=0
	// Size is the size of the memcached deployment
	Size int32 `json:"size"`
}

// MemcachedBackupStatus defines the observed state of MemcachedBackup
type MemcachedBackupStatus struct {
	// INSERT ADDITIONAL STATUS FIELD - define observed state of cluster
	// Important: Run "make" to regenerate code after modifying this file
	// Nodes are the names of the memcached pods
	Nodes []string `json:"nodes"`
}</pre></div></div></li><li class="listitem"><p class="simpara">
									Update the generated code for the resource type:
								</p><pre class="programlisting language-terminal">$ make generate</pre><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
									After you modify a <code class="literal">*_types.go</code> file, you must run the <code class="literal">make generate</code> command to update the generated code for that resource type.
								</p></div></div></li><li class="listitem"><p class="simpara">
									After the API is defined with <code class="literal">spec</code> and <code class="literal">status</code> fields and CRD validation markers, generate and update the CRD manifests:
								</p><pre class="programlisting language-terminal">$ make manifests</pre></li></ol></div><p>
							This Makefile target invokes the <code class="literal">controller-gen</code> utility to generate the CRD manifests in the <code class="literal">config/crd/bases/cache.my.domain_memcachedbackups.yaml</code> file.
						</p></section><section class="section" id="osdk-hh-implement-controller_osdk-hybrid-helm"><div class="titlepage"><div><div><h5 class="title">5.5.6.4.2. Controller implementation</h5></div></div></div><p>
							The controller in this tutorial performs the following actions:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Create a <code class="literal">Memcached</code> deployment if it does not exist.
								</li><li class="listitem">
									Ensure that the deployment size is the same as specified by the <code class="literal">Memcached</code> CR spec.
								</li><li class="listitem">
									Update the <code class="literal">Memcached</code> CR status with the names of the <code class="literal">memcached</code> pods.
								</li></ul></div><p>
							For a detailed explanation on how to configure the controller to perform the above mentioned actions, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-golang-implement-controller_osdk-golang-tutorial">Implementing the controller</a> in the Operator SDK tutorial for standard Go-based Operators.
						</p></section><section class="section" id="osdk-hh-main-go_osdk-hybrid-helm"><div class="titlepage"><div><div><h5 class="title">5.5.6.4.3. Differences in main.go</h5></div></div></div><p>
							For standard Go-based Operators and the Hybrid Helm Operator, the <code class="literal">main.go</code> file handles the scaffolding the initialization and running of the <a class="link" href="https://pkg.go.dev/sigs.k8s.io/controller-runtime/pkg/manager#Manager"><code class="literal">Manager</code></a> program for the Go API. For the Hybrid Helm Operator, however, the <code class="literal">main.go</code> file also exposes the logic for loading the <code class="literal">watches.yaml</code> file and configuring the Helm reconciler.
						</p><div class="example" id="idm139731977848656"><p class="title"><strong>Example 5.4. Example <code class="literal">main.go</code> file</strong></p><div class="example-contents"><pre class="programlisting language-terminal">...
	for _, w := range ws {
		// Register controller with the factory
		reconcilePeriod := defaultReconcilePeriod
		if w.ReconcilePeriod != nil {
			reconcilePeriod = w.ReconcilePeriod.Duration
		}

		maxConcurrentReconciles := defaultMaxConcurrentReconciles
		if w.MaxConcurrentReconciles != nil {
			maxConcurrentReconciles = *w.MaxConcurrentReconciles
		}

		r, err := reconciler.New(
			reconciler.WithChart(*w.Chart),
			reconciler.WithGroupVersionKind(w.GroupVersionKind),
			reconciler.WithOverrideValues(w.OverrideValues),
			reconciler.SkipDependentWatches(w.WatchDependentResources != nil &amp;&amp; !*w.WatchDependentResources),
			reconciler.WithMaxConcurrentReconciles(maxConcurrentReconciles),
			reconciler.WithReconcilePeriod(reconcilePeriod),
			reconciler.WithInstallAnnotations(annotation.DefaultInstallAnnotations...),
			reconciler.WithUpgradeAnnotations(annotation.DefaultUpgradeAnnotations...),
			reconciler.WithUninstallAnnotations(annotation.DefaultUninstallAnnotations...),
		)
...</pre></div></div><p>
							The manager is initialized with both <code class="literal">Helm</code> and <code class="literal">Go</code> reconcilers:
						</p><div class="example" id="idm139731977843472"><p class="title"><strong>Example 5.5. Example <code class="literal">Helm</code> and <code class="literal">Go</code> reconcilers</strong></p><div class="example-contents"><pre class="programlisting language-terminal">...
// Setup manager with Go API
   if err = (&amp;controllers.MemcachedBackupReconciler{
		Client: mgr.GetClient(),
		Scheme: mgr.GetScheme(),
	}).SetupWithManager(mgr); err != nil {
		setupLog.Error(err, "unable to create controller", "controller", "MemcachedBackup")
		os.Exit(1)
	}

   ...
// Setup manager with Helm API
	for _, w := range ws {

      ...
		if err := r.SetupWithManager(mgr); err != nil {
			setupLog.Error(err, "unable to create controller", "controller", "Helm")
			os.Exit(1)
		}
		setupLog.Info("configured watch", "gvk", w.GroupVersionKind, "chartPath", w.ChartPath, "maxConcurrentReconciles", maxConcurrentReconciles, "reconcilePeriod", reconcilePeriod)
	}

// Start the manager
   if err := mgr.Start(ctrl.SetupSignalHandler()); err != nil {
		setupLog.Error(err, "problem running manager")
		os.Exit(1)
	}</pre></div></div></section><section class="section" id="osdk-hh-rbac_osdk-hybrid-helm"><div class="titlepage"><div><div><h5 class="title">5.5.6.4.4. Permissions and RBAC manifests</h5></div></div></div><p>
							The controller requires certain role-based access control (RBAC) permissions to interact with the resources it manages. For the Go API, these are specified with RBAC markers, as shown in the Operator SDK tutorial for standard Go-based Operators.
						</p><p>
							For the Helm API, the permissions are scaffolded by default in <code class="literal">roles.yaml</code>. Currently, however, due to a known issue when the Go API is scaffolded, the permissions for the Helm API are overwritten. As a result of this issue, ensure that the permissions defined in <code class="literal">roles.yaml</code> match your requirements.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								This known issue is being tracked in <a class="link" href="https://github.com/operator-framework/helm-operator-plugins/issues/142">https://github.com/operator-framework/helm-operator-plugins/issues/142</a>.
							</p></div></div><p>
							The following is an example <code class="literal">role.yaml</code> for a Memcached Operator:
						</p><div class="example" id="idm139731977831984"><p class="title"><strong>Example 5.6. Example <code class="literal">Helm</code> and <code class="literal">Go</code> reconcilers</strong></p><div class="example-contents"><pre class="programlisting language-yaml">---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: manager-role
rules:
- apiGroups:
  - ""
  resources:
  - namespaces
  verbs:
  - get
- apiGroups:
  - apps
  resources:
  - deployments
  - daemonsets
  - replicasets
  - statefulsets
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - cache.my.domain
  resources:
  - memcachedbackups
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - cache.my.domain
  resources:
  - memcachedbackups/finalizers
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - ""
  resources:
  - pods
  - services
  - services/finalizers
  - endpoints
  - persistentvolumeclaims
  - events
  - configmaps
  - secrets
  - serviceaccounts
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - cache.my.domain
  resources:
  - memcachedbackups/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - policy
  resources:
  - events
  - poddisruptionbudgets
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - cache.my.domain
  resources:
  - memcacheds
  - memcacheds/status
  - memcacheds/finalizers
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch</pre></div></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-golang-controller-rbac-markers_osdk-golang-tutorial">RBAC markers for Go-based Operators</a>
								</li></ul></div></section></section><section class="section" id="osdk-run-locally_osdk-hybrid-helm"><div class="titlepage"><div><div><h4 class="title">5.5.6.5. Running locally outside the cluster</h4></div></div></div><p>
						You can run your Operator project as a Go program outside of the cluster. This is useful for development purposes to speed up deployment and testing.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Run the following command to install the custom resource definitions (CRDs) in the cluster configured in your <code class="literal">~/.kube/config</code> file and run the Operator locally:
							</p><pre class="programlisting language-terminal">$ make install run</pre></li></ul></div></section><section class="section" id="osdk-run-deployment_osdk-hybrid-helm"><div class="titlepage"><div><div><h4 class="title">5.5.6.6. Running as a deployment on the cluster</h4></div></div></div><p>
						You can run your Operator project as a deployment on your cluster.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Run the following <code class="literal">make</code> commands to build and push the Operator image. Modify the <code class="literal">IMG</code> argument in the following steps to reference a repository that you have access to. You can obtain an account for storing containers at repository sites such as Quay.io.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Build the image:
									</p><pre class="programlisting language-terminal">$ make docker-build IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											The Dockerfile generated by the SDK for the Operator explicitly references <code class="literal">GOARCH=amd64</code> for <code class="literal">go build</code>. This can be amended to <code class="literal">GOARCH=$TARGETARCH</code> for non-AMD64 architectures. Docker will automatically set the environment variable to the value specified by <code class="literal">–platform</code>. With Buildah, the <code class="literal">–build-arg</code> will need to be used for the purpose. For more information, see <a class="link" href="https://sdk.operatorframework.io/docs/advanced-topics/multi-arch/#supporting-multiple-architectures">Multiple Architectures</a>.
										</p></div></div></li><li class="listitem"><p class="simpara">
										Push the image to a repository:
									</p><pre class="programlisting language-terminal">$ make docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											The name and tag of the image, for example <code class="literal">IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</code>, in both the commands can also be set in your Makefile. Modify the <code class="literal">IMG ?= controller:latest</code> value to set your default image name.
										</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
								Run the following command to deploy the Operator:
							</p><pre class="programlisting language-terminal">$ make deploy IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><p class="simpara">
								By default, this command creates a namespace with the name of your Operator project in the form <code class="literal">&lt;project_name&gt;-system</code> and is used for the deployment. This command also installs the RBAC manifests from <code class="literal">config/rbac</code>.
							</p></li><li class="listitem"><p class="simpara">
								Run the following command to verify that the Operator is running:
							</p><pre class="programlisting language-terminal">$ oc get deployment -n &lt;project_name&gt;-system</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                    READY   UP-TO-DATE   AVAILABLE   AGE
&lt;project_name&gt;-controller-manager       1/1     1            1           8m</pre>

								</p></div></li></ol></div></section><section class="section" id="osdk-hh-create-cr_osdk-hybrid-helm"><div class="titlepage"><div><div><h4 class="title">5.5.6.7. Creating custom resources</h4></div></div></div><p>
						After your Operator is installed, you can test it by creating custom resources (CRs) that are now provided on the cluster by the Operator.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Change to the namespace where your Operator is installed:
							</p><pre class="programlisting language-terminal">$ oc project &lt;project_name&gt;-system</pre></li><li class="listitem"><p class="simpara">
								Update the sample <code class="literal">Memcached</code> CR manifest at the <code class="literal">config/samples/cache_v1_memcached.yaml</code> file by updating the <code class="literal">replicaCount</code> field to <code class="literal">3</code>:
							</p><div class="example" id="idm139731974965408"><p class="title"><strong>Example 5.7. Example <code class="literal">config/samples/cache_v1_memcached.yaml</code> file</strong></p><div class="example-contents"><pre class="programlisting language-yaml">apiVersion: cache.my.domain/v1
kind: Memcached
metadata:
  name: memcached-sample
spec:
  # Default values copied from &lt;project_dir&gt;/helm-charts/memcached/values.yaml
  affinity: {}
  autoscaling:
    enabled: false
    maxReplicas: 100
    minReplicas: 1
    targetCPUUtilizationPercentage: 80
  fullnameOverride: ""
  image:
    pullPolicy: IfNotPresent
    repository: nginx
    tag: ""
  imagePullSecrets: []
  ingress:
    annotations: {}
    className: ""
    enabled: false
    hosts:
    - host: chart-example.local
      paths:
      - path: /
        pathType: ImplementationSpecific
    tls: []
  nameOverride: ""
  nodeSelector: {}
  podAnnotations: {}
  podSecurityContext: {}
  replicaCount: 3
  resources: {}
  securityContext: {}
  service:
    port: 80
    type: ClusterIP
  serviceAccount:
    annotations: {}
    create: true
    name: ""
  tolerations: []</pre></div></div></li><li class="listitem"><p class="simpara">
								Create the <code class="literal">Memcached</code> CR:
							</p><pre class="programlisting language-terminal">$ oc apply -f config/samples/cache_v1_memcached.yaml</pre></li><li class="listitem"><p class="simpara">
								Ensure that the Memcached Operator creates the deployment for the sample CR with the correct size:
							</p><pre class="programlisting language-terminal">$ oc get pods</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                  READY     STATUS    RESTARTS   AGE
memcached-sample-6fd7c98d8-7dqdr      1/1       Running   0          18m
memcached-sample-6fd7c98d8-g5k7v      1/1       Running   0          18m
memcached-sample-6fd7c98d8-m7vn7      1/1       Running   0          18m</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Update the sample <code class="literal">MemcachedBackup</code> CR manifest at the <code class="literal">config/samples/cache_v1_memcachedbackup.yaml</code> file by updating the <code class="literal">size</code> to <code class="literal">2</code>:
							</p><div class="example" id="idm139731976846720"><p class="title"><strong>Example 5.8. Example <code class="literal">config/samples/cache_v1_memcachedbackup.yaml</code> file</strong></p><div class="example-contents"><pre class="programlisting language-yaml">apiVersion: cache.my.domain/v1
kind: MemcachedBackup
metadata:
  name: memcachedbackup-sample
spec:
  size: 2</pre></div></div></li><li class="listitem"><p class="simpara">
								Create the <code class="literal">MemcachedBackup</code> CR:
							</p><pre class="programlisting language-terminal">$ oc apply -f config/samples/cache_v1_memcachedbackup.yaml</pre></li><li class="listitem"><p class="simpara">
								Ensure that the count of <code class="literal">memcachedbackup</code> pods is the same as specified in the CR:
							</p><pre class="programlisting language-terminal">$ oc get pods</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">NAME                                        READY     STATUS    RESTARTS   AGE
memcachedbackup-sample-8649699989-4bbzg     1/1       Running   0          22m
memcachedbackup-sample-8649699989-mq6mx     1/1       Running   0          22m</pre>

								</p></div></li><li class="listitem">
								You can update the <code class="literal">spec</code> in each of the above CRs, and then apply them again. The controller reconciles again and ensures that the size of the pods is as specified in the <code class="literal">spec</code> of the respective CRs.
							</li><li class="listitem"><p class="simpara">
								Clean up the resources that have been created as part of this tutorial:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Delete the <code class="literal">Memcached</code> resource:
									</p><pre class="programlisting language-terminal">$ oc delete -f config/samples/cache_v1_memcached.yaml</pre></li><li class="listitem"><p class="simpara">
										Delete the <code class="literal">MemcachedBackup</code> resource:
									</p><pre class="programlisting language-terminal">$ oc delete -f config/samples/cache_v1_memcachedbackup.yaml</pre></li><li class="listitem"><p class="simpara">
										If you used the <code class="literal">make deploy</code> command to test the Operator, run the following command:
									</p><pre class="programlisting language-terminal">$ make undeploy</pre></li></ol></div></li></ol></div></section><section class="section" id="osdk-hh-project-layout_osdk-hybrid-helm"><div class="titlepage"><div><div><h4 class="title">5.5.6.8. Project layout</h4></div></div></div><p>
						The Hybrid Helm Operator scaffolding is customized to be compatible with both Helm and Go APIs.
					</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 80%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731976817728" scope="col">File/folders</th><th align="left" valign="top" id="idm139731976816640" scope="col">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731976817728"> <p>
										<code class="literal">Dockerfile</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976816640"> <p>
										Instructions used by a container engine to build your Operator image with the <code class="literal">make docker-build</code> command.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976817728"> <p>
										<code class="literal">Makefile</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976816640"> <p>
										Build file with helper targets to help you work with your project.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976817728"> <p>
										<code class="literal">PROJECT</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976816640"> <p>
										YAML file containing metadata information for the Operator. Represents the project’s configuration and is used to track useful information for the CLI and plugins.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976817728"> <p>
										<code class="literal">bin/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976816640"> <p>
										Contains useful binaries such as the <code class="literal">manager</code> which is used to run your project locally and the <code class="literal">kustomize</code> utility used for the project configuration.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976817728"> <p>
										<code class="literal">config/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976816640"> <p>
										Contains configuration files, including all <a class="link" href="https://kustomize.io/">Kustomize</a> manifests, to launch your Operator project on a cluster. Plugins might use it to provide functionality. For example, for the Operator SDK to help create your Operator bundle, the CLI looks up the CRDs and CRs which are scaffolded in this directory.
									</p>
									 <div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">config/crd/</code></span></dt><dd>
													Contains custom resource definitions (CRDs).
												</dd><dt><span class="term"><code class="literal">config/default/</code></span></dt><dd>
													Contains a Kustomize base for launching the controller in a standard configuration.
												</dd><dt><span class="term"><code class="literal">config/manager/</code></span></dt><dd>
													Contains the manifests to launch your Operator project as pods on the cluster.
												</dd><dt><span class="term"><code class="literal">config/manifests/</code></span></dt><dd>
													Contains the base to generate your OLM manifests in the <code class="literal">bundle/</code> directory.
												</dd><dt><span class="term"><code class="literal">config/prometheus/</code></span></dt><dd>
													Contains the manifests required to enable project to serve metrics to Prometheus such as the <code class="literal">ServiceMonitor</code> resource.
												</dd><dt><span class="term"><code class="literal">config/scorecard/</code></span></dt><dd>
													Contains the manifests required to allow you test your project with the scorecard tool.
												</dd><dt><span class="term"><code class="literal">config/rbac/</code></span></dt><dd>
													Contains the RBAC permissions required to run your project.
												</dd><dt><span class="term"><code class="literal">config/samples/</code></span></dt><dd>
													Contains samples for custom resources.
												</dd></dl></div>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976817728"> <p>
										<code class="literal">api/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976816640"> <p>
										Contains the Go API definition.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976817728"> <p>
										<code class="literal">controllers/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976816640"> <p>
										Contains the controllers for the Go API.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976817728"> <p>
										<code class="literal">hack/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976816640"> <p>
										Contains utility files, such as the file used to scaffold the license header for your project files.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976817728"> <p>
										<code class="literal">main.go</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976816640"> <p>
										Main program of the Operator. Instantiates a new manager that registers all custom resource definitions (CRDs) in the <code class="literal">apis/</code> directory and starts all controllers in the <code class="literal">controllers/</code> directory.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976817728"> <p>
										<code class="literal">helm-charts/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976816640"> <p>
										Contains the Helm charts which can be specified using the <code class="literal">create api</code> command with the Helm plugin.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976817728"> <p>
										<code class="literal">watches.yaml</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976816640"> <p>
										Contains group/version/kind (GVK) and Helm chart location. Used to configure the Helm watches.
									</p>
									 </td></tr></tbody></table></div></section></section><section class="section" id="osdk-hybrid-helm-updating-projects"><div class="titlepage"><div><div><h3 class="title">5.5.7. Updating Hybrid Helm-based projects for newer Operator SDK versions</h3></div></div></div><p>
					OpenShift Container Platform 4.13 supports Operator SDK 1.28.0. If you already have the 1.25.4 CLI installed on your workstation, you can update the CLI to 1.28.0 by <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-installing-cli">installing the latest version</a>.
				</p><p>
					However, to ensure your existing Operator projects maintain compatibility with Operator SDK 1.28.0, update steps are required for the associated breaking changes introduced since 1.25.4. You must perform the update steps manually in any of your Operator projects that were previously created or maintained with 1.25.4.
				</p><section class="section" id="osdk-upgrading-projects_osdk-hybrid-helm-updating-projects"><div class="titlepage"><div><div><h4 class="title">5.5.7.1. Updating Hybrid Helm-based Operator projects for Operator SDK 1.28.0</h4></div></div></div><p>
						The following procedure updates an existing Hybrid Helm-based Operator project for compatibility with 1.28.0.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Operator SDK 1.28.0 installed
							</li><li class="listitem">
								An Operator project created or maintained with Operator SDK 1.25.4
							</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Find the <code class="literal">ose-kube-rbac-proxy</code> pull spec in the following files, and update the image tag to <code class="literal">v4.13</code>:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">config/default/manager_auth_proxy_patch.yaml</code>
									</li><li class="listitem">
										<code class="literal">bundle/manifests/memcached-operator.clusterserviceversion.yaml</code>
									</li></ul></div><pre class="programlisting language-yaml">…
      containers:
      - name: kube-rbac-proxy
        image: registry.redhat.io/openshift4/ose-kube-rbac-proxy:v4.13 <span id="CO62-1"><!--Empty--></span><span class="callout">1</span>
…</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO62-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Update the tag version from <code class="literal">v4.12</code> to <code class="literal">v4.13</code>.
									</div></dd></dl></div></li></ul></div></section><section class="section _additional-resources" id="additional-resources_osdk-hybrid-helm-upgrading-projects"><div class="titlepage"><div><div><h4 class="title">5.5.7.2. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-pkgman-to-bundle">Migrating package manifest projects to bundle format</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.10/html-single/operators/index#osdk-upgrading-v1101-to-v1160_osdk-upgrading-projects">Upgrading projects for Operator SDK 1.16.0</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.9/html/operators/developing-operators#osdk-upgrading-v180-to-v1101_osdk-upgrading-projects">Upgrading projects for Operator SDK v1.10.1</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.8/html/operators/developing-operators#osdk-upgrading-v130-to-v180_osdk-upgrading-projects">Upgrading projects for Operator SDK v1.8.0</a>
							</li></ul></div></section></section></section><section class="section" id="java-based-operators"><div class="titlepage"><div><div><h2 class="title">5.6. Java-based Operators</h2></div></div></div><section class="section" id="osdk-java-quickstart"><div class="titlepage"><div><div><h3 class="title">5.6.1. Getting started with Operator SDK for Java-based Operators</h3></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Java-based Operator SDK is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
					</p><p>
						For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
					</p></div></div><p>
					To demonstrate the basics of setting up and running a Java-based Operator using tools and libraries provided by the Operator SDK, Operator developers can build an example Java-based Operator for Memcached, a distributed key-value store, and deploy it to a cluster.
				</p><section class="section" id="osdk-common-prereqs_osdk-java-quickstart"><div class="titlepage"><div><div><h4 class="title">5.6.1.1. Prerequisites</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Operator SDK CLI installed
							</li><li class="listitem">
								OpenShift CLI (<code class="literal">oc</code>) v4.13+ installed
							</li><li class="listitem">
								<a class="link" href="https://java.com/en/download/help/download_options.html">Java</a> v11+
							</li><li class="listitem">
								<a class="link" href="https://maven.apache.org/install.html">Maven</a> v3.6.3+
							</li><li class="listitem">
								Logged into an OpenShift Container Platform 4.13 cluster with <code class="literal">oc</code> with an account that has <code class="literal">cluster-admin</code> permissions
							</li><li class="listitem">
								To allow the cluster to pull the image, the repository where you push your image must be set as public, or you must configure an image pull secret
							</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-installing-cli">Installing the Operator SDK CLI</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cli_tools/#getting-started-cli">Getting started with the OpenShift CLI</a>
							</li></ul></div></section><section class="section" id="osdk-quickstart_osdk-java-quickstart"><div class="titlepage"><div><div><h4 class="title">5.6.1.2. Creating and deploying Java-based Operators</h4></div></div></div><p>
						You can build and deploy a simple Java-based Operator for Memcached by using the Operator SDK.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Create a project.</strong></span>
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Create your project directory:
									</p><pre class="programlisting language-terminal">$ mkdir memcached-operator</pre></li><li class="listitem"><p class="simpara">
										Change into the project directory:
									</p><pre class="programlisting language-terminal">$ cd memcached-operator</pre></li><li class="listitem"><p class="simpara">
										Run the <code class="literal">operator-sdk init</code> command with the <code class="literal">quarkus</code> plugin to initialize the project:
									</p><pre class="programlisting language-terminal">$ operator-sdk init \
    --plugins=quarkus \
    --domain=example.com \
    --project-name=memcached-operator</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Create an API.</strong></span>
							</p><p class="simpara">
								Create a simple Memcached API:
							</p><pre class="programlisting language-terminal">$ operator-sdk create api \
    --plugins quarkus \
    --group cache \
    --version v1 \
    --kind Memcached</pre></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Build and push the Operator image.</strong></span>
							</p><p class="simpara">
								Use the default <code class="literal">Makefile</code> targets to build and push your Operator. Set <code class="literal">IMG</code> with a pull spec for your image that uses a registry you can push to:
							</p><pre class="programlisting language-terminal">$ make docker-build docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Run the Operator.</strong></span>
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Install the CRD:
									</p><pre class="programlisting language-terminal">$ make install</pre></li><li class="listitem"><p class="simpara">
										Deploy the project to the cluster. Set <code class="literal">IMG</code> to the image that you pushed:
									</p><pre class="programlisting language-terminal">$ make deploy IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Create a sample custom resource (CR).</strong></span>
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Create a sample CR:
									</p><pre class="programlisting language-terminal">$ oc apply -f config/samples/cache_v1_memcached.yaml \
    -n memcached-operator-system</pre></li><li class="listitem"><p class="simpara">
										Watch for the CR to reconcile the Operator:
									</p><pre class="programlisting language-terminal">$ oc logs deployment.apps/memcached-operator-controller-manager \
    -c manager \
    -n memcached-operator-system</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Delete a CR.</strong></span>
							</p><p class="simpara">
								Delete a CR by running the following command:
							</p><pre class="programlisting language-terminal">$ oc delete -f config/samples/cache_v1_memcached -n memcached-operator-system</pre></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Clean up.</strong></span>
							</p><p class="simpara">
								Run the following command to clean up the resources that have been created as part of this procedure:
							</p><pre class="programlisting language-terminal">$ make undeploy</pre></li></ol></div></section><section class="section" id="next-steps_osdk-java-quickstart"><div class="titlepage"><div><div><h4 class="title">5.6.1.3. Next steps</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-java-tutorial">Operator SDK tutorial for Java-based Operators</a> for a more in-depth walkthrough on building a Java-based Operator.
							</li></ul></div></section></section><section class="section" id="osdk-java-tutorial"><div class="titlepage"><div><div><h3 class="title">5.6.2. Operator SDK tutorial for Java-based Operators</h3></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Java-based Operator SDK is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
					</p><p>
						For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
					</p></div></div><p>
					Operator developers can take advantage of Java programming language support in the Operator SDK to build an example Java-based Operator for Memcached, a distributed key-value store, and manage its lifecycle.
				</p><p>
					This process is accomplished using two centerpieces of the Operator Framework:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Operator SDK</span></dt><dd>
								The <code class="literal">operator-sdk</code> CLI tool and <code class="literal">java-operator-sdk</code> library API
							</dd><dt><span class="term">Operator Lifecycle Manager (OLM)</span></dt><dd>
								Installation, upgrade, and role-based access control (RBAC) of Operators on a cluster
							</dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						This tutorial goes into greater detail than <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-java-quickstart">Getting started with Operator SDK for Java-based Operators</a>.
					</p></div></div><section class="section" id="osdk-common-prereqs_osdk-java-tutorial"><div class="titlepage"><div><div><h4 class="title">5.6.2.1. Prerequisites</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Operator SDK CLI installed
							</li><li class="listitem">
								OpenShift CLI (<code class="literal">oc</code>) v4.13+ installed
							</li><li class="listitem">
								<a class="link" href="https://java.com/en/download/help/download_options.html">Java</a> v11+
							</li><li class="listitem">
								<a class="link" href="https://maven.apache.org/install.html">Maven</a> v3.6.3+
							</li><li class="listitem">
								Logged into an OpenShift Container Platform 4.13 cluster with <code class="literal">oc</code> with an account that has <code class="literal">cluster-admin</code> permissions
							</li><li class="listitem">
								To allow the cluster to pull the image, the repository where you push your image must be set as public, or you must configure an image pull secret
							</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-installing-cli">Installing the Operator SDK CLI</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cli_tools/#getting-started-cli">Getting started with the OpenShift CLI</a>
							</li></ul></div></section><section class="section" id="osdk-create-project_osdk-java-tutorial"><div class="titlepage"><div><div><h4 class="title">5.6.2.2. Creating a project</h4></div></div></div><p>
						Use the Operator SDK CLI to create a project called <code class="literal">memcached-operator</code>.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a directory for the project:
							</p><pre class="programlisting language-terminal">$ mkdir -p $HOME/projects/memcached-operator</pre></li><li class="listitem"><p class="simpara">
								Change to the directory:
							</p><pre class="programlisting language-terminal">$ cd $HOME/projects/memcached-operator</pre></li><li class="listitem"><p class="simpara">
								Run the <code class="literal">operator-sdk init</code> command with the <code class="literal">quarkus</code> plugin to initialize the project:
							</p><pre class="programlisting language-terminal">$ operator-sdk init \
    --plugins=quarkus \
    --domain=example.com \
    --project-name=memcached-operator</pre></li></ol></div><section class="section" id="osdk-project-file_osdk-java-tutorial"><div class="titlepage"><div><div><h5 class="title">5.6.2.2.1. PROJECT file</h5></div></div></div><p>
							Among the files generated by the <code class="literal">operator-sdk init</code> command is a Kubebuilder <code class="literal">PROJECT</code> file. Subsequent <code class="literal">operator-sdk</code> commands, as well as <code class="literal">help</code> output, that are run from the project root read this file and are aware that the project type is Java. For example:
						</p><pre class="programlisting language-yaml">domain: example.com
layout:
- quarkus.javaoperatorsdk.io/v1-alpha
projectName: memcached-operator
version: "3"</pre></section></section><section class="section" id="osdk-java-create-api-controller_osdk-java-tutorial"><div class="titlepage"><div><div><h4 class="title">5.6.2.3. Creating an API and controller</h4></div></div></div><p>
						Use the Operator SDK CLI to create a custom resource definition (CRD) API and controller.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Run the following command to create an API:
							</p><pre class="programlisting language-terminal">$ operator-sdk create api \
    --plugins=quarkus \ <span id="CO63-1"><!--Empty--></span><span class="callout">1</span>
    --group=cache \ <span id="CO63-2"><!--Empty--></span><span class="callout">2</span>
    --version=v1 \ <span id="CO63-3"><!--Empty--></span><span class="callout">3</span>
    --kind=Memcached <span id="CO63-4"><!--Empty--></span><span class="callout">4</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO63-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Set the plugin flag to <code class="literal">quarkus</code>.
									</div></dd><dt><a href="#CO63-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Set the group flag to <code class="literal">cache</code>.
									</div></dd><dt><a href="#CO63-3"><span class="callout">3</span></a> </dt><dd><div class="para">
										Set the version flag to <code class="literal">v1</code>.
									</div></dd><dt><a href="#CO63-4"><span class="callout">4</span></a> </dt><dd><div class="para">
										Set the kind flag to <code class="literal">Memcached</code>.
									</div></dd></dl></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Run the <code class="literal">tree</code> command to view the file structure:
							</p><pre class="programlisting language-terminal">$ tree</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">.
├── Makefile
├── PROJECT
├── pom.xml
└── src
    └── main
        ├── java
        │   └── com
        │       └── example
        │           ├── Memcached.java
        │           ├── MemcachedReconciler.java
        │           ├── MemcachedSpec.java
        │           └── MemcachedStatus.java
        └── resources
            └── application.properties

6 directories, 8 files</pre>

								</p></div></li></ol></div><section class="section" id="osdk-java-define-api_osdk-java-tutorial"><div class="titlepage"><div><div><h5 class="title">5.6.2.3.1. Defining the API</h5></div></div></div><p>
							Define the API for the <code class="literal">Memcached</code> custom resource (CR).
						</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Edit the following files that were generated as part of the <code class="literal">create api</code> process:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Update the following attributes in the <code class="literal">MemcachedSpec.java</code> file to define the desired state of the <code class="literal">Memcached</code> CR:
										</p><pre class="programlisting language-java">public class MemcachedSpec {

    private Integer size;

    public Integer getSize() {
        return size;
    }

    public void setSize(Integer size) {
        this.size = size;
    }
}</pre></li><li class="listitem"><p class="simpara">
											Update the following attributes in the <code class="literal">MemcachedStatus.java</code> file to define the observed state of the <code class="literal">Memcached</code> CR:
										</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												The example below illustrates a Node status field. It is recommended that you use <a class="link" href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#typical-status-properties">typical status properties</a> in practice.
											</p></div></div><pre class="programlisting language-java">import java.util.ArrayList;
import java.util.List;

public class MemcachedStatus {

    // Add Status information here
    // Nodes are the names of the memcached pods
    private List&lt;String&gt; nodes;

    public List&lt;String&gt; getNodes() {
        if (nodes == null) {
            nodes = new ArrayList&lt;&gt;();
        }
        return nodes;
    }

    public void setNodes(List&lt;String&gt; nodes) {
        this.nodes = nodes;
    }
}</pre></li><li class="listitem"><p class="simpara">
											Update the <code class="literal">Memcached.java</code> file to define the Schema for Memcached APIs that extends to both <code class="literal">MemcachedSpec.java</code> and <code class="literal">MemcachedStatus.java</code> files.
										</p><pre class="programlisting language-java">@Version("v1")
@Group("cache.example.com")
public class Memcached extends CustomResource&lt;MemcachedSpec, MemcachedStatus&gt; implements Namespaced {}</pre></li></ol></div></li></ul></div></section><section class="section" id="osdk-java-generate-crd_osdk-java-tutorial"><div class="titlepage"><div><div><h5 class="title">5.6.2.3.2. Generating CRD manifests</h5></div></div></div><p>
							After the API is defined with <code class="literal">MemcachedSpec</code> and <code class="literal">MemcachedStatus</code> files, you can generate CRD manifests.
						</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Run the following command from the <code class="literal">memcached-operator</code> directory to generate the CRD:
								</p><pre class="programlisting language-terminal">$ mvn clean install</pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Verify the contents of the CRD in the <code class="literal">target/kubernetes/memcacheds.cache.example.com-v1.yml</code> file as shown in the following example:
								</p><pre class="programlisting language-terminal">$ cat target/kubernetes/memcacheds.cache.example.com-v1.yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-yaml"># Generated by Fabric8 CRDGenerator, manual edits might get overwritten!
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: memcacheds.cache.example.com
spec:
  group: cache.example.com
  names:
    kind: Memcached
    plural: memcacheds
    singular: memcached
  scope: Namespaced
  versions:
  - name: v1
    schema:
      openAPIV3Schema:
        properties:
          spec:
            properties:
              size:
                type: integer
            type: object
          status:
            properties:
              nodes:
                items:
                  type: string
                type: array
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}</pre>

									</p></div></li></ul></div></section><section class="section" id="osdk-java-create-cr_osdk-java-tutorial"><div class="titlepage"><div><div><h5 class="title">5.6.2.3.3. Creating a Custom Resource</h5></div></div></div><p>
							After generating the CRD manifests, you can create the Custom Resource (CR).
						</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Create a Memcached CR called <code class="literal">memcached-sample.yaml</code>:
								</p><pre class="programlisting language-yaml">apiVersion: cache.example.com/v1
kind: Memcached
metadata:
  name: memcached-sample
spec:
  # Add spec fields here
  size: 1</pre></li></ul></div></section></section><section class="section" id="osdk-java-implement-controller_osdk-java-tutorial"><div class="titlepage"><div><div><h4 class="title">5.6.2.4. Implementing the controller</h4></div></div></div><p>
						After creating a new API and controller, you can implement the controller logic.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Append the following dependency to the <code class="literal">pom.xml</code> file:
							</p><pre class="programlisting language-xml">    &lt;dependency&gt;
      &lt;groupId&gt;commons-collections&lt;/groupId&gt;
      &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;
      &lt;version&gt;3.2.2&lt;/version&gt;
    &lt;/dependency&gt;</pre></li><li class="listitem"><p class="simpara">
								For this example, replace the generated controller file <code class="literal">MemcachedReconciler.java</code> with following example implementation:
							</p><div class="example" id="idm139731976694768"><p class="title"><strong>Example 5.9. Example <code class="literal">MemcachedReconciler.java</code></strong></p><div class="example-contents"><pre class="programlisting language-java">package com.example;

import io.fabric8.kubernetes.client.KubernetesClient;
import io.javaoperatorsdk.operator.api.reconciler.Context;
import io.javaoperatorsdk.operator.api.reconciler.Reconciler;
import io.javaoperatorsdk.operator.api.reconciler.UpdateControl;
import io.fabric8.kubernetes.api.model.ContainerBuilder;
import io.fabric8.kubernetes.api.model.ContainerPortBuilder;
import io.fabric8.kubernetes.api.model.LabelSelectorBuilder;
import io.fabric8.kubernetes.api.model.ObjectMetaBuilder;
import io.fabric8.kubernetes.api.model.OwnerReferenceBuilder;
import io.fabric8.kubernetes.api.model.Pod;
import io.fabric8.kubernetes.api.model.PodSpecBuilder;
import io.fabric8.kubernetes.api.model.PodTemplateSpecBuilder;
import io.fabric8.kubernetes.api.model.apps.Deployment;
import io.fabric8.kubernetes.api.model.apps.DeploymentBuilder;
import io.fabric8.kubernetes.api.model.apps.DeploymentSpecBuilder;
import org.apache.commons.collections.CollectionUtils;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

public class MemcachedReconciler implements Reconciler&lt;Memcached&gt; {
  private final KubernetesClient client;

  public MemcachedReconciler(KubernetesClient client) {
    this.client = client;
  }

  // TODO Fill in the rest of the reconciler

  @Override
  public UpdateControl&lt;Memcached&gt; reconcile(
      Memcached resource, Context context) {
      // TODO: fill in logic
      Deployment deployment = client.apps()
              .deployments()
              .inNamespace(resource.getMetadata().getNamespace())
              .withName(resource.getMetadata().getName())
              .get();

      if (deployment == null) {
          Deployment newDeployment = createMemcachedDeployment(resource);
          client.apps().deployments().create(newDeployment);
          return UpdateControl.noUpdate();
      }

      int currentReplicas = deployment.getSpec().getReplicas();
      int requiredReplicas = resource.getSpec().getSize();

      if (currentReplicas != requiredReplicas) {
          deployment.getSpec().setReplicas(requiredReplicas);
          client.apps().deployments().createOrReplace(deployment);
          return UpdateControl.noUpdate();
      }

      List&lt;Pod&gt; pods = client.pods()
          .inNamespace(resource.getMetadata().getNamespace())
          .withLabels(labelsForMemcached(resource))
          .list()
          .getItems();

      List&lt;String&gt; podNames =
          pods.stream().map(p -&gt; p.getMetadata().getName()).collect(Collectors.toList());


      if (resource.getStatus() == null
               || !CollectionUtils.isEqualCollection(podNames, resource.getStatus().getNodes())) {
           if (resource.getStatus() == null) resource.setStatus(new MemcachedStatus());
           resource.getStatus().setNodes(podNames);
           return UpdateControl.updateResource(resource);
      }

      return UpdateControl.noUpdate();
  }

  private Map&lt;String, String&gt; labelsForMemcached(Memcached m) {
    Map&lt;String, String&gt; labels = new HashMap&lt;&gt;();
    labels.put("app", "memcached");
    labels.put("memcached_cr", m.getMetadata().getName());
    return labels;
  }

  private Deployment createMemcachedDeployment(Memcached m) {
      Deployment deployment = new DeploymentBuilder()
          .withMetadata(
              new ObjectMetaBuilder()
                  .withName(m.getMetadata().getName())
                  .withNamespace(m.getMetadata().getNamespace())
                  .build())
          .withSpec(
              new DeploymentSpecBuilder()
                  .withReplicas(m.getSpec().getSize())
                  .withSelector(
                      new LabelSelectorBuilder().withMatchLabels(labelsForMemcached(m)).build())
                  .withTemplate(
                      new PodTemplateSpecBuilder()
                          .withMetadata(
                              new ObjectMetaBuilder().withLabels(labelsForMemcached(m)).build())
                          .withSpec(
                              new PodSpecBuilder()
                                  .withContainers(
                                      new ContainerBuilder()
                                          .withImage("memcached:1.4.36-alpine")
                                          .withName("memcached")
                                          .withCommand("memcached", "-m=64", "-o", "modern", "-v")
                                          .withPorts(
                                              new ContainerPortBuilder()
                                                  .withContainerPort(11211)
                                                  .withName("memcached")
                                                  .build())
                                          .build())
                                  .build())
                          .build())
                  .build())
          .build();
    deployment.addOwnerReference(m);
    return deployment;
  }
}</pre></div></div><p class="simpara">
								The example controller runs the following reconciliation logic for each <code class="literal">Memcached</code> custom resource (CR):
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Creates a Memcached deployment if it does not exist.
									</li><li class="listitem">
										Ensures that the deployment size matches the size specified by the <code class="literal">Memcached</code> CR spec.
									</li><li class="listitem">
										Updates the <code class="literal">Memcached</code> CR status with the names of the <code class="literal">memcached</code> pods.
									</li></ul></div></li></ol></div><p>
						The next subsections explain how the controller in the example implementation watches resources and how the reconcile loop is triggered. You can skip these subsections to go directly to <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-run-operator_osdk-java-tutorial">Running the Operator</a>.
					</p><section class="section" id="osdk-java-controller-reconcile-loop_osdk-java-tutorial"><div class="titlepage"><div><div><h5 class="title">5.6.2.4.1. Reconcile loop</h5></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Every controller has a reconciler object with a <code class="literal">Reconcile()</code> method that implements the reconcile loop. The reconcile loop is passed the <code class="literal">Deployment</code> argument, as shown in the following example:
								</p><pre class="programlisting language-java">        Deployment deployment = client.apps()
                .deployments()
                .inNamespace(resource.getMetadata().getNamespace())
                .withName(resource.getMetadata().getName())
                .get();</pre></li><li class="listitem"><p class="simpara">
									As shown in the following example, if the <code class="literal">Deployment</code> is <code class="literal">null</code>, the deployment needs to be created. After you create the <code class="literal">Deployment</code>, you can determine if reconciliation is necessary. If there is no need of reconciliation, return the value of <code class="literal">UpdateControl.noUpdate()</code>, otherwise, return the value of `UpdateControl.updateStatus(resource):
								</p><pre class="programlisting language-java">        if (deployment == null) {
            Deployment newDeployment = createMemcachedDeployment(resource);
            client.apps().deployments().create(newDeployment);
            return UpdateControl.noUpdate();
        }</pre></li><li class="listitem"><p class="simpara">
									After getting the <code class="literal">Deployment</code>, get the current and required replicas, as shown in the following example:
								</p><pre class="programlisting language-java">        int currentReplicas = deployment.getSpec().getReplicas();
        int requiredReplicas = resource.getSpec().getSize();</pre></li><li class="listitem"><p class="simpara">
									If <code class="literal">currentReplicas</code> does not match the <code class="literal">requiredReplicas</code>, you must update the <code class="literal">Deployment</code>, as shown in the following example:
								</p><pre class="programlisting language-java">        if (currentReplicas != requiredReplicas) {
            deployment.getSpec().setReplicas(requiredReplicas);
            client.apps().deployments().createOrReplace(deployment);
            return UpdateControl.noUpdate();
        }</pre></li><li class="listitem"><p class="simpara">
									The following example shows how to obtain the list of pods and their names:
								</p><pre class="programlisting language-java">        List&lt;Pod&gt; pods = client.pods()
            .inNamespace(resource.getMetadata().getNamespace())
            .withLabels(labelsForMemcached(resource))
            .list()
            .getItems();

        List&lt;String&gt; podNames =
            pods.stream().map(p -&gt; p.getMetadata().getName()).collect(Collectors.toList());</pre></li><li class="listitem"><p class="simpara">
									Check if resources were created and verify podnames with the Memcached resources. If a mismatch exists in either of these conditions, perform a reconciliation as shown in the following example:
								</p><pre class="programlisting language-java">        if (resource.getStatus() == null
                || !CollectionUtils.isEqualCollection(podNames, resource.getStatus().getNodes())) {
            if (resource.getStatus() == null) resource.setStatus(new MemcachedStatus());
            resource.getStatus().setNodes(podNames);
            return UpdateControl.updateResource(resource);
        }</pre></li></ol></div></section><section class="section" id="osdk-java-controller-labels-memcached_osdk-java-tutorial"><div class="titlepage"><div><div><h5 class="title">5.6.2.4.2. Defining <code class="literal">labelsForMemcached</code></h5></div></div></div><p>
							<code class="literal">labelsForMemcached</code> is a utility to return a map of the labels to attach to the resources:
						</p><pre class="programlisting language-java">    private Map&lt;String, String&gt; labelsForMemcached(Memcached m) {
        Map&lt;String, String&gt; labels = new HashMap&lt;&gt;();
        labels.put("app", "memcached");
        labels.put("memcached_cr", m.getMetadata().getName());
        return labels;
    }</pre></section><section class="section" id="osdk-java-controller-memcached-deployment_osdk-java-tutorial"><div class="titlepage"><div><div><h5 class="title">5.6.2.4.3. Define the <code class="literal">createMemcachedDeployment</code></h5></div></div></div><p>
							The <code class="literal">createMemcachedDeployment</code> method uses the <a class="link" href="https://fabric8.io/">fabric8</a> <code class="literal">DeploymentBuilder</code> class:
						</p><pre class="programlisting language-java">    private Deployment createMemcachedDeployment(Memcached m) {
        Deployment deployment = new DeploymentBuilder()
            .withMetadata(
                new ObjectMetaBuilder()
                    .withName(m.getMetadata().getName())
                    .withNamespace(m.getMetadata().getNamespace())
                    .build())
            .withSpec(
                new DeploymentSpecBuilder()
                    .withReplicas(m.getSpec().getSize())
                    .withSelector(
                        new LabelSelectorBuilder().withMatchLabels(labelsForMemcached(m)).build())
                    .withTemplate(
                        new PodTemplateSpecBuilder()
                            .withMetadata(
                                new ObjectMetaBuilder().withLabels(labelsForMemcached(m)).build())
                            .withSpec(
                                new PodSpecBuilder()
                                    .withContainers(
                                        new ContainerBuilder()
                                            .withImage("memcached:1.4.36-alpine")
                                            .withName("memcached")
                                            .withCommand("memcached", "-m=64", "-o", "modern", "-v")
                                            .withPorts(
                                                new ContainerPortBuilder()
                                                    .withContainerPort(11211)
                                                    .withName("memcached")
                                                    .build())
                                            .build())
                                    .build())
                            .build())
                    .build())
            .build();
      deployment.addOwnerReference(m);
      return deployment;
    }</pre></section></section><section class="section" id="osdk-run-operator_osdk-java-tutorial"><div class="titlepage"><div><div><h4 class="title">5.6.2.5. Running the Operator</h4></div></div></div><p>
						There are three ways you can use the Operator SDK CLI to build and run your Operator:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Run locally outside the cluster as a Go program.
							</li><li class="listitem">
								Run as a deployment on the cluster.
							</li><li class="listitem">
								Bundle your Operator and use Operator Lifecycle Manager (OLM) to deploy on the cluster.
							</li></ul></div><section class="section" id="osdk-run-locally_osdk-java-tutorial"><div class="titlepage"><div><div><h5 class="title">5.6.2.5.1. Running locally outside the cluster</h5></div></div></div><p>
							You can run your Operator project as a Go program outside of the cluster. This is useful for development purposes to speed up deployment and testing.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Run the following command to compile the Operator:
								</p><pre class="programlisting language-terminal">$ mvn clean install</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  11.193 s
[INFO] Finished at: 2021-05-26T12:16:54-04:00
[INFO] ------------------------------------------------------------------------</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Run the following command to install the CRD to the default namespace:
								</p><pre class="programlisting language-terminal">$ oc apply -f target/kubernetes/memcacheds.cache.example.com-v1.yml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">customresourcedefinition.apiextensions.k8s.io/memcacheds.cache.example.com created</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Create a file called <code class="literal">rbac.yaml</code> as shown in the following example:
								</p><pre class="programlisting language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: memcached-operator-admin
subjects:
- kind: ServiceAccount
  name: memcached-quarkus-operator-operator
  namespace: &lt;operator_namespace&gt;
roleRef:
  kind: ClusterRole
  name: cluster-admin
  apiGroup: ""</pre></li><li class="listitem"><p class="simpara">
									Run the following command to grant <code class="literal">cluster-admin</code> privileges to the <code class="literal">memcached-quarkus-operator-operator</code> by applying the <code class="literal">rbac.yaml</code> file:
								</p><pre class="programlisting language-terminal">$ oc apply -f rbac.yaml</pre></li><li class="listitem"><p class="simpara">
									Enter the following command to run the Operator:
								</p><pre class="programlisting language-terminal">$ java -jar target/quarkus-app/quarkus-run.jar</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										The <code class="literal">java</code> command will run the Operator and remain running until you end the process. You will need another terminal to complete the rest of these commands.
									</p></div></div></li><li class="listitem"><p class="simpara">
									Apply the <code class="literal">memcached-sample.yaml</code> file with the following command:
								</p><pre class="programlisting language-terminal">$ kubectl apply -f memcached-sample.yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">memcached.cache.example.com/memcached-sample created</pre>

									</p></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Run the following command to confirm that the pod has started:
								</p><pre class="programlisting language-terminal">$ oc get all</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME                                                       READY   STATUS    RESTARTS   AGE
pod/memcached-sample-6c765df685-mfqnz                      1/1     Running   0          18s</pre>

									</p></div></li></ul></div></section><section class="section" id="osdk-run-deployment_osdk-java-tutorial"><div class="titlepage"><div><div><h5 class="title">5.6.2.5.2. Running as a deployment on the cluster</h5></div></div></div><p>
							You can run your Operator project as a deployment on your cluster.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Run the following <code class="literal">make</code> commands to build and push the Operator image. Modify the <code class="literal">IMG</code> argument in the following steps to reference a repository that you have access to. You can obtain an account for storing containers at repository sites such as Quay.io.
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Build the image:
										</p><pre class="programlisting language-terminal">$ make docker-build IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												The Dockerfile generated by the SDK for the Operator explicitly references <code class="literal">GOARCH=amd64</code> for <code class="literal">go build</code>. This can be amended to <code class="literal">GOARCH=$TARGETARCH</code> for non-AMD64 architectures. Docker will automatically set the environment variable to the value specified by <code class="literal">–platform</code>. With Buildah, the <code class="literal">–build-arg</code> will need to be used for the purpose. For more information, see <a class="link" href="https://sdk.operatorframework.io/docs/advanced-topics/multi-arch/#supporting-multiple-architectures">Multiple Architectures</a>.
											</p></div></div></li><li class="listitem"><p class="simpara">
											Push the image to a repository:
										</p><pre class="programlisting language-terminal">$ make docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												The name and tag of the image, for example <code class="literal">IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</code>, in both the commands can also be set in your Makefile. Modify the <code class="literal">IMG ?= controller:latest</code> value to set your default image name.
											</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
									Run the following command to install the CRD to the default namespace:
								</p><pre class="programlisting language-terminal">$ oc apply -f target/kubernetes/memcacheds.cache.example.com-v1.yml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">customresourcedefinition.apiextensions.k8s.io/memcacheds.cache.example.com created</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Create a file called <code class="literal">rbac.yaml</code> as shown in the following example:
								</p><pre class="programlisting language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: memcached-operator-admin
subjects:
- kind: ServiceAccount
  name: memcached-quarkus-operator-operator
  namespace: &lt;operator_namespace&gt;
roleRef:
  kind: ClusterRole
  name: cluster-admin
  apiGroup: ""</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
										The <code class="literal">rbac.yaml</code> file will be applied at a later step.
									</p></div></div></li><li class="listitem"><p class="simpara">
									Run the following command to deploy the Operator:
								</p><pre class="programlisting language-terminal">$ make deploy IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre></li><li class="listitem"><p class="simpara">
									Run the following command to grant <code class="literal">cluster-admin</code> privileges to the <code class="literal">memcached-quarkus-operator-operator</code> by applying the <code class="literal">rbac.yaml</code> file created in a previous step:
								</p><pre class="programlisting language-terminal">$ oc apply -f rbac.yaml</pre></li><li class="listitem"><p class="simpara">
									Run the following command to verify that the Operator is running:
								</p><pre class="programlisting language-terminal">$ oc get all -n default</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME                                                      READY   UP-TO-DATE   AVAILABLE   AGE
pod/memcached-quarkus-operator-operator-7db86ccf58-k4mlm   0/1       Running   0           18s</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Run the following command to apply the <code class="literal">memcached-sample.yaml</code> and create the <code class="literal">memcached-sample</code> pod:
								</p><pre class="programlisting language-terminal">$ oc apply -f memcached-sample.yaml</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">memcached.cache.example.com/memcached-sample created</pre>

									</p></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Run the following command to confirm the pods have started:
								</p><pre class="programlisting language-terminal">$ oc get all</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME                                                       READY   STATUS    RESTARTS   AGE
pod/memcached-quarkus-operator-operator-7b766f4896-kxnzt   1/1     Running   1          79s
pod/memcached-sample-6c765df685-mfqnz                      1/1     Running   0          18s</pre>

									</p></div></li></ul></div></section><section class="section" id="osdk-bundle-deploy-olm_osdk-java-tutorial"><div class="titlepage"><div><div><h5 class="title">5.6.2.5.3. Bundling an Operator and deploying with Operator Lifecycle Manager</h5></div></div></div><section class="section" id="osdk-bundle-operator_osdk-java-tutorial"><div class="titlepage"><div><div><h6 class="title">5.6.2.5.3.1. Bundling an Operator</h6></div></div></div><p>
								The Operator bundle format is the default packaging method for Operator SDK and Operator Lifecycle Manager (OLM). You can get your Operator ready for use on OLM by using the Operator SDK to build and push your Operator project as a bundle image.
							</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
										Operator SDK CLI installed on a development workstation
									</li><li class="listitem">
										OpenShift CLI (<code class="literal">oc</code>) v4.13+ installed
									</li><li class="listitem">
										Operator project initialized by using the Operator SDK
									</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
										Run the following <code class="literal">make</code> commands in your Operator project directory to build and push your Operator image. Modify the <code class="literal">IMG</code> argument in the following steps to reference a repository that you have access to. You can obtain an account for storing containers at repository sites such as Quay.io.
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
												Build the image:
											</p><pre class="programlisting language-terminal">$ make docker-build IMG=&lt;registry&gt;/&lt;user&gt;/&lt;operator_image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
													The Dockerfile generated by the SDK for the Operator explicitly references <code class="literal">GOARCH=amd64</code> for <code class="literal">go build</code>. This can be amended to <code class="literal">GOARCH=$TARGETARCH</code> for non-AMD64 architectures. Docker will automatically set the environment variable to the value specified by <code class="literal">–platform</code>. With Buildah, the <code class="literal">–build-arg</code> will need to be used for the purpose. For more information, see <a class="link" href="https://sdk.operatorframework.io/docs/advanced-topics/multi-arch/#supporting-multiple-architectures">Multiple Architectures</a>.
												</p></div></div></li><li class="listitem"><p class="simpara">
												Push the image to a repository:
											</p><pre class="programlisting language-terminal">$ make docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;operator_image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li><li class="listitem"><p class="simpara">
										Create your Operator bundle manifest by running the <code class="literal">make bundle</code> command, which invokes several commands, including the Operator SDK <code class="literal">generate bundle</code> and <code class="literal">bundle validate</code> subcommands:
									</p><pre class="programlisting language-terminal">$ make bundle IMG=&lt;registry&gt;/&lt;user&gt;/&lt;operator_image_name&gt;:&lt;tag&gt;</pre><p class="simpara">
										Bundle manifests for an Operator describe how to display, create, and manage an application. The <code class="literal">make bundle</code> command creates the following files and directories in your Operator project:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												A bundle manifests directory named <code class="literal">bundle/manifests</code> that contains a <code class="literal">ClusterServiceVersion</code> object
											</li><li class="listitem">
												A bundle metadata directory named <code class="literal">bundle/metadata</code>
											</li><li class="listitem">
												All custom resource definitions (CRDs) in a <code class="literal">config/crd</code> directory
											</li><li class="listitem">
												A Dockerfile <code class="literal">bundle.Dockerfile</code>
											</li></ul></div><p class="simpara">
										These files are then automatically validated by using <code class="literal">operator-sdk bundle validate</code> to ensure the on-disk bundle representation is correct.
									</p></li><li class="listitem"><p class="simpara">
										Build and push your bundle image by running the following commands. OLM consumes Operator bundles using an index image, which reference one or more bundle images.
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
												Build the bundle image. Set <code class="literal">BUNDLE_IMG</code> with the details for the registry, user namespace, and image tag where you intend to push the image:
											</p><pre class="programlisting language-terminal">$ make bundle-build BUNDLE_IMG=&lt;registry&gt;/&lt;user&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt;</pre></li><li class="listitem"><p class="simpara">
												Push the bundle image:
											</p><pre class="programlisting language-terminal">$ docker push &lt;registry&gt;/&lt;user&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li></ol></div></section><section class="section" id="osdk-deploy-olm_osdk-java-tutorial"><div class="titlepage"><div><div><h6 class="title">5.6.2.5.3.2. Deploying an Operator with Operator Lifecycle Manager</h6></div></div></div><p>
								Operator Lifecycle Manager (OLM) helps you to install, update, and manage the lifecycle of Operators and their associated services on a Kubernetes cluster. OLM is installed by default on OpenShift Container Platform and runs as a Kubernetes extension so that you can use the web console and the OpenShift CLI (<code class="literal">oc</code>) for all Operator lifecycle management functions without any additional tools.
							</p><p>
								The Operator bundle format is the default packaging method for Operator SDK and OLM. You can use the Operator SDK to quickly run a bundle image on OLM to ensure that it runs properly.
							</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
										Operator SDK CLI installed on a development workstation
									</li><li class="listitem">
										Operator bundle image built and pushed to a registry
									</li><li class="listitem">
										OLM installed on a Kubernetes-based cluster (v1.16.0 or later if you use <code class="literal">apiextensions.k8s.io/v1</code> CRDs, for example OpenShift Container Platform 4.13)
									</li><li class="listitem">
										Logged in to the cluster with <code class="literal">oc</code> using an account with <code class="literal">cluster-admin</code> permissions
									</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Enter the following command to run the Operator on the cluster:
									</p><pre class="programlisting language-terminal">$ operator-sdk run bundle \<span id="CO64-1"><!--Empty--></span><span class="callout">1</span>
    -n &lt;namespace&gt; \<span id="CO64-2"><!--Empty--></span><span class="callout">2</span>
    &lt;registry&gt;/&lt;user&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt; <span id="CO64-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO64-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												The <code class="literal">run bundle</code> command creates a valid file-based catalog and installs the Operator bundle on your cluster using OLM.
											</div></dd><dt><a href="#CO64-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												Optional: By default, the command installs the Operator in the currently active project in your <code class="literal">~/.kube/config</code> file. You can add the <code class="literal">-n</code> flag to set a different namespace scope for the installation.
											</div></dd><dt><a href="#CO64-3"><span class="callout">3</span></a> </dt><dd><div class="para">
												If you do not specify an image, the command uses <code class="literal">quay.io/operator-framework/opm:latest</code> as the default index image. If you specify an image, the command uses the bundle image itself as the index image.
											</div></dd></dl></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
											As of OpenShift Container Platform 4.11, the <code class="literal">run bundle</code> command supports the file-based catalog format for Operator catalogs by default. The deprecated SQLite database format for Operator catalogs continues to be supported; however, it will be removed in a future release. It is recommended that Operator authors migrate their workflows to the file-based catalog format.
										</p></div></div><p class="simpara">
										This command performs the following actions:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												Create an index image referencing your bundle image. The index image is opaque and ephemeral, but accurately reflects how a bundle would be added to a catalog in production.
											</li><li class="listitem">
												Create a catalog source that points to your new index image, which enables OperatorHub to discover your Operator.
											</li><li class="listitem">
												Deploy your Operator to your cluster by creating an <code class="literal">OperatorGroup</code>, <code class="literal">Subscription</code>, <code class="literal">InstallPlan</code>, and all other required resources, including RBAC.
											</li></ul></div></li></ul></div></section></section></section><section class="section _additional-resources" id="additional-resources_osdk-java-tutorial"><div class="titlepage"><div><div><h4 class="title">5.6.2.6. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-java-project-layout">Project layout for Java-based Operators</a> to learn about the directory structures created by the Operator SDK.
							</li><li class="listitem">
								If a <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#enable-cluster-wide-proxy">cluster-wide egress proxy is configured</a>, cluster administrators can <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-configuring-proxy-support">override the proxy settings or inject a custom CA certificate</a> for specific Operators running on Operator Lifecycle Manager (OLM).
							</li></ul></div></section></section><section class="section" id="osdk-java-project-layout"><div class="titlepage"><div><div><h3 class="title">5.6.3. Project layout for Java-based Operators</h3></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Java-based Operator SDK is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
					</p><p>
						For more information about the support scope of Red Hat Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features Support Scope</a>.
					</p></div></div><p>
					The <code class="literal">operator-sdk</code> CLI can generate, or <span class="emphasis"><em>scaffold</em></span>, a number of packages and files for each Operator project.
				</p><section class="section" id="osdk-java-project-layout_osdk-java-project-layout"><div class="titlepage"><div><div><h4 class="title">5.6.3.1. Java-based project layout</h4></div></div></div><p>
						Java-based Operator projects generated by the <code class="literal">operator-sdk init</code> command contain the following files and directories:
					</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 80%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731975576944" scope="col">File or directory</th><th align="left" valign="top" id="idm139731975575856" scope="col">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731975576944"> <p>
										<code class="literal">pom.xml</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731975575856"> <p>
										File that contains the dependencies required to run the Operator.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731975576944"> <p>
										<code class="literal">&lt;domain&gt;/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731975575856"> <p>
										Directory that contains the files that represent the API. If the domain is <code class="literal">example.com</code>, this folder is called <code class="literal">example/</code>.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731975576944"> <p>
										<code class="literal">MemcachedReconciler.java</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731975575856"> <p>
										Java file that defines controller implementations.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731975576944"> <p>
										<code class="literal">MemcachedSpec.java</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731975575856"> <p>
										Java file that defines the desired state of the Memcached CR.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731975576944"> <p>
										<code class="literal">MemcachedStatus.java</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731975575856"> <p>
										Java file that defines the observed state of the Memcached CR.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731975576944"> <p>
										<code class="literal">Memcached.java</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731975575856"> <p>
										Java file that defines the Schema for Memcached APIs.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731975576944"> <p>
										<code class="literal">target/kubernetes/</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731975575856"> <p>
										Directory that contains the CRD yaml files.
									</p>
									 </td></tr></tbody></table></div></section></section><section class="section" id="osdk-java-updating-projects"><div class="titlepage"><div><div><h3 class="title">5.6.4. Updating projects for newer Operator SDK versions</h3></div></div></div><p>
					OpenShift Container Platform 4.13 supports Operator SDK 1.28.0. If you already have the 1.25.4 CLI installed on your workstation, you can update the CLI to 1.28.0 by <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-installing-cli">installing the latest version</a>.
				</p><p>
					However, to ensure your existing Operator projects maintain compatibility with Operator SDK 1.28.0, update steps are required for the associated breaking changes introduced since 1.25.4. You must perform the update steps manually in any of your Operator projects that were previously created or maintained with 1.25.4.
				</p><section class="section" id="osdk-upgrading-projects_osdk-java-updating-projects"><div class="titlepage"><div><div><h4 class="title">5.6.4.1. Updating Java-based Operator projects for Operator SDK 1.28.0</h4></div></div></div><p>
						The following procedure updates an existing Java-based Operator project for compatibility with 1.28.0.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Operator SDK 1.28.0 installed
							</li><li class="listitem">
								An Operator project created or maintained with Operator SDK 1.25.4
							</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Find the <code class="literal">ose-kube-rbac-proxy</code> pull spec in the following files, and update the image tag to <code class="literal">v4.13</code>:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">config/default/manager_auth_proxy_patch.yaml</code>
									</li><li class="listitem">
										<code class="literal">bundle/manifests/memcached-operator.clusterserviceversion.yaml</code>
									</li></ul></div><pre class="programlisting language-yaml">…
      containers:
      - name: kube-rbac-proxy
        image: registry.redhat.io/openshift4/ose-kube-rbac-proxy:v4.13 <span id="CO65-1"><!--Empty--></span><span class="callout">1</span>
…</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO65-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Update the tag version from <code class="literal">v4.12</code> to <code class="literal">v4.13</code>.
									</div></dd></dl></div></li></ul></div></section><section class="section _additional-resources" id="additional-resources_osdk-java-upgrading-projects"><div class="titlepage"><div><div><h4 class="title">5.6.4.2. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-pkgman-to-bundle">Migrating package manifest projects to bundle format</a>
							</li></ul></div></section></section></section><section class="section" id="osdk-generating-csvs"><div class="titlepage"><div><div><h2 class="title">5.7. Defining cluster service versions (CSVs)</h2></div></div></div><p>
				A <span class="emphasis"><em>cluster service version</em></span> (CSV), defined by a <code class="literal">ClusterServiceVersion</code> object, is a YAML manifest created from Operator metadata that assists Operator Lifecycle Manager (OLM) in running the Operator in a cluster. It is the metadata that accompanies an Operator container image, used to populate user interfaces with information such as its logo, description, and version. It is also a source of technical information that is required to run the Operator, like the RBAC rules it requires and which custom resources (CRs) it manages or depends on.
			</p><p>
				The Operator SDK includes the CSV generator to generate a CSV for the current Operator project, customized using information contained in YAML manifests and Operator source files.
			</p><p>
				A CSV-generating command removes the responsibility of Operator authors having in-depth OLM knowledge in order for their Operator to interact with OLM or publish metadata to the Catalog Registry. Further, because the CSV spec will likely change over time as new Kubernetes and OLM features are implemented, the Operator SDK is equipped to easily extend its update system to handle new CSV features going forward.
			</p><section class="section" id="osdk-how-csv-gen-works_osdk-generating-csvs"><div class="titlepage"><div><div><h3 class="title">5.7.1. How CSV generation works</h3></div></div></div><p>
					Operator bundle manifests, which include cluster service versions (CSVs), describe how to display, create, and manage an application with Operator Lifecycle Manager (OLM). The CSV generator in the Operator SDK, called by the <code class="literal">generate bundle</code> subcommand, is the first step towards publishing your Operator to a catalog and deploying it with OLM. The subcommand requires certain input manifests to construct a CSV manifest; all inputs are read when the command is invoked, along with a CSV base, to idempotently generate or regenerate a CSV.
				</p><p>
					Typically, the <code class="literal">generate kustomize manifests</code> subcommand would be run first to generate the input <a class="link" href="https://kustomize.io/">Kustomize</a> bases that are consumed by the <code class="literal">generate bundle</code> subcommand. However, the Operator SDK provides the <code class="literal">make bundle</code> command, which automates several tasks, including running the following subcommands in order:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							<code class="literal">generate kustomize manifests</code>
						</li><li class="listitem">
							<code class="literal">generate bundle</code>
						</li><li class="listitem">
							<code class="literal">bundle validate</code>
						</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-bundle-operator_osdk-working-bundle-images">Bundling an Operator</a> for a full procedure that includes generating a bundle and CSV.
						</li></ul></div><section class="section" id="osdk-csv-bundle-files_osdk-generating-csvs"><div class="titlepage"><div><div><h4 class="title">5.7.1.1. Generated files and resources</h4></div></div></div><p>
						The <code class="literal">make bundle</code> command creates the following files and directories in your Operator project:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A bundle manifests directory named <code class="literal">bundle/manifests</code> that contains a <code class="literal">ClusterServiceVersion</code> (CSV) object
							</li><li class="listitem">
								A bundle metadata directory named <code class="literal">bundle/metadata</code>
							</li><li class="listitem">
								All custom resource definitions (CRDs) in a <code class="literal">config/crd</code> directory
							</li><li class="listitem">
								A Dockerfile <code class="literal">bundle.Dockerfile</code>
							</li></ul></div><p>
						The following resources are typically included in a CSV:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Role</span></dt><dd>
									Defines Operator permissions within a namespace.
								</dd><dt><span class="term">ClusterRole</span></dt><dd>
									Defines cluster-wide Operator permissions.
								</dd><dt><span class="term">Deployment</span></dt><dd>
									Defines how an Operand of an Operator is run in pods.
								</dd><dt><span class="term">CustomResourceDefinition (CRD)</span></dt><dd>
									Defines custom resources that your Operator reconciles.
								</dd><dt><span class="term">Custom resource examples</span></dt><dd>
									Examples of resources adhering to the spec of a particular CRD.
								</dd></dl></div></section><section class="section" id="osdk-csv-ver_osdk-generating-csvs"><div class="titlepage"><div><div><h4 class="title">5.7.1.2. Version management</h4></div></div></div><p>
						The <code class="literal">--version</code> flag for the <code class="literal">generate bundle</code> subcommand supplies a semantic version for your bundle when creating one for the first time and when upgrading an existing one.
					</p><p>
						By setting the <code class="literal">VERSION</code> variable in your <code class="literal">Makefile</code>, the <code class="literal">--version</code> flag is automatically invoked using that value when the <code class="literal">generate bundle</code> subcommand is run by the <code class="literal">make bundle</code> command. The CSV version is the same as the Operator version, and a new CSV is generated when upgrading Operator versions.
					</p></section></section><section class="section" id="osdk-manually-defined-csv-fields_osdk-generating-csvs"><div class="titlepage"><div><div><h3 class="title">5.7.2. Manually-defined CSV fields</h3></div></div></div><p>
					Many CSV fields cannot be populated using generated, generic manifests that are not specific to Operator SDK. These fields are mostly human-written metadata about the Operator and various custom resource definitions (CRDs).
				</p><p>
					Operator authors must directly modify their cluster service version (CSV) YAML file, adding personalized data to the following required fields. The Operator SDK gives a warning during CSV generation when a lack of data in any of the required fields is detected.
				</p><p>
					The following tables detail which manually-defined CSV fields are required and which are optional.
				</p><div class="table" id="idm139731978290144"><p class="title"><strong>Table 5.7. Required CSV fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 80%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731978285312" scope="col">Field</th><th align="left" valign="top" id="idm139731978284224" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731978285312"> <p>
									<code class="literal">metadata.name</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731978284224"> <p>
									A unique name for this CSV. Operator version should be included in the name to ensure uniqueness, for example <code class="literal">app-operator.v0.1.1</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731978285312"> <p>
									<code class="literal">metadata.capabilities</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731978284224"> <p>
									The capability level according to the Operator maturity model. Options include <code class="literal">Basic Install</code>, <code class="literal">Seamless Upgrades</code>, <code class="literal">Full Lifecycle</code>, <code class="literal">Deep Insights</code>, and <code class="literal">Auto Pilot</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731978285312"> <p>
									<code class="literal">spec.displayName</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731978284224"> <p>
									A public name to identify the Operator.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731978285312"> <p>
									<code class="literal">spec.description</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731978284224"> <p>
									A short description of the functionality of the Operator.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731978285312"> <p>
									<code class="literal">spec.keywords</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731978284224"> <p>
									Keywords describing the Operator.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731978285312"> <p>
									<code class="literal">spec.maintainers</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731978284224"> <p>
									Human or organizational entities maintaining the Operator, with a <code class="literal">name</code> and <code class="literal">email</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731978285312"> <p>
									<code class="literal">spec.provider</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731978284224"> <p>
									The provider of the Operator (usually an organization), with a <code class="literal">name</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731978285312"> <p>
									<code class="literal">spec.labels</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731978284224"> <p>
									Key-value pairs to be used by Operator internals.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731978285312"> <p>
									<code class="literal">spec.version</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731978284224"> <p>
									Semantic version of the Operator, for example <code class="literal">0.1.1</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731978285312"> <p>
									<code class="literal">spec.customresourcedefinitions</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731978284224"> <p>
									Any CRDs the Operator uses. This field is populated automatically by the Operator SDK if any CRD YAML files are present in <code class="literal">deploy/</code>. However, several fields not in the CRD manifest spec require user input:
								</p>
								 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<code class="literal">description</code>: description of the CRD.
										</li><li class="listitem">
											<code class="literal">resources</code>: any Kubernetes resources leveraged by the CRD, for example <code class="literal">Pod</code> and <code class="literal">StatefulSet</code> objects.
										</li><li class="listitem">
											<code class="literal">specDescriptors</code>: UI hints for inputs and outputs of the Operator.
										</li></ul></div>
								 </td></tr></tbody></table></div></div><div class="table" id="idm139731976557888"><p class="title"><strong>Table 5.8. Optional CSV fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 80%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731976553056" scope="col">Field</th><th align="left" valign="top" id="idm139731976551968" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731976553056"> <p>
									<code class="literal">spec.replaces</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731976551968"> <p>
									The name of the CSV being replaced by this CSV.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731976553056"> <p>
									<code class="literal">spec.links</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731976551968"> <p>
									URLs (for example, websites and documentation) pertaining to the Operator or application being managed, each with a <code class="literal">name</code> and <code class="literal">url</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731976553056"> <p>
									<code class="literal">spec.selector</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731976551968"> <p>
									Selectors by which the Operator can pair resources in a cluster.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731976553056"> <p>
									<code class="literal">spec.icon</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731976551968"> <p>
									A base64-encoded icon unique to the Operator, set in a <code class="literal">base64data</code> field with a <code class="literal">mediatype</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731976553056"> <p>
									<code class="literal">spec.maturity</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731976551968"> <p>
									The level of maturity the software has achieved at this version. Options include <code class="literal">planning</code>, <code class="literal">pre-alpha</code>, <code class="literal">alpha</code>, <code class="literal">beta</code>, <code class="literal">stable</code>, <code class="literal">mature</code>, <code class="literal">inactive</code>, and <code class="literal">deprecated</code>.
								</p>
								 </td></tr></tbody></table></div></div><p>
					Further details on what data each field above should hold are found in the <a class="link" href="https://github.com/operator-framework/operator-lifecycle-manager/blob/master/doc/design/building-your-csv.md">CSV spec</a>.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Several YAML fields currently requiring user intervention can potentially be parsed from Operator code.
					</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-maturity-model_olm-what-operators-are">Operator maturity model</a>
						</li></ul></div><section class="section" id="osdk-csv-manual-annotations_osdk-generating-csvs"><div class="titlepage"><div><div><h4 class="title">5.7.2.1. Operator metadata annotations</h4></div></div></div><p>
						Operator developers can manually define certain annotations in the metadata of a cluster service version (CSV) to enable features or highlight capabilities in user interfaces (UIs), such as OperatorHub.
					</p><p>
						The following table lists Operator metadata annotations that can be manually defined using <code class="literal">metadata.annotations</code> fields.
					</p><div class="table" id="idm139731976514368"><p class="title"><strong>Table 5.9. Annotations</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731976509536" scope="col">Field</th><th align="left" valign="top" id="idm139731976508448" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731976509536"> <p>
										<code class="literal">alm-examples</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976508448"> <p>
										Provide custom resource definition (CRD) templates with a minimum set of configuration. Compatible UIs pre-fill this template for users to further customize.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976509536"> <p>
										<code class="literal">operatorframework.io/initialization-resource</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976508448"> <p>
										Specify a single required custom resource by adding <code class="literal">operatorframework.io/initialization-resource</code> annotation to the cluster service version (CSV) during Operator installation. The user is then prompted to create the custom resource through a template provided in the CSV. Must include a template that contains a complete YAML definition.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976509536"> <p>
										<code class="literal">operatorframework.io/suggested-namespace</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976508448"> <p>
										Set a suggested namespace where the Operator should be deployed.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976509536"> <p>
										<code class="literal">operatorframework.io/suggested-namespace-template</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976508448"> <p>
										Set a manifest for a Namespace object with the namespace default node selector specified.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976509536"> <p>
										<code class="literal">operators.openshift.io/infrastructure-features</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976508448"> <p>
										Infrastructure features supported by the Operator. Users can view and filter by these features when discovering Operators through OperatorHub in the web console. Valid, case-sensitive values:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">disconnected</code>: Operator supports being mirrored into disconnected catalogs, including all dependencies, and does not require internet access. All related images required for mirroring are listed by the Operator.
											</li><li class="listitem">
												<code class="literal">cnf</code>: Operator provides a Cloud-native Network Functions (CNF) Kubernetes plugin.
											</li><li class="listitem">
												<code class="literal">cni</code>: Operator provides a Container Network Interface (CNI) Kubernetes plugin.
											</li><li class="listitem">
												<code class="literal">csi</code>: Operator provides a Container Storage Interface (CSI) Kubernetes plugin.
											</li></ul></div>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">proxy-aware</code>: Operator supports running on a cluster behind a proxy. Operator accepts the standard proxy environment variables <code class="literal">HTTP_PROXY</code> and <code class="literal">HTTPS_PROXY</code>, which Operator Lifecycle Manager (OLM) provides to the Operator automatically when the cluster is configured to use a proxy. Required environment variables are passed down to Operands for managed workloads.
											</li></ul></div>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976509536"> <p>
										<code class="literal">operators.openshift.io/valid-subscription</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976508448"> <p>
										Free-form array for listing any specific subscriptions that are required to use the Operator. For example, <code class="literal">'["3Scale Commercial License", "Red Hat Managed Integration"]'</code>.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976509536"> <p>
										<code class="literal">operators.operatorframework.io/internal-objects</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976508448"> <p>
										Hides CRDs in the UI that are not meant for user manipulation.
									</p>
									 </td></tr></tbody></table></div></div><h6 id="osdk-csv-manual-annotations-examples_osdk-generating-csvs">Example use cases</h6><div class="formalpara"><p class="title"><strong>Operator supports disconnected and proxy-aware</strong></p><p>
							
<pre class="programlisting language-terminal">operators.openshift.io/infrastructure-features: '["disconnected", "proxy-aware"]'</pre>

						</p></div><div class="formalpara"><p class="title"><strong>Operator requires an OpenShift Container Platform license</strong></p><p>
							
<pre class="programlisting language-terminal">operators.openshift.io/valid-subscription: '["OpenShift Container Platform"]'</pre>

						</p></div><div class="formalpara"><p class="title"><strong>Operator requires a 3scale license</strong></p><p>
							
<pre class="programlisting language-terminal">operators.openshift.io/valid-subscription: '["3Scale Commercial License", "Red Hat Managed Integration"]'</pre>

						</p></div><div class="formalpara"><p class="title"><strong>Operator supports disconnected and proxy-aware, and requires an OpenShift Container Platform license</strong></p><p>
							
<pre class="programlisting language-terminal">operators.openshift.io/infrastructure-features: '["disconnected", "proxy-aware"]'
operators.openshift.io/valid-subscription: '["OpenShift Container Platform"]'</pre>

						</p></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-crds-templates_osdk-generating-csvs">CRD templates</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-init-resource_osdk-generating-csvs">Initializing required custom resources </a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-suggested-namespace_osdk-generating-csvs">Setting a suggested namespace</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-suggested-namespace-default-node_osdk-generating-csvs">Setting a suggested namespace with default node selector</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-enabling-operator-for-restricted-network_osdk-generating-csvs">Enabling your Operator for restricted network environments</a> (disconnected mode)
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-hiding-internal-objects_osdk-generating-csvs">Hiding internal objects</a>
							</li></ul></div></section></section><section class="section" id="olm-enabling-operator-for-restricted-network_osdk-generating-csvs"><div class="titlepage"><div><div><h3 class="title">5.7.3. Enabling your Operator for restricted network environments</h3></div></div></div><p>
					As an Operator author, your Operator must meet additional requirements to run properly in a restricted network, or disconnected, environment.
				</p><div class="itemizedlist"><p class="title"><strong>Operator requirements for supporting disconnected mode</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Replace hard-coded image references with environment variables.
						</li><li class="listitem"><p class="simpara">
							In the cluster service version (CSV) of your Operator:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									List any <span class="emphasis"><em>related images</em></span>, or other container images that your Operator might require to perform their functions.
								</li><li class="listitem">
									Reference all specified images by a digest (SHA) and not by a tag.
								</li></ul></div></li><li class="listitem">
							All dependencies of your Operator must also support running in a disconnected mode.
						</li><li class="listitem">
							Your Operator must not require any off-cluster resources.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							An Operator project with a CSV. The following procedure uses the Memcached Operator as an example for Go-, Ansible-, and Helm-based projects.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Set an environment variable for the additional image references used by the Operator in the <code class="literal">config/manager/manager.yaml</code> file:
						</p><div class="example" id="idm139731975939312"><p class="title"><strong>Example 5.10. Example <code class="literal">config/manager/manager.yaml</code> file</strong></p><div class="example-contents"><pre class="programlisting language-yaml">...
spec:
  ...
    spec:
      ...
      containers:
      - command:
        - /manager
        ...
        env:
        - name: &lt;related_image_environment_variable&gt; <span id="CO66-1"><!--Empty--></span><span class="callout">1</span>
          value: "&lt;related_image_reference_with_tag&gt;" <span id="CO66-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO66-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Define the environment variable, such as <code class="literal">RELATED_IMAGE_MEMCACHED</code>.
									</div></dd><dt><a href="#CO66-2"><span class="callout">2</span></a> </dt><dd><div class="para">
										Set the related image reference and tag, such as <code class="literal">docker.io/memcached:1.4.36-alpine</code>.
									</div></dd></dl></div></div></div></li><li class="listitem"><p class="simpara">
							Replace hard-coded image references with environment variables in the relevant file for your Operator project type:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									For Go-based Operator projects, add the environment variable to the <code class="literal">controllers/memcached_controller.go</code> file as shown in the following example:
								</p><div class="example" id="idm139731975928064"><p class="title"><strong>Example 5.11. Example <code class="literal">controllers/memcached_controller.go</code> file</strong></p><div class="example-contents"><pre class="programlisting language-diff">  // deploymentForMemcached returns a memcached Deployment object

...

	Spec: corev1.PodSpec{
        	Containers: []corev1.Container{{
-			Image:   "memcached:1.4.36-alpine", <span id="CO67-1"><!--Empty--></span><span class="callout">1</span>
+			Image:   os.Getenv("&lt;related_image_environment_variable&gt;"), <span id="CO67-2"><!--Empty--></span><span class="callout">2</span>
			Name:    "memcached",
			Command: []string{"memcached", "-m=64", "-o", "modern", "-v"},
			Ports: []corev1.ContainerPort{{

...</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO67-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												Delete the image reference and tag.
											</div></dd><dt><a href="#CO67-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												Use the <code class="literal">os.Getenv</code> function to call the <code class="literal">&lt;related_image_environment_variable&gt;</code>.
											</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											The <code class="literal">os.Getenv</code> function returns an empty string if a variable is not set. Set the <code class="literal">&lt;related_image_environment_variable&gt;</code> before changing the file.
										</p></div></div></div></div></li><li class="listitem"><p class="simpara">
									For Ansible-based Operator projects, add the environment variable to the <code class="literal">roles/memcached/tasks/main.yml</code> file as shown in the following example:
								</p><div class="example" id="idm139731975915872"><p class="title"><strong>Example 5.12. Example <code class="literal">roles/memcached/tasks/main.yml</code> file</strong></p><div class="example-contents"><pre class="programlisting language-diff">spec:
  containers:
  - name: memcached
    command:
    - memcached
    - -m=64
    - -o
    - modern
    - -v
-   image: "docker.io/memcached:1.4.36-alpine" <span id="CO68-1"><!--Empty--></span><span class="callout">1</span>
+   image: "{{ lookup('env', '&lt;related_image_environment_variable&gt;') }}" <span id="CO68-2"><!--Empty--></span><span class="callout">2</span>
    ports:
      - containerPort: 11211

...</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO68-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												Delete the image reference and tag.
											</div></dd><dt><a href="#CO68-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												Use the <code class="literal">lookup</code> function to call the <code class="literal">&lt;related_image_environment_variable&gt;</code>.
											</div></dd></dl></div></div></div></li><li class="listitem"><p class="simpara">
									For Helm-based Operator projects, add the <code class="literal">overrideValues</code> field to the <code class="literal">watches.yaml</code> file as shown in the following example:
								</p><div class="example" id="idm139731975905296"><p class="title"><strong>Example 5.13. Example <code class="literal">watches.yaml</code> file</strong></p><div class="example-contents"><pre class="programlisting language-yaml">...
- group: demo.example.com
  version: v1alpha1
  kind: Memcached
  chart: helm-charts/memcached
  overrideValues: <span id="CO69-1"><!--Empty--></span><span class="callout">1</span>
    relatedImage: ${&lt;related_image_environment_variable&gt;} <span id="CO69-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO69-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												Add the <code class="literal">overrideValues</code> field.
											</div></dd><dt><a href="#CO69-2"><span class="callout">2</span></a> </dt><dd><div class="para">
												Define the <code class="literal">overrideValues</code> field by using the <code class="literal">&lt;related_image_environment_variable&gt;</code>, such as <code class="literal">RELATED_IMAGE_MEMCACHED</code>.
											</div></dd></dl></div></div></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Add the value of the <code class="literal">overrideValues</code> field to the <code class="literal">helm-charts/memchached/values.yaml</code> file as shown in the following example:
										</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">helm-charts/memchached/values.yaml</code> file</strong></p><p>
												
<pre class="programlisting language-yaml">...
relatedImage: ""</pre>

											</p></div></li><li class="listitem"><p class="simpara">
											Edit the chart template in the <code class="literal">helm-charts/memcached/templates/deployment.yaml</code> file as shown in the following example:
										</p><div class="example" id="idm139731974942304"><p class="title"><strong>Example 5.14. Example <code class="literal">helm-charts/memcached/templates/deployment.yaml</code> file</strong></p><div class="example-contents"><pre class="programlisting language-yaml">containers:
  - name: {{ .Chart.Name }}
    securityContext:
      - toYaml {{ .Values.securityContext | nindent 12 }}
    image: "{{ .Values.image.pullPolicy }}
    env: <span id="CO70-1"><!--Empty--></span><span class="callout">1</span>
      - name: related_image <span id="CO70-2"><!--Empty--></span><span class="callout">2</span>
        value: "{{ .Values.relatedImage }}" <span id="CO70-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO70-1"><span class="callout">1</span></a> </dt><dd><div class="para">
														Add the <code class="literal">env</code> field.
													</div></dd><dt><a href="#CO70-2"><span class="callout">2</span></a> </dt><dd><div class="para">
														Name the environment variable.
													</div></dd><dt><a href="#CO70-3"><span class="callout">3</span></a> </dt><dd><div class="para">
														Define the value of the environment variable.
													</div></dd></dl></div></div></div></li></ol></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Add the <code class="literal">BUNDLE_GEN_FLAGS</code> variable definition to your <code class="literal">Makefile</code> with the following changes:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">Makefile</code></strong></p><p>
								
<pre class="programlisting language-diff">   BUNDLE_GEN_FLAGS ?= -q --overwrite --version $(VERSION) $(BUNDLE_METADATA_OPTS)

   # USE_IMAGE_DIGESTS defines if images are resolved via tags or digests
   # You can enable this value if you would like to use SHA Based Digests
   # To enable set flag to true
   USE_IMAGE_DIGESTS ?= false
   ifeq ($(USE_IMAGE_DIGESTS), true)
         BUNDLE_GEN_FLAGS += --use-image-digests
   endif

...

-  $(KUSTOMIZE) build config/manifests | operator-sdk generate bundle -q --overwrite --version $(VERSION) $(BUNDLE_METADATA_OPTS) <span id="CO71-1"><!--Empty--></span><span class="callout">1</span>
+  $(KUSTOMIZE) build config/manifests | operator-sdk generate bundle $(BUNDLE_GEN_FLAGS) <span id="CO71-2"><!--Empty--></span><span class="callout">2</span>

...</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO71-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Delete this line in the <code class="literal">Makefile</code>.
								</div></dd><dt><a href="#CO71-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Replace the line above with this line.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							To update your Operator image to use a digest (SHA) and not a tag, run the <code class="literal">make bundle</code> command and set <code class="literal">USE_IMAGE_DIGESTS</code> to <code class="literal">true</code> :
						</p><pre class="programlisting language-terminal">$ make bundle USE_IMAGE_DIGESTS=true</pre></li><li class="listitem"><p class="simpara">
							Add the <code class="literal">disconnected</code> annotation, which indicates that the Operator works in a disconnected environment:
						</p><pre class="programlisting language-yaml">metadata:
  annotations:
    operators.openshift.io/infrastructure-features: '["disconnected"]'</pre><p class="simpara">
							Operators can be filtered in OperatorHub by this infrastructure feature.
						</p></li></ol></div></section><section class="section" id="olm-enabling-operator-for-multi-arch_osdk-generating-csvs"><div class="titlepage"><div><div><h3 class="title">5.7.4. Enabling your Operator for multiple architectures and operating systems</h3></div></div></div><p>
					Operator Lifecycle Manager (OLM) assumes that all Operators run on Linux hosts. However, as an Operator author, you can specify whether your Operator supports managing workloads on other architectures, if worker nodes are available in the OpenShift Container Platform cluster.
				</p><p>
					If your Operator supports variants other than AMD64 and Linux, you can add labels to the cluster service version (CSV) that provides the Operator to list the supported variants. Labels indicating supported architectures and operating systems are defined by the following:
				</p><pre class="programlisting language-yaml">labels:
    operatorframework.io/arch.&lt;arch&gt;: supported <span id="CO72-1"><!--Empty--></span><span class="callout">1</span>
    operatorframework.io/os.&lt;os&gt;: supported <span id="CO72-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO72-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							Set <code class="literal">&lt;arch&gt;</code> to a supported string.
						</div></dd><dt><a href="#CO72-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							Set <code class="literal">&lt;os&gt;</code> to a supported string.
						</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Only the labels on the channel head of the default channel are considered for filtering package manifests by label. This means, for example, that providing an additional architecture for an Operator in the non-default channel is possible, but that architecture is not available for filtering in the <code class="literal">PackageManifest</code> API.
					</p></div></div><p>
					If a CSV does not include an <code class="literal">os</code> label, it is treated as if it has the following Linux support label by default:
				</p><pre class="programlisting language-yaml">labels:
    operatorframework.io/os.linux: supported</pre><p>
					If a CSV does not include an <code class="literal">arch</code> label, it is treated as if it has the following AMD64 support label by default:
				</p><pre class="programlisting language-yaml">labels:
    operatorframework.io/arch.amd64: supported</pre><p>
					If an Operator supports multiple node architectures or operating systems, you can add multiple labels, as well.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							An Operator project with a CSV.
						</li><li class="listitem">
							To support listing multiple architectures and operating systems, your Operator image referenced in the CSV must be a manifest list image.
						</li><li class="listitem">
							For the Operator to work properly in restricted network, or disconnected, environments, the image referenced must also be specified using a digest (SHA) and not by a tag.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Add a label in the <code class="literal">metadata.labels</code> of your CSV for each supported architecture and operating system that your Operator supports:
						</p><pre class="programlisting language-yaml">labels:
  operatorframework.io/arch.s390x: supported
  operatorframework.io/os.zos: supported
  operatorframework.io/os.linux: supported <span id="CO73-1"><!--Empty--></span><span class="callout">1</span>
  operatorframework.io/arch.amd64: supported <span id="CO73-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO73-1"><span class="callout">1</span></a> <a href="#CO73-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									After you add a new architecture or operating system, you must also now include the default <code class="literal">os.linux</code> and <code class="literal">arch.amd64</code> variants explicitly.
								</div></dd></dl></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							See the <a class="link" href="https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list">Image Manifest V 2, Schema 2</a> specification for more information on manifest lists.
						</li></ul></div><section class="section" id="olm-arch-os-support_osdk-generating-csvs"><div class="titlepage"><div><div><h4 class="title">5.7.4.1. Architecture and operating system support for Operators</h4></div></div></div><p>
						The following strings are supported in Operator Lifecycle Manager (OLM) on OpenShift Container Platform when labeling or filtering Operators that support multiple architectures and operating systems:
					</p><div class="table" id="idm139731977293520"><p class="title"><strong>Table 5.10. Architectures supported on OpenShift Container Platform</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731977288656" scope="col">Architecture</th><th align="left" valign="top" id="idm139731977287568" scope="col">String</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731977288656"> <p>
										AMD64
									</p>
									 </td><td align="left" valign="top" headers="idm139731977287568"> <p>
										<code class="literal">amd64</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977288656"> <p>
										IBM Power
									</p>
									 </td><td align="left" valign="top" headers="idm139731977287568"> <p>
										<code class="literal">ppc64le</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977288656"> <p>
										IBM Z
									</p>
									 </td><td align="left" valign="top" headers="idm139731977287568"> <p>
										<code class="literal">s390x</code>
									</p>
									 </td></tr></tbody></table></div></div><div class="table" id="idm139731977273024"><p class="title"><strong>Table 5.11. Operating systems supported on OpenShift Container Platform</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731977268144" scope="col">Operating system</th><th align="left" valign="top" id="idm139731977267056" scope="col">String</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731977268144"> <p>
										Linux
									</p>
									 </td><td align="left" valign="top" headers="idm139731977267056"> <p>
										<code class="literal">linux</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977268144"> <p>
										z/OS
									</p>
									 </td><td align="left" valign="top" headers="idm139731977267056"> <p>
										<code class="literal">zos</code>
									</p>
									 </td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Different versions of OpenShift Container Platform and other Kubernetes-based distributions might support a different set of architectures and operating systems.
						</p></div></div></section></section><section class="section" id="osdk-suggested-namespace_osdk-generating-csvs"><div class="titlepage"><div><div><h3 class="title">5.7.5. Setting a suggested namespace</h3></div></div></div><p>
					Some Operators must be deployed in a specific namespace, or with ancillary resources in specific namespaces, to work properly. If resolved from a subscription, Operator Lifecycle Manager (OLM) defaults the namespaced resources of an Operator to the namespace of its subscription.
				</p><p>
					As an Operator author, you can instead express a desired target namespace as part of your cluster service version (CSV) to maintain control over the final namespaces of the resources installed for their Operators. When adding the Operator to a cluster using OperatorHub, this enables the web console to autopopulate the suggested namespace for the cluster administrator during the installation process.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							In your CSV, set the <code class="literal">operatorframework.io/suggested-namespace</code> annotation to your suggested namespace:
						</p><pre class="programlisting language-yaml">metadata:
  annotations:
    operatorframework.io/suggested-namespace: &lt;namespace&gt; <span id="CO74-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO74-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Set your suggested namespace.
								</div></dd></dl></div></li></ul></div></section><section class="section" id="osdk-suggested-namespace-default-node_osdk-generating-csvs"><div class="titlepage"><div><div><h3 class="title">5.7.6. Setting a suggested namespace with default node selector</h3></div></div></div><p>
					Some Operators expect to run only on control plane nodes, which can be done by setting a <code class="literal">nodeSelector</code> in the <code class="literal">Pod</code> spec by the Operator itself.
				</p><p>
					To avoid getting duplicated and potentially conflicting cluster-wide default <code class="literal">nodeSelector</code>, you can set a default node selector on the namespace where the Operator runs. The default node selector will take precedence over the cluster default so the cluster default will not be applied to the pods in the Operators namespace.
				</p><p>
					When adding the Operator to a cluster using OperatorHub, the web console auto-populates the suggested namespace for the cluster administrator during the installation process. The suggested namespace is created using the namespace manifest in YAML which is included in the cluster service version (CSV).
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							In your CSV, set the <code class="literal">operatorframework.io/suggested-namespace-template</code> with a manifest for a <code class="literal">Namespace</code> object. The following sample is a manifest for an example <code class="literal">Namespace</code> with the namespace default node selector specified:
						</p><pre class="programlisting language-yaml">metadata:
  annotations:
    operatorframework.io/suggested-namespace-template: <span id="CO75-1"><!--Empty--></span><span class="callout">1</span>
      {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "name": "vertical-pod-autoscaler-suggested-template",
          "annotations": {
            "openshift.io/node-selector": ""
          }
        }
      }</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO75-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Set your suggested namespace.
								</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								If both <code class="literal">suggested-namespace</code> and <code class="literal">suggested-namespace-template</code> annotations are present in the CSV, <code class="literal">suggested-namespace-template</code> should take precedence.
							</p></div></div></li></ul></div></section><section class="section" id="osdk-operatorconditions_osdk-generating-csvs"><div class="titlepage"><div><div><h3 class="title">5.7.7. Enabling Operator conditions</h3></div></div></div><p>
					Operator Lifecycle Manager (OLM) provides Operators with a channel to communicate complex states that influence OLM behavior while managing the Operator. By default, OLM creates an <code class="literal">OperatorCondition</code> custom resource definition (CRD) when it installs an Operator. Based on the conditions set in the <code class="literal">OperatorCondition</code> custom resource (CR), the behavior of OLM changes accordingly.
				</p><p>
					To support Operator conditions, an Operator must be able to read the <code class="literal">OperatorCondition</code> CR created by OLM and have the ability to complete the following tasks:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Get the specific condition.
						</li><li class="listitem">
							Set the status of a specific condition.
						</li></ul></div><p>
					This can be accomplished by using the <a class="link" href="https://github.com/operator-framework/operator-lib/tree/v0.11.0"><code class="literal">operator-lib</code></a> library. An Operator author can provide a <a class="link" href="https://github.com/kubernetes-sigs/controller-runtime/tree/master/pkg/client"><code class="literal">controller-runtime</code> client</a> in their Operator for the library to access the <code class="literal">OperatorCondition</code> CR owned by the Operator in the cluster.
				</p><p>
					The library provides a generic <code class="literal">Conditions</code> interface, which has the following methods to <code class="literal">Get</code> and <code class="literal">Set</code> a <code class="literal">conditionType</code> in the <code class="literal">OperatorCondition</code> CR:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">Get</code></span></dt><dd>
								To get the specific condition, the library uses the <code class="literal">client.Get</code> function from <code class="literal">controller-runtime</code>, which requires an <code class="literal">ObjectKey</code> of type <code class="literal">types.NamespacedName</code> present in <code class="literal">conditionAccessor</code>.
							</dd><dt><span class="term"><code class="literal">Set</code></span></dt><dd>
								To update the status of the specific condition, the library uses the <code class="literal">client.Update</code> function from <code class="literal">controller-runtime</code>. An error occurs if the <code class="literal">conditionType</code> is not present in the CRD.
							</dd></dl></div><p>
					The Operator is allowed to modify only the <code class="literal">status</code> subresource of the CR. Operators can either delete or update the <code class="literal">status.conditions</code> array to include the condition. For more details on the format and description of the fields present in the conditions, see the upstream <a class="link" href="https://godoc.org/k8s.io/apimachinery/pkg/apis/meta/v1#Condition">Condition GoDocs</a>.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Operator SDK 1.28.0 supports <code class="literal">operator-lib</code> v0.11.0.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							An Operator project generated using the Operator SDK.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						To enable Operator conditions in your Operator project:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							In the <code class="literal">go.mod</code> file of your Operator project, add <code class="literal">operator-framework/operator-lib</code> as a required library:
						</p><pre class="programlisting language-go">module github.com/example-inc/memcached-operator

go 1.15

require (
  k8s.io/apimachinery v0.19.2
  k8s.io/client-go v0.19.2
  sigs.k8s.io/controller-runtime v0.7.0
  operator-framework/operator-lib v0.3.0
)</pre></li><li class="listitem"><p class="simpara">
							Write your own constructor in your Operator logic that will result in the following outcomes:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Accepts a <code class="literal">controller-runtime</code> client.
								</li><li class="listitem">
									Accepts a <code class="literal">conditionType</code>.
								</li><li class="listitem">
									Returns a <code class="literal">Condition</code> interface to update or add conditions.
								</li></ul></div><p class="simpara">
							Because OLM currently supports the <code class="literal">Upgradeable</code> condition, you can create an interface that has methods to access the <code class="literal">Upgradeable</code> condition. For example:
						</p><pre class="programlisting language-go">import (
  ...
  apiv1 "github.com/operator-framework/api/pkg/operators/v1"
)

func NewUpgradeable(cl client.Client) (Condition, error) {
  return NewCondition(cl, "apiv1.OperatorUpgradeable")
}

cond, err := NewUpgradeable(cl);</pre><p class="simpara">
							In this example, the <code class="literal">NewUpgradeable</code> constructor is further used to create a variable <code class="literal">cond</code> of type <code class="literal">Condition</code>. The <code class="literal">cond</code> variable would in turn have <code class="literal">Get</code> and <code class="literal">Set</code> methods, which can be used for handling the OLM <code class="literal">Upgradeable</code> condition.
						</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-operatorconditions">Operator conditions</a>
						</li></ul></div></section><section class="section" id="olm-defining-csv-webhook_osdk-generating-csvs"><div class="titlepage"><div><div><h3 class="title">5.7.8. Defining webhooks</h3></div></div></div><p>
					Webhooks allow Operator authors to intercept, modify, and accept or reject resources before they are saved to the object store and handled by the Operator controller. Operator Lifecycle Manager (OLM) can manage the lifecycle of these webhooks when they are shipped alongside your Operator.
				</p><p>
					The cluster service version (CSV) resource of an Operator can include a <code class="literal">webhookdefinitions</code> section to define the following types of webhooks:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Admission webhooks (validating and mutating)
						</li><li class="listitem">
							Conversion webhooks
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Add a <code class="literal">webhookdefinitions</code> section to the <code class="literal">spec</code> section of the CSV of your Operator and include any webhook definitions using a <code class="literal">type</code> of <code class="literal">ValidatingAdmissionWebhook</code>, <code class="literal">MutatingAdmissionWebhook</code>, or <code class="literal">ConversionWebhook</code>. The following example contains all three types of webhooks:
						</p><div class="formalpara"><p class="title"><strong>CSV containing webhooks</strong></p><p>
								
<pre class="programlisting language-yaml">  apiVersion: operators.coreos.com/v1alpha1
  kind: ClusterServiceVersion
  metadata:
    name: webhook-operator.v0.0.1
  spec:
    customresourcedefinitions:
      owned:
      - kind: WebhookTest
        name: webhooktests.webhook.operators.coreos.io <span id="CO76-1"><!--Empty--></span><span class="callout">1</span>
        version: v1
    install:
      spec:
        deployments:
        - name: webhook-operator-webhook
          ...
          ...
          ...
      strategy: deployment
    installModes:
    - supported: false
      type: OwnNamespace
    - supported: false
      type: SingleNamespace
    - supported: false
      type: MultiNamespace
    - supported: true
      type: AllNamespaces
    webhookdefinitions:
    - type: ValidatingAdmissionWebhook <span id="CO76-2"><!--Empty--></span><span class="callout">2</span>
      admissionReviewVersions:
      - v1beta1
      - v1
      containerPort: 443
      targetPort: 4343
      deploymentName: webhook-operator-webhook
      failurePolicy: Fail
      generateName: vwebhooktest.kb.io
      rules:
      - apiGroups:
        - webhook.operators.coreos.io
        apiVersions:
        - v1
        operations:
        - CREATE
        - UPDATE
        resources:
        - webhooktests
      sideEffects: None
      webhookPath: /validate-webhook-operators-coreos-io-v1-webhooktest
    - type: MutatingAdmissionWebhook <span id="CO76-3"><!--Empty--></span><span class="callout">3</span>
      admissionReviewVersions:
      - v1beta1
      - v1
      containerPort: 443
      targetPort: 4343
      deploymentName: webhook-operator-webhook
      failurePolicy: Fail
      generateName: mwebhooktest.kb.io
      rules:
      - apiGroups:
        - webhook.operators.coreos.io
        apiVersions:
        - v1
        operations:
        - CREATE
        - UPDATE
        resources:
        - webhooktests
      sideEffects: None
      webhookPath: /mutate-webhook-operators-coreos-io-v1-webhooktest
    - type: ConversionWebhook <span id="CO76-4"><!--Empty--></span><span class="callout">4</span>
      admissionReviewVersions:
      - v1beta1
      - v1
      containerPort: 443
      targetPort: 4343
      deploymentName: webhook-operator-webhook
      generateName: cwebhooktest.kb.io
      sideEffects: None
      webhookPath: /convert
      conversionCRDs:
      - webhooktests.webhook.operators.coreos.io <span id="CO76-5"><!--Empty--></span><span class="callout">5</span>
...</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO76-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									The CRDs targeted by the conversion webhook must exist here.
								</div></dd><dt><a href="#CO76-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									A validating admission webhook.
								</div></dd><dt><a href="#CO76-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									A mutating admission webhook.
								</div></dd><dt><a href="#CO76-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									A conversion webhook.
								</div></dd><dt><a href="#CO76-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									The <code class="literal">spec.PreserveUnknownFields</code> property of each CRD must be set to <code class="literal">false</code> or <code class="literal">nil</code>.
								</div></dd></dl></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/architecture/#admission-webhook-types_admission-plug-ins">Types of webhook admission plugins</a>
						</li><li class="listitem"><p class="simpara">
							Kubernetes documentation:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<a class="link" href="https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#validatingadmissionwebhook">Validating admission webhooks</a>
								</li><li class="listitem">
									<a class="link" href="https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#mutatingadmissionwebhook">Mutating admission webhooks</a>
								</li><li class="listitem">
									<a class="link" href="https://kubernetes.io/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definition-versioning/#webhook-conversion">Conversion webhooks</a>
								</li></ul></div></li></ul></div><section class="section" id="olm-webhook-considerations_osdk-generating-csvs"><div class="titlepage"><div><div><h4 class="title">5.7.8.1. Webhook considerations for OLM</h4></div></div></div><p>
						When deploying an Operator with webhooks using Operator Lifecycle Manager (OLM), you must define the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The <code class="literal">type</code> field must be set to either <code class="literal">ValidatingAdmissionWebhook</code>, <code class="literal">MutatingAdmissionWebhook</code>, or <code class="literal">ConversionWebhook</code>, or the CSV will be placed in a failed phase.
							</li><li class="listitem">
								The CSV must contain a deployment whose name is equivalent to the value supplied in the <code class="literal">deploymentName</code> field of the <code class="literal">webhookdefinition</code>.
							</li></ul></div><p>
						When the webhook is created, OLM ensures that the webhook only acts upon namespaces that match the Operator group that the Operator is deployed in.
					</p><h5 id="olm-webhook-ca_osdk-generating-csvs">Certificate authority constraints</h5><p>
						OLM is configured to provide each deployment with a single certificate authority (CA). The logic that generates and mounts the CA into the deployment was originally used by the API service lifecycle logic. As a result:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The TLS certificate file is mounted to the deployment at <code class="literal">/apiserver.local.config/certificates/apiserver.crt</code>.
							</li><li class="listitem">
								The TLS key file is mounted to the deployment at <code class="literal">/apiserver.local.config/certificates/apiserver.key</code>.
							</li></ul></div><h5 id="olm-admission-webhook-constraints_osdk-generating-csvs">Admission webhook rules constraints</h5><p>
						To prevent an Operator from configuring the cluster into an unrecoverable state, OLM places the CSV in the failed phase if the rules defined in an admission webhook intercept any of the following requests:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Requests that target all groups
							</li><li class="listitem">
								Requests that target the <code class="literal">operators.coreos.com</code> group
							</li><li class="listitem">
								Requests that target the <code class="literal">ValidatingWebhookConfigurations</code> or <code class="literal">MutatingWebhookConfigurations</code> resources
							</li></ul></div><h5 id="olm-conversion-webhook-constraints_osdk-generating-csvs">Conversion webhook constraints</h5><p>
						OLM places the CSV in the failed phase if a conversion webhook definition does not adhere to the following constraints:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								CSVs featuring a conversion webhook can only support the <code class="literal">AllNamespaces</code> install mode.
							</li><li class="listitem">
								The CRD targeted by the conversion webhook must have its <code class="literal">spec.preserveUnknownFields</code> field set to <code class="literal">false</code> or <code class="literal">nil</code>.
							</li><li class="listitem">
								The conversion webhook defined in the CSV must target an owned CRD.
							</li><li class="listitem">
								There can only be one conversion webhook on the entire cluster for a given CRD.
							</li></ul></div></section></section><section class="section" id="osdk-crds_osdk-generating-csvs"><div class="titlepage"><div><div><h3 class="title">5.7.9. Understanding your custom resource definitions (CRDs)</h3></div></div></div><p>
					There are two types of custom resource definitions (CRDs) that your Operator can use: ones that are <span class="emphasis"><em>owned</em></span> by it and ones that it depends on, which are <span class="emphasis"><em>required</em></span>.
				</p><section class="section" id="osdk-crds-owned_osdk-generating-csvs"><div class="titlepage"><div><div><h4 class="title">5.7.9.1. Owned CRDs</h4></div></div></div><p>
						The custom resource definitions (CRDs) owned by your Operator are the most important part of your CSV. This establishes the link between your Operator and the required RBAC rules, dependency management, and other Kubernetes concepts.
					</p><p>
						It is common for your Operator to use multiple CRDs to link together concepts, such as top-level database configuration in one object and a representation of replica sets in another. Each one should be listed out in the CSV file.
					</p><div class="table" id="idm139731976408672"><p class="title"><strong>Table 5.12. Owned CRD fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 22%; " class="col_1"><!--Empty--></col><col style="width: 56%; " class="col_2"><!--Empty--></col><col style="width: 22%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731976402912" scope="col">Field</th><th align="left" valign="top" id="idm139731976401824" scope="col">Description</th><th align="left" valign="top" id="idm139731976400736" scope="col">Required/optional</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731976402912"> <p>
										<code class="literal">Name</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976401824"> <p>
										The full name of your CRD.
									</p>
									 </td><td align="left" valign="top" headers="idm139731976400736"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976402912"> <p>
										<code class="literal">Version</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976401824"> <p>
										The version of that object API.
									</p>
									 </td><td align="left" valign="top" headers="idm139731976400736"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976402912"> <p>
										<code class="literal">Kind</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976401824"> <p>
										The machine readable name of your CRD.
									</p>
									 </td><td align="left" valign="top" headers="idm139731976400736"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976402912"> <p>
										<code class="literal">DisplayName</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976401824"> <p>
										A human readable version of your CRD name, for example <code class="literal">MongoDB Standalone</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm139731976400736"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976402912"> <p>
										<code class="literal">Description</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976401824"> <p>
										A short description of how this CRD is used by the Operator or a description of the functionality provided by the CRD.
									</p>
									 </td><td align="left" valign="top" headers="idm139731976400736"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976402912"> <p>
										<code class="literal">Group</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976401824"> <p>
										The API group that this CRD belongs to, for example <code class="literal">database.example.com</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm139731976400736"> <p>
										Optional
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976402912"> <p>
										<code class="literal">Resources</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976401824"> <p>
										Your CRDs own one or more types of Kubernetes objects. These are listed in the <code class="literal">resources</code> section to inform your users of the objects they might need to troubleshoot or how to connect to the application, such as the service or ingress rule that exposes a database.
									</p>
									 <p>
										It is recommended to only list out the objects that are important to a human, not an exhaustive list of everything you orchestrate. For example, do not list config maps that store internal state that are not meant to be modified by a user.
									</p>
									 </td><td align="left" valign="top" headers="idm139731976400736"> <p>
										Optional
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976402912"> <p>
										<code class="literal">SpecDescriptors</code>, <code class="literal">StatusDescriptors</code>, and <code class="literal">ActionDescriptors</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976401824"> <p>
										These descriptors are a way to hint UIs with certain inputs or outputs of your Operator that are most important to an end user. If your CRD contains the name of a secret or config map that the user must provide, you can specify that here. These items are linked and highlighted in compatible UIs.
									</p>
									 <p>
										There are three types of descriptors:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">SpecDescriptors</code>: A reference to fields in the <code class="literal">spec</code> block of an object.
											</li><li class="listitem">
												<code class="literal">StatusDescriptors</code>: A reference to fields in the <code class="literal">status</code> block of an object.
											</li><li class="listitem">
												<code class="literal">ActionDescriptors</code>: A reference to actions that can be performed on an object.
											</li></ul></div>
									 <p>
										All descriptors accept the following fields:
									</p>
									 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">DisplayName</code>: A human readable name for the <code class="literal">Spec</code>, <code class="literal">Status</code>, or <code class="literal">Action</code>.
											</li><li class="listitem">
												<code class="literal">Description</code>: A short description of the <code class="literal">Spec</code>, <code class="literal">Status</code>, or <code class="literal">Action</code> and how it is used by the Operator.
											</li><li class="listitem">
												<code class="literal">Path</code>: A dot-delimited path of the field on the object that this descriptor describes.
											</li><li class="listitem">
												<code class="literal">X-Descriptors</code>: Used to determine which "capabilities" this descriptor has and which UI component to use. See the <span class="strong strong"><strong>openshift/console</strong></span> project for a canonical <a class="link" href="https://github.com/openshift/console/tree/release-4.3/frontend/packages/operator-lifecycle-manager/src/components/descriptors/types.ts">list of React UI X-Descriptors</a> for OpenShift Container Platform.
											</li></ul></div>
									 <p>
										Also see the <span class="strong strong"><strong>openshift/console</strong></span> project for more information on <a class="link" href="https://github.com/openshift/console/tree/release-4.3/frontend/packages/operator-lifecycle-manager/src/components/descriptors">Descriptors</a> in general.
									</p>
									 </td><td align="left" valign="top" headers="idm139731976400736"> <p>
										Optional
									</p>
									 </td></tr></tbody></table></div></div><p>
						The following example depicts a <code class="literal">MongoDB Standalone</code> CRD that requires some user input in the form of a secret and config map, and orchestrates services, stateful sets, pods and config maps:
					</p><div id="osdk-crds-owned-example_osdk-generating-csvs" class="formalpara"><p class="title"><strong>Example owned CRD</strong></p><p>
							
<pre class="programlisting language-yaml">      - displayName: MongoDB Standalone
        group: mongodb.com
        kind: MongoDbStandalone
        name: mongodbstandalones.mongodb.com
        resources:
          - kind: Service
            name: ''
            version: v1
          - kind: StatefulSet
            name: ''
            version: v1beta2
          - kind: Pod
            name: ''
            version: v1
          - kind: ConfigMap
            name: ''
            version: v1
        specDescriptors:
          - description: Credentials for Ops Manager or Cloud Manager.
            displayName: Credentials
            path: credentials
            x-descriptors:
              - 'urn:alm:descriptor:com.tectonic.ui:selector:core:v1:Secret'
          - description: Project this deployment belongs to.
            displayName: Project
            path: project
            x-descriptors:
              - 'urn:alm:descriptor:com.tectonic.ui:selector:core:v1:ConfigMap'
          - description: MongoDB version to be installed.
            displayName: Version
            path: version
            x-descriptors:
              - 'urn:alm:descriptor:com.tectonic.ui:label'
        statusDescriptors:
          - description: The status of each of the pods for the MongoDB cluster.
            displayName: Pod Status
            path: pods
            x-descriptors:
              - 'urn:alm:descriptor:com.tectonic.ui:podStatuses'
        version: v1
        description: &gt;-
          MongoDB Deployment consisting of only one host. No replication of
          data.</pre>

						</p></div></section><section class="section" id="osdk-crds-required_osdk-generating-csvs"><div class="titlepage"><div><div><h4 class="title">5.7.9.2. Required CRDs</h4></div></div></div><p>
						Relying on other required CRDs is completely optional and only exists to reduce the scope of individual Operators and provide a way to compose multiple Operators together to solve an end-to-end use case.
					</p><p>
						An example of this is an Operator that might set up an application and install an etcd cluster (from an etcd Operator) to use for distributed locking and a Postgres database (from a Postgres Operator) for data storage.
					</p><p>
						Operator Lifecycle Manager (OLM) checks against the available CRDs and Operators in the cluster to fulfill these requirements. If suitable versions are found, the Operators are started within the desired namespace and a service account created for each Operator to create, watch, and modify the Kubernetes resources required.
					</p><div class="table" id="idm139731979297920"><p class="title"><strong>Table 5.13. Required CRD fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 22%; " class="col_1"><!--Empty--></col><col style="width: 56%; " class="col_2"><!--Empty--></col><col style="width: 22%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731979292160" scope="col">Field</th><th align="left" valign="top" id="idm139731979291072" scope="col">Description</th><th align="left" valign="top" id="idm139731979289984" scope="col">Required/optional</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731979292160"> <p>
										<code class="literal">Name</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731979291072"> <p>
										The full name of the CRD you require.
									</p>
									 </td><td align="left" valign="top" headers="idm139731979289984"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731979292160"> <p>
										<code class="literal">Version</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731979291072"> <p>
										The version of that object API.
									</p>
									 </td><td align="left" valign="top" headers="idm139731979289984"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731979292160"> <p>
										<code class="literal">Kind</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731979291072"> <p>
										The Kubernetes object kind.
									</p>
									 </td><td align="left" valign="top" headers="idm139731979289984"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731979292160"> <p>
										<code class="literal">DisplayName</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731979291072"> <p>
										A human readable version of the CRD.
									</p>
									 </td><td align="left" valign="top" headers="idm139731979289984"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731979292160"> <p>
										<code class="literal">Description</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731979291072"> <p>
										A summary of how the component fits in your larger architecture.
									</p>
									 </td><td align="left" valign="top" headers="idm139731979289984"> <p>
										Required
									</p>
									 </td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example required CRD</strong></p><p>
							
<pre class="programlisting language-yaml">    required:
    - name: etcdclusters.etcd.database.coreos.com
      version: v1beta2
      kind: EtcdCluster
      displayName: etcd Cluster
      description: Represents a cluster of etcd nodes.</pre>

						</p></div></section><section class="section" id="olm-dependency-resolution-crd-upgrades_osdk-generating-csvs"><div class="titlepage"><div><div><h4 class="title">5.7.9.3. CRD upgrades</h4></div></div></div><p>
						OLM upgrades a custom resource definition (CRD) immediately if it is owned by a singular cluster service version (CSV). If a CRD is owned by multiple CSVs, then the CRD is upgraded when it has satisfied all of the following backward compatible conditions:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								All existing serving versions in the current CRD are present in the new CRD.
							</li><li class="listitem">
								All existing instances, or custom resources, that are associated with the serving versions of the CRD are valid when validated against the validation schema of the new CRD.
							</li></ul></div><section class="section" id="olm-dependency-resolution-adding-new-crd-version_osdk-generating-csvs"><div class="titlepage"><div><div><h5 class="title">5.7.9.3.1. Adding a new CRD version</h5></div></div></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
								To add a new version of a CRD to your Operator:
							</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Add a new entry in the CRD resource under the <code class="literal">versions</code> section of your CSV.
								</p><p class="simpara">
									For example, if the current CRD has a version <code class="literal">v1alpha1</code> and you want to add a new version <code class="literal">v1beta1</code> and mark it as the new storage version, add a new entry for <code class="literal">v1beta1</code>:
								</p><pre class="programlisting language-yaml">versions:
  - name: v1alpha1
    served: true
    storage: false
  - name: v1beta1 <span id="CO77-1"><!--Empty--></span><span class="callout">1</span>
    served: true
    storage: true</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO77-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											New entry.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Ensure the referencing version of the CRD in the <code class="literal">owned</code> section of your CSV is updated if the CSV intends to use the new version:
								</p><pre class="programlisting language-yaml">customresourcedefinitions:
  owned:
  - name: cluster.example.com
    version: v1beta1 <span id="CO78-1"><!--Empty--></span><span class="callout">1</span>
    kind: cluster
    displayName: Cluster</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO78-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Update the <code class="literal">version</code>.
										</div></dd></dl></div></li><li class="listitem">
									Push the updated CRD and CSV to your bundle.
								</li></ol></div></section><section class="section" id="olm-dependency-resolution-removing-crd-version_osdk-generating-csvs"><div class="titlepage"><div><div><h5 class="title">5.7.9.3.2. Deprecating or removing a CRD version</h5></div></div></div><p>
							Operator Lifecycle Manager (OLM) does not allow a serving version of a custom resource definition (CRD) to be removed right away. Instead, a deprecated version of the CRD must be first disabled by setting the <code class="literal">served</code> field in the CRD to <code class="literal">false</code>. Then, the non-serving version can be removed on the subsequent CRD upgrade.
						</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
								To deprecate and remove a specific version of a CRD:
							</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Mark the deprecated version as non-serving to indicate this version is no longer in use and may be removed in a subsequent upgrade. For example:
								</p><pre class="programlisting language-yaml">versions:
  - name: v1alpha1
    served: false <span id="CO79-1"><!--Empty--></span><span class="callout">1</span>
    storage: true</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO79-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Set to <code class="literal">false</code>.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Switch the <code class="literal">storage</code> version to a serving version if the version to be deprecated is currently the <code class="literal">storage</code> version. For example:
								</p><pre class="programlisting language-yaml">versions:
  - name: v1alpha1
    served: false
    storage: false <span id="CO80-1"><!--Empty--></span><span class="callout">1</span>
  - name: v1beta1
    served: true
    storage: true <span id="CO80-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO80-1"><span class="callout">1</span></a> <a href="#CO80-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Update the <code class="literal">storage</code> fields accordingly.
										</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										To remove a specific version that is or was the <code class="literal">storage</code> version from a CRD, that version must be removed from the <code class="literal">storedVersion</code> in the status of the CRD. OLM will attempt to do this for you if it detects a stored version no longer exists in the new CRD.
									</p></div></div></li><li class="listitem">
									Upgrade the CRD with the above changes.
								</li><li class="listitem"><p class="simpara">
									In subsequent upgrade cycles, the non-serving version can be removed completely from the CRD. For example:
								</p><pre class="programlisting language-yaml">versions:
  - name: v1beta1
    served: true
    storage: true</pre></li><li class="listitem">
									Ensure the referencing CRD version in the <code class="literal">owned</code> section of your CSV is updated accordingly if that version is removed from the CRD.
								</li></ol></div></section></section><section class="section" id="osdk-crds-templates_osdk-generating-csvs"><div class="titlepage"><div><div><h4 class="title">5.7.9.4. CRD templates</h4></div></div></div><p>
						Users of your Operator must be made aware of which options are required versus optional. You can provide templates for each of your custom resource definitions (CRDs) with a minimum set of configuration as an annotation named <code class="literal">alm-examples</code>. Compatible UIs will pre-fill this template for users to further customize.
					</p><p>
						The annotation consists of a list of the kind, for example, the CRD name and the corresponding <code class="literal">metadata</code> and <code class="literal">spec</code> of the Kubernetes object.
					</p><p>
						The following full example provides templates for <code class="literal">EtcdCluster</code>, <code class="literal">EtcdBackup</code> and <code class="literal">EtcdRestore</code>:
					</p><pre class="programlisting language-yaml">metadata:
  annotations:
    alm-examples: &gt;-
      [{"apiVersion":"etcd.database.coreos.com/v1beta2","kind":"EtcdCluster","metadata":{"name":"example","namespace":"&lt;operator_namespace&gt;"},"spec":{"size":3,"version":"3.2.13"}},{"apiVersion":"etcd.database.coreos.com/v1beta2","kind":"EtcdRestore","metadata":{"name":"example-etcd-cluster"},"spec":{"etcdCluster":{"name":"example-etcd-cluster"},"backupStorageType":"S3","s3":{"path":"&lt;full-s3-path&gt;","awsSecret":"&lt;aws-secret&gt;"}}},{"apiVersion":"etcd.database.coreos.com/v1beta2","kind":"EtcdBackup","metadata":{"name":"example-etcd-cluster-backup"},"spec":{"etcdEndpoints":["&lt;etcd-cluster-endpoints&gt;"],"storageType":"S3","s3":{"path":"&lt;full-s3-path&gt;","awsSecret":"&lt;aws-secret&gt;"}}}]</pre></section><section class="section" id="osdk-hiding-internal-objects_osdk-generating-csvs"><div class="titlepage"><div><div><h4 class="title">5.7.9.5. Hiding internal objects</h4></div></div></div><p>
						It is common practice for Operators to use custom resource definitions (CRDs) internally to accomplish a task. These objects are not meant for users to manipulate and can be confusing to users of the Operator. For example, a database Operator might have a <code class="literal">Replication</code> CRD that is created whenever a user creates a Database object with <code class="literal">replication: true</code>.
					</p><p>
						As an Operator author, you can hide any CRDs in the user interface that are not meant for user manipulation by adding the <code class="literal">operators.operatorframework.io/internal-objects</code> annotation to the cluster service version (CSV) of your Operator.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Before marking one of your CRDs as internal, ensure that any debugging information or configuration that might be required to manage the application is reflected on the status or <code class="literal">spec</code> block of your CR, if applicable to your Operator.
							</li><li class="listitem"><p class="simpara">
								Add the <code class="literal">operators.operatorframework.io/internal-objects</code> annotation to the CSV of your Operator to specify any internal objects to hide in the user interface:
							</p><div class="formalpara"><p class="title"><strong>Internal object annotation</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: ClusterServiceVersion
metadata:
  name: my-operator-v1.2.3
  annotations:
    operators.operatorframework.io/internal-objects: '["my.internal.crd1.io","my.internal.crd2.io"]' <span id="CO81-1"><!--Empty--></span><span class="callout">1</span>
...</pre>

								</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO81-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Set any internal CRDs as an array of strings.
									</div></dd></dl></div></li></ol></div></section><section class="section" id="osdk-init-resource_osdk-generating-csvs"><div class="titlepage"><div><div><h4 class="title">5.7.9.6. Initializing required custom resources</h4></div></div></div><p>
						An Operator might require the user to instantiate a custom resource before the Operator can be fully functional. However, it can be challenging for a user to determine what is required or how to define the resource.
					</p><p>
						As an Operator developer, you can specify a single required custom resource by adding <code class="literal">operatorframework.io/initialization-resource</code> to the cluster service version (CSV) during Operator installation. You are then prompted to create the custom resource through a template that is provided in the CSV. The annotation must include a template that contains a complete YAML definition that is required to initialize the resource during installation.
					</p><p>
						If this annotation is defined, after installing the Operator from the OpenShift Container Platform web console, the user is prompted to create the resource using the template provided in the CSV.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Add the <code class="literal">operatorframework.io/initialization-resource</code> annotation to the CSV of your Operator to specify a required custom resource. For example, the following annotation requires the creation of a <code class="literal">StorageCluster</code> resource and provides a full YAML definition:
							</p><div class="formalpara"><p class="title"><strong>Initialization resource annotation</strong></p><p>
									
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: ClusterServiceVersion
metadata:
  name: my-operator-v1.2.3
  annotations:
    operatorframework.io/initialization-resource: |-
        {
            "apiVersion": "ocs.openshift.io/v1",
            "kind": "StorageCluster",
            "metadata": {
                "name": "example-storagecluster"
            },
            "spec": {
                "manageNodes": false,
                "monPVCTemplate": {
                    "spec": {
                        "accessModes": [
                            "ReadWriteOnce"
                        ],
                        "resources": {
                            "requests": {
                                "storage": "10Gi"
                            }
                        },
                        "storageClassName": "gp2"
                    }
                },
                "storageDeviceSets": [
                    {
                        "count": 3,
                        "dataPVCTemplate": {
                            "spec": {
                                "accessModes": [
                                    "ReadWriteOnce"
                                ],
                                "resources": {
                                    "requests": {
                                        "storage": "1Ti"
                                    }
                                },
                                "storageClassName": "gp2",
                                "volumeMode": "Block"
                            }
                        },
                        "name": "example-deviceset",
                        "placement": {},
                        "portable": true,
                        "resources": {}
                    }
                ]
            }
        }
...</pre>

								</p></div></li></ul></div></section></section><section class="section" id="osdk-apiservices_osdk-generating-csvs"><div class="titlepage"><div><div><h3 class="title">5.7.10. Understanding your API services</h3></div></div></div><p>
					As with CRDs, there are two types of API services that your Operator may use: <span class="emphasis"><em>owned</em></span> and <span class="emphasis"><em>required</em></span>.
				</p><section class="section" id="osdk-apiservices-owned_osdk-generating-csvs"><div class="titlepage"><div><div><h4 class="title">5.7.10.1. Owned API services</h4></div></div></div><p>
						When a CSV owns an API service, it is responsible for describing the deployment of the extension <code class="literal">api-server</code> that backs it and the group/version/kind (GVK) it provides.
					</p><p>
						An API service is uniquely identified by the group/version it provides and can be listed multiple times to denote the different kinds it is expected to provide.
					</p><div class="table" id="idm139731978760896"><p class="title"><strong>Table 5.14. Owned API service fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 22%; " class="col_1"><!--Empty--></col><col style="width: 56%; " class="col_2"><!--Empty--></col><col style="width: 22%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731978755120" scope="col">Field</th><th align="left" valign="top" id="idm139731978754032" scope="col">Description</th><th align="left" valign="top" id="idm139731978752944" scope="col">Required/optional</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731978755120"> <p>
										<code class="literal">Group</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978754032"> <p>
										Group that the API service provides, for example <code class="literal">database.example.com</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm139731978752944"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978755120"> <p>
										<code class="literal">Version</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978754032"> <p>
										Version of the API service, for example <code class="literal">v1alpha1</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm139731978752944"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978755120"> <p>
										<code class="literal">Kind</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978754032"> <p>
										A kind that the API service is expected to provide.
									</p>
									 </td><td align="left" valign="top" headers="idm139731978752944"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978755120"> <p>
										<code class="literal">Name</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978754032"> <p>
										The plural name for the API service provided.
									</p>
									 </td><td align="left" valign="top" headers="idm139731978752944"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978755120"> <p>
										<code class="literal">DeploymentName</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978754032"> <p>
										Name of the deployment defined by your CSV that corresponds to your API service (required for owned API services). During the CSV pending phase, the OLM Operator searches the <code class="literal">InstallStrategy</code> of your CSV for a <code class="literal">Deployment</code> spec with a matching name, and if not found, does not transition the CSV to the "Install Ready" phase.
									</p>
									 </td><td align="left" valign="top" headers="idm139731978752944"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978755120"> <p>
										<code class="literal">DisplayName</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978754032"> <p>
										A human readable version of your API service name, for example <code class="literal">MongoDB Standalone</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm139731978752944"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978755120"> <p>
										<code class="literal">Description</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978754032"> <p>
										A short description of how this API service is used by the Operator or a description of the functionality provided by the API service.
									</p>
									 </td><td align="left" valign="top" headers="idm139731978752944"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978755120"> <p>
										<code class="literal">Resources</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978754032"> <p>
										Your API services own one or more types of Kubernetes objects. These are listed in the resources section to inform your users of the objects they might need to troubleshoot or how to connect to the application, such as the service or ingress rule that exposes a database.
									</p>
									 <p>
										It is recommended to only list out the objects that are important to a human, not an exhaustive list of everything you orchestrate. For example, do not list config maps that store internal state that are not meant to be modified by a user.
									</p>
									 </td><td align="left" valign="top" headers="idm139731978752944"> <p>
										Optional
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731978755120"> <p>
										<code class="literal">SpecDescriptors</code>, <code class="literal">StatusDescriptors</code>, and <code class="literal">ActionDescriptors</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731978754032"> <p>
										Essentially the same as for owned CRDs.
									</p>
									 </td><td align="left" valign="top" headers="idm139731978752944"> <p>
										Optional
									</p>
									 </td></tr></tbody></table></div></div><section class="section" id="osdk-apiservices-resource-creation_osdk-generating-csvs"><div class="titlepage"><div><div><h5 class="title">5.7.10.1.1. API service resource creation</h5></div></div></div><p>
							Operator Lifecycle Manager (OLM) is responsible for creating or replacing the service and API service resources for each unique owned API service:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Service pod selectors are copied from the CSV deployment matching the <code class="literal">DeploymentName</code> field of the API service description.
								</li><li class="listitem">
									A new CA key/certificate pair is generated for each installation and the base64-encoded CA bundle is embedded in the respective API service resource.
								</li></ul></div></section><section class="section" id="osdk-apiservices-service-certs_osdk-generating-csvs"><div class="titlepage"><div><div><h5 class="title">5.7.10.1.2. API service serving certificates</h5></div></div></div><p>
							OLM handles generating a serving key/certificate pair whenever an owned API service is being installed. The serving certificate has a common name (CN) containing the hostname of the generated <code class="literal">Service</code> resource and is signed by the private key of the CA bundle embedded in the corresponding API service resource.
						</p><p>
							The certificate is stored as a type <code class="literal">kubernetes.io/tls</code> secret in the deployment namespace, and a volume named <code class="literal">apiservice-cert</code> is automatically appended to the volumes section of the deployment in the CSV matching the <code class="literal">DeploymentName</code> field of the API service description.
						</p><p>
							If one does not already exist, a volume mount with a matching name is also appended to all containers of that deployment. This allows users to define a volume mount with the expected name to accommodate any custom path requirements. The path of the generated volume mount defaults to <code class="literal">/apiserver.local.config/certificates</code> and any existing volume mounts with the same path are replaced.
						</p></section></section><section class="section" id="osdk-apiservice-required_osdk-generating-csvs"><div class="titlepage"><div><div><h4 class="title">5.7.10.2. Required API services</h4></div></div></div><p>
						OLM ensures all required CSVs have an API service that is available and all expected GVKs are discoverable before attempting installation. This allows a CSV to rely on specific kinds provided by API services it does not own.
					</p><div class="table" id="idm139731976736896"><p class="title"><strong>Table 5.15. Required API service fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 22%; " class="col_1"><!--Empty--></col><col style="width: 56%; " class="col_2"><!--Empty--></col><col style="width: 22%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731976731120" scope="col">Field</th><th align="left" valign="top" id="idm139731976730032" scope="col">Description</th><th align="left" valign="top" id="idm139731976728944" scope="col">Required/optional</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731976731120"> <p>
										<code class="literal">Group</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976730032"> <p>
										Group that the API service provides, for example <code class="literal">database.example.com</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm139731976728944"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976731120"> <p>
										<code class="literal">Version</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976730032"> <p>
										Version of the API service, for example <code class="literal">v1alpha1</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm139731976728944"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976731120"> <p>
										<code class="literal">Kind</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976730032"> <p>
										A kind that the API service is expected to provide.
									</p>
									 </td><td align="left" valign="top" headers="idm139731976728944"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976731120"> <p>
										<code class="literal">DisplayName</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976730032"> <p>
										A human readable version of your API service name, for example <code class="literal">MongoDB Standalone</code>.
									</p>
									 </td><td align="left" valign="top" headers="idm139731976728944"> <p>
										Required
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731976731120"> <p>
										<code class="literal">Description</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731976730032"> <p>
										A short description of how this API service is used by the Operator or a description of the functionality provided by the API service.
									</p>
									 </td><td align="left" valign="top" headers="idm139731976728944"> <p>
										Required
									</p>
									 </td></tr></tbody></table></div></div></section></section></section><section class="section" id="osdk-working-bundle-images"><div class="titlepage"><div><div><h2 class="title">5.8. Working with bundle images</h2></div></div></div><p>
				You can use the Operator SDK to package, deploy, and upgrade Operators in the bundle format for use on Operator Lifecycle Manager (OLM).
			</p><section class="section" id="osdk-bundle-operator_osdk-working-bundle-images"><div class="titlepage"><div><div><h3 class="title">5.8.1. Bundling an Operator</h3></div></div></div><p>
					The Operator bundle format is the default packaging method for Operator SDK and Operator Lifecycle Manager (OLM). You can get your Operator ready for use on OLM by using the Operator SDK to build and push your Operator project as a bundle image.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Operator SDK CLI installed on a development workstation
						</li><li class="listitem">
							OpenShift CLI (<code class="literal">oc</code>) v4.13+ installed
						</li><li class="listitem">
							Operator project initialized by using the Operator SDK
						</li><li class="listitem">
							If your Operator is Go-based, your project must be updated to use supported images for running on OpenShift Container Platform
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the following <code class="literal">make</code> commands in your Operator project directory to build and push your Operator image. Modify the <code class="literal">IMG</code> argument in the following steps to reference a repository that you have access to. You can obtain an account for storing containers at repository sites such as Quay.io.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Build the image:
								</p><pre class="programlisting language-terminal">$ make docker-build IMG=&lt;registry&gt;/&lt;user&gt;/&lt;operator_image_name&gt;:&lt;tag&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										The Dockerfile generated by the SDK for the Operator explicitly references <code class="literal">GOARCH=amd64</code> for <code class="literal">go build</code>. This can be amended to <code class="literal">GOARCH=$TARGETARCH</code> for non-AMD64 architectures. Docker will automatically set the environment variable to the value specified by <code class="literal">–platform</code>. With Buildah, the <code class="literal">–build-arg</code> will need to be used for the purpose. For more information, see <a class="link" href="https://sdk.operatorframework.io/docs/advanced-topics/multi-arch/#supporting-multiple-architectures">Multiple Architectures</a>.
									</p></div></div></li><li class="listitem"><p class="simpara">
									Push the image to a repository:
								</p><pre class="programlisting language-terminal">$ make docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;operator_image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create your Operator bundle manifest by running the <code class="literal">make bundle</code> command, which invokes several commands, including the Operator SDK <code class="literal">generate bundle</code> and <code class="literal">bundle validate</code> subcommands:
						</p><pre class="programlisting language-terminal">$ make bundle IMG=&lt;registry&gt;/&lt;user&gt;/&lt;operator_image_name&gt;:&lt;tag&gt;</pre><p class="simpara">
							Bundle manifests for an Operator describe how to display, create, and manage an application. The <code class="literal">make bundle</code> command creates the following files and directories in your Operator project:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									A bundle manifests directory named <code class="literal">bundle/manifests</code> that contains a <code class="literal">ClusterServiceVersion</code> object
								</li><li class="listitem">
									A bundle metadata directory named <code class="literal">bundle/metadata</code>
								</li><li class="listitem">
									All custom resource definitions (CRDs) in a <code class="literal">config/crd</code> directory
								</li><li class="listitem">
									A Dockerfile <code class="literal">bundle.Dockerfile</code>
								</li></ul></div><p class="simpara">
							These files are then automatically validated by using <code class="literal">operator-sdk bundle validate</code> to ensure the on-disk bundle representation is correct.
						</p></li><li class="listitem"><p class="simpara">
							Build and push your bundle image by running the following commands. OLM consumes Operator bundles using an index image, which reference one or more bundle images.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Build the bundle image. Set <code class="literal">BUNDLE_IMG</code> with the details for the registry, user namespace, and image tag where you intend to push the image:
								</p><pre class="programlisting language-terminal">$ make bundle-build BUNDLE_IMG=&lt;registry&gt;/&lt;user&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt;</pre></li><li class="listitem"><p class="simpara">
									Push the bundle image:
								</p><pre class="programlisting language-terminal">$ docker push &lt;registry&gt;/&lt;user&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li></ol></div></section><section class="section" id="osdk-deploy-olm_osdk-working-bundle-images"><div class="titlepage"><div><div><h3 class="title">5.8.2. Deploying an Operator with Operator Lifecycle Manager</h3></div></div></div><p>
					Operator Lifecycle Manager (OLM) helps you to install, update, and manage the lifecycle of Operators and their associated services on a Kubernetes cluster. OLM is installed by default on OpenShift Container Platform and runs as a Kubernetes extension so that you can use the web console and the OpenShift CLI (<code class="literal">oc</code>) for all Operator lifecycle management functions without any additional tools.
				</p><p>
					The Operator bundle format is the default packaging method for Operator SDK and OLM. You can use the Operator SDK to quickly run a bundle image on OLM to ensure that it runs properly.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Operator SDK CLI installed on a development workstation
						</li><li class="listitem">
							Operator bundle image built and pushed to a registry
						</li><li class="listitem">
							OLM installed on a Kubernetes-based cluster (v1.16.0 or later if you use <code class="literal">apiextensions.k8s.io/v1</code> CRDs, for example OpenShift Container Platform 4.13)
						</li><li class="listitem">
							Logged in to the cluster with <code class="literal">oc</code> using an account with <code class="literal">cluster-admin</code> permissions
						</li><li class="listitem">
							If your Operator is Go-based, your project must be updated to use supported images for running on OpenShift Container Platform
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Enter the following command to run the Operator on the cluster:
						</p><pre class="programlisting language-terminal">$ operator-sdk run bundle \<span id="CO82-1"><!--Empty--></span><span class="callout">1</span>
    -n &lt;namespace&gt; \<span id="CO82-2"><!--Empty--></span><span class="callout">2</span>
    &lt;registry&gt;/&lt;user&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt; <span id="CO82-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO82-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									The <code class="literal">run bundle</code> command creates a valid file-based catalog and installs the Operator bundle on your cluster using OLM.
								</div></dd><dt><a href="#CO82-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Optional: By default, the command installs the Operator in the currently active project in your <code class="literal">~/.kube/config</code> file. You can add the <code class="literal">-n</code> flag to set a different namespace scope for the installation.
								</div></dd><dt><a href="#CO82-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									If you do not specify an image, the command uses <code class="literal">quay.io/operator-framework/opm:latest</code> as the default index image. If you specify an image, the command uses the bundle image itself as the index image.
								</div></dd></dl></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								As of OpenShift Container Platform 4.11, the <code class="literal">run bundle</code> command supports the file-based catalog format for Operator catalogs by default. The deprecated SQLite database format for Operator catalogs continues to be supported; however, it will be removed in a future release. It is recommended that Operator authors migrate their workflows to the file-based catalog format.
							</p></div></div><p class="simpara">
							This command performs the following actions:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Create an index image referencing your bundle image. The index image is opaque and ephemeral, but accurately reflects how a bundle would be added to a catalog in production.
								</li><li class="listitem">
									Create a catalog source that points to your new index image, which enables OperatorHub to discover your Operator.
								</li><li class="listitem">
									Deploy your Operator to your cluster by creating an <code class="literal">OperatorGroup</code>, <code class="literal">Subscription</code>, <code class="literal">InstallPlan</code>, and all other required resources, including RBAC.
								</li></ul></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-file-based-catalogs_olm-packaging-format">File-based catalogs</a> in Operator Framework packaging format
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-managing-custom-catalogs-fb">File-based catalogs</a> in Managing custom catalogs
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-bundle-format_olm-packaging-format">Bundle format</a>
						</li></ul></div></section><section class="section" id="osdk-publish-catalog_osdk-working-bundle-images"><div class="titlepage"><div><div><h3 class="title">5.8.3. Publishing a catalog containing a bundled Operator</h3></div></div></div><p>
					To install and manage Operators, Operator Lifecycle Manager (OLM) requires that Operator bundles are listed in an index image, which is referenced by a catalog on the cluster. As an Operator author, you can use the Operator SDK to create an index containing the bundle for your Operator and all of its dependencies. This is useful for testing on remote clusters and publishing to container registries.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The Operator SDK uses the <code class="literal">opm</code> CLI to facilitate index image creation. Experience with the <code class="literal">opm</code> command is not required. For advanced use cases, the <code class="literal">opm</code> command can be used directly instead of the Operator SDK.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Operator SDK CLI installed on a development workstation
						</li><li class="listitem">
							Operator bundle image built and pushed to a registry
						</li><li class="listitem">
							OLM installed on a Kubernetes-based cluster (v1.16.0 or later if you use <code class="literal">apiextensions.k8s.io/v1</code> CRDs, for example OpenShift Container Platform 4.13)
						</li><li class="listitem">
							Logged in to the cluster with <code class="literal">oc</code> using an account with <code class="literal">cluster-admin</code> permissions
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the following <code class="literal">make</code> command in your Operator project directory to build an index image containing your Operator bundle:
						</p><pre class="programlisting language-terminal">$ make catalog-build CATALOG_IMG=&lt;registry&gt;/&lt;user&gt;/&lt;index_image_name&gt;:&lt;tag&gt;</pre><p class="simpara">
							where the <code class="literal">CATALOG_IMG</code> argument references a repository that you have access to. You can obtain an account for storing containers at repository sites such as Quay.io.
						</p></li><li class="listitem"><p class="simpara">
							Push the built index image to a repository:
						</p><pre class="programlisting language-terminal">$ make catalog-push CATALOG_IMG=&lt;registry&gt;/&lt;user&gt;/&lt;index_image_name&gt;:&lt;tag&gt;</pre><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
							You can use Operator SDK <code class="literal">make</code> commands together if you would rather perform multiple actions in sequence at once. For example, if you had not yet built a bundle image for your Operator project, you can build and push both a bundle image and an index image with the following syntax:
						</p><pre class="programlisting language-terminal">$ make bundle-build bundle-push catalog-build catalog-push \
    BUNDLE_IMG=&lt;bundle_image_pull_spec&gt; \
    CATALOG_IMG=&lt;index_image_pull_spec&gt;</pre><p>
							Alternatively, you can set the <code class="literal">IMAGE_TAG_BASE</code> field in your <code class="literal">Makefile</code> to an existing repository:
						</p><pre class="programlisting language-terminal">IMAGE_TAG_BASE=quay.io/example/my-operator</pre><p>
							You can then use the following syntax to build and push images with automatically-generated names, such as <code class="literal">quay.io/example/my-operator-bundle:v0.0.1</code> for the bundle image and <code class="literal">quay.io/example/my-operator-catalog:v0.0.1</code> for the index image:
						</p><pre class="programlisting language-terminal">$ make bundle-build bundle-push catalog-build catalog-push</pre></div></div></li><li class="listitem"><p class="simpara">
							Define a <code class="literal">CatalogSource</code> object that references the index image you just generated, and then create the object by using the <code class="literal">oc apply</code> command or web console:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">CatalogSource</code> YAML</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: CatalogSource
metadata:
  name: cs-memcached
  namespace: &lt;operator_namespace&gt;
spec:
  displayName: My Test
  publisher: Company
  sourceType: grpc
  grpcPodConfig:
    securityContextConfig: &lt;security_mode&gt; <span id="CO83-1"><!--Empty--></span><span class="callout">1</span>
  image: quay.io/example/memcached-catalog:v0.0.1 <span id="CO83-2"><!--Empty--></span><span class="callout">2</span>
  updateStrategy:
    registryPoll:
      interval: 10m</pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO83-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Specify the value of <code class="literal">legacy</code> or <code class="literal">restricted</code>. If the field is not set, the default value is <code class="literal">legacy</code>. In a future OpenShift Container Platform release, it is planned that the default value will be <code class="literal">restricted</code>. If your catalog cannot run with <code class="literal">restricted</code> permissions, it is recommended that you manually set this field to <code class="literal">legacy</code>.
								</div></dd><dt><a href="#CO83-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Set <code class="literal">image</code> to the image pull spec you used previously with the <code class="literal">CATALOG_IMG</code> argument.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Check the catalog source:
						</p><pre class="programlisting language-terminal">$ oc get catalogsource</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME           DISPLAY     TYPE   PUBLISHER   AGE
cs-memcached   My Test     grpc   Company     4h31m</pre>

							</p></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Install the Operator using your catalog:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Define an <code class="literal">OperatorGroup</code> object and create it by using the <code class="literal">oc apply</code> command or web console:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">OperatorGroup</code> YAML</strong></p><p>
										
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: my-test
  namespace: &lt;operator_namespace&gt;
spec:
  targetNamespaces:
  - &lt;operator_namespace&gt;</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Define a <code class="literal">Subscription</code> object and create it by using the <code class="literal">oc apply</code> command or web console:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">Subscription</code> YAML</strong></p><p>
										
<pre class="programlisting language-yaml">﻿apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: catalogtest
  namespace: &lt;catalog_namespace&gt;
spec:
  channel: "alpha"
  installPlanApproval: Manual
  name: catalog
  source: cs-memcached
  sourceNamespace: &lt;operator_namespace&gt;
  startingCSV: memcached-operator.v0.0.1</pre>

									</p></div></li></ol></div></li><li class="listitem"><p class="simpara">
							Verify the installed Operator is running:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Check the Operator group:
								</p><pre class="programlisting language-terminal">$ oc get og</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME             AGE
my-test           4h40m</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Check the cluster service version (CSV):
								</p><pre class="programlisting language-terminal">$ oc get csv</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME                        DISPLAY   VERSION   REPLACES   PHASE
memcached-operator.v0.0.1   Test      0.0.1                Succeeded</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Check the pods for the Operator:
								</p><pre class="programlisting language-terminal">$ oc get pods</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME                                                              READY   STATUS      RESTARTS   AGE
9098d908802769fbde8bd45255e69710a9f8420a8f3d814abe88b68f8ervdj6   0/1     Completed   0          4h33m
catalog-controller-manager-7fd5b7b987-69s4n                       2/2     Running     0          4h32m
cs-memcached-7622r                                                1/1     Running     0          4h33m</pre>

									</p></div></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-managing-custom-catalogs">Managing custom catalogs</a> for details on direct usage of the <code class="literal">opm</code> CLI for more advanced use cases.
						</li></ul></div></section><section class="section" id="osdk-bundle-upgrade-olm_osdk-working-bundle-images"><div class="titlepage"><div><div><h3 class="title">5.8.4. Testing an Operator upgrade on Operator Lifecycle Manager</h3></div></div></div><p>
					You can quickly test upgrading your Operator by using Operator Lifecycle Manager (OLM) integration in the Operator SDK, without requiring you to manually manage index images and catalog sources.
				</p><p>
					The <code class="literal">run bundle-upgrade</code> subcommand automates triggering an installed Operator to upgrade to a later version by specifying a bundle image for the later version.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Operator installed with OLM either by using the <code class="literal">run bundle</code> subcommand or with traditional OLM installation
						</li><li class="listitem">
							A bundle image that represents a later version of the installed Operator
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							If your Operator has not already been installed with OLM, install the earlier version either by using the <code class="literal">run bundle</code> subcommand or with traditional OLM installation.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								If the earlier version of the bundle was installed traditionally using OLM, the newer bundle that you intend to upgrade to must not exist in the index image referenced by the catalog source. Otherwise, running the <code class="literal">run bundle-upgrade</code> subcommand will cause the registry pod to fail because the newer bundle is already referenced by the index that provides the package and cluster service version (CSV).
							</p></div></div><p class="simpara">
							For example, you can use the following <code class="literal">run bundle</code> subcommand for a Memcached Operator by specifying the earlier bundle image:
						</p><pre class="programlisting language-terminal">$ operator-sdk run bundle &lt;registry&gt;/&lt;user&gt;/memcached-operator:v0.0.1</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">INFO[0006] Creating a File-Based Catalog of the bundle "quay.io/demo/memcached-operator:v0.0.1"
INFO[0008] Generated a valid File-Based Catalog
INFO[0012] Created registry pod: quay-io-demo-memcached-operator-v1-0-1
INFO[0012] Created CatalogSource: memcached-operator-catalog
INFO[0012] OperatorGroup "operator-sdk-og" created
INFO[0012] Created Subscription: memcached-operator-v0-0-1-sub
INFO[0015] Approved InstallPlan install-h9666 for the Subscription: memcached-operator-v0-0-1-sub
INFO[0015] Waiting for ClusterServiceVersion "my-project/memcached-operator.v0.0.1" to reach 'Succeeded' phase
INFO[0015] Waiting for ClusterServiceVersion ""my-project/memcached-operator.v0.0.1" to appear
INFO[0026] Found ClusterServiceVersion "my-project/memcached-operator.v0.0.1" phase: Pending
INFO[0028] Found ClusterServiceVersion "my-project/memcached-operator.v0.0.1" phase: Installing
INFO[0059] Found ClusterServiceVersion "my-project/memcached-operator.v0.0.1" phase: Succeeded
INFO[0059] OLM has successfully installed "memcached-operator.v0.0.1"</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Upgrade the installed Operator by specifying the bundle image for the later Operator version:
						</p><pre class="programlisting language-terminal">$ operator-sdk run bundle-upgrade &lt;registry&gt;/&lt;user&gt;/memcached-operator:v0.0.2</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">INFO[0002] Found existing subscription with name memcached-operator-v0-0-1-sub and namespace my-project
INFO[0002] Found existing catalog source with name memcached-operator-catalog and namespace my-project
INFO[0008] Generated a valid Upgraded File-Based Catalog
INFO[0009] Created registry pod: quay-io-demo-memcached-operator-v0-0-2
INFO[0009] Updated catalog source memcached-operator-catalog with address and annotations
INFO[0010] Deleted previous registry pod with name "quay-io-demo-memcached-operator-v0-0-1"
INFO[0041] Approved InstallPlan install-gvcjh for the Subscription: memcached-operator-v0-0-1-sub
INFO[0042] Waiting for ClusterServiceVersion "my-project/memcached-operator.v0.0.2" to reach 'Succeeded' phase
INFO[0019] Found ClusterServiceVersion "my-project/memcached-operator.v0.0.2" phase: Pending
INFO[0042] Found ClusterServiceVersion "my-project/memcached-operator.v0.0.2" phase: InstallReady
INFO[0043] Found ClusterServiceVersion "my-project/memcached-operator.v0.0.2" phase: Installing
INFO[0044] Found ClusterServiceVersion "my-project/memcached-operator.v0.0.2" phase: Succeeded
INFO[0044] Successfully upgraded to "memcached-operator.v0.0.2"</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Clean up the installed Operators:
						</p><pre class="programlisting language-terminal">$ operator-sdk cleanup memcached-operator</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-adding-operators-to-a-cluster">Traditional Operator installation with OLM</a>
						</li></ul></div></section><section class="section" id="osdk-control-compat_osdk-working-bundle-images"><div class="titlepage"><div><div><h3 class="title">5.8.5. Controlling Operator compatibility with OpenShift Container Platform versions</h3></div></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Kubernetes periodically deprecates certain APIs that are removed in subsequent releases. If your Operator is using a deprecated API, it might no longer work after the OpenShift Container Platform cluster is upgraded to the Kubernetes version where the API has been removed.
					</p><p>
						As an Operator author, it is strongly recommended that you review the <a class="link" href="https://kubernetes.io/docs/reference/using-api/deprecation-guide/">Deprecated API Migration Guide</a> in Kubernetes documentation and keep your Operator projects up to date to avoid using deprecated and removed APIs. Ideally, you should update your Operator before the release of a future version of OpenShift Container Platform that would make the Operator incompatible.
					</p></div></div><p>
					When an API is removed from an OpenShift Container Platform version, Operators running on that cluster version that are still using removed APIs will no longer work properly. As an Operator author, you should plan to update your Operator projects to accommodate API deprecation and removal to avoid interruptions for users of your Operator.
				</p><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
					You can check the event alerts of your Operators to find whether there are any warnings about APIs currently in use. The following alerts fire when they detect an API in use that will be removed in the next release:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">APIRemovedInNextReleaseInUse</code></span></dt><dd>
								APIs that will be removed in the next OpenShift Container Platform release.
							</dd><dt><span class="term"><code class="literal">APIRemovedInNextEUSReleaseInUse</code></span></dt><dd>
								APIs that will be removed in the next OpenShift Container Platform <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#ocp4_phases">Extended Update Support (EUS)</a> release.
							</dd></dl></div></div></div><p>
					If a cluster administrator has installed your Operator, before they upgrade to the next version of OpenShift Container Platform, they must ensure a version of your Operator is installed that is compatible with that next cluster version. While it is recommended that you update your Operator projects to no longer use deprecated or removed APIs, if you still need to publish your Operator bundles with removed APIs for continued use on earlier versions of OpenShift Container Platform, ensure that the bundle is configured accordingly.
				</p><p>
					The following procedure helps prevent administrators from installing versions of your Operator on an incompatible version of OpenShift Container Platform. These steps also prevent administrators from upgrading to a newer version of OpenShift Container Platform that is incompatible with the version of your Operator that is currently installed on their cluster.
				</p><p>
					This procedure is also useful when you know that the current version of your Operator will not work well, for any reason, on a specific OpenShift Container Platform version. By defining the cluster versions where the Operator should be distributed, you ensure that the Operator does not appear in a catalog of a cluster version which is outside of the allowed range.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Operators that use deprecated APIs can adversely impact critical workloads when cluster administrators upgrade to a future version of OpenShift Container Platform where the API is no longer supported. If your Operator is using deprecated APIs, you should configure the following settings in your Operator project as soon as possible.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							An existing Operator project
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							If you know that a specific bundle of your Operator is not supported and will not work correctly on OpenShift Container Platform later than a certain cluster version, configure the maximum version of OpenShift Container Platform that your Operator is compatible with. In your Operator project’s cluster service version (CSV), set the <code class="literal">olm.maxOpenShiftVersion</code> annotation to prevent administrators from upgrading their cluster before upgrading the installed Operator to a compatible version:
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								You must use <code class="literal">olm.maxOpenShiftVersion</code> annotation only if your Operator bundle version cannot work in later versions. Be aware that cluster admins cannot upgrade their clusters with your solution installed. If you do not provide later version and a valid upgrade path, administrators may uninstall your Operator and can upgrade the cluster version.
							</p></div></div><div class="formalpara"><p class="title"><strong>Example CSV with <code class="literal">olm.maxOpenShiftVersion</code> annotation</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: operators.coreos.com/v1alpha1
kind: ClusterServiceVersion
metadata:
  annotations:
    "olm.properties": '[{"type": "olm.maxOpenShiftVersion", "value": "&lt;cluster_version&gt;"}]' <span id="CO84-1"><!--Empty--></span><span class="callout">1</span></pre>

							</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO84-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Specify the maximum cluster version of OpenShift Container Platform that your Operator is compatible with. For example, setting <code class="literal">value</code> to <code class="literal">4.9</code> prevents cluster upgrades to OpenShift Container Platform versions later than 4.9 when this bundle is installed on a cluster.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							If your bundle is intended for distribution in a Red Hat-provided Operator catalog, configure the compatible versions of OpenShift Container Platform for your Operator by setting the following properties. This configuration ensures your Operator is only included in catalogs that target compatible versions of OpenShift Container Platform:
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								This step is only valid when publishing Operators in Red Hat-provided catalogs. If your bundle is only intended for distribution in a custom catalog, you can skip this step. For more details, see "Red Hat-provided Operator catalogs".
							</p></div></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Set the <code class="literal">com.redhat.openshift.versions</code> annotation in your project’s <code class="literal">bundle/metadata/annotations.yaml</code> file:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">bundle/metadata/annotations.yaml</code> file with compatible versions</strong></p><p>
										
<pre class="programlisting language-yaml">com.redhat.openshift.versions: "v4.7-v4.9" <span id="CO85-1"><!--Empty--></span><span class="callout">1</span></pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO85-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Set to a range or single version.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									To prevent your bundle from being carried on to an incompatible version of OpenShift Container Platform, ensure that the index image is generated with the proper <code class="literal">com.redhat.openshift.versions</code> label in your Operator’s bundle image. For example, if your project was generated using the Operator SDK, update the <code class="literal">bundle.Dockerfile</code> file:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">bundle.Dockerfile</code> with compatible versions</strong></p><p>
										
<pre class="programlisting language-yaml">LABEL com.redhat.openshift.versions="&lt;versions&gt;" <span id="CO86-1"><!--Empty--></span><span class="callout">1</span></pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO86-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Set to a range or single version, for example, <code class="literal">v4.7-v4.9</code>. This setting defines the cluster versions where the Operator should be distributed, and the Operator does not appear in a catalog of a cluster version which is outside of the range.
										</div></dd></dl></div></li></ol></div></li></ol></div><p>
					You can now bundle a new version of your Operator and publish the updated version to a catalog for distribution.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://redhat-connect.gitbook.io/certified-operator-guide/ocp-deployment/operator-metadata/bundle-directory/managing-openshift-versions">Managing OpenShift Versions</a> in the <span class="emphasis"><em>Certified Operator Build Guide</em></span>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-upgrading-operators">Updating installed Operators</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-rh-catalogs">Red Hat-provided Operator catalogs</a>
						</li></ul></div></section><section class="section _additional-resources" id="osdk-working-bundle-images-additional-resources"><div class="titlepage"><div><div><h3 class="title">5.8.6. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-bundle-format_olm-packaging-format">Operator Framework packaging format</a> for details on the bundle format.
						</li><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-managing-custom-catalogs">Managing custom catalogs</a> for details on adding bundle images to index images by using the <code class="literal">opm</code> command.
						</li><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-workflow">Operator Lifecycle Manager workflow</a> for details on how upgrades work for installed Operators.
						</li></ul></div></section></section><section class="section" id="osdk-complying-with-psa"><div class="titlepage"><div><div><h2 class="title">5.9. Complying with pod security admission</h2></div></div></div><p>
				<span class="emphasis"><em>Pod security admission</em></span> is an implementation of the <a class="link" href="https://kubernetes.io/docs/concepts/security/pod-security-standards/">Kubernetes pod security standards</a>. <a class="link" href="https://kubernetes.io/docs/concepts/security/pod-security-admission/">Pod security admission</a> restricts the behavior of pods. Pods that do not comply with the pod security admission defined globally or at the namespace level are not admitted to the cluster and cannot run.
			</p><p>
				If your Operator project does not require escalated permissions to run, you can ensure your workloads run in namespaces set to the <code class="literal">restricted</code> pod security level. If your Operator project requires escalated permissions to run, you must set the following security context configurations:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The allowed pod security admission level for the Operator’s namespace
					</li><li class="listitem">
						The allowed security context constraints (SCC) for the workload’s service account
					</li></ul></div><p>
				For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#understanding-and-managing-pod-security-admission">Understanding and managing pod security admission</a>.
			</p><section class="section" id="security-context-constraints-psa-synchronization_osdk-complying-with-psa"><div class="titlepage"><div><div><h3 class="title">5.9.1. Security context constraint synchronization with pod security standards</h3></div></div></div><p>
					OpenShift Container Platform includes <a class="link" href="https://kubernetes.io/docs/concepts/security/pod-security-admission">Kubernetes pod security admission</a>. Globally, the <code class="literal">privileged</code> profile is enforced, and the <code class="literal">restricted</code> profile is used for warnings and audits.
				</p><p>
					In addition to the global pod security admission control configuration, a controller exists that applies pod security admission control <code class="literal">warn</code> and <code class="literal">audit</code> labels to namespaces according to the SCC permissions of the service accounts that are in a given namespace.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Namespaces that are defined as part of the cluster payload have pod security admission synchronization disabled permanently. You can enable pod security admission synchronization on other namespaces as necessary. If an Operator is installed in a user-created <code class="literal">openshift-*</code> namespace, synchronization is turned on by default after a cluster service version (CSV) is created in the namespace.
					</p></div></div><p>
					The controller examines <code class="literal">ServiceAccount</code> object permissions to use security context constraints in each namespace. Security context constraints (SCCs) are mapped to pod security profiles based on their field values; the controller uses these translated profiles. Pod security admission <code class="literal">warn</code> and <code class="literal">audit</code> labels are set to the most privileged pod security profile found in the namespace to prevent warnings and audit logging as pods are created.
				</p><p>
					Namespace labeling is based on consideration of namespace-local service account privileges.
				</p><p>
					Applying pods directly might use the SCC privileges of the user who runs the pod. However, user privileges are not considered during automatic labeling.
				</p></section><section class="section" id="osdk-ensuring-operator-workloads-run-restricted-psa_osdk-complying-with-psa"><div class="titlepage"><div><div><h3 class="title">5.9.2. Ensuring Operator workloads run in namespaces set to the restricted pod security level</h3></div></div></div><p>
					To ensure your Operator project can run on a wide variety of deployments and environments, configure the Operator’s workloads to run in namespaces set to the <code class="literal">restricted</code> pod security level.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						You must leave the <code class="literal">runAsUser</code> field empty. If your image requires a specific user, it cannot be run under restricted security context constraints (SCC) and restricted pod security enforcement.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To configure Operator workloads to run in namespaces set to the <code class="literal">restricted</code> pod security level, edit your Operator’s namespace definition similar to the following examples:
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								It is recommended that you set the seccomp profile in your Operator’s namespace definition. However, setting the seccomp profile is not supported in OpenShift Container Platform 4.10.
							</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
									For Operator projects that must run in only OpenShift Container Platform 4.11 and later, edit your Operator’s namespace definition similar to the following example:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">config/manager/manager.yaml</code> file</strong></p><p>
										
<pre class="programlisting language-yaml">...
spec:
 securityContext:
   seccompProfile:
     type: RuntimeDefault <span id="CO87-1"><!--Empty--></span><span class="callout">1</span>
   runAsNonRoot: true
 containers:
   - name: &lt;operator_workload_container&gt;
     securityContext:
       allowPrivilegeEscalation: false
       capabilities:
         drop:
           - ALL
...</pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO87-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											By setting the seccomp profile type to <code class="literal">RuntimeDefault</code>, the SCC defaults to the pod security profile of the namespace.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									For Operator projects that must also run in OpenShift Container Platform 4.10, edit your Operator’s namespace definition similar to the following example:
								</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">config/manager/manager.yaml</code> file</strong></p><p>
										
<pre class="programlisting language-yaml">...
spec:
 securityContext: <span id="CO88-1"><!--Empty--></span><span class="callout">1</span>
   runAsNonRoot: true
 containers:
   - name: &lt;operator_workload_container&gt;
     securityContext:
       allowPrivilegeEscalation: false
       capabilities:
         drop:
           - ALL
...</pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO88-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Leaving the seccomp profile type unset ensures your Operator project can run in OpenShift Container Platform 4.10.
										</div></dd></dl></div></li></ul></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#managing-security-context-constraints">Managing security context constraints</a>
						</li></ul></div></section><section class="section" id="osdk-managing-psa-for-operators-with-escalated-permissions_osdk-complying-with-psa"><div class="titlepage"><div><div><h3 class="title">5.9.3. Managing pod security admission for Operator workloads that require escalated permissions</h3></div></div></div><p>
					If your Operator project requires escalated permissions to run, you must edit your Operator’s cluster service version (CSV).
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Set the security context configuration to the required permission level in your Operator’s CSV, similar to the following example:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">&lt;operator_name&gt;.clusterserviceversion.yaml</code> file with network administrator privileges</strong></p><p>
								
<pre class="programlisting language-yaml">...
containers:
   - name: my-container
     securityContext:
       allowPrivilegeEscalation: false
       capabilities:
         add:
           - "NET_ADMIN"
...</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Set the service account privileges that allow your Operator’s workloads to use the required security context constraints (SCC), similar to the following example:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">&lt;operator_name&gt;.clusterserviceversion.yaml</code> file</strong></p><p>
								
<pre class="programlisting language-yaml">...
  install:
    spec:
      clusterPermissions:
      - rules:
        - apiGroups:
          - security.openshift.io
          resourceNames:
          - privileged
          resources:
          - securitycontextconstraints
          verbs:
          - use
        serviceAccountName: default
...</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Edit your Operator’s CSV description to explain why your Operator project requires escalated permissions similar to the following example:
						</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">&lt;operator_name&gt;.clusterserviceversion.yaml</code> file</strong></p><p>
								
<pre class="programlisting language-yaml">...
spec:
  apiservicedefinitions:{}
  ...
description: The &lt;operator_name&gt; requires a privileged pod security admission label set on the Operator's namespace. The Operator's agents require escalated permissions to restart the node if the node needs remediation.</pre>

							</p></div></li></ol></div></section><section class="section _additional-resources" id="osdk-complying-with-psa-additional-resources"><div class="titlepage"><div><div><h3 class="title">5.9.4. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#understanding-and-managing-pod-security-admission">Understanding and managing pod security admission</a>
						</li></ul></div></section></section><section class="section" id="osdk-scorecard"><div class="titlepage"><div><div><h2 class="title">5.10. Validating Operators using the scorecard tool</h2></div></div></div><p>
				As an Operator author, you can use the scorecard tool in the Operator SDK to do the following tasks:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Validate that your Operator project is free of syntax errors and packaged correctly
					</li><li class="listitem">
						Review suggestions about ways you can improve your Operator
					</li></ul></div><section class="section" id="osdk-about-scorecard_osdk-scorecard"><div class="titlepage"><div><div><h3 class="title">5.10.1. About the scorecard tool</h3></div></div></div><p>
					While the Operator SDK <code class="literal">bundle validate</code> subcommand can validate local bundle directories and remote bundle images for content and structure, you can use the <code class="literal">scorecard</code> command to run tests on your Operator based on a configuration file and test images. These tests are implemented within test images that are configured and constructed to be executed by the scorecard.
				</p><p>
					The scorecard assumes it is run with access to a configured Kubernetes cluster, such as OpenShift Container Platform. The scorecard runs each test within a pod, from which pod logs are aggregated and test results are sent to the console. The scorecard has built-in basic and Operator Lifecycle Manager (OLM) tests and also provides a means to execute custom test definitions.
				</p><div class="orderedlist"><p class="title"><strong>Scorecard workflow</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Create all resources required by any related custom resources (CRs) and the Operator
						</li><li class="listitem">
							Create a proxy container in the deployment of the Operator to record calls to the API server and run tests
						</li><li class="listitem">
							Examine parameters in the CRs
						</li></ol></div><p>
					The scorecard tests make no assumptions as to the state of the Operator being tested. Creating Operators and CRs for an Operators are beyond the scope of the scorecard itself. Scorecard tests can, however, create whatever resources they require if the tests are designed for resource creation.
				</p><div class="formalpara"><p class="title"><strong><code class="literal">scorecard</code> command syntax</strong></p><p>
						
<pre class="programlisting language-terminal">$ operator-sdk scorecard &lt;bundle_dir_or_image&gt; [flags]</pre>

					</p></div><p>
					The scorecard requires a positional argument for either the on-disk path to your Operator bundle or the name of a bundle image.
				</p><p>
					For further information about the flags, run:
				</p><pre class="programlisting language-terminal">$ operator-sdk scorecard -h</pre></section><section class="section" id="osdk-scorecard-config_osdk-scorecard"><div class="titlepage"><div><div><h3 class="title">5.10.2. Scorecard configuration</h3></div></div></div><p>
					The scorecard tool uses a configuration that allows you to configure internal plugins, as well as several global configuration options. Tests are driven by a configuration file named <code class="literal">config.yaml</code>, which is generated by the <code class="literal">make bundle</code> command, located in your <code class="literal">bundle/</code> directory:
				</p><pre class="programlisting language-terminal">./bundle
...
└── tests
    └── scorecard
        └── config.yaml</pre><div class="formalpara"><p class="title"><strong>Example scorecard configuration file</strong></p><p>
						
<pre class="programlisting language-yaml">kind: Configuration
apiversion: scorecard.operatorframework.io/v1alpha3
metadata:
  name: config
stages:
- parallel: true
  tests:
  - image: quay.io/operator-framework/scorecard-test:v1.28.0
    entrypoint:
    - scorecard-test
    - basic-check-spec
    labels:
      suite: basic
      test: basic-check-spec-test
  - image: quay.io/operator-framework/scorecard-test:v1.28.0
    entrypoint:
    - scorecard-test
    - olm-bundle-validation
    labels:
      suite: olm
      test: olm-bundle-validation-test</pre>

					</p></div><p>
					The configuration file defines each test that scorecard can execute. The following fields of the scorecard configuration file define the test as follows:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"><!--Empty--></col><col style="width: 70%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731976333120" scope="col">Configuration field</th><th align="left" valign="top" id="idm139731976332032" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731976333120"> <p>
									<code class="literal">image</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731976332032"> <p>
									Test container image name that implements a test
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731976333120"> <p>
									<code class="literal">entrypoint</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731976332032"> <p>
									Command and arguments that are invoked in the test image to execute a test
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731976333120"> <p>
									<code class="literal">labels</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731976332032"> <p>
									Scorecard-defined or custom labels that select which tests to run
								</p>
								 </td></tr></tbody></table></div></section><section class="section" id="osdk-scorecard-tests_osdk-scorecard"><div class="titlepage"><div><div><h3 class="title">5.10.3. Built-in scorecard tests</h3></div></div></div><p>
					The scorecard ships with pre-defined tests that are arranged into suites: the basic test suite and the Operator Lifecycle Manager (OLM) suite.
				</p><div class="table" id="osdk-scorecard-basic-tests_osdk-scorecard"><p class="title"><strong>Table 5.16. Basic test suite</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 23%; " class="col_1"><!--Empty--></col><col style="width: 54%; " class="col_2"><!--Empty--></col><col style="width: 23%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731976308784" scope="col">Test</th><th align="left" valign="top" id="idm139731976307696" scope="col">Description</th><th align="left" valign="top" id="idm139731976306608" scope="col">Short name</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731976308784"> <p>
									Spec Block Exists
								</p>
								 </td><td align="left" valign="top" headers="idm139731976307696"> <p>
									This test checks the custom resource (CR) created in the cluster to make sure that all CRs have a <code class="literal">spec</code> block.
								</p>
								 </td><td align="left" valign="top" headers="idm139731976306608"> <p>
									<code class="literal">basic-check-spec-test</code>
								</p>
								 </td></tr></tbody></table></div></div><div class="table" id="osdk-scorecard-olm-tests_osdk-scorecard"><p class="title"><strong>Table 5.17. OLM test suite</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 23%; " class="col_1"><!--Empty--></col><col style="width: 54%; " class="col_2"><!--Empty--></col><col style="width: 23%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731976291856" scope="col">Test</th><th align="left" valign="top" id="idm139731976290768" scope="col">Description</th><th align="left" valign="top" id="idm139731976289680" scope="col">Short name</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731976291856"> <p>
									Bundle Validation
								</p>
								 </td><td align="left" valign="top" headers="idm139731976290768"> <p>
									This test validates the bundle manifests found in the bundle that is passed into scorecard. If the bundle contents contain errors, then the test result output includes the validator log as well as error messages from the validation library.
								</p>
								 </td><td align="left" valign="top" headers="idm139731976289680"> <p>
									<code class="literal">olm-bundle-validation-test</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731976291856"> <p>
									Provided APIs Have Validation
								</p>
								 </td><td align="left" valign="top" headers="idm139731976290768"> <p>
									This test verifies that the custom resource definitions (CRDs) for the provided CRs contain a validation section and that there is validation for each <code class="literal">spec</code> and <code class="literal">status</code> field detected in the CR.
								</p>
								 </td><td align="left" valign="top" headers="idm139731976289680"> <p>
									<code class="literal">olm-crds-have-validation-test</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731976291856"> <p>
									Owned CRDs Have Resources Listed
								</p>
								 </td><td align="left" valign="top" headers="idm139731976290768"> <p>
									This test makes sure that the CRDs for each CR provided via the <code class="literal">cr-manifest</code> option have a <code class="literal">resources</code> subsection in the <code class="literal">owned</code> CRDs section of the ClusterServiceVersion (CSV). If the test detects used resources that are not listed in the resources section, it lists them in the suggestions at the end of the test. Users are required to fill out the resources section after initial code generation for this test to pass.
								</p>
								 </td><td align="left" valign="top" headers="idm139731976289680"> <p>
									<code class="literal">olm-crds-have-resources-test</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731976291856"> <p>
									Spec Fields With Descriptors
								</p>
								 </td><td align="left" valign="top" headers="idm139731976290768"> <p>
									This test verifies that every field in the CRs <code class="literal">spec</code> sections has a corresponding descriptor listed in the CSV.
								</p>
								 </td><td align="left" valign="top" headers="idm139731976289680"> <p>
									<code class="literal">olm-spec-descriptors-test</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731976291856"> <p>
									Status Fields With Descriptors
								</p>
								 </td><td align="left" valign="top" headers="idm139731976290768"> <p>
									This test verifies that every field in the CRs <code class="literal">status</code> sections have a corresponding descriptor listed in the CSV.
								</p>
								 </td><td align="left" valign="top" headers="idm139731976289680"> <p>
									<code class="literal">olm-status-descriptors-test</code>
								</p>
								 </td></tr></tbody></table></div></div></section><section class="section" id="osdk-scorecard-run_osdk-scorecard"><div class="titlepage"><div><div><h3 class="title">5.10.4. Running the scorecard tool</h3></div></div></div><p>
					A default set of Kustomize files are generated by the Operator SDK after running the <code class="literal">init</code> command. The default <code class="literal">bundle/tests/scorecard/config.yaml</code> file that is generated can be immediately used to run the scorecard tool against your Operator, or you can modify this file to your test specifications.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Operator project generated by using the Operator SDK
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Generate or regenerate your bundle manifests and metadata for your Operator:
						</p><pre class="programlisting language-terminal">$ make bundle</pre><p class="simpara">
							This command automatically adds scorecard annotations to your bundle metadata, which is used by the <code class="literal">scorecard</code> command to run tests.
						</p></li><li class="listitem"><p class="simpara">
							Run the scorecard against the on-disk path to your Operator bundle or the name of a bundle image:
						</p><pre class="programlisting language-terminal">$ operator-sdk scorecard &lt;bundle_dir_or_image&gt;</pre></li></ol></div></section><section class="section" id="osdk-scorecard-output_osdk-scorecard"><div class="titlepage"><div><div><h3 class="title">5.10.5. Scorecard output</h3></div></div></div><p>
					The <code class="literal">--output</code> flag for the <code class="literal">scorecard</code> command specifies the scorecard results output format: either <code class="literal">text</code> or <code class="literal">json</code>.
				</p><div class="example" id="idm139731976238864"><p class="title"><strong>Example 5.15. Example JSON output snippet</strong></p><div class="example-contents"><pre class="programlisting language-json">{
  "apiVersion": "scorecard.operatorframework.io/v1alpha3",
  "kind": "TestList",
  "items": [
    {
      "kind": "Test",
      "apiVersion": "scorecard.operatorframework.io/v1alpha3",
      "spec": {
        "image": "quay.io/operator-framework/scorecard-test:v1.28.0",
        "entrypoint": [
          "scorecard-test",
          "olm-bundle-validation"
        ],
        "labels": {
          "suite": "olm",
          "test": "olm-bundle-validation-test"
        }
      },
      "status": {
        "results": [
          {
            "name": "olm-bundle-validation",
            "log": "time=\"2020-06-10T19:02:49Z\" level=debug msg=\"Found manifests directory\" name=bundle-test\ntime=\"2020-06-10T19:02:49Z\" level=debug msg=\"Found metadata directory\" name=bundle-test\ntime=\"2020-06-10T19:02:49Z\" level=debug msg=\"Getting mediaType info from manifests directory\" name=bundle-test\ntime=\"2020-06-10T19:02:49Z\" level=info msg=\"Found annotations file\" name=bundle-test\ntime=\"2020-06-10T19:02:49Z\" level=info msg=\"Could not find optional dependencies file\" name=bundle-test\n",
            "state": "pass"
          }
        ]
      }
    }
  ]
}</pre></div></div><div class="example" id="idm139731976234512"><p class="title"><strong>Example 5.16. Example text output snippet</strong></p><div class="example-contents"><pre class="programlisting language-text">--------------------------------------------------------------------------------
Image:      quay.io/operator-framework/scorecard-test:v1.28.0
Entrypoint: [scorecard-test olm-bundle-validation]
Labels:
	"suite":"olm"
	"test":"olm-bundle-validation-test"
Results:
	Name: olm-bundle-validation
	State: pass
	Log:
		time="2020-07-15T03:19:02Z" level=debug msg="Found manifests directory" name=bundle-test
		time="2020-07-15T03:19:02Z" level=debug msg="Found metadata directory" name=bundle-test
		time="2020-07-15T03:19:02Z" level=debug msg="Getting mediaType info from manifests directory" name=bundle-test
		time="2020-07-15T03:19:02Z" level=info msg="Found annotations file" name=bundle-test
		time="2020-07-15T03:19:02Z" level=info msg="Could not find optional dependencies file" name=bundle-test</pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The output format spec matches the <a class="link" href="https://pkg.go.dev/github.com/operator-framework/api/pkg/apis/scorecard/v1alpha3#Test"><code class="literal">Test</code></a> type layout.
					</p></div></div></section><section class="section" id="osdk-scorecard-select-tests_osdk-scorecard"><div class="titlepage"><div><div><h3 class="title">5.10.6. Selecting tests</h3></div></div></div><p>
					Scorecard tests are selected by setting the <code class="literal">--selector</code> CLI flag to a set of label strings. If a selector flag is not supplied, then all of the tests within the scorecard configuration file are run.
				</p><p>
					Tests are run serially with test results being aggregated by the scorecard and written to standard output, or <span class="emphasis"><em>stdout</em></span>.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To select a single test, for example <code class="literal">basic-check-spec-test</code>, specify the test by using the <code class="literal">--selector</code> flag:
						</p><pre class="programlisting language-terminal">$ operator-sdk scorecard &lt;bundle_dir_or_image&gt; \
    -o text \
    --selector=test=basic-check-spec-test</pre></li><li class="listitem"><p class="simpara">
							To select a suite of tests, for example <code class="literal">olm</code>, specify a label that is used by all of the OLM tests:
						</p><pre class="programlisting language-terminal">$ operator-sdk scorecard &lt;bundle_dir_or_image&gt; \
    -o text \
    --selector=suite=olm</pre></li><li class="listitem"><p class="simpara">
							To select multiple tests, specify the test names by using the <code class="literal">selector</code> flag using the following syntax:
						</p><pre class="programlisting language-terminal">$ operator-sdk scorecard &lt;bundle_dir_or_image&gt; \
    -o text \
    --selector='test in (basic-check-spec-test,olm-bundle-validation-test)'</pre></li></ol></div></section><section class="section" id="osdk-scorecard-parallel_osdk-scorecard"><div class="titlepage"><div><div><h3 class="title">5.10.7. Enabling parallel testing</h3></div></div></div><p>
					As an Operator author, you can define separate stages for your tests using the scorecard configuration file. Stages run sequentially in the order they are defined in the configuration file. A stage contains a list of tests and a configurable <code class="literal">parallel</code> setting.
				</p><p>
					By default, or when a stage explicitly sets <code class="literal">parallel</code> to <code class="literal">false</code>, tests in a stage are run sequentially in the order they are defined in the configuration file. Running tests one at a time is helpful to guarantee that no two tests interact and conflict with each other.
				</p><p>
					However, if tests are designed to be fully isolated, they can be parallelized.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To run a set of isolated tests in parallel, include them in the same stage and set <code class="literal">parallel</code> to <code class="literal">true</code>:
						</p><pre class="programlisting language-terminal">apiVersion: scorecard.operatorframework.io/v1alpha3
kind: Configuration
metadata:
  name: config
stages:
- parallel: true <span id="CO89-1"><!--Empty--></span><span class="callout">1</span>
  tests:
  - entrypoint:
    - scorecard-test
    - basic-check-spec
    image: quay.io/operator-framework/scorecard-test:v1.28.0
    labels:
      suite: basic
      test: basic-check-spec-test
  - entrypoint:
    - scorecard-test
    - olm-bundle-validation
    image: quay.io/operator-framework/scorecard-test:v1.28.0
    labels:
      suite: olm
      test: olm-bundle-validation-test</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO89-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Enables parallel testing
								</div></dd></dl></div><p class="simpara">
							All tests in a parallel stage are executed simultaneously, and scorecard waits for all of them to finish before proceding to the next stage. This can make your tests run much faster.
						</p></li></ul></div></section><section class="section" id="osdk-scorecard-custom-tests_osdk-scorecard"><div class="titlepage"><div><div><h3 class="title">5.10.8. Custom scorecard tests</h3></div></div></div><p>
					The scorecard tool can run custom tests that follow these mandated conventions:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Tests are implemented within a container image
						</li><li class="listitem">
							Tests accept an entrypoint which include a command and arguments
						</li><li class="listitem">
							Tests produce <code class="literal">v1alpha3</code> scorecard output in JSON format with no extraneous logging in the test output
						</li><li class="listitem">
							Tests can obtain the bundle contents at a shared mount point of <code class="literal">/bundle</code>
						</li><li class="listitem">
							Tests can access the Kubernetes API using an in-cluster client connection
						</li></ul></div><p>
					Writing custom tests in other programming languages is possible if the test image follows the above guidelines.
				</p><p>
					The following example shows of a custom test image written in Go:
				</p><div class="example" id="idm139731976193152"><p class="title"><strong>Example 5.17. Example custom scorecard test</strong></p><div class="example-contents"><pre class="programlisting language-go">// Copyright 2020 The Operator-SDK Authors
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package main

import (
	"encoding/json"
	"fmt"
	"log"
	"os"

	scapiv1alpha3 "github.com/operator-framework/api/pkg/apis/scorecard/v1alpha3"
	apimanifests "github.com/operator-framework/api/pkg/manifests"
)

// This is the custom scorecard test example binary
// As with the Redhat scorecard test image, the bundle that is under
// test is expected to be mounted so that tests can inspect the
// bundle contents as part of their test implementations.
// The actual test is to be run is named and that name is passed
// as an argument to this binary.  This argument mechanism allows
// this binary to run various tests all from within a single
// test image.

const PodBundleRoot = "/bundle"

func main() {
	entrypoint := os.Args[1:]
	if len(entrypoint) == 0 {
		log.Fatal("Test name argument is required")
	}

	// Read the pod's untar'd bundle from a well-known path.
	cfg, err := apimanifests.GetBundleFromDir(PodBundleRoot)
	if err != nil {
		log.Fatal(err.Error())
	}

	var result scapiv1alpha3.TestStatus

	// Names of the custom tests which would be passed in the
	// `operator-sdk` command.
	switch entrypoint[0] {
	case CustomTest1Name:
		result = CustomTest1(cfg)
	case CustomTest2Name:
		result = CustomTest2(cfg)
	default:
		result = printValidTests()
	}

	// Convert scapiv1alpha3.TestResult to json.
	prettyJSON, err := json.MarshalIndent(result, "", "    ")
	if err != nil {
		log.Fatal("Failed to generate json", err)
	}
	fmt.Printf("%s\n", string(prettyJSON))

}

// printValidTests will print out full list of test names to give a hint to the end user on what the valid tests are.
func printValidTests() scapiv1alpha3.TestStatus {
	result := scapiv1alpha3.TestResult{}
	result.State = scapiv1alpha3.FailState
	result.Errors = make([]string, 0)
	result.Suggestions = make([]string, 0)

	str := fmt.Sprintf("Valid tests for this image include: %s %s",
		CustomTest1Name,
		CustomTest2Name)
	result.Errors = append(result.Errors, str)
	return scapiv1alpha3.TestStatus{
		Results: []scapiv1alpha3.TestResult{result},
	}
}

const (
	CustomTest1Name = "customtest1"
	CustomTest2Name = "customtest2"
)

// Define any operator specific custom tests here.
// CustomTest1 and CustomTest2 are example test functions. Relevant operator specific
// test logic is to be implemented in similarly.

func CustomTest1(bundle *apimanifests.Bundle) scapiv1alpha3.TestStatus {
	r := scapiv1alpha3.TestResult{}
	r.Name = CustomTest1Name
	r.State = scapiv1alpha3.PassState
	r.Errors = make([]string, 0)
	r.Suggestions = make([]string, 0)
	almExamples := bundle.CSV.GetAnnotations()["alm-examples"]
	if almExamples == "" {
		fmt.Println("no alm-examples in the bundle CSV")
	}

	return wrapResult(r)
}

func CustomTest2(bundle *apimanifests.Bundle) scapiv1alpha3.TestStatus {
	r := scapiv1alpha3.TestResult{}
	r.Name = CustomTest2Name
	r.State = scapiv1alpha3.PassState
	r.Errors = make([]string, 0)
	r.Suggestions = make([]string, 0)
	almExamples := bundle.CSV.GetAnnotations()["alm-examples"]
	if almExamples == "" {
		fmt.Println("no alm-examples in the bundle CSV")
	}
	return wrapResult(r)
}

func wrapResult(r scapiv1alpha3.TestResult) scapiv1alpha3.TestStatus {
	return scapiv1alpha3.TestStatus{
		Results: []scapiv1alpha3.TestResult{r},
	}
}</pre></div></div></section></section><section class="section" id="osdk-bundle-validate"><div class="titlepage"><div><div><h2 class="title">5.11. Validating Operator bundles</h2></div></div></div><p>
				As an Operator author, you can run the <code class="literal">bundle validate</code> command in the Operator SDK to validate the content and format of an Operator bundle. You can run the command on a remote Operator bundle image or a local Operator bundle directory.
			</p><section class="section" id="osdk-about-bundle-validate_osdk-bundle-validate"><div class="titlepage"><div><div><h3 class="title">5.11.1. About the bundle validate command</h3></div></div></div><p>
					While the Operator SDK <code class="literal">scorecard</code> command can run tests on your Operator based on a configuration file and test images, the <code class="literal">bundle validate</code> subcommand can validate local bundle directories and remote bundle images for content and structure.
				</p><div class="formalpara"><p class="title"><strong><code class="literal">bundle validate</code> command syntax</strong></p><p>
						
<pre class="programlisting language-terminal">$ operator-sdk bundle validate &lt;bundle_dir_or_image&gt; &lt;flags&gt;</pre>

					</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The <code class="literal">bundle validate</code> command runs automatically when you build your bundle using the <code class="literal">make bundle</code> command.
					</p></div></div><p>
					Bundle images are pulled from a remote registry and built locally before they are validated. Local bundle directories must contain Operator metadata and manifests. The bundle metadata and manifests must have a structure similar to the following bundle layout:
				</p><div class="formalpara"><p class="title"><strong>Example bundle layout</strong></p><p>
						
<pre class="programlisting language-terminal">./bundle
  ├── manifests
  │   ├── cache.my.domain_memcacheds.yaml
  │   └── memcached-operator.clusterserviceversion.yaml
  └── metadata
      └── annotations.yaml</pre>

					</p></div><p>
					Bundle tests pass validation and finish with an exit code of <code class="literal">0</code> if no errors are detected.
				</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">INFO[0000] All validation tests have completed successfully</pre>

					</p></div><p>
					Tests fail validation and finish with an exit code of <code class="literal">1</code> if errors are detected.
				</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">ERRO[0000] Error: Value cache.example.com/v1alpha1, Kind=Memcached: CRD "cache.example.com/v1alpha1, Kind=Memcached" is present in bundle "" but not defined in CSV</pre>

					</p></div><p>
					Bundle tests that result in warnings can still pass validation with an exit code of <code class="literal">0</code> as long as no errors are detected. Tests only fail on errors.
				</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal">WARN[0000] Warning: Value : (memcached-operator.v0.0.1) annotations not found
INFO[0000] All validation tests have completed successfully</pre>

					</p></div><p>
					For further information about the <code class="literal">bundle validate</code> subcommand, run:
				</p><pre class="programlisting language-terminal">$ operator-sdk bundle validate -h</pre></section><section class="section" id="osdk-bundle-validate-tests_osdk-bundle-validate"><div class="titlepage"><div><div><h3 class="title">5.11.2. Built-in bundle validate tests</h3></div></div></div><p>
					The Operator SDK ships with pre-defined validators arranged into suites. If you run the <code class="literal">bundle validate</code> command without specifying a validator, the default test runs. The default test verifies that a bundle adheres to the specifications defined by the Operator Framework community. For more information, see "Bundle format".
				</p><p>
					You can run optional validators to test for issues such as OperatorHub compatibility or deprecated Kubernetes APIs. Optional validators always run in addition to the default test.
				</p><div class="formalpara"><p class="title"><strong><code class="literal">bundle validate</code> command syntax for optional test suites</strong></p><p>
						
<pre class="programlisting language-terminal">$ operator-sdk bundle validate &lt;bundle_dir_or_image&gt;
  --select-optional &lt;test_label&gt;</pre>

					</p></div><div class="table" id="osdk-bundle-validate-additional-tests_osdk-bundle-validate"><p class="title"><strong>Table 5.18. Addtional <code class="literal">bundle validate</code> validators</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 23%; " class="col_1"><!--Empty--></col><col style="width: 54%; " class="col_2"><!--Empty--></col><col style="width: 23%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731980079040" scope="col">Name</th><th align="left" valign="top" id="idm139731980077952" scope="col">Description</th><th align="left" valign="top" id="idm139731980076864" scope="col">Label</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731980079040"> <p>
									Operator Framework
								</p>
								 </td><td align="left" valign="top" headers="idm139731980077952"> <p>
									This validator tests an Operator bundle against the entire suite of validators provided by the Operator Framework.
								</p>
								 </td><td align="left" valign="top" headers="idm139731980076864"> <p>
									<code class="literal">suite=operatorframework</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731980079040"> <p>
									OperatorHub
								</p>
								 </td><td align="left" valign="top" headers="idm139731980077952"> <p>
									This validator tests an Operator bundle for compatibility with OperatorHub.
								</p>
								 </td><td align="left" valign="top" headers="idm139731980076864"> <p>
									<code class="literal">name=operatorhub</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731980079040"> <p>
									Good Practices
								</p>
								 </td><td align="left" valign="top" headers="idm139731980077952"> <p>
									This validator tests whether an Operator bundle complies with good practices as defined by the Operator Framework. It checks for issues, such as an empty CRD description or unsupported Operator Lifecycle Manager (OLM) resources.
								</p>
								 </td><td align="left" valign="top" headers="idm139731980076864"> <p>
									<code class="literal">name=good-practices</code>
								</p>
								 </td></tr></tbody></table></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-bundle-format_olm-packaging-format">Bundle format</a>
						</li></ul></div></section><section class="section" id="osdk-bundle-validate-run_osdk-bundle-validate"><div class="titlepage"><div><div><h3 class="title">5.11.3. Running the bundle validate command</h3></div></div></div><p>
					The default validator runs a test every time you enter the <code class="literal">bundle validate</code> command. You can run optional validators using the <code class="literal">--select-optional</code> flag. Optional validators run tests in addition to the default test.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Operator project generated by using the Operator SDK
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							If you want to run the default validator against a local bundle directory, enter the following command from your Operator project directory:
						</p><pre class="programlisting language-terminal">$ operator-sdk bundle validate ./bundle</pre></li><li class="listitem"><p class="simpara">
							If you want to run the default validator against a remote Operator bundle image, enter the following command:
						</p><pre class="programlisting language-terminal">$ operator-sdk bundle validate \
  &lt;bundle_registry&gt;/&lt;bundle_image_name&gt;:&lt;tag&gt;</pre><p class="simpara">
							where:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">&lt;bundle_registry&gt;</span></dt><dd>
										Specifies the registry where the bundle is hosted, such as <code class="literal">quay.io/example</code>.
									</dd><dt><span class="term">&lt;bundle_image_name&gt;</span></dt><dd>
										Specifies the name of the bundle image, such as <code class="literal">memcached-operator</code>.
									</dd><dt><span class="term">&lt;tag&gt;</span></dt><dd><p class="simpara">
										Specifies the tag of the bundle image, such as <code class="literal">v1.28.0</code>.
									</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											If you want to validate an Operator bundle image, you must host your image in a remote registry. The Operator SDK pulls the image and builds it locally before running tests. The <code class="literal">bundle validate</code> command does not support testing local bundle images.
										</p></div></div></dd></dl></div></li><li class="listitem"><p class="simpara">
							If you want to run an additional validator against an Operator bundle, enter the following command:
						</p><pre class="programlisting language-terminal">$ operator-sdk bundle validate \
  &lt;bundle_dir_or_image&gt; \
  --select-optional &lt;test_label&gt;</pre><p class="simpara">
							where:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">&lt;bundle_dir_or_image&gt;</span></dt><dd>
										Specifies the local bundle directory or remote bundle image, such as <code class="literal">~/projects/memcached</code> or <code class="literal">quay.io/example/memcached-operator:v1.28.0</code>.
									</dd><dt><span class="term">&lt;test_label&gt;</span></dt><dd><p class="simpara">
										Specifies the name of the validator you want to run, such as <code class="literal">name=good-practices</code>.
									</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
											
<pre class="programlisting language-terminal">ERRO[0000] Error: Value apiextensions.k8s.io/v1, Kind=CustomResource: unsupported media type registry+v1 for bundle object
WARN[0000] Warning: Value k8sevent.v0.0.1: owned CRD "k8sevents.k8s.k8sevent.com" has an empty description</pre>

										</p></div></dd></dl></div></li></ol></div></section></section><section class="section" id="osdk-ha-sno"><div class="titlepage"><div><div><h2 class="title">5.12. High-availability or single-node cluster detection and support</h2></div></div></div><p>
				An OpenShift Container Platform cluster can be configured in high-availability (HA) mode, which uses multiple nodes, or in non-HA mode, which uses a single node. A single-node cluster, also known as single-node OpenShift, is likely to have more conservative resource constraints. Therefore, it is important that Operators installed on a single-node cluster can adjust accordingly and still run well.
			</p><p>
				By accessing the cluster high-availability mode API provided in OpenShift Container Platform, Operator authors can use the Operator SDK to enable their Operator to detect a cluster’s infrastructure topology, either HA or non-HA mode. Custom Operator logic can be developed that uses the detected cluster topology to automatically switch the resource requirements, both for the Operator and for any Operands or workloads it manages, to a profile that best fits the topology.
			</p><section class="section" id="osdk-ha-sno-api_osdk-ha-sno"><div class="titlepage"><div><div><h3 class="title">5.12.1. About the cluster high-availability mode API</h3></div></div></div><p>
					OpenShift Container Platform provides a cluster high-availability mode API that can be used by Operators to help detect infrastructure topology. The Infrastructure API holds cluster-wide information regarding infrastructure. Operators managed by Operator Lifecycle Manager (OLM) can use the Infrastructure API if they need to configure an Operand or managed workload differently based on the high-availability mode.
				</p><p>
					In the Infrastructure API, the <code class="literal">infrastructureTopology</code> status expresses the expectations for infrastructure services that do not run on control plane nodes, usually indicated by a node selector for a <code class="literal">role</code> value other than <code class="literal">master</code>. The <code class="literal">controlPlaneTopology</code> status expresses the expectations for Operands that normally run on control plane nodes.
				</p><p>
					The default setting for either status is <code class="literal">HighlyAvailable</code>, which represents the behavior Operators have in multiple node clusters. The <code class="literal">SingleReplica</code> setting is used in single-node clusters, also known as single-node OpenShift, and indicates that Operators should not configure their Operands for high-availability operation.
				</p><p>
					The OpenShift Container Platform installer sets the <code class="literal">controlPlaneTopology</code> and <code class="literal">infrastructureTopology</code> status fields based on the replica counts for the cluster when it is created, according to the following rules:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							When the control plane replica count is less than 3, the <code class="literal">controlPlaneTopology</code> status is set to <code class="literal">SingleReplica</code>. Otherwise, it is set to <code class="literal">HighlyAvailable</code>.
						</li><li class="listitem">
							When the worker replica count is 0, the control plane nodes are also configured as workers. Therefore, the <code class="literal">infrastructureTopology</code> status will be the same as the <code class="literal">controlPlaneTopology</code> status.
						</li><li class="listitem">
							When the worker replica count is 1, the <code class="literal">infrastructureTopology</code> is set to <code class="literal">SingleReplica</code>. Otherwise, it is set to <code class="literal">HighlyAvailable</code>.
						</li></ul></div></section><section class="section" id="osdk-ha-sno-api-examples_osdk-ha-sno"><div class="titlepage"><div><div><h3 class="title">5.12.2. Example API usage in Operator projects</h3></div></div></div><p>
					As an Operator author, you can update your Operator project to access the Infrastructure API by using normal Kubernetes constructs and the <code class="literal">controller-runtime</code> library, as shown in the following examples:
				</p><div class="formalpara"><p class="title"><strong><code class="literal">controller-runtime</code> library example</strong></p><p>
						
<pre class="programlisting language-go">// Simple query
 nn := types.NamespacedName{
 Name: "cluster",
 }
 infraConfig := &amp;configv1.Infrastructure{}
 err = crClient.Get(context.Background(), nn, infraConfig)
 if err != nil {
 return err
 }
 fmt.Printf("using crclient: %v\n", infraConfig.Status.ControlPlaneTopology)
 fmt.Printf("using crclient: %v\n", infraConfig.Status.InfrastructureTopology)</pre>

					</p></div><div class="formalpara"><p class="title"><strong>Kubernetes constructs example</strong></p><p>
						
<pre class="programlisting language-go">operatorConfigInformer := configinformer.NewSharedInformerFactoryWithOptions(configClient, 2*time.Second)
 infrastructureLister = operatorConfigInformer.Config().V1().Infrastructures().Lister()
 infraConfig, err := configClient.ConfigV1().Infrastructures().Get(context.Background(), "cluster", metav1.GetOptions{})
 if err != nil {
 return err
 }
// fmt.Printf("%v\n", infraConfig)
 fmt.Printf("%v\n", infraConfig.Status.ControlPlaneTopology)
 fmt.Printf("%v\n", infraConfig.Status.InfrastructureTopology)</pre>

					</p></div></section></section><section class="section" id="osdk-monitoring-prometheus"><div class="titlepage"><div><div><h2 class="title">5.13. Configuring built-in monitoring with Prometheus</h2></div></div></div><p>
				This guide describes the built-in monitoring support provided by the Operator SDK using the Prometheus Operator and details usage for authors of Go-based and Ansible-based Operators.
			</p><section class="section" id="osdk-monitoring-prometheus-operator-support_osdk-monitoring-prometheus"><div class="titlepage"><div><div><h3 class="title">5.13.1. Prometheus Operator support</h3></div></div></div><p>
					<a class="link" href="https://prometheus.io/">Prometheus</a> is an open-source systems monitoring and alerting toolkit. The Prometheus Operator creates, configures, and manages Prometheus clusters running on Kubernetes-based clusters, such as OpenShift Container Platform.
				</p><p>
					Helper functions exist in the Operator SDK by default to automatically set up metrics in any generated Go-based Operator for use on clusters where the Prometheus Operator is deployed.
				</p></section><section class="section" id="osdk-monitoring-custom-metrics_osdk-monitoring-prometheus"><div class="titlepage"><div><div><h3 class="title">5.13.2. Exposing custom metrics for Go-based Operators</h3></div></div></div><p>
					As an Operator author, you can publish custom metrics by using the global Prometheus registry from the <code class="literal">controller-runtime/pkg/metrics</code> library.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Go-based Operator generated using the Operator SDK
						</li><li class="listitem">
							Prometheus Operator, which is deployed by default on OpenShift Container Platform clusters
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							In your Operator SDK project, uncomment the following line in the <code class="literal">config/default/kustomization.yaml</code> file:
						</p><pre class="programlisting language-yaml">../prometheus</pre></li><li class="listitem"><p class="simpara">
							Create a custom controller class to publish additional metrics from the Operator. The following example declares the <code class="literal">widgets</code> and <code class="literal">widgetFailures</code> collectors as global variables, and then registers them with the <code class="literal">init()</code> function in the controller’s package:
						</p><div class="example" id="idm139731979974944"><p class="title"><strong>Example 5.18. <code class="literal">controllers/memcached_controller_test_metrics.go</code> file</strong></p><div class="example-contents"><pre class="programlisting language-go">package controllers

import (
	"github.com/prometheus/client_golang/prometheus"
	"sigs.k8s.io/controller-runtime/pkg/metrics"
)


var (
    widgets = prometheus.NewCounter(
        prometheus.CounterOpts{
            Name: "widgets_total",
            Help: "Number of widgets processed",
        },
    )
    widgetFailures = prometheus.NewCounter(
        prometheus.CounterOpts{
            Name: "widget_failures_total",
            Help: "Number of failed widgets",
        },
    )
)

func init() {
    // Register custom metrics with the global prometheus registry
    metrics.Registry.MustRegister(widgets, widgetFailures)
}</pre></div></div></li><li class="listitem"><p class="simpara">
							Record to these collectors from any part of the reconcile loop in the <code class="literal">main</code> controller class, which determines the business logic for the metric:
						</p><div class="example" id="idm139731979970352"><p class="title"><strong>Example 5.19. <code class="literal">controllers/memcached_controller.go</code> file</strong></p><div class="example-contents"><pre class="programlisting language-go">func (r *MemcachedReconciler) Reconcile(ctx context.Context, req ctrl.Request) (ctrl.Result, error) {
	...
	...
	// Add metrics
	widgets.Inc()
	widgetFailures.Inc()

	return ctrl.Result{}, nil
}</pre></div></div></li><li class="listitem"><p class="simpara">
							Build and push the Operator:
						</p><pre class="programlisting language-terminal">$ make docker-build docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre></li><li class="listitem"><p class="simpara">
							Deploy the Operator:
						</p><pre class="programlisting language-terminal">$ make deploy IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre></li><li class="listitem"><p class="simpara">
							Create role and role binding definitions to allow the service monitor of the Operator to be scraped by the Prometheus instance of the OpenShift Container Platform cluster.
						</p><p class="simpara">
							Roles must be assigned so that service accounts have the permissions to scrape the metrics of the namespace:
						</p><div class="example" id="idm139731979961776"><p class="title"><strong>Example 5.20. <code class="literal">config/prometheus/role.yaml</code> role</strong></p><div class="example-contents"><pre class="programlisting language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: prometheus-k8s-role
  namespace: memcached-operator-system
rules:
  - apiGroups:
      - ""
    resources:
      - endpoints
      - pods
      - services
      - nodes
      - secrets
    verbs:
      - get
      - list
      - watch</pre></div></div><div class="example" id="idm139731979959104"><p class="title"><strong>Example 5.21. <code class="literal">config/prometheus/rolebinding.yaml</code> role binding</strong></p><div class="example-contents"><pre class="programlisting language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: prometheus-k8s-rolebinding
  namespace: memcached-operator-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: prometheus-k8s-role
subjects:
  - kind: ServiceAccount
    name: prometheus-k8s
    namespace: openshift-monitoring</pre></div></div></li><li class="listitem"><p class="simpara">
							Apply the roles and role bindings for the deployed Operator:
						</p><pre class="programlisting language-terminal">$ oc apply -f config/prometheus/role.yaml</pre><pre class="programlisting language-terminal">$ oc apply -f config/prometheus/rolebinding.yaml</pre></li><li class="listitem"><p class="simpara">
							Set the labels for the namespace that you want to scrape, which enables OpenShift cluster monitoring for that namespace:
						</p><pre class="programlisting language-terminal">$ oc label namespace &lt;operator_namespace&gt; openshift.io/cluster-monitoring="true"</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Query and view the metrics in the OpenShift Container Platform web console. You can use the names that were set in the custom controller class, for example <code class="literal">widgets_total</code> and <code class="literal">widget_failures_total</code>.
						</li></ul></div></section><section class="section" id="osdk-ansible-metrics_osdk-monitoring-prometheus"><div class="titlepage"><div><div><h3 class="title">5.13.3. Exposing custom metrics for Ansible-based Operators</h3></div></div></div><p>
					As an Operator author creating Ansible-based Operators, you can use the Operator SDK’s <code class="literal">osdk_metrics</code> module to expose custom Operator and Operand metrics, emit events, and support logging.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Ansible-based Operator generated using the Operator SDK
						</li><li class="listitem">
							Prometheus Operator, which is deployed by default on OpenShift Container Platform clusters
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Generate an Ansible-based Operator. This example uses a <code class="literal">testmetrics.com</code> domain:
						</p><pre class="programlisting language-terminal">$ operator-sdk init \
    --plugins=ansible \
    --domain=testmetrics.com</pre></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">metrics</code> API. This example uses a <code class="literal">kind</code> named <code class="literal">Testmetrics</code>:
						</p><pre class="programlisting language-terminal">$ operator-sdk create api \
    --group metrics \
    --version v1 \
    --kind Testmetrics \
    --generate-role</pre></li><li class="listitem"><p class="simpara">
							Edit the <code class="literal">roles/testmetrics/tasks/main.yml</code> file and use the <code class="literal">osdk_metrics</code> module to create custom metrics for your Operator project:
						</p><div class="example" id="idm139731979932480"><p class="title"><strong>Example 5.22. Example <code class="literal">roles/testmetrics/tasks/main.yml</code> file</strong></p><div class="example-contents"><pre class="programlisting language-yaml">---
# tasks file for Memcached
- name: start k8sstatus
  k8s:
    definition:
      kind: Deployment
      apiVersion: apps/v1
      metadata:
        name: '{{ ansible_operator_meta.name }}-memcached'
        namespace: '{{ ansible_operator_meta.namespace }}'
      spec:
        replicas: "{{size}}"
        selector:
          matchLabels:
            app: memcached
        template:
          metadata:
            labels:
              app: memcached
          spec:
            containers:
            - name: memcached
              command:
              - memcached
              - -m=64
              - -o
              - modern
              - -v
              image: "docker.io/memcached:1.4.36-alpine"
              ports:
                - containerPort: 11211

- osdk_metric:
    name: my_thing_counter
    description: This metric counts things
    counter: {}

- osdk_metric:
    name: my_counter_metric
    description: Add 3.14 to the counter
    counter:
      increment: yes

- osdk_metric:
    name: my_gauge_metric
    description: Create my gauge and set it to 2.
    gauge:
      set: 2

- osdk_metric:
    name: my_histogram_metric
    description: Observe my histogram
    histogram:
      observe: 2

- osdk_metric:
    name: my_summary_metric
    description: Observe my summary
    summary:
      observe: 2</pre></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run your Operator on a cluster. For example, to use the "run as a deployment" method:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Build the Operator image and push it to a registry:
								</p><pre class="programlisting language-terminal">$ make docker-build docker-push IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre></li><li class="listitem"><p class="simpara">
									Install the Operator on a cluster:
								</p><pre class="programlisting language-terminal">$ make install</pre></li><li class="listitem"><p class="simpara">
									Deploy the Operator:
								</p><pre class="programlisting language-terminal">$ make deploy IMG=&lt;registry&gt;/&lt;user&gt;/&lt;image_name&gt;:&lt;tag&gt;</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">Testmetrics</code> custom resource (CR):
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Define the CR spec:
								</p><div class="example" id="idm139731979916240"><p class="title"><strong>Example 5.23. Example <code class="literal">config/samples/metrics_v1_testmetrics.yaml</code> file</strong></p><div class="example-contents"><pre class="programlisting language-yaml">apiVersion: metrics.testmetrics.com/v1
kind: Testmetrics
metadata:
  name: testmetrics-sample
spec:
  size: 1</pre></div></div></li><li class="listitem"><p class="simpara">
									Create the object:
								</p><pre class="programlisting language-terminal">$ oc create -f config/samples/metrics_v1_testmetrics.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Get the pod details:
						</p><pre class="programlisting language-terminal">$ oc get pods</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                                    READY   STATUS    RESTARTS   AGE
ansiblemetrics-controller-manager-&lt;id&gt;  2/2     Running   0          149m
testmetrics-sample-memcached-&lt;id&gt;       1/1     Running   0          147m</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Get the endpoint details:
						</p><pre class="programlisting language-terminal">$ oc get ep</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                                                ENDPOINTS          AGE
ansiblemetrics-controller-manager-metrics-service   10.129.2.70:8443   150m</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Request a custom metrics token:
						</p><pre class="programlisting language-terminal">$ token=`oc create token prometheus-k8s -n openshift-monitoring`</pre></li><li class="listitem"><p class="simpara">
							Check the metrics values:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Check the <code class="literal">my_counter_metric</code> value:
								</p><pre class="programlisting language-terminal">$ oc exec ansiblemetrics-controller-manager-&lt;id&gt; -- curl -k -H "Authoriza
tion: Bearer $token" 'https://10.129.2.70:8443/metrics' | grep  my_counter</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">HELP my_counter_metric Add 3.14 to the counter
TYPE my_counter_metric counter
my_counter_metric 2</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Check the <code class="literal">my_gauge_metric</code> value:
								</p><pre class="programlisting language-terminal">$ oc exec ansiblemetrics-controller-manager-&lt;id&gt; -- curl -k -H "Authoriza
tion: Bearer $token" 'https://10.129.2.70:8443/metrics' | grep  gauge</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">HELP my_gauge_metric Create my gauge and set it to 2.</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Check the <code class="literal">my_histogram_metric</code> and <code class="literal">my_summary_metric</code> values:
								</p><pre class="programlisting language-terminal">$ oc exec ansiblemetrics-controller-manager-&lt;id&gt; -- curl -k -H "Authoriza
tion: Bearer $token" 'https://10.129.2.70:8443/metrics' | grep  Observe</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">HELP my_histogram_metric Observe my histogram
HELP my_summary_metric Observe my summary</pre>

									</p></div></li></ol></div></li></ol></div></section></section><section class="section" id="osdk-leader-election"><div class="titlepage"><div><div><h2 class="title">5.14. Configuring leader election</h2></div></div></div><p>
				During the lifecycle of an Operator, it is possible that there may be more than one instance running at any given time, for example when rolling out an upgrade for the Operator. In such a scenario, it is necessary to avoid contention between multiple Operator instances using leader election. This ensures only one leader instance handles the reconciliation while the other instances are inactive but ready to take over when the leader steps down.
			</p><p>
				There are two different leader election implementations to choose from, each with its own trade-off:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Leader-for-life</span></dt><dd>
							The leader pod only gives up leadership, using garbage collection, when it is deleted. This implementation precludes the possibility of two instances mistakenly running as leaders, a state also known as split brain. However, this method can be subject to a delay in electing a new leader. For example, when the leader pod is on an unresponsive or partitioned node, the <a class="link" href="https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/#options"><code class="literal">pod-eviction-timeout</code></a> dictates long how it takes for the leader pod to be deleted from the node and step down, with a default of <code class="literal">5m</code>. See the <a class="link" href="https://godoc.org/github.com/operator-framework/operator-sdk/pkg/leader">Leader-for-life</a> Go documentation for more.
						</dd><dt><span class="term">Leader-with-lease</span></dt><dd>
							The leader pod periodically renews the leader lease and gives up leadership when it cannot renew the lease. This implementation allows for a faster transition to a new leader when the existing leader is isolated, but there is a possibility of split brain in <a class="link" href="https://github.com/kubernetes/client-go/blob/30b06a83d67458700a5378239df6b96948cb9160/tools/leaderelection/leaderelection.go#L21-L24">certain situations</a>. See the <a class="link" href="https://godoc.org/github.com/kubernetes-sigs/controller-runtime/pkg/leaderelection">Leader-with-lease</a> Go documentation for more.
						</dd></dl></div><p>
				By default, the Operator SDK enables the Leader-for-life implementation. Consult the related Go documentation for both approaches to consider the trade-offs that make sense for your use case.
			</p><section class="section" id="osdk-leader-election-types_osdk-leader-election"><div class="titlepage"><div><div><h3 class="title">5.14.1. Operator leader election examples</h3></div></div></div><p>
					The following examples illustrate how to use the two leader election options for an Operator, Leader-for-life and Leader-with-lease.
				</p><section class="section" id="osdk-leader-for-life-election_osdk-leader-election"><div class="titlepage"><div><div><h4 class="title">5.14.1.1. Leader-for-life election</h4></div></div></div><p>
						With the Leader-for-life election implementation, a call to <code class="literal">leader.Become()</code> blocks the Operator as it retries until it can become the leader by creating the config map named <code class="literal">memcached-operator-lock</code>:
					</p><pre class="programlisting language-go">import (
  ...
  "github.com/operator-framework/operator-sdk/pkg/leader"
)

func main() {
  ...
  err = leader.Become(context.TODO(), "memcached-operator-lock")
  if err != nil {
    log.Error(err, "Failed to retry for leader lock")
    os.Exit(1)
  }
  ...
}</pre><p>
						If the Operator is not running inside a cluster, <code class="literal">leader.Become()</code> simply returns without error to skip the leader election since it cannot detect the name of the Operator.
					</p></section><section class="section" id="osdk-leader-with-lease-election_osdk-leader-election"><div class="titlepage"><div><div><h4 class="title">5.14.1.2. Leader-with-lease election</h4></div></div></div><p>
						The Leader-with-lease implementation can be enabled using the <a class="link" href="https://godoc.org/github.com/kubernetes-sigs/controller-runtime/pkg/manager#Options">Manager Options</a> for leader election:
					</p><pre class="programlisting language-go">import (
  ...
  "sigs.k8s.io/controller-runtime/pkg/manager"
)

func main() {
  ...
  opts := manager.Options{
    ...
    LeaderElection: true,
    LeaderElectionID: "memcached-operator-lock"
  }
  mgr, err := manager.New(cfg, opts)
  ...
}</pre><p>
						When the Operator is not running in a cluster, the Manager returns an error when starting because it cannot detect the namespace of the Operator to create the config map for leader election. You can override this namespace by setting the <code class="literal">LeaderElectionNamespace</code> option for the Manager.
					</p></section></section></section><section class="section" id="osdk-pruning-utility"><div class="titlepage"><div><div><h2 class="title">5.15. Object pruning utility for Go-based Operators</h2></div></div></div><p>
				The <code class="literal">operator-lib</code> pruning utility lets Go-based Operators clean up, or prune, objects when they are no longer needed. Operator authors can also use the utility to create custom hooks and strategies.
			</p><section class="section" id="osdk-about-pruning-utility_osdk-pruning-utility"><div class="titlepage"><div><div><h3 class="title">5.15.1. About the operator-lib pruning utility</h3></div></div></div><p>
					Objects, such as jobs or pods, are created as a normal part of the Operator life cycle. If the cluster administrator or the Operator does not remove these object, they can stay in the cluster and consume resources.
				</p><p>
					Previously, the following options were available for pruning unnecessary objects:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Operator authors had to create a unique pruning solution for their Operators.
						</li><li class="listitem">
							Cluster administrators had to clean up objects on their own.
						</li></ul></div><p>
					The <code class="literal">operator-lib</code> <a class="link" href="https://github.com/operator-framework/operator-lib/tree/main/prune">pruning utility</a> removes objects from a Kubernetes cluster for a given namespace. The library was added in version <code class="literal">0.9.0</code> of the <a class="link" href="https://github.com/operator-framework/operator-lib/releases/tag/v0.9.0"><code class="literal">operator-lib</code> library</a> as part of the Operator Framework.
				</p></section><section class="section" id="osdk-pruning-utility-config_osdk-pruning-utility"><div class="titlepage"><div><div><h3 class="title">5.15.2. Pruning utility configuration</h3></div></div></div><p>
					The <code class="literal">operator-lib</code> pruning utility is written in Go and includes common pruning strategies for Go-based Operators.
				</p><div class="formalpara"><p class="title"><strong>Example configuration</strong></p><p>
						
<pre class="programlisting language-go">cfg = Config{
        log:           logf.Log.WithName("prune"),
        DryRun:        false,
        Clientset:     client,
        LabelSelector: "app=&lt;operator_name&gt;",
        Resources: []schema.GroupVersionKind{
                {Group: "", Version: "", Kind: PodKind},
        },
        Namespaces: []string{"&lt;operator_namespace&gt;"},
        Strategy: StrategyConfig{
                Mode:            MaxCountStrategy,
                MaxCountSetting: 1,
        },
        PreDeleteHook: myhook,
}</pre>

					</p></div><p>
					The pruning utility configuration file defines pruning actions by using the following fields:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"><!--Empty--></col><col style="width: 70%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731977659232" scope="col">Configuration field</th><th align="left" valign="top" id="idm139731977658144" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731977659232"> <p>
									<code class="literal">log</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977658144"> <p>
									Logger used to handle library log messages.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731977659232"> <p>
									<code class="literal">DryRun</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977658144"> <p>
									Boolean that determines whether resources should be removed. If set to <code class="literal">true</code>, the utility runs but does not to remove resources.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731977659232"> <p>
									<code class="literal">Clientset</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977658144"> <p>
									Client-go Kubernetes ClientSet used for Kubernetes API calls.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731977659232"> <p>
									<code class="literal">LabelSelector</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977658144"> <p>
									Kubernetes label selector expression used to find resources to prune.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731977659232"> <p>
									<code class="literal">Resources</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977658144"> <p>
									Kubernetes resource kinds. <code class="literal">PodKind</code> and <code class="literal">JobKind</code> are currently supported.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731977659232"> <p>
									<code class="literal">Namespaces</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977658144"> <p>
									List of Kubernetes namespaces to search for resources.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731977659232"> <p>
									<code class="literal">Strategy</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977658144"> <p>
									Pruning strategy to run.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731977659232"> <p>
									<code class="literal">Strategy.Mode</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977658144"> <p>
									<code class="literal">MaxCountStrategy</code>, <code class="literal">MaxAgeStrategy</code>, or <code class="literal">CustomStrategy</code> are currently supported.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731977659232"> <p>
									<code class="literal">Strategy.MaxCountSetting</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977658144"> <p>
									Integer value for <code class="literal">MaxCountStrategy</code> that specifies how many resources should remain after the pruning utility runs.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731977659232"> <p>
									<code class="literal">Strategy.MaxAgeSetting</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977658144"> <p>
									Go <code class="literal">time.Duration</code> string value, such as <code class="literal">48h</code>, that specifies the age of resources to prune.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731977659232"> <p>
									<code class="literal">Strategy.CustomSettings</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977658144"> <p>
									Go map of values that can be passed into a custom strategy function.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731977659232"> <p>
									<code class="literal">PreDeleteHook</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977658144"> <p>
									Optional: Go function to call before pruning a resource.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731977659232"> <p>
									<code class="literal">CustomStrategy</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977658144"> <p>
									Optional: Go function that implements a custom pruning strategy.
								</p>
								 </td></tr></tbody></table></div><div class="formalpara"><p class="title"><strong>Pruning execution</strong></p><p>
						You can call the pruning action by running the execute function on the pruning configuration.
					</p></div><pre class="programlisting language-go">err := cfg.Execute(ctx)</pre><p>
					You can also call a pruning action by using a cron package or by calling the pruning utility with a triggering event.
				</p></section></section><section class="section" id="osdk-pkgman-to-bundle"><div class="titlepage"><div><div><h2 class="title">5.16. Migrating package manifest projects to bundle format</h2></div></div></div><p>
				Support for the legacy <span class="emphasis"><em>package manifest format</em></span> for Operators is removed in OpenShift Container Platform 4.8 and later. If you have an Operator project that was initially created using the package manifest format, you can use the Operator SDK to migrate the project to the bundle format. The bundle format is the preferred packaging format for Operator Lifecycle Manager (OLM) starting in OpenShift Container Platform 4.6.
			</p><section class="section" id="osdk-about-pkg-format-migration_osdk-pkgman-to-bundle"><div class="titlepage"><div><div><h3 class="title">5.16.1. About packaging format migration</h3></div></div></div><p>
					The Operator SDK <code class="literal">pkgman-to-bundle</code> command helps in migrating Operator Lifecycle Manager (OLM) package manifests to bundles. The command takes an input package manifest directory and generates bundles for each of the versions of manifests present in the input directory. You can also then build bundle images for each of the generated bundles.
				</p><p>
					For example, consider the following <code class="literal">packagemanifests/</code> directory for a project in the package manifest format:
				</p><div class="formalpara"><p class="title"><strong>Example package manifest format layout</strong></p><p>
						
<pre class="programlisting language-terminal">packagemanifests/
└── etcd
    ├── 0.0.1
    │   ├── etcdcluster.crd.yaml
    │   └── etcdoperator.clusterserviceversion.yaml
    ├── 0.0.2
    │   ├── etcdbackup.crd.yaml
    │   ├── etcdcluster.crd.yaml
    │   ├── etcdoperator.v0.0.2.clusterserviceversion.yaml
    │   └── etcdrestore.crd.yaml
    └── etcd.package.yaml</pre>

					</p></div><p>
					After running the migration, the following bundles are generated in the <code class="literal">bundle/</code> directory:
				</p><div class="formalpara"><p class="title"><strong>Example bundle format layout</strong></p><p>
						
<pre class="programlisting language-terminal">bundle/
├── bundle-0.0.1
│   ├── bundle.Dockerfile
│   ├── manifests
│   │   ├── etcdcluster.crd.yaml
│   │   ├── etcdoperator.clusterserviceversion.yaml
│   ├── metadata
│   │   └── annotations.yaml
│   └── tests
│       └── scorecard
│           └── config.yaml
└── bundle-0.0.2
    ├── bundle.Dockerfile
    ├── manifests
    │   ├── etcdbackup.crd.yaml
    │   ├── etcdcluster.crd.yaml
    │   ├── etcdoperator.v0.0.2.clusterserviceversion.yaml
    │   ├── etcdrestore.crd.yaml
    ├── metadata
    │   └── annotations.yaml
    └── tests
        └── scorecard
            └── config.yaml</pre>

					</p></div><p>
					Based on this generated layout, bundle images for both of the bundles are also built with the following names:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">quay.io/example/etcd:0.0.1</code>
						</li><li class="listitem">
							<code class="literal">quay.io/example/etcd:0.0.2</code>
						</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-packaging-format">Operator Framework packaging format</a>
						</li></ul></div></section><section class="section" id="osdk-migrating-pkgman_osdk-pkgman-to-bundle"><div class="titlepage"><div><div><h3 class="title">5.16.2. Migrating a package manifest project to bundle format</h3></div></div></div><p>
					Operator authors can use the Operator SDK to migrate a package manifest format Operator project to a bundle format project.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Operator SDK CLI installed
						</li><li class="listitem">
							Operator project initially generated using the Operator SDK in package manifest format
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Use the Operator SDK to migrate your package manifest project to the bundle format and generate bundle images:
						</p><pre class="programlisting language-terminal">$ operator-sdk pkgman-to-bundle &lt;package_manifests_dir&gt; \ <span id="CO90-1"><!--Empty--></span><span class="callout">1</span>
    [--output-dir &lt;directory&gt;] \ <span id="CO90-2"><!--Empty--></span><span class="callout">2</span>
    --image-tag-base &lt;image_name_base&gt; <span id="CO90-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO90-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Specify the location of the package manifests directory for the project, such as <code class="literal">packagemanifests/</code> or <code class="literal">manifests/</code>.
								</div></dd><dt><a href="#CO90-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Optional: By default, the generated bundles are written locally to disk to the <code class="literal">bundle/</code> directory. You can use the <code class="literal">--output-dir</code> flag to specify an alternative location.
								</div></dd><dt><a href="#CO90-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Set the <code class="literal">--image-tag-base</code> flag to provide the base of the image name, such as <code class="literal">quay.io/example/etcd</code>, that will be used for the bundles. Provide the name without a tag, because the tag for the images will be set according to the bundle version. For example, the full bundle image names are generated in the format <code class="literal">&lt;image_name_base&gt;:&lt;bundle_version&gt;</code>.
								</div></dd></dl></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Verify that the generated bundle image runs successfully:
						</p><pre class="programlisting language-terminal">$ operator-sdk run bundle &lt;bundle_image_name&gt;:&lt;tag&gt;</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">INFO[0025] Successfully created registry pod: quay-io-my-etcd-0-9-4
INFO[0025] Created CatalogSource: etcd-catalog
INFO[0026] OperatorGroup "operator-sdk-og" created
INFO[0026] Created Subscription: etcdoperator-v0-9-4-sub
INFO[0031] Approved InstallPlan install-5t58z for the Subscription: etcdoperator-v0-9-4-sub
INFO[0031] Waiting for ClusterServiceVersion "default/etcdoperator.v0.9.4" to reach 'Succeeded' phase
INFO[0032]   Waiting for ClusterServiceVersion "default/etcdoperator.v0.9.4" to appear
INFO[0048]   Found ClusterServiceVersion "default/etcdoperator.v0.9.4" phase: Pending
INFO[0049]   Found ClusterServiceVersion "default/etcdoperator.v0.9.4" phase: Installing
INFO[0064]   Found ClusterServiceVersion "default/etcdoperator.v0.9.4" phase: Succeeded
INFO[0065] OLM has successfully installed "etcdoperator.v0.9.4"</pre>

							</p></div></li></ul></div></section></section><section class="section" id="osdk-cli-ref"><div class="titlepage"><div><div><h2 class="title">5.17. Operator SDK CLI reference</h2></div></div></div><p>
				The Operator SDK command-line interface (CLI) is a development kit designed to make writing Operators easier.
			</p><div class="formalpara"><p class="title"><strong>Operator SDK CLI syntax</strong></p><p>
					
<pre class="programlisting language-terminal">$ operator-sdk &lt;command&gt; [&lt;subcommand&gt;] [&lt;argument&gt;] [&lt;flags&gt;]</pre>

				</p></div><p>
				Operator authors with cluster administrator access to a Kubernetes-based cluster (such as OpenShift Container Platform) can use the Operator SDK CLI to develop their own Operators based on Go, Ansible, or Helm. <a class="link" href="https://kubebuilder.io/">Kubebuilder</a> is embedded into the Operator SDK as the scaffolding solution for Go-based Operators, which means existing Kubebuilder projects can be used as is with the Operator SDK and continue to work.
			</p><section class="section" id="osdk-cli-ref-bundle_osdk-cli-ref"><div class="titlepage"><div><div><h3 class="title">5.17.1. bundle</h3></div></div></div><p>
					The <code class="literal">operator-sdk bundle</code> command manages Operator bundle metadata.
				</p><section class="section" id="osdk-cli-ref-bundle-validate_osdk-cli-ref"><div class="titlepage"><div><div><h4 class="title">5.17.1.1. validate</h4></div></div></div><p>
						The <code class="literal">bundle validate</code> subcommand validates an Operator bundle.
					</p><div class="table" id="idm139731977535808"><p class="title"><strong>Table 5.19. <code class="literal">bundle validate</code> flags</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 75%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731977530656" scope="col">Flag</th><th align="left" valign="top" id="idm139731977529568" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731977530656"> <p>
										<code class="literal">-h</code>, <code class="literal">--help</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977529568"> <p>
										Help output for the <code class="literal">bundle validate</code> subcommand.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977530656"> <p>
										<code class="literal">--index-builder</code> (string)
									</p>
									 </td><td align="left" valign="top" headers="idm139731977529568"> <p>
										Tool to pull and unpack bundle images. Only used when validating a bundle image. Available options are <code class="literal">docker</code>, which is the default, <code class="literal">podman</code>, or <code class="literal">none</code>.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977530656"> <p>
										<code class="literal">--list-optional</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977529568"> <p>
										List all optional validators available. When set, no validators are run.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731977530656"> <p>
										<code class="literal">--select-optional</code> (string)
									</p>
									 </td><td align="left" valign="top" headers="idm139731977529568"> <p>
										Label selector to select optional validators to run. When run with the <code class="literal">--list-optional</code> flag, lists available optional validators.
									</p>
									 </td></tr></tbody></table></div></div></section></section><section class="section" id="osdk-cli-ref-cleanup_osdk-cli-ref"><div class="titlepage"><div><div><h3 class="title">5.17.2. cleanup</h3></div></div></div><p>
					The <code class="literal">operator-sdk cleanup</code> command destroys and removes resources that were created for an Operator that was deployed with the <code class="literal">run</code> command.
				</p><div class="table" id="idm139731977504608"><p class="title"><strong>Table 5.20. <code class="literal">cleanup</code> flags</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 75%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731977499456" scope="col">Flag</th><th align="left" valign="top" id="idm139731977498368" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731977499456"> <p>
									<code class="literal">-h</code>, <code class="literal">--help</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977498368"> <p>
									Help output for the <code class="literal">run bundle</code> subcommand.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731977499456"> <p>
									<code class="literal">--kubeconfig</code> (string)
								</p>
								 </td><td align="left" valign="top" headers="idm139731977498368"> <p>
									Path to the <code class="literal">kubeconfig</code> file to use for CLI requests.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731977499456"> <p>
									<code class="literal">-n</code>, <code class="literal">--namespace</code> (string)
								</p>
								 </td><td align="left" valign="top" headers="idm139731977498368"> <p>
									If present, namespace in which to run the CLI request.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731977499456"> <p>
									<code class="literal">--timeout &lt;duration&gt;</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977498368"> <p>
									Time to wait for the command to complete before failing. The default value is <code class="literal">2m0s</code>.
								</p>
								 </td></tr></tbody></table></div></div></section><section class="section" id="osdk-cli-ref-completion_osdk-cli-ref"><div class="titlepage"><div><div><h3 class="title">5.17.3. completion</h3></div></div></div><p>
					The <code class="literal">operator-sdk completion</code> command generates shell completions to make issuing CLI commands quicker and easier.
				</p><div class="table" id="idm139731977474656"><p class="title"><strong>Table 5.21. <code class="literal">completion</code> subcommands</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 75%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731977469504" scope="col">Subcommand</th><th align="left" valign="top" id="idm139731977468416" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731977469504"> <p>
									<code class="literal">bash</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977468416"> <p>
									Generate bash completions.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731977469504"> <p>
									<code class="literal">zsh</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977468416"> <p>
									Generate zsh completions.
								</p>
								 </td></tr></tbody></table></div></div><div class="table" id="idm139731977457952"><p class="title"><strong>Table 5.22. <code class="literal">completion</code> flags</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 75%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731977452800" scope="col">Flag</th><th align="left" valign="top" id="idm139731977451712" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731977452800"> <p>
									<code class="literal">-h, --help</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731977451712"> <p>
									Usage help output.
								</p>
								 </td></tr></tbody></table></div></div><p>
					For example:
				</p><pre class="programlisting language-terminal">$ operator-sdk completion bash</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
						
<pre class="programlisting language-terminal"># bash completion for operator-sdk                         -*- shell-script -*-
...
# ex: ts=4 sw=4 et filetype=sh</pre>

					</p></div></section><section class="section" id="osdk-cli-ref-create_osdk-cli-ref"><div class="titlepage"><div><div><h3 class="title">5.17.4. create</h3></div></div></div><p>
					The <code class="literal">operator-sdk create</code> command is used to create, or <span class="emphasis"><em>scaffold</em></span>, a Kubernetes API.
				</p><section class="section" id="osdk-cli-ref-create-api_osdk-cli-ref"><div class="titlepage"><div><div><h4 class="title">5.17.4.1. api</h4></div></div></div><p>
						The <code class="literal">create api</code> subcommand scaffolds a Kubernetes API. The subcommand must be run in a project that was initialized with the <code class="literal">init</code> command.
					</p><div class="table" id="idm139731977435328"><p class="title"><strong>Table 5.23. <code class="literal">create api</code> flags</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 75%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731977430176" scope="col">Flag</th><th align="left" valign="top" id="idm139731977429088" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731977430176"> <p>
										<code class="literal">-h</code>, <code class="literal">--help</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731977429088"> <p>
										Help output for the <code class="literal">run bundle</code> subcommand.
									</p>
									 </td></tr></tbody></table></div></div></section></section><section class="section" id="osdk-cli-ref-generate_osdk-cli-ref"><div class="titlepage"><div><div><h3 class="title">5.17.5. generate</h3></div></div></div><p>
					The <code class="literal">operator-sdk generate</code> command invokes a specific generator to generate code or manifests.
				</p><section class="section" id="osdk-cli-ref-generate-bundle_osdk-cli-ref"><div class="titlepage"><div><div><h4 class="title">5.17.5.1. bundle</h4></div></div></div><p>
						The <code class="literal">generate bundle</code> subcommand generates a set of bundle manifests, metadata, and a <code class="literal">bundle.Dockerfile</code> file for your Operator project.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Typically, you run the <code class="literal">generate kustomize manifests</code> subcommand first to generate the input <a class="link" href="https://kustomize.io/">Kustomize</a> bases that are used by the <code class="literal">generate bundle</code> subcommand. However, you can use the <code class="literal">make bundle</code> command in an initialized project to automate running these commands in sequence.
						</p></div></div><div class="table" id="idm139731977412912"><p class="title"><strong>Table 5.24. <code class="literal">generate bundle</code> flags</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 75%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731974634736" scope="col">Flag</th><th align="left" valign="top" id="idm139731974633648" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731974634736"> <p>
										<code class="literal">--channels</code> (string)
									</p>
									 </td><td align="left" valign="top" headers="idm139731974633648"> <p>
										Comma-separated list of channels to which the bundle belongs. The default value is <code class="literal">alpha</code>.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974634736"> <p>
										<code class="literal">--crds-dir</code> (string)
									</p>
									 </td><td align="left" valign="top" headers="idm139731974633648"> <p>
										Root directory for <code class="literal">CustomResoureDefinition</code> manifests.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974634736"> <p>
										<code class="literal">--default-channel</code> (string)
									</p>
									 </td><td align="left" valign="top" headers="idm139731974633648"> <p>
										The default channel for the bundle.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974634736"> <p>
										<code class="literal">--deploy-dir</code> (string)
									</p>
									 </td><td align="left" valign="top" headers="idm139731974633648"> <p>
										Root directory for Operator manifests, such as deployments and RBAC. This directory is different from the directory passed to the <code class="literal">--input-dir</code> flag.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974634736"> <p>
										<code class="literal">-h</code>, <code class="literal">--help</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731974633648"> <p>
										Help for <code class="literal">generate bundle</code>
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974634736"> <p>
										<code class="literal">--input-dir</code> (string)
									</p>
									 </td><td align="left" valign="top" headers="idm139731974633648"> <p>
										Directory from which to read an existing bundle. This directory is the parent of your bundle <code class="literal">manifests</code> directory and is different from the <code class="literal">--deploy-dir</code> directory.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974634736"> <p>
										<code class="literal">--kustomize-dir</code> (string)
									</p>
									 </td><td align="left" valign="top" headers="idm139731974633648"> <p>
										Directory containing Kustomize bases and a <code class="literal">kustomization.yaml</code> file for bundle manifests. The default path is <code class="literal">config/manifests</code>.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974634736"> <p>
										<code class="literal">--manifests</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731974633648"> <p>
										Generate bundle manifests.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974634736"> <p>
										<code class="literal">--metadata</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731974633648"> <p>
										Generate bundle metadata and Dockerfile.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974634736"> <p>
										<code class="literal">--output-dir</code> (string)
									</p>
									 </td><td align="left" valign="top" headers="idm139731974633648"> <p>
										Directory to write the bundle to.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974634736"> <p>
										<code class="literal">--overwrite</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731974633648"> <p>
										Overwrite the bundle metadata and Dockerfile if they exist. The default value is <code class="literal">true</code>.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974634736"> <p>
										<code class="literal">--package</code> (string)
									</p>
									 </td><td align="left" valign="top" headers="idm139731974633648"> <p>
										Package name for the bundle.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974634736"> <p>
										<code class="literal">-q</code>, <code class="literal">--quiet</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731974633648"> <p>
										Run in quiet mode.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974634736"> <p>
										<code class="literal">--stdout</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731974633648"> <p>
										Write bundle manifest to standard out.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974634736"> <p>
										<code class="literal">--version</code> (string)
									</p>
									 </td><td align="left" valign="top" headers="idm139731974633648"> <p>
										Semantic version of the Operator in the generated bundle. Set only when creating a new bundle or upgrading the Operator.
									</p>
									 </td></tr></tbody></table></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-bundle-operator_osdk-working-bundle-images">Bundling an Operator</a> for a full procedure that includes using the <code class="literal">make bundle</code> command to call the <code class="literal">generate bundle</code> subcommand.
							</li></ul></div></section><section class="section" id="osdk-cli-ref-generate-kustomize_osdk-cli-ref"><div class="titlepage"><div><div><h4 class="title">5.17.5.2. kustomize</h4></div></div></div><p>
						The <code class="literal">generate kustomize</code> subcommand contains subcommands that generate <a class="link" href="https://kustomize.io/">Kustomize</a> data for the Operator.
					</p><section class="section" id="osdk-cli-ref-generate-kustomize-manifests_osdk-cli-ref"><div class="titlepage"><div><div><h5 class="title">5.17.5.2.1. manifests</h5></div></div></div><p>
							The <code class="literal">generate kustomize manifests</code> subcommand generates or regenerates Kustomize bases and a <code class="literal">kustomization.yaml</code> file in the <code class="literal">config/manifests</code> directory, which are used to build bundle manifests by other Operator SDK commands. This command interactively asks for UI metadata, an important component of manifest bases, by default unless a base already exists or you set the <code class="literal">--interactive=false</code> flag.
						</p><div class="table" id="idm139731974552320"><p class="title"><strong>Table 5.25. <code class="literal">generate kustomize manifests</code> flags</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 75%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731974547152" scope="col">Flag</th><th align="left" valign="top" id="idm139731974546064" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731974547152"> <p>
											<code class="literal">--apis-dir</code> (string)
										</p>
										 </td><td align="left" valign="top" headers="idm139731974546064"> <p>
											Root directory for API type definitions.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139731974547152"> <p>
											<code class="literal">-h</code>, <code class="literal">--help</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731974546064"> <p>
											Help for <code class="literal">generate kustomize manifests</code>.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139731974547152"> <p>
											<code class="literal">--input-dir</code> (string)
										</p>
										 </td><td align="left" valign="top" headers="idm139731974546064"> <p>
											Directory containing existing Kustomize files.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139731974547152"> <p>
											<code class="literal">--interactive</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731974546064"> <p>
											When set to <code class="literal">false</code>, if no Kustomize base exists, an interactive command prompt is presented to accept custom metadata.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139731974547152"> <p>
											<code class="literal">--output-dir</code> (string)
										</p>
										 </td><td align="left" valign="top" headers="idm139731974546064"> <p>
											Directory where to write Kustomize files.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139731974547152"> <p>
											<code class="literal">--package</code> (string)
										</p>
										 </td><td align="left" valign="top" headers="idm139731974546064"> <p>
											Package name.
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm139731974547152"> <p>
											<code class="literal">-q</code>, <code class="literal">--quiet</code>
										</p>
										 </td><td align="left" valign="top" headers="idm139731974546064"> <p>
											Run in quiet mode.
										</p>
										 </td></tr></tbody></table></div></div></section></section></section><section class="section" id="osdk-cli-ref-init_osdk-cli-ref"><div class="titlepage"><div><div><h3 class="title">5.17.6. init</h3></div></div></div><p>
					The <code class="literal">operator-sdk init</code> command initializes an Operator project and generates, or <span class="emphasis"><em>scaffolds</em></span>, a default project directory layout for the given plugin.
				</p><p>
					This command writes the following files:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Boilerplate license file
						</li><li class="listitem">
							<code class="literal">PROJECT</code> file with the domain and repository
						</li><li class="listitem">
							<code class="literal">Makefile</code> to build the project
						</li><li class="listitem">
							<code class="literal">go.mod</code> file with project dependencies
						</li><li class="listitem">
							<code class="literal">kustomization.yaml</code> file for customizing manifests
						</li><li class="listitem">
							Patch file for customizing images for manager manifests
						</li><li class="listitem">
							Patch file for enabling Prometheus metrics
						</li><li class="listitem">
							<code class="literal">main.go</code> file to run
						</li></ul></div><div class="table" id="idm139731974498384"><p class="title"><strong>Table 5.26. <code class="literal">init</code> flags</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 75%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731974493232" scope="col">Flag</th><th align="left" valign="top" id="idm139731974492144" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731974493232"> <p>
									<code class="literal">--help, -h</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731974492144"> <p>
									Help output for the <code class="literal">init</code> command.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731974493232"> <p>
									<code class="literal">--plugins</code> (string)
								</p>
								 </td><td align="left" valign="top" headers="idm139731974492144"> <p>
									Name and optionally version of the plugin to initialize the project with. Available plugins are <code class="literal">ansible.sdk.operatorframework.io/v1</code>, <code class="literal">go.kubebuilder.io/v2</code>, <code class="literal">go.kubebuilder.io/v3</code>, and <code class="literal">helm.sdk.operatorframework.io/v1</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731974493232"> <p>
									<code class="literal">--project-version</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731974492144"> <p>
									Project version. Available values are <code class="literal">2</code> and <code class="literal">3-alpha</code>, which is the default.
								</p>
								 </td></tr></tbody></table></div></div></section><section class="section" id="osdk-cli-ref-run_osdk-cli-ref"><div class="titlepage"><div><div><h3 class="title">5.17.7. run</h3></div></div></div><p>
					The <code class="literal">operator-sdk run</code> command provides options that can launch the Operator in various environments.
				</p><section class="section" id="osdk-cli-ref-run-bundle_osdk-cli-ref"><div class="titlepage"><div><div><h4 class="title">5.17.7.1. bundle</h4></div></div></div><p>
						The <code class="literal">run bundle</code> subcommand deploys an Operator in the bundle format with Operator Lifecycle Manager (OLM).
					</p><div class="table" id="idm139731974469136"><p class="title"><strong>Table 5.27. <code class="literal">run bundle</code> flags</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 75%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731974463984" scope="col">Flag</th><th align="left" valign="top" id="idm139731974462896" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731974463984"> <p>
										<code class="literal">--index-image</code> (string)
									</p>
									 </td><td align="left" valign="top" headers="idm139731974462896"> <p>
										Index image in which to inject a bundle. The default image is <code class="literal">quay.io/operator-framework/upstream-opm-builder:latest</code>.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974463984"> <p>
										<code class="literal">--install-mode &lt;install_mode_value&gt;</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731974462896"> <p>
										Install mode supported by the cluster service version (CSV) of the Operator, for example <code class="literal">AllNamespaces</code> or <code class="literal">SingleNamespace</code>.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974463984"> <p>
										<code class="literal">--timeout &lt;duration&gt;</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731974462896"> <p>
										Install timeout. The default value is <code class="literal">2m0s</code>.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974463984"> <p>
										<code class="literal">--kubeconfig</code> (string)
									</p>
									 </td><td align="left" valign="top" headers="idm139731974462896"> <p>
										Path to the <code class="literal">kubeconfig</code> file to use for CLI requests.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974463984"> <p>
										<code class="literal">-n</code>, <code class="literal">--namespace</code> (string)
									</p>
									 </td><td align="left" valign="top" headers="idm139731974462896"> <p>
										If present, namespace in which to run the CLI request.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974463984"> <p>
										<code class="literal">-h</code>, <code class="literal">--help</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731974462896"> <p>
										Help output for the <code class="literal">run bundle</code> subcommand.
									</p>
									 </td></tr></tbody></table></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
								See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-operatorgroups-membership_olm-understanding-operatorgroups">Operator group membership</a> for details on possible install modes.
							</li></ul></div></section><section class="section" id="osdk-cli-ref-run-bundle-upgrade_osdk-cli-ref"><div class="titlepage"><div><div><h4 class="title">5.17.7.2. bundle-upgrade</h4></div></div></div><p>
						The <code class="literal">run bundle-upgrade</code> subcommand upgrades an Operator that was previously installed in the bundle format with Operator Lifecycle Manager (OLM).
					</p><div class="table" id="idm139731974426032"><p class="title"><strong>Table 5.28. <code class="literal">run bundle-upgrade</code> flags</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 75%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731974420880" scope="col">Flag</th><th align="left" valign="top" id="idm139731974419792" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731974420880"> <p>
										<code class="literal">--timeout &lt;duration&gt;</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731974419792"> <p>
										Upgrade timeout. The default value is <code class="literal">2m0s</code>.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974420880"> <p>
										<code class="literal">--kubeconfig</code> (string)
									</p>
									 </td><td align="left" valign="top" headers="idm139731974419792"> <p>
										Path to the <code class="literal">kubeconfig</code> file to use for CLI requests.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974420880"> <p>
										<code class="literal">-n</code>, <code class="literal">--namespace</code> (string)
									</p>
									 </td><td align="left" valign="top" headers="idm139731974419792"> <p>
										If present, namespace in which to run the CLI request.
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm139731974420880"> <p>
										<code class="literal">-h</code>, <code class="literal">--help</code>
									</p>
									 </td><td align="left" valign="top" headers="idm139731974419792"> <p>
										Help output for the <code class="literal">run bundle</code> subcommand.
									</p>
									 </td></tr></tbody></table></div></div></section></section><section class="section" id="osdk-cli-ref-scorecard_osdk-cli-ref"><div class="titlepage"><div><div><h3 class="title">5.17.8. scorecard</h3></div></div></div><p>
					The <code class="literal">operator-sdk scorecard</code> command runs the scorecard tool to validate an Operator bundle and provide suggestions for improvements. The command takes one argument, either a bundle image or directory containing manifests and metadata. If the argument holds an image tag, the image must be present remotely.
				</p><div class="table" id="idm139731974395776"><p class="title"><strong>Table 5.29. <code class="literal">scorecard</code> flags</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 75%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731974390624" scope="col">Flag</th><th align="left" valign="top" id="idm139731974389536" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731974390624"> <p>
									<code class="literal">-c</code>, <code class="literal">--config</code> (string)
								</p>
								 </td><td align="left" valign="top" headers="idm139731974389536"> <p>
									Path to scorecard configuration file. The default path is <code class="literal">bundle/tests/scorecard/config.yaml</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731974390624"> <p>
									<code class="literal">-h</code>, <code class="literal">--help</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731974389536"> <p>
									Help output for the <code class="literal">scorecard</code> command.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731974390624"> <p>
									<code class="literal">--kubeconfig</code> (string)
								</p>
								 </td><td align="left" valign="top" headers="idm139731974389536"> <p>
									Path to <code class="literal">kubeconfig</code> file.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731974390624"> <p>
									<code class="literal">-L</code>, <code class="literal">--list</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731974389536"> <p>
									List which tests are available to run.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731974390624"> <p>
									<code class="literal">-n</code>, --namespace (string)
								</p>
								 </td><td align="left" valign="top" headers="idm139731974389536"> <p>
									Namespace in which to run the test images.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731974390624"> <p>
									<code class="literal">-o</code>, <code class="literal">--output</code> (string)
								</p>
								 </td><td align="left" valign="top" headers="idm139731974389536"> <p>
									Output format for results. Available values are <code class="literal">text</code>, which is the default, and <code class="literal">json</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731974390624"> <p>
									<code class="literal">-l</code>, <code class="literal">--selector</code> (string)
								</p>
								 </td><td align="left" valign="top" headers="idm139731974389536"> <p>
									Label selector to determine which tests are run.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731974390624"> <p>
									<code class="literal">-s</code>, <code class="literal">--service-account</code> (string)
								</p>
								 </td><td align="left" valign="top" headers="idm139731974389536"> <p>
									Service account to use for tests. The default value is <code class="literal">default</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731974390624"> <p>
									<code class="literal">-x</code>, <code class="literal">--skip-cleanup</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731974389536"> <p>
									Disable resource cleanup after tests are run.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139731974390624"> <p>
									<code class="literal">-w</code>, <code class="literal">--wait-time &lt;duration&gt;</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139731974389536"> <p>
									Seconds to wait for tests to complete, for example <code class="literal">35s</code>. The default value is <code class="literal">30s</code>.
								</p>
								 </td></tr></tbody></table></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#osdk-scorecard">Validating Operators using the scorecard tool</a> for details about running the scorecard tool.
						</li></ul></div></section></section></section><section class="chapter" id="cluster-operators-ref"><div class="titlepage"><div><div><h1 class="title">Chapter 6. Cluster Operators reference</h1></div></div></div><p>
			This reference guide indexes the <span class="emphasis"><em>cluster Operators</em></span> shipped by Red Hat that serve as the architectural foundation for OpenShift Container Platform. Cluster Operators are installed by default, unless otherwise noted, and are managed by the Cluster Version Operator (CVO). For more details on the control plane architecture, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/architecture/#operators-overview_control-plane">Operators in OpenShift Container Platform</a>.
		</p><p>
			Cluster administrators can view cluster Operators in the OpenShift Container Platform web console from the <span class="strong strong"><strong>Administration</strong></span> → <span class="strong strong"><strong>Cluster Settings</strong></span> page.
		</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				Cluster Operators are not managed by Operator Lifecycle Manager (OLM) and OperatorHub. OLM and OperatorHub are part of the <a class="link" href="https://operatorframework.io/">Operator Framework</a> used in OpenShift Container Platform for installing and running optional <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/architecture/#olm-operators_control-plane">add-on Operators</a>.
			</p></div></div><p>
			Some of the following cluster Operators can be disabled prior to installation. For more information see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#cluster-capabilities">cluster capabilities</a>.
		</p><section class="section" id="cluster-bare-metal-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.1. Cluster Baremetal Operator</h2></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The Cluster Baremetal Operator is an optional cluster capability that can be disabled by cluster administrators during installation. For more information about optional cluster capabilities, see "Cluster capabilities" in <span class="emphasis"><em>Installing</em></span>.
				</p></div></div><h4 id="purpose">Purpose</h4><p>
				The Cluster Baremetal Operator (CBO) deploys all the components necessary to take a bare-metal server to a fully functioning worker node ready to run OpenShift Container Platform compute nodes. The CBO ensures that the metal3 deployment, which consists of the Bare Metal Operator (BMO) and Ironic containers, runs on one of the control plane nodes within the OpenShift Container Platform cluster. The CBO also listens for OpenShift Container Platform updates to resources that it watches and takes appropriate action.
			</p><h4 id="project">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-baremetal-operator">cluster-baremetal-operator</a>
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#cluster-bare-metal-operator_cluster-capabilities">Bare-metal capability</a>
					</li></ul></div></section><section class="section" id="baremetal-event-relay_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.2. Bare Metal Event Relay</h2></div></div></div><h4 id="purpose-2">Purpose</h4><p>
				The OpenShift Bare Metal Event Relay manages the life-cycle of the Bare Metal Event Relay. The Bare Metal Event Relay enables you to configure the types of cluster event that are monitored using Redfish hardware events.
			</p><h4 id="configuration-objects">Configuration objects</h4><p>
				You can use this command to edit the configuration after installation: for example, the webhook port. You can edit configuration objects with:
			</p><pre class="programlisting language-terminal">$ oc -n [namespace] edit cm hw-event-proxy-operator-manager-config</pre><pre class="programlisting language-terminal">apiVersion: controller-runtime.sigs.k8s.io/v1alpha1
kind: ControllerManagerConfig
health:
  healthProbeBindAddress: :8081
metrics:
  bindAddress: 127.0.0.1:8080
webhook:
  port: 9443
leaderElection:
  leaderElect: true
  resourceName: 6e7a703c.redhat-cne.org</pre><h4 id="project-2">Project</h4><p>
				<a class="link" href="https://github.com/redhat-cne/hw-event-proxy-operator">hw-event-proxy-operator</a>
			</p><h4 id="crd">CRD</h4><p>
				The proxy enables applications running on bare-metal clusters to respond quickly to Redfish hardware changes and failures such as breaches of temperature thresholds, fan failure, disk loss, power outages, and memory failure, reported using the HardwareEvent CR.
			</p><p>
				<code class="literal">hardwareevents.event.redhat-cne.org</code>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Scope: Namespaced
					</li><li class="listitem">
						CR: HardwareEvent
					</li><li class="listitem">
						Validation: Yes
					</li></ul></div></section><section class="section" id="cloud-credential-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.3. Cloud Credential Operator</h2></div></div></div><h4 id="purpose-3">Purpose</h4><p>
				The Cloud Credential Operator (CCO) manages cloud provider credentials as Kubernetes custom resource definitions (CRDs). The CCO syncs on <code class="literal">CredentialsRequest</code> custom resources (CRs) to allow OpenShift Container Platform components to request cloud provider credentials with the specific permissions that are required for the cluster to run.
			</p><p>
				By setting different values for the <code class="literal">credentialsMode</code> parameter in the <code class="literal">install-config.yaml</code> file, the CCO can be configured to operate in several different modes. If no mode is specified, or the <code class="literal">credentialsMode</code> parameter is set to an empty string (<code class="literal">""</code>), the CCO operates in its default mode.
			</p><h4 id="project-3">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cloud-credential-operator">openshift-cloud-credential-operator</a>
			</p><h4 id="crds-2">CRDs</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<code class="literal">credentialsrequests.cloudcredential.openshift.io</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Scope: Namespaced
							</li><li class="listitem">
								CR: <code class="literal">CredentialsRequest</code>
							</li><li class="listitem">
								Validation: Yes
							</li></ul></div></li></ul></div><h4 id="configuration-objects-2">Configuration objects</h4><p>
				No configuration required.
			</p><h4 id="additional-resources_cluster-op-ref-cco">Additional resources</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/authentication_and_authorization/#about-cloud-credential-operator">About the Cloud Credential Operator</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/api_reference/#credentialsrequest-cloudcredential-openshift-io-v1"><code class="literal">CredentialsRequest</code> custom resource</a>
					</li></ul></div></section><section class="section" id="cluster-authentication-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.4. Cluster Authentication Operator</h2></div></div></div><h4 id="purpose-4">Purpose</h4><p>
				The Cluster Authentication Operator installs and maintains the <code class="literal">Authentication</code> custom resource in a cluster and can be viewed with:
			</p><pre class="programlisting language-terminal">$ oc get clusteroperator authentication -o yaml</pre><h4 id="project-4">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-authentication-operator">cluster-authentication-operator</a>
			</p></section><section class="section" id="cluster-autoscaler-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.5. Cluster Autoscaler Operator</h2></div></div></div><h4 id="purpose-5">Purpose</h4><p>
				The Cluster Autoscaler Operator manages deployments of the OpenShift Cluster Autoscaler using the <code class="literal">cluster-api</code> provider.
			</p><h4 id="project-5">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-autoscaler-operator">cluster-autoscaler-operator</a>
			</p><h4 id="crds-3">CRDs</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">ClusterAutoscaler</code>: This is a singleton resource, which controls the configuration autoscaler instance for the cluster. The Operator only responds to the <code class="literal">ClusterAutoscaler</code> resource named <code class="literal">default</code> in the managed namespace, the value of the <code class="literal">WATCH_NAMESPACE</code> environment variable.
					</li><li class="listitem">
						<code class="literal">MachineAutoscaler</code>: This resource targets a node group and manages the annotations to enable and configure autoscaling for that group, the <code class="literal">min</code> and <code class="literal">max</code> size. Currently only <code class="literal">MachineSet</code> objects can be targeted.
					</li></ul></div></section><section class="section" id="cluster-cloud-controller-manager-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.6. Cluster Cloud Controller Manager Operator</h2></div></div></div><h4 id="purpose-6">Purpose</h4><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					This Operator is General Availability for Microsoft Azure Stack Hub, Nutanix, Red Hat OpenStack Platform (RHOSP), and VMware vSphere.
				</p><p>
					It is available as a <a class="link" href="https://access.redhat.com/support/offerings/techpreview">Technology Preview</a> for Alibaba Cloud, Amazon Web Services (AWS), Google Cloud Platform (GCP), IBM Cloud, IBM Cloud Power VS, and Microsoft Azure.
				</p></div></div><p>
				The Cluster Cloud Controller Manager Operator manages and updates the cloud controller managers deployed on top of OpenShift Container Platform. The Operator is based on the Kubebuilder framework and <code class="literal">controller-runtime</code> libraries. It is installed via the Cluster Version Operator (CVO).
			</p><p>
				It contains the following components:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Operator
					</li><li class="listitem">
						Cloud configuration observer
					</li></ul></div><p>
				By default, the Operator exposes Prometheus metrics through the <code class="literal">metrics</code> service.
			</p><h4 id="project-6">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-cloud-controller-manager-operator">cluster-cloud-controller-manager-operator</a>
			</p></section><section class="section" id="cluster-capi-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.7. Cluster CAPI Operator</h2></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					This Operator is available as a <a class="link" href="https://access.redhat.com/support/offerings/techpreview">Technology Preview</a> for Amazon Web Services (AWS) and Google Cloud Platform (GCP).
				</p></div></div><h4 id="purpose-7">Purpose</h4><p>
				The Cluster CAPI Operator maintains the lifecycle of Cluster API resources. This Operator is responsible for all administrative tasks related to deploying the Cluster API project within an OpenShift Container Platform cluster.
			</p><h4 id="project-7">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-capi-operator">cluster-capi-operator</a>
			</p><h4 id="crds-4">CRDs</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<code class="literal">awsmachines.infrastructure.cluster.x-k8s.io</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Scope: Namespaced
							</li><li class="listitem">
								CR: <code class="literal">awsmachine</code>
							</li><li class="listitem">
								Validation: No
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<code class="literal">gcpmachines.infrastructure.cluster.x-k8s.io</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Scope: Namespaced
							</li><li class="listitem">
								CR: <code class="literal">gcpmachine</code>
							</li><li class="listitem">
								Validation: No
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<code class="literal">awsmachinetemplates.infrastructure.cluster.x-k8s.io</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Scope: Namespaced
							</li><li class="listitem">
								CR: <code class="literal">awsmachinetemplate</code>
							</li><li class="listitem">
								Validation: No
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<code class="literal">gcpmachinetemplates.infrastructure.cluster.x-k8s.io</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Scope: Namespaced
							</li><li class="listitem">
								CR: <code class="literal">gcpmachinetemplate</code>
							</li><li class="listitem">
								Validation: No
							</li></ul></div></li></ul></div></section><section class="section" id="cluster-config-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.8. Cluster Config Operator</h2></div></div></div><h4 id="purpose-8">Purpose</h4><p>
				The Cluster Config Operator performs the following tasks related to <code class="literal">config.openshift.io</code>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Creates CRDs.
					</li><li class="listitem">
						Renders the initial custom resources.
					</li><li class="listitem">
						Handles migrations.
					</li></ul></div><h4 id="project-8">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-config-operator">cluster-config-operator</a>
			</p></section><section class="section" id="cluster-csi-snapshot-controller-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.9. Cluster CSI Snapshot Controller Operator</h2></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The Cluster CSI Snapshot Controller Operator is an optional cluster capability that can be disabled by cluster administrators during installation. For more information about optional cluster capabilities, see "Cluster capabilities" in <span class="emphasis"><em>Installing</em></span>.
				</p></div></div><h4 id="purpose-9">Purpose</h4><p>
				The Cluster CSI Snapshot Controller Operator installs and maintains the CSI Snapshot Controller. The CSI Snapshot Controller is responsible for watching the <code class="literal">VolumeSnapshot</code> CRD objects and manages the creation and deletion lifecycle of volume snapshots.
			</p><h4 id="project-9">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-csi-snapshot-controller-operator">cluster-csi-snapshot-controller-operator</a>
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#cluster-csi-snapshot-controller-operator_cluster-capabilities">CSI snapshot controller capability</a>
					</li></ul></div></section><section class="section" id="cluster-image-registry-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.10. Cluster Image Registry Operator</h2></div></div></div><h4 id="purpose-10">Purpose</h4><p>
				The Cluster Image Registry Operator manages a singleton instance of the OpenShift image registry. It manages all configuration of the registry, including creating storage.
			</p><p>
				On initial start up, the Operator creates a default <code class="literal">image-registry</code> resource instance based on the configuration detected in the cluster. This indicates what cloud storage type to use based on the cloud provider.
			</p><p>
				If insufficient information is available to define a complete <code class="literal">image-registry</code> resource, then an incomplete resource is defined and the Operator updates the resource status with information about what is missing.
			</p><p>
				The Cluster Image Registry Operator runs in the <code class="literal">openshift-image-registry</code> namespace and it also manages the registry instance in that location. All configuration and workload resources for the registry reside in that namespace.
			</p><h4 id="project-10">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-image-registry-operator">cluster-image-registry-operator</a>
			</p></section><section class="section" id="cluster-machine-approver-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.11. Cluster Machine Approver Operator</h2></div></div></div><h4 id="purpose-11">Purpose</h4><p>
				The Cluster Machine Approver Operator automatically approves the CSRs requested for a new worker node after cluster installation.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					For the control plane node, the <code class="literal">approve-csr</code> service on the bootstrap node automatically approves all CSRs during the cluster bootstrapping phase.
				</p></div></div><h4 id="project-11">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-machine-approver">cluster-machine-approver-operator</a>
			</p></section><section class="section" id="cluster-monitoring-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.12. Cluster Monitoring Operator</h2></div></div></div><h4 id="purpose-12">Purpose</h4><p>
				The Cluster Monitoring Operator manages and updates the Prometheus-based cluster monitoring stack deployed on top of OpenShift Container Platform.
			</p><h4 id="project-12">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-monitoring-operator">openshift-monitoring</a>
			</p><h4 id="crds-5">CRDs</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<code class="literal">alertmanagers.monitoring.coreos.com</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Scope: Namespaced
							</li><li class="listitem">
								CR: <code class="literal">alertmanager</code>
							</li><li class="listitem">
								Validation: Yes
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<code class="literal">prometheuses.monitoring.coreos.com</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Scope: Namespaced
							</li><li class="listitem">
								CR: <code class="literal">prometheus</code>
							</li><li class="listitem">
								Validation: Yes
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<code class="literal">prometheusrules.monitoring.coreos.com</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Scope: Namespaced
							</li><li class="listitem">
								CR: <code class="literal">prometheusrule</code>
							</li><li class="listitem">
								Validation: Yes
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<code class="literal">servicemonitors.monitoring.coreos.com</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Scope: Namespaced
							</li><li class="listitem">
								CR: <code class="literal">servicemonitor</code>
							</li><li class="listitem">
								Validation: Yes
							</li></ul></div></li></ul></div><h4 id="configuration-objects-3">Configuration objects</h4><pre class="programlisting language-terminal">$ oc -n openshift-monitoring edit cm cluster-monitoring-config</pre></section><section class="section" id="cluster-network-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.13. Cluster Network Operator</h2></div></div></div><h4 id="purpose-13">Purpose</h4><p>
				The Cluster Network Operator installs and upgrades the networking components on an OpenShift Container Platform cluster.
			</p></section><section class="section" id="cluster-samples-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.14. Cluster Samples Operator</h2></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The Cluster Samples Operator is an optional cluster capability that can be disabled by cluster administrators during installation. For more information about optional cluster capabilities, see "Cluster capabilities" in <span class="emphasis"><em>Installing</em></span>.
				</p></div></div><h4 id="purpose-14">Purpose</h4><p>
				The Cluster Samples Operator manages the sample image streams and templates stored in the <code class="literal">openshift</code> namespace.
			</p><p>
				On initial start up, the Operator creates the default samples configuration resource to initiate the creation of the image streams and templates. The configuration object is a cluster scoped object with the key <code class="literal">cluster</code> and type <code class="literal">configs.samples</code>.
			</p><p>
				The image streams are the Red Hat Enterprise Linux CoreOS (RHCOS)-based OpenShift Container Platform image streams pointing to images on <code class="literal">registry.redhat.io</code>. Similarly, the templates are those categorized as OpenShift Container Platform templates.
			</p><p>
				The Cluster Samples Operator deployment is contained within the <code class="literal">openshift-cluster-samples-operator</code> namespace. On start up, the install pull secret is used by the image stream import logic in the OpenShift image registry and API server to authenticate with <code class="literal">registry.redhat.io</code>. An administrator can create any additional secrets in the <code class="literal">openshift</code> namespace if they change the registry used for the sample image streams. If created, those secrets contain the content of a <code class="literal">config.json</code> for <code class="literal">docker</code> needed to facilitate image import.
			</p><p>
				The image for the Cluster Samples Operator contains image stream and template definitions for the associated OpenShift Container Platform release. After the Cluster Samples Operator creates a sample, it adds an annotation that denotes the OpenShift Container Platform version that it is compatible with. The Operator uses this annotation to ensure that each sample matches the compatible release version. Samples outside of its inventory are ignored, as are skipped samples.
			</p><p>
				Modifications to any samples that are managed by the Operator are allowed as long as the version annotation is not modified or deleted. However, on an upgrade, as the version annotation will change, those modifications can get replaced as the sample will be updated with the newer version. The Jenkins images are part of the image payload from the installation and are tagged into the image streams directly.
			</p><p>
				The samples resource includes a finalizer, which cleans up the following upon its deletion:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Operator-managed image streams
					</li><li class="listitem">
						Operator-managed templates
					</li><li class="listitem">
						Operator-generated configuration resources
					</li><li class="listitem">
						Cluster status resources
					</li></ul></div><p>
				Upon deletion of the samples resource, the Cluster Samples Operator recreates the resource using the default configuration.
			</p><h4 id="project-13">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-samples-operator">cluster-samples-operator</a>
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#cluster-samples-operator_cluster-capabilities">OpenShift samples capability</a>
					</li></ul></div></section><section class="section" id="cluster-storage-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.15. Cluster Storage Operator</h2></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The Cluster Storage Operator is an optional cluster capability that can be disabled by cluster administrators during installation. For more information about optional cluster capabilities, see "Cluster capabilities" in <span class="emphasis"><em>Installing</em></span>.
				</p></div></div><h4 id="purpose-15">Purpose</h4><p>
				The Cluster Storage Operator sets OpenShift Container Platform cluster-wide storage defaults. It ensures a default <code class="literal">storageclass</code> exists for OpenShift Container Platform clusters. It also installs Container Storage Interface (CSI) drivers which enable your cluster to use various storage backends.
			</p><h4 id="project-14">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-storage-operator">cluster-storage-operator</a>
			</p><h4 id="configuration">Configuration</h4><p>
				No configuration is required.
			</p><h4 id="notes">Notes</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The storage class that the Operator creates can be made non-default by editing its annotation, but this storage class cannot be deleted as long as the Operator runs.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#cluster-storage-operator_cluster-capabilities">Storage capability</a>
					</li></ul></div></section><section class="section" id="cluster-version-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.16. Cluster Version Operator</h2></div></div></div><h4 id="purpose-16">Purpose</h4><p>
				Cluster Operators manage specific areas of cluster functionality. The Cluster Version Operator (CVO) manages the lifecycle of cluster Operators, many of which are installed in OpenShift Container Platform by default.
			</p><p>
				The CVO also checks with the OpenShift Update Service to see the valid updates and update paths based on current component versions and information in the graph.
			</p><h4 id="project-15">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-version-operator">cluster-version-operator</a>
			</p></section><section class="section" id="console-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.17. Console Operator</h2></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The Console Operator is an optional cluster capability that can be disabled by cluster administrators during installation. If you disable the Console Operator at installation, your cluster is still supported and upgradable. For more information about optional cluster capabilities, see "Cluster capabilities" in <span class="emphasis"><em>Installing</em></span>.
				</p></div></div><h4 id="purpose-17">Purpose</h4><p>
				The Console Operator installs and maintains the OpenShift Container Platform web console on a cluster. The Console Operator is installed by default and automatically maintains a console.
			</p><h4 id="project-16">Project</h4><p>
				<a class="link" href="https://github.com/openshift/console-operator">console-operator</a>
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#console-operator_cluster-capabilities">Web console capability</a>
					</li></ul></div></section><section class="section" id="control-plane-machine-set-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.18. Control Plane Machine Set Operator</h2></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					This Operator is available for Amazon Web Services (AWS), Google Cloud Platform (GCP), Microsoft Azure, and VMware vSphere.
				</p></div></div><h4 id="purpose-18">Purpose</h4><p>
				The Control Plane Machine Set Operator automates the management of control plane machine resources within an OpenShift Container Platform cluster.
			</p><h4 id="project-17">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-control-plane-machine-set-operator">cluster-control-plane-machine-set-operator</a>
			</p><h4 id="crds-6">CRDs</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<code class="literal">controlplanemachineset.machine.openshift.io</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Scope: Namespaced
							</li><li class="listitem">
								CR: <code class="literal">ControlPlaneMachineSet</code>
							</li><li class="listitem">
								Validation: Yes
							</li></ul></div></li></ul></div><h4 id="additional-resources_cluster-op-ref-cpmso">Additional resources</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/machine_management/#cpmso-about">About control plane machine sets</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/api_reference/#controlplanemachineset-machine-openshift-io-v1"><code class="literal">ControlPlaneMachineSet</code> custom resource</a>
					</li></ul></div></section><section class="section" id="dns-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.19. DNS Operator</h2></div></div></div><h4 id="purpose-19">Purpose</h4><p>
				The DNS Operator deploys and manages CoreDNS to provide a name resolution service to pods that enables DNS-based Kubernetes Service discovery in OpenShift Container Platform.
			</p><p>
				The Operator creates a working default deployment based on the cluster’s configuration.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The default cluster domain is <code class="literal">cluster.local</code>.
					</li><li class="listitem">
						Configuration of the CoreDNS Corefile or Kubernetes plugin is not yet supported.
					</li></ul></div><p>
				The DNS Operator manages CoreDNS as a Kubernetes daemon set exposed as a service with a static IP. CoreDNS runs on all nodes in the cluster.
			</p><h4 id="project-18">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-dns-operator">cluster-dns-operator</a>
			</p></section><section class="section" id="etcd-cluster-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.20. etcd cluster Operator</h2></div></div></div><h4 id="purpose-20">Purpose</h4><p>
				The etcd cluster Operator automates etcd cluster scaling, enables etcd monitoring and metrics, and simplifies disaster recovery procedures.
			</p><h4 id="project-19">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-etcd-operator/">cluster-etcd-operator</a>
			</p><h4 id="crds-7">CRDs</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<code class="literal">etcds.operator.openshift.io</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Scope: Cluster
							</li><li class="listitem">
								CR: <code class="literal">etcd</code>
							</li><li class="listitem">
								Validation: Yes
							</li></ul></div></li></ul></div><h4 id="configuration-objects-4">Configuration objects</h4><pre class="programlisting language-terminal">$ oc edit etcd cluster</pre></section><section class="section" id="ingress-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.21. Ingress Operator</h2></div></div></div><h4 id="purpose-21">Purpose</h4><p>
				The Ingress Operator configures and manages the OpenShift Container Platform router.
			</p><h4 id="project-20">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-ingress-operator">openshift-ingress-operator</a>
			</p><h4 id="crds-8">CRDs</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<code class="literal">clusteringresses.ingress.openshift.io</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Scope: Namespaced
							</li><li class="listitem">
								CR: <code class="literal">clusteringresses</code>
							</li><li class="listitem">
								Validation: No
							</li></ul></div></li></ul></div><h4 id="configuration-objects-5">Configuration objects</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Cluster config
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Type Name: <code class="literal">clusteringresses.ingress.openshift.io</code>
							</li><li class="listitem">
								Instance Name: <code class="literal">default</code>
							</li><li class="listitem"><p class="simpara">
								View Command:
							</p><pre class="programlisting language-terminal">$ oc get clusteringresses.ingress.openshift.io -n openshift-ingress-operator default -o yaml</pre></li></ul></div></li></ul></div><h4 id="notes-2">Notes</h4><p>
				The Ingress Operator sets up the router in the <code class="literal">openshift-ingress</code> project and creates the deployment for the router:
			</p><pre class="programlisting language-terminal">$ oc get deployment -n openshift-ingress</pre><p>
				The Ingress Operator uses the <code class="literal">clusterNetwork[].cidr</code> from the <code class="literal">network/cluster</code> status to determine what mode (IPv4, IPv6, or dual stack) the managed Ingress Controller (router) should operate in. For example, if <code class="literal">clusterNetwork</code> contains only a v6 <code class="literal">cidr</code>, then the Ingress Controller operates in IPv6-only mode.
			</p><p>
				In the following example, Ingress Controllers managed by the Ingress Operator will run in IPv4-only mode because only one cluster network exists and the network is an IPv4 <code class="literal">cidr</code>:
			</p><pre class="programlisting language-terminal">$ oc get network/cluster -o jsonpath='{.status.clusterNetwork[*]}'</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
					
<pre class="programlisting language-terminal">map[cidr:10.128.0.0/14 hostPrefix:23]</pre>

				</p></div></section><section class="section" id="insights-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.22. Insights Operator</h2></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The Insights Operator is an optional cluster capability that can be disabled by cluster administrators during installation. For more information about optional cluster capabilities, see "Cluster capabilities" in <span class="emphasis"><em>Installing</em></span>.
				</p></div></div><h4 id="purpose-22">Purpose</h4><p>
				The Insights Operator gathers OpenShift Container Platform configuration data and sends it to Red Hat. The data is used to produce proactive insights recommendations about potential issues that a cluster might be exposed to. These insights are communicated to cluster administrators through Insights Advisor on <a class="link" href="https://console.redhat.com/">console.redhat.com</a>.
			</p><h4 id="project-21">Project</h4><p>
				<a class="link" href="https://github.com/openshift/insights-operator">insights-operator</a>
			</p><h4 id="configuration-2">Configuration</h4><p>
				No configuration is required.
			</p><h4 id="notes-3">Notes</h4><p>
				Insights Operator complements OpenShift Container Platform Telemetry.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#insights-operator_cluster-capabilities">Insights capability</a>
					</li><li class="listitem">
						See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/support/#about-remote-health-monitoring">About remote health monitoring</a> for details about Insights Operator and Telemetry.
					</li></ul></div></section><section class="section" id="kube-apiserver-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.23. Kubernetes API Server Operator</h2></div></div></div><h4 id="purpose-23">Purpose</h4><p>
				The Kubernetes API Server Operator manages and updates the Kubernetes API server deployed on top of OpenShift Container Platform. The Operator is based on the OpenShift Container Platform <code class="literal">library-go</code> framework and it is installed using the Cluster Version Operator (CVO).
			</p><h4 id="project-22">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-kube-apiserver-operator">openshift-kube-apiserver-operator</a>
			</p><h4 id="crds-9">CRDs</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<code class="literal">kubeapiservers.operator.openshift.io</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Scope: Cluster
							</li><li class="listitem">
								CR: <code class="literal">kubeapiserver</code>
							</li><li class="listitem">
								Validation: Yes
							</li></ul></div></li></ul></div><h4 id="configuration-objects-6">Configuration objects</h4><pre class="programlisting language-terminal">$ oc edit kubeapiserver</pre></section><section class="section" id="kube-controller-manager-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.24. Kubernetes Controller Manager Operator</h2></div></div></div><h4 id="purpose-24">Purpose</h4><p>
				The Kubernetes Controller Manager Operator manages and updates the Kubernetes Controller Manager deployed on top of OpenShift Container Platform. The Operator is based on OpenShift Container Platform <code class="literal">library-go</code> framework and it is installed via the Cluster Version Operator (CVO).
			</p><p>
				It contains the following components:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Operator
					</li><li class="listitem">
						Bootstrap manifest renderer
					</li><li class="listitem">
						Installer based on static pods
					</li><li class="listitem">
						Configuration observer
					</li></ul></div><p>
				By default, the Operator exposes Prometheus metrics through the <code class="literal">metrics</code> service.
			</p><h4 id="project-23">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-kube-controller-manager-operator">cluster-kube-controller-manager-operator</a>
			</p></section><section class="section" id="cluster-kube-scheduler-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.25. Kubernetes Scheduler Operator</h2></div></div></div><h4 id="purpose-25">Purpose</h4><p>
				The Kubernetes Scheduler Operator manages and updates the Kubernetes Scheduler deployed on top of OpenShift Container Platform. The Operator is based on the OpenShift Container Platform <code class="literal">library-go</code> framework and it is installed with the Cluster Version Operator (CVO).
			</p><p>
				The Kubernetes Scheduler Operator contains the following components:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Operator
					</li><li class="listitem">
						Bootstrap manifest renderer
					</li><li class="listitem">
						Installer based on static pods
					</li><li class="listitem">
						Configuration observer
					</li></ul></div><p>
				By default, the Operator exposes Prometheus metrics through the metrics service.
			</p><h4 id="project-24">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-kube-scheduler-operator">cluster-kube-scheduler-operator</a>
			</p><h4 id="configuration-3">Configuration</h4><p>
				The configuration for the Kubernetes Scheduler is the result of merging:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						a default configuration.
					</li><li class="listitem">
						an observed configuration from the spec <code class="literal">schedulers.config.openshift.io</code>.
					</li></ul></div><p>
				All of these are sparse configurations, invalidated JSON snippets which are merged to form a valid configuration at the end.
			</p></section><section class="section" id="cluster-kube-storage-version-migrator-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.26. Kubernetes Storage Version Migrator Operator</h2></div></div></div><h4 id="purpose-26">Purpose</h4><p>
				The Kubernetes Storage Version Migrator Operator detects changes of the default storage version, creates migration requests for resource types when the storage version changes, and processes migration requests.
			</p><h4 id="project-25">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-kube-storage-version-migrator-operator">cluster-kube-storage-version-migrator-operator</a>
			</p></section><section class="section" id="machine-api-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.27. Machine API Operator</h2></div></div></div><h4 id="purpose-27">Purpose</h4><p>
				The Machine API Operator manages the lifecycle of specific purpose custom resource definitions (CRD), controllers, and RBAC objects that extend the Kubernetes API. This declares the desired state of machines in a cluster.
			</p><h4 id="project-26">Project</h4><p>
				<a class="link" href="https://github.com/openshift/machine-api-operator">machine-api-operator</a>
			</p><h4 id="crds-10">CRDs</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">MachineSet</code>
					</li><li class="listitem">
						<code class="literal">Machine</code>
					</li><li class="listitem">
						<code class="literal">MachineHealthCheck</code>
					</li></ul></div></section><section class="section" id="machine-config-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.28. Machine Config Operator</h2></div></div></div><h4 id="purpose-28">Purpose</h4><p>
				The Machine Config Operator manages and applies configuration and updates of the base operating system and container runtime, including everything between the kernel and kubelet.
			</p><p>
				There are four components:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">machine-config-server</code>: Provides Ignition configuration to new machines joining the cluster.
					</li><li class="listitem">
						<code class="literal">machine-config-controller</code>: Coordinates the upgrade of machines to the desired configurations defined by a <code class="literal">MachineConfig</code> object. Options are provided to control the upgrade for sets of machines individually.
					</li><li class="listitem">
						<code class="literal">machine-config-daemon</code>: Applies new machine configuration during update. Validates and verifies the state of the machine to the requested machine configuration.
					</li><li class="listitem">
						<code class="literal">machine-config</code>: Provides a complete source of machine configuration at installation, first start up, and updates for a machine.
					</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Currently, there is no supported way to block or restrict the machine config server endpoint. The machine config server must be exposed to the network so that newly-provisioned machines, which have no existing configuration or state, are able to fetch their configuration. In this model, the root of trust is the certificate signing requests (CSR) endpoint, which is where the kubelet sends its certificate signing request for approval to join the cluster. Because of this, machine configs should not be used to distribute sensitive information, such as secrets and certificates.
				</p><p>
					To ensure that the machine config server endpoints, ports 22623 and 22624, are secured in bare metal scenarios, customers must configure proper network policies.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/networking/#about-openshift-sdn">About the OpenShift SDN network plugin</a>.
					</li></ul></div><h4 id="project-27">Project</h4><p>
				<a class="link" href="https://github.com/openshift/machine-config-operator">openshift-machine-config-operator</a>
			</p></section><section class="section" id="marketplace-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.29. Marketplace Operator</h2></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The Marketplace Operator is an optional cluster capability that can be disabled by cluster administrators if it is not needed. For more information about optional cluster capabilities, see "Cluster capabilities" in <span class="emphasis"><em>Installing</em></span>.
				</p></div></div><h4 id="purpose-29">Purpose</h4><p>
				The Marketplace Operator simplifies the process for bringing off-cluster Operators to your cluster by using a set of default Operator Lifecycle Manager (OLM) catalogs on the cluster. When the Marketplace Operator is installed, it creates the <code class="literal">openshift-marketplace</code> namespace. OLM ensures catalog sources installed in the <code class="literal">openshift-marketplace</code> namespace are available for all namespaces on the cluster.
			</p><h4 id="project-28">Project</h4><p>
				<a class="link" href="https://github.com/operator-framework/operator-marketplace">operator-marketplace</a>
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#marketplace-operator_cluster-capabilities">Marketplace capability</a>
					</li></ul></div></section><section class="section" id="about-node-tuning-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.30. Node Tuning Operator</h2></div></div></div><h4 id="purpose-30">Purpose</h4><p>
				The Node Tuning Operator helps you manage node-level tuning by orchestrating the TuneD daemon and achieves low latency performance by using the Performance Profile controller. The majority of high-performance applications require some level of kernel tuning. The Node Tuning Operator provides a unified management interface to users of node-level sysctls and more flexibility to add custom tuning specified by user needs.
			</p><p>
				The Operator manages the containerized TuneD daemon for OpenShift Container Platform as a Kubernetes daemon set. It ensures the custom tuning specification is passed to all containerized TuneD daemons running in the cluster in the format that the daemons understand. The daemons run on all nodes in the cluster, one per node.
			</p><p>
				Node-level settings applied by the containerized TuneD daemon are rolled back on an event that triggers a profile change or when the containerized TuneD daemon is terminated gracefully by receiving and handling a termination signal.
			</p><p>
				The Node Tuning Operator uses the Performance Profile controller to implement automatic tuning to achieve low latency performance for OpenShift Container Platform applications.
			</p><p>
				The cluster administrator configures a performance profile to define node-level settings such as the following:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Updating the kernel to kernel-rt.
					</li><li class="listitem">
						Choosing CPUs for housekeeping.
					</li><li class="listitem">
						Choosing CPUs for running workloads.
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Currently, disabling CPU load balancing is not supported by cgroup v2. As a result, you might not get the desired behavior from performance profiles if you have cgroup v2 enabled. Enabling cgroup v2 is not recommended if you are using performance profiles.
				</p></div></div><p>
				The Node Tuning Operator is part of a standard OpenShift Container Platform installation in version 4.1 and later.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					In earlier versions of OpenShift Container Platform, the Performance Addon Operator was used to implement automatic tuning to achieve low latency performance for OpenShift applications. In OpenShift Container Platform 4.11 and later, this functionality is part of the Node Tuning Operator.
				</p></div></div><h4 id="project-29">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-node-tuning-operator">cluster-node-tuning-operator</a>
			</p><h4 id="cluster-operators-ref-nto-addtl-resources">Additional resources</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/scalability_and_performance/#cnf-understanding-low-latency_cnf-master">Low latency tuning of OCP nodes</a>
					</li></ul></div></section><section class="section" id="openshift-apiserver-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.31. OpenShift API Server Operator</h2></div></div></div><h4 id="purpose-31">Purpose</h4><p>
				The OpenShift API Server Operator installs and maintains the <code class="literal">openshift-apiserver</code> on a cluster.
			</p><h4 id="project-30">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-openshift-apiserver-operator">openshift-apiserver-operator</a>
			</p><h4 id="crds-11">CRDs</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<code class="literal">openshiftapiservers.operator.openshift.io</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Scope: Cluster
							</li><li class="listitem">
								CR: <code class="literal">openshiftapiserver</code>
							</li><li class="listitem">
								Validation: Yes
							</li></ul></div></li></ul></div></section><section class="section" id="cluster-openshift-controller-manager-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.32. OpenShift Controller Manager Operator</h2></div></div></div><h4 id="purpose-32">Purpose</h4><p>
				The OpenShift Controller Manager Operator installs and maintains the <code class="literal">OpenShiftControllerManager</code> custom resource in a cluster and can be viewed with:
			</p><pre class="programlisting language-terminal">$ oc get clusteroperator openshift-controller-manager -o yaml</pre><p>
				The custom resource definition (CRD) <code class="literal">openshiftcontrollermanagers.operator.openshift.io</code> can be viewed in a cluster with:
			</p><pre class="programlisting language-terminal">$ oc get crd openshiftcontrollermanagers.operator.openshift.io -o yaml</pre><h4 id="project-31">Project</h4><p>
				<a class="link" href="https://github.com/openshift/cluster-openshift-controller-manager-operator">cluster-openshift-controller-manager-operator</a>
			</p></section><section class="section" id="cluster-operators-ref-olm"><div class="titlepage"><div><div><h2 class="title">6.33. Operator Lifecycle Manager Operators</h2></div></div></div><h4 id="olm-overview_cluster-operators-ref">Purpose</h4><p>
				<span class="emphasis"><em>Operator Lifecycle Manager</em></span> (OLM) helps users install, update, and manage the lifecycle of Kubernetes native applications (Operators) and their associated services running across their OpenShift Container Platform clusters. It is part of the <a class="link" href="https://operatorframework.io/">Operator Framework</a>, an open source toolkit designed to manage Operators in an effective, automated, and scalable way.
			</p><div class="figure" id="idm139731986928448"><p class="title"><strong>Figure 6.1. Operator Lifecycle Manager workflow</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/OpenShift_Container_Platform-4.13-Operators-en-US/images/c8a00bac5df42a702ff1b826333610d0/olm-workflow.png" alt="olm workflow"/></div></div></div><p>
				OLM runs by default in OpenShift Container Platform 4.13, which aids cluster administrators in installing, upgrading, and granting access to Operators running on their cluster. The OpenShift Container Platform web console provides management screens for cluster administrators to install Operators, as well as grant specific projects access to use the catalog of Operators available on the cluster.
			</p><p>
				For developers, a self-service experience allows provisioning and configuring instances of databases, monitoring, and big data services without having to be subject matter experts, because the Operator has that knowledge baked into it.
			</p><h4 id="olm-architecture_cluster-operators-ref">CRDs</h4><p>
				Operator Lifecycle Manager (OLM) is composed of two Operators: the OLM Operator and the Catalog Operator.
			</p><p>
				Each of these Operators is responsible for managing the custom resource definitions (CRDs) that are the basis for the OLM framework:
			</p><div class="table" id="idm139731986920496"><p class="title"><strong>Table 6.1. CRDs managed by OLM and Catalog Operators</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 17%; " class="col_1"><!--Empty--></col><col style="width: 8%; " class="col_2"><!--Empty--></col><col style="width: 8%; " class="col_3"><!--Empty--></col><col style="width: 67%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731986913776" scope="col">Resource</th><th align="left" valign="top" id="idm139731986912688" scope="col">Short name</th><th align="left" valign="top" id="idm139731986911600" scope="col">Owner</th><th align="left" valign="top" id="idm139731986910512" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731986913776"> <p>
								<code class="literal">ClusterServiceVersion</code> (CSV)
							</p>
							 </td><td align="left" valign="top" headers="idm139731986912688"> <p>
								<code class="literal">csv</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139731986911600"> <p>
								OLM
							</p>
							 </td><td align="left" valign="top" headers="idm139731986910512"> <p>
								Application metadata: name, version, icon, required resources, installation, and so on.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139731986913776"> <p>
								<code class="literal">InstallPlan</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139731986912688"> <p>
								<code class="literal">ip</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139731986911600"> <p>
								Catalog
							</p>
							 </td><td align="left" valign="top" headers="idm139731986910512"> <p>
								Calculated list of resources to be created to automatically install or upgrade a CSV.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139731986913776"> <p>
								<code class="literal">CatalogSource</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139731986912688"> <p>
								<code class="literal">catsrc</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139731986911600"> <p>
								Catalog
							</p>
							 </td><td align="left" valign="top" headers="idm139731986910512"> <p>
								A repository of CSVs, CRDs, and packages that define an application.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139731986913776"> <p>
								<code class="literal">Subscription</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139731986912688"> <p>
								<code class="literal">sub</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139731986911600"> <p>
								Catalog
							</p>
							 </td><td align="left" valign="top" headers="idm139731986910512"> <p>
								Used to keep CSVs up to date by tracking a channel in a package.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139731986913776"> <p>
								<code class="literal">OperatorGroup</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139731986912688"> <p>
								<code class="literal">og</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139731986911600"> <p>
								OLM
							</p>
							 </td><td align="left" valign="top" headers="idm139731986910512"> <p>
								Configures all Operators deployed in the same namespace as the <code class="literal">OperatorGroup</code> object to watch for their custom resource (CR) in a list of namespaces or cluster-wide.
							</p>
							 </td></tr></tbody></table></div></div><p>
				Each of these Operators is also responsible for creating the following resources:
			</p><div class="table" id="idm139731986868256"><p class="title"><strong>Table 6.2. Resources created by OLM and Catalog Operators</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139731986863392" scope="col">Resource</th><th align="left" valign="top" id="idm139731986862304" scope="col">Owner</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139731986863392"> <p>
								<code class="literal">Deployments</code>
							</p>
							 </td><td rowspan="4" align="left" valign="middle" headers="idm139731986862304"> <p>
								OLM
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139731986863392"> <p>
								<code class="literal">ServiceAccounts</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139731986863392"> <p>
								<code class="literal">(Cluster)Roles</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139731986863392"> <p>
								<code class="literal">(Cluster)RoleBindings</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139731986863392"> <p>
								<code class="literal">CustomResourceDefinitions</code> (CRDs)
							</p>
							 </td><td rowspan="2" align="left" valign="middle" headers="idm139731986862304"> <p>
								Catalog
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139731986863392"> <p>
								<code class="literal">ClusterServiceVersions</code>
							</p>
							 </td></tr></tbody></table></div></div><h4 id="olm-arch-olm-operator_cluster-operators-ref">OLM Operator</h4><p>
				The OLM Operator is responsible for deploying applications defined by CSV resources after the required resources specified in the CSV are present in the cluster.
			</p><p>
				The OLM Operator is not concerned with the creation of the required resources; you can choose to manually create these resources using the CLI or using the Catalog Operator. This separation of concern allows users incremental buy-in in terms of how much of the OLM framework they choose to leverage for their application.
			</p><p>
				The OLM Operator uses the following workflow:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Watch for cluster service versions (CSVs) in a namespace and check that requirements are met.
					</li><li class="listitem"><p class="simpara">
						If requirements are met, run the install strategy for the CSV.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							A CSV must be an active member of an Operator group for the install strategy to run.
						</p></div></div></li></ol></div><h4 id="olm-arch-catalog-operator_cluster-operators-ref">Catalog Operator</h4><p>
				The Catalog Operator is responsible for resolving and installing cluster service versions (CSVs) and the required resources they specify. It is also responsible for watching catalog sources for updates to packages in channels and upgrading them, automatically if desired, to the latest available versions.
			</p><p>
				To track a package in a channel, you can create a <code class="literal">Subscription</code> object configuring the desired package, channel, and the <code class="literal">CatalogSource</code> object you want to use for pulling updates. When updates are found, an appropriate <code class="literal">InstallPlan</code> object is written into the namespace on behalf of the user.
			</p><p>
				The Catalog Operator uses the following workflow:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Connect to each catalog source in the cluster.
					</li><li class="listitem"><p class="simpara">
						Watch for unresolved install plans created by a user, and if found:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Find the CSV matching the name requested and add the CSV as a resolved resource.
							</li><li class="listitem">
								For each managed or required CRD, add the CRD as a resolved resource.
							</li><li class="listitem">
								For each required CRD, find the CSV that manages it.
							</li></ol></div></li><li class="listitem">
						Watch for resolved install plans and create all of the discovered resources for it, if approved by a user or automatically.
					</li><li class="listitem">
						Watch for catalog sources and subscriptions and create install plans based on them.
					</li></ol></div><h4 id="olm-arch-catalog-registry_cluster-operators-ref">Catalog Registry</h4><p>
				The Catalog Registry stores CSVs and CRDs for creation in a cluster and stores metadata about packages and channels.
			</p><p>
				A <span class="emphasis"><em>package manifest</em></span> is an entry in the Catalog Registry that associates a package identity with sets of CSVs. Within a package, channels point to a particular CSV. Because CSVs explicitly reference the CSV that they replace, a package manifest provides the Catalog Operator with all of the information that is required to update a CSV to the latest version in a channel, stepping through each intermediate version.
			</p><h4 id="cluster-operators-ref-olm-addtl-resources">Additional resources</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						For more information, see the sections on <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/operators/#olm-understanding-olm">understanding Operator Lifecycle Manager (OLM)</a>.
					</li></ul></div></section><section class="section" id="openshift-service-ca-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.34. OpenShift Service CA Operator</h2></div></div></div><h4 id="purpose-33">Purpose</h4><p>
				The OpenShift Service CA Operator mints and manages serving certificates for Kubernetes services.
			</p><h4 id="project-32">Project</h4><p>
				<a class="link" href="https://github.com/openshift/service-ca-operator">openshift-service-ca-operator</a>
			</p></section><section class="section" id="vsphere-problem-detector-operator_cluster-operators-ref"><div class="titlepage"><div><div><h2 class="title">6.35. vSphere Problem Detector Operator</h2></div></div></div><h4 id="purpose-34">Purpose</h4><p>
				The vSphere Problem Detector Operator checks clusters that are deployed on vSphere for common installation and misconfiguration issues that are related to storage.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The vSphere Problem Detector Operator is only started by the Cluster Storage Operator when the Cluster Storage Operator detects that the cluster is deployed on vSphere.
				</p></div></div><h4 id="configuration-4">Configuration</h4><p>
				No configuration is required.
			</p><h4 id="notes-4">Notes</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The Operator supports OpenShift Container Platform installations on vSphere.
					</li><li class="listitem">
						The Operator uses the <code class="literal">vsphere-cloud-credentials</code> to communicate with vSphere.
					</li><li class="listitem">
						The Operator performs checks that are related to storage.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For more details, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#using-vsphere-problem-detector-operator">Using the vSphere Problem Detector Operator</a>.
					</li></ul></div></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm139731989895296"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2023 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div>


  <nav class="pvof-doc__book-nav">
  <ol class="book-nav__list">
              </ol>
</nav>


          </div>
              </div>
              <div id="comments-footer" class="book-comments">
          

  

        </div>
          </div>
  </article>
<meta itemscope="" itemref="md1">



    </div>
      <!-- CP_PRIMER_FOOTER -->            </div>
        </main>
    </div>
    <!--googleoff: all-->
    <div id="to-top"><a class="btn_slideto" href="#masthead" aria-label="Back to Top"><span class="web-icon-upload"></span></a></div>
    <footer class="footer-main">
        <div class="footer-top">
            <div class="container">

              <div class="brand">
                <a href="https://redhat.com">
                  <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                    <defs>
                      <style>
                        .rh-logo-hat {
                          fill: #e00;
                        }
                        .rh-logo-type {
                          fill: #fff;
                        }
                      </style>
                    </defs>
                    <title>Red Hat</title>
                    <path
                      class="rh-logo-hat"
                      d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
                      <path class="rh-logo-band"
                      d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
                      <path
                      class="rh-logo-type"
                      d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
                  </svg>
                </a>
              </div>

              <div role="navigation" aria-label="quick">
                  <h3>Quick Links</h3>
                  <ul>
                      <li><a class="download-software" href="https://access.redhat.com/downloads/">Downloads</a></li>
                      <li><a class="manage-subscriptions" href="https://access.redhat.com/management">Subscriptions</a></li>
                      <li><a class="support-cases" href="https://access.redhat.com/support">Support Cases</a></li>
                      <li><a class="customer-service" href="https://access.redhat.com/support/customer-service">Customer Service</a></li>
                      <li><a class="quick-docs" href="https://access.redhat.com/documentation">Product Documentation</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="help">
                  <h3>Help</h3>
                  <ul>
                      <li><a class="contact-us" href="https://access.redhat.com/support/contact/">Contact Us</a></li>
                      <li><a class="cp-faqs" href="https://access.redhat.com/articles/33844">Customer Portal FAQ</a></li>
                      <li><a class="login-problems" href="https://access.redhat.com/help/login_assistance">Log-in Assistance</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="site">
                  <h3>Site Info</h3>
                  <ul>
                      <li><a class="trust-red-hat" href="https://www.redhat.com/en/trust">Trust Red Hat</a></li>
                      <li><a class="browser-support-policy" href="https://www.redhat.com/en/about/browser-support">Browser Support Policy</a></li>
                      <li><a class="accessibility" href="https://www.redhat.com/en/about/digital-accessibility">Accessibility</a></li>
                      <li><a class="recognition" href="https://access.redhat.com/recognition/">Awards and Recognition</a></li>
                      <li><a class="colophon" href="https://access.redhat.com/help/colophon/">Colophon</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="other">
                  <h3>Related Sites</h3>
                  <ul>
                      <li><a href="https://www.redhat.com/" class="red-hat-com">redhat.com</a></li>
                      <li><a href="http://developers.redhat.com/" class="red-hat-developers">developers.redhat.com</a></li>
                      <li><a href="https://connect.redhat.com/" class="partner-connect">connect.redhat.com</a></li>
                      <li><a href="https://cloud.redhat.com/" class="cloud-com">cloud.redhat.com</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="about">
                  <h3>About</h3>
                  <ul>
                      <li><a href="https://access.redhat.com/subscription-value" class="subscription-value">Red Hat Subscription Value</a></li>
                      <li><a href="https://www.redhat.com/about/" class="about-red-hat">About Red Hat</a></li>
                      <li><a href="http://jobs.redhat.com" class="about-jobs">Red Hat Jobs</a></li>
                  </ul>
              </div>

            </div>
        </div>

        <div class="anchor">
            <div class="container">
                <div class="status-legal">
                    <a hidden href="https://status.redhat.com" class="status-page-widget">
                        <span class="status-description"></span>
                        <span class="status-dot shape-circle"></span>
                    </a>
                    <div class="legal-copyright">
                        <div class="copyright">Copyright © 2023 Red Hat, Inc.</div>
                        <div role="navigation" aria-label="legal" class="legal">
                            <ul>
                                <li><a href="http://www.redhat.com/en/about/privacy-policy" class="privacy-policy">Privacy Statement</a></li>
                                <li><a href="https://www.redhat.com/en/about/terms-use" class="terms-of-use">Terms of Use</a></li>
                                <li><a href="http://www.redhat.com/en/about/all-policies-guidelines" class="all-policies">All Policies and Guidelines</a></li>
                                <li><a id="teconsent"></a></li>
                            </ul>
                            <div id="privacy_policy">We've updated our <a href='http://www.redhat.com/en/about/privacy-policy' class='privacy-policy'>Privacy Statement</a> effective September 15, 2023.
                            </div>
                          </div>
                        </div>
                </div>
                <div class="social">
                    <a href="http://www.redhat.com/summit/" class="summit">
                        <img src="https://access.redhat.com/chrome_themes/nimbus/img/rh-summit-red-a.svg" alt="Red Hat Summit" /> <span class="offscreen">Red Hat Summit</span>
                    </a>

                    <div class="social-media">
                        <a href="https://twitter.com/RedHat" class="sm-icon twitter"><span class="nicon-twitter"></span><span class="offscreen">Twitter</span></a>                        
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- TrustArc -->
    <div id="consent_blackbar"></div> 
    <!--googleon: all-->
</div>
<!-- /CP_PRIMER_FOOTER -->


  </div>

    
  </body>
</html>
