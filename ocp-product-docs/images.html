<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="og: https://ogp.me/ns#">
  <head>
    <meta charset="utf-8" />
<link rel="canonical" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/index" />
<link rel="shortlink" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/index" />
<meta property="og:site_name" content="Red Hat Customer Portal" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/index" />
<meta property="og:title" content="Images OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<meta property="og:description" content="This document provides instructions for creating and managing images and imagestreams in OpenShift Container Platform. It also provides instructions on using templates." />
<meta property="og:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="This document provides instructions for creating and managing images and imagestreams in OpenShift Container Platform. It also provides instructions on using templates." />
<meta name="twitter:title" content="Images OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<meta name="twitter:url" content="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/index" />
<meta name="twitter:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="title" content="Images OpenShift Container Platform 4.13 | Red Hat Customer Portal" />
<link rel="alternate" hreflang="en" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/index" />
<link rel="alternate" hreflang="ko" href="https://access.redhat.com/documentation/ko-kr/openshift_container_platform/4.13/html-single/images/index" />
<link rel="alternate" hreflang="zh-hans" href="https://access.redhat.com/documentation/zh-cn/openshift_container_platform/4.13/html-single/images/index" />
<link rel="alternate" hreflang="ja" href="https://access.redhat.com/documentation/ja-jp/openshift_container_platform/4.13/html-single/images/index" />
<link rel="alternate" hreflang="es" href="https://access.redhat.com/documentation/es-es/openshift_container_platform/4.13/html-single/images/index" />
<link rel="alternate" hreflang="ru" href="https://access.redhat.com/documentation/ru-ru/openshift_container_platform/4.13/html-single/images/index" />
<link rel="alternate" hreflang="pt-br" href="https://access.redhat.com/documentation/pt-br/openshift_container_platform/4.13/html-single/images/index" />
<link rel="alternate" hreflang="it" href="https://access.redhat.com/documentation/it-it/openshift_container_platform/4.13/html-single/images/index" />
<link rel="alternate" hreflang="de" href="https://access.redhat.com/documentation/de-de/openshift_container_platform/4.13/html-single/images/index" />
<link rel="alternate" hreflang="fr" href="https://access.redhat.com/documentation/fr-fr/openshift_container_platform/4.13/html-single/images/index" />
<link rel="alternate" hreflang="zh-hant" href="https://access.redhat.com/documentation/zh-tw/openshift_container_platform/4.13/html-single/images/index" />
<link rel="alternate" hreflang="id" href="https://access.redhat.com/documentation/id-id/openshift_container_platform/4.13/html-single/images/index" />
<link rel="alternate" hreflang="th" href="https://access.redhat.com/documentation/th-th/openshift_container_platform/4.13/html-single/images/index" />
<link rel="alternate" hreflang="vi" href="https://access.redhat.com/documentation/vi-vn/openshift_container_platform/4.13/html-single/images/index" />
<meta name="Generator" content="Drupal 9 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="revision" product="b0738f19-59ac-47eb-9512-8a439cd6dfb0" title="daddc9fc-cfa7-4162-b8fc-0c7477d9a7f2" page="6f2d992d-70c0-4a7e-82a2-9b0b049c792c" revision="dccd48b1f252cc22dad43e9ae6252b9287d98ca1:en-us" body="5a98367e72e20bfc4f8cee9ef8f9fe17.html" toc="52dc257a45ebc8cd0affc1e8959b5864.json" />

    <title>Images OpenShift Container Platform 4.13 | Red Hat Customer Portal</title>
    <link rel="stylesheet" media="all" href="/sites/dxp-docs/files/css/css_87GMcmxT1ib8ziQiU2KUAnTDFtZQV6iP-KGslA9LigM.css" />
<link rel="stylesheet" media="all" href="/sites/dxp-docs/files/css/css__Xq4GfgPDJw9K_yYJFmlRZGJeCENu3R3r4s0K7Tr_9g.css" />

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"documentation\/en-us\/openshift_container_platform\/4.13\/html-single\/images\/index","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"red_hat_jwt":{"client_id":"customer-portal","cookie_name":"rh_jwt","leeway":"0","realm":"redhat-external","sso_host":"https:\/\/sso.redhat.com\/","user_integration":1,"user_plugin":"drupal_user_auth","use_external_js":0,"use_internal_js":0,"use_in_admin":0},"user":{"uid":0,"permissionsHash":"d8ea0bce2d740dacbdfe0257cf55baa0e33f7fb8468a26d055ce75daaaa2d315"}}</script>
<script src="/sites/dxp-docs/files/js/js_EQWKo9EokWkWS99x_e1oM-NEM0zlKyTkp_83mGdm5Ks.js"></script>

    <!-- CP_PRIMER_HEAD -->  <!-- TrustArc & DTM -->
  <script src="//static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>
  <script src="//www.redhat.com/dtm.js"></script><meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<!--[if IEMobile]><meta http-equiv="cleartype" content="on"><![endif]-->

<!-- metaInclude -->
<meta name="avalon-host-info" content="dxp-kbase-prod-139-77b4fb8768-25dr9" />
<meta name="avalon-version" content="27861f77" />
<meta name="cp-chrome-build-date" content="2023-10-06T19:17:59.039Z" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#000000">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#000000">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-status-bar-style" content="#000000">
<link rel="manifest" href="https://access.redhat.com/webassets/avalon/j/manifest.json">
<!-- Open Search - Tap to search -->
<link rel="search" type="application/opensearchdescription+xml" title="Red Hat Customer Portal" href="https://access.redhat.com/webassets/avalon/j/opensearch.xml" />
<!-- title -->
<title>Red Hat Customer Portal - Access to 24x7 support and knowledge</title>
<!-- /title -->
<script type="text/javascript">
    window.portal = {
        analytics : {},
        host      : "https://access.redhat.com",
        idp_url   : "https://sso.redhat.com",
        lang      : "en", 
        version   : "27861f77",
        builddate : "2023-10-06T19:17:59.039Z",        fetchdate : "2023-10-10T17:45:08-0400",        nrid      : "NOLONGERSUPPORTED",
        nrlk      : "NOLONGERSUPPORTED"
    };
</script>
<script type="text/javascript">
    if (!/\/logout.*/.test(location.pathname) && portal.host === location.origin && document.cookie.indexOf('rh_sso_session') >= 0 && !(document.cookie.indexOf('rh_jwt') >= 0)) window.location = '/login?redirectTo=' + encodeURIComponent(window.location.href);
</script>
<!-- cssInclude -->

<link rel="shortcut icon" href="https://access.redhat.com/webassets/avalon/g/favicon.ico" /><link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/bootstrap.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/bootstrap-grid.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/main.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/components.css?v=27861f77" />
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/pages.css?v=27861f77" />

<link href="https://access.redhat.com/webassets/avalon/s/chosen.css?v=27861f77" rel="stylesheet" type="text/css" />

<!--[if lte IE 9]>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/ie.css" />
<![endif]--><noscript>
    <style type="text/css" media="screen"> .primary-nav { display: block; } </style>
</noscript>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/webassets/avalon/j/public_modules/node_modules/@cpelements/pfe-navigation/dist/pfe-navigation--lightdom.min.css" />
<!-- /cssInclude -->
<script src="https://access.redhat.com/webassets/avalon/j/public_modules/node_modules/@cpelements/pfe-navigation/dist/ie-polyfills.js?v=27861f77"></script>

<script async>
  if (!HTMLScriptElement.supports || !HTMLScriptElement.supports('importmap')) {
    import("https://www.redhatstatic.com/dx/v1-alpha/es-module-shims@1.7.3.js");
  }
</script>
<script type="importmap">
{
  "imports": {
    "@patternfly/elements/" : "https://www.redhatstatic.com/dx/v1-alpha/@patternfly/elements@2.2.2/",
    "@rhds/elements/":"https://www.redhatstatic.com/dx/v1-alpha/@rhds/elements@1.1.0/elements/",
    "@rhds/elements/lib/":"https://www.redhatstatic.com/dx/v1-alpha/@rhds/elements@1.1.0/lib/",
    "@cpelements/elements/":"https://www.redhatstatic.com/dx/v1-alpha/@cpelements/elements@2.0.0-alpha.7/elements/"
  }
}
</script><script type="text/javascript" src="https://access.redhat.com/webassets/avalon/j/lib/require.js?v=27861f77" data-main="/webassets/avalon/j/"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<script src="https://access.redhat.com/chrome_themes/nimbus/js/ie8.js"></script>
<![endif]-->
<script type="text/javascript" src="https://access.redhat.com/chrome_themes/nimbus/js/new-nav.js?v=27861f77" ></script>
<!-- /CP_PRIMER_HEAD -->

  </head>
  <body>
    
      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
      <!-- CP_PRIMER_HEADER -->
<div id="page-wrap" class="page-wrap">
    <div id="pers-top-page-wrap" class="top-page-wrap pers-loader-bg">

      <div id="hero-bg-top-left" class="summit-bg-shapes"></div>
      <div id="hero-bg-top-right" class="summit-bg-shapes"></div>

        <!--googleoff: all-->
        <header class="masthead" id="masthead">

            <a href="#pfe-navigation" id="global-skip-to-nav" class="skip-link visually-hidden">Skip to navigation</a>
            <a href="#cp-main" class="skip-link visually-hidden">Skip to main content</a>            <nav id="portal-utility-nav" class="utility-navigation utility-navigation--bar hidden-at-mobile" data-analytics-region="utility" aria-labelledby="nav__utility-nav--desktop">
                <h3 id="nav__utility-nav--desktop" class="element-invisible">Utilities
                </h3>
                <ul aria-labelledby="nav__utility-nav--desktop">
                    <li id="nav-subscription" data-portal-tour-1="1">
                        <a class="top-nav-subscriptions" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Subscription" href="https://access.redhat.com/management/" >Subscriptions
                        </a>
                    </li>
                    <li id="nav-downloads" data-portal-tour-1="2">
                        <a class="top-nav-downloads" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Downloads" href="https://access.redhat.com/downloads/" >Downloads
                        </a>
                    </li>
                    <li id="nav-containers">
                        <a class="top-nav-containers" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Containers" href="https://catalog.redhat.com/software/containers/explore/" >Containers
                        </a>
                    </li>
                    <li id="nav-support" data-portal-tour-1="3">
                        <a class="top-nav-support-cases" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Support Cases" href="https://access.redhat.com/support/cases/" >Support Cases
                        </a>
                    </li>
                </ul>
            </nav>

            <pfe-navigation id="pfe-navigation" data-analytics-region="mega menu">
                <div class="pfe-navigation__logo-wrapper" id="pfe-navigation__logo-wrapper">
                    <a href="https://access.redhat.com/" class="pfe-navigation__logo-link" data-analytics-text="logo" data-analytics-category="MM|logo">
                        <img class="pfe-navigation__logo-image" alt="Red Hat Customer Portal" src="https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg" />
                    </a>
                </div>

                <nav class="pfe-navigation" aria-label="Main Navigation" data-analytics-region="main nav">
                    <ul class="pfe-navigation__menu" id="pfe-navigation__menu">                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-subscription--mobile" data-portal-tour-1="1">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Subscription" href="https://access.redhat.com/management/" >Subscriptions
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-downloads--mobile" data-portal-tour-1="2">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Downloads" href="https://access.redhat.com/downloads/" >Downloads
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-containers--mobile">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Containers" href="https://catalog.redhat.com/software/containers/explore/" >Containers
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-support--mobile" data-portal-tour-1="3">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Support Cases" href="https://access.redhat.com/support/cases/" >Support Cases
                            </a>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a href="https://access.redhat.com/products/" class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Products and Services">Products &amp; Services
                            </a>
                            <div class="pfe-navigation__dropdown has-primary-detail">                                <div class="desktop-col-span-2 tablet-col-span-all">
                                    <h3>
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Products" href="https://access.redhat.com/products/">Products
                                        </a>
                                    </h3>
                                    <slot name="main-menu__dropdown--product__product-listing"></slot>
                                </div>                                <div>
                                    <h3 id="nav__products__support">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Support" href="https://access.redhat.com/support">Support
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__support">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Production Support" href="https://access.redhat.com/support/offerings/production/">Production Support
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Development Support" href="https://access.redhat.com/support/offerings/developer/">Development Support
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Product Life Cycles" href="https://access.redhat.com/product-life-cycles/">Product Life Cycles
                                                    </a></li>
                                    </ul>

                                    <h3 id="nav__products__services">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Services" href="https://www.redhat.com/en/services">Services
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__services">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Consulting" href="https://www.redhat.com/en/services/consulting">Consulting
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Technical Account Management" href="https://access.redhat.com/support/offerings/tam/">Technical Account Management
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Training and Certifications" href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications
                                                    </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__products__documentation">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Documentation" href="https://access.redhat.com/documentation">Documentation
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__documentation">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat Enterprise Linux" href="https://access.redhat.com/documentation/en/red_hat_enterprise_linux">Red Hat Enterprise Linux
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat JBoss Enterprise Application Platform" href="https://access.redhat.com/documentation/en/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat OpenStack Platform" href="https://access.redhat.com/documentation/en/red_hat_openstack_platform">Red Hat OpenStack Platform
                                                    </a></li>
                                                    <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat OpenShift Container Platform" href="https://access.redhat.com/documentation/en/openshift_container_platform">Red Hat OpenShift Container Platform
                                                        </a></li>
                                    </ul>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="All Documentation" data-analytics-linkType="cta" href="https://access.redhat.com/documentation">All Documentation
                                        </a>
                                    </pfe-cta>

                                    <h3 id="nav__products__catalog"><a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Ecosystem Catalog" href="https://catalog.redhat.com/">Ecosystem Catalog
                                        </a></h3>
                                        <ul aria-labelledby="nav__products__catalog">
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Ecosystem Catalog" data-analytics-text="Red Hat Partner Ecosystem" href="https://access.redhat.com/ecosystem/">Red Hat Partner Ecosystem
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Ecosystem Catalog" data-analytics-text="Partner Resources" href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources
                                                    </a></li>
                                        </ul>
                                </div>
                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Tools" href="https://access.redhat.com/labs/">Tools
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="nav__tools__tools" data-analytics-level="2" data-analytics-text="Tools" data-analytics-category="Tools">Tools
                                    </h3>
                                    <ul aria-labelledby="nav__tools__tools">
                                        <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Solution Engine" href="https://access.redhat.com/support/cases/#/troubleshoot">Troubleshoot a product issue
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Packages" href="https://access.redhat.com/downloads/content/package-browser">Packages
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Errata" href="https://access.redhat.com/errata/">Errata
                                                    </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__tools__labs">
                                        <a data-analytics-level="2" data-analytics-category="Tools" data-analytics-text="Customer Portal Labs" href="https://access.redhat.com/labs/">Customer Portal Labs
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__tools__labs">
                                        <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Configuration" href="https://access.redhat.com/labs/#!?type=config">Configuration
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Deployment" href="https://access.redhat.com/labs/#!?type=deploy">Deployment
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Security" href="https://access.redhat.com/labs/#!?type=security">Security
                                                    </a></li>                                                    <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Troubleshooting" href="https://access.redhat.com/labs/#!?type=troubleshoot">Troubleshoot
                                                        </a></li>
                                    </ul>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="All Labs" data-analytics-linkType="cta" href="https://access.redhat.com/labs/">All labs
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h4 id="nav__tools__red-hat-insights">
                                        <a data-analytics-level="2" data-analytics-category="Tools" data-analytics-text="Red Hat Insights" href="//www.redhat.com/en/technologies/management/insights">Red Hat Insights
                                        </a>
                                    </h4>
                                    <p>Increase visibility into IT operations to detect and resolve technical issues before they impact your business.</p>
                                    <a data-analytics-level="3" data-analytics-category="Tools|Red Hat Insights" data-analytics-text="Learn more" href="https://www.redhat.com/en/technologies/management/insights">Learn More
                                    </a>
                                    <br>
                                    <a data-analytics-level="3" data-analytics-category="Tools|Red Hat Insights" data-analytics-text="Go to Insights" href="https://cloud.redhat.com/insights">Go to Insights
                                    </a>
                                </div>
                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Security" href="https://access.redhat.com/security/">Security
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="security__security-center">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Red Hat Product Security Center" href="https://access.redhat.com/security">Red Hat Product Security Center
                                        </a>
                                    </h3>
                                    <p>Engage with our Red Hat Product Security team, access security updates, and ensure your environments are not exposed to any known security vulnerabilities.
                                    </p>
                                    <pfe-cta pfe-priority="primary">
                                        <a data-analytics-level="3" data-analytics-category="Security|Red Hat Product Security Center" data-analytics-text="Product Security Center" data-analytics-linkType="cta" href="https://access.redhat.com/security/">Product Security Center
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__security__updates" data-analytics-level="2" data-analytics-text="Security Updates" data-analytics-category="Security">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Security Updates" href="/security">Security Updates
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__security__updates">
                                        <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Security Advisories" href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Red Hat CVE Database" href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Security Labs" href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs
                                                    </a></li>
                                    </ul>
                                    <p class="margin-top-xl">Keep your systems secure with Red Hat&#039;s specialized responses to security vulnerabilities.
                                    </p>
                                    <pfe-cta>
                                        <a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="View Responses" data-analytics-linkType="cta" href="https://access.redhat.com/security/vulnerability">View Responses
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__security__resources">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Resources" href="https://access.redhat.com/security/overview">Resources
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__security__resources">                                            <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Security Blog" href="//redhat.com/en/blog/channel/security">Security Blog
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Security Measurement" href="https://www.redhat.com/security/data/metrics/">Security Measurement
                                                    </a></li>
                                                    <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Severity Ratings" href="https://access.redhat.com/security/updates/classification/">Severity Ratings
                                                        </a></li>
                                                        <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Backporting Policies" href="https://access.redhat.com/security/updates/backporting/">Backporting Policies
                                                            </a></li>
                                                            <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Product Signing (GPG) Keys" href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys
                                                                </a></li>
                                    </ul>
                                </div>

                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a href="https://access.redhat.com/community/" class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Community">Community
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="nav__community__cp-community">
                                        <a href="https://access.redhat.com/community" data-analytics-level="2" data-analytics-text="Customer Portal Community" data-analytics-text="Customer Portal Community" data-analytics-category="Community">Customer Portal Community
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__community__cp-community">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Discussions" href="https://access.redhat.com/discussions">Discussions
                                            </a></li>                                                <li><a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Private Groups" href="https://access.redhat.com/groups/">Private Groups
                                                    </a></li>
                                    </ul>

                                    <pfe-cta pfe-priority="primary">
                                        <a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Community Activity" data-analytics-linkType="cta" href="https://access.redhat.com/community/">Community Activity
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__community__events" data-analytics-level="2" data-analytics-text="Customer Events" data-analytics-category="Community">Customer Events
                                    </h3>
                                    <ul aria-labelledby="nav__community__events">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Customer Events" data-analytics-text="Red Hat Convergence" href="https://access.redhat.com/convergence/">Red Hat Convergence
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Community|Customer Events" data-analytics-text="Red Hat Summit" href="http://www.redhat.com/summit/">Red Hat Summit
                                                </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__community__stories" data-analytics-level="2" data-analytics-text="Stories" data-analytics-category="Community">Stories
                                    </h3>
                                    <ul aria-labelledby="nav__community__stories">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Stories" data-analytics-text="Red Hat Subscription Value" href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-text="You Asked. We Acted." data-analytics-category="Community|Stories" href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Community|Stories" data-analytics-text="Open Source Communities" href="http://www.redhat.com/en/open-source">Open Source Communities
                                                    </a></li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                    </ul>                </nav>                <div id="site-search" slot="search" class="utility-link site-search">
                    <div class="content">
                        <form class="ng-pristine ng-valid topSearchForm" id="topSearchForm" name="topSearchForm" action="/search/browse/search/" method="get" enctype="application/x-www-form-urlencoded">
                            <cp-search-autocomplete class="push-bottom" path="/webassets/avalon/j/data.json"></cp-search-autocomplete>                            <div>Or <a href="/support/cases/#/troubleshoot">troubleshoot an issue</a>.
                            </div>
                        </form>
                    </div>
                </div>


                <div slot="secondary-links" id="localesMenu">
                    <button class="pfe-navigation__secondary-link">
                        <pfe-icon icon="web-icon-globe" size="sm" aria-hidden="true"></pfe-icon>English
                    </button>

                    <pfe-navigation-dropdown dropdown-width="single">
                        <h2 class="utility-header">Select Your Language
                        </h2>
                        <ul class="reset">
                            <li><a href="https://access.redhat.com/changeLanguage?language=en" data-lang="en" id="en" data-analytics-text="English">English</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=ko" data-lang="ko" id="ko" data-analytics-text="Korean">한국어</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=ja"    data-lang="ja"    id="ja" data-analytics-text="Japanese">日本語</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" data-lang="zh_CN" id="zh_CN" data-analytics-text="Chinese">中文 (中国)</a></li>
                        </ul>

                    </pfe-navigation-dropdown>
                </div>                <rh-account-dropdown slot="account"></rh-account-dropdown>                <pfe-primary-detail breakpoint-width="600" class="main-menu__dropdown--product__product-listing" slot="main-menu__dropdown--product__product-listing" consistent-height>
                    <h3 slot="details-nav">Infrastructure and Management                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Enterprise Linux" href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Satellite" href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Subscription Management" href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Insights" href="https://access.redhat.com/products/red-hat-insights/">Red Hat Insights
                                </a>
                            </li>
                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Ansible Automation Platform" href="https://access.redhat.com/products/red-hat-ansible-automation-platform/">Red Hat Ansible Automation Platform
                                </a></li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Cloud Computing                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift" href="https://access.redhat.com/products/openshift">Red Hat OpenShift
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenStack Platform" href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat OpenShift Container Platform" href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat OpenShift Data Science" href="https://access.redhat.com/products/red-hat-openshift-data-science/">Red Hat OpenShift Data Science
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift Dedicated" href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat Advanced Cluster Security for Kubernetes" href="https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/">Red Hat Advanced Cluster Security for Kubernetes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat Advanced Cluster Management for Kubernetes" href="https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/">Red Hat Advanced Cluster Management for Kubernetes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat Quay" href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat CodeReady Workspaces" href="https://access.redhat.com/products/red-hat-codeready-workspaces/">OpenShift Dev Spaces
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift Service on AWS" href="https://access.redhat.com/products/red-hat-openshift-service-aws">Red Hat OpenShift Service on AWS
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Storage                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Gluster Storage" href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Hyperconverged Infrastructure" href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Ceph Storage" href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Openshift Container Storage" href="https://access.redhat.com/products/red-hat-openshift-data-foundation">Red Hat OpenShift Data Foundation
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Runtimes                    </h3>
                    <div slot="details">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Runtimes" href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat JBoss Enterprise Application Platform" href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Data Grid" href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat JBoss Web Server" href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Single Sign On" href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat support for Spring Boot" href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat build of Node.js" href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js
                                </a>
                            </li>                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat build of Quarkus" href="https://access.redhat.com/products/quarkus/">Red Hat build of Quarkus
                                </a>
                            </li>
                        </ul>
                    </div>

                    <h3 slot="details-nav">Integration and Automation                    </h3>
                    <div slot="details">
                        <ul class="border-bottom" id="portal-menu-border-bottom">
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat Application Foundations" href="https://access.redhat.com/products/red-hat-application-foundations/">Red Hat Application Foundations
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat Fuse" href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat AMQ" href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat 3scale API Management" href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div slot="details-nav--footer">
                        <pfe-cta pfe-priority="primary">
                            <a href="https://access.redhat.com/products/" class="pfe-navigation__menu-link" data-analytics-level="2" data-analytics-text="All Products" data-analytics-category="Products and Services|Products:" data-analytics-linkType="cta">All Products
                            </a>
                        </pfe-cta>
                    </div>
                </pfe-primary-detail>

            </pfe-navigation>

            <div id="scroll-anchor"></div>

            <!--[if IE 8]>
                <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                <span class="icon-warning alert-icon" aria-hidden="true"></span>
                You are using an unsupported web browser. Update to a supported browser for the best experience. <a href="/announcements/2120951">Read the announcement</a>.
                </div>
                </div>
            <![endif]-->
            <!--[if IE 9]>
                <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                <span class="icon-warning alert-icon" aria-hidden="true"></span>As of March 1, 2016, the Red Hat Customer Portal will no longer support Internet Explorer 9. See our new <a href="/help/browsers">browser support policy</a> for more information.
                </div>
                </div>
            <![endif]-->
            <div id="site-section"></div>
        </header>
        <!--googleon: all-->

        <main id="cp-main" class="portal-content-area">
            <div id="cp-content" class="main-content">                            <!-- /CP_PRIMER_HEADER -->

      <div class="container">
        

                                                                                                        <script>breadcrumbs = [["Products & Services","\/products\/"],["Product Documentation","\/documentation"],["OpenShift Container Platform","\/documentation\/en-us\/openshift_container_platform"],["4.13","\/documentation\/en-us\/openshift_container_platform\/4.13"],["Images","\/documentation\/en-us\/openshift_container_platform\/4.13\/html\/images"],["Images","\/documentation\/en-us\/openshift_container_platform\/4.13\/html\/images\/--single-page-document--"]]</script>

<div data-drupal-messages-fallback class="hidden"></div>


    </div>
        <div class="container">
        

  

  


  <article class="pvof-doc__content-wrapper__outer pvof-doc__content-wrapper__outer--css-not-removed">
    <script>
      'use strict';

            var $outerWrapper = document.querySelector('.pvof-doc__content-wrapper__outer');
      if ($outerWrapper && $outerWrapper.closest) {
        var $containerWrapper = $outerWrapper.closest('.container');
        if ($containerWrapper) {
          $containerWrapper.classList.remove('container');
          $containerWrapper.classList.add('j-chrome-content-container');
        }
      }

            var cssRemoved = false;
      try {
        var $crapCss = document.querySelectorAll(
          'link[href*="/chrome_themes/nimbus/css/pages.css"], link[href*="/chrome_themes/nimbus/css/components.css"]'
        );
        if ($crapCss.length) {
          for (let index = 0; index < $crapCss.length; index++) {
            const $stylesheet = $crapCss[index];
            $stylesheet.remove();
          }
        }
        cssRemoved = true;
      }
      catch (error) {
        console.error('Ran into an issue while trying to retheme page', error);
        cssRemoved = false;
      }

            if (cssRemoved) {
        var $pvofOuterWrapper = document.querySelector('.pvof-doc__content-wrapper__outer--css-not-removed');
        if ($pvofOuterWrapper) {
          $pvofOuterWrapper.classList.remove('pvof-doc__content-wrapper__outer--css-not-removed');
        }
      }
    </script>
    <div itemscope="" itemtype="https://schema.org/TechArticle" itemref="techArticle-md1 techArticle-md2 techArticle-md3"></div>
    <div itemscope="" itemtype="https://schema.org/SoftwareApplication" itemref="softwareApplication-md1 softwareApplication-md2 softwareApplication-md3 softwareApplication-md4"></div>
    <div class="pvof-doc__content-wrapper pvof-doc__content-wrapper--has-sidebar">
                                <div class="pvof-doc__content-wrapper__inner j-superdoc j-superdoc--has-nav">
                            <div class="pvof-sidebar__wrapper j-doc-nav j-superdoc__nav">
            <div class="j-sidebar__menu-container">
              <button class="j-sidebar__menu-trigger content-expander__trigger">
                <span class="j-sidebar__menu-trigger__open-text">Jump To</span>
                <span class="j-sidebar__menu-trigger__close-text">Close</span>
              </button>

              <div class="pvof-sidebar__inner-wrapper j-doc-nav__wrapper content-expander">
                <div class="j-sidebar__menu-details-container">
                  <button class="j-sidebar__menu-details-button j-sidebar__menu-details-button--expand">
                    Expand all
                  </button>
                  <button class="j-sidebar__menu-details-button j-sidebar__menu-details-button--collapse">
                    Collapse all
                  </button>
                </div>
                

  <nav id="pvof-doc__toc" class="pvof-doc__toc">
  <h2 class="j-doc-nav__title" id="j-doc-nav__title">
    Table of contents
  </h2>
  <div class="pvof-doc__toc-inner">
              <ol class="j-doc-nav__list" aria-labelledby="j-doc-nav__title">
                  <li class="j-doc-nav__list-item">
                                    

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images" class="j-doc-nav__link ">
    Images
  </a>
  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#overview-of-images" class="j-doc-nav__link j-doc-nav__link--has-children">
    1. Overview of images
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1. Overview of images"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1. Overview of images"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#about-containers-images-and-image-streams" class="j-doc-nav__link ">
    1.1. Understanding containers, images, and image streams
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-about_overview-of-images" class="j-doc-nav__link ">
    1.2. Images
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-image-registry-about_overview-of-images" class="j-doc-nav__link ">
    1.3. Image registry
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-container-repository-about_overview-of-images" class="j-doc-nav__link ">
    1.4. Image repository
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-tag_overview-of-images" class="j-doc-nav__link ">
    1.5. Image tags
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-id_overview-of-images" class="j-doc-nav__link ">
    1.6. Image IDs
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#containers-about_overview-of-images" class="j-doc-nav__link ">
    1.7. Containers
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-use_overview-of-images" class="j-doc-nav__link ">
    1.8. Why use imagestreams
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-tag_overview-of-images" class="j-doc-nav__link ">
    1.9. Image stream tags
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-image_overview-of-images" class="j-doc-nav__link ">
    1.10. Image stream images
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-trigger_overview-of-images" class="j-doc-nav__link ">
    1.11. Image stream triggers
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#how-you-can-use-the-cluster-samples-operator" class="j-doc-nav__link ">
    1.12. How you can use the Cluster Samples Operator
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#about-templates" class="j-doc-nav__link ">
    1.13. About templates
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#how-you-can-use-ruby-on-rails" class="j-doc-nav__link ">
    1.14. How you can use Ruby on Rails
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#configuring-samples-operator" class="j-doc-nav__link j-doc-nav__link--has-children">
    2. Configuring the Cluster Samples Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2. Configuring the Cluster Samples Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2. Configuring the Cluster Samples Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#samples-operator-overview_configuring-samples-operator" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1. Understanding the Cluster Samples Operator
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1. Understanding the Cluster Samples Operator"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1. Understanding the Cluster Samples Operator"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#samples-operator-bootstrapped" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.1.1. Cluster Samples Operator’s use of management state
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.1.1. Cluster Samples Operator’s use of management state"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.1.1. Cluster Samples Operator’s use of management state"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#samples-operator-restricted-network-install" class="j-doc-nav__link ">
    2.1.1.1. Restricted network installation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#samples-operator-restricted-network-install-with-access" class="j-doc-nav__link ">
    2.1.1.2. Restricted network installation with initial network access
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#samples-operator-retries" class="j-doc-nav__link ">
    2.1.2. Cluster Samples Operator’s tracking and error recovery of image stream imports
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#installation-images-samples-disconnected-mirroring-assist_configuring-samples-operator" class="j-doc-nav__link ">
    2.1.3. Cluster Samples Operator assistance for mirroring
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#samples-operator-configuration_configuring-samples-operator" class="j-doc-nav__link j-doc-nav__link--has-children">
    2.2. Cluster Samples Operator configuration parameters
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2.2. Cluster Samples Operator configuration parameters"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2.2. Cluster Samples Operator configuration parameters"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#configuration-restrictions" class="j-doc-nav__link ">
    2.2.1. Configuration restrictions
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#conditions" class="j-doc-nav__link ">
    2.2.2. Conditions
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#samples-operator-crd_configuring-samples-operator" class="j-doc-nav__link ">
    2.3. Accessing the Cluster Samples Operator configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-samples-operator-deprecated-image-stream_configuring-samples-operator" class="j-doc-nav__link ">
    2.4. Removing deprecated image stream tags from the Cluster Samples Operator
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#samples-operator-alt-registry" class="j-doc-nav__link j-doc-nav__link--has-children">
    3. Using the Cluster Samples Operator with an alternate registry
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "3. Using the Cluster Samples Operator with an alternate registry"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "3. Using the Cluster Samples Operator with an alternate registry"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#installation-about-mirror-registry_samples-operator-alt-registry" class="j-doc-nav__link j-doc-nav__link--has-children">
    3.1. About the mirror registry
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "3.1. About the mirror registry"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "3.1. About the mirror registry"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#samples-preparing-bastion" class="j-doc-nav__link ">
    3.1.1. Preparing the mirror host
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#cli-installing-cli_samples-operator-alt-registry" class="j-doc-nav__link ">
    3.1.2. Installing the OpenShift CLI by downloading the binary
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#installation-adding-registry-pull-secret_samples-operator-alt-registry" class="j-doc-nav__link ">
    3.2. Configuring credentials that allow images to be mirrored
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#installation-mirror-repository_samples-operator-alt-registry" class="j-doc-nav__link ">
    3.3. Mirroring the OpenShift Container Platform image repository
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#installation-restricted-network-samples_samples-operator-alt-registry" class="j-doc-nav__link j-doc-nav__link--has-children">
    3.4. Using Cluster Samples Operator image streams with alternate or mirrored registries
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "3.4. Using Cluster Samples Operator image streams with alternate or mirrored registries"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "3.4. Using Cluster Samples Operator image streams with alternate or mirrored registries"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#installation-images-samples-disconnected-mirroring-assist_samples-operator-alt-registry" class="j-doc-nav__link ">
    3.4.1. Cluster Samples Operator assistance for mirroring
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#creating-images" class="j-doc-nav__link j-doc-nav__link--has-children">
    4. Creating images
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4. Creating images"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4. Creating images"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-create-guidelines_create-images" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.1. Learning container best practices
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.1. Learning container best practices"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.1. Learning container best practices"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-create-guide-general_create-images" class="j-doc-nav__link ">
    4.1.1. General container image guidelines
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-create-guide-openshift_create-images" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.1.2. OpenShift Container Platform-specific guidelines
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.1.2. OpenShift Container Platform-specific guidelines"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.1.2. OpenShift Container Platform-specific guidelines"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#enable-images-for-source-to-image_create-images" class="j-doc-nav__link ">
    4.1.2.1. Enable images for source-to-image (S2I)
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#use-uid_create-images" class="j-doc-nav__link ">
    4.1.2.2. Support arbitrary user ids
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#use-services_create-images" class="j-doc-nav__link ">
    4.1.2.3. Use services for inter-image communication
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#provide-common-libraries_create-images" class="j-doc-nav__link ">
    4.1.2.4. Provide common libraries
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#use-env-vars_create-images" class="j-doc-nav__link ">
    4.1.2.5. Use environment variables for configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#set-image-metadata_create-images" class="j-doc-nav__link ">
    4.1.2.6. Set image metadata
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#clustering_create-images" class="j-doc-nav__link ">
    4.1.2.7. Clustering
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#logging_create-images" class="j-doc-nav__link ">
    4.1.2.8. Logging
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#liveness-and-readiness-probes_create-images" class="j-doc-nav__link ">
    4.1.2.9. Liveness and readiness probes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates_create-images" class="j-doc-nav__link ">
    4.1.2.10. Templates
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-create-metadata_create-images" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.2. Including metadata in images
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.2. Including metadata in images"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.2. Including metadata in images"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#defining-image-metadata" class="j-doc-nav__link ">
    4.2.1. Defining image metadata
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-create-s2i_create-images" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.3. Creating images from source code with source-to-image
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.3. Creating images from source code with source-to-image"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.3. Creating images from source code with source-to-image"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-create-s2i-build_create-images" class="j-doc-nav__link ">
    4.3.1. Understanding the source-to-image build process
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-create-s2i-scripts_create-images" class="j-doc-nav__link ">
    4.3.2. How to write source-to-image scripts
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-test-s2i_create-images" class="j-doc-nav__link j-doc-nav__link--has-children">
    4.4. About testing source-to-image images
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4.4. About testing source-to-image images"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4.4. About testing source-to-image images"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-test-s2i-testing-requirements_create-images" class="j-doc-nav__link ">
    4.4.1. Understanding testing requirements
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-test-s2i-generating-scripts-and-tools_create-images" class="j-doc-nav__link ">
    4.4.2. Generating scripts and tools
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-test-s21-testing-locally_create-images" class="j-doc-nav__link ">
    4.4.3. Testing locally
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-test-s21-basic-testing-workflow_create-images" class="j-doc-nav__link ">
    4.4.4. Basic testing workflow
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-test-s21-using-openshift-for-building-the-image_create-images" class="j-doc-nav__link ">
    4.4.5. Using OpenShift Container Platform for building the image
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#managing-images" class="j-doc-nav__link j-doc-nav__link--has-children">
    5. Managing images
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5. Managing images"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5. Managing images"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#managing-images-overview" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.1. Managing images overview
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.1. Managing images overview"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.1. Managing images overview"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-managing-overview_managing-images-overview" class="j-doc-nav__link ">
    5.1.1. Images overview
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#tagging-images" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.2. Tagging images
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.2. Tagging images"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.2. Tagging images"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-tag_tagging-images" class="j-doc-nav__link ">
    5.2.1. Image tags
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-tagging-conventions_tagging-images" class="j-doc-nav__link ">
    5.2.2. Image tag conventions
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-add-tags-to-imagestreams_tagging-images" class="j-doc-nav__link ">
    5.2.3. Adding tags to image streams
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-remove-tag-imagestream_tagging-images" class="j-doc-nav__link ">
    5.2.4. Removing tags from image streams
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-referencing-images-imagestreams_tagging-images" class="j-doc-nav__link ">
    5.2.5. Referencing images in imagestreams
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#image-pull-policy" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.3. Image pull policy
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.3. Image pull policy"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.3. Image pull policy"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-image-pull-policy-overview_image-pull-policy" class="j-doc-nav__link ">
    5.3.1. Image pull policy overview
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#using-image-pull-secrets" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4. Using image pull secrets
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4. Using image pull secrets"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4. Using image pull secrets"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-allow-pods-to-reference-images-across-projects_using-image-pull-secrets" class="j-doc-nav__link ">
    5.4.1. Allowing pods to reference images across projects
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-allow-pods-to-reference-images-from-secure-registries_using-image-pull-secrets" class="j-doc-nav__link j-doc-nav__link--has-children">
    5.4.2. Allowing pods to reference images from other secured registries
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5.4.2. Allowing pods to reference images from other secured registries"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5.4.2. Allowing pods to reference images from other secured registries"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-pulling-from-private-registries_using-image-pull-secrets" class="j-doc-nav__link ">
    5.4.2.1. Pulling from private registries with delegated authentication
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-update-global-pull-secret_using-image-pull-secrets" class="j-doc-nav__link ">
    5.4.3. Updating the global cluster pull secret
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#managing-image-streams" class="j-doc-nav__link j-doc-nav__link--has-children">
    6. Managing image streams
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6. Managing image streams"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6. Managing image streams"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-use_image-streams-managing" class="j-doc-nav__link ">
    6.1. Why use imagestreams
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-configure_image-streams-managing" class="j-doc-nav__link ">
    6.2. Configuring image streams
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-using-imagestream-images_image-streams-managing" class="j-doc-nav__link ">
    6.3. Image stream images
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-using-imagestream-tags_image-streams-managing" class="j-doc-nav__link ">
    6.4. Image stream tags
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-using-imagestream-change-triggers_image-streams-managing" class="j-doc-nav__link ">
    6.5. Image stream change triggers
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-mapping_image-streams-managing" class="j-doc-nav__link ">
    6.6. Image stream mapping
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#working-with-image-streams" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.7. Working with image streams
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.7. Working with image streams"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.7. Working with image streams"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-getting-info-about-imagestreams_image-streams-managing" class="j-doc-nav__link ">
    6.7.1. Getting information about image streams
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-adding-tags_image-streams-managing" class="j-doc-nav__link ">
    6.7.2. Adding tags to an image stream
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-external-image-tags_image-streams-managing" class="j-doc-nav__link ">
    6.7.3. Adding tags for an external image
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-update-tag_image-streams-managing" class="j-doc-nav__link ">
    6.7.4. Updating image stream tags
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-remove-tag_image-streams-managing" class="j-doc-nav__link ">
    6.7.5. Removing image stream tags
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-import_image-streams-managing" class="j-doc-nav__link ">
    6.7.6. Configuring periodic importing of image stream tags
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-import-images-image-streams" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.8. Importing and working with images and image streams
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.8. Importing and working with images and image streams"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.8. Importing and working with images and image streams"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-import-images-private-registry_image-streams-managing" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.8.1. Importing images and image streams from private registries
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.8.1. Importing images and image streams from private registries"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.8.1. Importing images and image streams from private registries"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-allow-pods-to-reference-images-from-secure-registries_image-streams-managing" class="j-doc-nav__link ">
    6.8.1.1. Allowing pods to reference images from other secured registries
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-import-import-mode_image-streams-managing" class="j-doc-nav__link j-doc-nav__link--has-children">
    6.8.2. Working with manifest lists
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6.8.2. Working with manifest lists"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6.8.2. Working with manifest lists"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-periodic-import-list_image-streams-managing" class="j-doc-nav__link ">
    6.8.2.1. Configuring periodic importing of manifest lists
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-ssl-import-list_image-streams-managing" class="j-doc-nav__link ">
    6.8.2.2. Configuring SSL/TSL when importing manifest lists
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-imagestream-specify-architecture_image-streams-managing" class="j-doc-nav__link ">
    6.8.3. Specifying architecture for --import-mode
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#importmode-configuration-fields_image-streams-managing" class="j-doc-nav__link ">
    6.8.4. Configuration fields for --import-mode
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#using-imagestreams-with-kube-resources" class="j-doc-nav__link j-doc-nav__link--has-children">
    7. Using image streams with Kubernetes resources
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7. Using image streams with Kubernetes resources"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7. Using image streams with Kubernetes resources"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-managing-images-enabling-imagestreams-kube_using-imagestreams-with-kube-resources" class="j-doc-nav__link ">
    7.1. Enabling image streams with Kubernetes resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#triggering-updates-on-imagestream-changes" class="j-doc-nav__link j-doc-nav__link--has-children">
    8. Triggering updates on image stream changes
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8. Triggering updates on image stream changes"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8. Triggering updates on image stream changes"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#openshift-resources" class="j-doc-nav__link ">
    8.1. OpenShift Container Platform resources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-triggering-updates-imagestream-changes-kubernetes-about_triggering-updates-on-imagestream-changes" class="j-doc-nav__link ">
    8.2. Triggering Kubernetes resources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-triggering-updates-imagestream-changes-kubernetes-cli_triggering-updates-on-imagestream-changes" class="j-doc-nav__link ">
    8.3. Setting the image trigger on Kubernetes resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#image-configuration" class="j-doc-nav__link j-doc-nav__link--has-children">
    9. Image configuration resources
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "9. Image configuration resources"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "9. Image configuration resources"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-configuration-parameters_image-configuration" class="j-doc-nav__link ">
    9.1. Image controller configuration parameters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-configuration-file_image-configuration" class="j-doc-nav__link j-doc-nav__link--has-children">
    9.2. Configuring image registry settings
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "9.2. Configuring image registry settings"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "9.2. Configuring image registry settings"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-configuration-allowed_image-configuration" class="j-doc-nav__link ">
    9.2.1. Adding specific registries
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-configuration-blocked_image-configuration" class="j-doc-nav__link j-doc-nav__link--has-children">
    9.2.2. Blocking specific registries
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "9.2.2. Blocking specific registries"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "9.2.2. Blocking specific registries"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-configuration-blocked-payload" class="j-doc-nav__link ">
    9.2.2.1. Blocking a payload registry
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-configuration-insecure_image-configuration" class="j-doc-nav__link ">
    9.2.3. Allowing insecure registries
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-configuration-shortname_image-configuration" class="j-doc-nav__link ">
    9.2.4. Adding registries that allow image short names
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-configuration-cas_image-configuration" class="j-doc-nav__link ">
    9.2.5. Configuring additional trust stores for image registry access
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-configuration-registry-mirror_image-configuration" class="j-doc-nav__link ">
    9.2.6. Configuring image registry repository mirroring
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-configuration-registry-mirror-convert_image-configuration" class="j-doc-nav__link ">
    9.2.7. Converting ImageContentSourcePolicy (ICSP) files for image registry repository mirroring
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#using-templates" class="j-doc-nav__link j-doc-nav__link--has-children">
    10. Using templates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "10. Using templates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "10. Using templates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-overview_using-templates" class="j-doc-nav__link ">
    10.1. Understanding templates
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-uploading_using-templates" class="j-doc-nav__link ">
    10.2. Uploading a template
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-creating-from-console_using-templates" class="j-doc-nav__link ">
    10.3. Creating an application by using the web console
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-using-the-cli_using-templates" class="j-doc-nav__link j-doc-nav__link--has-children">
    10.4. Creating objects from templates by using the CLI
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "10.4. Creating objects from templates by using the CLI"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "10.4. Creating objects from templates by using the CLI"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-cli-labels_using-templates" class="j-doc-nav__link ">
    10.4.1. Adding labels
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-cli-parameters_using-templates" class="j-doc-nav__link ">
    10.4.2. Listing parameters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-cli-generating-list-of-objects_using-templates" class="j-doc-nav__link ">
    10.4.3. Generating a list of objects
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-modifying-uploaded-template_using-templates" class="j-doc-nav__link ">
    10.5. Modifying uploaded templates
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-using-instant-app-quickstart_using-templates" class="j-doc-nav__link j-doc-nav__link--has-children">
    10.6. Using instant app and quick start templates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "10.6. Using instant app and quick start templates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "10.6. Using instant app and quick start templates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-quickstart_using-templates" class="j-doc-nav__link j-doc-nav__link--has-children">
    10.6.1. Quick start templates
  </a>
                              <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "10.6.1. Quick start templates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "10.6.1. Quick start templates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-quickstart-web-framework_using-templates" class="j-doc-nav__link ">
    10.6.1.1. Web framework quick start templates
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-writing_using-templates" class="j-doc-nav__link j-doc-nav__link--has-children">
    10.7. Writing templates
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "10.7. Writing templates"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "10.7. Writing templates"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-writing-description_using-templates" class="j-doc-nav__link ">
    10.7.1. Writing the template description
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-writing-labels_using-templates" class="j-doc-nav__link ">
    10.7.2. Writing template labels
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-writing-parameters_using-templates" class="j-doc-nav__link ">
    10.7.3. Writing template parameters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-writing-object-list_using-templates" class="j-doc-nav__link ">
    10.7.4. Writing the template object list
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-marking-as-bindable_using-templates" class="j-doc-nav__link ">
    10.7.5. Marking a template as bindable
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-exposing-object-fields_using-templates" class="j-doc-nav__link ">
    10.7.6. Exposing template object fields
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-waiting-for-readiness_using-templates" class="j-doc-nav__link ">
    10.7.7. Waiting for template readiness
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-create-from-existing-object_using-templates" class="j-doc-nav__link ">
    10.7.8. Creating a template from existing objects
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-using-ruby-on-rails" class="j-doc-nav__link j-doc-nav__link--has-children">
    11. Using Ruby on Rails
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "11. Using Ruby on Rails"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "11. Using Ruby on Rails"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#prerequisites" class="j-doc-nav__link ">
    11.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-rails-setting-up-database_templates-ruby-on-rails" class="j-doc-nav__link ">
    11.2. Setting up the database
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-rails-writing-application_templates-ruby-on-rails" class="j-doc-nav__link j-doc-nav__link--has-children">
    11.3. Writing your application
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "11.3. Writing your application"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "11.3. Writing your application"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-rails-creating-welcome-page_templates-ruby-on-rails" class="j-doc-nav__link ">
    11.3.1. Creating a welcome page
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-rails-configuring-application_templates-ruby-on-rails" class="j-doc-nav__link ">
    11.3.2. Configuring application for OpenShift Container Platform
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-rails-storing-application-in-git_templates-ruby-on-rails" class="j-doc-nav__link ">
    11.3.3. Storing your application in Git
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-rails-deploying-application_templates-ruby-on-rails" class="j-doc-nav__link j-doc-nav__link--has-children">
    11.4. Deploying your application to OpenShift Container Platform
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "11.4. Deploying your application to OpenShift Container Platform"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "11.4. Deploying your application to OpenShift Container Platform"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-rails-creating-database-service_templates-ruby-on-rails" class="j-doc-nav__link ">
    11.4.1. Creating the database service
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-rails-creating-frontend-service_templates-ruby-on-rails" class="j-doc-nav__link ">
    11.4.2. Creating the frontend service
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#templates-rails-creating-route-for-application_templates-ruby-on-rails" class="j-doc-nav__link ">
    11.4.3. Creating a route for your application
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#using-images" class="j-doc-nav__link j-doc-nav__link--has-children">
    12. Using images
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "12. Using images"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "12. Using images"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#using-images-overview" class="j-doc-nav__link ">
    12.1. Using images overview
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#using-s21-images" class="j-doc-nav__link j-doc-nav__link--has-children">
    12.2. Source-to-image
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "12.2. Source-to-image"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "12.2. Source-to-image"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-s2i-build-process-overview_using-s21-images" class="j-doc-nav__link ">
    12.2.1. Source-to-image build process overview
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#additional-resources_using-s21-images" class="j-doc-nav__link ">
    12.2.2. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#customizing-s2i-images" class="j-doc-nav__link j-doc-nav__link--has-children">
    12.3. Customizing source-to-image images
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "12.3. Customizing source-to-image images"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "12.3. Customizing source-to-image images"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#images-using-customizing-s2i-images-scripts-embedded_customizing-s2i-images" class="j-doc-nav__link ">
    12.3.1. Invoking scripts embedded in an image
  </a>
  
          </li>
              </ol>

  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                    

    <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images#idm140424673469136" class="j-doc-nav__link ">
    Legal Notice
  </a>
  
          </li>
              </ol>
    
  </div>
</nav>


              </div>
            </div>
            <div class="j-options-container j-options-container--mobile">
              <button class="j-sidebar__menu-trigger j-sidebar__menu-trigger--options content-expander__trigger">
                <span class="j-sidebar__menu-trigger__open-headline">
                  Settings
                </span>
                <span class="j-sidebar__menu-trigger__close-text">Close</span>
              </button>
              

  <ul class="j-doc-options__list content-expander">
    <li class="j-doc-options__item">
          <label class="j-doc-option__label j-doc-option__label--language" for="j-doc-language">
        Language:
      </label>
      <select id="j-doc-language" class="j-doc-option__select">
                  <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/images" selected=''>
            English
          </option>
                  <option value="/documentation/ja-jp/openshift_container_platform/4.13/html-single/images" >
            日本語
          </option>
                  <option value="/documentation/zh-cn/openshift_container_platform/4.13/html-single/images" >
            简体中文
          </option>
                  <option value="/documentation/ko-kr/openshift_container_platform/4.13/html-single/images" >
            한국어
          </option>
              </select>

            <noscript>
        <div class="j-doc-option__label j-doc-option__label--language" id="j-doc-option__label--language--nojs">
          Language:
        </div>
        <ul aria-labelledby="j-doc-option__label--language--nojs" class="j-doc-option__languages-list">
                      <li>
              <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images">English</a>
            </li>
                      <li>
              <a href="/documentation/ja-jp/openshift_container_platform/4.13/html-single/images">日本語</a>
            </li>
                      <li>
              <a href="/documentation/zh-cn/openshift_container_platform/4.13/html-single/images">简体中文</a>
            </li>
                      <li>
              <a href="/documentation/ko-kr/openshift_container_platform/4.13/html-single/images">한국어</a>
            </li>
                  </ul>
      </noscript>

      </li>

    <li class="j-doc-options__item">
    <label for="j-doc-mode" class="j-doc-option__label j-doc-option__label--format">
      Format:
    </label>
    <select id="j-doc-mode" class="j-doc-option__select">
              <option value="/documentation/en-us/openshift_container_platform/4.13/html/images"  class="j-doc-options__option j-doc-options__option--multi-page">
          Multi-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/images" selected='' class="j-doc-options__option j-doc-options__option--single-page">
          Single-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/pdf/images/OpenShift_Container_Platform-4.13-Images-en-US.pdf"  class="j-doc-options__option j-doc-options__option--pdf">
          PDF
        </option>
          </select>

        <noscript>
      <div class="j-doc-option__label j-doc-option__label--format" id="j-doc-option__label--format--nojs">
        Format:
      </div>
      <ul class="j-doc-option__format-list" aria-labelledby="j-doc-option__label--format--nojs">
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--multi-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html/images">Multi-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--single-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images">Single-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--pdf"><a href="/documentation/en-us/openshift_container_platform/4.13/pdf/images/OpenShift_Container_Platform-4.13-Images-en-US.pdf">PDF</a></li>
              </ul>
    </noscript>
  </li>
</ul>


              </div>
          </div>
                <div class="pvof-doc__tertiary-sidebar j-doc__tertiary-sidebar">
          <div class="pvof-doc__tertiary-sidebar__inner j-doc__tertiary-sidebar__inner">
            <div class="j-doc__doc-options">
              <div class="j-options-container j-options-container--desktop">
                <button class="j-sidebar__menu-trigger j-sidebar__menu-trigger--tablet content-expander__trigger">
                  <span class="j-sidebar__menu-trigger-icon"></span>
                  <h2 class="visually-hidden">Language and Page Formatting Options</h2>
                </button>
                  

  <ul class="j-doc-options__list content-expander">
    <li class="j-doc-options__item">
          <label class="j-doc-option__label j-doc-option__label--language" for="j-doc-language--2">
        Language:
      </label>
      <select id="j-doc-language--2" class="j-doc-option__select">
                  <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/images" selected=''>
            English
          </option>
                  <option value="/documentation/ja-jp/openshift_container_platform/4.13/html-single/images" >
            日本語
          </option>
                  <option value="/documentation/zh-cn/openshift_container_platform/4.13/html-single/images" >
            简体中文
          </option>
                  <option value="/documentation/ko-kr/openshift_container_platform/4.13/html-single/images" >
            한국어
          </option>
              </select>

            <noscript>
        <div class="j-doc-option__label j-doc-option__label--language" id="j-doc-option__label--language--nojs">
          Language:
        </div>
        <ul aria-labelledby="j-doc-option__label--language--nojs" class="j-doc-option__languages-list">
                      <li>
              <a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images">English</a>
            </li>
                      <li>
              <a href="/documentation/ja-jp/openshift_container_platform/4.13/html-single/images">日本語</a>
            </li>
                      <li>
              <a href="/documentation/zh-cn/openshift_container_platform/4.13/html-single/images">简体中文</a>
            </li>
                      <li>
              <a href="/documentation/ko-kr/openshift_container_platform/4.13/html-single/images">한국어</a>
            </li>
                  </ul>
      </noscript>

      </li>

    <li class="j-doc-options__item">
    <label for="j-doc-mode--2" class="j-doc-option__label j-doc-option__label--format">
      Format:
    </label>
    <select id="j-doc-mode--2" class="j-doc-option__select">
              <option value="/documentation/en-us/openshift_container_platform/4.13/html/images"  class="j-doc-options__option j-doc-options__option--multi-page">
          Multi-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/html-single/images" selected='' class="j-doc-options__option j-doc-options__option--single-page">
          Single-page
        </option>
              <option value="/documentation/en-us/openshift_container_platform/4.13/pdf/images/OpenShift_Container_Platform-4.13-Images-en-US.pdf"  class="j-doc-options__option j-doc-options__option--pdf">
          PDF
        </option>
          </select>

        <noscript>
      <div class="j-doc-option__label j-doc-option__label--format" id="j-doc-option__label--format--nojs">
        Format:
      </div>
      <ul class="j-doc-option__format-list" aria-labelledby="j-doc-option__label--format--nojs">
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--multi-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html/images">Multi-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--single-page"><a href="/documentation/en-us/openshift_container_platform/4.13/html-single/images">Single-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--pdf"><a href="/documentation/en-us/openshift_container_platform/4.13/pdf/images/OpenShift_Container_Platform-4.13-Images-en-US.pdf">PDF</a></li>
              </ul>
    </noscript>
  </li>
</ul>


                </div>
              </div>
          </div>
        </div>

                  <div class="doc-wrapper pvof-doc__wrapper j-superdoc__content-wrapper" id="doc-wrapper">
            

  <div class="pane-page-title">
    <h1 class="title" itemprop="name">Images</h1>
  </div>


  <div xml:lang="en-US" class="book" id="idm140424671484160"><div class="titlepage"><div><div class="producttitle"><span class="productname">OpenShift Container Platform</span> <span class="productnumber">4.13</span></div><div><h2 class="subtitle">Creating and managing images and imagestreams in OpenShift Container Platform </h2></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat OpenShift Documentation Team</span></div></div><div><a href="#idm140424673469136">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				This document provides instructions for creating and managing images and imagestreams in OpenShift Container Platform. It also provides instructions on using templates.
			</div></div></div></div><hr/></div><section class="chapter" id="overview-of-images"><div class="titlepage"><div><div><h1 class="title">Chapter 1. Overview of images</h1></div></div></div><section class="section" id="about-containers-images-and-image-streams"><div class="titlepage"><div><div><h2 class="title">1.1. Understanding containers, images, and image streams</h2></div></div></div><p>
				Containers, images, and image streams are important concepts to understand when you set out to create and manage containerized software. An image holds a set of software that is ready to run, while a container is a running instance of a container image. An image stream provides a way of storing different versions of the same basic image. Those different versions are represented by different tags on the same image name.
			</p></section><section class="section" id="images-about_overview-of-images"><div class="titlepage"><div><div><h2 class="title">1.2. Images</h2></div></div></div><p>
				Containers in OpenShift Container Platform are based on OCI- or Docker-formatted container <span class="emphasis"><em>images</em></span>. An image is a binary that includes all of the requirements for running a single container, as well as metadata describing its needs and capabilities.
			</p><p>
				You can think of it as a packaging technology. Containers only have access to resources defined in the image unless you give the container additional access when creating it. By deploying the same image in multiple containers across multiple hosts and load balancing between them, OpenShift Container Platform can provide redundancy and horizontal scaling for a service packaged into an image.
			</p><p>
				You can use the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux_atomic_host/7/html-single/managing_containers/#using_podman_to_work_with_containers">podman</a> or <code class="literal">docker</code> CLI directly to build images, but OpenShift Container Platform also supplies builder images that assist with creating new images by adding your code or configuration to existing images.
			</p><p>
				Because applications develop over time, a single image name can actually refer to many different versions of the same image. Each different image is referred to uniquely by its hash, a long hexadecimal number such as <code class="literal">fd44297e2ddb050ec4f…​</code>, which is usually shortened to 12 characters, such as <code class="literal">fd44297e2ddb</code>.
			</p><p>
				You can <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#creating-images">create</a>, <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#managing-images-overview">manage</a>, and <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#using-images-overview">use</a> container images.
			</p></section><section class="section" id="images-image-registry-about_overview-of-images"><div class="titlepage"><div><div><h2 class="title">1.3. Image registry</h2></div></div></div><p>
				An image registry is a content server that can store and serve container images. For example:
			</p><pre class="programlisting language-text">registry.redhat.io</pre><p>
				A registry contains a collection of one or more image repositories, which contain one or more tagged images. Red Hat provides a registry at <code class="literal">registry.redhat.io</code> for subscribers. OpenShift Container Platform can also supply its own OpenShift image registry for managing custom container images.
			</p></section><section class="section" id="images-container-repository-about_overview-of-images"><div class="titlepage"><div><div><h2 class="title">1.4. Image repository</h2></div></div></div><p>
				An image repository is a collection of related container images and tags identifying them. For example, the OpenShift Container Platform Jenkins images are in the repository:
			</p><pre class="programlisting language-text">docker.io/openshift/jenkins-2-centos7</pre></section><section class="section" id="images-tag_overview-of-images"><div class="titlepage"><div><div><h2 class="title">1.5. Image tags</h2></div></div></div><p>
				An image tag is a label applied to a container image in a repository that distinguishes a specific image from other images in an image stream. Typically, the tag represents a version number of some sort. For example, here <code class="literal">:v3.11.59-2</code> is the tag:
			</p><pre class="programlisting language-text">registry.access.redhat.com/openshift3/jenkins-2-rhel7:v3.11.59-2</pre><p>
				You can add additional tags to an image. For example, an image might be assigned the tags <code class="literal">:v3.11.59-2</code> and <code class="literal">:latest</code>.
			</p><p>
				OpenShift Container Platform provides the <code class="literal">oc tag</code> command, which is similar to the <code class="literal">docker tag</code> command, but operates on image streams instead of directly on images.
			</p></section><section class="section" id="images-id_overview-of-images"><div class="titlepage"><div><div><h2 class="title">1.6. Image IDs</h2></div></div></div><p>
				An image ID is a SHA (Secure Hash Algorithm) code that can be used to pull an image. A SHA image ID cannot change. A specific SHA identifier always references the exact same container image content. For example:
			</p><pre class="programlisting language-text">docker.io/openshift/jenkins-2-centos7@sha256:ab312bda324</pre></section><section class="section" id="containers-about_overview-of-images"><div class="titlepage"><div><div><h2 class="title">1.7. Containers</h2></div></div></div><p>
				The basic units of OpenShift Container Platform applications are called containers. <a class="link" href="https://www.redhat.com/en/topics/containers#overview">Linux container technologies</a> are lightweight mechanisms for isolating running processes so that they are limited to interacting with only their designated resources. The word container is defined as a specific running or paused instance of a container image.
			</p><p>
				Many application instances can be running in containers on a single host without visibility into each others' processes, files, network, and so on. Typically, each container provides a single service, often called a micro-service, such as a web server or a database, though containers can be used for arbitrary workloads.
			</p><p>
				The Linux kernel has been incorporating capabilities for container technologies for years. The Docker project developed a convenient management interface for Linux containers on a host. More recently, the <a class="link" href="https://github.com/opencontainers/">Open Container Initiative</a> has developed open standards for container formats and container runtimes. OpenShift Container Platform and Kubernetes add the ability to orchestrate OCI- and Docker-formatted containers across multi-host installations.
			</p><p>
				Though you do not directly interact with container runtimes when using OpenShift Container Platform, understanding their capabilities and terminology is important for understanding their role in OpenShift Container Platform and how your applications function inside of containers.
			</p><p>
				Tools such as <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux_atomic_host/7/html-single/managing_containers/#using_podman_to_work_with_containers">podman</a> can be used to replace <code class="literal">docker</code> command-line tools for running and managing containers directly. Using <code class="literal">podman</code>, you can experiment with containers separately from OpenShift Container Platform.
			</p></section><section class="section" id="images-imagestream-use_overview-of-images"><div class="titlepage"><div><div><h2 class="title">1.8. Why use imagestreams</h2></div></div></div><p>
				An image stream and its associated tags provide an abstraction for referencing container images from within OpenShift Container Platform. The image stream and its tags allow you to see what images are available and ensure that you are using the specific image you need even if the image in the repository changes.
			</p><p>
				Image streams do not contain actual image data, but present a single virtual view of related images, similar to an image repository.
			</p><p>
				You can configure builds and deployments to watch an image stream for notifications when new images are added and react by performing a build or deployment, respectively.
			</p><p>
				For example, if a deployment is using a certain image and a new version of that image is created, a deployment could be automatically performed to pick up the new version of the image.
			</p><p>
				However, if the image stream tag used by the deployment or build is not updated, then even if the container image in the container image registry is updated, the build or deployment continues using the previous, presumably known good image.
			</p><p>
				The source images can be stored in any of the following:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						OpenShift Container Platform’s integrated registry.
					</li><li class="listitem">
						An external registry, for example registry.redhat.io or quay.io.
					</li><li class="listitem">
						Other image streams in the OpenShift Container Platform cluster.
					</li></ul></div><p>
				When you define an object that references an image stream tag, such as a build or deployment configuration, you point to an image stream tag and not the repository. When you build or deploy your application, OpenShift Container Platform queries the repository using the image stream tag to locate the associated ID of the image and uses that exact image.
			</p><p>
				The image stream metadata is stored in the etcd instance along with other cluster information.
			</p><p>
				Using image streams has several significant benefits:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						You can tag, rollback a tag, and quickly deal with images, without having to re-push using the command line.
					</li><li class="listitem">
						You can trigger builds and deployments when a new image is pushed to the registry. Also, OpenShift Container Platform has generic triggers for other resources, such as Kubernetes objects.
					</li><li class="listitem">
						You can mark a tag for periodic re-import. If the source image has changed, that change is picked up and reflected in the image stream, which triggers the build or deployment flow, depending upon the build or deployment configuration.
					</li><li class="listitem">
						You can share images using fine-grained access control and quickly distribute images across your teams.
					</li><li class="listitem">
						If the source image changes, the image stream tag still points to a known-good version of the image, ensuring that your application do not break unexpectedly.
					</li><li class="listitem">
						You can configure security around who can view and use the images through permissions on the image stream objects.
					</li><li class="listitem">
						Users that lack permission to read or list images on the cluster level can still retrieve the images tagged in a project using image streams.
					</li></ul></div><p>
				You can <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#managing-image-streams">manage</a> image streams, <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#using-imagestreams-with-kube-resources">use image streams with Kubernetes resources</a>, and <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#triggering-updates-on-imagestream-changes">trigger updates on image stream updates</a>.
			</p></section><section class="section" id="images-imagestream-tag_overview-of-images"><div class="titlepage"><div><div><h2 class="title">1.9. Image stream tags</h2></div></div></div><p>
				An image stream tag is a named pointer to an image in an image stream. An image stream tag is similar to a container image tag.
			</p></section><section class="section" id="images-imagestream-image_overview-of-images"><div class="titlepage"><div><div><h2 class="title">1.10. Image stream images</h2></div></div></div><p>
				An image stream image allows you to retrieve a specific container image from a particular image stream where it is tagged. An image stream image is an API resource object that pulls together some metadata about a particular image SHA identifier.
			</p></section><section class="section" id="images-imagestream-trigger_overview-of-images"><div class="titlepage"><div><div><h2 class="title">1.11. Image stream triggers</h2></div></div></div><p>
				An image stream trigger causes a specific action when an image stream tag changes. For example, importing can cause the value of the tag to change, which causes a trigger to fire when there are deployments, builds, or other resources listening for those.
			</p></section><section class="section" id="how-you-can-use-the-cluster-samples-operator"><div class="titlepage"><div><div><h2 class="title">1.12. How you can use the Cluster Samples Operator</h2></div></div></div><p>
				During the initial startup, the Operator creates the default samples resource to initiate the creation of the image streams and templates. You can use the Cluster Samples Operator to manage the sample image streams and templates stored in the <code class="literal">openshift</code> namespace.
			</p><p>
				As a cluster administrator, you can use the Cluster Samples Operator to:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#configuring-samples-operator">Configure the Operator</a>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#samples-operator-alt-registry">Use the Operator with an alternate registry</a>.
					</li></ul></div></section><section class="section" id="about-templates"><div class="titlepage"><div><div><h2 class="title">1.13. About templates</h2></div></div></div><p>
				A template is a definition of an object to be replicated. You can use <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#using-templates">templates</a> to build and deploy configurations.
			</p></section><section class="section" id="how-you-can-use-ruby-on-rails"><div class="titlepage"><div><div><h2 class="title">1.14. How you can use Ruby on Rails</h2></div></div></div><p>
				As a developer, you can use <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#templates-using-ruby-on-rails">Ruby on Rails</a> to:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Write your application:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Set up a database.
							</li><li class="listitem">
								Create a welcome page.
							</li><li class="listitem">
								Configure your application for OpenShift Container Platform.
							</li><li class="listitem">
								Store your application in Git.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Deploy your application in OpenShift Container Platform:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Create the database service.
							</li><li class="listitem">
								Create the frontend service.
							</li><li class="listitem">
								Create a route for your application.
							</li></ul></div></li></ul></div></section></section><section class="chapter" id="configuring-samples-operator"><div class="titlepage"><div><div><h1 class="title">Chapter 2. Configuring the Cluster Samples Operator</h1></div></div></div><p>
			The Cluster Samples Operator, which operates in the <code class="literal">openshift</code> namespace, installs and updates the Red Hat Enterprise Linux (RHEL)-based OpenShift Container Platform image streams and OpenShift Container Platform templates.
		</p><div class="admonition important"><div class="admonition_header">Cluster Samples Operator is being downsized</div><div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Starting from OpenShift Container Platform 4.13, Cluster Samples Operator is downsized. Cluster Samples Operator will stop providing the following updates for non-Source-to-Image (Non-S2I) image streams and templates:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								new image streams and templates
							</li><li class="listitem">
								updates to the existing image streams and templates unless it is a CVE update
							</li></ul></div></li><li class="listitem">
						Cluster Samples Operator will provide support for Non-S2I image streams and templates as per the <a class="link" href="https://access.redhat.com/support/policy/updates/openshift#dates">OpenShift Container Platform lifecycle policy dates and support guidelines</a>.
					</li><li class="listitem"><p class="simpara">
						Cluster Samples Operator will continue to support the S2I builder image streams and templates and accept the updates. S2I image streams and templates include:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Ruby
							</li><li class="listitem">
								Python
							</li><li class="listitem">
								Node.js
							</li><li class="listitem">
								Perl
							</li><li class="listitem">
								PHP
							</li><li class="listitem">
								HTTPD
							</li><li class="listitem">
								Nginx
							</li><li class="listitem">
								EAP
							</li><li class="listitem">
								Java
							</li><li class="listitem">
								Webserver
							</li><li class="listitem">
								.NET
							</li><li class="listitem">
								Go
							</li></ul></div></li><li class="listitem">
						Starting from OpenShift Container Platform 4.16, Cluster Samples Operator will stop managing non-S2I image streams and templates. You can contact the image stream or template owner for any requirements and future plans. In addition, refer to the <a class="link" href="https://github.com/openshift/library/blob/master/official.yaml">list of the repositories hosting the image stream or templates</a>.
					</li></ul></div></div></div><section class="section" id="samples-operator-overview_configuring-samples-operator"><div class="titlepage"><div><div><h2 class="title">2.1. Understanding the Cluster Samples Operator</h2></div></div></div><p>
				During installation, the Operator creates the default configuration object for itself and then creates the sample image streams and templates, including quick start templates.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					To facilitate image stream imports from other registries that require credentials, a cluster administrator can create any additional secrets that contain the content of a Docker <code class="literal">config.json</code> file in the <code class="literal">openshift</code> namespace needed for image import.
				</p></div></div><p>
				The Cluster Samples Operator configuration is a cluster-wide resource, and the deployment is contained within the <code class="literal">openshift-cluster-samples-operator</code> namespace.
			</p><p>
				The image for the Cluster Samples Operator contains image stream and template definitions for the associated OpenShift Container Platform release. When each sample is created or updated, the Cluster Samples Operator includes an annotation that denotes the version of OpenShift Container Platform. The Operator uses this annotation to ensure that each sample matches the release version. Samples outside of its inventory are ignored, as are skipped samples. Modifications to any samples that are managed by the Operator, where that version annotation is modified or deleted, are reverted automatically.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The Jenkins images are part of the image payload from installation and are tagged into the image streams directly.
				</p></div></div><p>
				The Cluster Samples Operator configuration resource includes a finalizer which cleans up the following upon deletion:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Operator managed image streams.
					</li><li class="listitem">
						Operator managed templates.
					</li><li class="listitem">
						Operator generated configuration resources.
					</li><li class="listitem">
						Cluster status resources.
					</li></ul></div><p>
				Upon deletion of the samples resource, the Cluster Samples Operator recreates the resource using the default configuration.
			</p><section class="section" id="samples-operator-bootstrapped"><div class="titlepage"><div><div><h3 class="title">2.1.1. Cluster Samples Operator’s use of management state</h3></div></div></div><p>
					The Cluster Samples Operator is bootstrapped as <code class="literal">Managed</code> by default or if global proxy is configured. In the <code class="literal">Managed</code> state, the Cluster Samples Operator is actively managing its resources and keeping the component active in order to pull sample image streams and images from the registry and ensure that the requisite sample templates are installed.
				</p><p>
					Certain circumstances result in the Cluster Samples Operator bootstrapping itself as <code class="literal">Removed</code> including:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If the Cluster Samples Operator cannot reach <a class="link" href="https://registry.redhat.io">registry.redhat.io</a> after three minutes on initial startup after a clean installation.
						</li><li class="listitem">
							If the Cluster Samples Operator detects it is on an IPv6 network.
						</li><li class="listitem">
							If the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#images-configuration-parameters_image-configuration">image controller configuration parameters</a> prevent the creation of image streams by using the default image registry, or by using the image registry specified by the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#samples-operator-configuration_configuring-samples-operator"><code class="literal">samplesRegistry</code> setting</a>.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						For OpenShift Container Platform, the default image registry is <code class="literal">registry.redhat.io</code>.
					</p></div></div><p>
					However, if the Cluster Samples Operator detects that it is on an IPv6 network and an OpenShift Container Platform global proxy is configured, then IPv6 check supersedes all the checks. As a result, the Cluster Samples Operator bootstraps itself as <code class="literal">Removed</code>.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						IPv6 installations are not currently supported by <a class="link" href="https://registry.redhat.io">registry.redhat.io</a>. The Cluster Samples Operator pulls most of the sample image streams and images from <a class="link" href="https://registry.redhat.io">registry.redhat.io</a>.
					</p></div></div><section class="section" id="samples-operator-restricted-network-install"><div class="titlepage"><div><div><h4 class="title">2.1.1.1. Restricted network installation</h4></div></div></div><p>
						Boostrapping as <code class="literal">Removed</code> when unable to access <code class="literal">registry.redhat.io</code> facilitates restricted network installations when the network restriction is already in place. Bootstrapping as <code class="literal">Removed</code> when network access is restricted allows the cluster administrator more time to decide if samples are desired, because the Cluster Samples Operator does not submit alerts that sample image stream imports are failing when the management state is set to <code class="literal">Removed</code>. When the Cluster Samples Operator comes up as <code class="literal">Managed</code> and attempts to install sample image streams, it starts alerting two hours after initial installation if there are failing imports.
					</p></section><section class="section" id="samples-operator-restricted-network-install-with-access"><div class="titlepage"><div><div><h4 class="title">2.1.1.2. Restricted network installation with initial network access</h4></div></div></div><p>
						Conversely, if a cluster that is intended to be a restricted network or disconnected cluster is first installed while network access exists, the Cluster Samples Operator installs the content from <code class="literal">registry.redhat.io</code> since it can access it. If you want the Cluster Samples Operator to still bootstrap as <code class="literal">Removed</code> in order to defer samples installation until you have decided which samples are desired, set up image mirrors, and so on, then follow the instructions for using the Samples Operator with an alternate registry and customizing nodes, both linked in the additional resources section, to override the Cluster Samples Operator default configuration and initially come up as <code class="literal">Removed</code>.
					</p><p>
						You must put the following additional YAML file in the <code class="literal">openshift</code> directory created by <code class="literal">openshift-install create manifest</code>:
					</p><div class="formalpara"><p class="title"><strong>Example Cluster Samples Operator YAML file with <code class="literal">managementState: Removed</code></strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: samples.operator.openshift.io/v1
kind: Config
metadata:
  name: cluster
spec:
  architectures:
  - x86_64
  managementState: Removed</pre>

						</p></div></section></section><section class="section" id="samples-operator-retries"><div class="titlepage"><div><div><h3 class="title">2.1.2. Cluster Samples Operator’s tracking and error recovery of image stream imports</h3></div></div></div><p>
					After creation or update of a samples image stream, the Cluster Samples Operator monitors the progress of each image stream tag’s image import.
				</p><p>
					If an import fails, the Cluster Samples Operator retries the import through the image stream image import API, which is the same API used by the <code class="literal">oc import-image</code> command, approximately every 15 minutes until it sees the import succeed, or if the Cluster Samples Operator’s configuration is changed such that either the image stream is added to the <code class="literal">skippedImagestreams</code> list, or the management state is changed to <code class="literal">Removed</code>.
				</p><h3 id="additional-resources">Additional resources</h3><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If the Cluster Samples Operator is removed during installation, you can <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#samples-operator-alt-registry">use the Cluster Samples Operator with an alternate registry</a> so content can be imported, and then set the Cluster Samples Operator to <code class="literal">Managed</code> to get the samples.
						</li><li class="listitem"><p class="simpara">
							To ensure the Cluster Samples Operator bootstraps as <code class="literal">Removed</code> in a restricted network installation with initial network access to defer samples installation until you have decided which samples are desired, follow the instructions for <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#installing-customizing">customizing nodes</a> to override the Cluster Samples Operator default configuration and initially come up as <code class="literal">Removed</code>.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									To host samples in your disconnected environment, follow the instructions for <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#samples-operator-alt-registry">using the Cluster Samples Operator with an alternate registry</a>.
								</li></ul></div></li></ul></div></section><section class="section" id="installation-images-samples-disconnected-mirroring-assist_configuring-samples-operator"><div class="titlepage"><div><div><h3 class="title">2.1.3. Cluster Samples Operator assistance for mirroring</h3></div></div></div><p>
					During installation, OpenShift Container Platform creates a config map named <code class="literal">imagestreamtag-to-image</code> in the <code class="literal">openshift-cluster-samples-operator</code> namespace. The <code class="literal">imagestreamtag-to-image</code> config map contains an entry, the populating image, for each image stream tag.
				</p><p>
					The format of the key for each entry in the data field in the config map is <code class="literal">&lt;image_stream_name&gt;_&lt;image_stream_tag_name&gt;</code>.
				</p><p>
					During a disconnected installation of OpenShift Container Platform, the status of the Cluster Samples Operator is set to <code class="literal">Removed</code>. If you choose to change it to <code class="literal">Managed</code>, it installs samples.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The use of samples in a network-restricted or discontinued environment may require access to services external to your network. Some example services include: Github, Maven Central, npm, RubyGems, PyPi and others. There might be additional steps to take that allow the cluster samples operators’s objects to reach the services they require.
					</p></div></div><p>
					You can use this config map as a reference for which images need to be mirrored for your image streams to import.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							While the Cluster Samples Operator is set to <code class="literal">Removed</code>, you can create your mirrored registry, or determine which existing mirrored registry you want to use.
						</li><li class="listitem">
							Mirror the samples you want to the mirrored registry using the new config map as your guide.
						</li><li class="listitem">
							Add any of the image streams you did not mirror to the <code class="literal">skippedImagestreams</code> list of the Cluster Samples Operator configuration object.
						</li><li class="listitem">
							Set <code class="literal">samplesRegistry</code> of the Cluster Samples Operator configuration object to the mirrored registry.
						</li><li class="listitem">
							Then set the Cluster Samples Operator to <code class="literal">Managed</code> to install the image streams you have mirrored.
						</li></ul></div><p>
					See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#installation-restricted-network-samples_samples-operator-alt-registry">Using Cluster Samples Operator image streams with alternate or mirrored registries</a> for a detailed procedure.
				</p></section></section><section class="section" id="samples-operator-configuration_configuring-samples-operator"><div class="titlepage"><div><div><h2 class="title">2.2. Cluster Samples Operator configuration parameters</h2></div></div></div><p>
				The samples resource offers the following configuration fields:
			</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 27%; " class="col_1"><!--Empty--></col><col style="width: 73%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140424683722688" scope="col">Parameter</th><th align="left" valign="top" id="idm140424683721600" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140424683722688"> <p>
								<code class="literal">managementState</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140424683721600"> <p>
								<code class="literal">Managed</code>: The Cluster Samples Operator updates the samples as the configuration dictates.
							</p>
							 <p>
								<code class="literal">Unmanaged</code>: The Cluster Samples Operator ignores updates to its configuration resource object and any image streams or templates in the <code class="literal">openshift</code> namespace.
							</p>
							 <p>
								<code class="literal">Removed</code>: The Cluster Samples Operator removes the set of <code class="literal">Managed</code> image streams and templates in the <code class="literal">openshift</code> namespace. It ignores new samples created by the cluster administrator or any samples in the skipped lists. After the removals are complete, the Cluster Samples Operator works like it is in the <code class="literal">Unmanaged</code> state and ignores any watch events on the sample resources, image streams, or templates.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140424683722688"> <p>
								<code class="literal">samplesRegistry</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140424683721600"> <p>
								Allows you to specify which registry is accessed by image streams for their image content. <code class="literal">samplesRegistry</code> defaults to <code class="literal">registry.redhat.io</code> for OpenShift Container Platform.
							</p>
							 <div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Creation or update of RHEL content does not commence if the secret for pull access is not in place when either <code class="literal">Samples Registry</code> is not explicitly set, leaving an empty string, or when it is set to registry.redhat.io. In both cases, image imports work off of registry.redhat.io, which requires credentials.
								</p><p>
									Creation or update of RHEL content is not gated by the existence of the pull secret if the <code class="literal">Samples Registry</code> is overridden to a value other than the empty string or registry.redhat.io.
								</p></div></div>
							 </td></tr><tr><td align="left" valign="top" headers="idm140424683722688"> <p>
								<code class="literal">architectures</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140424683721600"> <p>
								Placeholder to choose an architecture type.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140424683722688"> <p>
								<code class="literal">skippedImagestreams</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140424683721600"> <p>
								Image streams that are in the Cluster Samples Operator’s inventory but that the cluster administrator wants the Operator to ignore or not manage. You can add a list of image stream names to this parameter. For example, <code class="literal">["httpd","perl"]</code>.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140424683722688"> <p>
								<code class="literal">skippedTemplates</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140424683721600"> <p>
								Templates that are in the Cluster Samples Operator’s inventory, but that the cluster administrator wants the Operator to ignore or not manage.
							</p>
							 </td></tr></tbody></table></div><p>
				Secret, image stream, and template watch events can come in before the initial samples resource object is created, the Cluster Samples Operator detects and re-queues the event.
			</p><section class="section" id="configuration-restrictions"><div class="titlepage"><div><div><h3 class="title">2.2.1. Configuration restrictions</h3></div></div></div><p>
					When the Cluster Samples Operator starts supporting multiple architectures, the architecture list is not allowed to be changed while in the <code class="literal">Managed</code> state.
				</p><p>
					To change the architectures values, a cluster administrator must:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Mark the <code class="literal">Management State</code> as <code class="literal">Removed</code>, saving the change.
						</li><li class="listitem">
							In a subsequent change, edit the architecture and change the <code class="literal">Management State</code> back to <code class="literal">Managed</code>.
						</li></ul></div><p>
					The Cluster Samples Operator still processes secrets while in <code class="literal">Removed</code> state. You can create the secret before switching to <code class="literal">Removed</code>, while in <code class="literal">Removed</code> before switching to <code class="literal">Managed</code>, or after switching to <code class="literal">Managed</code> state. There are delays in creating the samples until the secret event is processed if you create the secret after switching to <code class="literal">Managed</code>. This helps facilitate the changing of the registry, where you choose to remove all the samples before switching to insure a clean slate. Removing all samples before switching is not required.
				</p></section><section class="section" id="conditions"><div class="titlepage"><div><div><h3 class="title">2.2.2. Conditions</h3></div></div></div><p>
					The samples resource maintains the following conditions in its status:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 27%; " class="col_1"><!--Empty--></col><col style="width: 73%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140424683117712" scope="col">Condition</th><th align="left" valign="top" id="idm140424683116624" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140424683117712"> <p>
									<code class="literal">SamplesExists</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424683116624"> <p>
									Indicates the samples are created in the <code class="literal">openshift</code> namespace.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424683117712"> <p>
									<code class="literal">ImageChangesInProgress</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424683116624"> <p>
									<code class="literal">True</code> when image streams are created or updated, but not all of the tag spec generations and tag status generations match.
								</p>
								 <p>
									<code class="literal">False</code> when all of the generations match, or unrecoverable errors occurred during import, the last seen error is in the message field. The list of pending image streams is in the reason field.
								</p>
								 <p>
									This condition is deprecated in OpenShift Container Platform.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424683117712"> <p>
									<code class="literal">ConfigurationValid</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424683116624"> <p>
									<code class="literal">True</code> or <code class="literal">False</code> based on whether any of the restricted changes noted previously are submitted.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424683117712"> <p>
									<code class="literal">RemovePending</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424683116624"> <p>
									Indicator that there is a <code class="literal">Management State: Removed</code> setting pending, but the Cluster Samples Operator is waiting for the deletions to complete.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424683117712"> <p>
									<code class="literal">ImportImageErrorsExist</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424683116624"> <p>
									Indicator of which image streams had errors during the image import phase for one of their tags.
								</p>
								 <p>
									<code class="literal">True</code> when an error has occurred. The list of image streams with an error is in the reason field. The details of each error reported are in the message field.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424683117712"> <p>
									<code class="literal">MigrationInProgress</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424683116624"> <p>
									<code class="literal">True</code> when the Cluster Samples Operator detects that the version is different than the Cluster Samples Operator version with which the current samples set are installed.
								</p>
								 <p>
									This condition is deprecated in OpenShift Container Platform.
								</p>
								 </td></tr></tbody></table></div></section></section><section class="section" id="samples-operator-crd_configuring-samples-operator"><div class="titlepage"><div><div><h2 class="title">2.3. Accessing the Cluster Samples Operator configuration</h2></div></div></div><p>
				You can configure the Cluster Samples Operator by editing the file with the provided parameters.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Install the OpenShift CLI (<code class="literal">oc</code>).
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Access the Cluster Samples Operator configuration:
					</p><pre class="programlisting language-terminal">$ oc edit configs.samples.operator.openshift.io/cluster -o yaml</pre><p class="simpara">
						The Cluster Samples Operator configuration resembles the following example:
					</p><pre class="programlisting language-yaml">apiVersion: samples.operator.openshift.io/v1
kind: Config
...</pre></li></ul></div></section><section class="section" id="images-samples-operator-deprecated-image-stream_configuring-samples-operator"><div class="titlepage"><div><div><h2 class="title">2.4. Removing deprecated image stream tags from the Cluster Samples Operator</h2></div></div></div><p>
				The Cluster Samples Operator leaves deprecated image stream tags in an image stream because users can have deployments that use the deprecated image stream tags.
			</p><p>
				You can remove deprecated image stream tags by editing the image stream with the <code class="literal">oc tag</code> command.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Deprecated image stream tags that the samples providers have removed from their image streams are not included on initial installations.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You installed the <code class="literal">oc</code> CLI.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Remove deprecated image stream tags by editing the image stream with the <code class="literal">oc tag</code> command.
					</p><pre class="programlisting language-terminal">$ oc tag -d &lt;image_stream_name:tag&gt;</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">Deleted tag default/&lt;image_stream_name:tag&gt;.</pre>

						</p></div></li></ul></div><h3 id="additional-resources-2">Additional resources</h3><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						For more information about configuring credentials, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#using-image-pull-secrets">Using image pull secrets</a>.
					</li></ul></div></section></section><section class="chapter" id="samples-operator-alt-registry"><div class="titlepage"><div><div><h1 class="title">Chapter 3. Using the Cluster Samples Operator with an alternate registry</h1></div></div></div><p>
			You can use the Cluster Samples Operator with an alternate registry by first creating a mirror registry.
		</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
				You must have access to the internet to obtain the necessary container images. In this procedure, you place the mirror registry on a mirror host that has access to both your network and the internet.
			</p></div></div><section class="section" id="installation-about-mirror-registry_samples-operator-alt-registry"><div class="titlepage"><div><div><h2 class="title">3.1. About the mirror registry</h2></div></div></div><p>
				You can mirror the images that are required for OpenShift Container Platform installation and subsequent product updates to a container mirror registry such as Red Hat Quay, JFrog Artifactory, Sonatype Nexus Repository, or Harbor. If you do not have access to a large-scale container registry, you can use the <span class="emphasis"><em>mirror registry for Red Hat OpenShift</em></span>, a small-scale container registry included with OpenShift Container Platform subscriptions.
			</p><p>
				You can use any container registry that supports <a class="link" href="https://docs.docker.com/registry/spec/manifest-v2-2">Docker v2-2</a>, such as Red Hat Quay, the <span class="emphasis"><em>mirror registry for Red Hat OpenShift</em></span>, Artifactory, Sonatype Nexus Repository, or Harbor. Regardless of your chosen registry, the procedure to mirror content from Red Hat hosted sites on the internet to an isolated image registry is the same. After you mirror the content, you configure each cluster to retrieve this content from your mirror registry.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The OpenShift image registry cannot be used as the target registry because it does not support pushing without a tag, which is required during the mirroring process.
				</p></div></div><p>
				If choosing a container registry that is not the <span class="emphasis"><em>mirror registry for Red Hat OpenShift</em></span>, it must be reachable by every machine in the clusters that you provision. If the registry is unreachable, installation, updating, or normal operations such as workload relocation might fail. For that reason, you must run mirror registries in a highly available way, and the mirror registries must at least match the production availability of your OpenShift Container Platform clusters.
			</p><p>
				When you populate your mirror registry with OpenShift Container Platform images, you can follow two scenarios. If you have a host that can access both the internet and your mirror registry, but not your cluster nodes, you can directly mirror the content from that machine. This process is referred to as <span class="emphasis"><em>connected mirroring</em></span>. If you have no such host, you must mirror the images to a file system and then bring that host or removable media into your restricted environment. This process is referred to as <span class="emphasis"><em>disconnected mirroring</em></span>.
			</p><p>
				For mirrored registries, to view the source of pulled images, you must review the <code class="literal">Trying to access</code> log entry in the CRI-O logs. Other methods to view the image pull source, such as using the <code class="literal">crictl images</code> command on a node, show the non-mirrored image name, even though the image is pulled from the mirrored location.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Red Hat does not test third party registries with OpenShift Container Platform.
				</p></div></div><div class="formalpara"><p class="title"><strong>Additional information</strong></p><p>
					For information on viewing the CRI-O logs to view the image source, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/installing/#viewing-the-image-pull-source_validating-an-installation">Viewing the image pull source</a>.
				</p></div><section class="section" id="samples-preparing-bastion"><div class="titlepage"><div><div><h3 class="title">3.1.1. Preparing the mirror host</h3></div></div></div><p>
					Before you create the mirror registry, you must prepare the mirror host.
				</p></section><section class="section" id="cli-installing-cli_samples-operator-alt-registry"><div class="titlepage"><div><div><h3 class="title">3.1.2. Installing the OpenShift CLI by downloading the binary</h3></div></div></div><p>
					You can install the OpenShift CLI (<code class="literal">oc</code>) to interact with OpenShift Container Platform from a command-line interface. You can install <code class="literal">oc</code> on Linux, Windows, or macOS.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						If you installed an earlier version of <code class="literal">oc</code>, you cannot use it to complete all of the commands in OpenShift Container Platform 4.13. Download and install the new version of <code class="literal">oc</code>.
					</p></div></div><h5 id="installing-the-openshift-cli-on-linux">Installing the OpenShift CLI on Linux</h5><p>
					You can install the OpenShift CLI (<code class="literal">oc</code>) binary on Linux by using the following procedure.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <a class="link" href="https://access.redhat.com/downloads/content/290">OpenShift Container Platform downloads page</a> on the Red Hat Customer Portal.
						</li><li class="listitem">
							Select the architecture from the <span class="strong strong"><strong>Product Variant</strong></span> drop-down list.
						</li><li class="listitem">
							Select the appropriate version from the <span class="strong strong"><strong>Version</strong></span> drop-down list.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Download Now</strong></span> next to the <span class="strong strong"><strong>OpenShift v4.13 Linux Client</strong></span> entry and save the file.
						</li><li class="listitem"><p class="simpara">
							Unpack the archive:
						</p><pre class="programlisting language-terminal">$ tar xvf &lt;file&gt;</pre></li><li class="listitem"><p class="simpara">
							Place the <code class="literal">oc</code> binary in a directory that is on your <code class="literal">PATH</code>.
						</p><p class="simpara">
							To check your <code class="literal">PATH</code>, execute the following command:
						</p><pre class="programlisting language-terminal">$ echo $PATH</pre></li></ol></div><p>
					After you install the OpenShift CLI, it is available using the <code class="literal">oc</code> command:
				</p><pre class="programlisting language-terminal">$ oc &lt;command&gt;</pre><h5 id="installing-the-openshift-cli-on-windows">Installing the OpenShift CLI on Windows</h5><p>
					You can install the OpenShift CLI (<code class="literal">oc</code>) binary on Windows by using the following procedure.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <a class="link" href="https://access.redhat.com/downloads/content/290">OpenShift Container Platform downloads page</a> on the Red Hat Customer Portal.
						</li><li class="listitem">
							Select the appropriate version from the <span class="strong strong"><strong>Version</strong></span> drop-down list.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Download Now</strong></span> next to the <span class="strong strong"><strong>OpenShift v4.13 Windows Client</strong></span> entry and save the file.
						</li><li class="listitem">
							Unzip the archive with a ZIP program.
						</li><li class="listitem"><p class="simpara">
							Move the <code class="literal">oc</code> binary to a directory that is on your <code class="literal">PATH</code>.
						</p><p class="simpara">
							To check your <code class="literal">PATH</code>, open the command prompt and execute the following command:
						</p><pre class="programlisting language-terminal">C:\&gt; path</pre></li></ol></div><p>
					After you install the OpenShift CLI, it is available using the <code class="literal">oc</code> command:
				</p><pre class="programlisting language-terminal">C:\&gt; oc &lt;command&gt;</pre><h5 id="installing-the-openshift-cli-on-macos">Installing the OpenShift CLI on macOS</h5><p>
					You can install the OpenShift CLI (<code class="literal">oc</code>) binary on macOS by using the following procedure.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <a class="link" href="https://access.redhat.com/downloads/content/290">OpenShift Container Platform downloads page</a> on the Red Hat Customer Portal.
						</li><li class="listitem">
							Select the appropriate version from the <span class="strong strong"><strong>Version</strong></span> drop-down list.
						</li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Download Now</strong></span> next to the <span class="strong strong"><strong>OpenShift v4.13 macOS Client</strong></span> entry and save the file.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								For macOS arm64, choose the <span class="strong strong"><strong>OpenShift v4.13 macOS arm64 Client</strong></span> entry.
							</p></div></div></li><li class="listitem">
							Unpack and unzip the archive.
						</li><li class="listitem"><p class="simpara">
							Move the <code class="literal">oc</code> binary to a directory on your PATH.
						</p><p class="simpara">
							To check your <code class="literal">PATH</code>, open a terminal and execute the following command:
						</p><pre class="programlisting language-terminal">$ echo $PATH</pre></li></ol></div><p>
					After you install the OpenShift CLI, it is available using the <code class="literal">oc</code> command:
				</p><pre class="programlisting language-terminal">$ oc &lt;command&gt;</pre></section></section><section class="section" id="installation-adding-registry-pull-secret_samples-operator-alt-registry"><div class="titlepage"><div><div><h2 class="title">3.2. Configuring credentials that allow images to be mirrored</h2></div></div></div><p>
				Create a container image registry credentials file that allows mirroring images from Red Hat to your mirror.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You configured a mirror registry to use in your disconnected environment.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					Complete the following steps on the installation host:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Download your <code class="literal">registry.redhat.io</code> <a class="link" href="https://console.redhat.com/openshift/install/pull-secret">pull secret from the Red Hat OpenShift Cluster Manager</a>.
					</li><li class="listitem"><p class="simpara">
						Make a copy of your pull secret in JSON format:
					</p><pre class="programlisting language-terminal">$ cat ./pull-secret | jq . &gt; &lt;path&gt;/&lt;pull_secret_file_in_json&gt; <span id="CO1-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO1-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Specify the path to the folder to store the pull secret in and a name for the JSON file that you create.
							</div></dd></dl></div><p class="simpara">
						The contents of the file resemble the following example:
					</p><pre class="programlisting language-json">{
  "auths": {
    "cloud.openshift.com": {
      "auth": "b3BlbnNo...",
      "email": "you@example.com"
    },
    "quay.io": {
      "auth": "b3BlbnNo...",
      "email": "you@example.com"
    },
    "registry.connect.redhat.com": {
      "auth": "NTE3Njg5Nj...",
      "email": "you@example.com"
    },
    "registry.redhat.io": {
      "auth": "NTE3Njg5Nj...",
      "email": "you@example.com"
    }
  }
}</pre></li><li class="listitem"><p class="simpara">
						Generate the base64-encoded user name and password or token for your mirror registry:
					</p><pre class="programlisting language-terminal">$ echo -n '&lt;user_name&gt;:&lt;password&gt;' | base64 -w0 <span id="CO2-1"><!--Empty--></span><span class="callout">1</span>
BGVtbYk3ZHAtqXs=</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO2-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								For <code class="literal">&lt;user_name&gt;</code> and <code class="literal">&lt;password&gt;</code>, specify the user name and password that you configured for your registry.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Edit the JSON file and add a section that describes your registry to it:
					</p><pre class="programlisting language-json">  "auths": {
    "&lt;mirror_registry&gt;": { <span id="CO3-1"><!--Empty--></span><span class="callout">1</span>
      "auth": "&lt;credentials&gt;", <span id="CO3-2"><!--Empty--></span><span class="callout">2</span>
      "email": "you@example.com"
    }
  },</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO3-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								For <code class="literal">&lt;mirror_registry&gt;</code>, specify the registry domain name, and optionally the port, that your mirror registry uses to serve content. For example, <code class="literal">registry.example.com</code> or <code class="literal">registry.example.com:8443</code>
							</div></dd><dt><a href="#CO3-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								For <code class="literal">&lt;credentials&gt;</code>, specify the base64-encoded user name and password for the mirror registry.
							</div></dd></dl></div><p class="simpara">
						The file resembles the following example:
					</p><pre class="programlisting language-json">{
  "auths": {
    "registry.example.com": {
      "auth": "BGVtbYk3ZHAtqXs=",
      "email": "you@example.com"
    },
    "cloud.openshift.com": {
      "auth": "b3BlbnNo...",
      "email": "you@example.com"
    },
    "quay.io": {
      "auth": "b3BlbnNo...",
      "email": "you@example.com"
    },
    "registry.connect.redhat.com": {
      "auth": "NTE3Njg5Nj...",
      "email": "you@example.com"
    },
    "registry.redhat.io": {
      "auth": "NTE3Njg5Nj...",
      "email": "you@example.com"
    }
  }
}</pre></li></ol></div></section><section class="section" id="installation-mirror-repository_samples-operator-alt-registry"><div class="titlepage"><div><div><h2 class="title">3.3. Mirroring the OpenShift Container Platform image repository</h2></div></div></div><p>
				Mirror the OpenShift Container Platform image repository to your registry to use during cluster installation or upgrade.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Your mirror host has access to the internet.
					</li><li class="listitem">
						You configured a mirror registry to use in your restricted network and can access the certificate and credentials that you configured.
					</li><li class="listitem">
						You downloaded the <a class="link" href="https://console.redhat.com/openshift/install/pull-secret">pull secret from the Red Hat OpenShift Cluster Manager</a> and modified it to include authentication to your mirror repository.
					</li><li class="listitem">
						If you use self-signed certificates, you have specified a Subject Alternative Name in the certificates.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					Complete the following steps on the mirror host:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Review the <a class="link" href="https://access.redhat.com/downloads/content/290/">OpenShift Container Platform downloads page</a> to determine the version of OpenShift Container Platform that you want to install and determine the corresponding tag on the <a class="link" href="https://quay.io/repository/openshift-release-dev/ocp-release?tab=tags">Repository Tags</a> page.
					</li><li class="listitem"><p class="simpara">
						Set the required environment variables:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Export the release version:
							</p><pre class="programlisting language-terminal">$ OCP_RELEASE=&lt;release_version&gt;</pre><p class="simpara">
								For <code class="literal">&lt;release_version&gt;</code>, specify the tag that corresponds to the version of OpenShift Container Platform to install, such as <code class="literal">4.5.4</code>.
							</p></li><li class="listitem"><p class="simpara">
								Export the local registry name and host port:
							</p><pre class="programlisting language-terminal">$ LOCAL_REGISTRY='&lt;local_registry_host_name&gt;:&lt;local_registry_host_port&gt;'</pre><p class="simpara">
								For <code class="literal">&lt;local_registry_host_name&gt;</code>, specify the registry domain name for your mirror repository, and for <code class="literal">&lt;local_registry_host_port&gt;</code>, specify the port that it serves content on.
							</p></li><li class="listitem"><p class="simpara">
								Export the local repository name:
							</p><pre class="programlisting language-terminal">$ LOCAL_REPOSITORY='&lt;local_repository_name&gt;'</pre><p class="simpara">
								For <code class="literal">&lt;local_repository_name&gt;</code>, specify the name of the repository to create in your registry, such as <code class="literal">ocp4/openshift4</code>.
							</p></li><li class="listitem"><p class="simpara">
								Export the name of the repository to mirror:
							</p><pre class="programlisting language-terminal">$ PRODUCT_REPO='openshift-release-dev'</pre><p class="simpara">
								For a production release, you must specify <code class="literal">openshift-release-dev</code>.
							</p></li><li class="listitem"><p class="simpara">
								Export the path to your registry pull secret:
							</p><pre class="programlisting language-terminal">$ LOCAL_SECRET_JSON='&lt;path_to_pull_secret&gt;'</pre><p class="simpara">
								For <code class="literal">&lt;path_to_pull_secret&gt;</code>, specify the absolute path to and file name of the pull secret for your mirror registry that you created.
							</p></li><li class="listitem"><p class="simpara">
								Export the release mirror:
							</p><pre class="programlisting language-terminal">$ RELEASE_NAME="ocp-release"</pre><p class="simpara">
								For a production release, you must specify <code class="literal">ocp-release</code>.
							</p></li><li class="listitem"><p class="simpara">
								Export the type of architecture for your cluster:
							</p><pre class="programlisting language-terminal">$ ARCHITECTURE=&lt;cluster_architecture&gt; <span id="CO4-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO4-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Specify the architecture of the cluster, such as <code class="literal">x86_64</code>, <code class="literal">aarch64</code>, <code class="literal">s390x</code>, or <code class="literal">ppc64le</code>.
									</div></dd></dl></div></li><li class="listitem"><p class="simpara">
								Export the path to the directory to host the mirrored images:
							</p><pre class="programlisting language-terminal">$ REMOVABLE_MEDIA_PATH=&lt;path&gt; <span id="CO5-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO5-1"><span class="callout">1</span></a> </dt><dd><div class="para">
										Specify the full path, including the initial forward slash (/) character.
									</div></dd></dl></div></li></ol></div></li><li class="listitem"><p class="simpara">
						Mirror the version images to the mirror registry:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								If your mirror host does not have internet access, take the following actions:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										Connect the removable media to a system that is connected to the internet.
									</li><li class="listitem"><p class="simpara">
										Review the images and configuration manifests to mirror:
									</p><pre class="programlisting language-terminal">$ oc adm release mirror -a ${LOCAL_SECRET_JSON}  \
     --from=quay.io/${PRODUCT_REPO}/${RELEASE_NAME}:${OCP_RELEASE}-${ARCHITECTURE} \
     --to=${LOCAL_REGISTRY}/${LOCAL_REPOSITORY} \
     --to-release-image=${LOCAL_REGISTRY}/${LOCAL_REPOSITORY}:${OCP_RELEASE}-${ARCHITECTURE} --dry-run</pre></li><li class="listitem">
										Record the entire <code class="literal">imageContentSources</code> section from the output of the previous command. The information about your mirrors is unique to your mirrored repository, and you must add the <code class="literal">imageContentSources</code> section to the <code class="literal">install-config.yaml</code> file during installation.
									</li><li class="listitem"><p class="simpara">
										Mirror the images to a directory on the removable media:
									</p><pre class="programlisting language-terminal">$ oc adm release mirror -a ${LOCAL_SECRET_JSON} --to-dir=${REMOVABLE_MEDIA_PATH}/mirror quay.io/${PRODUCT_REPO}/${RELEASE_NAME}:${OCP_RELEASE}-${ARCHITECTURE}</pre></li><li class="listitem"><p class="simpara">
										Take the media to the restricted network environment and upload the images to the local container registry.
									</p><pre class="programlisting language-terminal">$ oc image mirror -a ${LOCAL_SECRET_JSON} --from-dir=${REMOVABLE_MEDIA_PATH}/mirror "file://openshift/release:${OCP_RELEASE}*" ${LOCAL_REGISTRY}/${LOCAL_REPOSITORY} <span id="CO6-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO6-1"><span class="callout">1</span></a> </dt><dd><div class="para">
												For <code class="literal">REMOVABLE_MEDIA_PATH</code>, you must use the same path that you specified when you mirrored the images.
											</div></dd></dl></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
											Running <code class="literal">oc image mirror</code> might result in the following error: <code class="literal">error: unable to retrieve source image</code>. This error occurs when image indexes include references to images that no longer exist on the image registry. Image indexes might retain older references to allow users running those images an upgrade path to newer points on the upgrade graph. As a temporary workaround, you can use the <code class="literal">--skip-missing</code> option to bypass the error and continue downloading the image index. For more information, see <a class="link" href="https://access.redhat.com/solutions/6975305">Service Mesh Operator mirroring failed</a>.
										</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
								If the local container registry is connected to the mirror host, take the following actions:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem"><p class="simpara">
										Directly push the release images to the local registry by using following command:
									</p><pre class="programlisting language-terminal">$ oc adm release mirror -a ${LOCAL_SECRET_JSON}  \
     --from=quay.io/${PRODUCT_REPO}/${RELEASE_NAME}:${OCP_RELEASE}-${ARCHITECTURE} \
     --to=${LOCAL_REGISTRY}/${LOCAL_REPOSITORY} \
     --to-release-image=${LOCAL_REGISTRY}/${LOCAL_REPOSITORY}:${OCP_RELEASE}-${ARCHITECTURE}</pre><p class="simpara">
										This command pulls the release information as a digest, and its output includes the <code class="literal">imageContentSources</code> data that you require when you install your cluster.
									</p></li><li class="listitem"><p class="simpara">
										Record the entire <code class="literal">imageContentSources</code> section from the output of the previous command. The information about your mirrors is unique to your mirrored repository, and you must add the <code class="literal">imageContentSources</code> section to the <code class="literal">install-config.yaml</code> file during installation.
									</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											The image name gets patched to Quay.io during the mirroring process, and the podman images will show Quay.io in the registry on the bootstrap virtual machine.
										</p></div></div></li></ol></div></li></ul></div></li><li class="listitem"><p class="simpara">
						To create the installation program that is based on the content that you mirrored, extract it and pin it to the release:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								If your mirror host does not have internet access, run the following command:
							</p><pre class="programlisting language-terminal">$ oc adm release extract -a ${LOCAL_SECRET_JSON} --icsp-file=&lt;file&gt; \ --command=openshift-install "${LOCAL_REGISTRY}/${LOCAL_REPOSITORY}:${OCP_RELEASE}"</pre></li><li class="listitem"><p class="simpara">
								If the local container registry is connected to the mirror host, run the following command:
							</p><pre class="programlisting language-terminal">$ oc adm release extract -a ${LOCAL_SECRET_JSON} --command=openshift-install "${LOCAL_REGISTRY}/${LOCAL_REPOSITORY}:${OCP_RELEASE}-${ARCHITECTURE}"</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									To ensure that you use the correct images for the version of OpenShift Container Platform that you selected, you must extract the installation program from the mirrored content.
								</p><p>
									You must perform this step on a machine with an active internet connection.
								</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
						For clusters using installer-provisioned infrastructure, run the following command:
					</p><pre class="programlisting language-terminal">$ openshift-install</pre></li></ol></div></section><section class="section" id="installation-restricted-network-samples_samples-operator-alt-registry"><div class="titlepage"><div><div><h2 class="title">3.4. Using Cluster Samples Operator image streams with alternate or mirrored registries</h2></div></div></div><p>
				Most image streams in the <code class="literal">openshift</code> namespace managed by the Cluster Samples Operator point to images located in the Red Hat registry at <a class="link" href="https://registry.redhat.io">registry.redhat.io</a>.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The <code class="literal">cli</code>, <code class="literal">installer</code>, <code class="literal">must-gather</code>, and <code class="literal">tests</code> image streams, while part of the install payload, are not managed by the Cluster Samples Operator. These are not addressed in this procedure.
				</p></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The Cluster Samples Operator must be set to <code class="literal">Managed</code> in a disconnected environment. To install the image streams, you have a mirrored registry.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
					</li><li class="listitem">
						Create a pull secret for your mirror registry.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Access the images of a specific image stream to mirror, for example:
					</p><pre class="programlisting language-terminal">$ oc get is &lt;imagestream&gt; -n openshift -o json | jq .spec.tags[].from.name | grep registry.redhat.io</pre></li><li class="listitem"><p class="simpara">
						Mirror images from <a class="link" href="https://registry.redhat.io">registry.redhat.io</a> associated with any image streams you need
					</p><pre class="programlisting language-terminal">$ oc image mirror registry.redhat.io/rhscl/ruby-25-rhel7:latest ${MIRROR_ADDR}/rhscl/ruby-25-rhel7:latest</pre></li><li class="listitem"><p class="simpara">
						Create the cluster’s image configuration object:
					</p><pre class="programlisting language-terminal">$ oc create configmap registry-config --from-file=${MIRROR_ADDR_HOSTNAME}..5000=$path/ca.crt -n openshift-config</pre></li><li class="listitem"><p class="simpara">
						Add the required trusted CAs for the mirror in the cluster’s image configuration object:
					</p><pre class="programlisting language-terminal">$ oc patch image.config.openshift.io/cluster --patch '{"spec":{"additionalTrustedCA":{"name":"registry-config"}}}' --type=merge</pre></li><li class="listitem"><p class="simpara">
						Update the <code class="literal">samplesRegistry</code> field in the Cluster Samples Operator configuration object to contain the <code class="literal">hostname</code> portion of the mirror location defined in the mirror configuration:
					</p><pre class="programlisting language-terminal">$ oc edit configs.samples.operator.openshift.io -n openshift-cluster-samples-operator</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							This is required because the image stream import process does not use the mirror or search mechanism at this time.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Add any image streams that are not mirrored into the <code class="literal">skippedImagestreams</code> field of the Cluster Samples Operator configuration object. Or if you do not want to support any of the sample image streams, set the Cluster Samples Operator to <code class="literal">Removed</code> in the Cluster Samples Operator configuration object.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The Cluster Samples Operator issues alerts if image stream imports are failing but the Cluster Samples Operator is either periodically retrying or does not appear to be retrying them.
						</p></div></div><p class="simpara">
						Many of the templates in the <code class="literal">openshift</code> namespace reference the image streams. So using <code class="literal">Removed</code> to purge both the image streams and templates will eliminate the possibility of attempts to use them if they are not functional because of any missing image streams.
					</p></li></ol></div><section class="section" id="installation-images-samples-disconnected-mirroring-assist_samples-operator-alt-registry"><div class="titlepage"><div><div><h3 class="title">3.4.1. Cluster Samples Operator assistance for mirroring</h3></div></div></div><p>
					During installation, OpenShift Container Platform creates a config map named <code class="literal">imagestreamtag-to-image</code> in the <code class="literal">openshift-cluster-samples-operator</code> namespace. The <code class="literal">imagestreamtag-to-image</code> config map contains an entry, the populating image, for each image stream tag.
				</p><p>
					The format of the key for each entry in the data field in the config map is <code class="literal">&lt;image_stream_name&gt;_&lt;image_stream_tag_name&gt;</code>.
				</p><p>
					During a disconnected installation of OpenShift Container Platform, the status of the Cluster Samples Operator is set to <code class="literal">Removed</code>. If you choose to change it to <code class="literal">Managed</code>, it installs samples.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The use of samples in a network-restricted or discontinued environment may require access to services external to your network. Some example services include: Github, Maven Central, npm, RubyGems, PyPi and others. There might be additional steps to take that allow the cluster samples operators’s objects to reach the services they require.
					</p></div></div><p>
					You can use this config map as a reference for which images need to be mirrored for your image streams to import.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							While the Cluster Samples Operator is set to <code class="literal">Removed</code>, you can create your mirrored registry, or determine which existing mirrored registry you want to use.
						</li><li class="listitem">
							Mirror the samples you want to the mirrored registry using the new config map as your guide.
						</li><li class="listitem">
							Add any of the image streams you did not mirror to the <code class="literal">skippedImagestreams</code> list of the Cluster Samples Operator configuration object.
						</li><li class="listitem">
							Set <code class="literal">samplesRegistry</code> of the Cluster Samples Operator configuration object to the mirrored registry.
						</li><li class="listitem">
							Then set the Cluster Samples Operator to <code class="literal">Managed</code> to install the image streams you have mirrored.
						</li></ul></div><p>
					See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#installation-restricted-network-samples_samples-operator-alt-registry">Using Cluster Samples Operator image streams with alternate or mirrored registries</a> for a detailed procedure.
				</p></section></section></section><section class="chapter" id="creating-images"><div class="titlepage"><div><div><h1 class="title">Chapter 4. Creating images</h1></div></div></div><p>
			Learn how to create your own container images, based on pre-built images that are ready to help you. The process includes learning best practices for writing images, defining metadata for images, testing images, and using a custom builder workflow to create images to use with OpenShift Container Platform. After you create an image, you can push it to the OpenShift image registry.
		</p><section class="section" id="images-create-guidelines_create-images"><div class="titlepage"><div><div><h2 class="title">4.1. Learning container best practices</h2></div></div></div><p>
				When creating container images to run on OpenShift Container Platform there are a number of best practices to consider as an image author to ensure a good experience for consumers of those images. Because images are intended to be immutable and used as-is, the following guidelines help ensure that your images are highly consumable and easy to use on OpenShift Container Platform.
			</p><section class="section" id="images-create-guide-general_create-images"><div class="titlepage"><div><div><h3 class="title">4.1.1. General container image guidelines</h3></div></div></div><p>
					The following guidelines apply when creating a container image in general, and are independent of whether the images are used on OpenShift Container Platform.
				</p><h5 id="reuse-images">Reuse images</h5><p>
					Wherever possible, base your image on an appropriate upstream image using the <code class="literal">FROM</code> statement. This ensures your image can easily pick up security fixes from an upstream image when it is updated, rather than you having to update your dependencies directly.
				</p><p>
					In addition, use tags in the <code class="literal">FROM</code> instruction, for example, <code class="literal">rhel:rhel7</code>, to make it clear to users exactly which version of an image your image is based on. Using a tag other than <code class="literal">latest</code> ensures your image is not subjected to breaking changes that might go into the <code class="literal">latest</code> version of an upstream image.
				</p><h5 id="maintain-compatibility-within-tags">Maintain compatibility within tags</h5><p>
					When tagging your own images, try to maintain backwards compatibility within a tag. For example, if you provide an image named <code class="literal">foo</code> and it currently includes version <code class="literal">1.0</code>, you might provide a tag of <code class="literal">foo:v1</code>. When you update the image, as long as it continues to be compatible with the original image, you can continue to tag the new image <code class="literal">foo:v1</code>, and downstream consumers of this tag are able to get updates without being broken.
				</p><p>
					If you later release an incompatible update, then switch to a new tag, for example <code class="literal">foo:v2</code>. This allows downstream consumers to move up to the new version at will, but not be inadvertently broken by the new incompatible image. Any downstream consumer using <code class="literal">foo:latest</code> takes on the risk of any incompatible changes being introduced.
				</p><h5 id="avoid-multiple-processes">Avoid multiple processes</h5><p>
					Do not start multiple services, such as a database and <code class="literal">SSHD</code>, inside one container. This is not necessary because containers are lightweight and can be easily linked together for orchestrating multiple processes. OpenShift Container Platform allows you to easily colocate and co-manage related images by grouping them into a single pod.
				</p><p>
					This colocation ensures the containers share a network namespace and storage for communication. Updates are also less disruptive as each image can be updated less frequently and independently. Signal handling flows are also clearer with a single process as you do not have to manage routing signals to spawned processes.
				</p><h5 id="use-literal-exec-literal-in-wrapper-scripts">Use <code class="literal">exec</code> in wrapper scripts</h5><p>
					Many images use wrapper scripts to do some setup before starting a process for the software being run. If your image uses such a script, that script uses <code class="literal">exec</code> so that the script’s process is replaced by your software. If you do not use <code class="literal">exec</code>, then signals sent by your container runtime go to your wrapper script instead of your software’s process. This is not what you want.
				</p><p>
					If you have a wrapper script that starts a process for some server. You start your container, for example, using <code class="literal">podman run -i</code>, which runs the wrapper script, which in turn starts your process. If you want to close your container with <code class="literal">CTRL+C</code>. If your wrapper script used <code class="literal">exec</code> to start the server process, <code class="literal">podman</code> sends SIGINT to the server process, and everything works as you expect. If you did not use <code class="literal">exec</code> in your wrapper script, <code class="literal">podman</code> sends SIGINT to the process for the wrapper script and your process keeps running like nothing happened.
				</p><p>
					Also note that your process runs as <code class="literal">PID 1</code> when running in a container. This means that if your main process terminates, the entire container is stopped, canceling any child processes you launched from your <code class="literal">PID 1</code> process.
				</p><h5 id="clean-temporary-files">Clean temporary files</h5><p>
					Remove all temporary files you create during the build process. This also includes any files added with the <code class="literal">ADD</code> command. For example, run the <code class="literal">yum clean</code> command after performing <code class="literal">yum install</code> operations.
				</p><p>
					You can prevent the <code class="literal">yum</code> cache from ending up in an image layer by creating your <code class="literal">RUN</code> statement as follows:
				</p><pre class="programlisting language-terminal">RUN yum -y install mypackage &amp;&amp; yum -y install myotherpackage &amp;&amp; yum clean all -y</pre><p>
					Note that if you instead write:
				</p><pre class="programlisting language-terminal">RUN yum -y install mypackage
RUN yum -y install myotherpackage &amp;&amp; yum clean all -y</pre><p>
					Then the first <code class="literal">yum</code> invocation leaves extra files in that layer, and these files cannot be removed when the <code class="literal">yum clean</code> operation is run later. The extra files are not visible in the final image, but they are present in the underlying layers.
				</p><p>
					The current container build process does not allow a command run in a later layer to shrink the space used by the image when something was removed in an earlier layer. However, this may change in the future. This means that if you perform an <code class="literal">rm</code> command in a later layer, although the files are hidden it does not reduce the overall size of the image to be downloaded. Therefore, as with the <code class="literal">yum clean</code> example, it is best to remove files in the same command that created them, where possible, so they do not end up written to a layer.
				</p><p>
					In addition, performing multiple commands in a single <code class="literal">RUN</code> statement reduces the number of layers in your image, which improves download and extraction time.
				</p><h5 id="place-instructions-in-the-proper-order">Place instructions in the proper order</h5><p>
					The container builder reads the <code class="literal">Dockerfile</code> and runs the instructions from top to bottom. Every instruction that is successfully executed creates a layer which can be reused the next time this or another image is built. It is very important to place instructions that rarely change at the top of your <code class="literal">Dockerfile</code>. Doing so ensures the next builds of the same image are very fast because the cache is not invalidated by upper layer changes.
				</p><p>
					For example, if you are working on a <code class="literal">Dockerfile</code> that contains an <code class="literal">ADD</code> command to install a file you are iterating on, and a <code class="literal">RUN</code> command to <code class="literal">yum install</code> a package, it is best to put the <code class="literal">ADD</code> command last:
				</p><pre class="programlisting language-terminal">FROM foo
RUN yum -y install mypackage &amp;&amp; yum clean all -y
ADD myfile /test/myfile</pre><p>
					This way each time you edit <code class="literal">myfile</code> and rerun <code class="literal">podman build</code> or <code class="literal">docker build</code>, the system reuses the cached layer for the <code class="literal">yum</code> command and only generates the new layer for the <code class="literal">ADD</code> operation.
				</p><p>
					If instead you wrote the <code class="literal">Dockerfile</code> as:
				</p><pre class="programlisting language-terminal">FROM foo
ADD myfile /test/myfile
RUN yum -y install mypackage &amp;&amp; yum clean all -y</pre><p>
					Then each time you changed <code class="literal">myfile</code> and reran <code class="literal">podman build</code> or <code class="literal">docker build</code>, the <code class="literal">ADD</code> operation would invalidate the <code class="literal">RUN</code> layer cache, so the <code class="literal">yum</code> operation must be rerun as well.
				</p><h5 id="mark-important-ports">Mark important ports</h5><p>
					The EXPOSE instruction makes a port in the container available to the host system and other containers. While it is possible to specify that a port should be exposed with a <code class="literal">podman run</code> invocation, using the EXPOSE instruction in a <code class="literal">Dockerfile</code> makes it easier for both humans and software to use your image by explicitly declaring the ports your software needs to run:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Exposed ports show up under <code class="literal">podman ps</code> associated with containers created from your image.
						</li><li class="listitem">
							Exposed ports are present in the metadata for your image returned by <code class="literal">podman inspect</code>.
						</li><li class="listitem">
							Exposed ports are linked when you link one container to another.
						</li></ul></div><h5 id="set-environment-variables">Set environment variables</h5><p>
					It is good practice to set environment variables with the <code class="literal">ENV</code> instruction. One example is to set the version of your project. This makes it easy for people to find the version without looking at the <code class="literal">Dockerfile</code>. Another example is advertising a path on the system that could be used by another process, such as <code class="literal">JAVA_HOME</code>.
				</p><h5 id="avoid-default-passwords">Avoid default passwords</h5><p>
					Avoid setting default passwords. Many people extend the image and forget to remove or change the default password. This can lead to security issues if a user in production is assigned a well-known password. Passwords are configurable using an environment variable instead.
				</p><p>
					If you do choose to set a default password, ensure that an appropriate warning message is displayed when the container is started. The message should inform the user of the value of the default password and explain how to change it, such as what environment variable to set.
				</p><h5 id="avoid-sshd">Avoid sshd</h5><p>
					It is best to avoid running <code class="literal">sshd</code> in your image. You can use the <code class="literal">podman exec</code> or <code class="literal">docker exec</code> command to access containers that are running on the local host. Alternatively, you can use the <code class="literal">oc exec</code> command or the <code class="literal">oc rsh</code> command to access containers that are running on the OpenShift Container Platform cluster. Installing and running <code class="literal">sshd</code> in your image opens up additional vectors for attack and requirements for security patching.
				</p><h5 id="use-volumes-for-persistent-data">Use volumes for persistent data</h5><p>
					Images use a <a class="link" href="https://docs.docker.com/reference/builder/#volume">volume</a> for persistent data. This way OpenShift Container Platform mounts the network storage to the node running the container, and if the container moves to a new node the storage is reattached to that node. By using the volume for all persistent storage needs, the content is preserved even if the container is restarted or moved. If your image writes data to arbitrary locations within the container, that content could not be preserved.
				</p><p>
					All data that needs to be preserved even after the container is destroyed must be written to a volume. Container engines support a <code class="literal">readonly</code> flag for containers, which can be used to strictly enforce good practices about not writing data to ephemeral storage in a container. Designing your image around that capability now makes it easier to take advantage of it later.
				</p><p>
					Explicitly defining volumes in your <code class="literal">Dockerfile</code> makes it easy for consumers of the image to understand what volumes they must define when running your image.
				</p><p>
					See the <a class="link" href="https://kubernetes.io/docs/concepts/storage/volumes/">Kubernetes documentation</a> for more information on how volumes are used in OpenShift Container Platform.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Even with persistent volumes, each instance of your image has its own volume, and the filesystem is not shared between instances. This means the volume cannot be used to share state in a cluster.
					</p></div></div></section><section class="section" id="images-create-guide-openshift_create-images"><div class="titlepage"><div><div><h3 class="title">4.1.2. OpenShift Container Platform-specific guidelines</h3></div></div></div><p>
					The following are guidelines that apply when creating container images specifically for use on OpenShift Container Platform.
				</p><section class="section" id="enable-images-for-source-to-image_create-images"><div class="titlepage"><div><div><h4 class="title">4.1.2.1. Enable images for source-to-image (S2I)</h4></div></div></div><p>
						For images that are intended to run application code provided by a third party, such as a Ruby image designed to run Ruby code provided by a developer, you can enable your image to work with the <a class="link" href="https://github.com/openshift/source-to-image">Source-to-Image (S2I)</a> build tool. S2I is a framework that makes it easy to write images that take application source code as an input and produce a new image that runs the assembled application as output.
					</p></section><section class="section" id="use-uid_create-images"><div class="titlepage"><div><div><h4 class="title">4.1.2.2. Support arbitrary user ids</h4></div></div></div><p>
						By default, OpenShift Container Platform runs containers using an arbitrarily assigned user ID. This provides additional security against processes escaping the container due to a container engine vulnerability and thereby achieving escalated permissions on the host node.
					</p><p>
						For an image to support running as an arbitrary user, directories and files that are written to by processes in the image must be owned by the root group and be read/writable by that group. Files to be executed must also have group execute permissions.
					</p><p>
						Adding the following to your Dockerfile sets the directory and file permissions to allow users in the root group to access them in the built image:
					</p><pre class="programlisting language-terminal">RUN chgrp -R 0 /some/directory &amp;&amp; \
    chmod -R g=u /some/directory</pre><p>
						Because the container user is always a member of the root group, the container user can read and write these files.
					</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							Care must be taken when altering the directories and file permissions of sensitive areas of a container, which is no different than to a normal system.
						</p><p>
							If applied to sensitive areas, such as <code class="literal">/etc/passwd</code>, this can allow the modification of such files by unintended users potentially exposing the container or host. CRI-O supports the insertion of arbitrary user IDs into the container’s <code class="literal">/etc/passwd</code>, so changing permissions is never required.
						</p></div></div><p>
						In addition, the processes running in the container must not listen on privileged ports, ports below 1024, since they are not running as a privileged user.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							If your S2I image does not include a <code class="literal">USER</code> declaration with a numeric user, your builds fail by default. To allow images that use either named users or the root <code class="literal">0</code> user to build in OpenShift Container Platform, you can add the project’s builder service account, <code class="literal">system:serviceaccount:&lt;your-project&gt;:builder</code>, to the <code class="literal">anyuid</code> security context constraint (SCC). Alternatively, you can allow all images to run as any user.
						</p></div></div></section><section class="section" id="use-services_create-images"><div class="titlepage"><div><div><h4 class="title">4.1.2.3. Use services for inter-image communication</h4></div></div></div><p>
						For cases where your image needs to communicate with a service provided by another image, such as a web front end image that needs to access a database image to store and retrieve data, your image consumes an OpenShift Container Platform service. Services provide a static endpoint for access which does not change as containers are stopped, started, or moved. In addition, services provide load balancing for requests.
					</p></section><section class="section" id="provide-common-libraries_create-images"><div class="titlepage"><div><div><h4 class="title">4.1.2.4. Provide common libraries</h4></div></div></div><p>
						For images that are intended to run application code provided by a third party, ensure that your image contains commonly used libraries for your platform. In particular, provide database drivers for common databases used with your platform. For example, provide JDBC drivers for MySQL and PostgreSQL if you are creating a Java framework image. Doing so prevents the need for common dependencies to be downloaded during application assembly time, speeding up application image builds. It also simplifies the work required by application developers to ensure all of their dependencies are met.
					</p></section><section class="section" id="use-env-vars_create-images"><div class="titlepage"><div><div><h4 class="title">4.1.2.5. Use environment variables for configuration</h4></div></div></div><p>
						Users of your image are able to configure it without having to create a downstream image based on your image. This means that the runtime configuration is handled using environment variables. For a simple configuration, the running process can consume the environment variables directly. For a more complicated configuration or for runtimes which do not support this, configure the runtime by defining a template configuration file that is processed during startup. During this processing, values supplied using environment variables can be substituted into the configuration file or used to make decisions about what options to set in the configuration file.
					</p><p>
						It is also possible and recommended to pass secrets such as certificates and keys into the container using environment variables. This ensures that the secret values do not end up committed in an image and leaked into a container image registry.
					</p><p>
						Providing environment variables allows consumers of your image to customize behavior, such as database settings, passwords, and performance tuning, without having to introduce a new layer on top of your image. Instead, they can simply define environment variable values when defining a pod and change those settings without rebuilding the image.
					</p><p>
						For extremely complex scenarios, configuration can also be supplied using volumes that would be mounted into the container at runtime. However, if you elect to do it this way you must ensure that your image provides clear error messages on startup when the necessary volume or configuration is not present.
					</p><p>
						This topic is related to the Using Services for Inter-image Communication topic in that configuration like datasources are defined in terms of environment variables that provide the service endpoint information. This allows an application to dynamically consume a datasource service that is defined in the OpenShift Container Platform environment without modifying the application image.
					</p><p>
						In addition, tuning is done by inspecting the <code class="literal">cgroups</code> settings for the container. This allows the image to tune itself to the available memory, CPU, and other resources. For example, Java-based images tune their heap based on the <code class="literal">cgroup</code> maximum memory parameter to ensure they do not exceed the limits and get an out-of-memory error.
					</p></section><section class="section" id="set-image-metadata_create-images"><div class="titlepage"><div><div><h4 class="title">4.1.2.6. Set image metadata</h4></div></div></div><p>
						Defining image metadata helps OpenShift Container Platform better consume your container images, allowing OpenShift Container Platform to create a better experience for developers using your image. For example, you can add metadata to provide helpful descriptions of your image, or offer suggestions on other images that are needed.
					</p></section><section class="section" id="clustering_create-images"><div class="titlepage"><div><div><h4 class="title">4.1.2.7. Clustering</h4></div></div></div><p>
						You must fully understand what it means to run multiple instances of your image. In the simplest case, the load balancing function of a service handles routing traffic to all instances of your image. However, many frameworks must share information to perform leader election or failover state; for example, in session replication.
					</p><p>
						Consider how your instances accomplish this communication when running in OpenShift Container Platform. Although pods can communicate directly with each other, their IP addresses change anytime the pod starts, stops, or is moved. Therefore, it is important for your clustering scheme to be dynamic.
					</p></section><section class="section" id="logging_create-images"><div class="titlepage"><div><div><h4 class="title">4.1.2.8. Logging</h4></div></div></div><p>
						It is best to send all logging to standard out. OpenShift Container Platform collects standard out from containers and sends it to the centralized logging service where it can be viewed. If you must separate log content, prefix the output with an appropriate keyword, which makes it possible to filter the messages.
					</p><p>
						If your image logs to a file, users must use manual operations to enter the running container and retrieve or view the log file.
					</p></section><section class="section" id="liveness-and-readiness-probes_create-images"><div class="titlepage"><div><div><h4 class="title">4.1.2.9. Liveness and readiness probes</h4></div></div></div><p>
						Document example liveness and readiness probes that can be used with your image. These probes allow users to deploy your image with confidence that traffic is not be routed to the container until it is prepared to handle it, and that the container is restarted if the process gets into an unhealthy state.
					</p></section><section class="section" id="templates_create-images"><div class="titlepage"><div><div><h4 class="title">4.1.2.10. Templates</h4></div></div></div><p>
						Consider providing an example template with your image. A template gives users an easy way to quickly get your image deployed with a working configuration. Your template must include the liveness and readiness probes you documented with the image, for completeness.
					</p></section></section></section><section class="section" id="images-create-metadata_create-images"><div class="titlepage"><div><div><h2 class="title">4.2. Including metadata in images</h2></div></div></div><p>
				Defining image metadata helps OpenShift Container Platform better consume your container images, allowing OpenShift Container Platform to create a better experience for developers using your image. For example, you can add metadata to provide helpful descriptions of your image, or offer suggestions on other images that may also be needed.
			</p><p>
				This topic only defines the metadata needed by the current set of use cases. Additional metadata or use cases may be added in the future.
			</p><section class="section" id="defining-image-metadata"><div class="titlepage"><div><div><h3 class="title">4.2.1. Defining image metadata</h3></div></div></div><p>
					You can use the <code class="literal">LABEL</code> instruction in a <code class="literal">Dockerfile</code> to define image metadata. Labels are similar to environment variables in that they are key value pairs attached to an image or a container. Labels are different from environment variable in that they are not visible to the running application and they can also be used for fast look-up of images and containers.
				</p><p>
					<a class="link" href="https://docs.docker.com/engine/reference/builder/#label">Docker documentation</a> for more information on the <code class="literal">LABEL</code> instruction.
				</p><p>
					The label names are typically namespaced. The namespace is set accordingly to reflect the project that is going to pick up the labels and use them. For OpenShift Container Platform the namespace is set to <code class="literal">io.openshift</code> and for Kubernetes the namespace is <code class="literal">io.k8s</code>.
				</p><p>
					See the <a class="link" href="https://docs.docker.com/engine/userguide/labels-custom-metadata">Docker custom metadata</a> documentation for details about the format.
				</p><div class="table" id="idm140424681696656"><p class="title"><strong>Table 4.1. Supported Metadata</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 27%; " class="col_1"><!--Empty--></col><col style="width: 73%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140424681691824" scope="col">Variable</th><th align="left" valign="top" id="idm140424681690736" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140424681691824"> <p>
									<code class="literal">io.openshift.tags</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424681690736"> <p>
									This label contains a list of tags represented as a list of comma-separated string values. The tags are the way to categorize the container images into broad areas of functionality. Tags help UI and generation tools to suggest relevant container images during the application creation process.
								</p>
								 
<pre class="screen">LABEL io.openshift.tags   mongodb,mongodb24,nosql</pre>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424681691824"> <p>
									<code class="literal">io.openshift.wants</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424681690736"> <p>
									Specifies a list of tags that the generation tools and the UI uses to provide relevant suggestions if you do not have the container images with specified tags already. For example, if the container image wants <code class="literal">mysql</code> and <code class="literal">redis</code> and you do not have the container image with <code class="literal">redis</code> tag, then UI can suggest you to add this image into your deployment.
								</p>
								 
<pre class="screen">LABEL io.openshift.wants   mongodb,redis</pre>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424681691824"> <p>
									<code class="literal">io.k8s.description</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424681690736"> <p>
									This label can be used to give the container image consumers more detailed information about the service or functionality this image provides. The UI can then use this description together with the container image name to provide more human friendly information to end users.
								</p>
								 
<pre class="screen">LABEL io.k8s.description The MySQL 5.5 Server with master-slave replication support</pre>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424681691824"> <p>
									<code class="literal">io.openshift.non-scalable</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424681690736"> <p>
									An image can use this variable to suggest that it does not support scaling. The UI then communicates this to consumers of that image. Being not-scalable means that the value of <code class="literal">replicas</code> should initially not be set higher than <code class="literal">1</code>.
								</p>
								 
<pre class="screen">LABEL io.openshift.non-scalable     true</pre>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424681691824"> <p>
									<code class="literal">io.openshift.min-memory</code> and <code class="literal">io.openshift.min-cpu</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424681690736"> <p>
									This label suggests how much resources the container image needs to work properly. The UI can warn the user that deploying this container image may exceed their user quota. The values must be compatible with Kubernetes quantity.
								</p>
								 
<pre class="screen">LABEL io.openshift.min-memory 16Gi
LABEL io.openshift.min-cpu     4</pre>
								 </td></tr></tbody></table></div></div></section></section><section class="section" id="images-create-s2i_create-images"><div class="titlepage"><div><div><h2 class="title">4.3. Creating images from source code with source-to-image</h2></div></div></div><p>
				Source-to-image (S2I) is a framework that makes it easy to write images that take application source code as an input and produce a new image that runs the assembled application as output.
			</p><p>
				The main advantage of using S2I for building reproducible container images is the ease of use for developers. As a builder image author, you must understand two basic concepts in order for your images to provide the best S2I performance, the build process and S2I scripts.
			</p><section class="section" id="images-create-s2i-build_create-images"><div class="titlepage"><div><div><h3 class="title">4.3.1. Understanding the source-to-image build process</h3></div></div></div><p>
					The build process consists of the following three fundamental elements, which are combined into a final container image:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Sources
						</li><li class="listitem">
							Source-to-image (S2I) scripts
						</li><li class="listitem">
							Builder image
						</li></ul></div><p>
					S2I generates a Dockerfile with the builder image as the first <code class="literal">FROM</code> instruction. The Dockerfile generated by S2I is then passed to Buildah.
				</p></section><section class="section" id="images-create-s2i-scripts_create-images"><div class="titlepage"><div><div><h3 class="title">4.3.2. How to write source-to-image scripts</h3></div></div></div><p>
					You can write source-to-image (S2I) scripts in any programming language, as long as the scripts are executable inside the builder image. S2I supports multiple options providing <code class="literal">assemble</code>/<code class="literal">run</code>/<code class="literal">save-artifacts</code> scripts. All of these locations are checked on each build in the following order:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							A script specified in the build configuration.
						</li><li class="listitem">
							A script found in the application source <code class="literal">.s2i/bin</code> directory.
						</li><li class="listitem">
							A script found at the default image URL with the <code class="literal">io.openshift.s2i.scripts-url</code> label.
						</li></ol></div><p>
					Both the <code class="literal">io.openshift.s2i.scripts-url</code> label specified in the image and the script specified in a build configuration can take one of the following forms:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">image:///path_to_scripts_dir</code>: absolute path inside the image to a directory where the S2I scripts are located.
						</li><li class="listitem">
							<code class="literal">file:///path_to_scripts_dir</code>: relative or absolute path to a directory on the host where the S2I scripts are located.
						</li><li class="listitem">
							<code class="literal">http(s)://path_to_scripts_dir</code>: URL to a directory where the S2I scripts are located.
						</li></ul></div><div class="table" id="idm140424672649408"><p class="title"><strong>Table 4.2. S2I scripts</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 27%; " class="col_1"><!--Empty--></col><col style="width: 73%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140424672644576" scope="col">Script</th><th align="left" valign="top" id="idm140424672643488" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140424672644576"> <p>
									<code class="literal">assemble</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424672643488"> <p>
									The <code class="literal">assemble</code> script builds the application artifacts from a source and places them into appropriate directories inside the image. This script is required. The workflow for this script is:
								</p>
								 <div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
											Optional: Restore build artifacts. If you want to support incremental builds, make sure to define <code class="literal">save-artifacts</code> as well.
										</li><li class="listitem">
											Place the application source in the desired location.
										</li><li class="listitem">
											Build the application artifacts.
										</li><li class="listitem">
											Install the artifacts into locations appropriate for them to run.
										</li></ol></div>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424672644576"> <p>
									<code class="literal">run</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424672643488"> <p>
									The <code class="literal">run</code> script executes your application. This script is required.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424672644576"> <p>
									<code class="literal">save-artifacts</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424672643488"> <p>
									The <code class="literal">save-artifacts</code> script gathers all dependencies that can speed up the build processes that follow. This script is optional. For example:
								</p>
								 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											For Ruby, <code class="literal">gems</code> installed by Bundler.
										</li><li class="listitem">
											For Java, <code class="literal">.m2</code> contents.
										</li></ul></div>
								 <p>
									These dependencies are gathered into a <code class="literal">tar</code> file and streamed to the standard output.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424672644576"> <p>
									<code class="literal">usage</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424672643488"> <p>
									The <code class="literal">usage</code> script allows you to inform the user how to properly use your image. This script is optional.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424672644576"> <p>
									<code class="literal">test/run</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424672643488"> <p>
									The <code class="literal">test/run</code> script allows you to create a process to check if the image is working correctly. This script is optional. The proposed flow of that process is:
								</p>
								 <div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
											Build the image.
										</li><li class="listitem">
											Run the image to verify the <code class="literal">usage</code> script.
										</li><li class="listitem">
											Run <code class="literal">s2i build</code> to verify the <code class="literal">assemble</code> script.
										</li><li class="listitem">
											Optional: Run <code class="literal">s2i build</code> again to verify the <code class="literal">save-artifacts</code> and <code class="literal">assemble</code> scripts save and restore artifacts functionality.
										</li><li class="listitem">
											Run the image to verify the test application is working.
										</li></ol></div>
								 <div class="admonition note"><div class="admonition_header">Note</div><div><p>
										The suggested location to put the test application built by your <code class="literal">test/run</code> script is the <code class="literal">test/test-app</code> directory in your image repository.
									</p></div></div>
								 </td></tr></tbody></table></div></div><p>
					<span class="strong strong"><strong>Example S2I scripts</strong></span>
				</p><p>
					The following example S2I scripts are written in Bash. Each example assumes its <code class="literal">tar</code> contents are unpacked into the <code class="literal">/tmp/s2i</code> directory.
				</p><div class="formalpara"><p class="title"><strong><code class="literal">assemble</code> script:</strong></p><p>
						
<pre class="programlisting language-bash">#!/bin/bash

# restore build artifacts
if [ "$(ls /tmp/s2i/artifacts/ 2&gt;/dev/null)" ]; then
    mv /tmp/s2i/artifacts/* $HOME/.
fi

# move the application source
mv /tmp/s2i/src $HOME/src

# build application artifacts
pushd ${HOME}
make all

# install the artifacts
make install
popd</pre>

					</p></div><div class="formalpara"><p class="title"><strong><code class="literal">run</code> script:</strong></p><p>
						
<pre class="programlisting language-bash">#!/bin/bash

# run the application
/opt/application/run.sh</pre>

					</p></div><div class="formalpara"><p class="title"><strong><code class="literal">save-artifacts</code> script:</strong></p><p>
						
<pre class="programlisting language-bash">#!/bin/bash

pushd ${HOME}
if [ -d deps ]; then
    # all deps contents to tar stream
    tar cf - deps
fi
popd</pre>

					</p></div><div class="formalpara"><p class="title"><strong><code class="literal">usage</code> script:</strong></p><p>
						
<pre class="programlisting language-bash">#!/bin/bash

# inform the user how to use the image
cat &lt;&lt;EOF
This is a S2I sample builder image, to use it, install
https://github.com/openshift/source-to-image
EOF</pre>

					</p></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://blog.openshift.com/create-s2i-builder-image/">S2I Image Creation Tutorial</a>
						</li></ul></div></section></section><section class="section" id="images-test-s2i_create-images"><div class="titlepage"><div><div><h2 class="title">4.4. About testing source-to-image images</h2></div></div></div><p>
				As an Source-to-Image (S2I) builder image author, you can test your S2I image locally and use the OpenShift Container Platform build system for automated testing and continuous integration.
			</p><p>
				S2I requires the <code class="literal">assemble</code> and <code class="literal">run</code> scripts to be present to successfully run the S2I build. Providing the <code class="literal">save-artifacts</code> script reuses the build artifacts, and providing the <code class="literal">usage</code> script ensures that usage information is printed to console when someone runs the container image outside of the S2I.
			</p><p>
				The goal of testing an S2I image is to make sure that all of these described commands work properly, even if the base container image has changed or the tooling used by the commands was updated.
			</p><section class="section" id="images-test-s2i-testing-requirements_create-images"><div class="titlepage"><div><div><h3 class="title">4.4.1. Understanding testing requirements</h3></div></div></div><p>
					The standard location for the <code class="literal">test</code> script is <code class="literal">test/run</code>. This script is invoked by the OpenShift Container Platform S2I image builder and it could be a simple Bash script or a static Go binary.
				</p><p>
					The <code class="literal">test/run</code> script performs the S2I build, so you must have the S2I binary available in your <code class="literal">$PATH</code>. If required, follow the installation instructions in the <a class="link" href="https://github.com/openshift/source-to-image/blob/master/README.md#installation">S2I README</a>.
				</p><p>
					S2I combines the application source code and builder image, so to test it you need a sample application source to verify that the source successfully transforms into a runnable container image. The sample application should be simple, but it should exercise the crucial steps of <code class="literal">assemble</code> and <code class="literal">run</code> scripts.
				</p></section><section class="section" id="images-test-s2i-generating-scripts-and-tools_create-images"><div class="titlepage"><div><div><h3 class="title">4.4.2. Generating scripts and tools</h3></div></div></div><p>
					The S2I tooling comes with powerful generation tools to speed up the process of creating a new S2I image. The <code class="literal">s2i create</code> command produces all the necessary S2I scripts and testing tools along with the <code class="literal">Makefile</code>:
				</p><pre class="programlisting language-termnal">$ s2i create _&lt;image name&gt;_ _&lt;destination directory&gt;_</pre><p>
					The generated <code class="literal">test/run</code> script must be adjusted to be useful, but it provides a good starting point to begin developing.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The <code class="literal">test/run</code> script produced by the <code class="literal">s2i create</code> command requires that the sample application sources are inside the <code class="literal">test/test-app</code> directory.
					</p></div></div></section><section class="section" id="images-test-s21-testing-locally_create-images"><div class="titlepage"><div><div><h3 class="title">4.4.3. Testing locally</h3></div></div></div><p>
					The easiest way to run the S2I image tests locally is to use the generated <code class="literal">Makefile</code>.
				</p><p>
					If you did not use the <code class="literal">s2i create</code> command, you can copy the following <code class="literal">Makefile</code> template and replace the <code class="literal">IMAGE_NAME</code> parameter with your image name.
				</p><div class="formalpara"><p class="title"><strong>Sample <code class="literal">Makefile</code></strong></p><p>
						
<pre class="screen">IMAGE_NAME = openshift/ruby-20-centos7
CONTAINER_ENGINE := $(shell command -v podman 2&gt; /dev/null | echo docker)

build:
	${CONTAINER_ENGINE} build -t $(IMAGE_NAME) .

.PHONY: test
test:
	${CONTAINER_ENGINE} build -t $(IMAGE_NAME)-candidate .
	IMAGE_NAME=$(IMAGE_NAME)-candidate test/run</pre>

					</p></div></section><section class="section" id="images-test-s21-basic-testing-workflow_create-images"><div class="titlepage"><div><div><h3 class="title">4.4.4. Basic testing workflow</h3></div></div></div><p>
					The <code class="literal">test</code> script assumes you have already built the image you want to test. If required, first build the S2I image. Run one of the following commands:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							If you use Podman, run the following command:
						</p><pre class="programlisting language-terminal">$ podman build -t &lt;builder_image_name&gt;</pre></li><li class="listitem"><p class="simpara">
							If you use Docker, run the following command:
						</p><pre class="programlisting language-terminal">$ docker build -t &lt;builder_image_name&gt;</pre></li></ul></div><p>
					The following steps describe the default workflow to test S2I image builders:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Verify the <code class="literal">usage</code> script is working:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									If you use Podman, run the following command:
								</p><pre class="programlisting language-terminal">$ podman run &lt;builder_image_name&gt; .</pre></li><li class="listitem"><p class="simpara">
									If you use Docker, run the following command:
								</p><pre class="programlisting language-terminal">$ docker run &lt;builder_image_name&gt; .</pre></li></ul></div></li><li class="listitem"><p class="simpara">
							Build the image:
						</p><pre class="programlisting language-terminal">$ s2i build file:///path-to-sample-app _&lt;BUILDER_IMAGE_NAME&gt;_ _&lt;OUTPUT_APPLICATION_IMAGE_NAME&gt;_</pre></li><li class="listitem">
							Optional: if you support <code class="literal">save-artifacts</code>, run step 2 once again to verify that saving and restoring artifacts works properly.
						</li><li class="listitem"><p class="simpara">
							Run the container:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									If you use Podman, run the following command:
								</p><pre class="programlisting language-terminal">$ podman run &lt;output_application_image_name&gt;</pre></li><li class="listitem"><p class="simpara">
									If you use Docker, run the following command:
								</p><pre class="programlisting language-terminal">$ docker run &lt;output_application_image_name&gt;</pre></li></ul></div></li><li class="listitem">
							Verify the container is running and the application is responding.
						</li></ol></div><p>
					Running these steps is generally enough to tell if the builder image is working as expected.
				</p></section><section class="section" id="images-test-s21-using-openshift-for-building-the-image_create-images"><div class="titlepage"><div><div><h3 class="title">4.4.5. Using OpenShift Container Platform for building the image</h3></div></div></div><p>
					Once you have a <code class="literal">Dockerfile</code> and the other artifacts that make up your new S2I builder image, you can put them in a git repository and use OpenShift Container Platform to build and push the image. Define a Docker build that points to your repository.
				</p><p>
					If your OpenShift Container Platform instance is hosted on a public IP address, the build can be triggered each time you push into your S2I builder image GitHub repository.
				</p><p>
					You can also use the <code class="literal">ImageChangeTrigger</code> to trigger a rebuild of your applications that are based on the S2I builder image you updated.
				</p></section></section></section><section class="chapter" id="managing-images"><div class="titlepage"><div><div><h1 class="title">Chapter 5. Managing images</h1></div></div></div><section class="section" id="managing-images-overview"><div class="titlepage"><div><div><h2 class="title">5.1. Managing images overview</h2></div></div></div><p>
				With OpenShift Container Platform you can interact with images and set up image streams, depending on where the registries of the images are located, any authentication requirements around those registries, and how you want your builds and deployments to behave.
			</p><section class="section" id="images-managing-overview_managing-images-overview"><div class="titlepage"><div><div><h3 class="title">5.1.1. Images overview</h3></div></div></div><p>
					An image stream comprises any number of container images identified by tags. It presents a single virtual view of related images, similar to a container image repository.
				</p><p>
					By watching an image stream, builds and deployments can receive notifications when new images are added or modified and react by performing a build or deployment, respectively.
				</p></section></section><section class="section" id="tagging-images"><div class="titlepage"><div><div><h2 class="title">5.2. Tagging images</h2></div></div></div><p>
				The following sections provide an overview and instructions for using image tags in the context of container images for working with OpenShift Container Platform image streams and their tags.
			</p><section class="section" id="images-tag_tagging-images"><div class="titlepage"><div><div><h3 class="title">5.2.1. Image tags</h3></div></div></div><p>
					An image tag is a label applied to a container image in a repository that distinguishes a specific image from other images in an image stream. Typically, the tag represents a version number of some sort. For example, here <code class="literal">:v3.11.59-2</code> is the tag:
				</p><pre class="programlisting language-text">registry.access.redhat.com/openshift3/jenkins-2-rhel7:v3.11.59-2</pre><p>
					You can add additional tags to an image. For example, an image might be assigned the tags <code class="literal">:v3.11.59-2</code> and <code class="literal">:latest</code>.
				</p><p>
					OpenShift Container Platform provides the <code class="literal">oc tag</code> command, which is similar to the <code class="literal">docker tag</code> command, but operates on image streams instead of directly on images.
				</p></section><section class="section" id="images-tagging-conventions_tagging-images"><div class="titlepage"><div><div><h3 class="title">5.2.2. Image tag conventions</h3></div></div></div><p>
					Images evolve over time and their tags reflect this. Generally, an image tag always points to the latest image built.
				</p><p>
					If there is too much information embedded in a tag name, like <code class="literal">v2.0.1-may-2019</code>, the tag points to just one revision of an image and is never updated. Using default image pruning options, such an image is never removed. In very large clusters, the schema of creating new tags for every revised image could eventually fill up the etcd datastore with excess tag metadata for images that are long outdated.
				</p><p>
					If the tag is named <code class="literal">v2.0</code>, image revisions are more likely. This results in longer tag history and, therefore, the image pruner is more likely to remove old and unused images.
				</p><p>
					Although tag naming convention is up to you, here are a few examples in the format <code class="literal">&lt;image_name&gt;:&lt;image_tag&gt;</code>:
				</p><div class="table" id="idm140424673011680"><p class="title"><strong>Table 5.1. Image tag naming conventions</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140424681628928" scope="col">Description</th><th align="left" valign="top" id="idm140424681627840" scope="col">Example</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140424681628928"> <p>
									Revision
								</p>
								 </td><td align="left" valign="top" headers="idm140424681627840"> <p>
									<code class="literal">myimage:v2.0.1</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424681628928"> <p>
									Architecture
								</p>
								 </td><td align="left" valign="top" headers="idm140424681627840"> <p>
									<code class="literal">myimage:v2.0-x86_64</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424681628928"> <p>
									Base image
								</p>
								 </td><td align="left" valign="top" headers="idm140424681627840"> <p>
									<code class="literal">myimage:v1.2-centos7</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424681628928"> <p>
									Latest (potentially unstable)
								</p>
								 </td><td align="left" valign="top" headers="idm140424681627840"> <p>
									<code class="literal">myimage:latest</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424681628928"> <p>
									Latest stable
								</p>
								 </td><td align="left" valign="top" headers="idm140424681627840"> <p>
									<code class="literal">myimage:stable</code>
								</p>
								 </td></tr></tbody></table></div></div><p>
					If you require dates in tag names, periodically inspect old and unsupported images and <code class="literal">istags</code> and remove them. Otherwise, you can experience increasing resource usage caused by retaining old images.
				</p></section><section class="section" id="images-add-tags-to-imagestreams_tagging-images"><div class="titlepage"><div><div><h3 class="title">5.2.3. Adding tags to image streams</h3></div></div></div><p>
					An image stream in OpenShift Container Platform comprises zero or more container images identified by tags.
				</p><p>
					There are different types of tags available. The default behavior uses a <code class="literal">permanent</code> tag, which points to a specific image in time. If the <code class="literal">permanent</code> tag is in use and the source changes, the tag does not change for the destination.
				</p><p>
					A <code class="literal">tracking</code> tag means the destination tag’s metadata is updated during the import of the source tag.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							You can add tags to an image stream using the <code class="literal">oc tag</code> command:
						</p><pre class="programlisting language-terminal">$ oc tag &lt;source&gt; &lt;destination&gt;</pre><p class="simpara">
							For example, to configure the <code class="literal">ruby</code> image stream <code class="literal">static-2.0</code> tag to always refer to the current image for the <code class="literal">ruby</code> image stream <code class="literal">2.0</code> tag:
						</p><pre class="programlisting language-terminal">$ oc tag ruby:2.0 ruby:static-2.0</pre><p class="simpara">
							This creates a new image stream tag named <code class="literal">static-2.0</code> in the <code class="literal">ruby</code> image stream. The new tag directly references the image id that the <code class="literal">ruby:2.0</code> image stream tag pointed to at the time <code class="literal">oc tag</code> was run, and the image it points to never changes.
						</p></li><li class="listitem"><p class="simpara">
							To ensure the destination tag is updated when the source tag changes, use the <code class="literal">--alias=true</code> flag:
						</p><pre class="programlisting language-terminal">$ oc tag --alias=true &lt;source&gt; &lt;destination&gt;</pre></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Use a tracking tag for creating permanent aliases, for example, <code class="literal">latest</code> or <code class="literal">stable</code>. The tag only works correctly within a single image stream. Trying to create a cross-image stream alias produces an error.
					</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							You can also add the <code class="literal">--scheduled=true</code> flag to have the destination tag be refreshed, or re-imported, periodically. The period is configured globally at the system level.
						</li><li class="listitem"><p class="simpara">
							The <code class="literal">--reference</code> flag creates an image stream tag that is not imported. The tag points to the source location, permanently.
						</p><p class="simpara">
							If you want to instruct OpenShift Container Platform to always fetch the tagged image from the integrated registry, use <code class="literal">--reference-policy=local</code>. The registry uses the pull-through feature to serve the image to the client. By default, the image blobs are mirrored locally by the registry. As a result, they can be pulled more quickly the next time they are needed. The flag also allows for pulling from insecure registries without a need to supply <code class="literal">--insecure-registry</code> to the container runtime as long as the image stream has an insecure annotation or the tag has an insecure import policy.
						</p></li></ul></div></section><section class="section" id="images-remove-tag-imagestream_tagging-images"><div class="titlepage"><div><div><h3 class="title">5.2.4. Removing tags from image streams</h3></div></div></div><p>
					You can remove tags from an image stream.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To remove a tag completely from an image stream run:
						</p><pre class="programlisting language-terminal">$ oc delete istag/ruby:latest</pre><p class="simpara">
							or:
						</p><pre class="programlisting language-terminal">$ oc tag -d ruby:latest</pre></li></ul></div></section><section class="section" id="images-referencing-images-imagestreams_tagging-images"><div class="titlepage"><div><div><h3 class="title">5.2.5. Referencing images in imagestreams</h3></div></div></div><p>
					You can use tags to reference images in image streams using the following reference types.
				</p><div class="table" id="idm140424671585936"><p class="title"><strong>Table 5.2. Imagestream reference types</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140424671580352" scope="col">Reference type</th><th align="left" valign="top" id="idm140424671579264" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140424671580352"> <p>
									<code class="literal">ImageStreamTag</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424671579264"> <p>
									An <code class="literal">ImageStreamTag</code> is used to reference or retrieve an image for a given image stream and tag.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424671580352"> <p>
									<code class="literal">ImageStreamImage</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424671579264"> <p>
									An <code class="literal">ImageStreamImage</code> is used to reference or retrieve an image for a given image stream and image <code class="literal">sha</code> ID.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424671580352"> <p>
									<code class="literal">DockerImage</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424671579264"> <p>
									A <code class="literal">DockerImage</code> is used to reference or retrieve an image for a given external registry. It uses standard Docker <code class="literal">pull specification</code> for its name.
								</p>
								 </td></tr></tbody></table></div></div><p>
					When viewing example image stream definitions you may notice they contain definitions of <code class="literal">ImageStreamTag</code> and references to <code class="literal">DockerImage</code>, but nothing related to <code class="literal">ImageStreamImage</code>.
				</p><p>
					This is because the <code class="literal">ImageStreamImage</code> objects are automatically created in OpenShift Container Platform when you import or tag an image into the image stream. You should never have to explicitly define an <code class="literal">ImageStreamImage</code> object in any image stream definition that you use to create image streams.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To reference an image for a given image stream and tag, use <code class="literal">ImageStreamTag</code>:
						</p><pre class="screen">&lt;image_stream_name&gt;:&lt;tag&gt;</pre></li><li class="listitem"><p class="simpara">
							To reference an image for a given image stream and image <code class="literal">sha</code> ID, use <code class="literal">ImageStreamImage</code>:
						</p><pre class="screen">&lt;image_stream_name&gt;@&lt;id&gt;</pre><p class="simpara">
							The <code class="literal">&lt;id&gt;</code> is an immutable identifier for a specific image, also called a digest.
						</p></li><li class="listitem"><p class="simpara">
							To reference or retrieve an image for a given external registry, use <code class="literal">DockerImage</code>:
						</p><pre class="screen">openshift/ruby-20-centos7:2.0</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								When no tag is specified, it is assumed the <code class="literal">latest</code> tag is used.
							</p></div></div><p class="simpara">
							You can also reference a third-party registry:
						</p><pre class="screen">registry.redhat.io/rhel7:latest</pre><p class="simpara">
							Or an image with a digest:
						</p><pre class="screen">centos/ruby-22-centos7@sha256:3a335d7d8a452970c5b4054ad7118ff134b3a6b50a2bb6d0c07c746e8986b28e</pre></li></ul></div></section></section><section class="section" id="image-pull-policy"><div class="titlepage"><div><div><h2 class="title">5.3. Image pull policy</h2></div></div></div><p>
				Each container in a pod has a container image. After you have created an image and pushed it to a registry, you can then refer to it in the pod.
			</p><section class="section" id="images-image-pull-policy-overview_image-pull-policy"><div class="titlepage"><div><div><h3 class="title">5.3.1. Image pull policy overview</h3></div></div></div><p>
					When OpenShift Container Platform creates containers, it uses the container <code class="literal">imagePullPolicy</code> to determine if the image should be pulled prior to starting the container. There are three possible values for <code class="literal">imagePullPolicy</code>:
				</p><div class="table" id="idm140424671642160"><p class="title"><strong>Table 5.3. <code class="literal">imagePullPolicy</code> values</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140424685231216" scope="col">Value</th><th align="left" valign="top" id="idm140424685230128" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140424685231216"> <p>
									<code class="literal">Always</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424685230128"> <p>
									Always pull the image.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424685231216"> <p>
									<code class="literal">IfNotPresent</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424685230128"> <p>
									Only pull the image if it does not already exist on the node.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424685231216"> <p>
									<code class="literal">Never</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424685230128"> <p>
									Never pull the image.
								</p>
								 </td></tr></tbody></table></div></div><p>
					If a container <code class="literal">imagePullPolicy</code> parameter is not specified, OpenShift Container Platform sets it based on the image tag:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							If the tag is <code class="literal">latest</code>, OpenShift Container Platform defaults <code class="literal">imagePullPolicy</code> to <code class="literal">Always</code>.
						</li><li class="listitem">
							Otherwise, OpenShift Container Platform defaults <code class="literal">imagePullPolicy</code> to <code class="literal">IfNotPresent</code>.
						</li></ol></div></section></section><section class="section" id="using-image-pull-secrets"><div class="titlepage"><div><div><h2 class="title">5.4. Using image pull secrets</h2></div></div></div><p>
				If you are using the OpenShift image registry and are pulling from image streams located in the same project, then your pod service account should already have the correct permissions and no additional action should be required.
			</p><p>
				However, for other scenarios, such as referencing images across OpenShift Container Platform projects or from secured registries, then additional configuration steps are required.
			</p><p>
				You can obtain the image <a class="link" href="https://console.redhat.com/openshift/install/pull-secret">pull secret from the Red Hat OpenShift Cluster Manager</a>. This pull secret is called <code class="literal">pullSecret</code>.
			</p><p>
				You use this pull secret to authenticate with the services that are provided by the included authorities, <a class="link" href="https://quay.io/">Quay.io</a> and <a class="link" href="https://registry.redhat.io">registry.redhat.io</a>, which serve the container images for OpenShift Container Platform components.
			</p><section class="section" id="images-allow-pods-to-reference-images-across-projects_using-image-pull-secrets"><div class="titlepage"><div><div><h3 class="title">5.4.1. Allowing pods to reference images across projects</h3></div></div></div><p>
					When using the OpenShift image registry, to allow pods in <code class="literal">project-a</code> to reference images in <code class="literal">project-b</code>, a service account in <code class="literal">project-a</code> must be bound to the <code class="literal">system:image-puller</code> role in <code class="literal">project-b</code>.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						When you create a pod service account or a namespace, wait until the service account is provisioned with a docker pull secret; if you create a pod before its service account is fully provisioned, the pod fails to access the OpenShift image registry.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To allow pods in <code class="literal">project-a</code> to reference images in <code class="literal">project-b</code>, bind a service account in <code class="literal">project-a</code> to the <code class="literal">system:image-puller</code> role in <code class="literal">project-b</code>:
						</p><pre class="programlisting language-terminal">$ oc policy add-role-to-user \
    system:image-puller system:serviceaccount:project-a:default \
    --namespace=project-b</pre><p class="simpara">
							After adding that role, the pods in <code class="literal">project-a</code> that reference the default service account are able to pull images from <code class="literal">project-b</code>.
						</p></li><li class="listitem"><p class="simpara">
							To allow access for any service account in <code class="literal">project-a</code>, use the group:
						</p><pre class="programlisting language-terminal">$ oc policy add-role-to-group \
    system:image-puller system:serviceaccounts:project-a \
    --namespace=project-b</pre></li></ol></div></section><section class="section" id="images-allow-pods-to-reference-images-from-secure-registries_using-image-pull-secrets"><div class="titlepage"><div><div><h3 class="title">5.4.2. Allowing pods to reference images from other secured registries</h3></div></div></div><p>
					The <code class="literal">.dockercfg</code> <code class="literal">$HOME/.docker/config.json</code> file for Docker clients is a Docker credentials file that stores your authentication information if you have previously logged into a secured or insecure registry.
				</p><p>
					To pull a secured container image that is not from OpenShift image registry, you must create a pull secret from your Docker credentials and add it to your service account.
				</p><p>
					The Docker credentials file and the associated pull secret can contain multiple references to the same registry, each with its own set of credentials.
				</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">config.json</code> file</strong></p><p>
						
<pre class="programlisting language-json">{
   "auths":{
      "cloud.openshift.com":{
         "auth":"b3Blb=",
         "email":"you@example.com"
      },
      "quay.io":{
         "auth":"b3Blb=",
         "email":"you@example.com"
      },
      "quay.io/repository-main":{
         "auth":"b3Blb=",
         "email":"you@example.com"
      }
   }
}</pre>

					</p></div><div class="formalpara"><p class="title"><strong>Example pull secret</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: v1
data:
  .dockerconfigjson: ewogICAiYXV0aHMiOnsKICAgICAgIm0iOnsKICAgICAgIsKICAgICAgICAgImF1dGgiOiJiM0JsYj0iLAogICAgICAgICAiZW1haWwiOiJ5b3VAZXhhbXBsZS5jb20iCiAgICAgIH0KICAgfQp9Cg==
kind: Secret
metadata:
  creationTimestamp: "2021-09-09T19:10:11Z"
  name: pull-secret
  namespace: default
  resourceVersion: "37676"
  uid: e2851531-01bc-48ba-878c-de96cfe31020
type: Opaque</pre>

					</p></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							If you already have a <code class="literal">.dockercfg</code> file for the secured registry, you can create a secret from that file by running:
						</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;pull_secret_name&gt; \
    --from-file=.dockercfg=&lt;path/to/.dockercfg&gt; \
    --type=kubernetes.io/dockercfg</pre></li><li class="listitem"><p class="simpara">
							Or if you have a <code class="literal">$HOME/.docker/config.json</code> file:
						</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;pull_secret_name&gt; \
    --from-file=.dockerconfigjson=&lt;path/to/.docker/config.json&gt; \
    --type=kubernetes.io/dockerconfigjson</pre></li><li class="listitem"><p class="simpara">
							If you do not already have a Docker credentials file for the secured registry, you can create a secret by running:
						</p><pre class="programlisting language-terminal">$ oc create secret docker-registry &lt;pull_secret_name&gt; \
    --docker-server=&lt;registry_server&gt; \
    --docker-username=&lt;user_name&gt; \
    --docker-password=&lt;password&gt; \
    --docker-email=&lt;email&gt;</pre></li><li class="listitem"><p class="simpara">
							To use a secret for pulling images for pods, you must add the secret to your service account. The name of the service account in this example should match the name of the service account the pod uses. The default service account is <code class="literal">default</code>:
						</p><pre class="programlisting language-terminal">$ oc secrets link default &lt;pull_secret_name&gt; --for=pull</pre></li></ul></div><section class="section" id="images-pulling-from-private-registries_using-image-pull-secrets"><div class="titlepage"><div><div><h4 class="title">5.4.2.1. Pulling from private registries with delegated authentication</h4></div></div></div><p>
						A private registry can delegate authentication to a separate service. In these cases, image pull secrets must be defined for both the authentication and registry endpoints.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a secret for the delegated authentication server:
							</p><pre class="programlisting language-terminal">$ oc create secret docker-registry \
    --docker-server=sso.redhat.com \
    --docker-username=developer@example.com \
    --docker-password=******** \
    --docker-email=unused \
    redhat-connect-sso

secret/redhat-connect-sso</pre></li><li class="listitem"><p class="simpara">
								Create a secret for the private registry:
							</p><pre class="programlisting language-terminal">$ oc create secret docker-registry \
    --docker-server=privateregistry.example.com \
    --docker-username=developer@example.com \
    --docker-password=******** \
    --docker-email=unused \
    private-registry

secret/private-registry</pre></li></ol></div></section></section><section class="section" id="images-update-global-pull-secret_using-image-pull-secrets"><div class="titlepage"><div><div><h3 class="title">5.4.3. Updating the global cluster pull secret</h3></div></div></div><p>
					You can update the global pull secret for your cluster by either replacing the current pull secret or appending a new pull secret.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						To transfer your cluster to another owner, you must first initiate the transfer in <a class="link" href="https://console.redhat.com/openshift">OpenShift Cluster Manager Hybrid Cloud Console</a>, and then update the pull secret on the cluster. Updating a cluster’s pull secret without initiating the transfer in OpenShift Cluster Manager causes the cluster to stop reporting Telemetry metrics in OpenShift Cluster Manager.
					</p><p>
						For more information <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_cluster_manager/2021/html/managing_clusters/assembly-managing-clusters#transferring-cluster-ownership_assembly-managing-clusters">about transferring cluster ownership</a>, see "Transferring cluster ownership" in the Red Hat OpenShift Cluster Manager documentation.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Optional: To append a new pull secret to the existing pull secret, complete the following steps:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Enter the following command to download the pull secret:
								</p><pre class="programlisting language-terminal">$ oc get secret/pull-secret -n openshift-config --template='{{index .data ".dockerconfigjson" | base64decode}}' &gt;&lt;pull_secret_location&gt; <span id="CO7-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO7-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Provide the path to the pull secret file.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Enter the following command to add the new pull secret:
								</p><pre class="programlisting language-terminal">$ oc registry login --registry="&lt;registry&gt;" \ <span id="CO8-1"><!--Empty--></span><span class="callout">1</span>
--auth-basic="&lt;username&gt;:&lt;password&gt;" \ <span id="CO8-2"><!--Empty--></span><span class="callout">2</span>
--to=&lt;pull_secret_location&gt; <span id="CO8-3"><!--Empty--></span><span class="callout">3</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO8-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Provide the new registry. You can include multiple repositories within the same registry, for example: <code class="literal">--registry="&lt;registry/my-namespace/my-repository&gt;"</code>.
										</div></dd><dt><a href="#CO8-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Provide the credentials of the new registry.
										</div></dd><dt><a href="#CO8-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Provide the path to the pull secret file.
										</div></dd></dl></div><p class="simpara">
									Alternatively, you can perform a manual update to the pull secret file.
								</p></li></ol></div></li><li class="listitem"><p class="simpara">
							Enter the following command to update the global pull secret for your cluster:
						</p><pre class="programlisting language-terminal">$ oc set data secret/pull-secret -n openshift-config --from-file=.dockerconfigjson=&lt;pull_secret_location&gt; <span id="CO9-1"><!--Empty--></span><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO9-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Provide the path to the new pull secret file.
								</div></dd></dl></div><p class="simpara">
							This update is rolled out to all nodes, which can take some time depending on the size of your cluster.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								As of OpenShift Container Platform 4.7.4, changes to the global pull secret no longer trigger a node drain or reboot.
							</p></div></div></li></ol></div></section></section></section><section class="chapter" id="managing-image-streams"><div class="titlepage"><div><div><h1 class="title">Chapter 6. Managing image streams</h1></div></div></div><p>
			Image streams provide a means of creating and updating container images in an on-going way. As improvements are made to an image, tags can be used to assign new version numbers and keep track of changes. This document describes how image streams are managed.
		</p><section class="section" id="images-imagestream-use_image-streams-managing"><div class="titlepage"><div><div><h2 class="title">6.1. Why use imagestreams</h2></div></div></div><p>
				An image stream and its associated tags provide an abstraction for referencing container images from within OpenShift Container Platform. The image stream and its tags allow you to see what images are available and ensure that you are using the specific image you need even if the image in the repository changes.
			</p><p>
				Image streams do not contain actual image data, but present a single virtual view of related images, similar to an image repository.
			</p><p>
				You can configure builds and deployments to watch an image stream for notifications when new images are added and react by performing a build or deployment, respectively.
			</p><p>
				For example, if a deployment is using a certain image and a new version of that image is created, a deployment could be automatically performed to pick up the new version of the image.
			</p><p>
				However, if the image stream tag used by the deployment or build is not updated, then even if the container image in the container image registry is updated, the build or deployment continues using the previous, presumably known good image.
			</p><p>
				The source images can be stored in any of the following:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						OpenShift Container Platform’s integrated registry.
					</li><li class="listitem">
						An external registry, for example registry.redhat.io or quay.io.
					</li><li class="listitem">
						Other image streams in the OpenShift Container Platform cluster.
					</li></ul></div><p>
				When you define an object that references an image stream tag, such as a build or deployment configuration, you point to an image stream tag and not the repository. When you build or deploy your application, OpenShift Container Platform queries the repository using the image stream tag to locate the associated ID of the image and uses that exact image.
			</p><p>
				The image stream metadata is stored in the etcd instance along with other cluster information.
			</p><p>
				Using image streams has several significant benefits:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						You can tag, rollback a tag, and quickly deal with images, without having to re-push using the command line.
					</li><li class="listitem">
						You can trigger builds and deployments when a new image is pushed to the registry. Also, OpenShift Container Platform has generic triggers for other resources, such as Kubernetes objects.
					</li><li class="listitem">
						You can mark a tag for periodic re-import. If the source image has changed, that change is picked up and reflected in the image stream, which triggers the build or deployment flow, depending upon the build or deployment configuration.
					</li><li class="listitem">
						You can share images using fine-grained access control and quickly distribute images across your teams.
					</li><li class="listitem">
						If the source image changes, the image stream tag still points to a known-good version of the image, ensuring that your application do not break unexpectedly.
					</li><li class="listitem">
						You can configure security around who can view and use the images through permissions on the image stream objects.
					</li><li class="listitem">
						Users that lack permission to read or list images on the cluster level can still retrieve the images tagged in a project using image streams.
					</li></ul></div></section><section class="section" id="images-imagestream-configure_image-streams-managing"><div class="titlepage"><div><div><h2 class="title">6.2. Configuring image streams</h2></div></div></div><p>
				An <code class="literal">ImageStream</code> object file contains the following elements.
			</p><div id="image-stream-object-definition_image-streams-managing" class="formalpara"><p class="title"><strong>Imagestream object definition</strong></p><p>
					
<pre class="programlisting language-yaml">apiVersion: image.openshift.io/v1
kind: ImageStream
metadata:
  annotations:
    openshift.io/generated-by: OpenShiftNewApp
  labels:
    app: ruby-sample-build
    template: application-template-stibuild
  name: origin-ruby-sample <span id="CO10-1"><!--Empty--></span><span class="callout">1</span>
  namespace: test
spec: {}
status:
  dockerImageRepository: 172.30.56.218:5000/test/origin-ruby-sample <span id="CO10-2"><!--Empty--></span><span class="callout">2</span>
  tags:
  - items:
    - created: 2017-09-02T10:15:09Z
      dockerImageReference: 172.30.56.218:5000/test/origin-ruby-sample@sha256:47463d94eb5c049b2d23b03a9530bf944f8f967a0fe79147dd6b9135bf7dd13d <span id="CO10-3"><!--Empty--></span><span class="callout">3</span>
      generation: 2
      image: sha256:909de62d1f609a717ec433cc25ca5cf00941545c83a01fb31527771e1fab3fc5 <span id="CO10-4"><!--Empty--></span><span class="callout">4</span>
    - created: 2017-09-01T13:40:11Z
      dockerImageReference: 172.30.56.218:5000/test/origin-ruby-sample@sha256:909de62d1f609a717ec433cc25ca5cf00941545c83a01fb31527771e1fab3fc5
      generation: 1
      image: sha256:47463d94eb5c049b2d23b03a9530bf944f8f967a0fe79147dd6b9135bf7dd13d
    tag: latest <span id="CO10-5"><!--Empty--></span><span class="callout">5</span></pre>

				</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO10-1"><span class="callout">1</span></a> </dt><dd><div class="para">
						The name of the image stream.
					</div></dd><dt><a href="#CO10-2"><span class="callout">2</span></a> </dt><dd><div class="para">
						Docker repository path where new images can be pushed to add or update them in this image stream.
					</div></dd><dt><a href="#CO10-3"><span class="callout">3</span></a> </dt><dd><div class="para">
						The SHA identifier that this image stream tag currently references. Resources that reference this image stream tag use this identifier.
					</div></dd><dt><a href="#CO10-4"><span class="callout">4</span></a> </dt><dd><div class="para">
						The SHA identifier that this image stream tag previously referenced. Can be used to rollback to an older image.
					</div></dd><dt><a href="#CO10-5"><span class="callout">5</span></a> </dt><dd><div class="para">
						The image stream tag name.
					</div></dd></dl></div></section><section class="section" id="images-using-imagestream-images_image-streams-managing"><div class="titlepage"><div><div><h2 class="title">6.3. Image stream images</h2></div></div></div><p>
				An image stream image points from within an image stream to a particular image ID.
			</p><p>
				Image stream images allow you to retrieve metadata about an image from a particular image stream where it is tagged.
			</p><p>
				Image stream image objects are automatically created in OpenShift Container Platform whenever you import or tag an image into the image stream. You should never have to explicitly define an image stream image object in any image stream definition that you use to create image streams.
			</p><p>
				The image stream image consists of the image stream name and image ID from the repository, delimited by an <code class="literal">@</code> sign:
			</p><pre class="screen">&lt;image-stream-name&gt;@&lt;image-id&gt;</pre><p>
				To refer to the image in the <code class="literal">ImageStream</code> object example, the image stream image looks like:
			</p><pre class="screen">origin-ruby-sample@sha256:47463d94eb5c049b2d23b03a9530bf944f8f967a0fe79147dd6b9135bf7dd13d</pre></section><section class="section" id="images-using-imagestream-tags_image-streams-managing"><div class="titlepage"><div><div><h2 class="title">6.4. Image stream tags</h2></div></div></div><p>
				An image stream tag is a named pointer to an image in an image stream. It is abbreviated as <code class="literal">istag</code>. An image stream tag is used to reference or retrieve an image for a given image stream and tag.
			</p><p>
				Image stream tags can reference any local or externally managed image. It contains a history of images represented as a stack of all images the tag ever pointed to. Whenever a new or existing image is tagged under particular image stream tag, it is placed at the first position in the history stack. The image previously occupying the top position is available at the second position. This allows for easy rollbacks to make tags point to historical images again.
			</p><p>
				The following image stream tag is from an <code class="literal">ImageStream</code> object:
			</p><div class="formalpara"><p class="title"><strong>Image stream tag with two images in its history</strong></p><p>
					
<pre class="programlisting language-yaml">  tags:
  - items:
    - created: 2017-09-02T10:15:09Z
      dockerImageReference: 172.30.56.218:5000/test/origin-ruby-sample@sha256:47463d94eb5c049b2d23b03a9530bf944f8f967a0fe79147dd6b9135bf7dd13d
      generation: 2
      image: sha256:909de62d1f609a717ec433cc25ca5cf00941545c83a01fb31527771e1fab3fc5
    - created: 2017-09-01T13:40:11Z
      dockerImageReference: 172.30.56.218:5000/test/origin-ruby-sample@sha256:909de62d1f609a717ec433cc25ca5cf00941545c83a01fb31527771e1fab3fc5
      generation: 1
      image: sha256:47463d94eb5c049b2d23b03a9530bf944f8f967a0fe79147dd6b9135bf7dd13d
    tag: latest</pre>

				</p></div><p>
				Image stream tags can be permanent tags or tracking tags.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Permanent tags are version-specific tags that point to a particular version of an image, such as Python 3.5.
					</li><li class="listitem"><p class="simpara">
						Tracking tags are reference tags that follow another image stream tag and can be updated to change which image they follow, like a symlink. These new levels are not guaranteed to be backwards-compatible.
					</p><p class="simpara">
						For example, the <code class="literal">latest</code> image stream tags that ship with OpenShift Container Platform are tracking tags. This means consumers of the <code class="literal">latest</code> image stream tag are updated to the newest level of the framework provided by the image when a new level becomes available. A <code class="literal">latest</code> image stream tag to <code class="literal">v3.10</code> can be changed to <code class="literal">v3.11</code> at any time. It is important to be aware that these <code class="literal">latest</code> image stream tags behave differently than the Docker <code class="literal">latest</code> tag. The <code class="literal">latest</code> image stream tag, in this case, does not point to the latest image in the Docker repository. It points to another image stream tag, which might not be the latest version of an image. For example, if the <code class="literal">latest</code> image stream tag points to <code class="literal">v3.10</code> of an image, when the <code class="literal">3.11</code> version is released, the <code class="literal">latest</code> tag is not automatically updated to <code class="literal">v3.11</code>, and remains at <code class="literal">v3.10</code> until it is manually updated to point to a <code class="literal">v3.11</code> image stream tag.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Tracking tags are limited to a single image stream and cannot reference other image streams.
						</p></div></div></li></ul></div><p>
				You can create your own image stream tags for your own needs.
			</p><p>
				The image stream tag is composed of the name of the image stream and a tag, separated by a colon:
			</p><pre class="screen">&lt;imagestream name&gt;:&lt;tag&gt;</pre><p>
				For example, to refer to the <code class="literal">sha256:47463d94eb5c049b2d23b03a9530bf944f8f967a0fe79147dd6b9135bf7dd13d</code> image in the <code class="literal">ImageStream</code> object example earlier, the image stream tag would be:
			</p><pre class="screen">origin-ruby-sample:latest</pre></section><section class="section" id="images-using-imagestream-change-triggers_image-streams-managing"><div class="titlepage"><div><div><h2 class="title">6.5. Image stream change triggers</h2></div></div></div><p>
				Image stream triggers allow your builds and deployments to be automatically invoked when a new version of an upstream image is available.
			</p><p>
				For example, builds and deployments can be automatically started when an image stream tag is modified. This is achieved by monitoring that particular image stream tag and notifying the build or deployment when a change is detected.
			</p></section><section class="section" id="images-imagestream-mapping_image-streams-managing"><div class="titlepage"><div><div><h2 class="title">6.6. Image stream mapping</h2></div></div></div><p>
				When the integrated registry receives a new image, it creates and sends an image stream mapping to OpenShift Container Platform, providing the image’s project, name, tag, and image metadata.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Configuring image stream mappings is an advanced feature.
				</p></div></div><p>
				This information is used to create a new image, if it does not already exist, and to tag the image into the image stream. OpenShift Container Platform stores complete metadata about each image, such as commands, entry point, and environment variables. Images in OpenShift Container Platform are immutable and the maximum name length is 63 characters.
			</p><p>
				The following image stream mapping example results in an image being tagged as <code class="literal">test/origin-ruby-sample:latest</code>:
			</p><div class="formalpara"><p class="title"><strong>Image stream mapping object definition</strong></p><p>
					
<pre class="programlisting language-yaml">apiVersion: image.openshift.io/v1
kind: ImageStreamMapping
metadata:
  creationTimestamp: null
  name: origin-ruby-sample
  namespace: test
tag: latest
image:
  dockerImageLayers:
  - name: sha256:5f70bf18a086007016e948b04aed3b82103a36bea41755b6cddfaf10ace3c6ef
    size: 0
  - name: sha256:ee1dd2cb6df21971f4af6de0f1d7782b81fb63156801cfde2bb47b4247c23c29
    size: 196634330
  - name: sha256:5f70bf18a086007016e948b04aed3b82103a36bea41755b6cddfaf10ace3c6ef
    size: 0
  - name: sha256:5f70bf18a086007016e948b04aed3b82103a36bea41755b6cddfaf10ace3c6ef
    size: 0
  - name: sha256:ca062656bff07f18bff46be00f40cfbb069687ec124ac0aa038fd676cfaea092
    size: 177723024
  - name: sha256:63d529c59c92843c395befd065de516ee9ed4995549f8218eac6ff088bfa6b6e
    size: 55679776
  - name: sha256:92114219a04977b5563d7dff71ec4caa3a37a15b266ce42ee8f43dba9798c966
    size: 11939149
  dockerImageMetadata:
    Architecture: amd64
    Config:
      Cmd:
      - /usr/libexec/s2i/run
      Entrypoint:
      - container-entrypoint
      Env:
      - RACK_ENV=production
      - OPENSHIFT_BUILD_NAMESPACE=test
      - OPENSHIFT_BUILD_SOURCE=https://github.com/openshift/ruby-hello-world.git
      - EXAMPLE=sample-app
      - OPENSHIFT_BUILD_NAME=ruby-sample-build-1
      - PATH=/opt/app-root/src/bin:/opt/app-root/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
      - STI_SCRIPTS_URL=image:///usr/libexec/s2i
      - STI_SCRIPTS_PATH=/usr/libexec/s2i
      - HOME=/opt/app-root/src
      - BASH_ENV=/opt/app-root/etc/scl_enable
      - ENV=/opt/app-root/etc/scl_enable
      - PROMPT_COMMAND=. /opt/app-root/etc/scl_enable
      - RUBY_VERSION=2.2
      ExposedPorts:
        8080/tcp: {}
      Labels:
        build-date: 2015-12-23
        io.k8s.description: Platform for building and running Ruby 2.2 applications
        io.k8s.display-name: 172.30.56.218:5000/test/origin-ruby-sample:latest
        io.openshift.build.commit.author: Ben Parees &lt;bparees@users.noreply.github.com&gt;
        io.openshift.build.commit.date: Wed Jan 20 10:14:27 2016 -0500
        io.openshift.build.commit.id: 00cadc392d39d5ef9117cbc8a31db0889eedd442
        io.openshift.build.commit.message: 'Merge pull request #51 from php-coder/fix_url_and_sti'
        io.openshift.build.commit.ref: master
        io.openshift.build.image: centos/ruby-22-centos7@sha256:3a335d7d8a452970c5b4054ad7118ff134b3a6b50a2bb6d0c07c746e8986b28e
        io.openshift.build.source-location: https://github.com/openshift/ruby-hello-world.git
        io.openshift.builder-base-version: 8d95148
        io.openshift.builder-version: 8847438ba06307f86ac877465eadc835201241df
        io.openshift.s2i.scripts-url: image:///usr/libexec/s2i
        io.openshift.tags: builder,ruby,ruby22
        io.s2i.scripts-url: image:///usr/libexec/s2i
        license: GPLv2
        name: CentOS Base Image
        vendor: CentOS
      User: "1001"
      WorkingDir: /opt/app-root/src
    Container: 86e9a4a3c760271671ab913616c51c9f3cea846ca524bf07c04a6f6c9e103a76
    ContainerConfig:
      AttachStdout: true
      Cmd:
      - /bin/sh
      - -c
      - tar -C /tmp -xf - &amp;&amp; /usr/libexec/s2i/assemble
      Entrypoint:
      - container-entrypoint
      Env:
      - RACK_ENV=production
      - OPENSHIFT_BUILD_NAME=ruby-sample-build-1
      - OPENSHIFT_BUILD_NAMESPACE=test
      - OPENSHIFT_BUILD_SOURCE=https://github.com/openshift/ruby-hello-world.git
      - EXAMPLE=sample-app
      - PATH=/opt/app-root/src/bin:/opt/app-root/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
      - STI_SCRIPTS_URL=image:///usr/libexec/s2i
      - STI_SCRIPTS_PATH=/usr/libexec/s2i
      - HOME=/opt/app-root/src
      - BASH_ENV=/opt/app-root/etc/scl_enable
      - ENV=/opt/app-root/etc/scl_enable
      - PROMPT_COMMAND=. /opt/app-root/etc/scl_enable
      - RUBY_VERSION=2.2
      ExposedPorts:
        8080/tcp: {}
      Hostname: ruby-sample-build-1-build
      Image: centos/ruby-22-centos7@sha256:3a335d7d8a452970c5b4054ad7118ff134b3a6b50a2bb6d0c07c746e8986b28e
      OpenStdin: true
      StdinOnce: true
      User: "1001"
      WorkingDir: /opt/app-root/src
    Created: 2016-01-29T13:40:00Z
    DockerVersion: 1.8.2.fc21
    Id: 9d7fd5e2d15495802028c569d544329f4286dcd1c9c085ff5699218dbaa69b43
    Parent: 57b08d979c86f4500dc8cad639c9518744c8dd39447c055a3517dc9c18d6fccd
    Size: 441976279
    apiVersion: "1.0"
    kind: DockerImage
  dockerImageMetadataVersion: "1.0"
  dockerImageReference: 172.30.56.218:5000/test/origin-ruby-sample@sha256:47463d94eb5c049b2d23b03a9530bf944f8f967a0fe79147dd6b9135bf7dd13d</pre>

				</p></div></section><section class="section" id="working-with-image-streams"><div class="titlepage"><div><div><h2 class="title">6.7. Working with image streams</h2></div></div></div><p>
				The following sections describe how to use image streams and image stream tags.
			</p><section class="section" id="images-getting-info-about-imagestreams_image-streams-managing"><div class="titlepage"><div><div><h3 class="title">6.7.1. Getting information about image streams</h3></div></div></div><p>
					You can get general information about the image stream and detailed information about all the tags it is pointing to.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To get general information about the image stream and detailed information about all the tags it is pointing to, enter the following command:
						</p><pre class="programlisting language-terminal">$ oc describe is/&lt;image-name&gt;</pre><p class="simpara">
							For example:
						</p><pre class="programlisting language-terminal">$ oc describe is/python</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Name:			python
Namespace:		default
Created:		About a minute ago
Labels:			&lt;none&gt;
Annotations:		openshift.io/image.dockerRepositoryCheck=2017-10-02T17:05:11Z
Docker Pull Spec:	docker-registry.default.svc:5000/default/python
Image Lookup:		local=false
Unique Images:		1
Tags:			1

3.5
  tagged from centos/python-35-centos7

  * centos/python-35-centos7@sha256:49c18358df82f4577386404991c51a9559f243e0b1bdc366df25
      About a minute ago</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							To get all of the information available about a particular image stream tag, enter the following command:
						</p><pre class="programlisting language-terminal">$ oc describe istag/&lt;image-stream&gt;:&lt;tag-name&gt;</pre><p class="simpara">
							For example:
						</p><pre class="programlisting language-terminal">$ oc describe istag/python:latest</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Image Name:	sha256:49c18358df82f4577386404991c51a9559f243e0b1bdc366df25
Docker Image:	centos/python-35-centos7@sha256:49c18358df82f4577386404991c51a9559f243e0b1bdc366df25
Name:		sha256:49c18358df82f4577386404991c51a9559f243e0b1bdc366df25
Created:	2 minutes ago
Image Size:	251.2 MB (first layer 2.898 MB, last binary layer 72.26 MB)
Image Created:	2 weeks ago
Author:		&lt;none&gt;
Arch:		amd64
Entrypoint:	container-entrypoint
Command:	/bin/sh -c $STI_SCRIPTS_PATH/usage
Working Dir:	/opt/app-root/src
User:		1001
Exposes Ports:	8080/tcp
Docker Labels:	build-date=20170801</pre>

							</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								More information is output than shown.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Enter the following command to discover which architecture or operating system that an image stream tag supports:
						</p><pre class="programlisting language-terminal">$ oc get istag &lt;image-stream-tag&gt; -ojsonpath="{range .image.dockerImageManifests[*]}{.os}/{.architecture}{'\n'}{end}"</pre><p class="simpara">
							For example:
						</p><pre class="programlisting language-terminal">$ oc get istag busybox:latest -ojsonpath="{range .image.dockerImageManifests[*]}{.os}/{.architecture}{'\n'}{end}"</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">linux/amd64
linux/arm
linux/arm64
linux/386
linux/mips64le
linux/ppc64le
linux/riscv64
linux/s390x</pre>

							</p></div></li></ul></div></section><section class="section" id="images-imagestream-adding-tags_image-streams-managing"><div class="titlepage"><div><div><h3 class="title">6.7.2. Adding tags to an image stream</h3></div></div></div><p>
					You can add additional tags to image streams.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Add a tag that points to one of the existing tags by using the `oc tag`command:
						</p><pre class="programlisting language-terminal">$ oc tag &lt;image-name:tag1&gt; &lt;image-name:tag2&gt;</pre><p class="simpara">
							For example:
						</p><pre class="programlisting language-terminal">$ oc tag python:3.5 python:latest</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Tag python:latest set to python@sha256:49c18358df82f4577386404991c51a9559f243e0b1bdc366df25.</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Confirm the image stream has two tags, one, <code class="literal">3.5</code>, pointing at the external container image and another tag, <code class="literal">latest</code>, pointing to the same image because it was created based on the first tag.
						</p><pre class="programlisting language-terminal">$ oc describe is/python</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Name:			python
Namespace:		default
Created:		5 minutes ago
Labels:			&lt;none&gt;
Annotations:		openshift.io/image.dockerRepositoryCheck=2017-10-02T17:05:11Z
Docker Pull Spec:	docker-registry.default.svc:5000/default/python
Image Lookup:		local=false
Unique Images:		1
Tags:			2

latest
  tagged from python@sha256:49c18358df82f4577386404991c51a9559f243e0b1bdc366df25

  * centos/python-35-centos7@sha256:49c18358df82f4577386404991c51a9559f243e0b1bdc366df25
      About a minute ago

3.5
  tagged from centos/python-35-centos7

  * centos/python-35-centos7@sha256:49c18358df82f4577386404991c51a9559f243e0b1bdc366df25
      5 minutes ago</pre>

							</p></div></li></ul></div></section><section class="section" id="images-imagestream-external-image-tags_image-streams-managing"><div class="titlepage"><div><div><h3 class="title">6.7.3. Adding tags for an external image</h3></div></div></div><p>
					You can add tags for external images.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Add tags pointing to internal or external images, by using the <code class="literal">oc tag</code> command for all tag-related operations:
						</p><pre class="programlisting language-terminal">$ oc tag &lt;repository/image&gt; &lt;image-name:tag&gt;</pre><p class="simpara">
							For example, this command maps the <code class="literal">docker.io/python:3.6.0</code> image to the <code class="literal">3.6</code> tag in the <code class="literal">python</code> image stream.
						</p><pre class="programlisting language-terminal">$ oc tag docker.io/python:3.6.0 python:3.6</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Tag python:3.6 set to docker.io/python:3.6.0.</pre>

							</p></div><p class="simpara">
							If the external image is secured, you must create a secret with credentials for accessing that registry.
						</p></li></ul></div></section><section class="section" id="images-imagestream-update-tag_image-streams-managing"><div class="titlepage"><div><div><h3 class="title">6.7.4. Updating image stream tags</h3></div></div></div><p>
					You can update a tag to reflect another tag in an image stream.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Update a tag:
						</p><pre class="programlisting language-terminal">$ oc tag &lt;image-name:tag&gt; &lt;image-name:latest&gt;</pre><p class="simpara">
							For example, the following updates the <code class="literal">latest</code> tag to reflect the <code class="literal">3.6</code> tag in an image stream:
						</p><pre class="programlisting language-terminal">$ oc tag python:3.6 python:latest</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Tag python:latest set to python@sha256:438208801c4806548460b27bd1fbcb7bb188273d13871ab43f.</pre>

							</p></div></li></ul></div></section><section class="section" id="images-imagestream-remove-tag_image-streams-managing"><div class="titlepage"><div><div><h3 class="title">6.7.5. Removing image stream tags</h3></div></div></div><p>
					You can remove old tags from an image stream.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Remove old tags from an image stream:
						</p><pre class="programlisting language-terminal">$ oc tag -d &lt;image-name:tag&gt;</pre><p class="simpara">
							For example:
						</p><pre class="programlisting language-terminal">$ oc tag -d python:3.5</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Deleted tag default/python:3.5.</pre>

							</p></div></li></ul></div><p>
					See <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#images-samples-operator-deprecated-image-stream_configuring-samples-operator">Removing deprecated image stream tags from the Cluster Samples Operator</a> for more information on how the Cluster Samples Operator handles deprecated image stream tags.
				</p></section><section class="section" id="images-imagestream-import_image-streams-managing"><div class="titlepage"><div><div><h3 class="title">6.7.6. Configuring periodic importing of image stream tags</h3></div></div></div><p>
					When working with an external container image registry, to periodically re-import an image, for example to get latest security updates, you can use the <code class="literal">--scheduled</code> flag.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Schedule importing images:
						</p><pre class="programlisting language-terminal">$ oc tag &lt;repository/image&gt; &lt;image-name:tag&gt; --scheduled</pre><p class="simpara">
							For example:
						</p><pre class="programlisting language-terminal">$ oc tag docker.io/python:3.6.0 python:3.6 --scheduled</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">Tag python:3.6 set to import docker.io/python:3.6.0 periodically.</pre>

							</p></div><p class="simpara">
							This command causes OpenShift Container Platform to periodically update this particular image stream tag. This period is a cluster-wide setting set to 15 minutes by default.
						</p></li><li class="listitem"><p class="simpara">
							Remove the periodic check, re-run above command but omit the <code class="literal">--scheduled</code> flag. This will reset its behavior to default.
						</p><pre class="programlisting language-terminal">$ oc tag &lt;repositiory/image&gt; &lt;image-name:tag&gt;</pre></li></ol></div></section></section><section class="section" id="images-imagestream-import-images-image-streams"><div class="titlepage"><div><div><h2 class="title">6.8. Importing and working with images and image streams</h2></div></div></div><p>
				The following sections describe how to import, and work with, image streams.
			</p><section class="section" id="images-imagestream-import-images-private-registry_image-streams-managing"><div class="titlepage"><div><div><h3 class="title">6.8.1. Importing images and image streams from private registries</h3></div></div></div><p>
					An image stream can be configured to import tag and image metadata from private image registries requiring authentication. This procedures applies if you change the registry that the Cluster Samples Operator uses to pull content from to something other than <a class="link" href="https://registry.redhat.io">registry.redhat.io</a>.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						When importing from insecure or secure registries, the registry URL defined in the secret must include the <code class="literal">:80</code> port suffix or the secret is not used when attempting to import from the registry.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							You must create a <code class="literal">secret</code> object that is used to store your credentials by entering the following command:
						</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;secret_name&gt; --from-file=.dockerconfigjson=&lt;file_absolute_path&gt; --type=kubernetes.io/dockerconfigjson</pre></li><li class="listitem"><p class="simpara">
							After the secret is configured, create the new image stream or enter the <code class="literal">oc import-image</code> command:
						</p><pre class="programlisting language-terminal">$ oc import-image &lt;imagestreamtag&gt; --from=&lt;image&gt; --confirm</pre><p class="simpara">
							During the import process, OpenShift Container Platform picks up the secrets and provides them to the remote party.
						</p></li></ol></div><section class="section" id="images-allow-pods-to-reference-images-from-secure-registries_image-streams-managing"><div class="titlepage"><div><div><h4 class="title">6.8.1.1. Allowing pods to reference images from other secured registries</h4></div></div></div><p>
						The <code class="literal">.dockercfg</code> <code class="literal">$HOME/.docker/config.json</code> file for Docker clients is a Docker credentials file that stores your authentication information if you have previously logged into a secured or insecure registry.
					</p><p>
						To pull a secured container image that is not from OpenShift image registry, you must create a pull secret from your Docker credentials and add it to your service account.
					</p><p>
						The Docker credentials file and the associated pull secret can contain multiple references to the same registry, each with its own set of credentials.
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">config.json</code> file</strong></p><p>
							
<pre class="programlisting language-json">{
   "auths":{
      "cloud.openshift.com":{
         "auth":"b3Blb=",
         "email":"you@example.com"
      },
      "quay.io":{
         "auth":"b3Blb=",
         "email":"you@example.com"
      },
      "quay.io/repository-main":{
         "auth":"b3Blb=",
         "email":"you@example.com"
      }
   }
}</pre>

						</p></div><div class="formalpara"><p class="title"><strong>Example pull secret</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: v1
data:
  .dockerconfigjson: ewogICAiYXV0aHMiOnsKICAgICAgIm0iOnsKICAgICAgIsKICAgICAgICAgImF1dGgiOiJiM0JsYj0iLAogICAgICAgICAiZW1haWwiOiJ5b3VAZXhhbXBsZS5jb20iCiAgICAgIH0KICAgfQp9Cg==
kind: Secret
metadata:
  creationTimestamp: "2021-09-09T19:10:11Z"
  name: pull-secret
  namespace: default
  resourceVersion: "37676"
  uid: e2851531-01bc-48ba-878c-de96cfe31020
type: Opaque</pre>

						</p></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								If you already have a <code class="literal">.dockercfg</code> file for the secured registry, you can create a secret from that file by running:
							</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;pull_secret_name&gt; \
    --from-file=.dockercfg=&lt;path/to/.dockercfg&gt; \
    --type=kubernetes.io/dockercfg</pre></li><li class="listitem"><p class="simpara">
								Or if you have a <code class="literal">$HOME/.docker/config.json</code> file:
							</p><pre class="programlisting language-terminal">$ oc create secret generic &lt;pull_secret_name&gt; \
    --from-file=.dockerconfigjson=&lt;path/to/.docker/config.json&gt; \
    --type=kubernetes.io/dockerconfigjson</pre></li><li class="listitem"><p class="simpara">
								If you do not already have a Docker credentials file for the secured registry, you can create a secret by running:
							</p><pre class="programlisting language-terminal">$ oc create secret docker-registry &lt;pull_secret_name&gt; \
    --docker-server=&lt;registry_server&gt; \
    --docker-username=&lt;user_name&gt; \
    --docker-password=&lt;password&gt; \
    --docker-email=&lt;email&gt;</pre></li><li class="listitem"><p class="simpara">
								To use a secret for pulling images for pods, you must add the secret to your service account. The name of the service account in this example should match the name of the service account the pod uses. The default service account is <code class="literal">default</code>:
							</p><pre class="programlisting language-terminal">$ oc secrets link default &lt;pull_secret_name&gt; --for=pull</pre></li></ul></div></section></section><section class="section" id="images-imagestream-import-import-mode_image-streams-managing"><div class="titlepage"><div><div><h3 class="title">6.8.2. Working with manifest lists</h3></div></div></div><p>
					You can import a single sub-manifest, or all manifests, of a manifest list when using <code class="literal">oc import-image</code> or <code class="literal">oc tag</code> CLI commands by adding the <code class="literal">--import-mode</code> flag.
				</p><p>
					Refer to the commands below to create an image stream that includes a single sub-manifest or multi-architecture images.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Create an image stream that includes multi-architecture images, and sets the import mode to <code class="literal">PreserveOriginal</code>, by entering the following command:
						</p><pre class="programlisting language-terminal">$ oc import-image &lt;multiarch-image-stream-tag&gt;  --from=&lt;registry&gt;/&lt;project_name&gt;/&lt;image-name&gt; \
--import-mode='PreserveOriginal' --reference-policy=local --confirm</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">---
Arch:           &lt;none&gt;
Manifests:      linux/amd64     sha256:6e325b86566fafd3c4683a05a219c30c421fbccbf8d87ab9d20d4ec1131c3451
                linux/arm64     sha256:d8fad562ffa75b96212c4a6dc81faf327d67714ed85475bf642729703a2b5bf6
                linux/ppc64le   sha256:7b7e25338e40d8bdeb1b28e37fef5e64f0afd412530b257f5b02b30851f416e1
---</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Alternatively, enter the following command to import an image with the <code class="literal">Legacy</code> import mode, which discards manifest lists and imports a single sub-manifest:
						</p><pre class="programlisting language-terminal">$ oc import-image &lt;multiarch-image-stream-tag&gt;  --from=&lt;registry&gt;/&lt;project_name&gt;/&lt;image-name&gt; \
--import-mode='Legacy' --confirm</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The <code class="literal">--import-mode=</code> default value is <code class="literal">Legacy</code>. Excluding this value, or failing to specify either <code class="literal">Legacy</code> or <code class="literal">PreserveOriginal</code>, imports a single sub-manifest. An invalid import mode returns the following error: <code class="literal">error: valid ImportMode values are Legacy or PreserveOriginal</code>.
							</p></div></div></li></ul></div><h5 id="images-imagestream-import-import-mode-limitations">Limitations</h5><p>
					Working with manifest lists has the following limitations:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							In some cases, users might want to use sub-manifests directly. When <code class="literal">oc adm prune images</code> is run, or the <code class="literal">CronJob</code> pruner runs, they cannot detect when a sub-manifest list is used. As a result, an administrator using <code class="literal">oc adm prune images</code>, or the <code class="literal">CronJob</code> pruner, might delete entire manifest lists, including sub-manifests.
						</p><p class="simpara">
							To avoid this limitation, you can use the manifest list by tag or by digest instead.
						</p></li></ul></div><section class="section" id="images-imagestream-periodic-import-list_image-streams-managing"><div class="titlepage"><div><div><h4 class="title">6.8.2.1. Configuring periodic importing of manifest lists</h4></div></div></div><p>
						To periodically re-import a manifest list, you can use the <code class="literal">--scheduled</code> flag.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Set the image stream to periodically update the manifest list by entering the following command:
							</p><pre class="programlisting language-terminal">$ oc import-image &lt;multiarch-image-stream-tag&gt;  --from=&lt;registry&gt;/&lt;project_name&gt;/&lt;image-name&gt; \
--import-mode='PreserveOriginal' --scheduled=true</pre></li></ul></div></section><section class="section" id="images-imagestream-ssl-import-list_image-streams-managing"><div class="titlepage"><div><div><h4 class="title">6.8.2.2. Configuring SSL/TSL when importing manifest lists</h4></div></div></div><p>
						To configure SSL/TSL when importing a manifest list, you can use the <code class="literal">--insecure</code> flag.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Set <code class="literal">--insecure=true</code> so that importing a manifest list skips SSL/TSL verification. For example:
							</p><pre class="programlisting language-terminal">$ oc import-image &lt;multiarch-image-stream-tag&gt; --from=&lt;registry&gt;/&lt;project_name&gt;/&lt;image-name&gt; \
--import-mode='PreserveOriginal' --insecure=true</pre></li></ul></div></section></section><section class="section" id="images-imagestream-specify-architecture_image-streams-managing"><div class="titlepage"><div><div><h3 class="title">6.8.3. Specifying architecture for --import-mode</h3></div></div></div><p>
					You can swap your imported image stream between multi-architecture and single architecture by excluding or including the <code class="literal">--import-mode=</code> flag
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Run the following command to update your image stream from multi-architecture to single architecture by excluding the <code class="literal">--import-mode=</code> flag:
						</p><pre class="programlisting language-terminal">$ oc import-image &lt;multiarch-image-stream-tag&gt; --from=&lt;registry&gt;/&lt;project_name&gt;/&lt;image-name&gt;</pre></li><li class="listitem"><p class="simpara">
							Run the following command to update your image stream from single-architecture to multi-architecture:
						</p><pre class="programlisting language-terminal">$ oc import-image &lt;multiarch-image-stream-tag&gt;  --from=&lt;registry&gt;/&lt;project_name&gt;/&lt;image-name&gt; \
--import-mode='PreserveOriginal'</pre></li></ul></div></section><section class="section" id="importmode-configuration-fields_image-streams-managing"><div class="titlepage"><div><div><h3 class="title">6.8.4. Configuration fields for --import-mode</h3></div></div></div><p>
					The following table describes the options available for the <code class="literal">--import-mode=</code> flag:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 27%; " class="col_1"><!--Empty--></col><col style="width: 73%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140424673990624" scope="col">Parameter</th><th align="left" valign="top" id="idm140424673989536" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140424673990624"> <p>
									<span class="strong strong"><strong>Legacy</strong></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140424673989536"> <p>
									The default option for <code class="literal">--import-mode</code>. When specified, the manifest list is discarded, and a single sub-manifest is imported. The platform is chosen in the following order of priority:
								</p>
								 <div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
											Tag annotations
										</li><li class="listitem">
											Control plane architecture
										</li><li class="listitem">
											Linux/AMD64
										</li><li class="listitem">
											The first manifest in the list
										</li></ol></div>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424673990624"> <p>
									<span class="strong strong"><strong>PreserveOriginal</strong></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140424673989536"> <p>
									When specified, the original manifest is preserved. For manifest lists, the manifest list and all of its sub-manifests are imported.
								</p>
								 </td></tr></tbody></table></div></section></section></section><section class="chapter" id="using-imagestreams-with-kube-resources"><div class="titlepage"><div><div><h1 class="title">Chapter 7. Using image streams with Kubernetes resources</h1></div></div></div><p>
			Image streams, being OpenShift Container Platform native resources, work out of the box with all the rest of native resources available in OpenShift Container Platform, such as builds or deployments. It is also possible to make them work with native Kubernetes resources, such as jobs, replication controllers, replica sets or Kubernetes deployments.
		</p><section class="section" id="images-managing-images-enabling-imagestreams-kube_using-imagestreams-with-kube-resources"><div class="titlepage"><div><div><h2 class="title">7.1. Enabling image streams with Kubernetes resources</h2></div></div></div><p>
				When using image streams with Kubernetes resources, you can only reference image streams that reside in the same project as the resource. The image stream reference must consist of a single segment value, for example <code class="literal">ruby:2.5</code>, where <code class="literal">ruby</code> is the name of an image stream that has a tag named <code class="literal">2.5</code> and resides in the same project as the resource making the reference.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					This feature can not be used in the <code class="literal">default</code> namespace, nor in any <code class="literal">openshift-</code> or <code class="literal">kube-</code> namespace.
				</p></div></div><p>
				There are two ways to enable image streams with Kubernetes resources:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Enabling image stream resolution on a specific resource. This allows only this resource to use the image stream name in the image field.
					</li><li class="listitem">
						Enabling image stream resolution on an image stream. This allows all resources pointing to this image stream to use it in the image field.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					You can use <code class="literal">oc set image-lookup</code> to enable image stream resolution on a specific resource or image stream resolution on an image stream.
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To allow all resources to reference the image stream named <code class="literal">mysql</code>, enter the following command:
					</p><pre class="programlisting language-terminal">$ oc set image-lookup mysql</pre><p class="simpara">
						This sets the <code class="literal">Imagestream.spec.lookupPolicy.local</code> field to true.
					</p><div class="formalpara"><p class="title"><strong>Imagestream with image lookup enabled</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: image.openshift.io/v1
kind: ImageStream
metadata:
  annotations:
    openshift.io/display-name: mysql
  name: mysql
  namespace: myproject
spec:
  lookupPolicy:
    local: true</pre>

						</p></div><p class="simpara">
						When enabled, the behavior is enabled for all tags within the image stream.
					</p></li><li class="listitem"><p class="simpara">
						Then you can query the image streams and see if the option is set:
					</p><pre class="programlisting language-terminal">$ oc set image-lookup imagestream --list</pre></li></ol></div><p>
				You can enable image lookup on a specific resource.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To allow the Kubernetes deployment named <code class="literal">mysql</code> to use image streams, run the following command:
					</p><pre class="programlisting language-terminal">$ oc set image-lookup deploy/mysql</pre><p class="simpara">
						This sets the <code class="literal">alpha.image.policy.openshift.io/resolve-names</code> annotation on the deployment.
					</p><div class="formalpara"><p class="title"><strong>Deployment with image lookup enabled</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: mysql
  namespace: myproject
spec:
  replicas: 1
  template:
    metadata:
      annotations:
        alpha.image.policy.openshift.io/resolve-names: '*'
    spec:
      containers:
      - image: mysql:latest
        imagePullPolicy: Always
        name: mysql</pre>

						</p></div></li></ul></div><p>
				You can disable image lookup.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To disable image lookup, pass <code class="literal">--enabled=false</code>:
					</p><pre class="programlisting language-terminal">$ oc set image-lookup deploy/mysql --enabled=false</pre></li></ul></div></section></section><section class="chapter" id="triggering-updates-on-imagestream-changes"><div class="titlepage"><div><div><h1 class="title">Chapter 8. Triggering updates on image stream changes</h1></div></div></div><p>
			When an image stream tag is updated to point to a new image, OpenShift Container Platform can automatically take action to roll the new image out to resources that were using the old image. You configure this behavior in different ways depending on the type of resource that references the image stream tag.
		</p><section class="section" id="openshift-resources"><div class="titlepage"><div><div><h2 class="title">8.1. OpenShift Container Platform resources</h2></div></div></div><p>
				OpenShift Container Platform deployment configurations and build configurations can be automatically triggered by changes to image stream tags. The triggered action can be run using the new value of the image referenced by the updated image stream tag.
			</p></section><section class="section" id="images-triggering-updates-imagestream-changes-kubernetes-about_triggering-updates-on-imagestream-changes"><div class="titlepage"><div><div><h2 class="title">8.2. Triggering Kubernetes resources</h2></div></div></div><p>
				Kubernetes resources do not have fields for triggering, unlike deployment and build configurations, which include as part of their API definition a set of fields for controlling triggers. Instead, you can use annotations in OpenShift Container Platform to request triggering.
			</p><p>
				The annotation is defined as follows:
			</p><pre class="programlisting language-yaml">Key: image.openshift.io/triggers
Value:
[
 {
   "from": {
     "kind": "ImageStreamTag", <span id="CO11-1"><!--Empty--></span><span class="callout">1</span>
     "name": "example:latest", <span id="CO11-2"><!--Empty--></span><span class="callout">2</span>
     "namespace": "myapp" <span id="CO11-3"><!--Empty--></span><span class="callout">3</span>
   },
   "fieldPath": "spec.template.spec.containers[?(@.name==\"web\")].image", <span id="CO11-4"><!--Empty--></span><span class="callout">4</span>
   "paused": false <span id="CO11-5"><!--Empty--></span><span class="callout">5</span>
 },
 ...
]</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO11-1"><span class="callout">1</span></a> </dt><dd><div class="para">
						Required: <code class="literal">kind</code> is the resource to trigger from must be <code class="literal">ImageStreamTag</code>.
					</div></dd><dt><a href="#CO11-2"><span class="callout">2</span></a> </dt><dd><div class="para">
						Required: <code class="literal">name</code> must be the name of an image stream tag.
					</div></dd><dt><a href="#CO11-3"><span class="callout">3</span></a> </dt><dd><div class="para">
						Optional: <code class="literal">namespace</code> defaults to the namespace of the object.
					</div></dd><dt><a href="#CO11-4"><span class="callout">4</span></a> </dt><dd><div class="para">
						Required: <code class="literal">fieldPath</code> is the JSON path to change. This field is limited and accepts only a JSON path expression that precisely matches a container by ID or index. For pods, the JSON path is "spec.containers[?(@.name='web')].image".
					</div></dd><dt><a href="#CO11-5"><span class="callout">5</span></a> </dt><dd><div class="para">
						Optional: <code class="literal">paused</code> is whether or not the trigger is paused, and the default value is <code class="literal">false</code>. Set <code class="literal">paused</code> to <code class="literal">true</code> to temporarily disable this trigger.
					</div></dd></dl></div><p>
				When one of the core Kubernetes resources contains both a pod template and this annotation, OpenShift Container Platform attempts to update the object by using the image currently associated with the image stream tag that is referenced by trigger. The update is performed against the <code class="literal">fieldPath</code> specified.
			</p><p>
				Examples of core Kubernetes resources that can contain both a pod template and annotation include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">CronJobs</code>
					</li><li class="listitem">
						<code class="literal">Deployments</code>
					</li><li class="listitem">
						<code class="literal">StatefulSets</code>
					</li><li class="listitem">
						<code class="literal">DaemonSets</code>
					</li><li class="listitem">
						<code class="literal">Jobs</code>
					</li><li class="listitem">
						<code class="literal">ReplicationControllers</code>
					</li><li class="listitem">
						<code class="literal">Pods</code>
					</li></ul></div></section><section class="section" id="images-triggering-updates-imagestream-changes-kubernetes-cli_triggering-updates-on-imagestream-changes"><div class="titlepage"><div><div><h2 class="title">8.3. Setting the image trigger on Kubernetes resources</h2></div></div></div><p>
				When adding an image trigger to deployments, you can use the <code class="literal">oc set triggers</code> command. For example, the sample command in this procedure adds an image change trigger to the deployment named <code class="literal">example</code> so that when the <code class="literal">example:latest</code> image stream tag is updated, the <code class="literal">web</code> container inside the deployment updates with the new image value. This command sets the correct <code class="literal">image.openshift.io/triggers</code> annotation on the deployment resource.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Trigger Kubernetes resources by entering the <code class="literal">oc set triggers</code> command:
					</p><pre class="programlisting language-terminal">$ oc set triggers deploy/example --from-image=example:latest -c web</pre></li></ul></div><p>
				Unless the deployment is paused, this pod template update automatically causes a deployment to occur with the new image value.
			</p></section></section><section class="chapter" id="image-configuration"><div class="titlepage"><div><div><h1 class="title">Chapter 9. Image configuration resources</h1></div></div></div><p>
			Use the following procedure to configure image registries.
		</p><section class="section" id="images-configuration-parameters_image-configuration"><div class="titlepage"><div><div><h2 class="title">9.1. Image controller configuration parameters</h2></div></div></div><p>
				The <code class="literal">image.config.openshift.io/cluster</code> resource holds cluster-wide information about how to handle images. The canonical, and only valid name is <code class="literal">cluster</code>. Its <code class="literal">spec</code> offers the following configuration parameters.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Parameters such as <code class="literal">DisableScheduledImport</code>, <code class="literal">MaxImagesBulkImportedPerRepository</code>, <code class="literal">MaxScheduledImportsPerMinute</code>, <code class="literal">ScheduledImageImportMinimumIntervalSeconds</code>, <code class="literal">InternalRegistryHostname</code> are not configurable.
				</p></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 27%; " class="col_1"><!--Empty--></col><col style="width: 73%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140424671599104" scope="col">Parameter</th><th align="left" valign="top" id="idm140424671598016" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140424671599104"> <p>
								<code class="literal">allowedRegistriesForImport</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140424671598016"> <p>
								Limits the container image registries from which normal users can import images. Set this list to the registries that you trust to contain valid images, and that you want applications to be able to import from. Users with permission to create images or <code class="literal">ImageStreamMappings</code> from the API are not affected by this policy. Typically only cluster administrators have the appropriate permissions.
							</p>
							 <p>
								Every element of this list contains a location of the registry specified by the registry domain name.
							</p>
							 <p>
								<code class="literal">domainName</code>: Specifies a domain name for the registry. If the registry uses a non-standard <code class="literal">80</code> or <code class="literal">443</code> port, the port should be included in the domain name as well.
							</p>
							 <p>
								<code class="literal">insecure</code>: Insecure indicates whether the registry is secure or insecure. By default, if not otherwise specified, the registry is assumed to be secure.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140424671599104"> <p>
								<code class="literal">additionalTrustedCA</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140424671598016"> <p>
								A reference to a config map containing additional CAs that should be trusted during <code class="literal">image stream import</code>, <code class="literal">pod image pull</code>, <code class="literal">openshift-image-registry pullthrough</code>, and builds.
							</p>
							 <p>
								The namespace for this config map is <code class="literal">openshift-config</code>. The format of the config map is to use the registry hostname as the key, and the PEM-encoded certificate as the value, for each additional registry CA to trust.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140424671599104"> <p>
								<code class="literal">externalRegistryHostnames</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140424671598016"> <p>
								Provides the hostnames for the default external image registry. The external hostname should be set only when the image registry is exposed externally. The first value is used in <code class="literal">publicDockerImageRepository</code> field in image streams. The value must be in <code class="literal">hostname[:port]</code> format.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140424671599104"> <p>
								<code class="literal">registrySources</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140424671598016"> <p>
								Contains configuration that determines how the container runtime should treat individual registries when accessing images for builds and pods. For instance, whether or not to allow insecure access. It does not contain configuration for the internal cluster registry.
							</p>
							 <p>
								<code class="literal">insecureRegistries</code>: Registries which do not have a valid TLS certificate or only support HTTP connections. To specify all subdomains, add the asterisk (<code class="literal">*</code>) wildcard character as a prefix to the domain name. For example, <code class="literal">*.example.com</code>. You can specify an individual repository within a registry. For example: <code class="literal">reg1.io/myrepo/myapp:latest</code>.
							</p>
							 <p>
								<code class="literal">blockedRegistries</code>: Registries for which image pull and push actions are denied. To specify all subdomains, add the asterisk (<code class="literal">*</code>) wildcard character as a prefix to the domain name. For example, <code class="literal">*.example.com</code>. You can specify an individual repository within a registry. For example: <code class="literal">reg1.io/myrepo/myapp:latest</code>. All other registries are allowed.
							</p>
							 <p>
								<code class="literal">allowedRegistries</code>: Registries for which image pull and push actions are allowed. To specify all subdomains, add the asterisk (<code class="literal">*</code>) wildcard character as a prefix to the domain name. For example, <code class="literal">*.example.com</code>. You can specify an individual repository within a registry. For example: <code class="literal">reg1.io/myrepo/myapp:latest</code>. All other registries are blocked.
							</p>
							 <p>
								<code class="literal">containerRuntimeSearchRegistries</code>: Registries for which image pull and push actions are allowed using image short names. All other registries are blocked.
							</p>
							 <p>
								Either <code class="literal">blockedRegistries</code> or <code class="literal">allowedRegistries</code> can be set, but not both.
							</p>
							 </td></tr></tbody></table></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					When the <code class="literal">allowedRegistries</code> parameter is defined, all registries, including <code class="literal">registry.redhat.io</code> and <code class="literal">quay.io</code> registries and the default OpenShift image registry, are blocked unless explicitly listed. When using the parameter, to prevent pod failure, add all registries including the <code class="literal">registry.redhat.io</code> and <code class="literal">quay.io</code> registries and the <code class="literal">internalRegistryHostname</code> to the <code class="literal">allowedRegistries</code> list, as they are required by payload images within your environment. For disconnected clusters, mirror registries should also be added.
				</p></div></div><p>
				The <code class="literal">status</code> field of the <code class="literal">image.config.openshift.io/cluster</code> resource holds observed values from the cluster.
			</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 27%; " class="col_1"><!--Empty--></col><col style="width: 73%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140424675497504" scope="col">Parameter</th><th align="left" valign="top" id="idm140424675496416" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140424675497504"> <p>
								<code class="literal">internalRegistryHostname</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140424675496416"> <p>
								Set by the Image Registry Operator, which controls the <code class="literal">internalRegistryHostname</code>. It sets the hostname for the default OpenShift image registry. The value must be in <code class="literal">hostname[:port]</code> format. For backward compatibility, you can still use the <code class="literal">OPENSHIFT_DEFAULT_REGISTRY</code> environment variable, but this setting overrides the environment variable.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140424675497504"> <p>
								<code class="literal">externalRegistryHostnames</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140424675496416"> <p>
								Set by the Image Registry Operator, provides the external hostnames for the image registry when it is exposed externally. The first value is used in <code class="literal">publicDockerImageRepository</code> field in image streams. The values must be in <code class="literal">hostname[:port]</code> format.
							</p>
							 </td></tr></tbody></table></div></section><section class="section" id="images-configuration-file_image-configuration"><div class="titlepage"><div><div><h2 class="title">9.2. Configuring image registry settings</h2></div></div></div><p>
				You can configure image registry settings by editing the <code class="literal">image.config.openshift.io/cluster</code> custom resource (CR). When changes to the registry are applied to the <code class="literal">image.config.openshift.io/cluster</code> CR, the Machine Config Operator (MCO) performs the following sequential actions:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Cordons the node
					</li><li class="listitem">
						Applies changes by restarting CRI-O
					</li><li class="listitem"><p class="simpara">
						Uncordons the node
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The MCO does not restart nodes when it detects changes.
						</p></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">image.config.openshift.io/cluster</code> custom resource:
					</p><pre class="programlisting language-terminal">$ oc edit image.config.openshift.io/cluster</pre><p class="simpara">
						The following is an example <code class="literal">image.config.openshift.io/cluster</code> CR:
					</p><pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1
kind: Image <span id="CO12-1"><!--Empty--></span><span class="callout">1</span>
metadata:
  annotations:
    release.openshift.io/create-only: "true"
  creationTimestamp: "2019-05-17T13:44:26Z"
  generation: 1
  name: cluster
  resourceVersion: "8302"
  selfLink: /apis/config.openshift.io/v1/images/cluster
  uid: e34555da-78a9-11e9-b92b-06d6c7da38dc
spec:
  allowedRegistriesForImport: <span id="CO12-2"><!--Empty--></span><span class="callout">2</span>
    - domainName: quay.io
      insecure: false
  additionalTrustedCA: <span id="CO12-3"><!--Empty--></span><span class="callout">3</span>
    name: myconfigmap
  registrySources: <span id="CO12-4"><!--Empty--></span><span class="callout">4</span>
    allowedRegistries:
    - example.com
    - quay.io
    - registry.redhat.io
    - image-registry.openshift-image-registry.svc:5000
    - reg1.io/myrepo/myapp:latest
    insecureRegistries:
    - insecure.com
status:
  internalRegistryHostname: image-registry.openshift-image-registry.svc:5000</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO12-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								<code class="literal">Image</code>: Holds cluster-wide information about how to handle images. The canonical, and only valid name is <code class="literal">cluster</code>.
							</div></dd><dt><a href="#CO12-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								<code class="literal">allowedRegistriesForImport</code>: Limits the container image registries from which normal users may import images. Set this list to the registries that you trust to contain valid images, and that you want applications to be able to import from. Users with permission to create images or <code class="literal">ImageStreamMappings</code> from the API are not affected by this policy. Typically only cluster administrators have the appropriate permissions.
							</div></dd><dt><a href="#CO12-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								<code class="literal">additionalTrustedCA</code>: A reference to a config map containing additional certificate authorities (CA) that are trusted during image stream import, pod image pull, <code class="literal">openshift-image-registry</code> pullthrough, and builds. The namespace for this config map is <code class="literal">openshift-config</code>. The format of the config map is to use the registry hostname as the key, and the PEM certificate as the value, for each additional registry CA to trust.
							</div></dd><dt><a href="#CO12-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								<code class="literal">registrySources</code>: Contains configuration that determines whether the container runtime allows or blocks individual registries when accessing images for builds and pods. Either the <code class="literal">allowedRegistries</code> parameter or the <code class="literal">blockedRegistries</code> parameter can be set, but not both. You can also define whether or not to allow access to insecure registries or registries that allow registries that use image short names. This example uses the <code class="literal">allowedRegistries</code> parameter, which defines the registries that are allowed to be used. The insecure registry <code class="literal">insecure.com</code> is also allowed. The <code class="literal">registrySources</code> parameter does not contain configuration for the internal cluster registry.
							</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When the <code class="literal">allowedRegistries</code> parameter is defined, all registries, including the registry.redhat.io and quay.io registries and the default OpenShift image registry, are blocked unless explicitly listed. If you use the parameter, to prevent pod failure, you must add the <code class="literal">registry.redhat.io</code> and <code class="literal">quay.io</code> registries and the <code class="literal">internalRegistryHostname</code> to the <code class="literal">allowedRegistries</code> list, as they are required by payload images within your environment. Do not add the <code class="literal">registry.redhat.io</code> and <code class="literal">quay.io</code> registries to the <code class="literal">blockedRegistries</code> list.
						</p><p>
							When using the <code class="literal">allowedRegistries</code>, <code class="literal">blockedRegistries</code>, or <code class="literal">insecureRegistries</code> parameter, you can specify an individual repository within a registry. For example: <code class="literal">reg1.io/myrepo/myapp:latest</code>.
						</p><p>
							Insecure external registries should be avoided to reduce possible security risks.
						</p></div></div></li><li class="listitem"><p class="simpara">
						To check that the changes are applied, list your nodes:
					</p><pre class="programlisting language-terminal">$ oc get nodes</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">NAME                                         STATUS                     ROLES                  AGE   VERSION
ip-10-0-137-182.us-east-2.compute.internal   Ready,SchedulingDisabled   worker                 65m   v1.26.0
ip-10-0-139-120.us-east-2.compute.internal   Ready,SchedulingDisabled   control-plane          74m   v1.26.0
ip-10-0-176-102.us-east-2.compute.internal   Ready                      control-plane          75m   v1.26.0
ip-10-0-188-96.us-east-2.compute.internal    Ready                      worker                 65m   v1.26.0
ip-10-0-200-59.us-east-2.compute.internal    Ready                      worker                 63m   v1.26.0
ip-10-0-223-123.us-east-2.compute.internal   Ready                      control-plane          73m   v1.26.0</pre>

						</p></div></li></ol></div><section class="section" id="images-configuration-allowed_image-configuration"><div class="titlepage"><div><div><h3 class="title">9.2.1. Adding specific registries</h3></div></div></div><p>
					You can add a list of registries, and optionally an individual repository within a registry, that are permitted for image pull and push actions by editing the <code class="literal">image.config.openshift.io/cluster</code> custom resource (CR). OpenShift Container Platform applies the changes to this CR to all nodes in the cluster.
				</p><p>
					When pulling or pushing images, the container runtime searches the registries listed under the <code class="literal">registrySources</code> parameter in the <code class="literal">image.config.openshift.io/cluster</code> CR. If you created a list of registries under the <code class="literal">allowedRegistries</code> parameter, the container runtime searches only those registries. Registries not in the list are blocked.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						When the <code class="literal">allowedRegistries</code> parameter is defined, all registries, including the <code class="literal">registry.redhat.io</code> and <code class="literal">quay.io</code> registries and the default OpenShift image registry, are blocked unless explicitly listed. If you use the parameter, to prevent pod failure, add the <code class="literal">registry.redhat.io</code> and <code class="literal">quay.io</code> registries and the <code class="literal">internalRegistryHostname</code> to the <code class="literal">allowedRegistries</code> list, as they are required by payload images within your environment. For disconnected clusters, mirror registries should also be added.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">image.config.openshift.io/cluster</code> CR:
						</p><pre class="programlisting language-terminal">$ oc edit image.config.openshift.io/cluster</pre><p class="simpara">
							The following is an example <code class="literal">image.config.openshift.io/cluster</code> CR with an allowed list:
						</p><pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1
kind: Image
metadata:
  annotations:
    release.openshift.io/create-only: "true"
  creationTimestamp: "2019-05-17T13:44:26Z"
  generation: 1
  name: cluster
  resourceVersion: "8302"
  selfLink: /apis/config.openshift.io/v1/images/cluster
  uid: e34555da-78a9-11e9-b92b-06d6c7da38dc
spec:
  registrySources: <span id="CO13-1"><!--Empty--></span><span class="callout">1</span>
    allowedRegistries: <span id="CO13-2"><!--Empty--></span><span class="callout">2</span>
    - example.com
    - quay.io
    - registry.redhat.io
    - reg1.io/myrepo/myapp:latest
    - image-registry.openshift-image-registry.svc:5000
status:
  internalRegistryHostname: image-registry.openshift-image-registry.svc:5000</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO13-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Contains configurations that determine how the container runtime should treat individual registries when accessing images for builds and pods. It does not contain configuration for the internal cluster registry.
								</div></dd><dt><a href="#CO13-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Specify registries, and optionally a repository in that registry, to use for image pull and push actions. All other registries are blocked.
								</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Either the <code class="literal">allowedRegistries</code> parameter or the <code class="literal">blockedRegistries</code> parameter can be set, but not both.
							</p></div></div><p class="simpara">
							The Machine Config Operator (MCO) watches the <code class="literal">image.config.openshift.io/cluster</code> resource for any changes to the registries. When the MCO detects a change, it drains the nodes, applies the change, and uncordons the nodes. After the nodes return to the <code class="literal">Ready</code> state, the allowed registries list is used to update the image signature policy in the <code class="literal">/host/etc/containers/policy.json</code> file on each node.
						</p></li><li class="listitem"><p class="simpara">
							To check that the registries have been added to the policy file, use the following command on a node:
						</p><pre class="programlisting language-terminal">$ cat /host/etc/containers/policy.json</pre><p class="simpara">
							The following policy indicates that only images from the example.com, quay.io, and registry.redhat.io registries are permitted for image pulls and pushes:
						</p><div class="example" id="idm140424673488704"><p class="title"><strong>Example 9.1. Example image signature policy file</strong></p><div class="example-contents"><pre class="programlisting language-terminal">{
   "default":[
      {
         "type":"reject"
      }
   ],
   "transports":{
      "atomic":{
         "example.com":[
            {
               "type":"insecureAcceptAnything"
            }
         ],
         "image-registry.openshift-image-registry.svc:5000":[
            {
               "type":"insecureAcceptAnything"
            }
         ],
         "insecure.com":[
            {
               "type":"insecureAcceptAnything"
            }
         ],
         "quay.io":[
            {
               "type":"insecureAcceptAnything"
            }
         ],
         "reg4.io/myrepo/myapp:latest":[
            {
               "type":"insecureAcceptAnything"
            }
         ],
         "registry.redhat.io":[
            {
               "type":"insecureAcceptAnything"
            }
         ]
      },
      "docker":{
         "example.com":[
            {
               "type":"insecureAcceptAnything"
            }
         ],
         "image-registry.openshift-image-registry.svc:5000":[
            {
               "type":"insecureAcceptAnything"
            }
         ],
         "insecure.com":[
            {
               "type":"insecureAcceptAnything"
            }
         ],
         "quay.io":[
            {
               "type":"insecureAcceptAnything"
            }
         ],
         "reg4.io/myrepo/myapp:latest":[
            {
               "type":"insecureAcceptAnything"
            }
         ],
         "registry.redhat.io":[
            {
               "type":"insecureAcceptAnything"
            }
         ]
      },
      "docker-daemon":{
         "":[
            {
               "type":"insecureAcceptAnything"
            }
         ]
      }
   }
}</pre></div></div></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If your cluster uses the <code class="literal">registrySources.insecureRegistries</code> parameter, ensure that any insecure registries are included in the allowed list.
					</p><p>
						For example:
					</p><pre class="programlisting language-yml">spec:
  registrySources:
    insecureRegistries:
    - insecure.com
    allowedRegistries:
    - example.com
    - quay.io
    - registry.redhat.io
    - insecure.com
    - image-registry.openshift-image-registry.svc:5000</pre></div></div></section><section class="section" id="images-configuration-blocked_image-configuration"><div class="titlepage"><div><div><h3 class="title">9.2.2. Blocking specific registries</h3></div></div></div><p>
					You can block any registry, and optionally an individual repository within a registry, by editing the <code class="literal">image.config.openshift.io/cluster</code> custom resource (CR). OpenShift Container Platform applies the changes to this CR to all nodes in the cluster.
				</p><p>
					When pulling or pushing images, the container runtime searches the registries listed under the <code class="literal">registrySources</code> parameter in the <code class="literal">image.config.openshift.io/cluster</code> CR. If you created a list of registries under the <code class="literal">blockedRegistries</code> parameter, the container runtime does not search those registries. All other registries are allowed.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						To prevent pod failure, do not add the <code class="literal">registry.redhat.io</code> and <code class="literal">quay.io</code> registries to the <code class="literal">blockedRegistries</code> list, as they are required by payload images within your environment.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">image.config.openshift.io/cluster</code> CR:
						</p><pre class="programlisting language-terminal">$ oc edit image.config.openshift.io/cluster</pre><p class="simpara">
							The following is an example <code class="literal">image.config.openshift.io/cluster</code> CR with a blocked list:
						</p><pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1
kind: Image
metadata:
  annotations:
    release.openshift.io/create-only: "true"
  creationTimestamp: "2019-05-17T13:44:26Z"
  generation: 1
  name: cluster
  resourceVersion: "8302"
  selfLink: /apis/config.openshift.io/v1/images/cluster
  uid: e34555da-78a9-11e9-b92b-06d6c7da38dc
spec:
  registrySources: <span id="CO14-1"><!--Empty--></span><span class="callout">1</span>
    blockedRegistries: <span id="CO14-2"><!--Empty--></span><span class="callout">2</span>
    - untrusted.com
    - reg1.io/myrepo/myapp:latest
status:
  internalRegistryHostname: image-registry.openshift-image-registry.svc:5000</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO14-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Contains configurations that determine how the container runtime should treat individual registries when accessing images for builds and pods. It does not contain configuration for the internal cluster registry.
								</div></dd><dt><a href="#CO14-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Specify registries, and optionally a repository in that registry, that should not be used for image pull and push actions. All other registries are allowed.
								</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Either the <code class="literal">blockedRegistries</code> registry or the <code class="literal">allowedRegistries</code> registry can be set, but not both.
							</p></div></div><p class="simpara">
							The Machine Config Operator (MCO) watches the <code class="literal">image.config.openshift.io/cluster</code> resource for any changes to the registries. When the MCO detects a change, it drains the nodes, applies the change, and uncordons the nodes. After the nodes return to the <code class="literal">Ready</code> state, changes to the blocked registries appear in the <code class="literal">/etc/containers/registries.conf</code> file on each node.
						</p></li><li class="listitem"><p class="simpara">
							To check that the registries have been added to the policy file, use the following command on a node:
						</p><pre class="programlisting language-terminal">$ cat /host/etc/containers/registries.conf</pre><p class="simpara">
							The following example indicates that images from the <code class="literal">untrusted.com</code> registry are prevented for image pulls and pushes:
						</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">unqualified-search-registries = ["registry.access.redhat.com", "docker.io"]

[[registry]]
  prefix = ""
  location = "untrusted.com"
  blocked = true</pre>

							</p></div></li></ol></div><section class="section" id="images-configuration-blocked-payload"><div class="titlepage"><div><div><h4 class="title">9.2.2.1. Blocking a payload registry</h4></div></div></div><p>
						In a mirroring configuration, you can block upstream payload registries in a disconnected environment using a <code class="literal">ImageContentSourcePolicy</code> (ICSP) object. The following example procedure demonstrates how to block the <code class="literal">quay.io/openshift-payload</code> payload registry.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create the mirror configuration using an <code class="literal">ImageContentSourcePolicy</code> (ICSP) object to mirror the payload to a registry in your instance. The following example ICSP file mirrors the payload <code class="literal">internal-mirror.io/openshift-payload</code>:
							</p><pre class="programlisting language-yaml">apiVersion: operator.openshift.io/v1alpha1
kind: ImageContentSourcePolicy
metadata:
  name: my-icsp
spec:
  repositoryDigestMirrors:
  - mirrors:
    - internal-mirror.io/openshift-payload
    source: quay.io/openshift-payload</pre></li><li class="listitem"><p class="simpara">
								After the object deploys onto your nodes, verify that the mirror configuration is set by checking the <code class="literal">/etc/containers/registries.conf</code> file:
							</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">[[registry]]
  prefix = ""
  location = "quay.io/openshift-payload"
  mirror-by-digest-only = true

[[registry.mirror]]
  location = "internal-mirror.io/openshift-payload"</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Use the following command to edit the <code class="literal">image.config.openshift.io</code> custom resource file:
							</p><pre class="programlisting language-terminal">$ oc edit image.config.openshift.io cluster</pre></li><li class="listitem"><p class="simpara">
								To block the payload registry, add the following configuration to the <code class="literal">image.config.openshift.io</code> custom resource file:
							</p><pre class="programlisting language-yaml">spec:
  registrySource:
    blockedRegistries:
     - quay.io/openshift-payload</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Verify that the upstream payload registry is blocked by checking the <code class="literal">/etc/containers/registries.conf</code> file on the node.
							</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">[[registry]]
  prefix = ""
  location = "quay.io/openshift-payload"
  blocked = true
  mirror-by-digest-only = true

[[registry.mirror]]
  location = "internal-mirror.io/openshift-payload"</pre>

								</p></div></li></ul></div></section></section><section class="section" id="images-configuration-insecure_image-configuration"><div class="titlepage"><div><div><h3 class="title">9.2.3. Allowing insecure registries</h3></div></div></div><p>
					You can add insecure registries, and optionally an individual repository within a registry, by editing the <code class="literal">image.config.openshift.io/cluster</code> custom resource (CR). OpenShift Container Platform applies the changes to this CR to all nodes in the cluster.
				</p><p>
					Registries that do not use valid SSL certificates or do not require HTTPS connections are considered insecure.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Insecure external registries should be avoided to reduce possible security risks.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">image.config.openshift.io/cluster</code> CR:
						</p><pre class="programlisting language-terminal">$ oc edit image.config.openshift.io/cluster</pre><p class="simpara">
							The following is an example <code class="literal">image.config.openshift.io/cluster</code> CR with an insecure registries list:
						</p><pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1
kind: Image
metadata:
  annotations:
    release.openshift.io/create-only: "true"
  creationTimestamp: "2019-05-17T13:44:26Z"
  generation: 1
  name: cluster
  resourceVersion: "8302"
  selfLink: /apis/config.openshift.io/v1/images/cluster
  uid: e34555da-78a9-11e9-b92b-06d6c7da38dc
spec:
  registrySources: <span id="CO15-1"><!--Empty--></span><span class="callout">1</span>
    insecureRegistries: <span id="CO15-2"><!--Empty--></span><span class="callout">2</span>
    - insecure.com
    - reg4.io/myrepo/myapp:latest
    allowedRegistries:
    - example.com
    - quay.io
    - registry.redhat.io
    - insecure.com <span id="CO15-3"><!--Empty--></span><span class="callout">3</span>
    - reg4.io/myrepo/myapp:latest
    - image-registry.openshift-image-registry.svc:5000
status:
  internalRegistryHostname: image-registry.openshift-image-registry.svc:5000</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO15-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Contains configurations that determine how the container runtime should treat individual registries when accessing images for builds and pods. It does not contain configuration for the internal cluster registry.
								</div></dd><dt><a href="#CO15-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Specify an insecure registry. You can specify a repository in that registry.
								</div></dd><dt><a href="#CO15-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Ensure that any insecure registries are included in the <code class="literal">allowedRegistries</code> list.
								</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								When the <code class="literal">allowedRegistries</code> parameter is defined, all registries, including the registry.redhat.io and quay.io registries and the default OpenShift image registry, are blocked unless explicitly listed. If you use the parameter, to prevent pod failure, add all registries including the <code class="literal">registry.redhat.io</code> and <code class="literal">quay.io</code> registries and the <code class="literal">internalRegistryHostname</code> to the <code class="literal">allowedRegistries</code> list, as they are required by payload images within your environment. For disconnected clusters, mirror registries should also be added.
							</p></div></div><p class="simpara">
							The Machine Config Operator (MCO) watches the <code class="literal">image.config.openshift.io/cluster</code> CR for any changes to the registries, then drains and uncordons the nodes when it detects changes. After the nodes return to the <code class="literal">Ready</code> state, changes to the insecure and blocked registries appear in the <code class="literal">/etc/containers/registries.conf</code> file on each node.
						</p></li><li class="listitem"><p class="simpara">
							To check that the registries have been added to the policy file, use the following command on a node:
						</p><pre class="programlisting language-terminal">$ cat /host/etc/containers/registries.conf</pre><p class="simpara">
							The following example indicates that images from the <code class="literal">insecure.com</code> registry is insecure and is allowed for image pulls and pushes.
						</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">unqualified-search-registries = ["registry.access.redhat.com", "docker.io"]

[[registry]]
  prefix = ""
  location = "insecure.com"
  insecure = true</pre>

							</p></div></li></ol></div></section><section class="section" id="images-configuration-shortname_image-configuration"><div class="titlepage"><div><div><h3 class="title">9.2.4. Adding registries that allow image short names</h3></div></div></div><p>
					You can add registries to search for an image short name by editing the <code class="literal">image.config.openshift.io/cluster</code> custom resource (CR). OpenShift Container Platform applies the changes to this CR to all nodes in the cluster.
				</p><p>
					An image short name enables you to search for images without including the fully qualified domain name in the pull spec. For example, you could use <code class="literal">rhel7/etcd</code> instead of <code class="literal">registry.access.redhat.com/rhe7/etcd</code>.
				</p><p>
					You might use short names in situations where using the full path is not practical. For example, if your cluster references multiple internal registries whose DNS changes frequently, you would need to update the fully qualified domain names in your pull specs with each change. In this case, using an image short name might be beneficial.
				</p><p>
					When pulling or pushing images, the container runtime searches the registries listed under the <code class="literal">registrySources</code> parameter in the <code class="literal">image.config.openshift.io/cluster</code> CR. If you created a list of registries under the <code class="literal">containerRuntimeSearchRegistries</code> parameter, when pulling an image with a short name, the container runtime searches those registries.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Using image short names with public registries is strongly discouraged because the image might not deploy if the public registry requires authentication. Use fully-qualified image names with public registries.
					</p><p>
						Red Hat internal or private registries typically support the use of image short names.
					</p><p>
						If you list public registries under the <code class="literal">containerRuntimeSearchRegistries</code> parameter, you expose your credentials to all the registries on the list and you risk network and registry attacks.
					</p><p>
						You cannot list multiple public registries under the <code class="literal">containerRuntimeSearchRegistries</code> parameter if each public registry requires different credentials and a cluster does not list the public registry in the global pull secret.
					</p><p>
						For a public registry that requires authentication, you can use an image short name only if the registry has its credentials stored in the global pull secret.
					</p></div></div><p>
					The Machine Config Operator (MCO) watches the <code class="literal">image.config.openshift.io/cluster</code> resource for any changes to the registries. When the MCO detects a change, it drains the nodes, applies the change, and uncordons the nodes. After the nodes return to the <code class="literal">Ready</code> state, if the <code class="literal">containerRuntimeSearchRegistries</code> parameter is added, the MCO creates a file in the <code class="literal">/etc/containers/registries.conf.d</code> directory on each node with the listed registries. The file overrides the default list of unqualified search registries in the <code class="literal">/host/etc/containers/registries.conf</code> file. There is no way to fall back to the default list of unqualified search registries.
				</p><p>
					The <code class="literal">containerRuntimeSearchRegistries</code> parameter works only with the Podman and CRI-O container engines. The registries in the list can be used only in pod specs, not in builds and image streams.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">image.config.openshift.io/cluster</code> custom resource:
						</p><pre class="programlisting language-terminal">$ oc edit image.config.openshift.io/cluster</pre><p class="simpara">
							The following is an example <code class="literal">image.config.openshift.io/cluster</code> CR:
						</p><pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1
kind: Image
metadata:
  annotations:
    release.openshift.io/create-only: "true"
  creationTimestamp: "2019-05-17T13:44:26Z"
  generation: 1
  name: cluster
  resourceVersion: "8302"
  selfLink: /apis/config.openshift.io/v1/images/cluster
  uid: e34555da-78a9-11e9-b92b-06d6c7da38dc
spec:
  allowedRegistriesForImport:
    - domainName: quay.io
      insecure: false
  additionalTrustedCA:
    name: myconfigmap
  registrySources:
    containerRuntimeSearchRegistries: <span id="CO16-1"><!--Empty--></span><span class="callout">1</span>
    - reg1.io
    - reg2.io
    - reg3.io
    allowedRegistries: <span id="CO16-2"><!--Empty--></span><span class="callout">2</span>
    - example.com
    - quay.io
    - registry.redhat.io
    - reg1.io
    - reg2.io
    - reg3.io
    - image-registry.openshift-image-registry.svc:5000
...
status:
  internalRegistryHostname: image-registry.openshift-image-registry.svc:5000</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO16-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Specify registries to use with image short names. You should use image short names with only internal or private registries to reduce possible security risks.
								</div></dd><dt><a href="#CO16-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Ensure that any registries listed under <code class="literal">containerRuntimeSearchRegistries</code> are included in the <code class="literal">allowedRegistries</code> list.
								</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								When the <code class="literal">allowedRegistries</code> parameter is defined, all registries, including the <code class="literal">registry.redhat.io</code> and <code class="literal">quay.io</code> registries and the default OpenShift image registry, are blocked unless explicitly listed. If you use this parameter, to prevent pod failure, add all registries including the <code class="literal">registry.redhat.io</code> and <code class="literal">quay.io</code> registries and the <code class="literal">internalRegistryHostname</code> to the <code class="literal">allowedRegistries</code> list, as they are required by payload images within your environment. For disconnected clusters, mirror registries should also be added.
							</p></div></div></li><li class="listitem"><p class="simpara">
							To check that the registries have been added, when a node returns to the <code class="literal">Ready</code> state, use the following command on the node:
						</p><pre class="programlisting language-terminal">$ cat /host/etc/containers/registries.conf.d/01-image-searchRegistries.conf</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">unqualified-search-registries = ['reg1.io', 'reg2.io', 'reg3.io']</pre>

							</p></div></li></ol></div></section><section class="section" id="images-configuration-cas_image-configuration"><div class="titlepage"><div><div><h3 class="title">9.2.5. Configuring additional trust stores for image registry access</h3></div></div></div><p>
					The <code class="literal">image.config.openshift.io/cluster</code> custom resource can contain a reference to a config map that contains additional certificate authorities to be trusted during image registry access.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The certificate authorities (CA) must be PEM-encoded.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						You can create a config map in the <code class="literal">openshift-config</code> namespace and use its name in <code class="literal">AdditionalTrustedCA</code> in the <code class="literal">image.config.openshift.io</code> custom resource to provide additional CAs that should be trusted when contacting external registries.
					</p></div><p>
					The config map key is the hostname of a registry with the port for which this CA is to be trusted, and the PEM certificate content is the value, for each additional registry CA to trust.
				</p><div class="formalpara"><p class="title"><strong>Image registry CA config map example</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: my-registry-ca
data:
  registry.example.com: |
    -----BEGIN CERTIFICATE-----
    ...
    -----END CERTIFICATE-----
  registry-with-port.example.com..5000: | <span id="CO17-1"><!--Empty--></span><span class="callout">1</span>
    -----BEGIN CERTIFICATE-----
    ...
    -----END CERTIFICATE-----</pre>

					</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO17-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							If the registry has the port, such as <code class="literal">registry-with-port.example.com:5000</code>, <code class="literal">:</code> should be replaced with <code class="literal">..</code>.
						</div></dd></dl></div><p>
					You can configure additional CAs with the following procedure.
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To configure an additional CA:
						</p><pre class="programlisting language-terminal">$ oc create configmap registry-config --from-file=&lt;external_registry_address&gt;=ca.crt -n openshift-config</pre><pre class="programlisting language-terminal">$ oc edit image.config.openshift.io cluster</pre><pre class="programlisting language-yaml">spec:
  additionalTrustedCA:
    name: registry-config</pre></li></ol></div></section><section class="section" id="images-configuration-registry-mirror_image-configuration"><div class="titlepage"><div><div><h3 class="title">9.2.6. Configuring image registry repository mirroring</h3></div></div></div><p>
					Setting up container registry repository mirroring enables you to perform the following tasks:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Configure your OpenShift Container Platform cluster to redirect requests to pull images from a repository on a source image registry and have it resolved by a repository on a mirrored image registry.
						</li><li class="listitem">
							Identify multiple mirrored repositories for each target repository, to make sure that if one mirror is down, another can be used.
						</li></ul></div><p>
					Repository mirroring in OpenShift Container Platform includes the following attributes:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Image pulls are resilient to registry downtimes.
						</li><li class="listitem">
							Clusters in disconnected environments can pull images from critical locations, such as quay.io, and have registries behind a company firewall provide the requested images.
						</li><li class="listitem">
							A particular order of registries is tried when an image pull request is made, with the permanent registry typically being the last one tried.
						</li><li class="listitem">
							The mirror information you enter is added to the <code class="literal">/etc/containers/registries.conf</code> file on every node in the OpenShift Container Platform cluster.
						</li><li class="listitem">
							When a node makes a request for an image from the source repository, it tries each mirrored repository in turn until it finds the requested content. If all mirrors fail, the cluster tries the source repository. If successful, the image is pulled to the node.
						</li></ul></div><p>
					Setting up repository mirroring can be done in the following ways:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							At OpenShift Container Platform installation:
						</p><p class="simpara">
							By pulling container images needed by OpenShift Container Platform and then bringing those images behind your company’s firewall, you can install OpenShift Container Platform into a datacenter that is in a disconnected environment.
						</p></li><li class="listitem"><p class="simpara">
							After OpenShift Container Platform installation:
						</p><p class="simpara">
							If you did not configure mirroring during OpenShift Container Platform installation, you can do so post-installation by using one of the following custom resource (CR) objects:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<code class="literal">ImageDigestMirrorSet</code>. This CR allows you to pull images from a mirrored registry by using digest specifications.
								</li><li class="listitem">
									<code class="literal">ImageTagMirrorSet</code>. This CR allows you to pull images from a mirrored registry by using image tags.
								</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								Using an <code class="literal">ImageContentSourcePolicy</code> (ICSP) object to configure repository mirroring is a deprecated feature. Deprecated functionality is still included in OpenShift Container Platform and continues to be supported; however, it will be removed in a future release of this product and is not recommended for new deployments. If you have existing YAML files that you used to create <code class="literal">ImageContentSourcePolicy</code> objects, you can use the <code class="literal">oc adm migrate icsp</code> command to convert those files to an <code class="literal">ImageDigestMirrorSet</code> YAML file. For more information, see "Converting ImageContentSourcePolicy (ICSP) files for image registry repository mirroring" in the following section.
							</p></div></div></li></ul></div><p>
					Both of these custom resource objects identify the following information:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The source of the container image repository you want to mirror.
						</li><li class="listitem">
							A separate entry for each mirror repository you want to offer the content requested from the source repository.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If your cluster uses an <code class="literal">ImageDigestMirrorSet</code> or <code class="literal">ImageTagMirrorSet</code> object to configure repository mirroring, you can use only global pull secrets for mirrored registries. You cannot add a pull secret to a project.
					</p></div></div><p>
					The following procedure creates a post-installation mirror configuration, where you create an <code class="literal">ImageDigestMirrorSet</code> object.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Ensure that you have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li><li class="listitem"><p class="simpara">
							Ensure that there are no <code class="literal">ImageContentSourcePolicy</code> objects on your cluster. For example, you can use the following command:
						</p><pre class="programlisting language-terminal">$ oc get ImageContentSourcePolicy</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">No resources found</pre>

							</p></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Configure mirrored repositories, by either:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Setting up a mirrored repository with Red Hat Quay, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_quay/3/html/manage_red_hat_quay/repo-mirroring-in-red-hat-quay">Red Hat Quay Repository Mirroring</a>. Using Red Hat Quay allows you to copy images from one repository to another and also automatically sync those repositories repeatedly over time.
								</li><li class="listitem"><p class="simpara">
									Using a tool such as <code class="literal">skopeo</code> to copy images manually from the source directory to the mirrored repository.
								</p><p class="simpara">
									For example, after installing the skopeo RPM package on a Red Hat Enterprise Linux (RHEL) 7 or RHEL 8 system, use the <code class="literal">skopeo</code> command as shown in this example:
								</p><pre class="programlisting language-terminal">$ skopeo copy \
docker://registry.access.redhat.com/ubi9/ubi-minimal:latest@sha256:5cf... \
docker://example.io/example/ubi-minimal</pre><p class="simpara">
									In this example, you have a container image registry that is named <code class="literal">example.io</code> with an image repository named <code class="literal">example</code> to which you want to copy the <code class="literal">ubi9/ubi-minimal</code> image from <code class="literal">registry.access.redhat.com</code>. After you create the registry, you can configure your OpenShift Container Platform cluster to redirect requests made of the source repository to the mirrored repository.
								</p></li></ul></div></li><li class="listitem">
							Log in to your OpenShift Container Platform cluster.
						</li><li class="listitem"><p class="simpara">
							Create an <code class="literal">ImageDigestMirrorSet</code> or <code class="literal">ImageTagMirrorSet</code> CR, as needed, replacing the source and mirrors with your own registry and repository pairs and images:
						</p><pre class="programlisting language-yaml">apiVersion: config.openshift.io/v1 <span id="CO18-1"><!--Empty--></span><span class="callout">1</span>
kind: ImageDigestMirrorSet <span id="CO18-2"><!--Empty--></span><span class="callout">2</span>
metadata:
  name: ubi9repo
spec:
  imageDigestMirrors: <span id="CO18-3"><!--Empty--></span><span class="callout">3</span>
  - mirrors:
    - example.io/example/ubi-minimal <span id="CO18-4"><!--Empty--></span><span class="callout">4</span>
    - example.com/example/ubi-minimal <span id="CO18-5"><!--Empty--></span><span class="callout">5</span>
    source: registry.access.redhat.com/ubi9/ubi-minimal <span id="CO18-6"><!--Empty--></span><span class="callout">6</span>
    mirrorSourcePolicy: AllowContactingSource <span id="CO18-7"><!--Empty--></span><span class="callout">7</span>
  - mirrors:
    - mirror.example.com/redhat
    source: registry.redhat.io/openshift4 <span id="CO18-8"><!--Empty--></span><span class="callout">8</span>
    mirrorSourcePolicy: AllowContactingSource
  - mirrors:
    - mirror.example.com
    source: registry.redhat.io <span id="CO18-9"><!--Empty--></span><span class="callout">9</span>
    mirrorSourcePolicy: AllowContactingSource
  - mirrors:
    - mirror.example.net/image
    source: registry.example.com/example/myimage <span id="CO18-10"><!--Empty--></span><span class="callout">10</span>
    mirrorSourcePolicy: AllowContactingSource
  - mirrors:
    - mirror.example.net
    source: registry.example.com/example <span id="CO18-11"><!--Empty--></span><span class="callout">11</span>
    mirrorSourcePolicy: AllowContactingSource
  - mirrors:
    - mirror.example.net/registry-example-com
    source: registry.example.com <span id="CO18-12"><!--Empty--></span><span class="callout">12</span>
    mirrorSourcePolicy: AllowContactingSource</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO18-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Indicates the API to use with this CR. This must be <code class="literal">config.openshift.io/v1</code>.
								</div></dd><dt><a href="#CO18-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Indicates the kind of object according to the pull type:
								</div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<code class="literal">ImageDigestMirrorSet</code>: Pulls a digest reference image.
										</li><li class="listitem">
											<code class="literal">ImageTagMirrorSet</code>: Pulls a tag reference image.
										</li></ul></div></dd><dt><a href="#CO18-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Indicates the type of image pull method, either:
								</div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<code class="literal">imageDigestMirrors</code>: Use for an <code class="literal">ImageDigestMirrorSet</code> CR.
										</li><li class="listitem">
											<code class="literal">imageTagMirrors</code>: Use for an <code class="literal">ImageTagMirrorSet</code> CR.
										</li></ul></div></dd><dt><a href="#CO18-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									Indicates the name of the mirrored image registry and repository.
								</div></dd><dt><a href="#CO18-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									Optional: Indicates a secondary mirror repository for each target repository. If one mirror is down, the target repository can use another mirror.
								</div></dd><dt><a href="#CO18-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									Indicates the registry and repository source, which is the repository that is referred to in image pull specifications.
								</div></dd><dt><a href="#CO18-7"><span class="callout">7</span></a> </dt><dd><div class="para">
									Optional: Indicates the fallback policy if the image pull fails:
								</div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<code class="literal">AllowContactingSource</code>: Allows continued attempts to pull the image from the source repository. This is the default.
										</li><li class="listitem">
											<code class="literal">NeverContactSource</code>: Prevents continued attempts to pull the image from the source repository.
										</li></ul></div></dd><dt><a href="#CO18-8"><span class="callout">8</span></a> </dt><dd><div class="para">
									Optional: Indicates a namespace inside a registry, which allows you to use any image in that namespace. If you use a registry domain as a source, the object is applied to all repositories from the registry.
								</div></dd><dt><a href="#CO18-9"><span class="callout">9</span></a> </dt><dd><div class="para">
									Optional: Indicates a registry, which allows you to use any image in that registry. If you specify a registry name, the object is applied to all repositories from a source registry to a mirror registry.
								</div></dd><dt><a href="#CO18-10"><span class="callout">10</span></a> </dt><dd><div class="para">
									Pulls the image <code class="literal">registry.example.com/example/myimage@sha256:…​</code> from the mirror <code class="literal">mirror.example.net/image@sha256:..</code>.
								</div></dd><dt><a href="#CO18-11"><span class="callout">11</span></a> </dt><dd><div class="para">
									Pulls the image <code class="literal">registry.example.com/example/image@sha256:…​</code> in the source registry namespace from the mirror <code class="literal">mirror.example.net/image@sha256:…​</code>.
								</div></dd><dt><a href="#CO18-12"><span class="callout">12</span></a> </dt><dd><div class="para">
									Pulls the image <code class="literal">registry.example.com/myimage@sha256</code> from the mirror registry <code class="literal">example.net/registry-example-com/myimage@sha256:…​</code>. The <code class="literal">ImageContentSourcePolicy</code> resource is applied to all repositories from a source registry to a mirror registry <code class="literal">mirror.example.net/registry-example-com</code>.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Create the new object:
						</p><pre class="programlisting language-terminal">$ oc create -f registryrepomirror.yaml</pre><p class="simpara">
							After the object is created, the Machine Config Operator (MCO) cordons the nodes as the new settings are deployed to each node. The MCO restarts the nodes for an <code class="literal">ImageTagMirrorSet</code> object only. The MCO does not restart the nodes for <code class="literal">ImageDigestMirrorSet</code> objects. When the nodes are uncordoned, the cluster starts using the mirrored repository for requests to the source repository.
						</p></li><li class="listitem"><p class="simpara">
							To check that the mirrored configuration settings are applied, do the following on one of the nodes.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									List your nodes:
								</p><pre class="programlisting language-terminal">$ oc get node</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">NAME                           STATUS                     ROLES    AGE  VERSION
ip-10-0-137-44.ec2.internal    Ready                      worker   7m   v1.26.0
ip-10-0-138-148.ec2.internal   Ready                      master   11m  v1.26.0
ip-10-0-139-122.ec2.internal   Ready                      master   11m  v1.26.0
ip-10-0-147-35.ec2.internal    Ready                      worker   7m   v1.26.0
ip-10-0-153-12.ec2.internal    Ready                      worker   7m   v1.26.0
ip-10-0-154-10.ec2.internal    Ready                      master   11m  v1.26.0</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Start the debugging process to access the node:
								</p><pre class="programlisting language-terminal">$ oc debug node/ip-10-0-147-35.ec2.internal</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">Starting pod/ip-10-0-147-35ec2internal-debug ...
To use host binaries, run `chroot /host`</pre>

									</p></div></li><li class="listitem"><p class="simpara">
									Change your root directory to <code class="literal">/host</code>:
								</p><pre class="programlisting language-terminal">sh-4.2# chroot /host</pre></li><li class="listitem"><p class="simpara">
									Check the <code class="literal">/etc/containers/registries.conf</code> file to make sure the changes were made:
								</p><pre class="programlisting language-terminal">sh-4.2# cat /etc/containers/registries.conf</pre><p class="simpara">
									The following output represents a <code class="literal">registries.conf</code> file where an <code class="literal">ImageDigestMirrorSet</code> object and an <code class="literal">ImageTagMirrorSet</code> object were applied. The final two entries are marked <code class="literal">digest-only</code> and <code class="literal">tag-only</code> respectively.
								</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
										
<pre class="programlisting language-terminal">unqualified-search-registries = ["registry.access.redhat.com", "docker.io"]
short-name-mode = ""

[[registry]]
  prefix = ""
  location = "registry.access.redhat.com/ubi9/ubi-minimal" <span id="CO19-1"><!--Empty--></span><span class="callout">1</span>

  [[registry.mirror]]
    location = "example.io/example/ubi-minimal" <span id="CO19-2"><!--Empty--></span><span class="callout">2</span>
    pull-from-mirror = "digest-only" <span id="CO19-3"><!--Empty--></span><span class="callout">3</span>

  [[registry.mirror]]
    location = "example.com/example/ubi-minimal"
    pull-from-mirror = "digest-only"

[[registry]]
  prefix = ""
  location = "registry.example.com"

  [[registry.mirror]]
    location = "mirror.example.net/registry-example-com"
    pull-from-mirror = "digest-only"

[[registry]]
  prefix = ""
  location = "registry.example.com/example"

  [[registry.mirror]]
    location = "mirror.example.net"
    pull-from-mirror = "digest-only"

[[registry]]
  prefix = ""
  location = "registry.example.com/example/myimage"

  [[registry.mirror]]
    location = "mirror.example.net/image"
    pull-from-mirror = "digest-only"

[[registry]]
  prefix = ""
  location = "registry.redhat.io"

  [[registry.mirror]]
    location = "mirror.example.com"
    pull-from-mirror = "digest-only"

[[registry]]
  prefix = ""
  location = "registry.redhat.io/openshift4"

  [[registry.mirror]]
    location = "mirror.example.com/redhat"
    pull-from-mirror = "digest-only"
[[registry]]
  prefix = ""
  location = "registry.access.redhat.com/ubi9/ubi-minimal"
  blocked = true <span id="CO19-4"><!--Empty--></span><span class="callout">4</span>

  [[registry.mirror]]
    location = "example.io/example/ubi-minimal-tag"
    pull-from-mirror = "tag-only" <span id="CO19-5"><!--Empty--></span><span class="callout">5</span></pre>

									</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO19-1"><span class="callout">1</span></a> </dt><dd><div class="para">
											Indicates the repository that is referred to in a pull spec.
										</div></dd><dt><a href="#CO19-2"><span class="callout">2</span></a> </dt><dd><div class="para">
											Indicates the mirror for that repository.
										</div></dd><dt><a href="#CO19-3"><span class="callout">3</span></a> </dt><dd><div class="para">
											Indicates that the image pull from the mirror is a digest reference image.
										</div></dd><dt><a href="#CO19-4"><span class="callout">4</span></a> </dt><dd><div class="para">
											Indicates that the <code class="literal">NeverContactSource</code> parameter is set for this repository.
										</div></dd><dt><a href="#CO19-5"><span class="callout">5</span></a> </dt><dd><div class="para">
											Indicates that the image pull from the mirror is a tag reference image.
										</div></dd></dl></div></li><li class="listitem"><p class="simpara">
									Pull an image to the node from the source and check if it is resolved by the mirror.
								</p><pre class="programlisting language-terminal">sh-4.2# podman pull --log-level=debug registry.access.redhat.com/ubi9/ubi-minimal@sha256:5cf...</pre></li></ol></div></li></ol></div><div class="formalpara"><p class="title"><strong>Troubleshooting repository mirroring</strong></p><p>
						If the repository mirroring procedure does not work as described, use the following information about how repository mirroring works to help troubleshoot the problem.
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The first working mirror is used to supply the pulled image.
						</li><li class="listitem">
							The main registry is only used if no other mirror works.
						</li><li class="listitem">
							From the system context, the <code class="literal">Insecure</code> flags are used as fallback.
						</li><li class="listitem">
							The format of the <code class="literal">/etc/containers/registries.conf</code> file has changed recently. It is now version 2 and in TOML format.
						</li><li class="listitem">
							You cannot add the same repository to both an <code class="literal">ImageDigestMirrorSet</code> and an <code class="literal">ImageTagMirrorSet</code> object.
						</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							For more information about global pull secrets, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#images-update-global-pull-secret_using-image-pull-secrets">Updating the global cluster pull secret</a>.
						</li></ul></div></section><section class="section" id="images-configuration-registry-mirror-convert_image-configuration"><div class="titlepage"><div><div><h3 class="title">9.2.7. Converting ImageContentSourcePolicy (ICSP) files for image registry repository mirroring</h3></div></div></div><p>
					Using an <code class="literal">ImageContentSourcePolicy</code> (ICSP) object to configure repository mirroring is a deprecated feature. This functionality is still included in OpenShift Container Platform and continues to be supported; however, it will be removed in a future release of this product and is not recommended for new deployments.
				</p><p>
					ICSP objects are being replaced by <code class="literal">ImageDigestMirrorSet</code> and <code class="literal">ImageTagMirrorSet</code> objects to configure repository mirroring. If you have existing YAML files that you used to create <code class="literal">ImageContentSourcePolicy</code> objects, you can use the <code class="literal">oc adm migrate icsp</code> command to convert those files to an <code class="literal">ImageDigestMirrorSet</code> YAML file. The command updates the API to the current version, changes the <code class="literal">kind</code> value to <code class="literal">ImageDigestMirrorSet</code>, and changes <code class="literal">spec.repositoryDigestMirrors</code> to <code class="literal">spec.imageDigestMirrors</code>. The rest of the file is not changed.
				</p><p>
					For more information about <code class="literal">ImageDigestMirrorSet</code> or <code class="literal">ImageTagMirrorSet</code> objects, see "Configuring image registry repository mirroring" in the previous section.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Ensure that you have access to the cluster as a user with the <code class="literal">cluster-admin</code> role.
						</li><li class="listitem">
							Ensure that you have <code class="literal">ImageContentSourcePolicy</code> objects on your cluster.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Use the following command to convert one or more <code class="literal">ImageContentSourcePolicy</code> YAML files to an <code class="literal">ImageDigestMirrorSet</code> YAML file:
						</p><pre class="programlisting language-terminal">$ oc adm migrate icsp &lt;file_name&gt;.yaml &lt;file_name&gt;.yaml &lt;file_name&gt;.yaml --dest-dir &lt;path_to_the_directory&gt;</pre><p class="simpara">
							where:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">&lt;file_name&gt;</code></span></dt><dd>
										Specifies the name of the source <code class="literal">ImageContentSourcePolicy</code> YAML. You can list multiple file names.
									</dd><dt><span class="term"><code class="literal">--dest-dir</code></span></dt><dd>
										Optional: Specifies a directory for the output <code class="literal">ImageDigestMirrorSet</code> YAML. If unset, the file is written to the current directory.
									</dd></dl></div><p class="simpara">
							For example, the following command converts the <code class="literal">icsp.yaml</code> and <code class="literal">icsp-2.yaml</code> file and saves the new YAML files to the <code class="literal">idms-files</code> directory.
						</p><pre class="programlisting language-terminal">$ oc adm migrate icsp icsp.yaml icsp-2.yaml --dest-dir idms-files</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">wrote ImageDigestMirrorSet to idms-files/imagedigestmirrorset_ubi8repo.5911620242173376087.yaml
wrote ImageDigestMirrorSet to idms-files/imagedigestmirrorset_ubi9repo.6456931852378115011.yaml</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Create the CR object by running the following command:
						</p><pre class="programlisting language-terminal">$ oc create -f &lt;path_to_the_directory&gt;/&lt;file-name&gt;.yaml</pre><p class="simpara">
							where:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">&lt;path_to_the_directory&gt;</code></span></dt><dd>
										Specifies the path to the directory, if you used the <code class="literal">--dest-dir</code> flag.
									</dd><dt><span class="term"><code class="literal">&lt;file_name&gt;</code></span></dt><dd>
										Specifies the name of the <code class="literal">ImageDigestMirrorSet</code> YAML.
									</dd></dl></div></li></ol></div></section></section></section><section class="chapter" id="using-templates"><div class="titlepage"><div><div><h1 class="title">Chapter 10. Using templates</h1></div></div></div><p>
			The following sections provide an overview of templates, as well as how to use and create them.
		</p><section class="section" id="templates-overview_using-templates"><div class="titlepage"><div><div><h2 class="title">10.1. Understanding templates</h2></div></div></div><p>
				A template describes a set of objects that can be parameterized and processed to produce a list of objects for creation by OpenShift Container Platform. A template can be processed to create anything you have permission to create within a project, for example services, build configurations, and deployment configurations. A template can also define a set of labels to apply to every object defined in the template.
			</p><p>
				You can create a list of objects from a template using the CLI or, if a template has been uploaded to your project or the global template library, using the web console.
			</p></section><section class="section" id="templates-uploading_using-templates"><div class="titlepage"><div><div><h2 class="title">10.2. Uploading a template</h2></div></div></div><p>
				If you have a JSON or YAML file that defines a template, for example as seen in this example, you can upload the template to projects using the CLI. This saves the template to the project for repeated use by any user with appropriate access to that project. Instructions on writing your own templates are provided later in this topic.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Upload a template to your current project’s template library, pass the JSON or YAML file with the following command:
					</p><pre class="programlisting language-terminal">$ oc create -f &lt;filename&gt;</pre></li><li class="listitem"><p class="simpara">
						Upload a template to a different project using the <code class="literal">-n</code> option with the name of the project:
					</p><pre class="programlisting language-terminal">$ oc create -f &lt;filename&gt; -n &lt;project&gt;</pre></li></ul></div><p>
				The template is now available for selection using the web console or the CLI.
			</p></section><section class="section" id="templates-creating-from-console_using-templates"><div class="titlepage"><div><div><h2 class="title">10.3. Creating an application by using the web console</h2></div></div></div><p>
				You can use the web console to create an application from a template.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						While in the desired project, click <span class="strong strong"><strong>Add to Project</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Select either a builder image from the list of images in your project, or from the service catalog.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Only image stream tags that have the <code class="literal">builder</code> tag listed in their annotations appear in this list, as demonstrated here:
						</p></div></div><pre class="programlisting language-yaml">kind: "ImageStream"
apiVersion: "v1"
metadata:
  name: "ruby"
  creationTimestamp: null
spec:
  dockerImageRepository: "registry.redhat.io/rhscl/ruby-26-rhel7"
  tags:
    -
      name: "2.6"
      annotations:
        description: "Build and run Ruby 2.6 applications"
        iconClass: "icon-ruby"
        tags: "builder,ruby" <span id="CO20-1"><!--Empty--></span><span class="callout">1</span>
        supports: "ruby:2.6,ruby"
        version: "2.6"</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO20-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Including <code class="literal">builder</code> here ensures this image stream tag appears in the web console as a builder.
							</div></dd></dl></div></li><li class="listitem">
						Modify the settings in the new application screen to configure the objects to support your application.
					</li></ol></div></section><section class="section" id="templates-using-the-cli_using-templates"><div class="titlepage"><div><div><h2 class="title">10.4. Creating objects from templates by using the CLI</h2></div></div></div><p>
				You can use the CLI to process templates and use the configuration that is generated to create objects.
			</p><section class="section" id="templates-cli-labels_using-templates"><div class="titlepage"><div><div><h3 class="title">10.4.1. Adding labels</h3></div></div></div><p>
					Labels are used to manage and organize generated objects, such as pods. The labels specified in the template are applied to every object that is generated from the template.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Add labels in the template from the command line:
						</p><pre class="programlisting language-terminal">$ oc process -f &lt;filename&gt; -l name=otherLabel</pre></li></ul></div></section><section class="section" id="templates-cli-parameters_using-templates"><div class="titlepage"><div><div><h3 class="title">10.4.2. Listing parameters</h3></div></div></div><p>
					The list of parameters that you can override are listed in the <code class="literal">parameters</code> section of the template.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							You can list parameters with the CLI by using the following command and specifying the file to be used:
						</p><pre class="programlisting language-terminal">$ oc process --parameters -f &lt;filename&gt;</pre><p class="simpara">
							Alternatively, if the template is already uploaded:
						</p><pre class="programlisting language-terminal">$ oc process --parameters -n &lt;project&gt; &lt;template_name&gt;</pre><p class="simpara">
							For example, the following shows the output when listing the parameters for one of the quick start templates in the default <code class="literal">openshift</code> project:
						</p><pre class="programlisting language-terminal">$ oc process --parameters -n openshift rails-postgresql-example</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">NAME                         DESCRIPTION                                                                                              GENERATOR           VALUE
SOURCE_REPOSITORY_URL        The URL of the repository with your application source code                                                                  https://github.com/sclorg/rails-ex.git
SOURCE_REPOSITORY_REF        Set this to a branch name, tag or other ref of your repository if you are not using the default branch
CONTEXT_DIR                  Set this to the relative path to your project if it is not in the root of your repository
APPLICATION_DOMAIN           The exposed hostname that will route to the Rails service                                                                    rails-postgresql-example.openshiftapps.com
GITHUB_WEBHOOK_SECRET        A secret string used to configure the GitHub webhook                                                     expression          [a-zA-Z0-9]{40}
SECRET_KEY_BASE              Your secret key for verifying the integrity of signed cookies                                            expression          [a-z0-9]{127}
APPLICATION_USER             The application user that is used within the sample application to authorize access on pages                                 openshift
APPLICATION_PASSWORD         The application password that is used within the sample application to authorize access on pages                             secret
DATABASE_SERVICE_NAME        Database service name                                                                                                        postgresql
POSTGRESQL_USER              database username                                                                                        expression          user[A-Z0-9]{3}
POSTGRESQL_PASSWORD          database password                                                                                        expression          [a-zA-Z0-9]{8}
POSTGRESQL_DATABASE          database name                                                                                                                root
POSTGRESQL_MAX_CONNECTIONS   database max connections                                                                                                     10
POSTGRESQL_SHARED_BUFFERS    database shared buffers                                                                                                      12MB</pre>

							</p></div><p class="simpara">
							The output identifies several parameters that are generated with a regular expression-like generator when the template is processed.
						</p></li></ol></div></section><section class="section" id="templates-cli-generating-list-of-objects_using-templates"><div class="titlepage"><div><div><h3 class="title">10.4.3. Generating a list of objects</h3></div></div></div><p>
					Using the CLI, you can process a file defining a template to return the list of objects to standard output.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Process a file defining a template to return the list of objects to standard output:
						</p><pre class="programlisting language-terminal">$ oc process -f &lt;filename&gt;</pre><p class="simpara">
							Alternatively, if the template has already been uploaded to the current project:
						</p><pre class="programlisting language-terminal">$ oc process &lt;template_name&gt;</pre></li><li class="listitem"><p class="simpara">
							Create objects from a template by processing the template and piping the output to <code class="literal">oc create</code>:
						</p><pre class="programlisting language-terminal">$ oc process -f &lt;filename&gt; | oc create -f -</pre><p class="simpara">
							Alternatively, if the template has already been uploaded to the current project:
						</p><pre class="programlisting language-terminal">$ oc process &lt;template&gt; | oc create -f -</pre></li><li class="listitem"><p class="simpara">
							You can override any parameter values defined in the file by adding the <code class="literal">-p</code> option for each <code class="literal">&lt;name&gt;=&lt;value&gt;</code> pair you want to override. A parameter reference appears in any text field inside the template items.
						</p><p class="simpara">
							For example, in the following the <code class="literal">POSTGRESQL_USER</code> and <code class="literal">POSTGRESQL_DATABASE</code> parameters of a template are overridden to output a configuration with customized environment variables:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Creating a List of objects from a template
								</p><pre class="programlisting language-terminal">$ oc process -f my-rails-postgresql \
    -p POSTGRESQL_USER=bob \
    -p POSTGRESQL_DATABASE=mydatabase</pre></li><li class="listitem"><p class="simpara">
									The JSON file can either be redirected to a file or applied directly without uploading the template by piping the processed output to the <code class="literal">oc create</code> command:
								</p><pre class="programlisting language-terminal">$ oc process -f my-rails-postgresql \
    -p POSTGRESQL_USER=bob \
    -p POSTGRESQL_DATABASE=mydatabase \
    | oc create -f -</pre></li><li class="listitem"><p class="simpara">
									If you have large number of parameters, you can store them in a file and then pass this file to <code class="literal">oc process</code>:
								</p><pre class="programlisting language-terminal">$ cat postgres.env
POSTGRESQL_USER=bob
POSTGRESQL_DATABASE=mydatabase</pre><pre class="programlisting language-terminal">$ oc process -f my-rails-postgresql --param-file=postgres.env</pre></li><li class="listitem"><p class="simpara">
									You can also read the environment from standard input by using <code class="literal">"-"</code> as the argument to <code class="literal">--param-file</code>:
								</p><pre class="programlisting language-terminal">$ sed s/bob/alice/ postgres.env | oc process -f my-rails-postgresql --param-file=-</pre></li></ol></div></li></ol></div></section></section><section class="section" id="templates-modifying-uploaded-template_using-templates"><div class="titlepage"><div><div><h2 class="title">10.5. Modifying uploaded templates</h2></div></div></div><p>
				You can edit a template that has already been uploaded to your project.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Modify a template that has already been uploaded:
					</p><pre class="programlisting language-terminal">$ oc edit template &lt;template&gt;</pre></li></ul></div></section><section class="section" id="templates-using-instant-app-quickstart_using-templates"><div class="titlepage"><div><div><h2 class="title">10.6. Using instant app and quick start templates</h2></div></div></div><p>
				OpenShift Container Platform provides a number of default instant app and quick start templates to make it easy to quickly get started creating a new application for different languages. Templates are provided for Rails (Ruby), Django (Python), Node.js, CakePHP (PHP), and Dancer (Perl). Your cluster administrator must create these templates in the default, global <code class="literal">openshift</code> project so you have access to them.
			</p><p>
				By default, the templates build using a public source repository on GitHub that contains the necessary application code.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						You can list the available default instant app and quick start templates with:
					</p><pre class="programlisting language-terminal">$ oc get templates -n openshift</pre></li><li class="listitem"><p class="simpara">
						To modify the source and build your own version of the application:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Fork the repository referenced by the template’s default <code class="literal">SOURCE_REPOSITORY_URL</code> parameter.
							</li><li class="listitem"><p class="simpara">
								Override the value of the <code class="literal">SOURCE_REPOSITORY_URL</code> parameter when creating from the template, specifying your fork instead of the default value.
							</p><p class="simpara">
								By doing this, the build configuration created by the template now points to your fork of the application code, and you can modify the code and rebuild the application at will.
							</p></li></ol></div></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Some of the instant app and quick start templates define a database deployment configuration. The configuration they define uses ephemeral storage for the database content. These templates should be used for demonstration purposes only as all database data is lost if the database pod restarts for any reason.
				</p></div></div><section class="section" id="templates-quickstart_using-templates"><div class="titlepage"><div><div><h3 class="title">10.6.1. Quick start templates</h3></div></div></div><p>
					A quick start template is a basic example of an application running on OpenShift Container Platform. Quick starts come in a variety of languages and frameworks, and are defined in a template, which is constructed from a set of services, build configurations, and deployment configurations. This template references the necessary images and source repositories to build and deploy the application.
				</p><p>
					To explore a quick start, create an application from a template. Your administrator must have already installed these templates in your OpenShift Container Platform cluster, in which case you can simply select it from the web console.
				</p><p>
					Quick starts refer to a source repository that contains the application source code. To customize the quick start, fork the repository and, when creating an application from the template, substitute the default source repository name with your forked repository. This results in builds that are performed using your source code instead of the provided example source. You can then update the code in your source repository and launch a new build to see the changes reflected in the deployed application.
				</p><section class="section" id="templates-quickstart-web-framework_using-templates"><div class="titlepage"><div><div><h4 class="title">10.6.1.1. Web framework quick start templates</h4></div></div></div><p>
						These quick start templates provide a basic application of the indicated framework and language:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								CakePHP: a PHP web framework that includes a MySQL database
							</li><li class="listitem">
								Dancer: a Perl web framework that includes a MySQL database
							</li><li class="listitem">
								Django: a Python web framework that includes a PostgreSQL database
							</li><li class="listitem">
								NodeJS: a NodeJS web application that includes a MongoDB database
							</li><li class="listitem">
								Rails: a Ruby web framework that includes a PostgreSQL database
							</li></ul></div></section></section></section><section class="section" id="templates-writing_using-templates"><div class="titlepage"><div><div><h2 class="title">10.7. Writing templates</h2></div></div></div><p>
				You can define new templates to make it easy to recreate all the objects of your application. The template defines the objects it creates along with some metadata to guide the creation of those objects.
			</p><p>
				The following is an example of a simple template object definition (YAML):
			</p><pre class="programlisting language-yaml">apiVersion: template.openshift.io/v1
kind: Template
metadata:
  name: redis-template
  annotations:
    description: "Description"
    iconClass: "icon-redis"
    tags: "database,nosql"
objects:
- apiVersion: v1
  kind: Pod
  metadata:
    name: redis-master
  spec:
    containers:
    - env:
      - name: REDIS_PASSWORD
        value: ${REDIS_PASSWORD}
      image: dockerfile/redis
      name: master
      ports:
      - containerPort: 6379
        protocol: TCP
parameters:
- description: Password used for Redis authentication
  from: '[A-Z0-9]{8}'
  generate: expression
  name: REDIS_PASSWORD
labels:
  redis: master</pre><section class="section" id="templates-writing-description_using-templates"><div class="titlepage"><div><div><h3 class="title">10.7.1. Writing the template description</h3></div></div></div><p>
					The template description informs you what the template does and helps you find it when searching in the web console. Additional metadata beyond the template name is optional, but useful to have. In addition to general descriptive information, the metadata also includes a set of tags. Useful tags include the name of the language the template is related to for example, Java, PHP, Ruby, and so on.
				</p><p>
					The following is an example of template description metadata:
				</p><pre class="programlisting language-yaml">kind: Template
apiVersion: template.openshift.io/v1
metadata:
  name: cakephp-mysql-example <span id="CO21-1"><!--Empty--></span><span class="callout">1</span>
  annotations:
    openshift.io/display-name: "CakePHP MySQL Example (Ephemeral)" <span id="CO21-2"><!--Empty--></span><span class="callout">2</span>
    description: &gt;-
      An example CakePHP application with a MySQL database. For more information
      about using this template, including OpenShift considerations, see
      https://github.com/sclorg/cakephp-ex/blob/master/README.md.


      WARNING: Any data stored will be lost upon pod destruction. Only use this
      template for testing." <span id="CO21-3"><!--Empty--></span><span class="callout">3</span>
    openshift.io/long-description: &gt;-
      This template defines resources needed to develop a CakePHP application,
      including a build configuration, application DeploymentConfig, and
      database DeploymentConfig.  The database is stored in
      non-persistent storage, so this configuration should be used for
      experimental purposes only. <span id="CO21-4"><!--Empty--></span><span class="callout">4</span>
    tags: "quickstart,php,cakephp" <span id="CO21-5"><!--Empty--></span><span class="callout">5</span>
    iconClass: icon-php <span id="CO21-6"><!--Empty--></span><span class="callout">6</span>
    openshift.io/provider-display-name: "Red Hat, Inc." <span id="CO21-7"><!--Empty--></span><span class="callout">7</span>
    openshift.io/documentation-url: "https://github.com/sclorg/cakephp-ex" <span id="CO21-8"><!--Empty--></span><span class="callout">8</span>
    openshift.io/support-url: "https://access.redhat.com" <span id="CO21-9"><!--Empty--></span><span class="callout">9</span>
message: "Your admin credentials are ${ADMIN_USERNAME}:${ADMIN_PASSWORD}" <span id="CO21-10"><!--Empty--></span><span class="callout">10</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO21-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							The unique name of the template.
						</div></dd><dt><a href="#CO21-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							A brief, user-friendly name, which can be employed by user interfaces.
						</div></dd><dt><a href="#CO21-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							A description of the template. Include enough detail that users understand what is being deployed and any caveats they must know before deploying. It should also provide links to additional information, such as a README file. Newlines can be included to create paragraphs.
						</div></dd><dt><a href="#CO21-4"><span class="callout">4</span></a> </dt><dd><div class="para">
							Additional template description. This may be displayed by the service catalog, for example.
						</div></dd><dt><a href="#CO21-5"><span class="callout">5</span></a> </dt><dd><div class="para">
							Tags to be associated with the template for searching and grouping. Add tags that include it into one of the provided catalog categories. Refer to the <code class="literal">id</code> and <code class="literal">categoryAliases</code> in <code class="literal">CATALOG_CATEGORIES</code> in the console constants file. The categories can also be customized for the whole cluster.
						</div></dd><dt><a href="#CO21-6"><span class="callout">6</span></a> </dt><dd><div class="para">
							An icon to be displayed with your template in the web console.
						</div><div class="example" id="idm140424672460704"><p class="title"><strong>Example 10.1. Available icons</strong></p><div class="example-contents"><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">icon-3scale</code>
									</li><li class="listitem">
										<code class="literal">icon-aerogear</code>
									</li><li class="listitem">
										<code class="literal">icon-amq</code>
									</li><li class="listitem">
										<code class="literal">icon-angularjs</code>
									</li><li class="listitem">
										<code class="literal">icon-ansible</code>
									</li><li class="listitem">
										<code class="literal">icon-apache</code>
									</li><li class="listitem">
										<code class="literal">icon-beaker</code>
									</li><li class="listitem">
										<code class="literal">icon-camel</code>
									</li><li class="listitem">
										<code class="literal">icon-capedwarf</code>
									</li><li class="listitem">
										<code class="literal">icon-cassandra</code>
									</li><li class="listitem">
										<code class="literal">icon-catalog-icon</code>
									</li><li class="listitem">
										<code class="literal">icon-clojure</code>
									</li><li class="listitem">
										<code class="literal">icon-codeigniter</code>
									</li><li class="listitem">
										<code class="literal">icon-cordova</code>
									</li><li class="listitem">
										<code class="literal">icon-datagrid</code>
									</li><li class="listitem">
										<code class="literal">icon-datavirt</code>
									</li><li class="listitem">
										<code class="literal">icon-debian</code>
									</li><li class="listitem">
										<code class="literal">icon-decisionserver</code>
									</li><li class="listitem">
										<code class="literal">icon-django</code>
									</li><li class="listitem">
										<code class="literal">icon-dotnet</code>
									</li><li class="listitem">
										<code class="literal">icon-drupal</code>
									</li><li class="listitem">
										<code class="literal">icon-eap</code>
									</li><li class="listitem">
										<code class="literal">icon-elastic</code>
									</li><li class="listitem">
										<code class="literal">icon-erlang</code>
									</li><li class="listitem">
										<code class="literal">icon-fedora</code>
									</li><li class="listitem">
										<code class="literal">icon-freebsd</code>
									</li><li class="listitem">
										<code class="literal">icon-git</code>
									</li><li class="listitem">
										<code class="literal">icon-github</code>
									</li><li class="listitem">
										<code class="literal">icon-gitlab</code>
									</li><li class="listitem">
										<code class="literal">icon-glassfish</code>
									</li><li class="listitem">
										<code class="literal">icon-go-gopher</code>
									</li><li class="listitem">
										<code class="literal">icon-golang</code>
									</li><li class="listitem">
										<code class="literal">icon-grails</code>
									</li><li class="listitem">
										<code class="literal">icon-hadoop</code>
									</li><li class="listitem">
										<code class="literal">icon-haproxy</code>
									</li><li class="listitem">
										<code class="literal">icon-helm</code>
									</li><li class="listitem">
										<code class="literal">icon-infinispan</code>
									</li><li class="listitem">
										<code class="literal">icon-jboss</code>
									</li><li class="listitem">
										<code class="literal">icon-jenkins</code>
									</li><li class="listitem">
										<code class="literal">icon-jetty</code>
									</li><li class="listitem">
										<code class="literal">icon-joomla</code>
									</li><li class="listitem">
										<code class="literal">icon-jruby</code>
									</li><li class="listitem">
										<code class="literal">icon-js</code>
									</li><li class="listitem">
										<code class="literal">icon-knative</code>
									</li><li class="listitem">
										<code class="literal">icon-kubevirt</code>
									</li><li class="listitem">
										<code class="literal">icon-laravel</code>
									</li><li class="listitem">
										<code class="literal">icon-load-balancer</code>
									</li><li class="listitem">
										<code class="literal">icon-mariadb</code>
									</li><li class="listitem">
										<code class="literal">icon-mediawiki</code>
									</li><li class="listitem">
										<code class="literal">icon-memcached</code>
									</li><li class="listitem">
										<code class="literal">icon-mongodb</code>
									</li><li class="listitem">
										<code class="literal">icon-mssql</code>
									</li><li class="listitem">
										<code class="literal">icon-mysql-database</code>
									</li><li class="listitem">
										<code class="literal">icon-nginx</code>
									</li><li class="listitem">
										<code class="literal">icon-nodejs</code>
									</li><li class="listitem">
										<code class="literal">icon-openjdk</code>
									</li><li class="listitem">
										<code class="literal">icon-openliberty</code>
									</li><li class="listitem">
										<code class="literal">icon-openshift</code>
									</li><li class="listitem">
										<code class="literal">icon-openstack</code>
									</li><li class="listitem">
										<code class="literal">icon-other-linux</code>
									</li><li class="listitem">
										<code class="literal">icon-other-unknown</code>
									</li><li class="listitem">
										<code class="literal">icon-perl</code>
									</li><li class="listitem">
										<code class="literal">icon-phalcon</code>
									</li><li class="listitem">
										<code class="literal">icon-php</code>
									</li><li class="listitem">
										<code class="literal">icon-play</code>
									</li><li class="listitem">
										<code class="literal">iconpostgresql</code>
									</li><li class="listitem">
										<code class="literal">icon-processserver</code>
									</li><li class="listitem">
										<code class="literal">icon-python</code>
									</li><li class="listitem">
										<code class="literal">icon-quarkus</code>
									</li><li class="listitem">
										<code class="literal">icon-rabbitmq</code>
									</li><li class="listitem">
										<code class="literal">icon-rails</code>
									</li><li class="listitem">
										<code class="literal">icon-redhat</code>
									</li><li class="listitem">
										<code class="literal">icon-redis</code>
									</li><li class="listitem">
										<code class="literal">icon-rh-integration</code>
									</li><li class="listitem">
										<code class="literal">icon-rh-spring-boot</code>
									</li><li class="listitem">
										<code class="literal">icon-rh-tomcat</code>
									</li><li class="listitem">
										<code class="literal">icon-ruby</code>
									</li><li class="listitem">
										<code class="literal">icon-scala</code>
									</li><li class="listitem">
										<code class="literal">icon-serverlessfx</code>
									</li><li class="listitem">
										<code class="literal">icon-shadowman</code>
									</li><li class="listitem">
										<code class="literal">icon-spring-boot</code>
									</li><li class="listitem">
										<code class="literal">icon-spring</code>
									</li><li class="listitem">
										<code class="literal">icon-sso</code>
									</li><li class="listitem">
										<code class="literal">icon-stackoverflow</code>
									</li><li class="listitem">
										<code class="literal">icon-suse</code>
									</li><li class="listitem">
										<code class="literal">icon-symfony</code>
									</li><li class="listitem">
										<code class="literal">icon-tomcat</code>
									</li><li class="listitem">
										<code class="literal">icon-ubuntu</code>
									</li><li class="listitem">
										<code class="literal">icon-vertx</code>
									</li><li class="listitem">
										<code class="literal">icon-wildfly</code>
									</li><li class="listitem">
										<code class="literal">icon-windows</code>
									</li><li class="listitem">
										<code class="literal">icon-wordpress</code>
									</li><li class="listitem">
										<code class="literal">icon-xamarin</code>
									</li><li class="listitem">
										<code class="literal">icon-zend</code>
									</li></ul></div></div></div></dd><dt><a href="#CO21-7"><span class="callout">7</span></a> </dt><dd><div class="para">
							The name of the person or organization providing the template.
						</div></dd><dt><a href="#CO21-8"><span class="callout">8</span></a> </dt><dd><div class="para">
							A URL referencing further documentation for the template.
						</div></dd><dt><a href="#CO21-9"><span class="callout">9</span></a> </dt><dd><div class="para">
							A URL where support can be obtained for the template.
						</div></dd><dt><a href="#CO21-10"><span class="callout">10</span></a> </dt><dd><div class="para">
							An instructional message that is displayed when this template is instantiated. This field should inform the user how to use the newly created resources. Parameter substitution is performed on the message before being displayed so that generated credentials and other parameters can be included in the output. Include links to any next-steps documentation that users should follow.
						</div></dd></dl></div></section><section class="section" id="templates-writing-labels_using-templates"><div class="titlepage"><div><div><h3 class="title">10.7.2. Writing template labels</h3></div></div></div><p>
					Templates can include a set of labels. These labels are added to each object created when the template is instantiated. Defining a label in this way makes it easy for users to find and manage all the objects created from a particular template.
				</p><p>
					The following is an example of template object labels:
				</p><pre class="programlisting language-yaml">kind: "Template"
apiVersion: "v1"
...
labels:
  template: "cakephp-mysql-example" <span id="CO22-1"><!--Empty--></span><span class="callout">1</span>
  app: "${NAME}" <span id="CO22-2"><!--Empty--></span><span class="callout">2</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO22-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							A label that is applied to all objects created from this template.
						</div></dd><dt><a href="#CO22-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							A parameterized label that is also applied to all objects created from this template. Parameter expansion is carried out on both label keys and values.
						</div></dd></dl></div></section><section class="section" id="templates-writing-parameters_using-templates"><div class="titlepage"><div><div><h3 class="title">10.7.3. Writing template parameters</h3></div></div></div><p>
					Parameters allow a value to be supplied by you or generated when the template is instantiated. Then, that value is substituted wherever the parameter is referenced. References can be defined in any field in the objects list field. This is useful for generating random passwords or allowing you to supply a hostname or other user-specific value that is required to customize the template. Parameters can be referenced in two ways:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							As a string value by placing values in the form <code class="literal">${PARAMETER_NAME}</code> in any string field in the template.
						</li><li class="listitem">
							As a JSON or YAML value by placing values in the form <code class="literal">${{PARAMETER_NAME}}</code> in place of any field in the template.
						</li></ul></div><p>
					When using the <code class="literal">${PARAMETER_NAME}</code> syntax, multiple parameter references can be combined in a single field and the reference can be embedded within fixed data, such as <code class="literal">"http://${PARAMETER_1}${PARAMETER_2}"</code>. Both parameter values are substituted and the resulting value is a quoted string.
				</p><p>
					When using the <code class="literal">${{PARAMETER_NAME}}</code> syntax only a single parameter reference is allowed and leading and trailing characters are not permitted. The resulting value is unquoted unless, after substitution is performed, the result is not a valid JSON object. If the result is not a valid JSON value, the resulting value is quoted and treated as a standard string.
				</p><p>
					A single parameter can be referenced multiple times within a template and it can be referenced using both substitution syntaxes within a single template.
				</p><p>
					A default value can be provided, which is used if you do not supply a different value:
				</p><p>
					The following is an example of setting an explicit value as the default value:
				</p><pre class="programlisting language-yaml">parameters:
  - name: USERNAME
    description: "The user name for Joe"
    value: joe</pre><p>
					Parameter values can also be generated based on rules specified in the parameter definition, for example generating a parameter value:
				</p><pre class="programlisting language-yaml">parameters:
  - name: PASSWORD
    description: "The random user password"
    generate: expression
    from: "[a-zA-Z0-9]{12}"</pre><p>
					In the previous example, processing generates a random password 12 characters long consisting of all upper and lowercase alphabet letters and numbers.
				</p><p>
					The syntax available is not a full regular expression syntax. However, you can use <code class="literal">\w</code>, <code class="literal">\d</code>, <code class="literal">\a</code>, and <code class="literal">\A</code> modifiers:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">[\w]{10}</code> produces 10 alphabet characters, numbers, and underscores. This follows the PCRE standard and is equal to <code class="literal">[a-zA-Z0-9_]{10}</code>.
						</li><li class="listitem">
							<code class="literal">[\d]{10}</code> produces 10 numbers. This is equal to <code class="literal">[0-9]{10}</code>.
						</li><li class="listitem">
							<code class="literal">[\a]{10}</code> produces 10 alphabetical characters. This is equal to <code class="literal">[a-zA-Z]{10}</code>.
						</li><li class="listitem">
							<code class="literal">[\A]{10}</code> produces 10 punctuation or symbol characters. This is equal to <code class="literal">[~!@#$%\^&amp;*()\-_+={}\[\]\\|&lt;,&gt;.?/"';:`]{10}</code>.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Depending on if the template is written in YAML or JSON, and the type of string that the modifier is embedded within, you might need to escape the backslash with a second backslash. The following examples are equivalent:
					</p><div class="formalpara"><p class="title"><strong>Example YAML template with a modifier</strong></p><p>
							
<pre class="programlisting language-yaml">  parameters:
  - name: singlequoted_example
    generate: expression
    from: '[\A]{10}'
  - name: doublequoted_example
    generate: expression
    from: "[\\A]{10}"</pre>

						</p></div><div class="formalpara"><p class="title"><strong>Example JSON template with a modifier</strong></p><p>
							
<pre class="programlisting language-json">{
    "parameters": [
       {
        "name": "json_example",
        "generate": "expression",
        "from": "[\\A]{10}"
       }
    ]
}</pre>

						</p></div></div></div><p>
					Here is an example of a full template with parameter definitions and references:
				</p><pre class="programlisting language-yaml">kind: Template
apiVersion: template.openshift.io/v1
metadata:
  name: my-template
objects:
  - kind: BuildConfig
    apiVersion: build.openshift.io/v1
    metadata:
      name: cakephp-mysql-example
      annotations:
        description: Defines how to build the application
    spec:
      source:
        type: Git
        git:
          uri: "${SOURCE_REPOSITORY_URL}" <span id="CO23-1"><!--Empty--></span><span class="callout">1</span>
          ref: "${SOURCE_REPOSITORY_REF}"
        contextDir: "${CONTEXT_DIR}"
  - kind: DeploymentConfig
    apiVersion: apps.openshift.io/v1
    metadata:
      name: frontend
    spec:
      replicas: "${{REPLICA_COUNT}}" <span id="CO23-2"><!--Empty--></span><span class="callout">2</span>
parameters:
  - name: SOURCE_REPOSITORY_URL <span id="CO23-3"><!--Empty--></span><span class="callout">3</span>
    displayName: Source Repository URL <span id="CO23-4"><!--Empty--></span><span class="callout">4</span>
    description: The URL of the repository with your application source code <span id="CO23-5"><!--Empty--></span><span class="callout">5</span>
    value: https://github.com/sclorg/cakephp-ex.git <span id="CO23-6"><!--Empty--></span><span class="callout">6</span>
    required: true <span id="CO23-7"><!--Empty--></span><span class="callout">7</span>
  - name: GITHUB_WEBHOOK_SECRET
    description: A secret string used to configure the GitHub webhook
    generate: expression <span id="CO23-8"><!--Empty--></span><span class="callout">8</span>
    from: "[a-zA-Z0-9]{40}" <span id="CO23-9"><!--Empty--></span><span class="callout">9</span>
  - name: REPLICA_COUNT
    description: Number of replicas to run
    value: "2"
    required: true
message: "... The GitHub webhook secret is ${GITHUB_WEBHOOK_SECRET} ..." <span id="CO23-10"><!--Empty--></span><span class="callout">10</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO23-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							This value is replaced with the value of the <code class="literal">SOURCE_REPOSITORY_URL</code> parameter when the template is instantiated.
						</div></dd><dt><a href="#CO23-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							This value is replaced with the unquoted value of the <code class="literal">REPLICA_COUNT</code> parameter when the template is instantiated.
						</div></dd><dt><a href="#CO23-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							The name of the parameter. This value is used to reference the parameter within the template.
						</div></dd><dt><a href="#CO23-4"><span class="callout">4</span></a> </dt><dd><div class="para">
							The user-friendly name for the parameter. This is displayed to users.
						</div></dd><dt><a href="#CO23-5"><span class="callout">5</span></a> </dt><dd><div class="para">
							A description of the parameter. Provide more detailed information for the purpose of the parameter, including any constraints on the expected value. Descriptions should use complete sentences to follow the console’s text standards. Do not make this a duplicate of the display name.
						</div></dd><dt><a href="#CO23-6"><span class="callout">6</span></a> </dt><dd><div class="para">
							A default value for the parameter which is used if you do not override the value when instantiating the template. Avoid using default values for things like passwords, instead use generated parameters in combination with secrets.
						</div></dd><dt><a href="#CO23-7"><span class="callout">7</span></a> </dt><dd><div class="para">
							Indicates this parameter is required, meaning you cannot override it with an empty value. If the parameter does not provide a default or generated value, you must supply a value.
						</div></dd><dt><a href="#CO23-8"><span class="callout">8</span></a> </dt><dd><div class="para">
							A parameter which has its value generated.
						</div></dd><dt><a href="#CO23-9"><span class="callout">9</span></a> </dt><dd><div class="para">
							The input to the generator. In this case, the generator produces a 40 character alphanumeric value including upper and lowercase characters.
						</div></dd><dt><a href="#CO23-10"><span class="callout">10</span></a> </dt><dd><div class="para">
							Parameters can be included in the template message. This informs you about generated values.
						</div></dd></dl></div></section><section class="section" id="templates-writing-object-list_using-templates"><div class="titlepage"><div><div><h3 class="title">10.7.4. Writing the template object list</h3></div></div></div><p>
					The main portion of the template is the list of objects which is created when the template is instantiated. This can be any valid API object, such as a build configuration, deployment configuration, or service. The object is created exactly as defined here, with any parameter values substituted in prior to creation. The definition of these objects can reference parameters defined earlier.
				</p><p>
					The following is an example of an object list:
				</p><pre class="programlisting language-yaml">kind: "Template"
apiVersion: "v1"
metadata:
  name: my-template
objects:
  - kind: "Service" <span id="CO24-1"><!--Empty--></span><span class="callout">1</span>
    apiVersion: "v1"
    metadata:
      name: "cakephp-mysql-example"
      annotations:
        description: "Exposes and load balances the application pods"
    spec:
      ports:
        - name: "web"
          port: 8080
          targetPort: 8080
      selector:
        name: "cakephp-mysql-example"</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO24-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							The definition of a service, which is created by this template.
						</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If an object definition metadata includes a fixed <code class="literal">namespace</code> field value, the field is stripped out of the definition during template instantiation. If the <code class="literal">namespace</code> field contains a parameter reference, normal parameter substitution is performed and the object is created in whatever namespace the parameter substitution resolved the value to, assuming the user has permission to create objects in that namespace.
					</p></div></div></section><section class="section" id="templates-marking-as-bindable_using-templates"><div class="titlepage"><div><div><h3 class="title">10.7.5. Marking a template as bindable</h3></div></div></div><p>
					The Template Service Broker advertises one service in its catalog for each template object of which it is aware. By default, each of these services is advertised as being bindable, meaning an end user is permitted to bind against the provisioned service.
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Template authors can prevent end users from binding against services provisioned from a given template.
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Prevent end user from binding against services provisioned from a given template by adding the annotation <code class="literal">template.openshift.io/bindable: "false"</code> to the template.
						</li></ul></div></section><section class="section" id="templates-exposing-object-fields_using-templates"><div class="titlepage"><div><div><h3 class="title">10.7.6. Exposing template object fields</h3></div></div></div><p>
					Template authors can indicate that fields of particular objects in a template should be exposed. The Template Service Broker recognizes exposed fields on <code class="literal">ConfigMap</code>, <code class="literal">Secret</code>, <code class="literal">Service</code>, and <code class="literal">Route</code> objects, and returns the values of the exposed fields when a user binds a service backed by the broker.
				</p><p>
					To expose one or more fields of an object, add annotations prefixed by <code class="literal">template.openshift.io/expose-</code> or <code class="literal">template.openshift.io/base64-expose-</code> to the object in the template.
				</p><p>
					Each annotation key, with its prefix removed, is passed through to become a key in a <code class="literal">bind</code> response.
				</p><p>
					Each annotation value is a Kubernetes JSONPath expression, which is resolved at bind time to indicate the object field whose value should be returned in the <code class="literal">bind</code> response.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						<code class="literal">Bind</code> response key-value pairs can be used in other parts of the system as environment variables. Therefore, it is recommended that every annotation key with its prefix removed should be a valid environment variable name — beginning with a character <code class="literal">A-Z</code>, <code class="literal">a-z</code>, or <code class="literal">_</code>, and being followed by zero or more characters <code class="literal">A-Z</code>, <code class="literal">a-z</code>, <code class="literal">0-9</code>, or <code class="literal">_</code>.
					</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Unless escaped with a backslash, Kubernetes' JSONPath implementation interprets characters such as <code class="literal">.</code>, <code class="literal">@</code>, and others as metacharacters, regardless of their position in the expression. Therefore, for example, to refer to a <code class="literal">ConfigMap</code> datum named <code class="literal">my.key</code>, the required JSONPath expression would be <code class="literal">{.data['my\.key']}</code>. Depending on how the JSONPath expression is then written in YAML, an additional backslash might be required, for example <code class="literal">"{.data['my\\.key']}"</code>.
					</p></div></div><p>
					The following is an example of different objects' fields being exposed:
				</p><pre class="programlisting language-yaml">kind: Template
apiVersion: template.openshift.io/v1
metadata:
  name: my-template
objects:
- kind: ConfigMap
  apiVersion: v1
  metadata:
    name: my-template-config
    annotations:
      template.openshift.io/expose-username: "{.data['my\\.username']}"
  data:
    my.username: foo
- kind: Secret
  apiVersion: v1
  metadata:
    name: my-template-config-secret
    annotations:
      template.openshift.io/base64-expose-password: "{.data['password']}"
  stringData:
    password: &lt;password&gt;
- kind: Service
  apiVersion: v1
  metadata:
    name: my-template-service
    annotations:
      template.openshift.io/expose-service_ip_port: "{.spec.clusterIP}:{.spec.ports[?(.name==\"web\")].port}"
  spec:
    ports:
    - name: "web"
      port: 8080
- kind: Route
  apiVersion: route.openshift.io/v1
  metadata:
    name: my-template-route
    annotations:
      template.openshift.io/expose-uri: "http://{.spec.host}{.spec.path}"
  spec:
    path: mypath</pre><p>
					An example response to a <code class="literal">bind</code> operation given the above partial template follows:
				</p><pre class="programlisting language-json">{
  "credentials": {
    "username": "foo",
    "password": "YmFy",
    "service_ip_port": "172.30.12.34:8080",
    "uri": "http://route-test.router.default.svc.cluster.local/mypath"
  }
}</pre><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Use the <code class="literal">template.openshift.io/expose-</code> annotation to return the field value as a string. This is convenient, although it does not handle arbitrary binary data.
						</li><li class="listitem">
							If you want to return binary data, use the <code class="literal">template.openshift.io/base64-expose-</code> annotation instead to base64 encode the data before it is returned.
						</li></ul></div></section><section class="section" id="templates-waiting-for-readiness_using-templates"><div class="titlepage"><div><div><h3 class="title">10.7.7. Waiting for template readiness</h3></div></div></div><p>
					Template authors can indicate that certain objects within a template should be waited for before a template instantiation by the service catalog, Template Service Broker, or <code class="literal">TemplateInstance</code> API is considered complete.
				</p><p>
					To use this feature, mark one or more objects of kind <code class="literal">Build</code>, <code class="literal">BuildConfig</code>, <code class="literal">Deployment</code>, <code class="literal">DeploymentConfig</code>, <code class="literal">Job</code>, or <code class="literal">StatefulSet</code> in a template with the following annotation:
				</p><pre class="programlisting language-text">"template.alpha.openshift.io/wait-for-ready": "true"</pre><p>
					Template instantiation is not complete until all objects marked with the annotation report ready. Similarly, if any of the annotated objects report failed, or if the template fails to become ready within a fixed timeout of one hour, the template instantiation fails.
				</p><p>
					For the purposes of instantiation, readiness and failure of each object kind are defined as follows:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 40%; " class="col_2"><!--Empty--></col><col style="width: 40%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140424672803872" scope="col">Kind</th><th align="left" valign="top" id="idm140424672802784" scope="col">Readiness</th><th align="left" valign="top" id="idm140424672801696" scope="col">Failure</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140424672803872"> <p>
									<code class="literal">Build</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424672802784"> <p>
									Object reports phase complete.
								</p>
								 </td><td align="left" valign="top" headers="idm140424672801696"> <p>
									Object reports phase canceled, error, or failed.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424672803872"> <p>
									<code class="literal">BuildConfig</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424672802784"> <p>
									Latest associated build object reports phase complete.
								</p>
								 </td><td align="left" valign="top" headers="idm140424672801696"> <p>
									Latest associated build object reports phase canceled, error, or failed.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424672803872"> <p>
									<code class="literal">Deployment</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424672802784"> <p>
									Object reports new replica set and deployment available. This honors readiness probes defined on the object.
								</p>
								 </td><td align="left" valign="top" headers="idm140424672801696"> <p>
									Object reports progressing condition as false.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424672803872"> <p>
									<code class="literal">DeploymentConfig</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424672802784"> <p>
									Object reports new replication controller and deployment available. This honors readiness probes defined on the object.
								</p>
								 </td><td align="left" valign="top" headers="idm140424672801696"> <p>
									Object reports progressing condition as false.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424672803872"> <p>
									<code class="literal">Job</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424672802784"> <p>
									Object reports completion.
								</p>
								 </td><td align="left" valign="top" headers="idm140424672801696"> <p>
									Object reports that one or more failures have occurred.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140424672803872"> <p>
									<code class="literal">StatefulSet</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140424672802784"> <p>
									Object reports all replicas ready. This honors readiness probes defined on the object.
								</p>
								 </td><td align="left" valign="top" headers="idm140424672801696"> <p>
									Not applicable.
								</p>
								 </td></tr></tbody></table></div><p>
					The following is an example template extract, which uses the <code class="literal">wait-for-ready</code> annotation. Further examples can be found in the OpenShift Container Platform quick start templates.
				</p><pre class="programlisting language-yaml">kind: Template
apiVersion: template.openshift.io/v1
metadata:
  name: my-template
objects:
- kind: BuildConfig
  apiVersion: build.openshift.io/v1
  metadata:
    name: ...
    annotations:
      # wait-for-ready used on BuildConfig ensures that template instantiation
      # will fail immediately if build fails
      template.alpha.openshift.io/wait-for-ready: "true"
  spec:
    ...
- kind: DeploymentConfig
  apiVersion: apps.openshift.io/v1
  metadata:
    name: ...
    annotations:
      template.alpha.openshift.io/wait-for-ready: "true"
  spec:
    ...
- kind: Service
  apiVersion: v1
  metadata:
    name: ...
  spec:
    ...</pre><div class="itemizedlist"><p class="title"><strong>Additional recommendations</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Set memory, CPU, and storage default sizes to make sure your application is given enough resources to run smoothly.
						</li><li class="listitem">
							Avoid referencing the <code class="literal">latest</code> tag from images if that tag is used across major versions. This can cause running applications to break when new images are pushed to that tag.
						</li><li class="listitem">
							A good template builds and deploys cleanly without requiring modifications after the template is deployed.
						</li></ul></div></section><section class="section" id="templates-create-from-existing-object_using-templates"><div class="titlepage"><div><div><h3 class="title">10.7.8. Creating a template from existing objects</h3></div></div></div><p>
					Rather than writing an entire template from scratch, you can export existing objects from your project in YAML form, and then modify the YAML from there by adding parameters and other customizations as template form.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Export objects in a project in YAML form:
						</p><pre class="programlisting language-terminal">$ oc get -o yaml all &gt; &lt;yaml_filename&gt;</pre><p class="simpara">
							You can also substitute a particular resource type or multiple resources instead of <code class="literal">all</code>. Run <code class="literal">oc get -h</code> for more examples.
						</p><p class="simpara">
							The object types included in <code class="literal">oc get -o yaml all</code> are:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<code class="literal">BuildConfig</code>
								</li><li class="listitem">
									<code class="literal">Build</code>
								</li><li class="listitem">
									<code class="literal">DeploymentConfig</code>
								</li><li class="listitem">
									<code class="literal">ImageStream</code>
								</li><li class="listitem">
									<code class="literal">Pod</code>
								</li><li class="listitem">
									<code class="literal">ReplicationController</code>
								</li><li class="listitem">
									<code class="literal">Route</code>
								</li><li class="listitem">
									<code class="literal">Service</code>
								</li></ul></div></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Using the <code class="literal">all</code> alias is not recommended because the contents might vary across different clusters and versions. Instead, specify all required resources.
					</p></div></div></section></section></section><section class="chapter" id="templates-using-ruby-on-rails"><div class="titlepage"><div><div><h1 class="title">Chapter 11. Using Ruby on Rails</h1></div></div></div><p>
			Ruby on Rails is a web framework written in Ruby. This guide covers using Rails 4 on OpenShift Container Platform.
		</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
				Go through the whole tutorial to have an overview of all the steps necessary to run your application on the OpenShift Container Platform. If you experience a problem try reading through the entire tutorial and then going back to your issue. It can also be useful to review your previous steps to ensure that all the steps were run correctly.
			</p></div></div><section class="section" id="prerequisites"><div class="titlepage"><div><div><h2 class="title">11.1. Prerequisites</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Basic Ruby and Rails knowledge.
					</li><li class="listitem">
						Locally installed version of Ruby 2.0.0+, Rubygems, Bundler.
					</li><li class="listitem">
						Basic Git knowledge.
					</li><li class="listitem">
						Running instance of OpenShift Container Platform 4.
					</li><li class="listitem">
						Make sure that an instance of OpenShift Container Platform is running and is available. Also make sure that your <code class="literal">oc</code> CLI client is installed and the command is accessible from your command shell, so you can use it to log in using your email address and password.
					</li></ul></div></section><section class="section" id="templates-rails-setting-up-database_templates-ruby-on-rails"><div class="titlepage"><div><div><h2 class="title">11.2. Setting up the database</h2></div></div></div><p>
				Rails applications are almost always used with a database. For local development use the PostgreSQL database.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the database:
					</p><pre class="programlisting language-terminal">$ sudo yum install -y postgresql postgresql-server postgresql-devel</pre></li><li class="listitem"><p class="simpara">
						Initialize the database:
					</p><pre class="programlisting language-terminal">$ sudo postgresql-setup initdb</pre><p class="simpara">
						This command creates the <code class="literal">/var/lib/pgsql/data</code> directory, in which the data is stored.
					</p></li><li class="listitem"><p class="simpara">
						Start the database:
					</p><pre class="programlisting language-terminal">$ sudo systemctl start postgresql.service</pre></li><li class="listitem"><p class="simpara">
						When the database is running, create your <code class="literal">rails</code> user:
					</p><pre class="programlisting language-terminal">$ sudo -u postgres createuser -s rails</pre><p class="simpara">
						Note that the user created has no password.
					</p></li></ol></div></section><section class="section" id="templates-rails-writing-application_templates-ruby-on-rails"><div class="titlepage"><div><div><h2 class="title">11.3. Writing your application</h2></div></div></div><p>
				If you are starting your Rails application from scratch, you must install the Rails gem first. Then you can proceed with writing your application.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the Rails gem:
					</p><pre class="programlisting language-terminal">$ gem install rails</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
							
<pre class="programlisting language-terminal">Successfully installed rails-4.3.0
1 gem installed</pre>

						</p></div></li><li class="listitem"><p class="simpara">
						After you install the Rails gem, create a new application with PostgreSQL as your database:
					</p><pre class="programlisting language-terminal">$ rails new rails-app --database=postgresql</pre></li><li class="listitem"><p class="simpara">
						Change into your new application directory:
					</p><pre class="programlisting language-terminal">$ cd rails-app</pre></li><li class="listitem"><p class="simpara">
						If you already have an application, make sure the <code class="literal">pg</code> (postgresql) gem is present in your <code class="literal">Gemfile</code>. If not, edit your <code class="literal">Gemfile</code> by adding the gem:
					</p><pre class="programlisting language-terminal">gem 'pg'</pre></li><li class="listitem"><p class="simpara">
						Generate a new <code class="literal">Gemfile.lock</code> with all your dependencies:
					</p><pre class="programlisting language-terminal">$ bundle install</pre></li><li class="listitem"><p class="simpara">
						In addition to using the <code class="literal">postgresql</code> database with the <code class="literal">pg</code> gem, you also must ensure that the <code class="literal">config/database.yml</code> is using the <code class="literal">postgresql</code> adapter.
					</p><p class="simpara">
						Make sure you updated <code class="literal">default</code> section in the <code class="literal">config/database.yml</code> file, so it looks like this:
					</p><pre class="programlisting language-yaml">default: &amp;default
  adapter: postgresql
  encoding: unicode
  pool: 5
  host: localhost
  username: rails
  password: &lt;password&gt;</pre></li><li class="listitem"><p class="simpara">
						Create your application’s development and test databases:
					</p><pre class="programlisting language-terminal">$ rake db:create</pre><p class="simpara">
						This creates <code class="literal">development</code> and <code class="literal">test</code> database in your PostgreSQL server.
					</p></li></ol></div><section class="section" id="templates-rails-creating-welcome-page_templates-ruby-on-rails"><div class="titlepage"><div><div><h3 class="title">11.3.1. Creating a welcome page</h3></div></div></div><p>
					Since Rails 4 no longer serves a static <code class="literal">public/index.html</code> page in production, you must create a new root page.
				</p><p>
					To have a custom welcome page must do following steps:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Create a controller with an index action.
						</li><li class="listitem">
							Create a view page for the welcome controller index action.
						</li><li class="listitem">
							Create a route that serves applications root page with the created controller and view.
						</li></ul></div><p>
					Rails offers a generator that completes all necessary steps for you.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run Rails generator:
						</p><pre class="programlisting language-terminal">$ rails generate controller welcome index</pre><p class="simpara">
							All the necessary files are created.
						</p></li><li class="listitem"><p class="simpara">
							edit line 2 in <code class="literal">config/routes.rb</code> file as follows:
						</p><pre class="screen">root 'welcome#index'</pre></li><li class="listitem"><p class="simpara">
							Run the rails server to verify the page is available:
						</p><pre class="programlisting language-terminal">$ rails server</pre><p class="simpara">
							You should see your page by visiting <a class="link" href="http://localhost:3000">http://localhost:3000</a> in your browser. If you do not see the page, check the logs that are output to your server to debug.
						</p></li></ol></div></section><section class="section" id="templates-rails-configuring-application_templates-ruby-on-rails"><div class="titlepage"><div><div><h3 class="title">11.3.2. Configuring application for OpenShift Container Platform</h3></div></div></div><p>
					To have your application communicate with the PostgreSQL database service running in OpenShift Container Platform you must edit the <code class="literal">default</code> section in your <code class="literal">config/database.yml</code> to use environment variables, which you must define later, upon the database service creation.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">default</code> section in your <code class="literal">config/database.yml</code> with pre-defined variables as follows:
						</p><div class="formalpara"><p class="title"><strong>Sample <code class="literal">config/database</code> YAML file</strong></p><p>
								
<pre class="programlisting language-eruby">&lt;% user = ENV.key?("POSTGRESQL_ADMIN_PASSWORD") ? "root" : ENV["POSTGRESQL_USER"] %&gt;
&lt;% password = ENV.key?("POSTGRESQL_ADMIN_PASSWORD") ? ENV["POSTGRESQL_ADMIN_PASSWORD"] : ENV["POSTGRESQL_PASSWORD"] %&gt;
&lt;% db_service = ENV.fetch("DATABASE_SERVICE_NAME","").upcase %&gt;

default: &amp;default
  adapter: postgresql
  encoding: unicode
  # For details on connection pooling, see rails configuration guide
  # http://guides.rubyonrails.org/configuring.html#database-pooling
  pool: &lt;%= ENV["POSTGRESQL_MAX_CONNECTIONS"] || 5 %&gt;
  username: &lt;%= user %&gt;
  password: &lt;%= password %&gt;
  host: &lt;%= ENV["#{db_service}_SERVICE_HOST"] %&gt;
  port: &lt;%= ENV["#{db_service}_SERVICE_PORT"] %&gt;
  database: &lt;%= ENV["POSTGRESQL_DATABASE"] %&gt;</pre>

							</p></div></li></ul></div></section><section class="section" id="templates-rails-storing-application-in-git_templates-ruby-on-rails"><div class="titlepage"><div><div><h3 class="title">11.3.3. Storing your application in Git</h3></div></div></div><p>
					Building an application in OpenShift Container Platform usually requires that the source code be stored in a git repository, so you must install <code class="literal">git</code> if you do not already have it.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Install git.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Make sure you are in your Rails application directory by running the <code class="literal">ls -1</code> command. The output of the command should look like:
						</p><pre class="programlisting language-terminal">$ ls -1</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">app
bin
config
config.ru
db
Gemfile
Gemfile.lock
lib
log
public
Rakefile
README.rdoc
test
tmp
vendor</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Run the following commands in your Rails app directory to initialize and commit your code to git:
						</p><pre class="programlisting language-terminal">$ git init</pre><pre class="programlisting language-terminal">$ git add .</pre><pre class="programlisting language-terminal">$ git commit -m "initial commit"</pre><p class="simpara">
							After your application is committed you must push it to a remote repository. GitHub account, in which you create a new repository.
						</p></li><li class="listitem"><p class="simpara">
							Set the remote that points to your <code class="literal">git</code> repository:
						</p><pre class="programlisting language-terminal">$ git remote add origin git@github.com:&lt;namespace/repository-name&gt;.git</pre></li><li class="listitem"><p class="simpara">
							Push your application to your remote git repository.
						</p><pre class="programlisting language-terminal">$ git push</pre></li></ol></div></section></section><section class="section" id="templates-rails-deploying-application_templates-ruby-on-rails"><div class="titlepage"><div><div><h2 class="title">11.4. Deploying your application to OpenShift Container Platform</h2></div></div></div><p>
				You can deploy you application to OpenShift Container Platform.
			</p><p>
				After creating the <code class="literal">rails-app</code> project, you are automatically switched to the new project namespace.
			</p><p>
				Deploying your application in OpenShift Container Platform involves three steps:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Creating a database service from OpenShift Container Platform’s PostgreSQL image.
					</li><li class="listitem">
						Creating a frontend service from OpenShift Container Platform’s Ruby 2.0 builder image and your Ruby on Rails source code, which are wired with the database service.
					</li><li class="listitem">
						Creating a route for your application.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To deploy your Ruby on Rails application, create a new project for the application:
					</p><pre class="programlisting language-terminal">$ oc new-project rails-app --description="My Rails application" --display-name="Rails Application"</pre></li></ul></div><section class="section" id="templates-rails-creating-database-service_templates-ruby-on-rails"><div class="titlepage"><div><div><h3 class="title">11.4.1. Creating the database service</h3></div></div></div><p>
					Your Rails application expects a running database service. For this service use PostgreSQL database image.
				</p><p>
					To create the database service, use the <code class="literal">oc new-app</code> command. To this command you must pass some necessary environment variables which are used inside the database container. These environment variables are required to set the username, password, and name of the database. You can change the values of these environment variables to anything you would like. The variables are as follows:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							POSTGRESQL_DATABASE
						</li><li class="listitem">
							POSTGRESQL_USER
						</li><li class="listitem">
							POSTGRESQL_PASSWORD
						</li></ul></div><p>
					Setting these variables ensures:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A database exists with the specified name.
						</li><li class="listitem">
							A user exists with the specified name.
						</li><li class="listitem">
							The user can access the specified database with the specified password.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create the database service:
						</p><pre class="programlisting language-terminal">$ oc new-app postgresql -e POSTGRESQL_DATABASE=db_name -e POSTGRESQL_USER=username -e POSTGRESQL_PASSWORD=password</pre><p class="simpara">
							To also set the password for the database administrator, append to the previous command with:
						</p><pre class="programlisting language-terminal">-e POSTGRESQL_ADMIN_PASSWORD=admin_pw</pre></li><li class="listitem"><p class="simpara">
							Watch the progress:
						</p><pre class="programlisting language-terminal">$ oc get pods --watch</pre></li></ol></div></section><section class="section" id="templates-rails-creating-frontend-service_templates-ruby-on-rails"><div class="titlepage"><div><div><h3 class="title">11.4.2. Creating the frontend service</h3></div></div></div><p>
					To bring your application to OpenShift Container Platform, you must specify a repository in which your application lives.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create the frontend service and specify database related environment variables that were setup when creating the database service:
						</p><pre class="programlisting language-terminal">$ oc new-app path/to/source/code --name=rails-app -e POSTGRESQL_USER=username -e POSTGRESQL_PASSWORD=password -e POSTGRESQL_DATABASE=db_name -e DATABASE_SERVICE_NAME=postgresql</pre><p class="simpara">
							With this command, OpenShift Container Platform fetches the source code, sets up the builder, builds your application image, and deploys the newly created image together with the specified environment variables. The application is named <code class="literal">rails-app</code>.
						</p></li><li class="listitem"><p class="simpara">
							Verify the environment variables have been added by viewing the JSON document of the <code class="literal">rails-app</code> deployment config:
						</p><pre class="programlisting language-terminal">$ oc get dc rails-app -o json</pre><p class="simpara">
							You should see the following section:
						</p><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-json">env": [
    {
        "name": "POSTGRESQL_USER",
        "value": "username"
    },
    {
        "name": "POSTGRESQL_PASSWORD",
        "value": "password"
    },
    {
        "name": "POSTGRESQL_DATABASE",
        "value": "db_name"
    },
    {
        "name": "DATABASE_SERVICE_NAME",
        "value": "postgresql"
    }

],</pre>

							</p></div></li><li class="listitem"><p class="simpara">
							Check the build process:
						</p><pre class="programlisting language-terminal">$ oc logs -f build/rails-app-1</pre></li><li class="listitem"><p class="simpara">
							After the build is complete, look at the running pods in OpenShift Container Platform:
						</p><pre class="programlisting language-terminal">$ oc get pods</pre><p class="simpara">
							You should see a line starting with <code class="literal">myapp-&lt;number&gt;-&lt;hash&gt;</code>, and that is your application running in OpenShift Container Platform.
						</p></li><li class="listitem"><p class="simpara">
							Before your application is functional, you must initialize the database by running the database migration script. There are two ways you can do this:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Manually from the running frontend container:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
											Exec into frontend container with <code class="literal">rsh</code> command:
										</p><pre class="programlisting language-terminal">$ oc rsh &lt;frontend_pod_id&gt;</pre></li><li class="listitem"><p class="simpara">
											Run the migration from inside the container:
										</p><pre class="programlisting language-terminal">$ RAILS_ENV=production bundle exec rake db:migrate</pre><p class="simpara">
											If you are running your Rails application in a <code class="literal">development</code> or <code class="literal">test</code> environment you do not have to specify the <code class="literal">RAILS_ENV</code> environment variable.
										</p></li></ul></div></li><li class="listitem">
									By adding pre-deployment lifecycle hooks in your template.
								</li></ul></div></li></ol></div></section><section class="section" id="templates-rails-creating-route-for-application_templates-ruby-on-rails"><div class="titlepage"><div><div><h3 class="title">11.4.3. Creating a route for your application</h3></div></div></div><p>
					You can expose a service to create a route for your application.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To expose a service by giving it an externally-reachable hostname like <code class="literal">www.example.com</code> use OpenShift Container Platform route. In your case you need to expose the frontend service by typing:
						</p><pre class="programlisting language-terminal">$ oc expose service rails-app --hostname=www.example.com</pre></li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Ensure the hostname you specify resolves into the IP address of the router.
					</p></div></div></section></section></section><section class="chapter" id="using-images"><div class="titlepage"><div><div><h1 class="title">Chapter 12. Using images</h1></div></div></div><section class="section" id="using-images-overview"><div class="titlepage"><div><div><h2 class="title">12.1. Using images overview</h2></div></div></div><p>
				Use the following topics to discover the different Source-to-Image (S2I), database, and other container images that are available for OpenShift Container Platform users.
			</p><p>
				Red Hat official container images are provided in the Red Hat Registry at <a class="link" href="https://registry.redhat.io">registry.redhat.io</a>. OpenShift Container Platform’s supported S2I, database, and Jenkins images are provided in the <code class="literal">openshift4</code> repository in the Red Hat Quay Registry. For example, <code class="literal">quay.io/openshift-release-dev/ocp-v4.0-&lt;address&gt;</code> is the name of the OpenShift Application Platform image.
			</p><p>
				The xPaaS middleware images are provided in their respective product repositories on the Red Hat Registry but suffixed with a <code class="literal">-openshift</code>. For example, <code class="literal">registry.redhat.io/jboss-eap-6/eap64-openshift</code> is the name of the JBoss EAP image.
			</p><p>
				All Red Hat supported images covered in this section are described in the <a class="link" href="https://catalog.redhat.com/software/containers/explore">Container images section of the Red Hat Ecosystem Catalog</a>. For every version of each image, you can find details on its contents and usage. Browse or search for the image that interests you.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The newer versions of container images are not compatible with earlier versions of OpenShift Container Platform. Verify and use the correct version of container images, based on your version of OpenShift Container Platform.
				</p></div></div></section><section class="section" id="using-s21-images"><div class="titlepage"><div><div><h2 class="title">12.2. Source-to-image</h2></div></div></div><p>
				You can use the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_software_collections/3/html-single/using_red_hat_software_collections_container_images/index">Red Hat Software Collections</a> images as a foundation for applications that rely on specific runtime environments such as Node.js, Perl, or Python. You can use the <a class="link" href="https://access.redhat.com/documentation/en-us/openjdk/11/html/using_openjdk_11_source-to-image_for_openshift/index">Red Hat Java Source-to-Image for OpenShift</a> documentation as a reference for runtime environments that use Java. Special versions of some of these runtime base images are referred to as Source-to-Image (S2I) images. With S2I images, you can insert your code into a base image environment that is ready to run that code.
			</p><p>
				S2I images include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						.NET
					</li><li class="listitem">
						Java
					</li><li class="listitem">
						Go
					</li><li class="listitem">
						Node.js
					</li><li class="listitem">
						Perl
					</li><li class="listitem">
						PHP
					</li><li class="listitem">
						Python
					</li><li class="listitem">
						Ruby
					</li></ul></div><p>
				S2I images are available for you to use directly from the OpenShift Container Platform web console by following procedure:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Log in to the OpenShift Container Platform web console using your login credentials. The default view for the OpenShift Container Platform web console is the <span class="strong strong"><strong>Administrator</strong></span> perspective.
					</li><li class="listitem">
						Use the perspective switcher to switch to the <span class="strong strong"><strong>Developer</strong></span> perspective.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>+Add</strong></span> view, select an existing project from the list or use the <span class="strong strong"><strong>Project</strong></span> drop-down list to create a new project.
					</li><li class="listitem">
						Choose <span class="strong strong"><strong>All services</strong></span> under the tile <span class="strong strong"><strong>Developer Catalog</strong></span>.
					</li><li class="listitem">
						Select the Type <span class="strong strong"><strong>Builder Images</strong></span> then can see the available S2I images.
					</li></ol></div><p>
				S2I images are also available though the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#configuring-samples-operator">Configuring the Cluster Samples Operator</a>.
			</p><section class="section" id="images-s2i-build-process-overview_using-s21-images"><div class="titlepage"><div><div><h3 class="title">12.2.1. Source-to-image build process overview</h3></div></div></div><p>
					Source-to-image (S2I) produces ready-to-run images by injecting source code into a container that prepares that source code to be run. It performs the following steps:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Runs the <code class="literal">FROM &lt;builder image&gt;</code> command
						</li><li class="listitem">
							Copies the source code to a defined location in the builder image
						</li><li class="listitem">
							Runs the assemble script in the builder image
						</li><li class="listitem">
							Sets the run script in the builder image as the default command
						</li></ol></div><p>
					Buildah then creates the container image.
				</p></section><section class="section _additional-resources" id="additional-resources_using-s21-images"><div class="titlepage"><div><div><h3 class="title">12.2.2. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							For instructions on using the Cluster Samples Operator, see the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#configuring-samples-operator">Configuring the Cluster Samples Operator</a>.
						</li><li class="listitem">
							For more information on S2I builds, see the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/cicd/#builds-strategy-s2i-build_build-strategies">builds strategy documentation on S2I builds</a>.
						</li><li class="listitem">
							For troubleshooting assistance for the S2I process, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/support/#troubleshooting-s2i">Troubleshooting the Source-to-Image process</a>.
						</li><li class="listitem">
							For an overview of creating images with S2I, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#images-create-s2i_create-images">Creating images from source code with source-to-image</a>.
						</li><li class="listitem">
							For an overview of testing S2I images, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html-single/images/#images-test-s2i_create-images">About testing S2I images</a>.
						</li></ul></div></section></section><section class="section" id="customizing-s2i-images"><div class="titlepage"><div><div><h2 class="title">12.3. Customizing source-to-image images</h2></div></div></div><p>
				Source-to-image (S2I) builder images include assemble and run scripts, but the default behavior of those scripts is not suitable for all users. You can customize the behavior of an S2I builder that includes default scripts.
			</p><section class="section" id="images-using-customizing-s2i-images-scripts-embedded_customizing-s2i-images"><div class="titlepage"><div><div><h3 class="title">12.3.1. Invoking scripts embedded in an image</h3></div></div></div><p>
					Builder images provide their own version of the source-to-image (S2I) scripts that cover the most common use-cases. If these scripts do not fulfill your needs, S2I provides a way of overriding them by adding custom ones in the <code class="literal">.s2i/bin</code> directory. However, by doing this, you are completely replacing the standard scripts. In some cases, replacing the scripts is acceptable, but, in other scenarios, you can run a few commands before or after the scripts while retaining the logic of the script provided in the image. To reuse the standard scripts, you can create a wrapper script that runs custom logic and delegates further work to the default scripts in the image.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Look at the value of the <code class="literal">io.openshift.s2i.scripts-url</code> label to determine the location of the scripts inside of the builder image:
						</p><pre class="programlisting language-terminal">$ podman inspect --format='{{ index .Config.Labels "io.openshift.s2i.scripts-url" }}' wildfly/wildfly-centos7</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
								
<pre class="programlisting language-terminal">image:///usr/libexec/s2i</pre>

							</p></div><p class="simpara">
							You inspected the <code class="literal">wildfly/wildfly-centos7</code> builder image and found out that the scripts are in the <code class="literal">/usr/libexec/s2i</code> directory.
						</p></li><li class="listitem"><p class="simpara">
							Create a script that includes an invocation of one of the standard scripts wrapped in other commands:
						</p><div class="formalpara"><p class="title"><strong><code class="literal">.s2i/bin/assemble</code> script</strong></p><p>
								
<pre class="programlisting language-bash">#!/bin/bash
echo "Before assembling"

/usr/libexec/s2i/assemble
rc=$?

if [ $rc -eq 0 ]; then
    echo "After successful assembling"
else
    echo "After failed assembling"
fi

exit $rc</pre>

							</p></div><p class="simpara">
							This example shows a custom assemble script that prints the message, runs the standard assemble script from the image, and prints another message depending on the exit code of the assemble script.
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								When wrapping the run script, you must use <code class="literal">exec</code> for invoking it to ensure signals are handled properly. The use of <code class="literal">exec</code> also precludes the ability to run additional commands after invoking the default image run script.
							</p></div></div><div class="formalpara"><p class="title"><strong><code class="literal">.s2i/bin/run</code> script</strong></p><p>
								
<pre class="programlisting language-bash">#!/bin/bash
echo "Before running application"
exec /usr/libexec/s2i/run</pre>

							</p></div></li></ol></div></section></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm140424673469136"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2023 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div>


  <nav class="pvof-doc__book-nav">
  <ol class="book-nav__list">
              </ol>
</nav>


          </div>
              </div>
              <div id="comments-footer" class="book-comments">
          

  

        </div>
          </div>
  </article>
<meta itemscope="" itemref="md1">



    </div>
      <!-- CP_PRIMER_FOOTER -->            </div>
        </main>
    </div>
    <!--googleoff: all-->
    <div id="to-top"><a class="btn_slideto" href="#masthead" aria-label="Back to Top"><span class="web-icon-upload"></span></a></div>
    <footer class="footer-main">
        <div class="footer-top">
            <div class="container">

              <div class="brand">
                <a href="https://redhat.com">
                  <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                    <defs>
                      <style>
                        .rh-logo-hat {
                          fill: #e00;
                        }
                        .rh-logo-type {
                          fill: #fff;
                        }
                      </style>
                    </defs>
                    <title>Red Hat</title>
                    <path
                      class="rh-logo-hat"
                      d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
                      <path class="rh-logo-band"
                      d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
                      <path
                      class="rh-logo-type"
                      d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
                  </svg>
                </a>
              </div>

              <div role="navigation" aria-label="quick">
                  <h3>Quick Links</h3>
                  <ul>
                      <li><a class="download-software" href="https://access.redhat.com/downloads/">Downloads</a></li>
                      <li><a class="manage-subscriptions" href="https://access.redhat.com/management">Subscriptions</a></li>
                      <li><a class="support-cases" href="https://access.redhat.com/support">Support Cases</a></li>
                      <li><a class="customer-service" href="https://access.redhat.com/support/customer-service">Customer Service</a></li>
                      <li><a class="quick-docs" href="https://access.redhat.com/documentation">Product Documentation</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="help">
                  <h3>Help</h3>
                  <ul>
                      <li><a class="contact-us" href="https://access.redhat.com/support/contact/">Contact Us</a></li>
                      <li><a class="cp-faqs" href="https://access.redhat.com/articles/33844">Customer Portal FAQ</a></li>
                      <li><a class="login-problems" href="https://access.redhat.com/help/login_assistance">Log-in Assistance</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="site">
                  <h3>Site Info</h3>
                  <ul>
                      <li><a class="trust-red-hat" href="https://www.redhat.com/en/trust">Trust Red Hat</a></li>
                      <li><a class="browser-support-policy" href="https://www.redhat.com/en/about/browser-support">Browser Support Policy</a></li>
                      <li><a class="accessibility" href="https://www.redhat.com/en/about/digital-accessibility">Accessibility</a></li>
                      <li><a class="recognition" href="https://access.redhat.com/recognition/">Awards and Recognition</a></li>
                      <li><a class="colophon" href="https://access.redhat.com/help/colophon/">Colophon</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="other">
                  <h3>Related Sites</h3>
                  <ul>
                      <li><a href="https://www.redhat.com/" class="red-hat-com">redhat.com</a></li>
                      <li><a href="http://developers.redhat.com/" class="red-hat-developers">developers.redhat.com</a></li>
                      <li><a href="https://connect.redhat.com/" class="partner-connect">connect.redhat.com</a></li>
                      <li><a href="https://cloud.redhat.com/" class="cloud-com">cloud.redhat.com</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="about">
                  <h3>About</h3>
                  <ul>
                      <li><a href="https://access.redhat.com/subscription-value" class="subscription-value">Red Hat Subscription Value</a></li>
                      <li><a href="https://www.redhat.com/about/" class="about-red-hat">About Red Hat</a></li>
                      <li><a href="http://jobs.redhat.com" class="about-jobs">Red Hat Jobs</a></li>
                  </ul>
              </div>

            </div>
        </div>

        <div class="anchor">
            <div class="container">
                <div class="status-legal">
                    <a hidden href="https://status.redhat.com" class="status-page-widget">
                        <span class="status-description"></span>
                        <span class="status-dot shape-circle"></span>
                    </a>
                    <div class="legal-copyright">
                        <div class="copyright">Copyright © 2023 Red Hat, Inc.</div>
                        <div role="navigation" aria-label="legal" class="legal">
                            <ul>
                                <li><a href="http://www.redhat.com/en/about/privacy-policy" class="privacy-policy">Privacy Statement</a></li>
                                <li><a href="https://www.redhat.com/en/about/terms-use" class="terms-of-use">Terms of Use</a></li>
                                <li><a href="http://www.redhat.com/en/about/all-policies-guidelines" class="all-policies">All Policies and Guidelines</a></li>
                                <li><a id="teconsent"></a></li>
                            </ul>
                            <div id="privacy_policy">We've updated our <a href='http://www.redhat.com/en/about/privacy-policy' class='privacy-policy'>Privacy Statement</a> effective September 15, 2023.
                            </div>
                          </div>
                        </div>
                </div>
                <div class="social">
                    <a href="http://www.redhat.com/summit/" class="summit">
                        <img src="https://access.redhat.com/chrome_themes/nimbus/img/rh-summit-red-a.svg" alt="Red Hat Summit" /> <span class="offscreen">Red Hat Summit</span>
                    </a>

                    <div class="social-media">
                        <a href="https://twitter.com/RedHat" class="sm-icon twitter"><span class="nicon-twitter"></span><span class="offscreen">Twitter</span></a>                        
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- TrustArc -->
    <div id="consent_blackbar"></div> 
    <!--googleon: all-->
</div>
<!-- /CP_PRIMER_FOOTER -->


  </div>

    
  </body>
</html>
